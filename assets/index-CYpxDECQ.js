const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/AddLayerModal-DMVSchiP.js","assets/Edit-6lTTt_tw.js","assets/LayerList-BNUadUBf.js"])))=>i.map(i=>d[i]);
var c9=Object.defineProperty;var d9=(e,t,n)=>t in e?c9(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Q_=(e,t,n)=>d9(e,typeof t!="symbol"?t+"":t,n);function h9(e,t){for(var n=0;n<t.length;n++){const s=t[n];if(typeof s!="string"&&!Array.isArray(s)){for(const a in s)if(a!=="default"&&!(a in e)){const u=Object.getOwnPropertyDescriptor(s,a);u&&Object.defineProperty(e,a,u.get?u:{enumerable:!0,get:()=>s[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const u of a)if(u.type==="childList")for(const f of u.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&s(f)}).observe(document,{childList:!0,subtree:!0});function n(a){const u={};return a.integrity&&(u.integrity=a.integrity),a.referrerPolicy&&(u.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?u.credentials="include":a.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function s(a){if(a.ep)return;a.ep=!0;const u=n(a);fetch(a.href,u)}})();var fl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function yc(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var DN={exports:{}},kC={},zN={exports:{}},Zi={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kx=Symbol.for("react.element"),f9=Symbol.for("react.portal"),p9=Symbol.for("react.fragment"),m9=Symbol.for("react.strict_mode"),g9=Symbol.for("react.profiler"),y9=Symbol.for("react.provider"),_9=Symbol.for("react.context"),v9=Symbol.for("react.forward_ref"),x9=Symbol.for("react.suspense"),b9=Symbol.for("react.memo"),w9=Symbol.for("react.lazy"),xD=Symbol.iterator;function S9(e){return e===null||typeof e!="object"?null:(e=xD&&e[xD]||e["@@iterator"],typeof e=="function"?e:null)}var FN={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},NN=Object.assign,BN={};function p0(e,t,n){this.props=e,this.context=t,this.refs=BN,this.updater=n||FN}p0.prototype.isReactComponent={};p0.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};p0.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function jN(){}jN.prototype=p0.prototype;function HP(e,t,n){this.props=e,this.context=t,this.refs=BN,this.updater=n||FN}var WP=HP.prototype=new jN;WP.constructor=HP;NN(WP,p0.prototype);WP.isPureReactComponent=!0;var bD=Array.isArray,VN=Object.prototype.hasOwnProperty,qP={current:null},$N={key:!0,ref:!0,__self:!0,__source:!0};function UN(e,t,n){var s,a={},u=null,f=null;if(t!=null)for(s in t.ref!==void 0&&(f=t.ref),t.key!==void 0&&(u=""+t.key),t)VN.call(t,s)&&!$N.hasOwnProperty(s)&&(a[s]=t[s]);var _=arguments.length-2;if(_===1)a.children=n;else if(1<_){for(var r=Array(_),C=0;C<_;C++)r[C]=arguments[C+2];a.children=r}if(e&&e.defaultProps)for(s in _=e.defaultProps,_)a[s]===void 0&&(a[s]=_[s]);return{$$typeof:Kx,type:e,key:u,ref:f,props:a,_owner:qP.current}}function C9(e,t){return{$$typeof:Kx,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function XP(e){return typeof e=="object"&&e!==null&&e.$$typeof===Kx}function E9(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var wD=/\/+/g;function OI(e,t){return typeof e=="object"&&e!==null&&e.key!=null?E9(""+e.key):t.toString(36)}function Yw(e,t,n,s,a){var u=typeof e;(u==="undefined"||u==="boolean")&&(e=null);var f=!1;if(e===null)f=!0;else switch(u){case"string":case"number":f=!0;break;case"object":switch(e.$$typeof){case Kx:case f9:f=!0}}if(f)return f=e,a=a(f),e=s===""?"."+OI(f,0):s,bD(a)?(n="",e!=null&&(n=e.replace(wD,"$&/")+"/"),Yw(a,t,n,"",function(C){return C})):a!=null&&(XP(a)&&(a=C9(a,n+(!a.key||f&&f.key===a.key?"":(""+a.key).replace(wD,"$&/")+"/")+e)),t.push(a)),1;if(f=0,s=s===""?".":s+":",bD(e))for(var _=0;_<e.length;_++){u=e[_];var r=s+OI(u,_);f+=Yw(u,t,n,r,a)}else if(r=S9(e),typeof r=="function")for(e=r.call(e),_=0;!(u=e.next()).done;)u=u.value,r=s+OI(u,_++),f+=Yw(u,t,n,r,a);else if(u==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return f}function Kb(e,t,n){if(e==null)return e;var s=[],a=0;return Yw(e,s,"","",function(u){return t.call(n,u,a++)}),s}function T9(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Dl={current:null},Zw={transition:null},I9={ReactCurrentDispatcher:Dl,ReactCurrentBatchConfig:Zw,ReactCurrentOwner:qP};function GN(){throw Error("act(...) is not supported in production builds of React.")}Zi.Children={map:Kb,forEach:function(e,t,n){Kb(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Kb(e,function(){t++}),t},toArray:function(e){return Kb(e,function(t){return t})||[]},only:function(e){if(!XP(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Zi.Component=p0;Zi.Fragment=p9;Zi.Profiler=g9;Zi.PureComponent=HP;Zi.StrictMode=m9;Zi.Suspense=x9;Zi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=I9;Zi.act=GN;Zi.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var s=NN({},e.props),a=e.key,u=e.ref,f=e._owner;if(t!=null){if(t.ref!==void 0&&(u=t.ref,f=qP.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var _=e.type.defaultProps;for(r in t)VN.call(t,r)&&!$N.hasOwnProperty(r)&&(s[r]=t[r]===void 0&&_!==void 0?_[r]:t[r])}var r=arguments.length-2;if(r===1)s.children=n;else if(1<r){_=Array(r);for(var C=0;C<r;C++)_[C]=arguments[C+2];s.children=_}return{$$typeof:Kx,type:e.type,key:a,ref:u,props:s,_owner:f}};Zi.createContext=function(e){return e={$$typeof:_9,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:y9,_context:e},e.Consumer=e};Zi.createElement=UN;Zi.createFactory=function(e){var t=UN.bind(null,e);return t.type=e,t};Zi.createRef=function(){return{current:null}};Zi.forwardRef=function(e){return{$$typeof:v9,render:e}};Zi.isValidElement=XP;Zi.lazy=function(e){return{$$typeof:w9,_payload:{_status:-1,_result:e},_init:T9}};Zi.memo=function(e,t){return{$$typeof:b9,type:e,compare:t===void 0?null:t}};Zi.startTransition=function(e){var t=Zw.transition;Zw.transition={};try{e()}finally{Zw.transition=t}};Zi.unstable_act=GN;Zi.useCallback=function(e,t){return Dl.current.useCallback(e,t)};Zi.useContext=function(e){return Dl.current.useContext(e)};Zi.useDebugValue=function(){};Zi.useDeferredValue=function(e){return Dl.current.useDeferredValue(e)};Zi.useEffect=function(e,t){return Dl.current.useEffect(e,t)};Zi.useId=function(){return Dl.current.useId()};Zi.useImperativeHandle=function(e,t,n){return Dl.current.useImperativeHandle(e,t,n)};Zi.useInsertionEffect=function(e,t){return Dl.current.useInsertionEffect(e,t)};Zi.useLayoutEffect=function(e,t){return Dl.current.useLayoutEffect(e,t)};Zi.useMemo=function(e,t){return Dl.current.useMemo(e,t)};Zi.useReducer=function(e,t,n){return Dl.current.useReducer(e,t,n)};Zi.useRef=function(e){return Dl.current.useRef(e)};Zi.useState=function(e){return Dl.current.useState(e)};Zi.useSyncExternalStore=function(e,t,n){return Dl.current.useSyncExternalStore(e,t,n)};Zi.useTransition=function(){return Dl.current.useTransition()};Zi.version="18.3.1";zN.exports=Zi;var X=zN.exports;const Sr=yc(X),qk=h9({__proto__:null,default:Sr},[X]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var k9=X,M9=Symbol.for("react.element"),P9=Symbol.for("react.fragment"),A9=Object.prototype.hasOwnProperty,L9=k9.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,R9={key:!0,ref:!0,__self:!0,__source:!0};function HN(e,t,n){var s,a={},u=null,f=null;n!==void 0&&(u=""+n),t.key!==void 0&&(u=""+t.key),t.ref!==void 0&&(f=t.ref);for(s in t)A9.call(t,s)&&!R9.hasOwnProperty(s)&&(a[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps,t)a[s]===void 0&&(a[s]=t[s]);return{$$typeof:M9,type:e,key:u,ref:f,props:a,_owner:L9.current}}kC.Fragment=P9;kC.jsx=HN;kC.jsxs=HN;DN.exports=kC;var K=DN.exports,WN={exports:{}},Pu={},qN={exports:{}},XN={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(Me,Re){var Oe=Me.length;Me.push(Re);e:for(;0<Oe;){var $e=Oe-1>>>1,Ke=Me[$e];if(0<a(Ke,Re))Me[$e]=Re,Me[Oe]=Ke,Oe=$e;else break e}}function n(Me){return Me.length===0?null:Me[0]}function s(Me){if(Me.length===0)return null;var Re=Me[0],Oe=Me.pop();if(Oe!==Re){Me[0]=Oe;e:for(var $e=0,Ke=Me.length,Ct=Ke>>>1;$e<Ct;){var Ue=2*($e+1)-1,ft=Me[Ue],Bt=Ue+1,hn=Me[Bt];if(0>a(ft,Oe))Bt<Ke&&0>a(hn,ft)?(Me[$e]=hn,Me[Bt]=Oe,$e=Bt):(Me[$e]=ft,Me[Ue]=Oe,$e=Ue);else if(Bt<Ke&&0>a(hn,Oe))Me[$e]=hn,Me[Bt]=Oe,$e=Bt;else break e}}return Re}function a(Me,Re){var Oe=Me.sortIndex-Re.sortIndex;return Oe!==0?Oe:Me.id-Re.id}if(typeof performance=="object"&&typeof performance.now=="function"){var u=performance;e.unstable_now=function(){return u.now()}}else{var f=Date,_=f.now();e.unstable_now=function(){return f.now()-_}}var r=[],C=[],k=1,I=null,P=3,D=!1,N=!1,j=!1,W=typeof setTimeout=="function"?setTimeout:null,H=typeof clearTimeout=="function"?clearTimeout:null,q=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function Z(Me){for(var Re=n(C);Re!==null;){if(Re.callback===null)s(C);else if(Re.startTime<=Me)s(C),Re.sortIndex=Re.expirationTime,t(r,Re);else break;Re=n(C)}}function re(Me){if(j=!1,Z(Me),!N)if(n(r)!==null)N=!0,Se(le);else{var Re=n(C);Re!==null&&Pe(re,Re.startTime-Me)}}function le(Me,Re){N=!1,j&&(j=!1,H(de),de=-1),D=!0;var Oe=P;try{for(Z(Re),I=n(r);I!==null&&(!(I.expirationTime>Re)||Me&&!xe());){var $e=I.callback;if(typeof $e=="function"){I.callback=null,P=I.priorityLevel;var Ke=$e(I.expirationTime<=Re);Re=e.unstable_now(),typeof Ke=="function"?I.callback=Ke:I===n(r)&&s(r),Z(Re)}else s(r);I=n(r)}if(I!==null)var Ct=!0;else{var Ue=n(C);Ue!==null&&Pe(re,Ue.startTime-Re),Ct=!1}return Ct}finally{I=null,P=Oe,D=!1}}var _e=!1,ye=null,de=-1,ce=5,oe=-1;function xe(){return!(e.unstable_now()-oe<ce)}function he(){if(ye!==null){var Me=e.unstable_now();oe=Me;var Re=!0;try{Re=ye(!0,Me)}finally{Re?Ee():(_e=!1,ye=null)}}else _e=!1}var Ee;if(typeof q=="function")Ee=function(){q(he)};else if(typeof MessageChannel<"u"){var se=new MessageChannel,we=se.port2;se.port1.onmessage=he,Ee=function(){we.postMessage(null)}}else Ee=function(){W(he,0)};function Se(Me){ye=Me,_e||(_e=!0,Ee())}function Pe(Me,Re){de=W(function(){Me(e.unstable_now())},Re)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Me){Me.callback=null},e.unstable_continueExecution=function(){N||D||(N=!0,Se(le))},e.unstable_forceFrameRate=function(Me){0>Me||125<Me?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ce=0<Me?Math.floor(1e3/Me):5},e.unstable_getCurrentPriorityLevel=function(){return P},e.unstable_getFirstCallbackNode=function(){return n(r)},e.unstable_next=function(Me){switch(P){case 1:case 2:case 3:var Re=3;break;default:Re=P}var Oe=P;P=Re;try{return Me()}finally{P=Oe}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Me,Re){switch(Me){case 1:case 2:case 3:case 4:case 5:break;default:Me=3}var Oe=P;P=Me;try{return Re()}finally{P=Oe}},e.unstable_scheduleCallback=function(Me,Re,Oe){var $e=e.unstable_now();switch(typeof Oe=="object"&&Oe!==null?(Oe=Oe.delay,Oe=typeof Oe=="number"&&0<Oe?$e+Oe:$e):Oe=$e,Me){case 1:var Ke=-1;break;case 2:Ke=250;break;case 5:Ke=1073741823;break;case 4:Ke=1e4;break;default:Ke=5e3}return Ke=Oe+Ke,Me={id:k++,callback:Re,priorityLevel:Me,startTime:Oe,expirationTime:Ke,sortIndex:-1},Oe>$e?(Me.sortIndex=Oe,t(C,Me),n(r)===null&&Me===n(C)&&(j?(H(de),de=-1):j=!0,Pe(re,Oe-$e))):(Me.sortIndex=Ke,t(r,Me),N||D||(N=!0,Se(le))),Me},e.unstable_shouldYield=xe,e.unstable_wrapCallback=function(Me){var Re=P;return function(){var Oe=P;P=Re;try{return Me.apply(this,arguments)}finally{P=Oe}}}})(XN);qN.exports=XN;var O9=qN.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var D9=X,ku=O9;function fr(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var YN=new Set,hx={};function Om(e,t){Vy(e,t),Vy(e+"Capture",t)}function Vy(e,t){for(hx[e]=t,e=0;e<t.length;e++)YN.add(t[e])}var Lh=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Xk=Object.prototype.hasOwnProperty,z9=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,SD={},CD={};function F9(e){return Xk.call(CD,e)?!0:Xk.call(SD,e)?!1:z9.test(e)?CD[e]=!0:(SD[e]=!0,!1)}function N9(e,t,n,s){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return s?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function B9(e,t,n,s){if(t===null||typeof t>"u"||N9(e,t,n,s))return!0;if(s)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function zl(e,t,n,s,a,u,f){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=s,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=u,this.removeEmptyString=f}var Ua={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Ua[e]=new zl(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Ua[t]=new zl(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Ua[e]=new zl(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Ua[e]=new zl(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Ua[e]=new zl(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Ua[e]=new zl(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Ua[e]=new zl(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Ua[e]=new zl(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Ua[e]=new zl(e,5,!1,e.toLowerCase(),null,!1,!1)});var YP=/[\-:]([a-z])/g;function ZP(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(YP,ZP);Ua[t]=new zl(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(YP,ZP);Ua[t]=new zl(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(YP,ZP);Ua[t]=new zl(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Ua[e]=new zl(e,1,!1,e.toLowerCase(),null,!1,!1)});Ua.xlinkHref=new zl("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Ua[e]=new zl(e,1,!1,e.toLowerCase(),null,!0,!0)});function KP(e,t,n,s){var a=Ua.hasOwnProperty(t)?Ua[t]:null;(a!==null?a.type!==0:s||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(B9(t,n,a,s)&&(n=null),s||a===null?F9(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=n===null?a.type===3?!1:"":n:(t=a.attributeName,s=a.attributeNamespace,n===null?e.removeAttribute(t):(a=a.type,n=a===3||a===4&&n===!0?"":""+n,s?e.setAttributeNS(s,t,n):e.setAttribute(t,n))))}var Vh=D9.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Jb=Symbol.for("react.element"),ay=Symbol.for("react.portal"),ly=Symbol.for("react.fragment"),JP=Symbol.for("react.strict_mode"),Yk=Symbol.for("react.profiler"),ZN=Symbol.for("react.provider"),KN=Symbol.for("react.context"),QP=Symbol.for("react.forward_ref"),Zk=Symbol.for("react.suspense"),Kk=Symbol.for("react.suspense_list"),e2=Symbol.for("react.memo"),Af=Symbol.for("react.lazy"),JN=Symbol.for("react.offscreen"),ED=Symbol.iterator;function ev(e){return e===null||typeof e!="object"?null:(e=ED&&e[ED]||e["@@iterator"],typeof e=="function"?e:null)}var Ls=Object.assign,DI;function Dv(e){if(DI===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);DI=t&&t[1]||""}return`
`+DI+e}var zI=!1;function FI(e,t){if(!e||zI)return"";zI=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(C){var s=C}Reflect.construct(e,[],t)}else{try{t.call()}catch(C){s=C}e.call(t.prototype)}else{try{throw Error()}catch(C){s=C}e()}}catch(C){if(C&&s&&typeof C.stack=="string"){for(var a=C.stack.split(`
`),u=s.stack.split(`
`),f=a.length-1,_=u.length-1;1<=f&&0<=_&&a[f]!==u[_];)_--;for(;1<=f&&0<=_;f--,_--)if(a[f]!==u[_]){if(f!==1||_!==1)do if(f--,_--,0>_||a[f]!==u[_]){var r=`
`+a[f].replace(" at new "," at ");return e.displayName&&r.includes("<anonymous>")&&(r=r.replace("<anonymous>",e.displayName)),r}while(1<=f&&0<=_);break}}}finally{zI=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Dv(e):""}function j9(e){switch(e.tag){case 5:return Dv(e.type);case 16:return Dv("Lazy");case 13:return Dv("Suspense");case 19:return Dv("SuspenseList");case 0:case 2:case 15:return e=FI(e.type,!1),e;case 11:return e=FI(e.type.render,!1),e;case 1:return e=FI(e.type,!0),e;default:return""}}function Jk(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ly:return"Fragment";case ay:return"Portal";case Yk:return"Profiler";case JP:return"StrictMode";case Zk:return"Suspense";case Kk:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case KN:return(e.displayName||"Context")+".Consumer";case ZN:return(e._context.displayName||"Context")+".Provider";case QP:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case e2:return t=e.displayName||null,t!==null?t:Jk(e.type)||"Memo";case Af:t=e._payload,e=e._init;try{return Jk(e(t))}catch{}}return null}function V9(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Jk(t);case 8:return t===JP?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function tp(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function QN(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function $9(e){var t=QN(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),s=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var a=n.get,u=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(f){s=""+f,u.call(this,f)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return s},setValue:function(f){s=""+f},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Qb(e){e._valueTracker||(e._valueTracker=$9(e))}function eB(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),s="";return e&&(s=QN(e)?e.checked?"true":"false":e.value),e=s,e!==n?(t.setValue(e),!0):!1}function wS(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Qk(e,t){var n=t.checked;return Ls({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function TD(e,t){var n=t.defaultValue==null?"":t.defaultValue,s=t.checked!=null?t.checked:t.defaultChecked;n=tp(t.value!=null?t.value:n),e._wrapperState={initialChecked:s,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function tB(e,t){t=t.checked,t!=null&&KP(e,"checked",t,!1)}function eM(e,t){tB(e,t);var n=tp(t.value),s=t.type;if(n!=null)s==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(s==="submit"||s==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?tM(e,t.type,n):t.hasOwnProperty("defaultValue")&&tM(e,t.type,tp(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function ID(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var s=t.type;if(!(s!=="submit"&&s!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function tM(e,t,n){(t!=="number"||wS(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var zv=Array.isArray;function Ey(e,t,n,s){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&s&&(e[n].defaultSelected=!0)}else{for(n=""+tp(n),t=null,a=0;a<e.length;a++){if(e[a].value===n){e[a].selected=!0,s&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function nM(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(fr(91));return Ls({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function kD(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(fr(92));if(zv(n)){if(1<n.length)throw Error(fr(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:tp(n)}}function nB(e,t){var n=tp(t.value),s=tp(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),s!=null&&(e.defaultValue=""+s)}function MD(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function rB(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function rM(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?rB(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var ew,iB=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,s,a){MSApp.execUnsafeLocalFunction(function(){return e(t,n,s,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(ew=ew||document.createElement("div"),ew.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ew.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function fx(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Zv={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},U9=["Webkit","ms","Moz","O"];Object.keys(Zv).forEach(function(e){U9.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Zv[t]=Zv[e]})});function oB(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||Zv.hasOwnProperty(e)&&Zv[e]?(""+t).trim():t+"px"}function sB(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var s=n.indexOf("--")===0,a=oB(n,t[n],s);n==="float"&&(n="cssFloat"),s?e.setProperty(n,a):e[n]=a}}var G9=Ls({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function iM(e,t){if(t){if(G9[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(fr(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(fr(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(fr(61))}if(t.style!=null&&typeof t.style!="object")throw Error(fr(62))}}function oM(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var sM=null;function t2(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var aM=null,Ty=null,Iy=null;function PD(e){if(e=e1(e)){if(typeof aM!="function")throw Error(fr(280));var t=e.stateNode;t&&(t=RC(t),aM(e.stateNode,e.type,t))}}function aB(e){Ty?Iy?Iy.push(e):Iy=[e]:Ty=e}function lB(){if(Ty){var e=Ty,t=Iy;if(Iy=Ty=null,PD(e),t)for(e=0;e<t.length;e++)PD(t[e])}}function uB(e,t){return e(t)}function cB(){}var NI=!1;function dB(e,t,n){if(NI)return e(t,n);NI=!0;try{return uB(e,t,n)}finally{NI=!1,(Ty!==null||Iy!==null)&&(cB(),lB())}}function px(e,t){var n=e.stateNode;if(n===null)return null;var s=RC(n);if(s===null)return null;n=s[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(e=e.type,s=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!s;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(fr(231,t,typeof n));return n}var lM=!1;if(Lh)try{var tv={};Object.defineProperty(tv,"passive",{get:function(){lM=!0}}),window.addEventListener("test",tv,tv),window.removeEventListener("test",tv,tv)}catch{lM=!1}function H9(e,t,n,s,a,u,f,_,r){var C=Array.prototype.slice.call(arguments,3);try{t.apply(n,C)}catch(k){this.onError(k)}}var Kv=!1,SS=null,CS=!1,uM=null,W9={onError:function(e){Kv=!0,SS=e}};function q9(e,t,n,s,a,u,f,_,r){Kv=!1,SS=null,H9.apply(W9,arguments)}function X9(e,t,n,s,a,u,f,_,r){if(q9.apply(this,arguments),Kv){if(Kv){var C=SS;Kv=!1,SS=null}else throw Error(fr(198));CS||(CS=!0,uM=C)}}function Dm(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function hB(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function AD(e){if(Dm(e)!==e)throw Error(fr(188))}function Y9(e){var t=e.alternate;if(!t){if(t=Dm(e),t===null)throw Error(fr(188));return t!==e?null:e}for(var n=e,s=t;;){var a=n.return;if(a===null)break;var u=a.alternate;if(u===null){if(s=a.return,s!==null){n=s;continue}break}if(a.child===u.child){for(u=a.child;u;){if(u===n)return AD(a),e;if(u===s)return AD(a),t;u=u.sibling}throw Error(fr(188))}if(n.return!==s.return)n=a,s=u;else{for(var f=!1,_=a.child;_;){if(_===n){f=!0,n=a,s=u;break}if(_===s){f=!0,s=a,n=u;break}_=_.sibling}if(!f){for(_=u.child;_;){if(_===n){f=!0,n=u,s=a;break}if(_===s){f=!0,s=u,n=a;break}_=_.sibling}if(!f)throw Error(fr(189))}}if(n.alternate!==s)throw Error(fr(190))}if(n.tag!==3)throw Error(fr(188));return n.stateNode.current===n?e:t}function fB(e){return e=Y9(e),e!==null?pB(e):null}function pB(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=pB(e);if(t!==null)return t;e=e.sibling}return null}var mB=ku.unstable_scheduleCallback,LD=ku.unstable_cancelCallback,Z9=ku.unstable_shouldYield,K9=ku.unstable_requestPaint,Js=ku.unstable_now,J9=ku.unstable_getCurrentPriorityLevel,n2=ku.unstable_ImmediatePriority,gB=ku.unstable_UserBlockingPriority,ES=ku.unstable_NormalPriority,Q9=ku.unstable_LowPriority,yB=ku.unstable_IdlePriority,MC=null,jd=null;function e7(e){if(jd&&typeof jd.onCommitFiberRoot=="function")try{jd.onCommitFiberRoot(MC,e,void 0,(e.current.flags&128)===128)}catch{}}var Kc=Math.clz32?Math.clz32:r7,t7=Math.log,n7=Math.LN2;function r7(e){return e>>>=0,e===0?32:31-(t7(e)/n7|0)|0}var tw=64,nw=4194304;function Fv(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function TS(e,t){var n=e.pendingLanes;if(n===0)return 0;var s=0,a=e.suspendedLanes,u=e.pingedLanes,f=n&268435455;if(f!==0){var _=f&~a;_!==0?s=Fv(_):(u&=f,u!==0&&(s=Fv(u)))}else f=n&~a,f!==0?s=Fv(f):u!==0&&(s=Fv(u));if(s===0)return 0;if(t!==0&&t!==s&&!(t&a)&&(a=s&-s,u=t&-t,a>=u||a===16&&(u&4194240)!==0))return t;if(s&4&&(s|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=s;0<t;)n=31-Kc(t),a=1<<n,s|=e[n],t&=~a;return s}function i7(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function o7(e,t){for(var n=e.suspendedLanes,s=e.pingedLanes,a=e.expirationTimes,u=e.pendingLanes;0<u;){var f=31-Kc(u),_=1<<f,r=a[f];r===-1?(!(_&n)||_&s)&&(a[f]=i7(_,t)):r<=t&&(e.expiredLanes|=_),u&=~_}}function cM(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function _B(){var e=tw;return tw<<=1,!(tw&4194240)&&(tw=64),e}function BI(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Jx(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Kc(t),e[t]=n}function s7(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var s=e.eventTimes;for(e=e.expirationTimes;0<n;){var a=31-Kc(n),u=1<<a;t[a]=0,s[a]=-1,e[a]=-1,n&=~u}}function r2(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var s=31-Kc(n),a=1<<s;a&t|e[s]&t&&(e[s]|=t),n&=~a}}var Ao=0;function vB(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var xB,i2,bB,wB,SB,dM=!1,rw=[],Gf=null,Hf=null,Wf=null,mx=new Map,gx=new Map,Of=[],a7="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function RD(e,t){switch(e){case"focusin":case"focusout":Gf=null;break;case"dragenter":case"dragleave":Hf=null;break;case"mouseover":case"mouseout":Wf=null;break;case"pointerover":case"pointerout":mx.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":gx.delete(t.pointerId)}}function nv(e,t,n,s,a,u){return e===null||e.nativeEvent!==u?(e={blockedOn:t,domEventName:n,eventSystemFlags:s,nativeEvent:u,targetContainers:[a]},t!==null&&(t=e1(t),t!==null&&i2(t)),e):(e.eventSystemFlags|=s,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function l7(e,t,n,s,a){switch(t){case"focusin":return Gf=nv(Gf,e,t,n,s,a),!0;case"dragenter":return Hf=nv(Hf,e,t,n,s,a),!0;case"mouseover":return Wf=nv(Wf,e,t,n,s,a),!0;case"pointerover":var u=a.pointerId;return mx.set(u,nv(mx.get(u)||null,e,t,n,s,a)),!0;case"gotpointercapture":return u=a.pointerId,gx.set(u,nv(gx.get(u)||null,e,t,n,s,a)),!0}return!1}function CB(e){var t=lm(e.target);if(t!==null){var n=Dm(t);if(n!==null){if(t=n.tag,t===13){if(t=hB(n),t!==null){e.blockedOn=t,SB(e.priority,function(){bB(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Kw(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=hM(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var s=new n.constructor(n.type,n);sM=s,n.target.dispatchEvent(s),sM=null}else return t=e1(n),t!==null&&i2(t),e.blockedOn=n,!1;t.shift()}return!0}function OD(e,t,n){Kw(e)&&n.delete(t)}function u7(){dM=!1,Gf!==null&&Kw(Gf)&&(Gf=null),Hf!==null&&Kw(Hf)&&(Hf=null),Wf!==null&&Kw(Wf)&&(Wf=null),mx.forEach(OD),gx.forEach(OD)}function rv(e,t){e.blockedOn===t&&(e.blockedOn=null,dM||(dM=!0,ku.unstable_scheduleCallback(ku.unstable_NormalPriority,u7)))}function yx(e){function t(a){return rv(a,e)}if(0<rw.length){rv(rw[0],e);for(var n=1;n<rw.length;n++){var s=rw[n];s.blockedOn===e&&(s.blockedOn=null)}}for(Gf!==null&&rv(Gf,e),Hf!==null&&rv(Hf,e),Wf!==null&&rv(Wf,e),mx.forEach(t),gx.forEach(t),n=0;n<Of.length;n++)s=Of[n],s.blockedOn===e&&(s.blockedOn=null);for(;0<Of.length&&(n=Of[0],n.blockedOn===null);)CB(n),n.blockedOn===null&&Of.shift()}var ky=Vh.ReactCurrentBatchConfig,IS=!0;function c7(e,t,n,s){var a=Ao,u=ky.transition;ky.transition=null;try{Ao=1,o2(e,t,n,s)}finally{Ao=a,ky.transition=u}}function d7(e,t,n,s){var a=Ao,u=ky.transition;ky.transition=null;try{Ao=4,o2(e,t,n,s)}finally{Ao=a,ky.transition=u}}function o2(e,t,n,s){if(IS){var a=hM(e,t,n,s);if(a===null)YI(e,t,s,kS,n),RD(e,s);else if(l7(a,e,t,n,s))s.stopPropagation();else if(RD(e,s),t&4&&-1<a7.indexOf(e)){for(;a!==null;){var u=e1(a);if(u!==null&&xB(u),u=hM(e,t,n,s),u===null&&YI(e,t,s,kS,n),u===a)break;a=u}a!==null&&s.stopPropagation()}else YI(e,t,s,null,n)}}var kS=null;function hM(e,t,n,s){if(kS=null,e=t2(s),e=lm(e),e!==null)if(t=Dm(e),t===null)e=null;else if(n=t.tag,n===13){if(e=hB(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return kS=e,null}function EB(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(J9()){case n2:return 1;case gB:return 4;case ES:case Q9:return 16;case yB:return 536870912;default:return 16}default:return 16}}var Bf=null,s2=null,Jw=null;function TB(){if(Jw)return Jw;var e,t=s2,n=t.length,s,a="value"in Bf?Bf.value:Bf.textContent,u=a.length;for(e=0;e<n&&t[e]===a[e];e++);var f=n-e;for(s=1;s<=f&&t[n-s]===a[u-s];s++);return Jw=a.slice(e,1<s?1-s:void 0)}function Qw(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function iw(){return!0}function DD(){return!1}function Au(e){function t(n,s,a,u,f){this._reactName=n,this._targetInst=a,this.type=s,this.nativeEvent=u,this.target=f,this.currentTarget=null;for(var _ in e)e.hasOwnProperty(_)&&(n=e[_],this[_]=n?n(u):u[_]);return this.isDefaultPrevented=(u.defaultPrevented!=null?u.defaultPrevented:u.returnValue===!1)?iw:DD,this.isPropagationStopped=DD,this}return Ls(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=iw)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=iw)},persist:function(){},isPersistent:iw}),t}var m0={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},a2=Au(m0),Qx=Ls({},m0,{view:0,detail:0}),h7=Au(Qx),jI,VI,iv,PC=Ls({},Qx,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:l2,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==iv&&(iv&&e.type==="mousemove"?(jI=e.screenX-iv.screenX,VI=e.screenY-iv.screenY):VI=jI=0,iv=e),jI)},movementY:function(e){return"movementY"in e?e.movementY:VI}}),zD=Au(PC),f7=Ls({},PC,{dataTransfer:0}),p7=Au(f7),m7=Ls({},Qx,{relatedTarget:0}),$I=Au(m7),g7=Ls({},m0,{animationName:0,elapsedTime:0,pseudoElement:0}),y7=Au(g7),_7=Ls({},m0,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),v7=Au(_7),x7=Ls({},m0,{data:0}),FD=Au(x7),b7={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},w7={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},S7={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function C7(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=S7[e])?!!t[e]:!1}function l2(){return C7}var E7=Ls({},Qx,{key:function(e){if(e.key){var t=b7[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Qw(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?w7[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:l2,charCode:function(e){return e.type==="keypress"?Qw(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Qw(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),T7=Au(E7),I7=Ls({},PC,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ND=Au(I7),k7=Ls({},Qx,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:l2}),M7=Au(k7),P7=Ls({},m0,{propertyName:0,elapsedTime:0,pseudoElement:0}),A7=Au(P7),L7=Ls({},PC,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),R7=Au(L7),O7=[9,13,27,32],u2=Lh&&"CompositionEvent"in window,Jv=null;Lh&&"documentMode"in document&&(Jv=document.documentMode);var D7=Lh&&"TextEvent"in window&&!Jv,IB=Lh&&(!u2||Jv&&8<Jv&&11>=Jv),BD=" ",jD=!1;function kB(e,t){switch(e){case"keyup":return O7.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function MB(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var uy=!1;function z7(e,t){switch(e){case"compositionend":return MB(t);case"keypress":return t.which!==32?null:(jD=!0,BD);case"textInput":return e=t.data,e===BD&&jD?null:e;default:return null}}function F7(e,t){if(uy)return e==="compositionend"||!u2&&kB(e,t)?(e=TB(),Jw=s2=Bf=null,uy=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return IB&&t.locale!=="ko"?null:t.data;default:return null}}var N7={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function VD(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!N7[e.type]:t==="textarea"}function PB(e,t,n,s){aB(s),t=MS(t,"onChange"),0<t.length&&(n=new a2("onChange","change",null,n,s),e.push({event:n,listeners:t}))}var Qv=null,_x=null;function B7(e){VB(e,0)}function AC(e){var t=hy(e);if(eB(t))return e}function j7(e,t){if(e==="change")return t}var AB=!1;if(Lh){var UI;if(Lh){var GI="oninput"in document;if(!GI){var $D=document.createElement("div");$D.setAttribute("oninput","return;"),GI=typeof $D.oninput=="function"}UI=GI}else UI=!1;AB=UI&&(!document.documentMode||9<document.documentMode)}function UD(){Qv&&(Qv.detachEvent("onpropertychange",LB),_x=Qv=null)}function LB(e){if(e.propertyName==="value"&&AC(_x)){var t=[];PB(t,_x,e,t2(e)),dB(B7,t)}}function V7(e,t,n){e==="focusin"?(UD(),Qv=t,_x=n,Qv.attachEvent("onpropertychange",LB)):e==="focusout"&&UD()}function $7(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return AC(_x)}function U7(e,t){if(e==="click")return AC(t)}function G7(e,t){if(e==="input"||e==="change")return AC(t)}function H7(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var td=typeof Object.is=="function"?Object.is:H7;function vx(e,t){if(td(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),s=Object.keys(t);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var a=n[s];if(!Xk.call(t,a)||!td(e[a],t[a]))return!1}return!0}function GD(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function HD(e,t){var n=GD(e);e=0;for(var s;n;){if(n.nodeType===3){if(s=e+n.textContent.length,e<=t&&s>=t)return{node:n,offset:t-e};e=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=GD(n)}}function RB(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?RB(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function OB(){for(var e=window,t=wS();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=wS(e.document)}return t}function c2(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function W7(e){var t=OB(),n=e.focusedElem,s=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&RB(n.ownerDocument.documentElement,n)){if(s!==null&&c2(n)){if(t=s.start,e=s.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=n.textContent.length,u=Math.min(s.start,a);s=s.end===void 0?u:Math.min(s.end,a),!e.extend&&u>s&&(a=s,s=u,u=a),a=HD(n,u);var f=HD(n,s);a&&f&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==f.node||e.focusOffset!==f.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),u>s?(e.addRange(t),e.extend(f.node,f.offset)):(t.setEnd(f.node,f.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var q7=Lh&&"documentMode"in document&&11>=document.documentMode,cy=null,fM=null,ex=null,pM=!1;function WD(e,t,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;pM||cy==null||cy!==wS(s)||(s=cy,"selectionStart"in s&&c2(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),ex&&vx(ex,s)||(ex=s,s=MS(fM,"onSelect"),0<s.length&&(t=new a2("onSelect","select",null,t,n),e.push({event:t,listeners:s}),t.target=cy)))}function ow(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var dy={animationend:ow("Animation","AnimationEnd"),animationiteration:ow("Animation","AnimationIteration"),animationstart:ow("Animation","AnimationStart"),transitionend:ow("Transition","TransitionEnd")},HI={},DB={};Lh&&(DB=document.createElement("div").style,"AnimationEvent"in window||(delete dy.animationend.animation,delete dy.animationiteration.animation,delete dy.animationstart.animation),"TransitionEvent"in window||delete dy.transitionend.transition);function LC(e){if(HI[e])return HI[e];if(!dy[e])return e;var t=dy[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in DB)return HI[e]=t[n];return e}var zB=LC("animationend"),FB=LC("animationiteration"),NB=LC("animationstart"),BB=LC("transitionend"),jB=new Map,qD="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function fp(e,t){jB.set(e,t),Om(t,[e])}for(var WI=0;WI<qD.length;WI++){var qI=qD[WI],X7=qI.toLowerCase(),Y7=qI[0].toUpperCase()+qI.slice(1);fp(X7,"on"+Y7)}fp(zB,"onAnimationEnd");fp(FB,"onAnimationIteration");fp(NB,"onAnimationStart");fp("dblclick","onDoubleClick");fp("focusin","onFocus");fp("focusout","onBlur");fp(BB,"onTransitionEnd");Vy("onMouseEnter",["mouseout","mouseover"]);Vy("onMouseLeave",["mouseout","mouseover"]);Vy("onPointerEnter",["pointerout","pointerover"]);Vy("onPointerLeave",["pointerout","pointerover"]);Om("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Om("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Om("onBeforeInput",["compositionend","keypress","textInput","paste"]);Om("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Om("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Om("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Nv="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Z7=new Set("cancel close invalid load scroll toggle".split(" ").concat(Nv));function XD(e,t,n){var s=e.type||"unknown-event";e.currentTarget=n,X9(s,t,void 0,e),e.currentTarget=null}function VB(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var s=e[n],a=s.event;s=s.listeners;e:{var u=void 0;if(t)for(var f=s.length-1;0<=f;f--){var _=s[f],r=_.instance,C=_.currentTarget;if(_=_.listener,r!==u&&a.isPropagationStopped())break e;XD(a,_,C),u=r}else for(f=0;f<s.length;f++){if(_=s[f],r=_.instance,C=_.currentTarget,_=_.listener,r!==u&&a.isPropagationStopped())break e;XD(a,_,C),u=r}}}if(CS)throw e=uM,CS=!1,uM=null,e}function fs(e,t){var n=t[vM];n===void 0&&(n=t[vM]=new Set);var s=e+"__bubble";n.has(s)||($B(t,e,2,!1),n.add(s))}function XI(e,t,n){var s=0;t&&(s|=4),$B(n,e,s,t)}var sw="_reactListening"+Math.random().toString(36).slice(2);function xx(e){if(!e[sw]){e[sw]=!0,YN.forEach(function(n){n!=="selectionchange"&&(Z7.has(n)||XI(n,!1,e),XI(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[sw]||(t[sw]=!0,XI("selectionchange",!1,t))}}function $B(e,t,n,s){switch(EB(t)){case 1:var a=c7;break;case 4:a=d7;break;default:a=o2}n=a.bind(null,t,n,e),a=void 0,!lM||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),s?a!==void 0?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):a!==void 0?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function YI(e,t,n,s,a){var u=s;if(!(t&1)&&!(t&2)&&s!==null)e:for(;;){if(s===null)return;var f=s.tag;if(f===3||f===4){var _=s.stateNode.containerInfo;if(_===a||_.nodeType===8&&_.parentNode===a)break;if(f===4)for(f=s.return;f!==null;){var r=f.tag;if((r===3||r===4)&&(r=f.stateNode.containerInfo,r===a||r.nodeType===8&&r.parentNode===a))return;f=f.return}for(;_!==null;){if(f=lm(_),f===null)return;if(r=f.tag,r===5||r===6){s=u=f;continue e}_=_.parentNode}}s=s.return}dB(function(){var C=u,k=t2(n),I=[];e:{var P=jB.get(e);if(P!==void 0){var D=a2,N=e;switch(e){case"keypress":if(Qw(n)===0)break e;case"keydown":case"keyup":D=T7;break;case"focusin":N="focus",D=$I;break;case"focusout":N="blur",D=$I;break;case"beforeblur":case"afterblur":D=$I;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":D=zD;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":D=p7;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":D=M7;break;case zB:case FB:case NB:D=y7;break;case BB:D=A7;break;case"scroll":D=h7;break;case"wheel":D=R7;break;case"copy":case"cut":case"paste":D=v7;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":D=ND}var j=(t&4)!==0,W=!j&&e==="scroll",H=j?P!==null?P+"Capture":null:P;j=[];for(var q=C,Z;q!==null;){Z=q;var re=Z.stateNode;if(Z.tag===5&&re!==null&&(Z=re,H!==null&&(re=px(q,H),re!=null&&j.push(bx(q,re,Z)))),W)break;q=q.return}0<j.length&&(P=new D(P,N,null,n,k),I.push({event:P,listeners:j}))}}if(!(t&7)){e:{if(P=e==="mouseover"||e==="pointerover",D=e==="mouseout"||e==="pointerout",P&&n!==sM&&(N=n.relatedTarget||n.fromElement)&&(lm(N)||N[Rh]))break e;if((D||P)&&(P=k.window===k?k:(P=k.ownerDocument)?P.defaultView||P.parentWindow:window,D?(N=n.relatedTarget||n.toElement,D=C,N=N?lm(N):null,N!==null&&(W=Dm(N),N!==W||N.tag!==5&&N.tag!==6)&&(N=null)):(D=null,N=C),D!==N)){if(j=zD,re="onMouseLeave",H="onMouseEnter",q="mouse",(e==="pointerout"||e==="pointerover")&&(j=ND,re="onPointerLeave",H="onPointerEnter",q="pointer"),W=D==null?P:hy(D),Z=N==null?P:hy(N),P=new j(re,q+"leave",D,n,k),P.target=W,P.relatedTarget=Z,re=null,lm(k)===C&&(j=new j(H,q+"enter",N,n,k),j.target=Z,j.relatedTarget=W,re=j),W=re,D&&N)t:{for(j=D,H=N,q=0,Z=j;Z;Z=zg(Z))q++;for(Z=0,re=H;re;re=zg(re))Z++;for(;0<q-Z;)j=zg(j),q--;for(;0<Z-q;)H=zg(H),Z--;for(;q--;){if(j===H||H!==null&&j===H.alternate)break t;j=zg(j),H=zg(H)}j=null}else j=null;D!==null&&YD(I,P,D,j,!1),N!==null&&W!==null&&YD(I,W,N,j,!0)}}e:{if(P=C?hy(C):window,D=P.nodeName&&P.nodeName.toLowerCase(),D==="select"||D==="input"&&P.type==="file")var le=j7;else if(VD(P))if(AB)le=G7;else{le=$7;var _e=V7}else(D=P.nodeName)&&D.toLowerCase()==="input"&&(P.type==="checkbox"||P.type==="radio")&&(le=U7);if(le&&(le=le(e,C))){PB(I,le,n,k);break e}_e&&_e(e,P,C),e==="focusout"&&(_e=P._wrapperState)&&_e.controlled&&P.type==="number"&&tM(P,"number",P.value)}switch(_e=C?hy(C):window,e){case"focusin":(VD(_e)||_e.contentEditable==="true")&&(cy=_e,fM=C,ex=null);break;case"focusout":ex=fM=cy=null;break;case"mousedown":pM=!0;break;case"contextmenu":case"mouseup":case"dragend":pM=!1,WD(I,n,k);break;case"selectionchange":if(q7)break;case"keydown":case"keyup":WD(I,n,k)}var ye;if(u2)e:{switch(e){case"compositionstart":var de="onCompositionStart";break e;case"compositionend":de="onCompositionEnd";break e;case"compositionupdate":de="onCompositionUpdate";break e}de=void 0}else uy?kB(e,n)&&(de="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(de="onCompositionStart");de&&(IB&&n.locale!=="ko"&&(uy||de!=="onCompositionStart"?de==="onCompositionEnd"&&uy&&(ye=TB()):(Bf=k,s2="value"in Bf?Bf.value:Bf.textContent,uy=!0)),_e=MS(C,de),0<_e.length&&(de=new FD(de,e,null,n,k),I.push({event:de,listeners:_e}),ye?de.data=ye:(ye=MB(n),ye!==null&&(de.data=ye)))),(ye=D7?z7(e,n):F7(e,n))&&(C=MS(C,"onBeforeInput"),0<C.length&&(k=new FD("onBeforeInput","beforeinput",null,n,k),I.push({event:k,listeners:C}),k.data=ye))}VB(I,t)})}function bx(e,t,n){return{instance:e,listener:t,currentTarget:n}}function MS(e,t){for(var n=t+"Capture",s=[];e!==null;){var a=e,u=a.stateNode;a.tag===5&&u!==null&&(a=u,u=px(e,n),u!=null&&s.unshift(bx(e,u,a)),u=px(e,t),u!=null&&s.push(bx(e,u,a))),e=e.return}return s}function zg(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function YD(e,t,n,s,a){for(var u=t._reactName,f=[];n!==null&&n!==s;){var _=n,r=_.alternate,C=_.stateNode;if(r!==null&&r===s)break;_.tag===5&&C!==null&&(_=C,a?(r=px(n,u),r!=null&&f.unshift(bx(n,r,_))):a||(r=px(n,u),r!=null&&f.push(bx(n,r,_)))),n=n.return}f.length!==0&&e.push({event:t,listeners:f})}var K7=/\r\n?/g,J7=/\u0000|\uFFFD/g;function ZD(e){return(typeof e=="string"?e:""+e).replace(K7,`
`).replace(J7,"")}function aw(e,t,n){if(t=ZD(t),ZD(e)!==t&&n)throw Error(fr(425))}function PS(){}var mM=null,gM=null;function yM(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var _M=typeof setTimeout=="function"?setTimeout:void 0,Q7=typeof clearTimeout=="function"?clearTimeout:void 0,KD=typeof Promise=="function"?Promise:void 0,eH=typeof queueMicrotask=="function"?queueMicrotask:typeof KD<"u"?function(e){return KD.resolve(null).then(e).catch(tH)}:_M;function tH(e){setTimeout(function(){throw e})}function ZI(e,t){var n=t,s=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&a.nodeType===8)if(n=a.data,n==="/$"){if(s===0){e.removeChild(a),yx(t);return}s--}else n!=="$"&&n!=="$?"&&n!=="$!"||s++;n=a}while(n);yx(t)}function qf(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function JD(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var g0=Math.random().toString(36).slice(2),Dd="__reactFiber$"+g0,wx="__reactProps$"+g0,Rh="__reactContainer$"+g0,vM="__reactEvents$"+g0,nH="__reactListeners$"+g0,rH="__reactHandles$"+g0;function lm(e){var t=e[Dd];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Rh]||n[Dd]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=JD(e);e!==null;){if(n=e[Dd])return n;e=JD(e)}return t}e=n,n=e.parentNode}return null}function e1(e){return e=e[Dd]||e[Rh],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function hy(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(fr(33))}function RC(e){return e[wx]||null}var xM=[],fy=-1;function pp(e){return{current:e}}function ps(e){0>fy||(e.current=xM[fy],xM[fy]=null,fy--)}function as(e,t){fy++,xM[fy]=e.current,e.current=t}var np={},yl=pp(np),eu=pp(!1),xm=np;function $y(e,t){var n=e.type.contextTypes;if(!n)return np;var s=e.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===t)return s.__reactInternalMemoizedMaskedChildContext;var a={},u;for(u in n)a[u]=t[u];return s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function tu(e){return e=e.childContextTypes,e!=null}function AS(){ps(eu),ps(yl)}function QD(e,t,n){if(yl.current!==np)throw Error(fr(168));as(yl,t),as(eu,n)}function UB(e,t,n){var s=e.stateNode;if(t=t.childContextTypes,typeof s.getChildContext!="function")return n;s=s.getChildContext();for(var a in s)if(!(a in t))throw Error(fr(108,V9(e)||"Unknown",a));return Ls({},n,s)}function LS(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||np,xm=yl.current,as(yl,e),as(eu,eu.current),!0}function e5(e,t,n){var s=e.stateNode;if(!s)throw Error(fr(169));n?(e=UB(e,t,xm),s.__reactInternalMemoizedMergedChildContext=e,ps(eu),ps(yl),as(yl,e)):ps(eu),as(eu,n)}var Sh=null,OC=!1,KI=!1;function GB(e){Sh===null?Sh=[e]:Sh.push(e)}function iH(e){OC=!0,GB(e)}function mp(){if(!KI&&Sh!==null){KI=!0;var e=0,t=Ao;try{var n=Sh;for(Ao=1;e<n.length;e++){var s=n[e];do s=s(!0);while(s!==null)}Sh=null,OC=!1}catch(a){throw Sh!==null&&(Sh=Sh.slice(e+1)),mB(n2,mp),a}finally{Ao=t,KI=!1}}return null}var py=[],my=0,RS=null,OS=0,nc=[],rc=0,bm=null,Ch=1,Eh="";function tm(e,t){py[my++]=OS,py[my++]=RS,RS=e,OS=t}function HB(e,t,n){nc[rc++]=Ch,nc[rc++]=Eh,nc[rc++]=bm,bm=e;var s=Ch;e=Eh;var a=32-Kc(s)-1;s&=~(1<<a),n+=1;var u=32-Kc(t)+a;if(30<u){var f=a-a%5;u=(s&(1<<f)-1).toString(32),s>>=f,a-=f,Ch=1<<32-Kc(t)+a|n<<a|s,Eh=u+e}else Ch=1<<u|n<<a|s,Eh=e}function d2(e){e.return!==null&&(tm(e,1),HB(e,1,0))}function h2(e){for(;e===RS;)RS=py[--my],py[my]=null,OS=py[--my],py[my]=null;for(;e===bm;)bm=nc[--rc],nc[rc]=null,Eh=nc[--rc],nc[rc]=null,Ch=nc[--rc],nc[rc]=null}var Tu=null,Cu=null,xs=!1,Hc=null;function WB(e,t){var n=sc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function t5(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Tu=e,Cu=qf(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Tu=e,Cu=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=bm!==null?{id:Ch,overflow:Eh}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=sc(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Tu=e,Cu=null,!0):!1;default:return!1}}function bM(e){return(e.mode&1)!==0&&(e.flags&128)===0}function wM(e){if(xs){var t=Cu;if(t){var n=t;if(!t5(e,t)){if(bM(e))throw Error(fr(418));t=qf(n.nextSibling);var s=Tu;t&&t5(e,t)?WB(s,n):(e.flags=e.flags&-4097|2,xs=!1,Tu=e)}}else{if(bM(e))throw Error(fr(418));e.flags=e.flags&-4097|2,xs=!1,Tu=e}}}function n5(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Tu=e}function lw(e){if(e!==Tu)return!1;if(!xs)return n5(e),xs=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!yM(e.type,e.memoizedProps)),t&&(t=Cu)){if(bM(e))throw qB(),Error(fr(418));for(;t;)WB(e,t),t=qf(t.nextSibling)}if(n5(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(fr(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Cu=qf(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Cu=null}}else Cu=Tu?qf(e.stateNode.nextSibling):null;return!0}function qB(){for(var e=Cu;e;)e=qf(e.nextSibling)}function Uy(){Cu=Tu=null,xs=!1}function f2(e){Hc===null?Hc=[e]:Hc.push(e)}var oH=Vh.ReactCurrentBatchConfig;function ov(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(fr(309));var s=n.stateNode}if(!s)throw Error(fr(147,e));var a=s,u=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===u?t.ref:(t=function(f){var _=a.refs;f===null?delete _[u]:_[u]=f},t._stringRef=u,t)}if(typeof e!="string")throw Error(fr(284));if(!n._owner)throw Error(fr(290,e))}return e}function uw(e,t){throw e=Object.prototype.toString.call(t),Error(fr(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function r5(e){var t=e._init;return t(e._payload)}function XB(e){function t(H,q){if(e){var Z=H.deletions;Z===null?(H.deletions=[q],H.flags|=16):Z.push(q)}}function n(H,q){if(!e)return null;for(;q!==null;)t(H,q),q=q.sibling;return null}function s(H,q){for(H=new Map;q!==null;)q.key!==null?H.set(q.key,q):H.set(q.index,q),q=q.sibling;return H}function a(H,q){return H=Kf(H,q),H.index=0,H.sibling=null,H}function u(H,q,Z){return H.index=Z,e?(Z=H.alternate,Z!==null?(Z=Z.index,Z<q?(H.flags|=2,q):Z):(H.flags|=2,q)):(H.flags|=1048576,q)}function f(H){return e&&H.alternate===null&&(H.flags|=2),H}function _(H,q,Z,re){return q===null||q.tag!==6?(q=ik(Z,H.mode,re),q.return=H,q):(q=a(q,Z),q.return=H,q)}function r(H,q,Z,re){var le=Z.type;return le===ly?k(H,q,Z.props.children,re,Z.key):q!==null&&(q.elementType===le||typeof le=="object"&&le!==null&&le.$$typeof===Af&&r5(le)===q.type)?(re=a(q,Z.props),re.ref=ov(H,q,Z),re.return=H,re):(re=sS(Z.type,Z.key,Z.props,null,H.mode,re),re.ref=ov(H,q,Z),re.return=H,re)}function C(H,q,Z,re){return q===null||q.tag!==4||q.stateNode.containerInfo!==Z.containerInfo||q.stateNode.implementation!==Z.implementation?(q=ok(Z,H.mode,re),q.return=H,q):(q=a(q,Z.children||[]),q.return=H,q)}function k(H,q,Z,re,le){return q===null||q.tag!==7?(q=mm(Z,H.mode,re,le),q.return=H,q):(q=a(q,Z),q.return=H,q)}function I(H,q,Z){if(typeof q=="string"&&q!==""||typeof q=="number")return q=ik(""+q,H.mode,Z),q.return=H,q;if(typeof q=="object"&&q!==null){switch(q.$$typeof){case Jb:return Z=sS(q.type,q.key,q.props,null,H.mode,Z),Z.ref=ov(H,null,q),Z.return=H,Z;case ay:return q=ok(q,H.mode,Z),q.return=H,q;case Af:var re=q._init;return I(H,re(q._payload),Z)}if(zv(q)||ev(q))return q=mm(q,H.mode,Z,null),q.return=H,q;uw(H,q)}return null}function P(H,q,Z,re){var le=q!==null?q.key:null;if(typeof Z=="string"&&Z!==""||typeof Z=="number")return le!==null?null:_(H,q,""+Z,re);if(typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case Jb:return Z.key===le?r(H,q,Z,re):null;case ay:return Z.key===le?C(H,q,Z,re):null;case Af:return le=Z._init,P(H,q,le(Z._payload),re)}if(zv(Z)||ev(Z))return le!==null?null:k(H,q,Z,re,null);uw(H,Z)}return null}function D(H,q,Z,re,le){if(typeof re=="string"&&re!==""||typeof re=="number")return H=H.get(Z)||null,_(q,H,""+re,le);if(typeof re=="object"&&re!==null){switch(re.$$typeof){case Jb:return H=H.get(re.key===null?Z:re.key)||null,r(q,H,re,le);case ay:return H=H.get(re.key===null?Z:re.key)||null,C(q,H,re,le);case Af:var _e=re._init;return D(H,q,Z,_e(re._payload),le)}if(zv(re)||ev(re))return H=H.get(Z)||null,k(q,H,re,le,null);uw(q,re)}return null}function N(H,q,Z,re){for(var le=null,_e=null,ye=q,de=q=0,ce=null;ye!==null&&de<Z.length;de++){ye.index>de?(ce=ye,ye=null):ce=ye.sibling;var oe=P(H,ye,Z[de],re);if(oe===null){ye===null&&(ye=ce);break}e&&ye&&oe.alternate===null&&t(H,ye),q=u(oe,q,de),_e===null?le=oe:_e.sibling=oe,_e=oe,ye=ce}if(de===Z.length)return n(H,ye),xs&&tm(H,de),le;if(ye===null){for(;de<Z.length;de++)ye=I(H,Z[de],re),ye!==null&&(q=u(ye,q,de),_e===null?le=ye:_e.sibling=ye,_e=ye);return xs&&tm(H,de),le}for(ye=s(H,ye);de<Z.length;de++)ce=D(ye,H,de,Z[de],re),ce!==null&&(e&&ce.alternate!==null&&ye.delete(ce.key===null?de:ce.key),q=u(ce,q,de),_e===null?le=ce:_e.sibling=ce,_e=ce);return e&&ye.forEach(function(xe){return t(H,xe)}),xs&&tm(H,de),le}function j(H,q,Z,re){var le=ev(Z);if(typeof le!="function")throw Error(fr(150));if(Z=le.call(Z),Z==null)throw Error(fr(151));for(var _e=le=null,ye=q,de=q=0,ce=null,oe=Z.next();ye!==null&&!oe.done;de++,oe=Z.next()){ye.index>de?(ce=ye,ye=null):ce=ye.sibling;var xe=P(H,ye,oe.value,re);if(xe===null){ye===null&&(ye=ce);break}e&&ye&&xe.alternate===null&&t(H,ye),q=u(xe,q,de),_e===null?le=xe:_e.sibling=xe,_e=xe,ye=ce}if(oe.done)return n(H,ye),xs&&tm(H,de),le;if(ye===null){for(;!oe.done;de++,oe=Z.next())oe=I(H,oe.value,re),oe!==null&&(q=u(oe,q,de),_e===null?le=oe:_e.sibling=oe,_e=oe);return xs&&tm(H,de),le}for(ye=s(H,ye);!oe.done;de++,oe=Z.next())oe=D(ye,H,de,oe.value,re),oe!==null&&(e&&oe.alternate!==null&&ye.delete(oe.key===null?de:oe.key),q=u(oe,q,de),_e===null?le=oe:_e.sibling=oe,_e=oe);return e&&ye.forEach(function(he){return t(H,he)}),xs&&tm(H,de),le}function W(H,q,Z,re){if(typeof Z=="object"&&Z!==null&&Z.type===ly&&Z.key===null&&(Z=Z.props.children),typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case Jb:e:{for(var le=Z.key,_e=q;_e!==null;){if(_e.key===le){if(le=Z.type,le===ly){if(_e.tag===7){n(H,_e.sibling),q=a(_e,Z.props.children),q.return=H,H=q;break e}}else if(_e.elementType===le||typeof le=="object"&&le!==null&&le.$$typeof===Af&&r5(le)===_e.type){n(H,_e.sibling),q=a(_e,Z.props),q.ref=ov(H,_e,Z),q.return=H,H=q;break e}n(H,_e);break}else t(H,_e);_e=_e.sibling}Z.type===ly?(q=mm(Z.props.children,H.mode,re,Z.key),q.return=H,H=q):(re=sS(Z.type,Z.key,Z.props,null,H.mode,re),re.ref=ov(H,q,Z),re.return=H,H=re)}return f(H);case ay:e:{for(_e=Z.key;q!==null;){if(q.key===_e)if(q.tag===4&&q.stateNode.containerInfo===Z.containerInfo&&q.stateNode.implementation===Z.implementation){n(H,q.sibling),q=a(q,Z.children||[]),q.return=H,H=q;break e}else{n(H,q);break}else t(H,q);q=q.sibling}q=ok(Z,H.mode,re),q.return=H,H=q}return f(H);case Af:return _e=Z._init,W(H,q,_e(Z._payload),re)}if(zv(Z))return N(H,q,Z,re);if(ev(Z))return j(H,q,Z,re);uw(H,Z)}return typeof Z=="string"&&Z!==""||typeof Z=="number"?(Z=""+Z,q!==null&&q.tag===6?(n(H,q.sibling),q=a(q,Z),q.return=H,H=q):(n(H,q),q=ik(Z,H.mode,re),q.return=H,H=q),f(H)):n(H,q)}return W}var Gy=XB(!0),YB=XB(!1),DS=pp(null),zS=null,gy=null,p2=null;function m2(){p2=gy=zS=null}function g2(e){var t=DS.current;ps(DS),e._currentValue=t}function SM(e,t,n){for(;e!==null;){var s=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,s!==null&&(s.childLanes|=t)):s!==null&&(s.childLanes&t)!==t&&(s.childLanes|=t),e===n)break;e=e.return}}function My(e,t){zS=e,p2=gy=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Jl=!0),e.firstContext=null)}function hc(e){var t=e._currentValue;if(p2!==e)if(e={context:e,memoizedValue:t,next:null},gy===null){if(zS===null)throw Error(fr(308));gy=e,zS.dependencies={lanes:0,firstContext:e}}else gy=gy.next=e;return t}var um=null;function y2(e){um===null?um=[e]:um.push(e)}function ZB(e,t,n,s){var a=t.interleaved;return a===null?(n.next=n,y2(t)):(n.next=a.next,a.next=n),t.interleaved=n,Oh(e,s)}function Oh(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Lf=!1;function _2(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function KB(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ih(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Xf(e,t,n){var s=e.updateQueue;if(s===null)return null;if(s=s.shared,po&2){var a=s.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),s.pending=t,Oh(e,n)}return a=s.interleaved,a===null?(t.next=t,y2(s)):(t.next=a.next,a.next=t),s.interleaved=t,Oh(e,n)}function eS(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var s=t.lanes;s&=e.pendingLanes,n|=s,t.lanes=n,r2(e,n)}}function i5(e,t){var n=e.updateQueue,s=e.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var a=null,u=null;if(n=n.firstBaseUpdate,n!==null){do{var f={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};u===null?a=u=f:u=u.next=f,n=n.next}while(n!==null);u===null?a=u=t:u=u.next=t}else a=u=t;n={baseState:s.baseState,firstBaseUpdate:a,lastBaseUpdate:u,shared:s.shared,effects:s.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function FS(e,t,n,s){var a=e.updateQueue;Lf=!1;var u=a.firstBaseUpdate,f=a.lastBaseUpdate,_=a.shared.pending;if(_!==null){a.shared.pending=null;var r=_,C=r.next;r.next=null,f===null?u=C:f.next=C,f=r;var k=e.alternate;k!==null&&(k=k.updateQueue,_=k.lastBaseUpdate,_!==f&&(_===null?k.firstBaseUpdate=C:_.next=C,k.lastBaseUpdate=r))}if(u!==null){var I=a.baseState;f=0,k=C=r=null,_=u;do{var P=_.lane,D=_.eventTime;if((s&P)===P){k!==null&&(k=k.next={eventTime:D,lane:0,tag:_.tag,payload:_.payload,callback:_.callback,next:null});e:{var N=e,j=_;switch(P=t,D=n,j.tag){case 1:if(N=j.payload,typeof N=="function"){I=N.call(D,I,P);break e}I=N;break e;case 3:N.flags=N.flags&-65537|128;case 0:if(N=j.payload,P=typeof N=="function"?N.call(D,I,P):N,P==null)break e;I=Ls({},I,P);break e;case 2:Lf=!0}}_.callback!==null&&_.lane!==0&&(e.flags|=64,P=a.effects,P===null?a.effects=[_]:P.push(_))}else D={eventTime:D,lane:P,tag:_.tag,payload:_.payload,callback:_.callback,next:null},k===null?(C=k=D,r=I):k=k.next=D,f|=P;if(_=_.next,_===null){if(_=a.shared.pending,_===null)break;P=_,_=P.next,P.next=null,a.lastBaseUpdate=P,a.shared.pending=null}}while(!0);if(k===null&&(r=I),a.baseState=r,a.firstBaseUpdate=C,a.lastBaseUpdate=k,t=a.shared.interleaved,t!==null){a=t;do f|=a.lane,a=a.next;while(a!==t)}else u===null&&(a.shared.lanes=0);Sm|=f,e.lanes=f,e.memoizedState=I}}function o5(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var s=e[t],a=s.callback;if(a!==null){if(s.callback=null,s=n,typeof a!="function")throw Error(fr(191,a));a.call(s)}}}var t1={},Vd=pp(t1),Sx=pp(t1),Cx=pp(t1);function cm(e){if(e===t1)throw Error(fr(174));return e}function v2(e,t){switch(as(Cx,t),as(Sx,e),as(Vd,t1),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:rM(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=rM(t,e)}ps(Vd),as(Vd,t)}function Hy(){ps(Vd),ps(Sx),ps(Cx)}function JB(e){cm(Cx.current);var t=cm(Vd.current),n=rM(t,e.type);t!==n&&(as(Sx,e),as(Vd,n))}function x2(e){Sx.current===e&&(ps(Vd),ps(Sx))}var Ts=pp(0);function NS(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var JI=[];function b2(){for(var e=0;e<JI.length;e++)JI[e]._workInProgressVersionPrimary=null;JI.length=0}var tS=Vh.ReactCurrentDispatcher,QI=Vh.ReactCurrentBatchConfig,wm=0,Ps=null,pa=null,Ea=null,BS=!1,tx=!1,Ex=0,sH=0;function il(){throw Error(fr(321))}function w2(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!td(e[n],t[n]))return!1;return!0}function S2(e,t,n,s,a,u){if(wm=u,Ps=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,tS.current=e===null||e.memoizedState===null?cH:dH,e=n(s,a),tx){u=0;do{if(tx=!1,Ex=0,25<=u)throw Error(fr(301));u+=1,Ea=pa=null,t.updateQueue=null,tS.current=hH,e=n(s,a)}while(tx)}if(tS.current=jS,t=pa!==null&&pa.next!==null,wm=0,Ea=pa=Ps=null,BS=!1,t)throw Error(fr(300));return e}function C2(){var e=Ex!==0;return Ex=0,e}function Pd(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ea===null?Ps.memoizedState=Ea=e:Ea=Ea.next=e,Ea}function fc(){if(pa===null){var e=Ps.alternate;e=e!==null?e.memoizedState:null}else e=pa.next;var t=Ea===null?Ps.memoizedState:Ea.next;if(t!==null)Ea=t,pa=e;else{if(e===null)throw Error(fr(310));pa=e,e={memoizedState:pa.memoizedState,baseState:pa.baseState,baseQueue:pa.baseQueue,queue:pa.queue,next:null},Ea===null?Ps.memoizedState=Ea=e:Ea=Ea.next=e}return Ea}function Tx(e,t){return typeof t=="function"?t(e):t}function ek(e){var t=fc(),n=t.queue;if(n===null)throw Error(fr(311));n.lastRenderedReducer=e;var s=pa,a=s.baseQueue,u=n.pending;if(u!==null){if(a!==null){var f=a.next;a.next=u.next,u.next=f}s.baseQueue=a=u,n.pending=null}if(a!==null){u=a.next,s=s.baseState;var _=f=null,r=null,C=u;do{var k=C.lane;if((wm&k)===k)r!==null&&(r=r.next={lane:0,action:C.action,hasEagerState:C.hasEagerState,eagerState:C.eagerState,next:null}),s=C.hasEagerState?C.eagerState:e(s,C.action);else{var I={lane:k,action:C.action,hasEagerState:C.hasEagerState,eagerState:C.eagerState,next:null};r===null?(_=r=I,f=s):r=r.next=I,Ps.lanes|=k,Sm|=k}C=C.next}while(C!==null&&C!==u);r===null?f=s:r.next=_,td(s,t.memoizedState)||(Jl=!0),t.memoizedState=s,t.baseState=f,t.baseQueue=r,n.lastRenderedState=s}if(e=n.interleaved,e!==null){a=e;do u=a.lane,Ps.lanes|=u,Sm|=u,a=a.next;while(a!==e)}else a===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function tk(e){var t=fc(),n=t.queue;if(n===null)throw Error(fr(311));n.lastRenderedReducer=e;var s=n.dispatch,a=n.pending,u=t.memoizedState;if(a!==null){n.pending=null;var f=a=a.next;do u=e(u,f.action),f=f.next;while(f!==a);td(u,t.memoizedState)||(Jl=!0),t.memoizedState=u,t.baseQueue===null&&(t.baseState=u),n.lastRenderedState=u}return[u,s]}function QB(){}function e6(e,t){var n=Ps,s=fc(),a=t(),u=!td(s.memoizedState,a);if(u&&(s.memoizedState=a,Jl=!0),s=s.queue,E2(r6.bind(null,n,s,e),[e]),s.getSnapshot!==t||u||Ea!==null&&Ea.memoizedState.tag&1){if(n.flags|=2048,Ix(9,n6.bind(null,n,s,a,t),void 0,null),Ia===null)throw Error(fr(349));wm&30||t6(n,t,a)}return a}function t6(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Ps.updateQueue,t===null?(t={lastEffect:null,stores:null},Ps.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function n6(e,t,n,s){t.value=n,t.getSnapshot=s,i6(t)&&o6(e)}function r6(e,t,n){return n(function(){i6(t)&&o6(e)})}function i6(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!td(e,n)}catch{return!0}}function o6(e){var t=Oh(e,1);t!==null&&Jc(t,e,1,-1)}function s5(e){var t=Pd();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Tx,lastRenderedState:e},t.queue=e,e=e.dispatch=uH.bind(null,Ps,e),[t.memoizedState,e]}function Ix(e,t,n,s){return e={tag:e,create:t,destroy:n,deps:s,next:null},t=Ps.updateQueue,t===null?(t={lastEffect:null,stores:null},Ps.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(s=n.next,n.next=e,e.next=s,t.lastEffect=e)),e}function s6(){return fc().memoizedState}function nS(e,t,n,s){var a=Pd();Ps.flags|=e,a.memoizedState=Ix(1|t,n,void 0,s===void 0?null:s)}function DC(e,t,n,s){var a=fc();s=s===void 0?null:s;var u=void 0;if(pa!==null){var f=pa.memoizedState;if(u=f.destroy,s!==null&&w2(s,f.deps)){a.memoizedState=Ix(t,n,u,s);return}}Ps.flags|=e,a.memoizedState=Ix(1|t,n,u,s)}function a5(e,t){return nS(8390656,8,e,t)}function E2(e,t){return DC(2048,8,e,t)}function a6(e,t){return DC(4,2,e,t)}function l6(e,t){return DC(4,4,e,t)}function u6(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function c6(e,t,n){return n=n!=null?n.concat([e]):null,DC(4,4,u6.bind(null,t,e),n)}function T2(){}function d6(e,t){var n=fc();t=t===void 0?null:t;var s=n.memoizedState;return s!==null&&t!==null&&w2(t,s[1])?s[0]:(n.memoizedState=[e,t],e)}function h6(e,t){var n=fc();t=t===void 0?null:t;var s=n.memoizedState;return s!==null&&t!==null&&w2(t,s[1])?s[0]:(e=e(),n.memoizedState=[e,t],e)}function f6(e,t,n){return wm&21?(td(n,t)||(n=_B(),Ps.lanes|=n,Sm|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Jl=!0),e.memoizedState=n)}function aH(e,t){var n=Ao;Ao=n!==0&&4>n?n:4,e(!0);var s=QI.transition;QI.transition={};try{e(!1),t()}finally{Ao=n,QI.transition=s}}function p6(){return fc().memoizedState}function lH(e,t,n){var s=Zf(e);if(n={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null},m6(e))g6(t,n);else if(n=ZB(e,t,n,s),n!==null){var a=Ol();Jc(n,e,s,a),y6(n,t,s)}}function uH(e,t,n){var s=Zf(e),a={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null};if(m6(e))g6(t,a);else{var u=e.alternate;if(e.lanes===0&&(u===null||u.lanes===0)&&(u=t.lastRenderedReducer,u!==null))try{var f=t.lastRenderedState,_=u(f,n);if(a.hasEagerState=!0,a.eagerState=_,td(_,f)){var r=t.interleaved;r===null?(a.next=a,y2(t)):(a.next=r.next,r.next=a),t.interleaved=a;return}}catch{}finally{}n=ZB(e,t,a,s),n!==null&&(a=Ol(),Jc(n,e,s,a),y6(n,t,s))}}function m6(e){var t=e.alternate;return e===Ps||t!==null&&t===Ps}function g6(e,t){tx=BS=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function y6(e,t,n){if(n&4194240){var s=t.lanes;s&=e.pendingLanes,n|=s,t.lanes=n,r2(e,n)}}var jS={readContext:hc,useCallback:il,useContext:il,useEffect:il,useImperativeHandle:il,useInsertionEffect:il,useLayoutEffect:il,useMemo:il,useReducer:il,useRef:il,useState:il,useDebugValue:il,useDeferredValue:il,useTransition:il,useMutableSource:il,useSyncExternalStore:il,useId:il,unstable_isNewReconciler:!1},cH={readContext:hc,useCallback:function(e,t){return Pd().memoizedState=[e,t===void 0?null:t],e},useContext:hc,useEffect:a5,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,nS(4194308,4,u6.bind(null,t,e),n)},useLayoutEffect:function(e,t){return nS(4194308,4,e,t)},useInsertionEffect:function(e,t){return nS(4,2,e,t)},useMemo:function(e,t){var n=Pd();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var s=Pd();return t=n!==void 0?n(t):t,s.memoizedState=s.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},s.queue=e,e=e.dispatch=lH.bind(null,Ps,e),[s.memoizedState,e]},useRef:function(e){var t=Pd();return e={current:e},t.memoizedState=e},useState:s5,useDebugValue:T2,useDeferredValue:function(e){return Pd().memoizedState=e},useTransition:function(){var e=s5(!1),t=e[0];return e=aH.bind(null,e[1]),Pd().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var s=Ps,a=Pd();if(xs){if(n===void 0)throw Error(fr(407));n=n()}else{if(n=t(),Ia===null)throw Error(fr(349));wm&30||t6(s,t,n)}a.memoizedState=n;var u={value:n,getSnapshot:t};return a.queue=u,a5(r6.bind(null,s,u,e),[e]),s.flags|=2048,Ix(9,n6.bind(null,s,u,n,t),void 0,null),n},useId:function(){var e=Pd(),t=Ia.identifierPrefix;if(xs){var n=Eh,s=Ch;n=(s&~(1<<32-Kc(s)-1)).toString(32)+n,t=":"+t+"R"+n,n=Ex++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=sH++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},dH={readContext:hc,useCallback:d6,useContext:hc,useEffect:E2,useImperativeHandle:c6,useInsertionEffect:a6,useLayoutEffect:l6,useMemo:h6,useReducer:ek,useRef:s6,useState:function(){return ek(Tx)},useDebugValue:T2,useDeferredValue:function(e){var t=fc();return f6(t,pa.memoizedState,e)},useTransition:function(){var e=ek(Tx)[0],t=fc().memoizedState;return[e,t]},useMutableSource:QB,useSyncExternalStore:e6,useId:p6,unstable_isNewReconciler:!1},hH={readContext:hc,useCallback:d6,useContext:hc,useEffect:E2,useImperativeHandle:c6,useInsertionEffect:a6,useLayoutEffect:l6,useMemo:h6,useReducer:tk,useRef:s6,useState:function(){return tk(Tx)},useDebugValue:T2,useDeferredValue:function(e){var t=fc();return pa===null?t.memoizedState=e:f6(t,pa.memoizedState,e)},useTransition:function(){var e=tk(Tx)[0],t=fc().memoizedState;return[e,t]},useMutableSource:QB,useSyncExternalStore:e6,useId:p6,unstable_isNewReconciler:!1};function $c(e,t){if(e&&e.defaultProps){t=Ls({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function CM(e,t,n,s){t=e.memoizedState,n=n(s,t),n=n==null?t:Ls({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var zC={isMounted:function(e){return(e=e._reactInternals)?Dm(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var s=Ol(),a=Zf(e),u=Ih(s,a);u.payload=t,n!=null&&(u.callback=n),t=Xf(e,u,a),t!==null&&(Jc(t,e,a,s),eS(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var s=Ol(),a=Zf(e),u=Ih(s,a);u.tag=1,u.payload=t,n!=null&&(u.callback=n),t=Xf(e,u,a),t!==null&&(Jc(t,e,a,s),eS(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Ol(),s=Zf(e),a=Ih(n,s);a.tag=2,t!=null&&(a.callback=t),t=Xf(e,a,s),t!==null&&(Jc(t,e,s,n),eS(t,e,s))}};function l5(e,t,n,s,a,u,f){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(s,u,f):t.prototype&&t.prototype.isPureReactComponent?!vx(n,s)||!vx(a,u):!0}function _6(e,t,n){var s=!1,a=np,u=t.contextType;return typeof u=="object"&&u!==null?u=hc(u):(a=tu(t)?xm:yl.current,s=t.contextTypes,u=(s=s!=null)?$y(e,a):np),t=new t(n,u),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=zC,e.stateNode=t,t._reactInternals=e,s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=u),t}function u5(e,t,n,s){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,s),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,s),t.state!==e&&zC.enqueueReplaceState(t,t.state,null)}function EM(e,t,n,s){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs={},_2(e);var u=t.contextType;typeof u=="object"&&u!==null?a.context=hc(u):(u=tu(t)?xm:yl.current,a.context=$y(e,u)),a.state=e.memoizedState,u=t.getDerivedStateFromProps,typeof u=="function"&&(CM(e,t,u,n),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&zC.enqueueReplaceState(a,a.state,null),FS(e,n,a,s),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function Wy(e,t){try{var n="",s=t;do n+=j9(s),s=s.return;while(s);var a=n}catch(u){a=`
Error generating stack: `+u.message+`
`+u.stack}return{value:e,source:t,stack:a,digest:null}}function nk(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function TM(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var fH=typeof WeakMap=="function"?WeakMap:Map;function v6(e,t,n){n=Ih(-1,n),n.tag=3,n.payload={element:null};var s=t.value;return n.callback=function(){$S||($S=!0,zM=s),TM(e,t)},n}function x6(e,t,n){n=Ih(-1,n),n.tag=3;var s=e.type.getDerivedStateFromError;if(typeof s=="function"){var a=t.value;n.payload=function(){return s(a)},n.callback=function(){TM(e,t)}}var u=e.stateNode;return u!==null&&typeof u.componentDidCatch=="function"&&(n.callback=function(){TM(e,t),typeof s!="function"&&(Yf===null?Yf=new Set([this]):Yf.add(this));var f=t.stack;this.componentDidCatch(t.value,{componentStack:f!==null?f:""})}),n}function c5(e,t,n){var s=e.pingCache;if(s===null){s=e.pingCache=new fH;var a=new Set;s.set(t,a)}else a=s.get(t),a===void 0&&(a=new Set,s.set(t,a));a.has(n)||(a.add(n),e=IH.bind(null,e,t,n),t.then(e,e))}function d5(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function h5(e,t,n,s,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Ih(-1,1),t.tag=2,Xf(n,t,1))),n.lanes|=1),e)}var pH=Vh.ReactCurrentOwner,Jl=!1;function Pl(e,t,n,s){t.child=e===null?YB(t,null,n,s):Gy(t,e.child,n,s)}function f5(e,t,n,s,a){n=n.render;var u=t.ref;return My(t,a),s=S2(e,t,n,s,u,a),n=C2(),e!==null&&!Jl?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Dh(e,t,a)):(xs&&n&&d2(t),t.flags|=1,Pl(e,t,s,a),t.child)}function p5(e,t,n,s,a){if(e===null){var u=n.type;return typeof u=="function"&&!O2(u)&&u.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=u,b6(e,t,u,s,a)):(e=sS(n.type,null,s,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(u=e.child,!(e.lanes&a)){var f=u.memoizedProps;if(n=n.compare,n=n!==null?n:vx,n(f,s)&&e.ref===t.ref)return Dh(e,t,a)}return t.flags|=1,e=Kf(u,s),e.ref=t.ref,e.return=t,t.child=e}function b6(e,t,n,s,a){if(e!==null){var u=e.memoizedProps;if(vx(u,s)&&e.ref===t.ref)if(Jl=!1,t.pendingProps=s=u,(e.lanes&a)!==0)e.flags&131072&&(Jl=!0);else return t.lanes=e.lanes,Dh(e,t,a)}return IM(e,t,n,s,a)}function w6(e,t,n){var s=t.pendingProps,a=s.children,u=e!==null?e.memoizedState:null;if(s.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},as(_y,vu),vu|=n;else{if(!(n&1073741824))return e=u!==null?u.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,as(_y,vu),vu|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=u!==null?u.baseLanes:n,as(_y,vu),vu|=s}else u!==null?(s=u.baseLanes|n,t.memoizedState=null):s=n,as(_y,vu),vu|=s;return Pl(e,t,a,n),t.child}function S6(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function IM(e,t,n,s,a){var u=tu(n)?xm:yl.current;return u=$y(t,u),My(t,a),n=S2(e,t,n,s,u,a),s=C2(),e!==null&&!Jl?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Dh(e,t,a)):(xs&&s&&d2(t),t.flags|=1,Pl(e,t,n,a),t.child)}function m5(e,t,n,s,a){if(tu(n)){var u=!0;LS(t)}else u=!1;if(My(t,a),t.stateNode===null)rS(e,t),_6(t,n,s),EM(t,n,s,a),s=!0;else if(e===null){var f=t.stateNode,_=t.memoizedProps;f.props=_;var r=f.context,C=n.contextType;typeof C=="object"&&C!==null?C=hc(C):(C=tu(n)?xm:yl.current,C=$y(t,C));var k=n.getDerivedStateFromProps,I=typeof k=="function"||typeof f.getSnapshotBeforeUpdate=="function";I||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(_!==s||r!==C)&&u5(t,f,s,C),Lf=!1;var P=t.memoizedState;f.state=P,FS(t,s,f,a),r=t.memoizedState,_!==s||P!==r||eu.current||Lf?(typeof k=="function"&&(CM(t,n,k,s),r=t.memoizedState),(_=Lf||l5(t,n,_,s,P,r,C))?(I||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount()),typeof f.componentDidMount=="function"&&(t.flags|=4194308)):(typeof f.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=s,t.memoizedState=r),f.props=s,f.state=r,f.context=C,s=_):(typeof f.componentDidMount=="function"&&(t.flags|=4194308),s=!1)}else{f=t.stateNode,KB(e,t),_=t.memoizedProps,C=t.type===t.elementType?_:$c(t.type,_),f.props=C,I=t.pendingProps,P=f.context,r=n.contextType,typeof r=="object"&&r!==null?r=hc(r):(r=tu(n)?xm:yl.current,r=$y(t,r));var D=n.getDerivedStateFromProps;(k=typeof D=="function"||typeof f.getSnapshotBeforeUpdate=="function")||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(_!==I||P!==r)&&u5(t,f,s,r),Lf=!1,P=t.memoizedState,f.state=P,FS(t,s,f,a);var N=t.memoizedState;_!==I||P!==N||eu.current||Lf?(typeof D=="function"&&(CM(t,n,D,s),N=t.memoizedState),(C=Lf||l5(t,n,C,s,P,N,r)||!1)?(k||typeof f.UNSAFE_componentWillUpdate!="function"&&typeof f.componentWillUpdate!="function"||(typeof f.componentWillUpdate=="function"&&f.componentWillUpdate(s,N,r),typeof f.UNSAFE_componentWillUpdate=="function"&&f.UNSAFE_componentWillUpdate(s,N,r)),typeof f.componentDidUpdate=="function"&&(t.flags|=4),typeof f.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof f.componentDidUpdate!="function"||_===e.memoizedProps&&P===e.memoizedState||(t.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||_===e.memoizedProps&&P===e.memoizedState||(t.flags|=1024),t.memoizedProps=s,t.memoizedState=N),f.props=s,f.state=N,f.context=r,s=C):(typeof f.componentDidUpdate!="function"||_===e.memoizedProps&&P===e.memoizedState||(t.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||_===e.memoizedProps&&P===e.memoizedState||(t.flags|=1024),s=!1)}return kM(e,t,n,s,u,a)}function kM(e,t,n,s,a,u){S6(e,t);var f=(t.flags&128)!==0;if(!s&&!f)return a&&e5(t,n,!1),Dh(e,t,u);s=t.stateNode,pH.current=t;var _=f&&typeof n.getDerivedStateFromError!="function"?null:s.render();return t.flags|=1,e!==null&&f?(t.child=Gy(t,e.child,null,u),t.child=Gy(t,null,_,u)):Pl(e,t,_,u),t.memoizedState=s.state,a&&e5(t,n,!0),t.child}function C6(e){var t=e.stateNode;t.pendingContext?QD(e,t.pendingContext,t.pendingContext!==t.context):t.context&&QD(e,t.context,!1),v2(e,t.containerInfo)}function g5(e,t,n,s,a){return Uy(),f2(a),t.flags|=256,Pl(e,t,n,s),t.child}var MM={dehydrated:null,treeContext:null,retryLane:0};function PM(e){return{baseLanes:e,cachePool:null,transitions:null}}function E6(e,t,n){var s=t.pendingProps,a=Ts.current,u=!1,f=(t.flags&128)!==0,_;if((_=f)||(_=e!==null&&e.memoizedState===null?!1:(a&2)!==0),_?(u=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),as(Ts,a&1),e===null)return wM(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(f=s.children,e=s.fallback,u?(s=t.mode,u=t.child,f={mode:"hidden",children:f},!(s&1)&&u!==null?(u.childLanes=0,u.pendingProps=f):u=BC(f,s,0,null),e=mm(e,s,n,null),u.return=t,e.return=t,u.sibling=e,t.child=u,t.child.memoizedState=PM(n),t.memoizedState=MM,e):I2(t,f));if(a=e.memoizedState,a!==null&&(_=a.dehydrated,_!==null))return mH(e,t,f,s,_,a,n);if(u){u=s.fallback,f=t.mode,a=e.child,_=a.sibling;var r={mode:"hidden",children:s.children};return!(f&1)&&t.child!==a?(s=t.child,s.childLanes=0,s.pendingProps=r,t.deletions=null):(s=Kf(a,r),s.subtreeFlags=a.subtreeFlags&14680064),_!==null?u=Kf(_,u):(u=mm(u,f,n,null),u.flags|=2),u.return=t,s.return=t,s.sibling=u,t.child=s,s=u,u=t.child,f=e.child.memoizedState,f=f===null?PM(n):{baseLanes:f.baseLanes|n,cachePool:null,transitions:f.transitions},u.memoizedState=f,u.childLanes=e.childLanes&~n,t.memoizedState=MM,s}return u=e.child,e=u.sibling,s=Kf(u,{mode:"visible",children:s.children}),!(t.mode&1)&&(s.lanes=n),s.return=t,s.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=s,t.memoizedState=null,s}function I2(e,t){return t=BC({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function cw(e,t,n,s){return s!==null&&f2(s),Gy(t,e.child,null,n),e=I2(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function mH(e,t,n,s,a,u,f){if(n)return t.flags&256?(t.flags&=-257,s=nk(Error(fr(422))),cw(e,t,f,s)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(u=s.fallback,a=t.mode,s=BC({mode:"visible",children:s.children},a,0,null),u=mm(u,a,f,null),u.flags|=2,s.return=t,u.return=t,s.sibling=u,t.child=s,t.mode&1&&Gy(t,e.child,null,f),t.child.memoizedState=PM(f),t.memoizedState=MM,u);if(!(t.mode&1))return cw(e,t,f,null);if(a.data==="$!"){if(s=a.nextSibling&&a.nextSibling.dataset,s)var _=s.dgst;return s=_,u=Error(fr(419)),s=nk(u,s,void 0),cw(e,t,f,s)}if(_=(f&e.childLanes)!==0,Jl||_){if(s=Ia,s!==null){switch(f&-f){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(s.suspendedLanes|f)?0:a,a!==0&&a!==u.retryLane&&(u.retryLane=a,Oh(e,a),Jc(s,e,a,-1))}return R2(),s=nk(Error(fr(421))),cw(e,t,f,s)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=kH.bind(null,e),a._reactRetry=t,null):(e=u.treeContext,Cu=qf(a.nextSibling),Tu=t,xs=!0,Hc=null,e!==null&&(nc[rc++]=Ch,nc[rc++]=Eh,nc[rc++]=bm,Ch=e.id,Eh=e.overflow,bm=t),t=I2(t,s.children),t.flags|=4096,t)}function y5(e,t,n){e.lanes|=t;var s=e.alternate;s!==null&&(s.lanes|=t),SM(e.return,t,n)}function rk(e,t,n,s,a){var u=e.memoizedState;u===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:a}:(u.isBackwards=t,u.rendering=null,u.renderingStartTime=0,u.last=s,u.tail=n,u.tailMode=a)}function T6(e,t,n){var s=t.pendingProps,a=s.revealOrder,u=s.tail;if(Pl(e,t,s.children,n),s=Ts.current,s&2)s=s&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&y5(e,n,t);else if(e.tag===19)y5(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}s&=1}if(as(Ts,s),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;n!==null;)e=n.alternate,e!==null&&NS(e)===null&&(a=n),n=n.sibling;n=a,n===null?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),rk(t,!1,a,n,u);break;case"backwards":for(n=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&NS(e)===null){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}rk(t,!0,n,null,u);break;case"together":rk(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function rS(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Dh(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Sm|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(fr(153));if(t.child!==null){for(e=t.child,n=Kf(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Kf(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function gH(e,t,n){switch(t.tag){case 3:C6(t),Uy();break;case 5:JB(t);break;case 1:tu(t.type)&&LS(t);break;case 4:v2(t,t.stateNode.containerInfo);break;case 10:var s=t.type._context,a=t.memoizedProps.value;as(DS,s._currentValue),s._currentValue=a;break;case 13:if(s=t.memoizedState,s!==null)return s.dehydrated!==null?(as(Ts,Ts.current&1),t.flags|=128,null):n&t.child.childLanes?E6(e,t,n):(as(Ts,Ts.current&1),e=Dh(e,t,n),e!==null?e.sibling:null);as(Ts,Ts.current&1);break;case 19:if(s=(n&t.childLanes)!==0,e.flags&128){if(s)return T6(e,t,n);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),as(Ts,Ts.current),s)break;return null;case 22:case 23:return t.lanes=0,w6(e,t,n)}return Dh(e,t,n)}var I6,AM,k6,M6;I6=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};AM=function(){};k6=function(e,t,n,s){var a=e.memoizedProps;if(a!==s){e=t.stateNode,cm(Vd.current);var u=null;switch(n){case"input":a=Qk(e,a),s=Qk(e,s),u=[];break;case"select":a=Ls({},a,{value:void 0}),s=Ls({},s,{value:void 0}),u=[];break;case"textarea":a=nM(e,a),s=nM(e,s),u=[];break;default:typeof a.onClick!="function"&&typeof s.onClick=="function"&&(e.onclick=PS)}iM(n,s);var f;n=null;for(C in a)if(!s.hasOwnProperty(C)&&a.hasOwnProperty(C)&&a[C]!=null)if(C==="style"){var _=a[C];for(f in _)_.hasOwnProperty(f)&&(n||(n={}),n[f]="")}else C!=="dangerouslySetInnerHTML"&&C!=="children"&&C!=="suppressContentEditableWarning"&&C!=="suppressHydrationWarning"&&C!=="autoFocus"&&(hx.hasOwnProperty(C)?u||(u=[]):(u=u||[]).push(C,null));for(C in s){var r=s[C];if(_=a!=null?a[C]:void 0,s.hasOwnProperty(C)&&r!==_&&(r!=null||_!=null))if(C==="style")if(_){for(f in _)!_.hasOwnProperty(f)||r&&r.hasOwnProperty(f)||(n||(n={}),n[f]="");for(f in r)r.hasOwnProperty(f)&&_[f]!==r[f]&&(n||(n={}),n[f]=r[f])}else n||(u||(u=[]),u.push(C,n)),n=r;else C==="dangerouslySetInnerHTML"?(r=r?r.__html:void 0,_=_?_.__html:void 0,r!=null&&_!==r&&(u=u||[]).push(C,r)):C==="children"?typeof r!="string"&&typeof r!="number"||(u=u||[]).push(C,""+r):C!=="suppressContentEditableWarning"&&C!=="suppressHydrationWarning"&&(hx.hasOwnProperty(C)?(r!=null&&C==="onScroll"&&fs("scroll",e),u||_===r||(u=[])):(u=u||[]).push(C,r))}n&&(u=u||[]).push("style",n);var C=u;(t.updateQueue=C)&&(t.flags|=4)}};M6=function(e,t,n,s){n!==s&&(t.flags|=4)};function sv(e,t){if(!xs)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:s.sibling=null}}function ol(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,s=0;if(t)for(var a=e.child;a!==null;)n|=a.lanes|a.childLanes,s|=a.subtreeFlags&14680064,s|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)n|=a.lanes|a.childLanes,s|=a.subtreeFlags,s|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=s,e.childLanes=n,t}function yH(e,t,n){var s=t.pendingProps;switch(h2(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ol(t),null;case 1:return tu(t.type)&&AS(),ol(t),null;case 3:return s=t.stateNode,Hy(),ps(eu),ps(yl),b2(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(e===null||e.child===null)&&(lw(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Hc!==null&&(BM(Hc),Hc=null))),AM(e,t),ol(t),null;case 5:x2(t);var a=cm(Cx.current);if(n=t.type,e!==null&&t.stateNode!=null)k6(e,t,n,s,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!s){if(t.stateNode===null)throw Error(fr(166));return ol(t),null}if(e=cm(Vd.current),lw(t)){s=t.stateNode,n=t.type;var u=t.memoizedProps;switch(s[Dd]=t,s[wx]=u,e=(t.mode&1)!==0,n){case"dialog":fs("cancel",s),fs("close",s);break;case"iframe":case"object":case"embed":fs("load",s);break;case"video":case"audio":for(a=0;a<Nv.length;a++)fs(Nv[a],s);break;case"source":fs("error",s);break;case"img":case"image":case"link":fs("error",s),fs("load",s);break;case"details":fs("toggle",s);break;case"input":TD(s,u),fs("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!u.multiple},fs("invalid",s);break;case"textarea":kD(s,u),fs("invalid",s)}iM(n,u),a=null;for(var f in u)if(u.hasOwnProperty(f)){var _=u[f];f==="children"?typeof _=="string"?s.textContent!==_&&(u.suppressHydrationWarning!==!0&&aw(s.textContent,_,e),a=["children",_]):typeof _=="number"&&s.textContent!==""+_&&(u.suppressHydrationWarning!==!0&&aw(s.textContent,_,e),a=["children",""+_]):hx.hasOwnProperty(f)&&_!=null&&f==="onScroll"&&fs("scroll",s)}switch(n){case"input":Qb(s),ID(s,u,!0);break;case"textarea":Qb(s),MD(s);break;case"select":case"option":break;default:typeof u.onClick=="function"&&(s.onclick=PS)}s=a,t.updateQueue=s,s!==null&&(t.flags|=4)}else{f=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=rB(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=f.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof s.is=="string"?e=f.createElement(n,{is:s.is}):(e=f.createElement(n),n==="select"&&(f=e,s.multiple?f.multiple=!0:s.size&&(f.size=s.size))):e=f.createElementNS(e,n),e[Dd]=t,e[wx]=s,I6(e,t,!1,!1),t.stateNode=e;e:{switch(f=oM(n,s),n){case"dialog":fs("cancel",e),fs("close",e),a=s;break;case"iframe":case"object":case"embed":fs("load",e),a=s;break;case"video":case"audio":for(a=0;a<Nv.length;a++)fs(Nv[a],e);a=s;break;case"source":fs("error",e),a=s;break;case"img":case"image":case"link":fs("error",e),fs("load",e),a=s;break;case"details":fs("toggle",e),a=s;break;case"input":TD(e,s),a=Qk(e,s),fs("invalid",e);break;case"option":a=s;break;case"select":e._wrapperState={wasMultiple:!!s.multiple},a=Ls({},s,{value:void 0}),fs("invalid",e);break;case"textarea":kD(e,s),a=nM(e,s),fs("invalid",e);break;default:a=s}iM(n,a),_=a;for(u in _)if(_.hasOwnProperty(u)){var r=_[u];u==="style"?sB(e,r):u==="dangerouslySetInnerHTML"?(r=r?r.__html:void 0,r!=null&&iB(e,r)):u==="children"?typeof r=="string"?(n!=="textarea"||r!=="")&&fx(e,r):typeof r=="number"&&fx(e,""+r):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(hx.hasOwnProperty(u)?r!=null&&u==="onScroll"&&fs("scroll",e):r!=null&&KP(e,u,r,f))}switch(n){case"input":Qb(e),ID(e,s,!1);break;case"textarea":Qb(e),MD(e);break;case"option":s.value!=null&&e.setAttribute("value",""+tp(s.value));break;case"select":e.multiple=!!s.multiple,u=s.value,u!=null?Ey(e,!!s.multiple,u,!1):s.defaultValue!=null&&Ey(e,!!s.multiple,s.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=PS)}switch(n){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return ol(t),null;case 6:if(e&&t.stateNode!=null)M6(e,t,e.memoizedProps,s);else{if(typeof s!="string"&&t.stateNode===null)throw Error(fr(166));if(n=cm(Cx.current),cm(Vd.current),lw(t)){if(s=t.stateNode,n=t.memoizedProps,s[Dd]=t,(u=s.nodeValue!==n)&&(e=Tu,e!==null))switch(e.tag){case 3:aw(s.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&aw(s.nodeValue,n,(e.mode&1)!==0)}u&&(t.flags|=4)}else s=(n.nodeType===9?n:n.ownerDocument).createTextNode(s),s[Dd]=t,t.stateNode=s}return ol(t),null;case 13:if(ps(Ts),s=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(xs&&Cu!==null&&t.mode&1&&!(t.flags&128))qB(),Uy(),t.flags|=98560,u=!1;else if(u=lw(t),s!==null&&s.dehydrated!==null){if(e===null){if(!u)throw Error(fr(318));if(u=t.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(fr(317));u[Dd]=t}else Uy(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;ol(t),u=!1}else Hc!==null&&(BM(Hc),Hc=null),u=!0;if(!u)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(s=s!==null,s!==(e!==null&&e.memoizedState!==null)&&s&&(t.child.flags|=8192,t.mode&1&&(e===null||Ts.current&1?ma===0&&(ma=3):R2())),t.updateQueue!==null&&(t.flags|=4),ol(t),null);case 4:return Hy(),AM(e,t),e===null&&xx(t.stateNode.containerInfo),ol(t),null;case 10:return g2(t.type._context),ol(t),null;case 17:return tu(t.type)&&AS(),ol(t),null;case 19:if(ps(Ts),u=t.memoizedState,u===null)return ol(t),null;if(s=(t.flags&128)!==0,f=u.rendering,f===null)if(s)sv(u,!1);else{if(ma!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(f=NS(e),f!==null){for(t.flags|=128,sv(u,!1),s=f.updateQueue,s!==null&&(t.updateQueue=s,t.flags|=4),t.subtreeFlags=0,s=n,n=t.child;n!==null;)u=n,e=s,u.flags&=14680066,f=u.alternate,f===null?(u.childLanes=0,u.lanes=e,u.child=null,u.subtreeFlags=0,u.memoizedProps=null,u.memoizedState=null,u.updateQueue=null,u.dependencies=null,u.stateNode=null):(u.childLanes=f.childLanes,u.lanes=f.lanes,u.child=f.child,u.subtreeFlags=0,u.deletions=null,u.memoizedProps=f.memoizedProps,u.memoizedState=f.memoizedState,u.updateQueue=f.updateQueue,u.type=f.type,e=f.dependencies,u.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return as(Ts,Ts.current&1|2),t.child}e=e.sibling}u.tail!==null&&Js()>qy&&(t.flags|=128,s=!0,sv(u,!1),t.lanes=4194304)}else{if(!s)if(e=NS(f),e!==null){if(t.flags|=128,s=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),sv(u,!0),u.tail===null&&u.tailMode==="hidden"&&!f.alternate&&!xs)return ol(t),null}else 2*Js()-u.renderingStartTime>qy&&n!==1073741824&&(t.flags|=128,s=!0,sv(u,!1),t.lanes=4194304);u.isBackwards?(f.sibling=t.child,t.child=f):(n=u.last,n!==null?n.sibling=f:t.child=f,u.last=f)}return u.tail!==null?(t=u.tail,u.rendering=t,u.tail=t.sibling,u.renderingStartTime=Js(),t.sibling=null,n=Ts.current,as(Ts,s?n&1|2:n&1),t):(ol(t),null);case 22:case 23:return L2(),s=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==s&&(t.flags|=8192),s&&t.mode&1?vu&1073741824&&(ol(t),t.subtreeFlags&6&&(t.flags|=8192)):ol(t),null;case 24:return null;case 25:return null}throw Error(fr(156,t.tag))}function _H(e,t){switch(h2(t),t.tag){case 1:return tu(t.type)&&AS(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Hy(),ps(eu),ps(yl),b2(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return x2(t),null;case 13:if(ps(Ts),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(fr(340));Uy()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ps(Ts),null;case 4:return Hy(),null;case 10:return g2(t.type._context),null;case 22:case 23:return L2(),null;case 24:return null;default:return null}}var dw=!1,cl=!1,vH=typeof WeakSet=="function"?WeakSet:Set,Gr=null;function yy(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(s){$s(e,t,s)}else n.current=null}function LM(e,t,n){try{n()}catch(s){$s(e,t,s)}}var _5=!1;function xH(e,t){if(mM=IS,e=OB(),c2(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var a=s.anchorOffset,u=s.focusNode;s=s.focusOffset;try{n.nodeType,u.nodeType}catch{n=null;break e}var f=0,_=-1,r=-1,C=0,k=0,I=e,P=null;t:for(;;){for(var D;I!==n||a!==0&&I.nodeType!==3||(_=f+a),I!==u||s!==0&&I.nodeType!==3||(r=f+s),I.nodeType===3&&(f+=I.nodeValue.length),(D=I.firstChild)!==null;)P=I,I=D;for(;;){if(I===e)break t;if(P===n&&++C===a&&(_=f),P===u&&++k===s&&(r=f),(D=I.nextSibling)!==null)break;I=P,P=I.parentNode}I=D}n=_===-1||r===-1?null:{start:_,end:r}}else n=null}n=n||{start:0,end:0}}else n=null;for(gM={focusedElem:e,selectionRange:n},IS=!1,Gr=t;Gr!==null;)if(t=Gr,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Gr=e;else for(;Gr!==null;){t=Gr;try{var N=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(N!==null){var j=N.memoizedProps,W=N.memoizedState,H=t.stateNode,q=H.getSnapshotBeforeUpdate(t.elementType===t.type?j:$c(t.type,j),W);H.__reactInternalSnapshotBeforeUpdate=q}break;case 3:var Z=t.stateNode.containerInfo;Z.nodeType===1?Z.textContent="":Z.nodeType===9&&Z.documentElement&&Z.removeChild(Z.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(fr(163))}}catch(re){$s(t,t.return,re)}if(e=t.sibling,e!==null){e.return=t.return,Gr=e;break}Gr=t.return}return N=_5,_5=!1,N}function nx(e,t,n){var s=t.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var a=s=s.next;do{if((a.tag&e)===e){var u=a.destroy;a.destroy=void 0,u!==void 0&&LM(t,n,u)}a=a.next}while(a!==s)}}function FC(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var s=n.create;n.destroy=s()}n=n.next}while(n!==t)}}function RM(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function P6(e){var t=e.alternate;t!==null&&(e.alternate=null,P6(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Dd],delete t[wx],delete t[vM],delete t[nH],delete t[rH])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function A6(e){return e.tag===5||e.tag===3||e.tag===4}function v5(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||A6(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function OM(e,t,n){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=PS));else if(s!==4&&(e=e.child,e!==null))for(OM(e,t,n),e=e.sibling;e!==null;)OM(e,t,n),e=e.sibling}function DM(e,t,n){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(s!==4&&(e=e.child,e!==null))for(DM(e,t,n),e=e.sibling;e!==null;)DM(e,t,n),e=e.sibling}var Na=null,Gc=!1;function Ef(e,t,n){for(n=n.child;n!==null;)L6(e,t,n),n=n.sibling}function L6(e,t,n){if(jd&&typeof jd.onCommitFiberUnmount=="function")try{jd.onCommitFiberUnmount(MC,n)}catch{}switch(n.tag){case 5:cl||yy(n,t);case 6:var s=Na,a=Gc;Na=null,Ef(e,t,n),Na=s,Gc=a,Na!==null&&(Gc?(e=Na,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Na.removeChild(n.stateNode));break;case 18:Na!==null&&(Gc?(e=Na,n=n.stateNode,e.nodeType===8?ZI(e.parentNode,n):e.nodeType===1&&ZI(e,n),yx(e)):ZI(Na,n.stateNode));break;case 4:s=Na,a=Gc,Na=n.stateNode.containerInfo,Gc=!0,Ef(e,t,n),Na=s,Gc=a;break;case 0:case 11:case 14:case 15:if(!cl&&(s=n.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){a=s=s.next;do{var u=a,f=u.destroy;u=u.tag,f!==void 0&&(u&2||u&4)&&LM(n,t,f),a=a.next}while(a!==s)}Ef(e,t,n);break;case 1:if(!cl&&(yy(n,t),s=n.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=n.memoizedProps,s.state=n.memoizedState,s.componentWillUnmount()}catch(_){$s(n,t,_)}Ef(e,t,n);break;case 21:Ef(e,t,n);break;case 22:n.mode&1?(cl=(s=cl)||n.memoizedState!==null,Ef(e,t,n),cl=s):Ef(e,t,n);break;default:Ef(e,t,n)}}function x5(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new vH),t.forEach(function(s){var a=MH.bind(null,e,s);n.has(s)||(n.add(s),s.then(a,a))})}}function jc(e,t){var n=t.deletions;if(n!==null)for(var s=0;s<n.length;s++){var a=n[s];try{var u=e,f=t,_=f;e:for(;_!==null;){switch(_.tag){case 5:Na=_.stateNode,Gc=!1;break e;case 3:Na=_.stateNode.containerInfo,Gc=!0;break e;case 4:Na=_.stateNode.containerInfo,Gc=!0;break e}_=_.return}if(Na===null)throw Error(fr(160));L6(u,f,a),Na=null,Gc=!1;var r=a.alternate;r!==null&&(r.return=null),a.return=null}catch(C){$s(a,t,C)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)R6(t,e),t=t.sibling}function R6(e,t){var n=e.alternate,s=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(jc(t,e),Td(e),s&4){try{nx(3,e,e.return),FC(3,e)}catch(j){$s(e,e.return,j)}try{nx(5,e,e.return)}catch(j){$s(e,e.return,j)}}break;case 1:jc(t,e),Td(e),s&512&&n!==null&&yy(n,n.return);break;case 5:if(jc(t,e),Td(e),s&512&&n!==null&&yy(n,n.return),e.flags&32){var a=e.stateNode;try{fx(a,"")}catch(j){$s(e,e.return,j)}}if(s&4&&(a=e.stateNode,a!=null)){var u=e.memoizedProps,f=n!==null?n.memoizedProps:u,_=e.type,r=e.updateQueue;if(e.updateQueue=null,r!==null)try{_==="input"&&u.type==="radio"&&u.name!=null&&tB(a,u),oM(_,f);var C=oM(_,u);for(f=0;f<r.length;f+=2){var k=r[f],I=r[f+1];k==="style"?sB(a,I):k==="dangerouslySetInnerHTML"?iB(a,I):k==="children"?fx(a,I):KP(a,k,I,C)}switch(_){case"input":eM(a,u);break;case"textarea":nB(a,u);break;case"select":var P=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!u.multiple;var D=u.value;D!=null?Ey(a,!!u.multiple,D,!1):P!==!!u.multiple&&(u.defaultValue!=null?Ey(a,!!u.multiple,u.defaultValue,!0):Ey(a,!!u.multiple,u.multiple?[]:"",!1))}a[wx]=u}catch(j){$s(e,e.return,j)}}break;case 6:if(jc(t,e),Td(e),s&4){if(e.stateNode===null)throw Error(fr(162));a=e.stateNode,u=e.memoizedProps;try{a.nodeValue=u}catch(j){$s(e,e.return,j)}}break;case 3:if(jc(t,e),Td(e),s&4&&n!==null&&n.memoizedState.isDehydrated)try{yx(t.containerInfo)}catch(j){$s(e,e.return,j)}break;case 4:jc(t,e),Td(e);break;case 13:jc(t,e),Td(e),a=e.child,a.flags&8192&&(u=a.memoizedState!==null,a.stateNode.isHidden=u,!u||a.alternate!==null&&a.alternate.memoizedState!==null||(P2=Js())),s&4&&x5(e);break;case 22:if(k=n!==null&&n.memoizedState!==null,e.mode&1?(cl=(C=cl)||k,jc(t,e),cl=C):jc(t,e),Td(e),s&8192){if(C=e.memoizedState!==null,(e.stateNode.isHidden=C)&&!k&&e.mode&1)for(Gr=e,k=e.child;k!==null;){for(I=Gr=k;Gr!==null;){switch(P=Gr,D=P.child,P.tag){case 0:case 11:case 14:case 15:nx(4,P,P.return);break;case 1:yy(P,P.return);var N=P.stateNode;if(typeof N.componentWillUnmount=="function"){s=P,n=P.return;try{t=s,N.props=t.memoizedProps,N.state=t.memoizedState,N.componentWillUnmount()}catch(j){$s(s,n,j)}}break;case 5:yy(P,P.return);break;case 22:if(P.memoizedState!==null){w5(I);continue}}D!==null?(D.return=P,Gr=D):w5(I)}k=k.sibling}e:for(k=null,I=e;;){if(I.tag===5){if(k===null){k=I;try{a=I.stateNode,C?(u=a.style,typeof u.setProperty=="function"?u.setProperty("display","none","important"):u.display="none"):(_=I.stateNode,r=I.memoizedProps.style,f=r!=null&&r.hasOwnProperty("display")?r.display:null,_.style.display=oB("display",f))}catch(j){$s(e,e.return,j)}}}else if(I.tag===6){if(k===null)try{I.stateNode.nodeValue=C?"":I.memoizedProps}catch(j){$s(e,e.return,j)}}else if((I.tag!==22&&I.tag!==23||I.memoizedState===null||I===e)&&I.child!==null){I.child.return=I,I=I.child;continue}if(I===e)break e;for(;I.sibling===null;){if(I.return===null||I.return===e)break e;k===I&&(k=null),I=I.return}k===I&&(k=null),I.sibling.return=I.return,I=I.sibling}}break;case 19:jc(t,e),Td(e),s&4&&x5(e);break;case 21:break;default:jc(t,e),Td(e)}}function Td(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(A6(n)){var s=n;break e}n=n.return}throw Error(fr(160))}switch(s.tag){case 5:var a=s.stateNode;s.flags&32&&(fx(a,""),s.flags&=-33);var u=v5(e);DM(e,u,a);break;case 3:case 4:var f=s.stateNode.containerInfo,_=v5(e);OM(e,_,f);break;default:throw Error(fr(161))}}catch(r){$s(e,e.return,r)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function bH(e,t,n){Gr=e,O6(e)}function O6(e,t,n){for(var s=(e.mode&1)!==0;Gr!==null;){var a=Gr,u=a.child;if(a.tag===22&&s){var f=a.memoizedState!==null||dw;if(!f){var _=a.alternate,r=_!==null&&_.memoizedState!==null||cl;_=dw;var C=cl;if(dw=f,(cl=r)&&!C)for(Gr=a;Gr!==null;)f=Gr,r=f.child,f.tag===22&&f.memoizedState!==null?S5(a):r!==null?(r.return=f,Gr=r):S5(a);for(;u!==null;)Gr=u,O6(u),u=u.sibling;Gr=a,dw=_,cl=C}b5(e)}else a.subtreeFlags&8772&&u!==null?(u.return=a,Gr=u):b5(e)}}function b5(e){for(;Gr!==null;){var t=Gr;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:cl||FC(5,t);break;case 1:var s=t.stateNode;if(t.flags&4&&!cl)if(n===null)s.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:$c(t.type,n.memoizedProps);s.componentDidUpdate(a,n.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var u=t.updateQueue;u!==null&&o5(t,u,s);break;case 3:var f=t.updateQueue;if(f!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}o5(t,f,n)}break;case 5:var _=t.stateNode;if(n===null&&t.flags&4){n=_;var r=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":r.autoFocus&&n.focus();break;case"img":r.src&&(n.src=r.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var C=t.alternate;if(C!==null){var k=C.memoizedState;if(k!==null){var I=k.dehydrated;I!==null&&yx(I)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(fr(163))}cl||t.flags&512&&RM(t)}catch(P){$s(t,t.return,P)}}if(t===e){Gr=null;break}if(n=t.sibling,n!==null){n.return=t.return,Gr=n;break}Gr=t.return}}function w5(e){for(;Gr!==null;){var t=Gr;if(t===e){Gr=null;break}var n=t.sibling;if(n!==null){n.return=t.return,Gr=n;break}Gr=t.return}}function S5(e){for(;Gr!==null;){var t=Gr;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{FC(4,t)}catch(r){$s(t,n,r)}break;case 1:var s=t.stateNode;if(typeof s.componentDidMount=="function"){var a=t.return;try{s.componentDidMount()}catch(r){$s(t,a,r)}}var u=t.return;try{RM(t)}catch(r){$s(t,u,r)}break;case 5:var f=t.return;try{RM(t)}catch(r){$s(t,f,r)}}}catch(r){$s(t,t.return,r)}if(t===e){Gr=null;break}var _=t.sibling;if(_!==null){_.return=t.return,Gr=_;break}Gr=t.return}}var wH=Math.ceil,VS=Vh.ReactCurrentDispatcher,k2=Vh.ReactCurrentOwner,uc=Vh.ReactCurrentBatchConfig,po=0,Ia=null,la=null,$a=0,vu=0,_y=pp(0),ma=0,kx=null,Sm=0,NC=0,M2=0,rx=null,Zl=null,P2=0,qy=1/0,bh=null,$S=!1,zM=null,Yf=null,hw=!1,jf=null,US=0,ix=0,FM=null,iS=-1,oS=0;function Ol(){return po&6?Js():iS!==-1?iS:iS=Js()}function Zf(e){return e.mode&1?po&2&&$a!==0?$a&-$a:oH.transition!==null?(oS===0&&(oS=_B()),oS):(e=Ao,e!==0||(e=window.event,e=e===void 0?16:EB(e.type)),e):1}function Jc(e,t,n,s){if(50<ix)throw ix=0,FM=null,Error(fr(185));Jx(e,n,s),(!(po&2)||e!==Ia)&&(e===Ia&&(!(po&2)&&(NC|=n),ma===4&&Df(e,$a)),nu(e,s),n===1&&po===0&&!(t.mode&1)&&(qy=Js()+500,OC&&mp()))}function nu(e,t){var n=e.callbackNode;o7(e,t);var s=TS(e,e===Ia?$a:0);if(s===0)n!==null&&LD(n),e.callbackNode=null,e.callbackPriority=0;else if(t=s&-s,e.callbackPriority!==t){if(n!=null&&LD(n),t===1)e.tag===0?iH(C5.bind(null,e)):GB(C5.bind(null,e)),eH(function(){!(po&6)&&mp()}),n=null;else{switch(vB(s)){case 1:n=n2;break;case 4:n=gB;break;case 16:n=ES;break;case 536870912:n=yB;break;default:n=ES}n=$6(n,D6.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function D6(e,t){if(iS=-1,oS=0,po&6)throw Error(fr(327));var n=e.callbackNode;if(Py()&&e.callbackNode!==n)return null;var s=TS(e,e===Ia?$a:0);if(s===0)return null;if(s&30||s&e.expiredLanes||t)t=GS(e,s);else{t=s;var a=po;po|=2;var u=F6();(Ia!==e||$a!==t)&&(bh=null,qy=Js()+500,pm(e,t));do try{EH();break}catch(_){z6(e,_)}while(!0);m2(),VS.current=u,po=a,la!==null?t=0:(Ia=null,$a=0,t=ma)}if(t!==0){if(t===2&&(a=cM(e),a!==0&&(s=a,t=NM(e,a))),t===1)throw n=kx,pm(e,0),Df(e,s),nu(e,Js()),n;if(t===6)Df(e,s);else{if(a=e.current.alternate,!(s&30)&&!SH(a)&&(t=GS(e,s),t===2&&(u=cM(e),u!==0&&(s=u,t=NM(e,u))),t===1))throw n=kx,pm(e,0),Df(e,s),nu(e,Js()),n;switch(e.finishedWork=a,e.finishedLanes=s,t){case 0:case 1:throw Error(fr(345));case 2:nm(e,Zl,bh);break;case 3:if(Df(e,s),(s&130023424)===s&&(t=P2+500-Js(),10<t)){if(TS(e,0)!==0)break;if(a=e.suspendedLanes,(a&s)!==s){Ol(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=_M(nm.bind(null,e,Zl,bh),t);break}nm(e,Zl,bh);break;case 4:if(Df(e,s),(s&4194240)===s)break;for(t=e.eventTimes,a=-1;0<s;){var f=31-Kc(s);u=1<<f,f=t[f],f>a&&(a=f),s&=~u}if(s=a,s=Js()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*wH(s/1960))-s,10<s){e.timeoutHandle=_M(nm.bind(null,e,Zl,bh),s);break}nm(e,Zl,bh);break;case 5:nm(e,Zl,bh);break;default:throw Error(fr(329))}}}return nu(e,Js()),e.callbackNode===n?D6.bind(null,e):null}function NM(e,t){var n=rx;return e.current.memoizedState.isDehydrated&&(pm(e,t).flags|=256),e=GS(e,t),e!==2&&(t=Zl,Zl=n,t!==null&&BM(t)),e}function BM(e){Zl===null?Zl=e:Zl.push.apply(Zl,e)}function SH(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var s=0;s<n.length;s++){var a=n[s],u=a.getSnapshot;a=a.value;try{if(!td(u(),a))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Df(e,t){for(t&=~M2,t&=~NC,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Kc(t),s=1<<n;e[n]=-1,t&=~s}}function C5(e){if(po&6)throw Error(fr(327));Py();var t=TS(e,0);if(!(t&1))return nu(e,Js()),null;var n=GS(e,t);if(e.tag!==0&&n===2){var s=cM(e);s!==0&&(t=s,n=NM(e,s))}if(n===1)throw n=kx,pm(e,0),Df(e,t),nu(e,Js()),n;if(n===6)throw Error(fr(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,nm(e,Zl,bh),nu(e,Js()),null}function A2(e,t){var n=po;po|=1;try{return e(t)}finally{po=n,po===0&&(qy=Js()+500,OC&&mp())}}function Cm(e){jf!==null&&jf.tag===0&&!(po&6)&&Py();var t=po;po|=1;var n=uc.transition,s=Ao;try{if(uc.transition=null,Ao=1,e)return e()}finally{Ao=s,uc.transition=n,po=t,!(po&6)&&mp()}}function L2(){vu=_y.current,ps(_y)}function pm(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,Q7(n)),la!==null)for(n=la.return;n!==null;){var s=n;switch(h2(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&AS();break;case 3:Hy(),ps(eu),ps(yl),b2();break;case 5:x2(s);break;case 4:Hy();break;case 13:ps(Ts);break;case 19:ps(Ts);break;case 10:g2(s.type._context);break;case 22:case 23:L2()}n=n.return}if(Ia=e,la=e=Kf(e.current,null),$a=vu=t,ma=0,kx=null,M2=NC=Sm=0,Zl=rx=null,um!==null){for(t=0;t<um.length;t++)if(n=um[t],s=n.interleaved,s!==null){n.interleaved=null;var a=s.next,u=n.pending;if(u!==null){var f=u.next;u.next=a,s.next=f}n.pending=s}um=null}return e}function z6(e,t){do{var n=la;try{if(m2(),tS.current=jS,BS){for(var s=Ps.memoizedState;s!==null;){var a=s.queue;a!==null&&(a.pending=null),s=s.next}BS=!1}if(wm=0,Ea=pa=Ps=null,tx=!1,Ex=0,k2.current=null,n===null||n.return===null){ma=1,kx=t,la=null;break}e:{var u=e,f=n.return,_=n,r=t;if(t=$a,_.flags|=32768,r!==null&&typeof r=="object"&&typeof r.then=="function"){var C=r,k=_,I=k.tag;if(!(k.mode&1)&&(I===0||I===11||I===15)){var P=k.alternate;P?(k.updateQueue=P.updateQueue,k.memoizedState=P.memoizedState,k.lanes=P.lanes):(k.updateQueue=null,k.memoizedState=null)}var D=d5(f);if(D!==null){D.flags&=-257,h5(D,f,_,u,t),D.mode&1&&c5(u,C,t),t=D,r=C;var N=t.updateQueue;if(N===null){var j=new Set;j.add(r),t.updateQueue=j}else N.add(r);break e}else{if(!(t&1)){c5(u,C,t),R2();break e}r=Error(fr(426))}}else if(xs&&_.mode&1){var W=d5(f);if(W!==null){!(W.flags&65536)&&(W.flags|=256),h5(W,f,_,u,t),f2(Wy(r,_));break e}}u=r=Wy(r,_),ma!==4&&(ma=2),rx===null?rx=[u]:rx.push(u),u=f;do{switch(u.tag){case 3:u.flags|=65536,t&=-t,u.lanes|=t;var H=v6(u,r,t);i5(u,H);break e;case 1:_=r;var q=u.type,Z=u.stateNode;if(!(u.flags&128)&&(typeof q.getDerivedStateFromError=="function"||Z!==null&&typeof Z.componentDidCatch=="function"&&(Yf===null||!Yf.has(Z)))){u.flags|=65536,t&=-t,u.lanes|=t;var re=x6(u,_,t);i5(u,re);break e}}u=u.return}while(u!==null)}B6(n)}catch(le){t=le,la===n&&n!==null&&(la=n=n.return);continue}break}while(!0)}function F6(){var e=VS.current;return VS.current=jS,e===null?jS:e}function R2(){(ma===0||ma===3||ma===2)&&(ma=4),Ia===null||!(Sm&268435455)&&!(NC&268435455)||Df(Ia,$a)}function GS(e,t){var n=po;po|=2;var s=F6();(Ia!==e||$a!==t)&&(bh=null,pm(e,t));do try{CH();break}catch(a){z6(e,a)}while(!0);if(m2(),po=n,VS.current=s,la!==null)throw Error(fr(261));return Ia=null,$a=0,ma}function CH(){for(;la!==null;)N6(la)}function EH(){for(;la!==null&&!Z9();)N6(la)}function N6(e){var t=V6(e.alternate,e,vu);e.memoizedProps=e.pendingProps,t===null?B6(e):la=t,k2.current=null}function B6(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=_H(n,t),n!==null){n.flags&=32767,la=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ma=6,la=null;return}}else if(n=yH(n,t,vu),n!==null){la=n;return}if(t=t.sibling,t!==null){la=t;return}la=t=e}while(t!==null);ma===0&&(ma=5)}function nm(e,t,n){var s=Ao,a=uc.transition;try{uc.transition=null,Ao=1,TH(e,t,n,s)}finally{uc.transition=a,Ao=s}return null}function TH(e,t,n,s){do Py();while(jf!==null);if(po&6)throw Error(fr(327));n=e.finishedWork;var a=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(fr(177));e.callbackNode=null,e.callbackPriority=0;var u=n.lanes|n.childLanes;if(s7(e,u),e===Ia&&(la=Ia=null,$a=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||hw||(hw=!0,$6(ES,function(){return Py(),null})),u=(n.flags&15990)!==0,n.subtreeFlags&15990||u){u=uc.transition,uc.transition=null;var f=Ao;Ao=1;var _=po;po|=4,k2.current=null,xH(e,n),R6(n,e),W7(gM),IS=!!mM,gM=mM=null,e.current=n,bH(n),K9(),po=_,Ao=f,uc.transition=u}else e.current=n;if(hw&&(hw=!1,jf=e,US=a),u=e.pendingLanes,u===0&&(Yf=null),e7(n.stateNode),nu(e,Js()),t!==null)for(s=e.onRecoverableError,n=0;n<t.length;n++)a=t[n],s(a.value,{componentStack:a.stack,digest:a.digest});if($S)throw $S=!1,e=zM,zM=null,e;return US&1&&e.tag!==0&&Py(),u=e.pendingLanes,u&1?e===FM?ix++:(ix=0,FM=e):ix=0,mp(),null}function Py(){if(jf!==null){var e=vB(US),t=uc.transition,n=Ao;try{if(uc.transition=null,Ao=16>e?16:e,jf===null)var s=!1;else{if(e=jf,jf=null,US=0,po&6)throw Error(fr(331));var a=po;for(po|=4,Gr=e.current;Gr!==null;){var u=Gr,f=u.child;if(Gr.flags&16){var _=u.deletions;if(_!==null){for(var r=0;r<_.length;r++){var C=_[r];for(Gr=C;Gr!==null;){var k=Gr;switch(k.tag){case 0:case 11:case 15:nx(8,k,u)}var I=k.child;if(I!==null)I.return=k,Gr=I;else for(;Gr!==null;){k=Gr;var P=k.sibling,D=k.return;if(P6(k),k===C){Gr=null;break}if(P!==null){P.return=D,Gr=P;break}Gr=D}}}var N=u.alternate;if(N!==null){var j=N.child;if(j!==null){N.child=null;do{var W=j.sibling;j.sibling=null,j=W}while(j!==null)}}Gr=u}}if(u.subtreeFlags&2064&&f!==null)f.return=u,Gr=f;else e:for(;Gr!==null;){if(u=Gr,u.flags&2048)switch(u.tag){case 0:case 11:case 15:nx(9,u,u.return)}var H=u.sibling;if(H!==null){H.return=u.return,Gr=H;break e}Gr=u.return}}var q=e.current;for(Gr=q;Gr!==null;){f=Gr;var Z=f.child;if(f.subtreeFlags&2064&&Z!==null)Z.return=f,Gr=Z;else e:for(f=q;Gr!==null;){if(_=Gr,_.flags&2048)try{switch(_.tag){case 0:case 11:case 15:FC(9,_)}}catch(le){$s(_,_.return,le)}if(_===f){Gr=null;break e}var re=_.sibling;if(re!==null){re.return=_.return,Gr=re;break e}Gr=_.return}}if(po=a,mp(),jd&&typeof jd.onPostCommitFiberRoot=="function")try{jd.onPostCommitFiberRoot(MC,e)}catch{}s=!0}return s}finally{Ao=n,uc.transition=t}}return!1}function E5(e,t,n){t=Wy(n,t),t=v6(e,t,1),e=Xf(e,t,1),t=Ol(),e!==null&&(Jx(e,1,t),nu(e,t))}function $s(e,t,n){if(e.tag===3)E5(e,e,n);else for(;t!==null;){if(t.tag===3){E5(t,e,n);break}else if(t.tag===1){var s=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(Yf===null||!Yf.has(s))){e=Wy(n,e),e=x6(t,e,1),t=Xf(t,e,1),e=Ol(),t!==null&&(Jx(t,1,e),nu(t,e));break}}t=t.return}}function IH(e,t,n){var s=e.pingCache;s!==null&&s.delete(t),t=Ol(),e.pingedLanes|=e.suspendedLanes&n,Ia===e&&($a&n)===n&&(ma===4||ma===3&&($a&130023424)===$a&&500>Js()-P2?pm(e,0):M2|=n),nu(e,t)}function j6(e,t){t===0&&(e.mode&1?(t=nw,nw<<=1,!(nw&130023424)&&(nw=4194304)):t=1);var n=Ol();e=Oh(e,t),e!==null&&(Jx(e,t,n),nu(e,n))}function kH(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),j6(e,n)}function MH(e,t){var n=0;switch(e.tag){case 13:var s=e.stateNode,a=e.memoizedState;a!==null&&(n=a.retryLane);break;case 19:s=e.stateNode;break;default:throw Error(fr(314))}s!==null&&s.delete(t),j6(e,n)}var V6;V6=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||eu.current)Jl=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Jl=!1,gH(e,t,n);Jl=!!(e.flags&131072)}else Jl=!1,xs&&t.flags&1048576&&HB(t,OS,t.index);switch(t.lanes=0,t.tag){case 2:var s=t.type;rS(e,t),e=t.pendingProps;var a=$y(t,yl.current);My(t,n),a=S2(null,t,s,e,a,n);var u=C2();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,tu(s)?(u=!0,LS(t)):u=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,_2(t),a.updater=zC,t.stateNode=a,a._reactInternals=t,EM(t,s,e,n),t=kM(null,t,s,!0,u,n)):(t.tag=0,xs&&u&&d2(t),Pl(null,t,a,n),t=t.child),t;case 16:s=t.elementType;e:{switch(rS(e,t),e=t.pendingProps,a=s._init,s=a(s._payload),t.type=s,a=t.tag=AH(s),e=$c(s,e),a){case 0:t=IM(null,t,s,e,n);break e;case 1:t=m5(null,t,s,e,n);break e;case 11:t=f5(null,t,s,e,n);break e;case 14:t=p5(null,t,s,$c(s.type,e),n);break e}throw Error(fr(306,s,""))}return t;case 0:return s=t.type,a=t.pendingProps,a=t.elementType===s?a:$c(s,a),IM(e,t,s,a,n);case 1:return s=t.type,a=t.pendingProps,a=t.elementType===s?a:$c(s,a),m5(e,t,s,a,n);case 3:e:{if(C6(t),e===null)throw Error(fr(387));s=t.pendingProps,u=t.memoizedState,a=u.element,KB(e,t),FS(t,s,null,n);var f=t.memoizedState;if(s=f.element,u.isDehydrated)if(u={element:s,isDehydrated:!1,cache:f.cache,pendingSuspenseBoundaries:f.pendingSuspenseBoundaries,transitions:f.transitions},t.updateQueue.baseState=u,t.memoizedState=u,t.flags&256){a=Wy(Error(fr(423)),t),t=g5(e,t,s,n,a);break e}else if(s!==a){a=Wy(Error(fr(424)),t),t=g5(e,t,s,n,a);break e}else for(Cu=qf(t.stateNode.containerInfo.firstChild),Tu=t,xs=!0,Hc=null,n=YB(t,null,s,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Uy(),s===a){t=Dh(e,t,n);break e}Pl(e,t,s,n)}t=t.child}return t;case 5:return JB(t),e===null&&wM(t),s=t.type,a=t.pendingProps,u=e!==null?e.memoizedProps:null,f=a.children,yM(s,a)?f=null:u!==null&&yM(s,u)&&(t.flags|=32),S6(e,t),Pl(e,t,f,n),t.child;case 6:return e===null&&wM(t),null;case 13:return E6(e,t,n);case 4:return v2(t,t.stateNode.containerInfo),s=t.pendingProps,e===null?t.child=Gy(t,null,s,n):Pl(e,t,s,n),t.child;case 11:return s=t.type,a=t.pendingProps,a=t.elementType===s?a:$c(s,a),f5(e,t,s,a,n);case 7:return Pl(e,t,t.pendingProps,n),t.child;case 8:return Pl(e,t,t.pendingProps.children,n),t.child;case 12:return Pl(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(s=t.type._context,a=t.pendingProps,u=t.memoizedProps,f=a.value,as(DS,s._currentValue),s._currentValue=f,u!==null)if(td(u.value,f)){if(u.children===a.children&&!eu.current){t=Dh(e,t,n);break e}}else for(u=t.child,u!==null&&(u.return=t);u!==null;){var _=u.dependencies;if(_!==null){f=u.child;for(var r=_.firstContext;r!==null;){if(r.context===s){if(u.tag===1){r=Ih(-1,n&-n),r.tag=2;var C=u.updateQueue;if(C!==null){C=C.shared;var k=C.pending;k===null?r.next=r:(r.next=k.next,k.next=r),C.pending=r}}u.lanes|=n,r=u.alternate,r!==null&&(r.lanes|=n),SM(u.return,n,t),_.lanes|=n;break}r=r.next}}else if(u.tag===10)f=u.type===t.type?null:u.child;else if(u.tag===18){if(f=u.return,f===null)throw Error(fr(341));f.lanes|=n,_=f.alternate,_!==null&&(_.lanes|=n),SM(f,n,t),f=u.sibling}else f=u.child;if(f!==null)f.return=u;else for(f=u;f!==null;){if(f===t){f=null;break}if(u=f.sibling,u!==null){u.return=f.return,f=u;break}f=f.return}u=f}Pl(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,s=t.pendingProps.children,My(t,n),a=hc(a),s=s(a),t.flags|=1,Pl(e,t,s,n),t.child;case 14:return s=t.type,a=$c(s,t.pendingProps),a=$c(s.type,a),p5(e,t,s,a,n);case 15:return b6(e,t,t.type,t.pendingProps,n);case 17:return s=t.type,a=t.pendingProps,a=t.elementType===s?a:$c(s,a),rS(e,t),t.tag=1,tu(s)?(e=!0,LS(t)):e=!1,My(t,n),_6(t,s,a),EM(t,s,a,n),kM(null,t,s,!0,e,n);case 19:return T6(e,t,n);case 22:return w6(e,t,n)}throw Error(fr(156,t.tag))};function $6(e,t){return mB(e,t)}function PH(e,t,n,s){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function sc(e,t,n,s){return new PH(e,t,n,s)}function O2(e){return e=e.prototype,!(!e||!e.isReactComponent)}function AH(e){if(typeof e=="function")return O2(e)?1:0;if(e!=null){if(e=e.$$typeof,e===QP)return 11;if(e===e2)return 14}return 2}function Kf(e,t){var n=e.alternate;return n===null?(n=sc(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function sS(e,t,n,s,a,u){var f=2;if(s=e,typeof e=="function")O2(e)&&(f=1);else if(typeof e=="string")f=5;else e:switch(e){case ly:return mm(n.children,a,u,t);case JP:f=8,a|=8;break;case Yk:return e=sc(12,n,t,a|2),e.elementType=Yk,e.lanes=u,e;case Zk:return e=sc(13,n,t,a),e.elementType=Zk,e.lanes=u,e;case Kk:return e=sc(19,n,t,a),e.elementType=Kk,e.lanes=u,e;case JN:return BC(n,a,u,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case ZN:f=10;break e;case KN:f=9;break e;case QP:f=11;break e;case e2:f=14;break e;case Af:f=16,s=null;break e}throw Error(fr(130,e==null?e:typeof e,""))}return t=sc(f,n,t,a),t.elementType=e,t.type=s,t.lanes=u,t}function mm(e,t,n,s){return e=sc(7,e,s,t),e.lanes=n,e}function BC(e,t,n,s){return e=sc(22,e,s,t),e.elementType=JN,e.lanes=n,e.stateNode={isHidden:!1},e}function ik(e,t,n){return e=sc(6,e,null,t),e.lanes=n,e}function ok(e,t,n){return t=sc(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function LH(e,t,n,s,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=BI(0),this.expirationTimes=BI(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=BI(0),this.identifierPrefix=s,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function D2(e,t,n,s,a,u,f,_,r){return e=new LH(e,t,n,_,r),t===1?(t=1,u===!0&&(t|=8)):t=0,u=sc(3,null,null,t),e.current=u,u.stateNode=e,u.memoizedState={element:s,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},_2(u),e}function RH(e,t,n){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ay,key:s==null?null:""+s,children:e,containerInfo:t,implementation:n}}function U6(e){if(!e)return np;e=e._reactInternals;e:{if(Dm(e)!==e||e.tag!==1)throw Error(fr(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(tu(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(fr(171))}if(e.tag===1){var n=e.type;if(tu(n))return UB(e,n,t)}return t}function G6(e,t,n,s,a,u,f,_,r){return e=D2(n,s,!0,e,a,u,f,_,r),e.context=U6(null),n=e.current,s=Ol(),a=Zf(n),u=Ih(s,a),u.callback=t??null,Xf(n,u,a),e.current.lanes=a,Jx(e,a,s),nu(e,s),e}function jC(e,t,n,s){var a=t.current,u=Ol(),f=Zf(a);return n=U6(n),t.context===null?t.context=n:t.pendingContext=n,t=Ih(u,f),t.payload={element:e},s=s===void 0?null:s,s!==null&&(t.callback=s),e=Xf(a,t,f),e!==null&&(Jc(e,a,f,u),eS(e,a,f)),f}function HS(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function T5(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function z2(e,t){T5(e,t),(e=e.alternate)&&T5(e,t)}function OH(){return null}var H6=typeof reportError=="function"?reportError:function(e){console.error(e)};function F2(e){this._internalRoot=e}VC.prototype.render=F2.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(fr(409));jC(e,t,null,null)};VC.prototype.unmount=F2.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Cm(function(){jC(null,e,null,null)}),t[Rh]=null}};function VC(e){this._internalRoot=e}VC.prototype.unstable_scheduleHydration=function(e){if(e){var t=wB();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Of.length&&t!==0&&t<Of[n].priority;n++);Of.splice(n,0,e),n===0&&CB(e)}};function N2(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function $C(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function I5(){}function DH(e,t,n,s,a){if(a){if(typeof s=="function"){var u=s;s=function(){var C=HS(f);u.call(C)}}var f=G6(t,s,e,0,null,!1,!1,"",I5);return e._reactRootContainer=f,e[Rh]=f.current,xx(e.nodeType===8?e.parentNode:e),Cm(),f}for(;a=e.lastChild;)e.removeChild(a);if(typeof s=="function"){var _=s;s=function(){var C=HS(r);_.call(C)}}var r=D2(e,0,!1,null,null,!1,!1,"",I5);return e._reactRootContainer=r,e[Rh]=r.current,xx(e.nodeType===8?e.parentNode:e),Cm(function(){jC(t,r,n,s)}),r}function UC(e,t,n,s,a){var u=n._reactRootContainer;if(u){var f=u;if(typeof a=="function"){var _=a;a=function(){var r=HS(f);_.call(r)}}jC(t,f,e,a)}else f=DH(n,t,e,a,s);return HS(f)}xB=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Fv(t.pendingLanes);n!==0&&(r2(t,n|1),nu(t,Js()),!(po&6)&&(qy=Js()+500,mp()))}break;case 13:Cm(function(){var s=Oh(e,1);if(s!==null){var a=Ol();Jc(s,e,1,a)}}),z2(e,1)}};i2=function(e){if(e.tag===13){var t=Oh(e,134217728);if(t!==null){var n=Ol();Jc(t,e,134217728,n)}z2(e,134217728)}};bB=function(e){if(e.tag===13){var t=Zf(e),n=Oh(e,t);if(n!==null){var s=Ol();Jc(n,e,t,s)}z2(e,t)}};wB=function(){return Ao};SB=function(e,t){var n=Ao;try{return Ao=e,t()}finally{Ao=n}};aM=function(e,t,n){switch(t){case"input":if(eM(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var s=n[t];if(s!==e&&s.form===e.form){var a=RC(s);if(!a)throw Error(fr(90));eB(s),eM(s,a)}}}break;case"textarea":nB(e,n);break;case"select":t=n.value,t!=null&&Ey(e,!!n.multiple,t,!1)}};uB=A2;cB=Cm;var zH={usingClientEntryPoint:!1,Events:[e1,hy,RC,aB,lB,A2]},av={findFiberByHostInstance:lm,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},FH={bundleType:av.bundleType,version:av.version,rendererPackageName:av.rendererPackageName,rendererConfig:av.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Vh.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=fB(e),e===null?null:e.stateNode},findFiberByHostInstance:av.findFiberByHostInstance||OH,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var fw=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!fw.isDisabled&&fw.supportsFiber)try{MC=fw.inject(FH),jd=fw}catch{}}Pu.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=zH;Pu.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!N2(t))throw Error(fr(200));return RH(e,t,null,n)};Pu.createRoot=function(e,t){if(!N2(e))throw Error(fr(299));var n=!1,s="",a=H6;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=D2(e,1,!1,null,null,n,!1,s,a),e[Rh]=t.current,xx(e.nodeType===8?e.parentNode:e),new F2(t)};Pu.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(fr(188)):(e=Object.keys(e).join(","),Error(fr(268,e)));return e=fB(t),e=e===null?null:e.stateNode,e};Pu.flushSync=function(e){return Cm(e)};Pu.hydrate=function(e,t,n){if(!$C(t))throw Error(fr(200));return UC(null,e,t,!0,n)};Pu.hydrateRoot=function(e,t,n){if(!N2(e))throw Error(fr(405));var s=n!=null&&n.hydratedSources||null,a=!1,u="",f=H6;if(n!=null&&(n.unstable_strictMode===!0&&(a=!0),n.identifierPrefix!==void 0&&(u=n.identifierPrefix),n.onRecoverableError!==void 0&&(f=n.onRecoverableError)),t=G6(t,null,e,1,n??null,a,!1,u,f),e[Rh]=t.current,xx(e),s)for(e=0;e<s.length;e++)n=s[e],a=n._getVersion,a=a(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new VC(t)};Pu.render=function(e,t,n){if(!$C(t))throw Error(fr(200));return UC(null,e,t,!1,n)};Pu.unmountComponentAtNode=function(e){if(!$C(e))throw Error(fr(40));return e._reactRootContainer?(Cm(function(){UC(null,null,e,!1,function(){e._reactRootContainer=null,e[Rh]=null})}),!0):!1};Pu.unstable_batchedUpdates=A2;Pu.unstable_renderSubtreeIntoContainer=function(e,t,n,s){if(!$C(n))throw Error(fr(200));if(e==null||e._reactInternals===void 0)throw Error(fr(38));return UC(e,t,n,!1,s)};Pu.version="18.3.1-next-f1338f8080-20240426";function W6(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(W6)}catch(e){console.error(e)}}W6(),WN.exports=Pu;var kh=WN.exports;const Vf=yc(kh);var q6,k5=kh;q6=k5.createRoot,k5.hydrateRoot;var X6={exports:{}};(function(e,t){var n={};(function(s,a){e.exports=a()})(fl,function(){var s,a,u;function f(r,C){if(!s)s=C;else if(!a)a=C;else{var k="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+s+")(sharedChunk); ("+a+")(sharedChunk); self.onerror = null;",I={};s(I),u=C(I),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(u.workerUrl=window.URL.createObjectURL(new Blob([k],{type:"text/javascript"})))}}f(["exports"],function(r){function C(d){return d&&d.__esModule&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d}var k,I={},P={};function D(){if(k)return P;k=1,Object.defineProperty(P,"__esModule",{value:!0}),P.setMatrixArrayType=function(v){P.ARRAY_TYPE=i=v},P.toRadian=function(v){return v*h},P.equals=function(v,p){return Math.abs(v-p)<=d*Math.max(1,Math.abs(v),Math.abs(p))},P.RANDOM=P.ARRAY_TYPE=P.EPSILON=void 0;var d=1e-6;P.EPSILON=d;var i=typeof Float32Array<"u"?Float32Array:Array;P.ARRAY_TYPE=i;var l=Math.random;P.RANDOM=l;var h=Math.PI/180;return Math.hypot||(Math.hypot=function(){for(var v=0,p=arguments.length;p--;)v+=arguments[p]*arguments[p];return Math.sqrt(v)}),P}var N,j={};function W(){if(N)return j;function d(p){return d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x},d(p)}N=1,Object.defineProperty(j,"__esModule",{value:!0}),j.create=function(){var p=new i.ARRAY_TYPE(4);return i.ARRAY_TYPE!=Float32Array&&(p[1]=0,p[2]=0),p[0]=1,p[3]=1,p},j.clone=function(p){var x=new i.ARRAY_TYPE(4);return x[0]=p[0],x[1]=p[1],x[2]=p[2],x[3]=p[3],x},j.copy=function(p,x){return p[0]=x[0],p[1]=x[1],p[2]=x[2],p[3]=x[3],p},j.identity=function(p){return p[0]=1,p[1]=0,p[2]=0,p[3]=1,p},j.fromValues=function(p,x,M,z){var V=new i.ARRAY_TYPE(4);return V[0]=p,V[1]=x,V[2]=M,V[3]=z,V},j.set=function(p,x,M,z,V){return p[0]=x,p[1]=M,p[2]=z,p[3]=V,p},j.transpose=function(p,x){if(p===x){var M=x[1];p[1]=x[2],p[2]=M}else p[0]=x[0],p[1]=x[2],p[2]=x[1],p[3]=x[3];return p},j.invert=function(p,x){var M=x[0],z=x[1],V=x[2],E=x[3],L=M*E-V*z;return L?(p[0]=E*(L=1/L),p[1]=-z*L,p[2]=-V*L,p[3]=M*L,p):null},j.adjoint=function(p,x){var M=x[0];return p[0]=x[3],p[1]=-x[1],p[2]=-x[2],p[3]=M,p},j.determinant=function(p){return p[0]*p[3]-p[2]*p[1]},j.multiply=h,j.rotate=function(p,x,M){var z=x[0],V=x[1],E=x[2],L=x[3],B=Math.sin(M),O=Math.cos(M);return p[0]=z*O+E*B,p[1]=V*O+L*B,p[2]=z*-B+E*O,p[3]=V*-B+L*O,p},j.scale=function(p,x,M){var z=x[1],V=x[2],E=x[3],L=M[0],B=M[1];return p[0]=x[0]*L,p[1]=z*L,p[2]=V*B,p[3]=E*B,p},j.fromRotation=function(p,x){var M=Math.sin(x),z=Math.cos(x);return p[0]=z,p[1]=M,p[2]=-M,p[3]=z,p},j.fromScaling=function(p,x){return p[0]=x[0],p[1]=0,p[2]=0,p[3]=x[1],p},j.str=function(p){return"mat2("+p[0]+", "+p[1]+", "+p[2]+", "+p[3]+")"},j.frob=function(p){return Math.hypot(p[0],p[1],p[2],p[3])},j.LDU=function(p,x,M,z){return p[2]=z[2]/z[0],M[0]=z[0],M[1]=z[1],M[3]=z[3]-p[2]*M[1],[p,x,M]},j.add=function(p,x,M){return p[0]=x[0]+M[0],p[1]=x[1]+M[1],p[2]=x[2]+M[2],p[3]=x[3]+M[3],p},j.subtract=v,j.exactEquals=function(p,x){return p[0]===x[0]&&p[1]===x[1]&&p[2]===x[2]&&p[3]===x[3]},j.equals=function(p,x){var M=p[0],z=p[1],V=p[2],E=p[3],L=x[0],B=x[1],O=x[2],F=x[3];return Math.abs(M-L)<=i.EPSILON*Math.max(1,Math.abs(M),Math.abs(L))&&Math.abs(z-B)<=i.EPSILON*Math.max(1,Math.abs(z),Math.abs(B))&&Math.abs(V-O)<=i.EPSILON*Math.max(1,Math.abs(V),Math.abs(O))&&Math.abs(E-F)<=i.EPSILON*Math.max(1,Math.abs(E),Math.abs(F))},j.multiplyScalar=function(p,x,M){return p[0]=x[0]*M,p[1]=x[1]*M,p[2]=x[2]*M,p[3]=x[3]*M,p},j.multiplyScalarAndAdd=function(p,x,M,z){return p[0]=x[0]+M[0]*z,p[1]=x[1]+M[1]*z,p[2]=x[2]+M[2]*z,p[3]=x[3]+M[3]*z,p},j.sub=j.mul=void 0;var i=function(p,x){if(p&&p.__esModule)return p;if(p===null||d(p)!=="object"&&typeof p!="function")return{default:p};var M=l(void 0);if(M&&M.has(p))return M.get(p);var z={},V=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var E in p)if(E!=="default"&&Object.prototype.hasOwnProperty.call(p,E)){var L=V?Object.getOwnPropertyDescriptor(p,E):null;L&&(L.get||L.set)?Object.defineProperty(z,E,L):z[E]=p[E]}return z.default=p,M&&M.set(p,z),z}(D());function l(p){if(typeof WeakMap!="function")return null;var x=new WeakMap,M=new WeakMap;return(l=function(z){return z?M:x})(p)}function h(p,x,M){var z=x[0],V=x[1],E=x[2],L=x[3],B=M[0],O=M[1],F=M[2],G=M[3];return p[0]=z*B+E*O,p[1]=V*B+L*O,p[2]=z*F+E*G,p[3]=V*F+L*G,p}function v(p,x,M){return p[0]=x[0]-M[0],p[1]=x[1]-M[1],p[2]=x[2]-M[2],p[3]=x[3]-M[3],p}return j.mul=h,j.sub=v,j}var H,q={};function Z(){if(H)return q;function d(p){return d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x},d(p)}H=1,Object.defineProperty(q,"__esModule",{value:!0}),q.create=function(){var p=new i.ARRAY_TYPE(6);return i.ARRAY_TYPE!=Float32Array&&(p[1]=0,p[2]=0,p[4]=0,p[5]=0),p[0]=1,p[3]=1,p},q.clone=function(p){var x=new i.ARRAY_TYPE(6);return x[0]=p[0],x[1]=p[1],x[2]=p[2],x[3]=p[3],x[4]=p[4],x[5]=p[5],x},q.copy=function(p,x){return p[0]=x[0],p[1]=x[1],p[2]=x[2],p[3]=x[3],p[4]=x[4],p[5]=x[5],p},q.identity=function(p){return p[0]=1,p[1]=0,p[2]=0,p[3]=1,p[4]=0,p[5]=0,p},q.fromValues=function(p,x,M,z,V,E){var L=new i.ARRAY_TYPE(6);return L[0]=p,L[1]=x,L[2]=M,L[3]=z,L[4]=V,L[5]=E,L},q.set=function(p,x,M,z,V,E,L){return p[0]=x,p[1]=M,p[2]=z,p[3]=V,p[4]=E,p[5]=L,p},q.invert=function(p,x){var M=x[0],z=x[1],V=x[2],E=x[3],L=x[4],B=x[5],O=M*E-z*V;return O?(p[0]=E*(O=1/O),p[1]=-z*O,p[2]=-V*O,p[3]=M*O,p[4]=(V*B-E*L)*O,p[5]=(z*L-M*B)*O,p):null},q.determinant=function(p){return p[0]*p[3]-p[1]*p[2]},q.multiply=h,q.rotate=function(p,x,M){var z=x[0],V=x[1],E=x[2],L=x[3],B=x[4],O=x[5],F=Math.sin(M),G=Math.cos(M);return p[0]=z*G+E*F,p[1]=V*G+L*F,p[2]=z*-F+E*G,p[3]=V*-F+L*G,p[4]=B,p[5]=O,p},q.scale=function(p,x,M){var z=x[1],V=x[2],E=x[3],L=x[4],B=x[5],O=M[0],F=M[1];return p[0]=x[0]*O,p[1]=z*O,p[2]=V*F,p[3]=E*F,p[4]=L,p[5]=B,p},q.translate=function(p,x,M){var z=x[0],V=x[1],E=x[2],L=x[3],B=x[4],O=x[5],F=M[0],G=M[1];return p[0]=z,p[1]=V,p[2]=E,p[3]=L,p[4]=z*F+E*G+B,p[5]=V*F+L*G+O,p},q.fromRotation=function(p,x){var M=Math.sin(x),z=Math.cos(x);return p[0]=z,p[1]=M,p[2]=-M,p[3]=z,p[4]=0,p[5]=0,p},q.fromScaling=function(p,x){return p[0]=x[0],p[1]=0,p[2]=0,p[3]=x[1],p[4]=0,p[5]=0,p},q.fromTranslation=function(p,x){return p[0]=1,p[1]=0,p[2]=0,p[3]=1,p[4]=x[0],p[5]=x[1],p},q.str=function(p){return"mat2d("+p[0]+", "+p[1]+", "+p[2]+", "+p[3]+", "+p[4]+", "+p[5]+")"},q.frob=function(p){return Math.hypot(p[0],p[1],p[2],p[3],p[4],p[5],1)},q.add=function(p,x,M){return p[0]=x[0]+M[0],p[1]=x[1]+M[1],p[2]=x[2]+M[2],p[3]=x[3]+M[3],p[4]=x[4]+M[4],p[5]=x[5]+M[5],p},q.subtract=v,q.multiplyScalar=function(p,x,M){return p[0]=x[0]*M,p[1]=x[1]*M,p[2]=x[2]*M,p[3]=x[3]*M,p[4]=x[4]*M,p[5]=x[5]*M,p},q.multiplyScalarAndAdd=function(p,x,M,z){return p[0]=x[0]+M[0]*z,p[1]=x[1]+M[1]*z,p[2]=x[2]+M[2]*z,p[3]=x[3]+M[3]*z,p[4]=x[4]+M[4]*z,p[5]=x[5]+M[5]*z,p},q.exactEquals=function(p,x){return p[0]===x[0]&&p[1]===x[1]&&p[2]===x[2]&&p[3]===x[3]&&p[4]===x[4]&&p[5]===x[5]},q.equals=function(p,x){var M=p[0],z=p[1],V=p[2],E=p[3],L=p[4],B=p[5],O=x[0],F=x[1],G=x[2],Q=x[3],ie=x[4],pe=x[5];return Math.abs(M-O)<=i.EPSILON*Math.max(1,Math.abs(M),Math.abs(O))&&Math.abs(z-F)<=i.EPSILON*Math.max(1,Math.abs(z),Math.abs(F))&&Math.abs(V-G)<=i.EPSILON*Math.max(1,Math.abs(V),Math.abs(G))&&Math.abs(E-Q)<=i.EPSILON*Math.max(1,Math.abs(E),Math.abs(Q))&&Math.abs(L-ie)<=i.EPSILON*Math.max(1,Math.abs(L),Math.abs(ie))&&Math.abs(B-pe)<=i.EPSILON*Math.max(1,Math.abs(B),Math.abs(pe))},q.sub=q.mul=void 0;var i=function(p,x){if(p&&p.__esModule)return p;if(p===null||d(p)!=="object"&&typeof p!="function")return{default:p};var M=l(void 0);if(M&&M.has(p))return M.get(p);var z={},V=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var E in p)if(E!=="default"&&Object.prototype.hasOwnProperty.call(p,E)){var L=V?Object.getOwnPropertyDescriptor(p,E):null;L&&(L.get||L.set)?Object.defineProperty(z,E,L):z[E]=p[E]}return z.default=p,M&&M.set(p,z),z}(D());function l(p){if(typeof WeakMap!="function")return null;var x=new WeakMap,M=new WeakMap;return(l=function(z){return z?M:x})(p)}function h(p,x,M){var z=x[0],V=x[1],E=x[2],L=x[3],B=x[4],O=x[5],F=M[0],G=M[1],Q=M[2],ie=M[3],pe=M[4],ge=M[5];return p[0]=z*F+E*G,p[1]=V*F+L*G,p[2]=z*Q+E*ie,p[3]=V*Q+L*ie,p[4]=z*pe+E*ge+B,p[5]=V*pe+L*ge+O,p}function v(p,x,M){return p[0]=x[0]-M[0],p[1]=x[1]-M[1],p[2]=x[2]-M[2],p[3]=x[3]-M[3],p[4]=x[4]-M[4],p[5]=x[5]-M[5],p}return q.mul=h,q.sub=v,q}var re,le={};function _e(){if(re)return le;function d(p){return d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x},d(p)}re=1,Object.defineProperty(le,"__esModule",{value:!0}),le.create=function(){var p=new i.ARRAY_TYPE(9);return i.ARRAY_TYPE!=Float32Array&&(p[1]=0,p[2]=0,p[3]=0,p[5]=0,p[6]=0,p[7]=0),p[0]=1,p[4]=1,p[8]=1,p},le.fromMat4=function(p,x){return p[0]=x[0],p[1]=x[1],p[2]=x[2],p[3]=x[4],p[4]=x[5],p[5]=x[6],p[6]=x[8],p[7]=x[9],p[8]=x[10],p},le.clone=function(p){var x=new i.ARRAY_TYPE(9);return x[0]=p[0],x[1]=p[1],x[2]=p[2],x[3]=p[3],x[4]=p[4],x[5]=p[5],x[6]=p[6],x[7]=p[7],x[8]=p[8],x},le.copy=function(p,x){return p[0]=x[0],p[1]=x[1],p[2]=x[2],p[3]=x[3],p[4]=x[4],p[5]=x[5],p[6]=x[6],p[7]=x[7],p[8]=x[8],p},le.fromValues=function(p,x,M,z,V,E,L,B,O){var F=new i.ARRAY_TYPE(9);return F[0]=p,F[1]=x,F[2]=M,F[3]=z,F[4]=V,F[5]=E,F[6]=L,F[7]=B,F[8]=O,F},le.set=function(p,x,M,z,V,E,L,B,O,F){return p[0]=x,p[1]=M,p[2]=z,p[3]=V,p[4]=E,p[5]=L,p[6]=B,p[7]=O,p[8]=F,p},le.identity=function(p){return p[0]=1,p[1]=0,p[2]=0,p[3]=0,p[4]=1,p[5]=0,p[6]=0,p[7]=0,p[8]=1,p},le.transpose=function(p,x){if(p===x){var M=x[1],z=x[2],V=x[5];p[1]=x[3],p[2]=x[6],p[3]=M,p[5]=x[7],p[6]=z,p[7]=V}else p[0]=x[0],p[1]=x[3],p[2]=x[6],p[3]=x[1],p[4]=x[4],p[5]=x[7],p[6]=x[2],p[7]=x[5],p[8]=x[8];return p},le.invert=function(p,x){var M=x[0],z=x[1],V=x[2],E=x[3],L=x[4],B=x[5],O=x[6],F=x[7],G=x[8],Q=G*L-B*F,ie=-G*E+B*O,pe=F*E-L*O,ge=M*Q+z*ie+V*pe;return ge?(p[0]=Q*(ge=1/ge),p[1]=(-G*z+V*F)*ge,p[2]=(B*z-V*L)*ge,p[3]=ie*ge,p[4]=(G*M-V*O)*ge,p[5]=(-B*M+V*E)*ge,p[6]=pe*ge,p[7]=(-F*M+z*O)*ge,p[8]=(L*M-z*E)*ge,p):null},le.adjoint=function(p,x){var M=x[0],z=x[1],V=x[2],E=x[3],L=x[4],B=x[5],O=x[6],F=x[7],G=x[8];return p[0]=L*G-B*F,p[1]=V*F-z*G,p[2]=z*B-V*L,p[3]=B*O-E*G,p[4]=M*G-V*O,p[5]=V*E-M*B,p[6]=E*F-L*O,p[7]=z*O-M*F,p[8]=M*L-z*E,p},le.determinant=function(p){var x=p[3],M=p[4],z=p[5],V=p[6],E=p[7],L=p[8];return p[0]*(L*M-z*E)+p[1]*(-L*x+z*V)+p[2]*(E*x-M*V)},le.multiply=h,le.translate=function(p,x,M){var z=x[0],V=x[1],E=x[2],L=x[3],B=x[4],O=x[5],F=x[6],G=x[7],Q=x[8],ie=M[0],pe=M[1];return p[0]=z,p[1]=V,p[2]=E,p[3]=L,p[4]=B,p[5]=O,p[6]=ie*z+pe*L+F,p[7]=ie*V+pe*B+G,p[8]=ie*E+pe*O+Q,p},le.rotate=function(p,x,M){var z=x[0],V=x[1],E=x[2],L=x[3],B=x[4],O=x[5],F=x[6],G=x[7],Q=x[8],ie=Math.sin(M),pe=Math.cos(M);return p[0]=pe*z+ie*L,p[1]=pe*V+ie*B,p[2]=pe*E+ie*O,p[3]=pe*L-ie*z,p[4]=pe*B-ie*V,p[5]=pe*O-ie*E,p[6]=F,p[7]=G,p[8]=Q,p},le.scale=function(p,x,M){var z=M[0],V=M[1];return p[0]=z*x[0],p[1]=z*x[1],p[2]=z*x[2],p[3]=V*x[3],p[4]=V*x[4],p[5]=V*x[5],p[6]=x[6],p[7]=x[7],p[8]=x[8],p},le.fromTranslation=function(p,x){return p[0]=1,p[1]=0,p[2]=0,p[3]=0,p[4]=1,p[5]=0,p[6]=x[0],p[7]=x[1],p[8]=1,p},le.fromRotation=function(p,x){var M=Math.sin(x),z=Math.cos(x);return p[0]=z,p[1]=M,p[2]=0,p[3]=-M,p[4]=z,p[5]=0,p[6]=0,p[7]=0,p[8]=1,p},le.fromScaling=function(p,x){return p[0]=x[0],p[1]=0,p[2]=0,p[3]=0,p[4]=x[1],p[5]=0,p[6]=0,p[7]=0,p[8]=1,p},le.fromMat2d=function(p,x){return p[0]=x[0],p[1]=x[1],p[2]=0,p[3]=x[2],p[4]=x[3],p[5]=0,p[6]=x[4],p[7]=x[5],p[8]=1,p},le.fromQuat=function(p,x){var M=x[0],z=x[1],V=x[2],E=x[3],L=M+M,B=z+z,O=V+V,F=M*L,G=z*L,Q=z*B,ie=V*L,pe=V*B,ge=V*O,ae=E*L,be=E*B,Te=E*O;return p[0]=1-Q-ge,p[3]=G-Te,p[6]=ie+be,p[1]=G+Te,p[4]=1-F-ge,p[7]=pe-ae,p[2]=ie-be,p[5]=pe+ae,p[8]=1-F-Q,p},le.normalFromMat4=function(p,x){var M=x[0],z=x[1],V=x[2],E=x[3],L=x[4],B=x[5],O=x[6],F=x[7],G=x[8],Q=x[9],ie=x[10],pe=x[11],ge=x[12],ae=x[13],be=x[14],Te=x[15],Be=M*B-z*L,Xe=M*O-V*L,Ze=M*F-E*L,He=z*O-V*B,ct=z*F-E*B,Qe=V*F-E*O,pt=G*ae-Q*ge,St=G*be-ie*ge,Tt=G*Te-pe*ge,It=Q*be-ie*ae,Lt=Q*Te-pe*ae,Yt=ie*Te-pe*be,Rt=Be*Yt-Xe*Lt+Ze*It+He*Tt-ct*St+Qe*pt;return Rt?(p[0]=(B*Yt-O*Lt+F*It)*(Rt=1/Rt),p[1]=(O*Tt-L*Yt-F*St)*Rt,p[2]=(L*Lt-B*Tt+F*pt)*Rt,p[3]=(V*Lt-z*Yt-E*It)*Rt,p[4]=(M*Yt-V*Tt+E*St)*Rt,p[5]=(z*Tt-M*Lt-E*pt)*Rt,p[6]=(ae*Qe-be*ct+Te*He)*Rt,p[7]=(be*Ze-ge*Qe-Te*Xe)*Rt,p[8]=(ge*ct-ae*Ze+Te*Be)*Rt,p):null},le.projection=function(p,x,M){return p[0]=2/x,p[1]=0,p[2]=0,p[3]=0,p[4]=-2/M,p[5]=0,p[6]=-1,p[7]=1,p[8]=1,p},le.str=function(p){return"mat3("+p[0]+", "+p[1]+", "+p[2]+", "+p[3]+", "+p[4]+", "+p[5]+", "+p[6]+", "+p[7]+", "+p[8]+")"},le.frob=function(p){return Math.hypot(p[0],p[1],p[2],p[3],p[4],p[5],p[6],p[7],p[8])},le.add=function(p,x,M){return p[0]=x[0]+M[0],p[1]=x[1]+M[1],p[2]=x[2]+M[2],p[3]=x[3]+M[3],p[4]=x[4]+M[4],p[5]=x[5]+M[5],p[6]=x[6]+M[6],p[7]=x[7]+M[7],p[8]=x[8]+M[8],p},le.subtract=v,le.multiplyScalar=function(p,x,M){return p[0]=x[0]*M,p[1]=x[1]*M,p[2]=x[2]*M,p[3]=x[3]*M,p[4]=x[4]*M,p[5]=x[5]*M,p[6]=x[6]*M,p[7]=x[7]*M,p[8]=x[8]*M,p},le.multiplyScalarAndAdd=function(p,x,M,z){return p[0]=x[0]+M[0]*z,p[1]=x[1]+M[1]*z,p[2]=x[2]+M[2]*z,p[3]=x[3]+M[3]*z,p[4]=x[4]+M[4]*z,p[5]=x[5]+M[5]*z,p[6]=x[6]+M[6]*z,p[7]=x[7]+M[7]*z,p[8]=x[8]+M[8]*z,p},le.exactEquals=function(p,x){return p[0]===x[0]&&p[1]===x[1]&&p[2]===x[2]&&p[3]===x[3]&&p[4]===x[4]&&p[5]===x[5]&&p[6]===x[6]&&p[7]===x[7]&&p[8]===x[8]},le.equals=function(p,x){var M=p[0],z=p[1],V=p[2],E=p[3],L=p[4],B=p[5],O=p[6],F=p[7],G=p[8],Q=x[0],ie=x[1],pe=x[2],ge=x[3],ae=x[4],be=x[5],Te=x[6],Be=x[7],Xe=x[8];return Math.abs(M-Q)<=i.EPSILON*Math.max(1,Math.abs(M),Math.abs(Q))&&Math.abs(z-ie)<=i.EPSILON*Math.max(1,Math.abs(z),Math.abs(ie))&&Math.abs(V-pe)<=i.EPSILON*Math.max(1,Math.abs(V),Math.abs(pe))&&Math.abs(E-ge)<=i.EPSILON*Math.max(1,Math.abs(E),Math.abs(ge))&&Math.abs(L-ae)<=i.EPSILON*Math.max(1,Math.abs(L),Math.abs(ae))&&Math.abs(B-be)<=i.EPSILON*Math.max(1,Math.abs(B),Math.abs(be))&&Math.abs(O-Te)<=i.EPSILON*Math.max(1,Math.abs(O),Math.abs(Te))&&Math.abs(F-Be)<=i.EPSILON*Math.max(1,Math.abs(F),Math.abs(Be))&&Math.abs(G-Xe)<=i.EPSILON*Math.max(1,Math.abs(G),Math.abs(Xe))},le.sub=le.mul=void 0;var i=function(p,x){if(p&&p.__esModule)return p;if(p===null||d(p)!=="object"&&typeof p!="function")return{default:p};var M=l(void 0);if(M&&M.has(p))return M.get(p);var z={},V=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var E in p)if(E!=="default"&&Object.prototype.hasOwnProperty.call(p,E)){var L=V?Object.getOwnPropertyDescriptor(p,E):null;L&&(L.get||L.set)?Object.defineProperty(z,E,L):z[E]=p[E]}return z.default=p,M&&M.set(p,z),z}(D());function l(p){if(typeof WeakMap!="function")return null;var x=new WeakMap,M=new WeakMap;return(l=function(z){return z?M:x})(p)}function h(p,x,M){var z=x[0],V=x[1],E=x[2],L=x[3],B=x[4],O=x[5],F=x[6],G=x[7],Q=x[8],ie=M[0],pe=M[1],ge=M[2],ae=M[3],be=M[4],Te=M[5],Be=M[6],Xe=M[7],Ze=M[8];return p[0]=ie*z+pe*L+ge*F,p[1]=ie*V+pe*B+ge*G,p[2]=ie*E+pe*O+ge*Q,p[3]=ae*z+be*L+Te*F,p[4]=ae*V+be*B+Te*G,p[5]=ae*E+be*O+Te*Q,p[6]=Be*z+Xe*L+Ze*F,p[7]=Be*V+Xe*B+Ze*G,p[8]=Be*E+Xe*O+Ze*Q,p}function v(p,x,M){return p[0]=x[0]-M[0],p[1]=x[1]-M[1],p[2]=x[2]-M[2],p[3]=x[3]-M[3],p[4]=x[4]-M[4],p[5]=x[5]-M[5],p[6]=x[6]-M[6],p[7]=x[7]-M[7],p[8]=x[8]-M[8],p}return le.mul=h,le.sub=v,le}var ye,de={};function ce(){if(ye)return de;function d(E){return d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(L){return typeof L}:function(L){return L&&typeof Symbol=="function"&&L.constructor===Symbol&&L!==Symbol.prototype?"symbol":typeof L},d(E)}ye=1,Object.defineProperty(de,"__esModule",{value:!0}),de.create=function(){var E=new i.ARRAY_TYPE(16);return i.ARRAY_TYPE!=Float32Array&&(E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[6]=0,E[7]=0,E[8]=0,E[9]=0,E[11]=0,E[12]=0,E[13]=0,E[14]=0),E[0]=1,E[5]=1,E[10]=1,E[15]=1,E},de.clone=function(E){var L=new i.ARRAY_TYPE(16);return L[0]=E[0],L[1]=E[1],L[2]=E[2],L[3]=E[3],L[4]=E[4],L[5]=E[5],L[6]=E[6],L[7]=E[7],L[8]=E[8],L[9]=E[9],L[10]=E[10],L[11]=E[11],L[12]=E[12],L[13]=E[13],L[14]=E[14],L[15]=E[15],L},de.copy=function(E,L){return E[0]=L[0],E[1]=L[1],E[2]=L[2],E[3]=L[3],E[4]=L[4],E[5]=L[5],E[6]=L[6],E[7]=L[7],E[8]=L[8],E[9]=L[9],E[10]=L[10],E[11]=L[11],E[12]=L[12],E[13]=L[13],E[14]=L[14],E[15]=L[15],E},de.fromValues=function(E,L,B,O,F,G,Q,ie,pe,ge,ae,be,Te,Be,Xe,Ze){var He=new i.ARRAY_TYPE(16);return He[0]=E,He[1]=L,He[2]=B,He[3]=O,He[4]=F,He[5]=G,He[6]=Q,He[7]=ie,He[8]=pe,He[9]=ge,He[10]=ae,He[11]=be,He[12]=Te,He[13]=Be,He[14]=Xe,He[15]=Ze,He},de.set=function(E,L,B,O,F,G,Q,ie,pe,ge,ae,be,Te,Be,Xe,Ze,He){return E[0]=L,E[1]=B,E[2]=O,E[3]=F,E[4]=G,E[5]=Q,E[6]=ie,E[7]=pe,E[8]=ge,E[9]=ae,E[10]=be,E[11]=Te,E[12]=Be,E[13]=Xe,E[14]=Ze,E[15]=He,E},de.identity=h,de.transpose=function(E,L){if(E===L){var B=L[1],O=L[2],F=L[3],G=L[6],Q=L[7],ie=L[11];E[1]=L[4],E[2]=L[8],E[3]=L[12],E[4]=B,E[6]=L[9],E[7]=L[13],E[8]=O,E[9]=G,E[11]=L[14],E[12]=F,E[13]=Q,E[14]=ie}else E[0]=L[0],E[1]=L[4],E[2]=L[8],E[3]=L[12],E[4]=L[1],E[5]=L[5],E[6]=L[9],E[7]=L[13],E[8]=L[2],E[9]=L[6],E[10]=L[10],E[11]=L[14],E[12]=L[3],E[13]=L[7],E[14]=L[11],E[15]=L[15];return E},de.invert=function(E,L){var B=L[0],O=L[1],F=L[2],G=L[3],Q=L[4],ie=L[5],pe=L[6],ge=L[7],ae=L[8],be=L[9],Te=L[10],Be=L[11],Xe=L[12],Ze=L[13],He=L[14],ct=L[15],Qe=B*ie-O*Q,pt=B*pe-F*Q,St=B*ge-G*Q,Tt=O*pe-F*ie,It=O*ge-G*ie,Lt=F*ge-G*pe,Yt=ae*Ze-be*Xe,Rt=ae*He-Te*Xe,ln=ae*ct-Be*Xe,gn=be*He-Te*Ze,Qt=be*ct-Be*Ze,Qn=Te*ct-Be*He,$n=Qe*Qn-pt*Qt+St*gn+Tt*ln-It*Rt+Lt*Yt;return $n?(E[0]=(ie*Qn-pe*Qt+ge*gn)*($n=1/$n),E[1]=(F*Qt-O*Qn-G*gn)*$n,E[2]=(Ze*Lt-He*It+ct*Tt)*$n,E[3]=(Te*It-be*Lt-Be*Tt)*$n,E[4]=(pe*ln-Q*Qn-ge*Rt)*$n,E[5]=(B*Qn-F*ln+G*Rt)*$n,E[6]=(He*St-Xe*Lt-ct*pt)*$n,E[7]=(ae*Lt-Te*St+Be*pt)*$n,E[8]=(Q*Qt-ie*ln+ge*Yt)*$n,E[9]=(O*ln-B*Qt-G*Yt)*$n,E[10]=(Xe*It-Ze*St+ct*Qe)*$n,E[11]=(be*St-ae*It-Be*Qe)*$n,E[12]=(ie*Rt-Q*gn-pe*Yt)*$n,E[13]=(B*gn-O*Rt+F*Yt)*$n,E[14]=(Ze*pt-Xe*Tt-He*Qe)*$n,E[15]=(ae*Tt-be*pt+Te*Qe)*$n,E):null},de.adjoint=function(E,L){var B=L[0],O=L[1],F=L[2],G=L[3],Q=L[4],ie=L[5],pe=L[6],ge=L[7],ae=L[8],be=L[9],Te=L[10],Be=L[11],Xe=L[12],Ze=L[13],He=L[14],ct=L[15];return E[0]=ie*(Te*ct-Be*He)-be*(pe*ct-ge*He)+Ze*(pe*Be-ge*Te),E[1]=-(O*(Te*ct-Be*He)-be*(F*ct-G*He)+Ze*(F*Be-G*Te)),E[2]=O*(pe*ct-ge*He)-ie*(F*ct-G*He)+Ze*(F*ge-G*pe),E[3]=-(O*(pe*Be-ge*Te)-ie*(F*Be-G*Te)+be*(F*ge-G*pe)),E[4]=-(Q*(Te*ct-Be*He)-ae*(pe*ct-ge*He)+Xe*(pe*Be-ge*Te)),E[5]=B*(Te*ct-Be*He)-ae*(F*ct-G*He)+Xe*(F*Be-G*Te),E[6]=-(B*(pe*ct-ge*He)-Q*(F*ct-G*He)+Xe*(F*ge-G*pe)),E[7]=B*(pe*Be-ge*Te)-Q*(F*Be-G*Te)+ae*(F*ge-G*pe),E[8]=Q*(be*ct-Be*Ze)-ae*(ie*ct-ge*Ze)+Xe*(ie*Be-ge*be),E[9]=-(B*(be*ct-Be*Ze)-ae*(O*ct-G*Ze)+Xe*(O*Be-G*be)),E[10]=B*(ie*ct-ge*Ze)-Q*(O*ct-G*Ze)+Xe*(O*ge-G*ie),E[11]=-(B*(ie*Be-ge*be)-Q*(O*Be-G*be)+ae*(O*ge-G*ie)),E[12]=-(Q*(be*He-Te*Ze)-ae*(ie*He-pe*Ze)+Xe*(ie*Te-pe*be)),E[13]=B*(be*He-Te*Ze)-ae*(O*He-F*Ze)+Xe*(O*Te-F*be),E[14]=-(B*(ie*He-pe*Ze)-Q*(O*He-F*Ze)+Xe*(O*pe-F*ie)),E[15]=B*(ie*Te-pe*be)-Q*(O*Te-F*be)+ae*(O*pe-F*ie),E},de.determinant=function(E){var L=E[0],B=E[1],O=E[2],F=E[3],G=E[4],Q=E[5],ie=E[6],pe=E[7],ge=E[8],ae=E[9],be=E[10],Te=E[11],Be=E[12],Xe=E[13],Ze=E[14],He=E[15];return(L*Q-B*G)*(be*He-Te*Ze)-(L*ie-O*G)*(ae*He-Te*Xe)+(L*pe-F*G)*(ae*Ze-be*Xe)+(B*ie-O*Q)*(ge*He-Te*Be)-(B*pe-F*Q)*(ge*Ze-be*Be)+(O*pe-F*ie)*(ge*Xe-ae*Be)},de.multiply=v,de.translate=function(E,L,B){var O,F,G,Q,ie,pe,ge,ae,be,Te,Be,Xe,Ze=B[0],He=B[1],ct=B[2];return L===E?(E[12]=L[0]*Ze+L[4]*He+L[8]*ct+L[12],E[13]=L[1]*Ze+L[5]*He+L[9]*ct+L[13],E[14]=L[2]*Ze+L[6]*He+L[10]*ct+L[14],E[15]=L[3]*Ze+L[7]*He+L[11]*ct+L[15]):(F=L[1],G=L[2],Q=L[3],ie=L[4],pe=L[5],ge=L[6],ae=L[7],be=L[8],Te=L[9],Be=L[10],Xe=L[11],E[0]=O=L[0],E[1]=F,E[2]=G,E[3]=Q,E[4]=ie,E[5]=pe,E[6]=ge,E[7]=ae,E[8]=be,E[9]=Te,E[10]=Be,E[11]=Xe,E[12]=O*Ze+ie*He+be*ct+L[12],E[13]=F*Ze+pe*He+Te*ct+L[13],E[14]=G*Ze+ge*He+Be*ct+L[14],E[15]=Q*Ze+ae*He+Xe*ct+L[15]),E},de.scale=function(E,L,B){var O=B[0],F=B[1],G=B[2];return E[0]=L[0]*O,E[1]=L[1]*O,E[2]=L[2]*O,E[3]=L[3]*O,E[4]=L[4]*F,E[5]=L[5]*F,E[6]=L[6]*F,E[7]=L[7]*F,E[8]=L[8]*G,E[9]=L[9]*G,E[10]=L[10]*G,E[11]=L[11]*G,E[12]=L[12],E[13]=L[13],E[14]=L[14],E[15]=L[15],E},de.rotate=function(E,L,B,O){var F,G,Q,ie,pe,ge,ae,be,Te,Be,Xe,Ze,He,ct,Qe,pt,St,Tt,It,Lt,Yt,Rt,ln,gn,Qt=O[0],Qn=O[1],$n=O[2],kn=Math.hypot(Qt,Qn,$n);return kn<i.EPSILON?null:(Qt*=kn=1/kn,Qn*=kn,$n*=kn,F=Math.sin(B),G=Math.cos(B),pe=L[1],ge=L[2],ae=L[3],Te=L[5],Be=L[6],Xe=L[7],He=L[9],ct=L[10],Qe=L[11],pt=Qt*Qt*(Q=1-G)+G,It=Qt*Qn*Q-$n*F,Lt=Qn*Qn*Q+G,Yt=$n*Qn*Q+Qt*F,Rt=Qt*$n*Q+Qn*F,ln=Qn*$n*Q-Qt*F,gn=$n*$n*Q+G,E[0]=(ie=L[0])*pt+(be=L[4])*(St=Qn*Qt*Q+$n*F)+(Ze=L[8])*(Tt=$n*Qt*Q-Qn*F),E[1]=pe*pt+Te*St+He*Tt,E[2]=ge*pt+Be*St+ct*Tt,E[3]=ae*pt+Xe*St+Qe*Tt,E[4]=ie*It+be*Lt+Ze*Yt,E[5]=pe*It+Te*Lt+He*Yt,E[6]=ge*It+Be*Lt+ct*Yt,E[7]=ae*It+Xe*Lt+Qe*Yt,E[8]=ie*Rt+be*ln+Ze*gn,E[9]=pe*Rt+Te*ln+He*gn,E[10]=ge*Rt+Be*ln+ct*gn,E[11]=ae*Rt+Xe*ln+Qe*gn,L!==E&&(E[12]=L[12],E[13]=L[13],E[14]=L[14],E[15]=L[15]),E)},de.rotateX=function(E,L,B){var O=Math.sin(B),F=Math.cos(B),G=L[4],Q=L[5],ie=L[6],pe=L[7],ge=L[8],ae=L[9],be=L[10],Te=L[11];return L!==E&&(E[0]=L[0],E[1]=L[1],E[2]=L[2],E[3]=L[3],E[12]=L[12],E[13]=L[13],E[14]=L[14],E[15]=L[15]),E[4]=G*F+ge*O,E[5]=Q*F+ae*O,E[6]=ie*F+be*O,E[7]=pe*F+Te*O,E[8]=ge*F-G*O,E[9]=ae*F-Q*O,E[10]=be*F-ie*O,E[11]=Te*F-pe*O,E},de.rotateY=function(E,L,B){var O=Math.sin(B),F=Math.cos(B),G=L[0],Q=L[1],ie=L[2],pe=L[3],ge=L[8],ae=L[9],be=L[10],Te=L[11];return L!==E&&(E[4]=L[4],E[5]=L[5],E[6]=L[6],E[7]=L[7],E[12]=L[12],E[13]=L[13],E[14]=L[14],E[15]=L[15]),E[0]=G*F-ge*O,E[1]=Q*F-ae*O,E[2]=ie*F-be*O,E[3]=pe*F-Te*O,E[8]=G*O+ge*F,E[9]=Q*O+ae*F,E[10]=ie*O+be*F,E[11]=pe*O+Te*F,E},de.rotateZ=function(E,L,B){var O=Math.sin(B),F=Math.cos(B),G=L[0],Q=L[1],ie=L[2],pe=L[3],ge=L[4],ae=L[5],be=L[6],Te=L[7];return L!==E&&(E[8]=L[8],E[9]=L[9],E[10]=L[10],E[11]=L[11],E[12]=L[12],E[13]=L[13],E[14]=L[14],E[15]=L[15]),E[0]=G*F+ge*O,E[1]=Q*F+ae*O,E[2]=ie*F+be*O,E[3]=pe*F+Te*O,E[4]=ge*F-G*O,E[5]=ae*F-Q*O,E[6]=be*F-ie*O,E[7]=Te*F-pe*O,E},de.fromTranslation=function(E,L){return E[0]=1,E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[5]=1,E[6]=0,E[7]=0,E[8]=0,E[9]=0,E[10]=1,E[11]=0,E[12]=L[0],E[13]=L[1],E[14]=L[2],E[15]=1,E},de.fromScaling=function(E,L){return E[0]=L[0],E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[5]=L[1],E[6]=0,E[7]=0,E[8]=0,E[9]=0,E[10]=L[2],E[11]=0,E[12]=0,E[13]=0,E[14]=0,E[15]=1,E},de.fromRotation=function(E,L,B){var O,F,G,Q=B[0],ie=B[1],pe=B[2],ge=Math.hypot(Q,ie,pe);return ge<i.EPSILON?null:(Q*=ge=1/ge,ie*=ge,pe*=ge,O=Math.sin(L),F=Math.cos(L),E[0]=Q*Q*(G=1-F)+F,E[1]=ie*Q*G+pe*O,E[2]=pe*Q*G-ie*O,E[3]=0,E[4]=Q*ie*G-pe*O,E[5]=ie*ie*G+F,E[6]=pe*ie*G+Q*O,E[7]=0,E[8]=Q*pe*G+ie*O,E[9]=ie*pe*G-Q*O,E[10]=pe*pe*G+F,E[11]=0,E[12]=0,E[13]=0,E[14]=0,E[15]=1,E)},de.fromXRotation=function(E,L){var B=Math.sin(L),O=Math.cos(L);return E[0]=1,E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[5]=O,E[6]=B,E[7]=0,E[8]=0,E[9]=-B,E[10]=O,E[11]=0,E[12]=0,E[13]=0,E[14]=0,E[15]=1,E},de.fromYRotation=function(E,L){var B=Math.sin(L),O=Math.cos(L);return E[0]=O,E[1]=0,E[2]=-B,E[3]=0,E[4]=0,E[5]=1,E[6]=0,E[7]=0,E[8]=B,E[9]=0,E[10]=O,E[11]=0,E[12]=0,E[13]=0,E[14]=0,E[15]=1,E},de.fromZRotation=function(E,L){var B=Math.sin(L),O=Math.cos(L);return E[0]=O,E[1]=B,E[2]=0,E[3]=0,E[4]=-B,E[5]=O,E[6]=0,E[7]=0,E[8]=0,E[9]=0,E[10]=1,E[11]=0,E[12]=0,E[13]=0,E[14]=0,E[15]=1,E},de.fromRotationTranslation=p,de.fromQuat2=function(E,L){var B=new i.ARRAY_TYPE(3),O=-L[0],F=-L[1],G=-L[2],Q=L[3],ie=L[4],pe=L[5],ge=L[6],ae=L[7],be=O*O+F*F+G*G+Q*Q;return be>0?(B[0]=2*(ie*Q+ae*O+pe*G-ge*F)/be,B[1]=2*(pe*Q+ae*F+ge*O-ie*G)/be,B[2]=2*(ge*Q+ae*G+ie*F-pe*O)/be):(B[0]=2*(ie*Q+ae*O+pe*G-ge*F),B[1]=2*(pe*Q+ae*F+ge*O-ie*G),B[2]=2*(ge*Q+ae*G+ie*F-pe*O)),p(E,L,B),E},de.getTranslation=function(E,L){return E[0]=L[12],E[1]=L[13],E[2]=L[14],E},de.getScaling=x,de.getRotation=function(E,L){var B=new i.ARRAY_TYPE(3);x(B,L);var O=1/B[0],F=1/B[1],G=1/B[2],Q=L[0]*O,ie=L[1]*F,pe=L[2]*G,ge=L[4]*O,ae=L[5]*F,be=L[6]*G,Te=L[8]*O,Be=L[9]*F,Xe=L[10]*G,Ze=Q+ae+Xe,He=0;return Ze>0?(He=2*Math.sqrt(Ze+1),E[3]=.25*He,E[0]=(be-Be)/He,E[1]=(Te-pe)/He,E[2]=(ie-ge)/He):Q>ae&&Q>Xe?(He=2*Math.sqrt(1+Q-ae-Xe),E[3]=(be-Be)/He,E[0]=.25*He,E[1]=(ie+ge)/He,E[2]=(Te+pe)/He):ae>Xe?(He=2*Math.sqrt(1+ae-Q-Xe),E[3]=(Te-pe)/He,E[0]=(ie+ge)/He,E[1]=.25*He,E[2]=(be+Be)/He):(He=2*Math.sqrt(1+Xe-Q-ae),E[3]=(ie-ge)/He,E[0]=(Te+pe)/He,E[1]=(be+Be)/He,E[2]=.25*He),E},de.fromRotationTranslationScale=function(E,L,B,O){var F=L[0],G=L[1],Q=L[2],ie=L[3],pe=F+F,ge=G+G,ae=Q+Q,be=F*pe,Te=F*ge,Be=F*ae,Xe=G*ge,Ze=G*ae,He=Q*ae,ct=ie*pe,Qe=ie*ge,pt=ie*ae,St=O[0],Tt=O[1],It=O[2];return E[0]=(1-(Xe+He))*St,E[1]=(Te+pt)*St,E[2]=(Be-Qe)*St,E[3]=0,E[4]=(Te-pt)*Tt,E[5]=(1-(be+He))*Tt,E[6]=(Ze+ct)*Tt,E[7]=0,E[8]=(Be+Qe)*It,E[9]=(Ze-ct)*It,E[10]=(1-(be+Xe))*It,E[11]=0,E[12]=B[0],E[13]=B[1],E[14]=B[2],E[15]=1,E},de.fromRotationTranslationScaleOrigin=function(E,L,B,O,F){var G=L[0],Q=L[1],ie=L[2],pe=L[3],ge=G+G,ae=Q+Q,be=ie+ie,Te=G*ge,Be=G*ae,Xe=G*be,Ze=Q*ae,He=Q*be,ct=ie*be,Qe=pe*ge,pt=pe*ae,St=pe*be,Tt=O[0],It=O[1],Lt=O[2],Yt=F[0],Rt=F[1],ln=F[2],gn=(1-(Ze+ct))*Tt,Qt=(Be+St)*Tt,Qn=(Xe-pt)*Tt,$n=(Be-St)*It,kn=(1-(Te+ct))*It,vn=(He+Qe)*It,br=(Xe+pt)*Lt,Zn=(He-Qe)*Lt,nr=(1-(Te+Ze))*Lt;return E[0]=gn,E[1]=Qt,E[2]=Qn,E[3]=0,E[4]=$n,E[5]=kn,E[6]=vn,E[7]=0,E[8]=br,E[9]=Zn,E[10]=nr,E[11]=0,E[12]=B[0]+Yt-(gn*Yt+$n*Rt+br*ln),E[13]=B[1]+Rt-(Qt*Yt+kn*Rt+Zn*ln),E[14]=B[2]+ln-(Qn*Yt+vn*Rt+nr*ln),E[15]=1,E},de.fromQuat=function(E,L){var B=L[0],O=L[1],F=L[2],G=L[3],Q=B+B,ie=O+O,pe=F+F,ge=B*Q,ae=O*Q,be=O*ie,Te=F*Q,Be=F*ie,Xe=F*pe,Ze=G*Q,He=G*ie,ct=G*pe;return E[0]=1-be-Xe,E[1]=ae+ct,E[2]=Te-He,E[3]=0,E[4]=ae-ct,E[5]=1-ge-Xe,E[6]=Be+Ze,E[7]=0,E[8]=Te+He,E[9]=Be-Ze,E[10]=1-ge-be,E[11]=0,E[12]=0,E[13]=0,E[14]=0,E[15]=1,E},de.frustum=function(E,L,B,O,F,G,Q){var ie=1/(B-L),pe=1/(F-O),ge=1/(G-Q);return E[0]=2*G*ie,E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[5]=2*G*pe,E[6]=0,E[7]=0,E[8]=(B+L)*ie,E[9]=(F+O)*pe,E[10]=(Q+G)*ge,E[11]=-1,E[12]=0,E[13]=0,E[14]=Q*G*2*ge,E[15]=0,E},de.perspectiveNO=M,de.perspectiveZO=function(E,L,B,O,F){var G,Q=1/Math.tan(L/2);return E[0]=Q/B,E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[5]=Q,E[6]=0,E[7]=0,E[8]=0,E[9]=0,E[11]=-1,E[12]=0,E[13]=0,E[15]=0,F!=null&&F!==1/0?(E[10]=F*(G=1/(O-F)),E[14]=F*O*G):(E[10]=-1,E[14]=-O),E},de.perspectiveFromFieldOfView=function(E,L,B,O){var F=Math.tan(L.upDegrees*Math.PI/180),G=Math.tan(L.downDegrees*Math.PI/180),Q=Math.tan(L.leftDegrees*Math.PI/180),ie=Math.tan(L.rightDegrees*Math.PI/180),pe=2/(Q+ie),ge=2/(F+G);return E[0]=pe,E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[5]=ge,E[6]=0,E[7]=0,E[8]=-(Q-ie)*pe*.5,E[9]=(F-G)*ge*.5,E[10]=O/(B-O),E[11]=-1,E[12]=0,E[13]=0,E[14]=O*B/(B-O),E[15]=0,E},de.orthoNO=z,de.orthoZO=function(E,L,B,O,F,G,Q){var ie=1/(L-B),pe=1/(O-F),ge=1/(G-Q);return E[0]=-2*ie,E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[5]=-2*pe,E[6]=0,E[7]=0,E[8]=0,E[9]=0,E[10]=ge,E[11]=0,E[12]=(L+B)*ie,E[13]=(F+O)*pe,E[14]=G*ge,E[15]=1,E},de.lookAt=function(E,L,B,O){var F,G,Q,ie,pe,ge,ae,be,Te,Be,Xe=L[0],Ze=L[1],He=L[2],ct=O[0],Qe=O[1],pt=O[2],St=B[0],Tt=B[1],It=B[2];return Math.abs(Xe-St)<i.EPSILON&&Math.abs(Ze-Tt)<i.EPSILON&&Math.abs(He-It)<i.EPSILON?h(E):(ae=Xe-St,be=Ze-Tt,Te=He-It,F=Qe*(Te*=Be=1/Math.hypot(ae,be,Te))-pt*(be*=Be),G=pt*(ae*=Be)-ct*Te,Q=ct*be-Qe*ae,(Be=Math.hypot(F,G,Q))?(F*=Be=1/Be,G*=Be,Q*=Be):(F=0,G=0,Q=0),ie=be*Q-Te*G,pe=Te*F-ae*Q,ge=ae*G-be*F,(Be=Math.hypot(ie,pe,ge))?(ie*=Be=1/Be,pe*=Be,ge*=Be):(ie=0,pe=0,ge=0),E[0]=F,E[1]=ie,E[2]=ae,E[3]=0,E[4]=G,E[5]=pe,E[6]=be,E[7]=0,E[8]=Q,E[9]=ge,E[10]=Te,E[11]=0,E[12]=-(F*Xe+G*Ze+Q*He),E[13]=-(ie*Xe+pe*Ze+ge*He),E[14]=-(ae*Xe+be*Ze+Te*He),E[15]=1,E)},de.targetTo=function(E,L,B,O){var F=L[0],G=L[1],Q=L[2],ie=O[0],pe=O[1],ge=O[2],ae=F-B[0],be=G-B[1],Te=Q-B[2],Be=ae*ae+be*be+Te*Te;Be>0&&(ae*=Be=1/Math.sqrt(Be),be*=Be,Te*=Be);var Xe=pe*Te-ge*be,Ze=ge*ae-ie*Te,He=ie*be-pe*ae;return(Be=Xe*Xe+Ze*Ze+He*He)>0&&(Xe*=Be=1/Math.sqrt(Be),Ze*=Be,He*=Be),E[0]=Xe,E[1]=Ze,E[2]=He,E[3]=0,E[4]=be*He-Te*Ze,E[5]=Te*Xe-ae*He,E[6]=ae*Ze-be*Xe,E[7]=0,E[8]=ae,E[9]=be,E[10]=Te,E[11]=0,E[12]=F,E[13]=G,E[14]=Q,E[15]=1,E},de.str=function(E){return"mat4("+E[0]+", "+E[1]+", "+E[2]+", "+E[3]+", "+E[4]+", "+E[5]+", "+E[6]+", "+E[7]+", "+E[8]+", "+E[9]+", "+E[10]+", "+E[11]+", "+E[12]+", "+E[13]+", "+E[14]+", "+E[15]+")"},de.frob=function(E){return Math.hypot(E[0],E[1],E[2],E[3],E[4],E[5],E[6],E[7],E[8],E[9],E[10],E[11],E[12],E[13],E[14],E[15])},de.add=function(E,L,B){return E[0]=L[0]+B[0],E[1]=L[1]+B[1],E[2]=L[2]+B[2],E[3]=L[3]+B[3],E[4]=L[4]+B[4],E[5]=L[5]+B[5],E[6]=L[6]+B[6],E[7]=L[7]+B[7],E[8]=L[8]+B[8],E[9]=L[9]+B[9],E[10]=L[10]+B[10],E[11]=L[11]+B[11],E[12]=L[12]+B[12],E[13]=L[13]+B[13],E[14]=L[14]+B[14],E[15]=L[15]+B[15],E},de.subtract=V,de.multiplyScalar=function(E,L,B){return E[0]=L[0]*B,E[1]=L[1]*B,E[2]=L[2]*B,E[3]=L[3]*B,E[4]=L[4]*B,E[5]=L[5]*B,E[6]=L[6]*B,E[7]=L[7]*B,E[8]=L[8]*B,E[9]=L[9]*B,E[10]=L[10]*B,E[11]=L[11]*B,E[12]=L[12]*B,E[13]=L[13]*B,E[14]=L[14]*B,E[15]=L[15]*B,E},de.multiplyScalarAndAdd=function(E,L,B,O){return E[0]=L[0]+B[0]*O,E[1]=L[1]+B[1]*O,E[2]=L[2]+B[2]*O,E[3]=L[3]+B[3]*O,E[4]=L[4]+B[4]*O,E[5]=L[5]+B[5]*O,E[6]=L[6]+B[6]*O,E[7]=L[7]+B[7]*O,E[8]=L[8]+B[8]*O,E[9]=L[9]+B[9]*O,E[10]=L[10]+B[10]*O,E[11]=L[11]+B[11]*O,E[12]=L[12]+B[12]*O,E[13]=L[13]+B[13]*O,E[14]=L[14]+B[14]*O,E[15]=L[15]+B[15]*O,E},de.exactEquals=function(E,L){return E[0]===L[0]&&E[1]===L[1]&&E[2]===L[2]&&E[3]===L[3]&&E[4]===L[4]&&E[5]===L[5]&&E[6]===L[6]&&E[7]===L[7]&&E[8]===L[8]&&E[9]===L[9]&&E[10]===L[10]&&E[11]===L[11]&&E[12]===L[12]&&E[13]===L[13]&&E[14]===L[14]&&E[15]===L[15]},de.equals=function(E,L){var B=E[0],O=E[1],F=E[2],G=E[3],Q=E[4],ie=E[5],pe=E[6],ge=E[7],ae=E[8],be=E[9],Te=E[10],Be=E[11],Xe=E[12],Ze=E[13],He=E[14],ct=E[15],Qe=L[0],pt=L[1],St=L[2],Tt=L[3],It=L[4],Lt=L[5],Yt=L[6],Rt=L[7],ln=L[8],gn=L[9],Qt=L[10],Qn=L[11],$n=L[12],kn=L[13],vn=L[14],br=L[15];return Math.abs(B-Qe)<=i.EPSILON*Math.max(1,Math.abs(B),Math.abs(Qe))&&Math.abs(O-pt)<=i.EPSILON*Math.max(1,Math.abs(O),Math.abs(pt))&&Math.abs(F-St)<=i.EPSILON*Math.max(1,Math.abs(F),Math.abs(St))&&Math.abs(G-Tt)<=i.EPSILON*Math.max(1,Math.abs(G),Math.abs(Tt))&&Math.abs(Q-It)<=i.EPSILON*Math.max(1,Math.abs(Q),Math.abs(It))&&Math.abs(ie-Lt)<=i.EPSILON*Math.max(1,Math.abs(ie),Math.abs(Lt))&&Math.abs(pe-Yt)<=i.EPSILON*Math.max(1,Math.abs(pe),Math.abs(Yt))&&Math.abs(ge-Rt)<=i.EPSILON*Math.max(1,Math.abs(ge),Math.abs(Rt))&&Math.abs(ae-ln)<=i.EPSILON*Math.max(1,Math.abs(ae),Math.abs(ln))&&Math.abs(be-gn)<=i.EPSILON*Math.max(1,Math.abs(be),Math.abs(gn))&&Math.abs(Te-Qt)<=i.EPSILON*Math.max(1,Math.abs(Te),Math.abs(Qt))&&Math.abs(Be-Qn)<=i.EPSILON*Math.max(1,Math.abs(Be),Math.abs(Qn))&&Math.abs(Xe-$n)<=i.EPSILON*Math.max(1,Math.abs(Xe),Math.abs($n))&&Math.abs(Ze-kn)<=i.EPSILON*Math.max(1,Math.abs(Ze),Math.abs(kn))&&Math.abs(He-vn)<=i.EPSILON*Math.max(1,Math.abs(He),Math.abs(vn))&&Math.abs(ct-br)<=i.EPSILON*Math.max(1,Math.abs(ct),Math.abs(br))},de.sub=de.mul=de.ortho=de.perspective=void 0;var i=function(E,L){if(E&&E.__esModule)return E;if(E===null||d(E)!=="object"&&typeof E!="function")return{default:E};var B=l(void 0);if(B&&B.has(E))return B.get(E);var O={},F=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var G in E)if(G!=="default"&&Object.prototype.hasOwnProperty.call(E,G)){var Q=F?Object.getOwnPropertyDescriptor(E,G):null;Q&&(Q.get||Q.set)?Object.defineProperty(O,G,Q):O[G]=E[G]}return O.default=E,B&&B.set(E,O),O}(D());function l(E){if(typeof WeakMap!="function")return null;var L=new WeakMap,B=new WeakMap;return(l=function(O){return O?B:L})(E)}function h(E){return E[0]=1,E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[5]=1,E[6]=0,E[7]=0,E[8]=0,E[9]=0,E[10]=1,E[11]=0,E[12]=0,E[13]=0,E[14]=0,E[15]=1,E}function v(E,L,B){var O=L[0],F=L[1],G=L[2],Q=L[3],ie=L[4],pe=L[5],ge=L[6],ae=L[7],be=L[8],Te=L[9],Be=L[10],Xe=L[11],Ze=L[12],He=L[13],ct=L[14],Qe=L[15],pt=B[0],St=B[1],Tt=B[2],It=B[3];return E[0]=pt*O+St*ie+Tt*be+It*Ze,E[1]=pt*F+St*pe+Tt*Te+It*He,E[2]=pt*G+St*ge+Tt*Be+It*ct,E[3]=pt*Q+St*ae+Tt*Xe+It*Qe,E[4]=(pt=B[4])*O+(St=B[5])*ie+(Tt=B[6])*be+(It=B[7])*Ze,E[5]=pt*F+St*pe+Tt*Te+It*He,E[6]=pt*G+St*ge+Tt*Be+It*ct,E[7]=pt*Q+St*ae+Tt*Xe+It*Qe,E[8]=(pt=B[8])*O+(St=B[9])*ie+(Tt=B[10])*be+(It=B[11])*Ze,E[9]=pt*F+St*pe+Tt*Te+It*He,E[10]=pt*G+St*ge+Tt*Be+It*ct,E[11]=pt*Q+St*ae+Tt*Xe+It*Qe,E[12]=(pt=B[12])*O+(St=B[13])*ie+(Tt=B[14])*be+(It=B[15])*Ze,E[13]=pt*F+St*pe+Tt*Te+It*He,E[14]=pt*G+St*ge+Tt*Be+It*ct,E[15]=pt*Q+St*ae+Tt*Xe+It*Qe,E}function p(E,L,B){var O=L[0],F=L[1],G=L[2],Q=L[3],ie=O+O,pe=F+F,ge=G+G,ae=O*ie,be=O*pe,Te=O*ge,Be=F*pe,Xe=F*ge,Ze=G*ge,He=Q*ie,ct=Q*pe,Qe=Q*ge;return E[0]=1-(Be+Ze),E[1]=be+Qe,E[2]=Te-ct,E[3]=0,E[4]=be-Qe,E[5]=1-(ae+Ze),E[6]=Xe+He,E[7]=0,E[8]=Te+ct,E[9]=Xe-He,E[10]=1-(ae+Be),E[11]=0,E[12]=B[0],E[13]=B[1],E[14]=B[2],E[15]=1,E}function x(E,L){var B=L[4],O=L[5],F=L[6],G=L[8],Q=L[9],ie=L[10];return E[0]=Math.hypot(L[0],L[1],L[2]),E[1]=Math.hypot(B,O,F),E[2]=Math.hypot(G,Q,ie),E}function M(E,L,B,O,F){var G,Q=1/Math.tan(L/2);return E[0]=Q/B,E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[5]=Q,E[6]=0,E[7]=0,E[8]=0,E[9]=0,E[11]=-1,E[12]=0,E[13]=0,E[15]=0,F!=null&&F!==1/0?(E[10]=(F+O)*(G=1/(O-F)),E[14]=2*F*O*G):(E[10]=-1,E[14]=-2*O),E}function z(E,L,B,O,F,G,Q){var ie=1/(L-B),pe=1/(O-F),ge=1/(G-Q);return E[0]=-2*ie,E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[5]=-2*pe,E[6]=0,E[7]=0,E[8]=0,E[9]=0,E[10]=2*ge,E[11]=0,E[12]=(L+B)*ie,E[13]=(F+O)*pe,E[14]=(Q+G)*ge,E[15]=1,E}function V(E,L,B){return E[0]=L[0]-B[0],E[1]=L[1]-B[1],E[2]=L[2]-B[2],E[3]=L[3]-B[3],E[4]=L[4]-B[4],E[5]=L[5]-B[5],E[6]=L[6]-B[6],E[7]=L[7]-B[7],E[8]=L[8]-B[8],E[9]=L[9]-B[9],E[10]=L[10]-B[10],E[11]=L[11]-B[11],E[12]=L[12]-B[12],E[13]=L[13]-B[13],E[14]=L[14]-B[14],E[15]=L[15]-B[15],E}return de.perspective=M,de.ortho=z,de.mul=v,de.sub=V,de}var oe,xe={},he={};function Ee(){if(oe)return he;function d(F){return d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(G){return typeof G}:function(G){return G&&typeof Symbol=="function"&&G.constructor===Symbol&&G!==Symbol.prototype?"symbol":typeof G},d(F)}oe=1,Object.defineProperty(he,"__esModule",{value:!0}),he.create=h,he.clone=function(F){var G=new i.ARRAY_TYPE(3);return G[0]=F[0],G[1]=F[1],G[2]=F[2],G},he.length=v,he.fromValues=function(F,G,Q){var ie=new i.ARRAY_TYPE(3);return ie[0]=F,ie[1]=G,ie[2]=Q,ie},he.copy=function(F,G){return F[0]=G[0],F[1]=G[1],F[2]=G[2],F},he.set=function(F,G,Q,ie){return F[0]=G,F[1]=Q,F[2]=ie,F},he.add=function(F,G,Q){return F[0]=G[0]+Q[0],F[1]=G[1]+Q[1],F[2]=G[2]+Q[2],F},he.subtract=p,he.multiply=x,he.divide=M,he.ceil=function(F,G){return F[0]=Math.ceil(G[0]),F[1]=Math.ceil(G[1]),F[2]=Math.ceil(G[2]),F},he.floor=function(F,G){return F[0]=Math.floor(G[0]),F[1]=Math.floor(G[1]),F[2]=Math.floor(G[2]),F},he.min=function(F,G,Q){return F[0]=Math.min(G[0],Q[0]),F[1]=Math.min(G[1],Q[1]),F[2]=Math.min(G[2],Q[2]),F},he.max=function(F,G,Q){return F[0]=Math.max(G[0],Q[0]),F[1]=Math.max(G[1],Q[1]),F[2]=Math.max(G[2],Q[2]),F},he.round=function(F,G){return F[0]=Math.round(G[0]),F[1]=Math.round(G[1]),F[2]=Math.round(G[2]),F},he.scale=function(F,G,Q){return F[0]=G[0]*Q,F[1]=G[1]*Q,F[2]=G[2]*Q,F},he.scaleAndAdd=function(F,G,Q,ie){return F[0]=G[0]+Q[0]*ie,F[1]=G[1]+Q[1]*ie,F[2]=G[2]+Q[2]*ie,F},he.distance=z,he.squaredDistance=V,he.squaredLength=E,he.negate=function(F,G){return F[0]=-G[0],F[1]=-G[1],F[2]=-G[2],F},he.inverse=function(F,G){return F[0]=1/G[0],F[1]=1/G[1],F[2]=1/G[2],F},he.normalize=function(F,G){var Q=G[0],ie=G[1],pe=G[2],ge=Q*Q+ie*ie+pe*pe;return ge>0&&(ge=1/Math.sqrt(ge)),F[0]=G[0]*ge,F[1]=G[1]*ge,F[2]=G[2]*ge,F},he.dot=L,he.cross=function(F,G,Q){var ie=G[0],pe=G[1],ge=G[2],ae=Q[0],be=Q[1],Te=Q[2];return F[0]=pe*Te-ge*be,F[1]=ge*ae-ie*Te,F[2]=ie*be-pe*ae,F},he.lerp=function(F,G,Q,ie){var pe=G[0],ge=G[1],ae=G[2];return F[0]=pe+ie*(Q[0]-pe),F[1]=ge+ie*(Q[1]-ge),F[2]=ae+ie*(Q[2]-ae),F},he.hermite=function(F,G,Q,ie,pe,ge){var ae=ge*ge,be=ae*(2*ge-3)+1,Te=ae*(ge-2)+ge,Be=ae*(ge-1),Xe=ae*(3-2*ge);return F[0]=G[0]*be+Q[0]*Te+ie[0]*Be+pe[0]*Xe,F[1]=G[1]*be+Q[1]*Te+ie[1]*Be+pe[1]*Xe,F[2]=G[2]*be+Q[2]*Te+ie[2]*Be+pe[2]*Xe,F},he.bezier=function(F,G,Q,ie,pe,ge){var ae=1-ge,be=ae*ae,Te=ge*ge,Be=be*ae,Xe=3*ge*be,Ze=3*Te*ae,He=Te*ge;return F[0]=G[0]*Be+Q[0]*Xe+ie[0]*Ze+pe[0]*He,F[1]=G[1]*Be+Q[1]*Xe+ie[1]*Ze+pe[1]*He,F[2]=G[2]*Be+Q[2]*Xe+ie[2]*Ze+pe[2]*He,F},he.random=function(F,G){G=G||1;var Q=2*i.RANDOM()*Math.PI,ie=2*i.RANDOM()-1,pe=Math.sqrt(1-ie*ie)*G;return F[0]=Math.cos(Q)*pe,F[1]=Math.sin(Q)*pe,F[2]=ie*G,F},he.transformMat4=function(F,G,Q){var ie=G[0],pe=G[1],ge=G[2],ae=Q[3]*ie+Q[7]*pe+Q[11]*ge+Q[15];return F[0]=(Q[0]*ie+Q[4]*pe+Q[8]*ge+Q[12])/(ae=ae||1),F[1]=(Q[1]*ie+Q[5]*pe+Q[9]*ge+Q[13])/ae,F[2]=(Q[2]*ie+Q[6]*pe+Q[10]*ge+Q[14])/ae,F},he.transformMat3=function(F,G,Q){var ie=G[0],pe=G[1],ge=G[2];return F[0]=ie*Q[0]+pe*Q[3]+ge*Q[6],F[1]=ie*Q[1]+pe*Q[4]+ge*Q[7],F[2]=ie*Q[2]+pe*Q[5]+ge*Q[8],F},he.transformQuat=function(F,G,Q){var ie=Q[0],pe=Q[1],ge=Q[2],ae=G[0],be=G[1],Te=G[2],Be=pe*Te-ge*be,Xe=ge*ae-ie*Te,Ze=ie*be-pe*ae,He=pe*Ze-ge*Xe,ct=ge*Be-ie*Ze,Qe=ie*Xe-pe*Be,pt=2*Q[3];return Xe*=pt,Ze*=pt,ct*=2,Qe*=2,F[0]=ae+(Be*=pt)+(He*=2),F[1]=be+Xe+ct,F[2]=Te+Ze+Qe,F},he.rotateX=function(F,G,Q,ie){var pe=[],ge=[];return pe[0]=G[0]-Q[0],pe[1]=G[1]-Q[1],pe[2]=G[2]-Q[2],ge[0]=pe[0],ge[1]=pe[1]*Math.cos(ie)-pe[2]*Math.sin(ie),ge[2]=pe[1]*Math.sin(ie)+pe[2]*Math.cos(ie),F[0]=ge[0]+Q[0],F[1]=ge[1]+Q[1],F[2]=ge[2]+Q[2],F},he.rotateY=function(F,G,Q,ie){var pe=[],ge=[];return pe[0]=G[0]-Q[0],pe[1]=G[1]-Q[1],pe[2]=G[2]-Q[2],ge[0]=pe[2]*Math.sin(ie)+pe[0]*Math.cos(ie),ge[1]=pe[1],ge[2]=pe[2]*Math.cos(ie)-pe[0]*Math.sin(ie),F[0]=ge[0]+Q[0],F[1]=ge[1]+Q[1],F[2]=ge[2]+Q[2],F},he.rotateZ=function(F,G,Q,ie){var pe=[],ge=[];return pe[0]=G[0]-Q[0],pe[1]=G[1]-Q[1],pe[2]=G[2]-Q[2],ge[0]=pe[0]*Math.cos(ie)-pe[1]*Math.sin(ie),ge[1]=pe[0]*Math.sin(ie)+pe[1]*Math.cos(ie),ge[2]=pe[2],F[0]=ge[0]+Q[0],F[1]=ge[1]+Q[1],F[2]=ge[2]+Q[2],F},he.angle=function(F,G){var Q=F[0],ie=F[1],pe=F[2],ge=G[0],ae=G[1],be=G[2],Te=Math.sqrt(Q*Q+ie*ie+pe*pe)*Math.sqrt(ge*ge+ae*ae+be*be),Be=Te&&L(F,G)/Te;return Math.acos(Math.min(Math.max(Be,-1),1))},he.zero=function(F){return F[0]=0,F[1]=0,F[2]=0,F},he.str=function(F){return"vec3("+F[0]+", "+F[1]+", "+F[2]+")"},he.exactEquals=function(F,G){return F[0]===G[0]&&F[1]===G[1]&&F[2]===G[2]},he.equals=function(F,G){var Q=F[0],ie=F[1],pe=F[2],ge=G[0],ae=G[1],be=G[2];return Math.abs(Q-ge)<=i.EPSILON*Math.max(1,Math.abs(Q),Math.abs(ge))&&Math.abs(ie-ae)<=i.EPSILON*Math.max(1,Math.abs(ie),Math.abs(ae))&&Math.abs(pe-be)<=i.EPSILON*Math.max(1,Math.abs(pe),Math.abs(be))},he.forEach=he.sqrLen=he.len=he.sqrDist=he.dist=he.div=he.mul=he.sub=void 0;var i=function(F,G){if(F&&F.__esModule)return F;if(F===null||d(F)!=="object"&&typeof F!="function")return{default:F};var Q=l(void 0);if(Q&&Q.has(F))return Q.get(F);var ie={},pe=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ge in F)if(ge!=="default"&&Object.prototype.hasOwnProperty.call(F,ge)){var ae=pe?Object.getOwnPropertyDescriptor(F,ge):null;ae&&(ae.get||ae.set)?Object.defineProperty(ie,ge,ae):ie[ge]=F[ge]}return ie.default=F,Q&&Q.set(F,ie),ie}(D());function l(F){if(typeof WeakMap!="function")return null;var G=new WeakMap,Q=new WeakMap;return(l=function(ie){return ie?Q:G})(F)}function h(){var F=new i.ARRAY_TYPE(3);return i.ARRAY_TYPE!=Float32Array&&(F[0]=0,F[1]=0,F[2]=0),F}function v(F){return Math.hypot(F[0],F[1],F[2])}function p(F,G,Q){return F[0]=G[0]-Q[0],F[1]=G[1]-Q[1],F[2]=G[2]-Q[2],F}function x(F,G,Q){return F[0]=G[0]*Q[0],F[1]=G[1]*Q[1],F[2]=G[2]*Q[2],F}function M(F,G,Q){return F[0]=G[0]/Q[0],F[1]=G[1]/Q[1],F[2]=G[2]/Q[2],F}function z(F,G){return Math.hypot(G[0]-F[0],G[1]-F[1],G[2]-F[2])}function V(F,G){var Q=G[0]-F[0],ie=G[1]-F[1],pe=G[2]-F[2];return Q*Q+ie*ie+pe*pe}function E(F){var G=F[0],Q=F[1],ie=F[2];return G*G+Q*Q+ie*ie}function L(F,G){return F[0]*G[0]+F[1]*G[1]+F[2]*G[2]}he.sub=p,he.mul=x,he.div=M,he.dist=z,he.sqrDist=V,he.len=v,he.sqrLen=E;var B,O=(B=h(),function(F,G,Q,ie,pe,ge){var ae,be;for(G||(G=3),Q||(Q=0),be=ie?Math.min(ie*G+Q,F.length):F.length,ae=Q;ae<be;ae+=G)B[0]=F[ae],B[1]=F[ae+1],B[2]=F[ae+2],pe(B,B,ge),F[ae]=B[0],F[ae+1]=B[1],F[ae+2]=B[2];return F});return he.forEach=O,he}var se,we,Se={};function Pe(){if(se)return Se;function d(O){return d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(F){return typeof F}:function(F){return F&&typeof Symbol=="function"&&F.constructor===Symbol&&F!==Symbol.prototype?"symbol":typeof F},d(O)}se=1,Object.defineProperty(Se,"__esModule",{value:!0}),Se.create=h,Se.clone=function(O){var F=new i.ARRAY_TYPE(4);return F[0]=O[0],F[1]=O[1],F[2]=O[2],F[3]=O[3],F},Se.fromValues=function(O,F,G,Q){var ie=new i.ARRAY_TYPE(4);return ie[0]=O,ie[1]=F,ie[2]=G,ie[3]=Q,ie},Se.copy=function(O,F){return O[0]=F[0],O[1]=F[1],O[2]=F[2],O[3]=F[3],O},Se.set=function(O,F,G,Q,ie){return O[0]=F,O[1]=G,O[2]=Q,O[3]=ie,O},Se.add=function(O,F,G){return O[0]=F[0]+G[0],O[1]=F[1]+G[1],O[2]=F[2]+G[2],O[3]=F[3]+G[3],O},Se.subtract=v,Se.multiply=p,Se.divide=x,Se.ceil=function(O,F){return O[0]=Math.ceil(F[0]),O[1]=Math.ceil(F[1]),O[2]=Math.ceil(F[2]),O[3]=Math.ceil(F[3]),O},Se.floor=function(O,F){return O[0]=Math.floor(F[0]),O[1]=Math.floor(F[1]),O[2]=Math.floor(F[2]),O[3]=Math.floor(F[3]),O},Se.min=function(O,F,G){return O[0]=Math.min(F[0],G[0]),O[1]=Math.min(F[1],G[1]),O[2]=Math.min(F[2],G[2]),O[3]=Math.min(F[3],G[3]),O},Se.max=function(O,F,G){return O[0]=Math.max(F[0],G[0]),O[1]=Math.max(F[1],G[1]),O[2]=Math.max(F[2],G[2]),O[3]=Math.max(F[3],G[3]),O},Se.round=function(O,F){return O[0]=Math.round(F[0]),O[1]=Math.round(F[1]),O[2]=Math.round(F[2]),O[3]=Math.round(F[3]),O},Se.scale=function(O,F,G){return O[0]=F[0]*G,O[1]=F[1]*G,O[2]=F[2]*G,O[3]=F[3]*G,O},Se.scaleAndAdd=function(O,F,G,Q){return O[0]=F[0]+G[0]*Q,O[1]=F[1]+G[1]*Q,O[2]=F[2]+G[2]*Q,O[3]=F[3]+G[3]*Q,O},Se.distance=M,Se.squaredDistance=z,Se.length=V,Se.squaredLength=E,Se.negate=function(O,F){return O[0]=-F[0],O[1]=-F[1],O[2]=-F[2],O[3]=-F[3],O},Se.inverse=function(O,F){return O[0]=1/F[0],O[1]=1/F[1],O[2]=1/F[2],O[3]=1/F[3],O},Se.normalize=function(O,F){var G=F[0],Q=F[1],ie=F[2],pe=F[3],ge=G*G+Q*Q+ie*ie+pe*pe;return ge>0&&(ge=1/Math.sqrt(ge)),O[0]=G*ge,O[1]=Q*ge,O[2]=ie*ge,O[3]=pe*ge,O},Se.dot=function(O,F){return O[0]*F[0]+O[1]*F[1]+O[2]*F[2]+O[3]*F[3]},Se.cross=function(O,F,G,Q){var ie=G[0]*Q[1]-G[1]*Q[0],pe=G[0]*Q[2]-G[2]*Q[0],ge=G[0]*Q[3]-G[3]*Q[0],ae=G[1]*Q[2]-G[2]*Q[1],be=G[1]*Q[3]-G[3]*Q[1],Te=G[2]*Q[3]-G[3]*Q[2],Be=F[0],Xe=F[1],Ze=F[2],He=F[3];return O[0]=Xe*Te-Ze*be+He*ae,O[1]=-Be*Te+Ze*ge-He*pe,O[2]=Be*be-Xe*ge+He*ie,O[3]=-Be*ae+Xe*pe-Ze*ie,O},Se.lerp=function(O,F,G,Q){var ie=F[0],pe=F[1],ge=F[2],ae=F[3];return O[0]=ie+Q*(G[0]-ie),O[1]=pe+Q*(G[1]-pe),O[2]=ge+Q*(G[2]-ge),O[3]=ae+Q*(G[3]-ae),O},Se.random=function(O,F){var G,Q,ie,pe,ge,ae;F=F||1;do ge=(G=2*i.RANDOM()-1)*G+(Q=2*i.RANDOM()-1)*Q;while(ge>=1);do ae=(ie=2*i.RANDOM()-1)*ie+(pe=2*i.RANDOM()-1)*pe;while(ae>=1);var be=Math.sqrt((1-ge)/ae);return O[0]=F*G,O[1]=F*Q,O[2]=F*ie*be,O[3]=F*pe*be,O},Se.transformMat4=function(O,F,G){var Q=F[0],ie=F[1],pe=F[2],ge=F[3];return O[0]=G[0]*Q+G[4]*ie+G[8]*pe+G[12]*ge,O[1]=G[1]*Q+G[5]*ie+G[9]*pe+G[13]*ge,O[2]=G[2]*Q+G[6]*ie+G[10]*pe+G[14]*ge,O[3]=G[3]*Q+G[7]*ie+G[11]*pe+G[15]*ge,O},Se.transformQuat=function(O,F,G){var Q=F[0],ie=F[1],pe=F[2],ge=G[0],ae=G[1],be=G[2],Te=G[3],Be=Te*Q+ae*pe-be*ie,Xe=Te*ie+be*Q-ge*pe,Ze=Te*pe+ge*ie-ae*Q,He=-ge*Q-ae*ie-be*pe;return O[0]=Be*Te+He*-ge+Xe*-be-Ze*-ae,O[1]=Xe*Te+He*-ae+Ze*-ge-Be*-be,O[2]=Ze*Te+He*-be+Be*-ae-Xe*-ge,O[3]=F[3],O},Se.zero=function(O){return O[0]=0,O[1]=0,O[2]=0,O[3]=0,O},Se.str=function(O){return"vec4("+O[0]+", "+O[1]+", "+O[2]+", "+O[3]+")"},Se.exactEquals=function(O,F){return O[0]===F[0]&&O[1]===F[1]&&O[2]===F[2]&&O[3]===F[3]},Se.equals=function(O,F){var G=O[0],Q=O[1],ie=O[2],pe=O[3],ge=F[0],ae=F[1],be=F[2],Te=F[3];return Math.abs(G-ge)<=i.EPSILON*Math.max(1,Math.abs(G),Math.abs(ge))&&Math.abs(Q-ae)<=i.EPSILON*Math.max(1,Math.abs(Q),Math.abs(ae))&&Math.abs(ie-be)<=i.EPSILON*Math.max(1,Math.abs(ie),Math.abs(be))&&Math.abs(pe-Te)<=i.EPSILON*Math.max(1,Math.abs(pe),Math.abs(Te))},Se.forEach=Se.sqrLen=Se.len=Se.sqrDist=Se.dist=Se.div=Se.mul=Se.sub=void 0;var i=function(O,F){if(O&&O.__esModule)return O;if(O===null||d(O)!=="object"&&typeof O!="function")return{default:O};var G=l(void 0);if(G&&G.has(O))return G.get(O);var Q={},ie=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var pe in O)if(pe!=="default"&&Object.prototype.hasOwnProperty.call(O,pe)){var ge=ie?Object.getOwnPropertyDescriptor(O,pe):null;ge&&(ge.get||ge.set)?Object.defineProperty(Q,pe,ge):Q[pe]=O[pe]}return Q.default=O,G&&G.set(O,Q),Q}(D());function l(O){if(typeof WeakMap!="function")return null;var F=new WeakMap,G=new WeakMap;return(l=function(Q){return Q?G:F})(O)}function h(){var O=new i.ARRAY_TYPE(4);return i.ARRAY_TYPE!=Float32Array&&(O[0]=0,O[1]=0,O[2]=0,O[3]=0),O}function v(O,F,G){return O[0]=F[0]-G[0],O[1]=F[1]-G[1],O[2]=F[2]-G[2],O[3]=F[3]-G[3],O}function p(O,F,G){return O[0]=F[0]*G[0],O[1]=F[1]*G[1],O[2]=F[2]*G[2],O[3]=F[3]*G[3],O}function x(O,F,G){return O[0]=F[0]/G[0],O[1]=F[1]/G[1],O[2]=F[2]/G[2],O[3]=F[3]/G[3],O}function M(O,F){return Math.hypot(F[0]-O[0],F[1]-O[1],F[2]-O[2],F[3]-O[3])}function z(O,F){var G=F[0]-O[0],Q=F[1]-O[1],ie=F[2]-O[2],pe=F[3]-O[3];return G*G+Q*Q+ie*ie+pe*pe}function V(O){return Math.hypot(O[0],O[1],O[2],O[3])}function E(O){var F=O[0],G=O[1],Q=O[2],ie=O[3];return F*F+G*G+Q*Q+ie*ie}Se.sub=v,Se.mul=p,Se.div=x,Se.dist=M,Se.sqrDist=z,Se.len=V,Se.sqrLen=E;var L,B=(L=h(),function(O,F,G,Q,ie,pe){var ge,ae;for(F||(F=4),G||(G=0),ae=Q?Math.min(Q*F+G,O.length):O.length,ge=G;ge<ae;ge+=F)L[0]=O[ge],L[1]=O[ge+1],L[2]=O[ge+2],L[3]=O[ge+3],ie(L,L,pe),O[ge]=L[0],O[ge+1]=L[1],O[ge+2]=L[2],O[ge+3]=L[3];return O});return Se.forEach=B,Se}function Me(){if(we)return xe;function d(Qe){return d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(pt){return typeof pt}:function(pt){return pt&&typeof Symbol=="function"&&pt.constructor===Symbol&&pt!==Symbol.prototype?"symbol":typeof pt},d(Qe)}we=1,Object.defineProperty(xe,"__esModule",{value:!0}),xe.create=M,xe.identity=function(Qe){return Qe[0]=0,Qe[1]=0,Qe[2]=0,Qe[3]=1,Qe},xe.setAxisAngle=z,xe.getAxisAngle=function(Qe,pt){var St=2*Math.acos(pt[3]),Tt=Math.sin(St/2);return Tt>i.EPSILON?(Qe[0]=pt[0]/Tt,Qe[1]=pt[1]/Tt,Qe[2]=pt[2]/Tt):(Qe[0]=1,Qe[1]=0,Qe[2]=0),St},xe.getAngle=function(Qe,pt){var St=G(Qe,pt);return Math.acos(2*St*St-1)},xe.multiply=V,xe.rotateX=function(Qe,pt,St){St*=.5;var Tt=pt[0],It=pt[1],Lt=pt[2],Yt=pt[3],Rt=Math.sin(St),ln=Math.cos(St);return Qe[0]=Tt*ln+Yt*Rt,Qe[1]=It*ln+Lt*Rt,Qe[2]=Lt*ln-It*Rt,Qe[3]=Yt*ln-Tt*Rt,Qe},xe.rotateY=function(Qe,pt,St){St*=.5;var Tt=pt[0],It=pt[1],Lt=pt[2],Yt=pt[3],Rt=Math.sin(St),ln=Math.cos(St);return Qe[0]=Tt*ln-Lt*Rt,Qe[1]=It*ln+Yt*Rt,Qe[2]=Lt*ln+Tt*Rt,Qe[3]=Yt*ln-It*Rt,Qe},xe.rotateZ=function(Qe,pt,St){St*=.5;var Tt=pt[0],It=pt[1],Lt=pt[2],Yt=pt[3],Rt=Math.sin(St),ln=Math.cos(St);return Qe[0]=Tt*ln+It*Rt,Qe[1]=It*ln-Tt*Rt,Qe[2]=Lt*ln+Yt*Rt,Qe[3]=Yt*ln-Lt*Rt,Qe},xe.calculateW=function(Qe,pt){var St=pt[0],Tt=pt[1],It=pt[2];return Qe[0]=St,Qe[1]=Tt,Qe[2]=It,Qe[3]=Math.sqrt(Math.abs(1-St*St-Tt*Tt-It*It)),Qe},xe.exp=E,xe.ln=L,xe.pow=function(Qe,pt,St){return L(Qe,pt),F(Qe,Qe,St),E(Qe,Qe),Qe},xe.slerp=B,xe.random=function(Qe){var pt=i.RANDOM(),St=i.RANDOM(),Tt=i.RANDOM(),It=Math.sqrt(1-pt),Lt=Math.sqrt(pt);return Qe[0]=It*Math.sin(2*Math.PI*St),Qe[1]=It*Math.cos(2*Math.PI*St),Qe[2]=Lt*Math.sin(2*Math.PI*Tt),Qe[3]=Lt*Math.cos(2*Math.PI*Tt),Qe},xe.invert=function(Qe,pt){var St=pt[0],Tt=pt[1],It=pt[2],Lt=pt[3],Yt=St*St+Tt*Tt+It*It+Lt*Lt,Rt=Yt?1/Yt:0;return Qe[0]=-St*Rt,Qe[1]=-Tt*Rt,Qe[2]=-It*Rt,Qe[3]=Lt*Rt,Qe},xe.conjugate=function(Qe,pt){return Qe[0]=-pt[0],Qe[1]=-pt[1],Qe[2]=-pt[2],Qe[3]=pt[3],Qe},xe.fromMat3=O,xe.fromEuler=function(Qe,pt,St,Tt){var It=.5*Math.PI/180;pt*=It,St*=It,Tt*=It;var Lt=Math.sin(pt),Yt=Math.cos(pt),Rt=Math.sin(St),ln=Math.cos(St),gn=Math.sin(Tt),Qt=Math.cos(Tt);return Qe[0]=Lt*ln*Qt-Yt*Rt*gn,Qe[1]=Yt*Rt*Qt+Lt*ln*gn,Qe[2]=Yt*ln*gn-Lt*Rt*Qt,Qe[3]=Yt*ln*Qt+Lt*Rt*gn,Qe},xe.str=function(Qe){return"quat("+Qe[0]+", "+Qe[1]+", "+Qe[2]+", "+Qe[3]+")"},xe.setAxes=xe.sqlerp=xe.rotationTo=xe.equals=xe.exactEquals=xe.normalize=xe.sqrLen=xe.squaredLength=xe.len=xe.length=xe.lerp=xe.dot=xe.scale=xe.mul=xe.add=xe.set=xe.copy=xe.fromValues=xe.clone=void 0;var i=x(D()),l=x(_e()),h=x(Ee()),v=x(Pe());function p(Qe){if(typeof WeakMap!="function")return null;var pt=new WeakMap,St=new WeakMap;return(p=function(Tt){return Tt?St:pt})(Qe)}function x(Qe,pt){if(Qe&&Qe.__esModule)return Qe;if(Qe===null||d(Qe)!=="object"&&typeof Qe!="function")return{default:Qe};var St=p(pt);if(St&&St.has(Qe))return St.get(Qe);var Tt={},It=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Lt in Qe)if(Lt!=="default"&&Object.prototype.hasOwnProperty.call(Qe,Lt)){var Yt=It?Object.getOwnPropertyDescriptor(Qe,Lt):null;Yt&&(Yt.get||Yt.set)?Object.defineProperty(Tt,Lt,Yt):Tt[Lt]=Qe[Lt]}return Tt.default=Qe,St&&St.set(Qe,Tt),Tt}function M(){var Qe=new i.ARRAY_TYPE(4);return i.ARRAY_TYPE!=Float32Array&&(Qe[0]=0,Qe[1]=0,Qe[2]=0),Qe[3]=1,Qe}function z(Qe,pt,St){St*=.5;var Tt=Math.sin(St);return Qe[0]=Tt*pt[0],Qe[1]=Tt*pt[1],Qe[2]=Tt*pt[2],Qe[3]=Math.cos(St),Qe}function V(Qe,pt,St){var Tt=pt[0],It=pt[1],Lt=pt[2],Yt=pt[3],Rt=St[0],ln=St[1],gn=St[2],Qt=St[3];return Qe[0]=Tt*Qt+Yt*Rt+It*gn-Lt*ln,Qe[1]=It*Qt+Yt*ln+Lt*Rt-Tt*gn,Qe[2]=Lt*Qt+Yt*gn+Tt*ln-It*Rt,Qe[3]=Yt*Qt-Tt*Rt-It*ln-Lt*gn,Qe}function E(Qe,pt){var St=pt[0],Tt=pt[1],It=pt[2],Lt=pt[3],Yt=Math.sqrt(St*St+Tt*Tt+It*It),Rt=Math.exp(Lt),ln=Yt>0?Rt*Math.sin(Yt)/Yt:0;return Qe[0]=St*ln,Qe[1]=Tt*ln,Qe[2]=It*ln,Qe[3]=Rt*Math.cos(Yt),Qe}function L(Qe,pt){var St=pt[0],Tt=pt[1],It=pt[2],Lt=pt[3],Yt=Math.sqrt(St*St+Tt*Tt+It*It),Rt=Yt>0?Math.atan2(Yt,Lt)/Yt:0;return Qe[0]=St*Rt,Qe[1]=Tt*Rt,Qe[2]=It*Rt,Qe[3]=.5*Math.log(St*St+Tt*Tt+It*It+Lt*Lt),Qe}function B(Qe,pt,St,Tt){var It,Lt,Yt,Rt,ln,gn=pt[0],Qt=pt[1],Qn=pt[2],$n=pt[3],kn=St[0],vn=St[1],br=St[2],Zn=St[3];return(Lt=gn*kn+Qt*vn+Qn*br+$n*Zn)<0&&(Lt=-Lt,kn=-kn,vn=-vn,br=-br,Zn=-Zn),1-Lt>i.EPSILON?(It=Math.acos(Lt),Yt=Math.sin(It),Rt=Math.sin((1-Tt)*It)/Yt,ln=Math.sin(Tt*It)/Yt):(Rt=1-Tt,ln=Tt),Qe[0]=Rt*gn+ln*kn,Qe[1]=Rt*Qt+ln*vn,Qe[2]=Rt*Qn+ln*br,Qe[3]=Rt*$n+ln*Zn,Qe}function O(Qe,pt){var St,Tt=pt[0]+pt[4]+pt[8];if(Tt>0)St=Math.sqrt(Tt+1),Qe[3]=.5*St,Qe[0]=(pt[5]-pt[7])*(St=.5/St),Qe[1]=(pt[6]-pt[2])*St,Qe[2]=(pt[1]-pt[3])*St;else{var It=0;pt[4]>pt[0]&&(It=1),pt[8]>pt[3*It+It]&&(It=2);var Lt=(It+1)%3,Yt=(It+2)%3;St=Math.sqrt(pt[3*It+It]-pt[3*Lt+Lt]-pt[3*Yt+Yt]+1),Qe[It]=.5*St,Qe[3]=(pt[3*Lt+Yt]-pt[3*Yt+Lt])*(St=.5/St),Qe[Lt]=(pt[3*Lt+It]+pt[3*It+Lt])*St,Qe[Yt]=(pt[3*Yt+It]+pt[3*It+Yt])*St}return Qe}xe.clone=v.clone,xe.fromValues=v.fromValues,xe.copy=v.copy,xe.set=v.set,xe.add=v.add,xe.mul=V;var F=v.scale;xe.scale=F;var G=v.dot;xe.dot=G,xe.lerp=v.lerp;var Q=v.length;xe.length=Q,xe.len=Q;var ie=v.squaredLength;xe.squaredLength=ie,xe.sqrLen=ie;var pe=v.normalize;xe.normalize=pe,xe.exactEquals=v.exactEquals,xe.equals=v.equals;var ge,ae,be,Te=(ge=h.create(),ae=h.fromValues(1,0,0),be=h.fromValues(0,1,0),function(Qe,pt,St){var Tt=h.dot(pt,St);return Tt<-.999999?(h.cross(ge,ae,pt),h.len(ge)<1e-6&&h.cross(ge,be,pt),h.normalize(ge,ge),z(Qe,ge,Math.PI),Qe):Tt>.999999?(Qe[0]=0,Qe[1]=0,Qe[2]=0,Qe[3]=1,Qe):(h.cross(ge,pt,St),Qe[0]=ge[0],Qe[1]=ge[1],Qe[2]=ge[2],Qe[3]=1+Tt,pe(Qe,Qe))});xe.rotationTo=Te;var Be,Xe,Ze=(Be=M(),Xe=M(),function(Qe,pt,St,Tt,It,Lt){return B(Be,pt,It,Lt),B(Xe,St,Tt,Lt),B(Qe,Be,Xe,2*Lt*(1-Lt)),Qe});xe.sqlerp=Ze;var He,ct=(He=l.create(),function(Qe,pt,St,Tt){return He[0]=St[0],He[3]=St[1],He[6]=St[2],He[1]=Tt[0],He[4]=Tt[1],He[7]=Tt[2],He[2]=-pt[0],He[5]=-pt[1],He[8]=-pt[2],pe(Qe,O(Qe,He))});return xe.setAxes=ct,xe}var Re,Oe={};function $e(){if(Re)return Oe;function d(B){return d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(O){return typeof O}:function(O){return O&&typeof Symbol=="function"&&O.constructor===Symbol&&O!==Symbol.prototype?"symbol":typeof O},d(B)}Re=1,Object.defineProperty(Oe,"__esModule",{value:!0}),Oe.create=function(){var B=new i.ARRAY_TYPE(8);return i.ARRAY_TYPE!=Float32Array&&(B[0]=0,B[1]=0,B[2]=0,B[4]=0,B[5]=0,B[6]=0,B[7]=0),B[3]=1,B},Oe.clone=function(B){var O=new i.ARRAY_TYPE(8);return O[0]=B[0],O[1]=B[1],O[2]=B[2],O[3]=B[3],O[4]=B[4],O[5]=B[5],O[6]=B[6],O[7]=B[7],O},Oe.fromValues=function(B,O,F,G,Q,ie,pe,ge){var ae=new i.ARRAY_TYPE(8);return ae[0]=B,ae[1]=O,ae[2]=F,ae[3]=G,ae[4]=Q,ae[5]=ie,ae[6]=pe,ae[7]=ge,ae},Oe.fromRotationTranslationValues=function(B,O,F,G,Q,ie,pe){var ge=new i.ARRAY_TYPE(8);ge[0]=B,ge[1]=O,ge[2]=F,ge[3]=G;var ae=.5*Q,be=.5*ie,Te=.5*pe;return ge[4]=ae*G+be*F-Te*O,ge[5]=be*G+Te*B-ae*F,ge[6]=Te*G+ae*O-be*B,ge[7]=-ae*B-be*O-Te*F,ge},Oe.fromRotationTranslation=x,Oe.fromTranslation=function(B,O){return B[0]=0,B[1]=0,B[2]=0,B[3]=1,B[4]=.5*O[0],B[5]=.5*O[1],B[6]=.5*O[2],B[7]=0,B},Oe.fromRotation=function(B,O){return B[0]=O[0],B[1]=O[1],B[2]=O[2],B[3]=O[3],B[4]=0,B[5]=0,B[6]=0,B[7]=0,B},Oe.fromMat4=function(B,O){var F=l.create();h.getRotation(F,O);var G=new i.ARRAY_TYPE(3);return h.getTranslation(G,O),x(B,F,G),B},Oe.copy=M,Oe.identity=function(B){return B[0]=0,B[1]=0,B[2]=0,B[3]=1,B[4]=0,B[5]=0,B[6]=0,B[7]=0,B},Oe.set=function(B,O,F,G,Q,ie,pe,ge,ae){return B[0]=O,B[1]=F,B[2]=G,B[3]=Q,B[4]=ie,B[5]=pe,B[6]=ge,B[7]=ae,B},Oe.getDual=function(B,O){return B[0]=O[4],B[1]=O[5],B[2]=O[6],B[3]=O[7],B},Oe.setDual=function(B,O){return B[4]=O[0],B[5]=O[1],B[6]=O[2],B[7]=O[3],B},Oe.getTranslation=function(B,O){var F=O[4],G=O[5],Q=O[6],ie=O[7],pe=-O[0],ge=-O[1],ae=-O[2],be=O[3];return B[0]=2*(F*be+ie*pe+G*ae-Q*ge),B[1]=2*(G*be+ie*ge+Q*pe-F*ae),B[2]=2*(Q*be+ie*ae+F*ge-G*pe),B},Oe.translate=function(B,O,F){var G=O[0],Q=O[1],ie=O[2],pe=O[3],ge=.5*F[0],ae=.5*F[1],be=.5*F[2],Te=O[4],Be=O[5],Xe=O[6],Ze=O[7];return B[0]=G,B[1]=Q,B[2]=ie,B[3]=pe,B[4]=pe*ge+Q*be-ie*ae+Te,B[5]=pe*ae+ie*ge-G*be+Be,B[6]=pe*be+G*ae-Q*ge+Xe,B[7]=-G*ge-Q*ae-ie*be+Ze,B},Oe.rotateX=function(B,O,F){var G=-O[0],Q=-O[1],ie=-O[2],pe=O[3],ge=O[4],ae=O[5],be=O[6],Te=O[7],Be=ge*pe+Te*G+ae*ie-be*Q,Xe=ae*pe+Te*Q+be*G-ge*ie,Ze=be*pe+Te*ie+ge*Q-ae*G,He=Te*pe-ge*G-ae*Q-be*ie;return l.rotateX(B,O,F),B[4]=Be*(pe=B[3])+He*(G=B[0])+Xe*(ie=B[2])-Ze*(Q=B[1]),B[5]=Xe*pe+He*Q+Ze*G-Be*ie,B[6]=Ze*pe+He*ie+Be*Q-Xe*G,B[7]=He*pe-Be*G-Xe*Q-Ze*ie,B},Oe.rotateY=function(B,O,F){var G=-O[0],Q=-O[1],ie=-O[2],pe=O[3],ge=O[4],ae=O[5],be=O[6],Te=O[7],Be=ge*pe+Te*G+ae*ie-be*Q,Xe=ae*pe+Te*Q+be*G-ge*ie,Ze=be*pe+Te*ie+ge*Q-ae*G,He=Te*pe-ge*G-ae*Q-be*ie;return l.rotateY(B,O,F),B[4]=Be*(pe=B[3])+He*(G=B[0])+Xe*(ie=B[2])-Ze*(Q=B[1]),B[5]=Xe*pe+He*Q+Ze*G-Be*ie,B[6]=Ze*pe+He*ie+Be*Q-Xe*G,B[7]=He*pe-Be*G-Xe*Q-Ze*ie,B},Oe.rotateZ=function(B,O,F){var G=-O[0],Q=-O[1],ie=-O[2],pe=O[3],ge=O[4],ae=O[5],be=O[6],Te=O[7],Be=ge*pe+Te*G+ae*ie-be*Q,Xe=ae*pe+Te*Q+be*G-ge*ie,Ze=be*pe+Te*ie+ge*Q-ae*G,He=Te*pe-ge*G-ae*Q-be*ie;return l.rotateZ(B,O,F),B[4]=Be*(pe=B[3])+He*(G=B[0])+Xe*(ie=B[2])-Ze*(Q=B[1]),B[5]=Xe*pe+He*Q+Ze*G-Be*ie,B[6]=Ze*pe+He*ie+Be*Q-Xe*G,B[7]=He*pe-Be*G-Xe*Q-Ze*ie,B},Oe.rotateByQuatAppend=function(B,O,F){var G=F[0],Q=F[1],ie=F[2],pe=F[3],ge=O[0],ae=O[1],be=O[2],Te=O[3];return B[0]=ge*pe+Te*G+ae*ie-be*Q,B[1]=ae*pe+Te*Q+be*G-ge*ie,B[2]=be*pe+Te*ie+ge*Q-ae*G,B[3]=Te*pe-ge*G-ae*Q-be*ie,B[4]=(ge=O[4])*pe+(Te=O[7])*G+(ae=O[5])*ie-(be=O[6])*Q,B[5]=ae*pe+Te*Q+be*G-ge*ie,B[6]=be*pe+Te*ie+ge*Q-ae*G,B[7]=Te*pe-ge*G-ae*Q-be*ie,B},Oe.rotateByQuatPrepend=function(B,O,F){var G=O[0],Q=O[1],ie=O[2],pe=O[3],ge=F[0],ae=F[1],be=F[2],Te=F[3];return B[0]=G*Te+pe*ge+Q*be-ie*ae,B[1]=Q*Te+pe*ae+ie*ge-G*be,B[2]=ie*Te+pe*be+G*ae-Q*ge,B[3]=pe*Te-G*ge-Q*ae-ie*be,B[4]=G*(Te=F[7])+pe*(ge=F[4])+Q*(be=F[6])-ie*(ae=F[5]),B[5]=Q*Te+pe*ae+ie*ge-G*be,B[6]=ie*Te+pe*be+G*ae-Q*ge,B[7]=pe*Te-G*ge-Q*ae-ie*be,B},Oe.rotateAroundAxis=function(B,O,F,G){if(Math.abs(G)<i.EPSILON)return M(B,O);var Q=Math.hypot(F[0],F[1],F[2]);G*=.5;var ie=Math.sin(G),pe=ie*F[0]/Q,ge=ie*F[1]/Q,ae=ie*F[2]/Q,be=Math.cos(G),Te=O[0],Be=O[1],Xe=O[2],Ze=O[3];B[0]=Te*be+Ze*pe+Be*ae-Xe*ge,B[1]=Be*be+Ze*ge+Xe*pe-Te*ae,B[2]=Xe*be+Ze*ae+Te*ge-Be*pe,B[3]=Ze*be-Te*pe-Be*ge-Xe*ae;var He=O[4],ct=O[5],Qe=O[6],pt=O[7];return B[4]=He*be+pt*pe+ct*ae-Qe*ge,B[5]=ct*be+pt*ge+Qe*pe-He*ae,B[6]=Qe*be+pt*ae+He*ge-ct*pe,B[7]=pt*be-He*pe-ct*ge-Qe*ae,B},Oe.add=function(B,O,F){return B[0]=O[0]+F[0],B[1]=O[1]+F[1],B[2]=O[2]+F[2],B[3]=O[3]+F[3],B[4]=O[4]+F[4],B[5]=O[5]+F[5],B[6]=O[6]+F[6],B[7]=O[7]+F[7],B},Oe.multiply=z,Oe.scale=function(B,O,F){return B[0]=O[0]*F,B[1]=O[1]*F,B[2]=O[2]*F,B[3]=O[3]*F,B[4]=O[4]*F,B[5]=O[5]*F,B[6]=O[6]*F,B[7]=O[7]*F,B},Oe.lerp=function(B,O,F,G){var Q=1-G;return V(O,F)<0&&(G=-G),B[0]=O[0]*Q+F[0]*G,B[1]=O[1]*Q+F[1]*G,B[2]=O[2]*Q+F[2]*G,B[3]=O[3]*Q+F[3]*G,B[4]=O[4]*Q+F[4]*G,B[5]=O[5]*Q+F[5]*G,B[6]=O[6]*Q+F[6]*G,B[7]=O[7]*Q+F[7]*G,B},Oe.invert=function(B,O){var F=L(O);return B[0]=-O[0]/F,B[1]=-O[1]/F,B[2]=-O[2]/F,B[3]=O[3]/F,B[4]=-O[4]/F,B[5]=-O[5]/F,B[6]=-O[6]/F,B[7]=O[7]/F,B},Oe.conjugate=function(B,O){return B[0]=-O[0],B[1]=-O[1],B[2]=-O[2],B[3]=O[3],B[4]=-O[4],B[5]=-O[5],B[6]=-O[6],B[7]=O[7],B},Oe.normalize=function(B,O){var F=L(O);if(F>0){F=Math.sqrt(F);var G=O[0]/F,Q=O[1]/F,ie=O[2]/F,pe=O[3]/F,ge=O[4],ae=O[5],be=O[6],Te=O[7],Be=G*ge+Q*ae+ie*be+pe*Te;B[0]=G,B[1]=Q,B[2]=ie,B[3]=pe,B[4]=(ge-G*Be)/F,B[5]=(ae-Q*Be)/F,B[6]=(be-ie*Be)/F,B[7]=(Te-pe*Be)/F}return B},Oe.str=function(B){return"quat2("+B[0]+", "+B[1]+", "+B[2]+", "+B[3]+", "+B[4]+", "+B[5]+", "+B[6]+", "+B[7]+")"},Oe.exactEquals=function(B,O){return B[0]===O[0]&&B[1]===O[1]&&B[2]===O[2]&&B[3]===O[3]&&B[4]===O[4]&&B[5]===O[5]&&B[6]===O[6]&&B[7]===O[7]},Oe.equals=function(B,O){var F=B[0],G=B[1],Q=B[2],ie=B[3],pe=B[4],ge=B[5],ae=B[6],be=B[7],Te=O[0],Be=O[1],Xe=O[2],Ze=O[3],He=O[4],ct=O[5],Qe=O[6],pt=O[7];return Math.abs(F-Te)<=i.EPSILON*Math.max(1,Math.abs(F),Math.abs(Te))&&Math.abs(G-Be)<=i.EPSILON*Math.max(1,Math.abs(G),Math.abs(Be))&&Math.abs(Q-Xe)<=i.EPSILON*Math.max(1,Math.abs(Q),Math.abs(Xe))&&Math.abs(ie-Ze)<=i.EPSILON*Math.max(1,Math.abs(ie),Math.abs(Ze))&&Math.abs(pe-He)<=i.EPSILON*Math.max(1,Math.abs(pe),Math.abs(He))&&Math.abs(ge-ct)<=i.EPSILON*Math.max(1,Math.abs(ge),Math.abs(ct))&&Math.abs(ae-Qe)<=i.EPSILON*Math.max(1,Math.abs(ae),Math.abs(Qe))&&Math.abs(be-pt)<=i.EPSILON*Math.max(1,Math.abs(be),Math.abs(pt))},Oe.sqrLen=Oe.squaredLength=Oe.len=Oe.length=Oe.dot=Oe.mul=Oe.setReal=Oe.getReal=void 0;var i=p(D()),l=p(Me()),h=p(ce());function v(B){if(typeof WeakMap!="function")return null;var O=new WeakMap,F=new WeakMap;return(v=function(G){return G?F:O})(B)}function p(B,O){if(B&&B.__esModule)return B;if(B===null||d(B)!=="object"&&typeof B!="function")return{default:B};var F=v(O);if(F&&F.has(B))return F.get(B);var G={},Q=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ie in B)if(ie!=="default"&&Object.prototype.hasOwnProperty.call(B,ie)){var pe=Q?Object.getOwnPropertyDescriptor(B,ie):null;pe&&(pe.get||pe.set)?Object.defineProperty(G,ie,pe):G[ie]=B[ie]}return G.default=B,F&&F.set(B,G),G}function x(B,O,F){var G=.5*F[0],Q=.5*F[1],ie=.5*F[2],pe=O[0],ge=O[1],ae=O[2],be=O[3];return B[0]=pe,B[1]=ge,B[2]=ae,B[3]=be,B[4]=G*be+Q*ae-ie*ge,B[5]=Q*be+ie*pe-G*ae,B[6]=ie*be+G*ge-Q*pe,B[7]=-G*pe-Q*ge-ie*ae,B}function M(B,O){return B[0]=O[0],B[1]=O[1],B[2]=O[2],B[3]=O[3],B[4]=O[4],B[5]=O[5],B[6]=O[6],B[7]=O[7],B}function z(B,O,F){var G=O[0],Q=O[1],ie=O[2],pe=O[3],ge=F[4],ae=F[5],be=F[6],Te=F[7],Be=O[4],Xe=O[5],Ze=O[6],He=O[7],ct=F[0],Qe=F[1],pt=F[2],St=F[3];return B[0]=G*St+pe*ct+Q*pt-ie*Qe,B[1]=Q*St+pe*Qe+ie*ct-G*pt,B[2]=ie*St+pe*pt+G*Qe-Q*ct,B[3]=pe*St-G*ct-Q*Qe-ie*pt,B[4]=G*Te+pe*ge+Q*be-ie*ae+Be*St+He*ct+Xe*pt-Ze*Qe,B[5]=Q*Te+pe*ae+ie*ge-G*be+Xe*St+He*Qe+Ze*ct-Be*pt,B[6]=ie*Te+pe*be+G*ae-Q*ge+Ze*St+He*pt+Be*Qe-Xe*ct,B[7]=pe*Te-G*ge-Q*ae-ie*be+He*St-Be*ct-Xe*Qe-Ze*pt,B}Oe.getReal=l.copy,Oe.setReal=l.copy,Oe.mul=z;var V=l.dot;Oe.dot=V;var E=l.length;Oe.length=E,Oe.len=E;var L=l.squaredLength;return Oe.squaredLength=L,Oe.sqrLen=L,Oe}var Ke,Ct,Ue={};function ft(){if(Ke)return Ue;function d(O){return d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(F){return typeof F}:function(F){return F&&typeof Symbol=="function"&&F.constructor===Symbol&&F!==Symbol.prototype?"symbol":typeof F},d(O)}Ke=1,Object.defineProperty(Ue,"__esModule",{value:!0}),Ue.create=h,Ue.clone=function(O){var F=new i.ARRAY_TYPE(2);return F[0]=O[0],F[1]=O[1],F},Ue.fromValues=function(O,F){var G=new i.ARRAY_TYPE(2);return G[0]=O,G[1]=F,G},Ue.copy=function(O,F){return O[0]=F[0],O[1]=F[1],O},Ue.set=function(O,F,G){return O[0]=F,O[1]=G,O},Ue.add=function(O,F,G){return O[0]=F[0]+G[0],O[1]=F[1]+G[1],O},Ue.subtract=v,Ue.multiply=p,Ue.divide=x,Ue.ceil=function(O,F){return O[0]=Math.ceil(F[0]),O[1]=Math.ceil(F[1]),O},Ue.floor=function(O,F){return O[0]=Math.floor(F[0]),O[1]=Math.floor(F[1]),O},Ue.min=function(O,F,G){return O[0]=Math.min(F[0],G[0]),O[1]=Math.min(F[1],G[1]),O},Ue.max=function(O,F,G){return O[0]=Math.max(F[0],G[0]),O[1]=Math.max(F[1],G[1]),O},Ue.round=function(O,F){return O[0]=Math.round(F[0]),O[1]=Math.round(F[1]),O},Ue.scale=function(O,F,G){return O[0]=F[0]*G,O[1]=F[1]*G,O},Ue.scaleAndAdd=function(O,F,G,Q){return O[0]=F[0]+G[0]*Q,O[1]=F[1]+G[1]*Q,O},Ue.distance=M,Ue.squaredDistance=z,Ue.length=V,Ue.squaredLength=E,Ue.negate=function(O,F){return O[0]=-F[0],O[1]=-F[1],O},Ue.inverse=function(O,F){return O[0]=1/F[0],O[1]=1/F[1],O},Ue.normalize=function(O,F){var G=F[0],Q=F[1],ie=G*G+Q*Q;return ie>0&&(ie=1/Math.sqrt(ie)),O[0]=F[0]*ie,O[1]=F[1]*ie,O},Ue.dot=function(O,F){return O[0]*F[0]+O[1]*F[1]},Ue.cross=function(O,F,G){var Q=F[0]*G[1]-F[1]*G[0];return O[0]=O[1]=0,O[2]=Q,O},Ue.lerp=function(O,F,G,Q){var ie=F[0],pe=F[1];return O[0]=ie+Q*(G[0]-ie),O[1]=pe+Q*(G[1]-pe),O},Ue.random=function(O,F){F=F||1;var G=2*i.RANDOM()*Math.PI;return O[0]=Math.cos(G)*F,O[1]=Math.sin(G)*F,O},Ue.transformMat2=function(O,F,G){var Q=F[0],ie=F[1];return O[0]=G[0]*Q+G[2]*ie,O[1]=G[1]*Q+G[3]*ie,O},Ue.transformMat2d=function(O,F,G){var Q=F[0],ie=F[1];return O[0]=G[0]*Q+G[2]*ie+G[4],O[1]=G[1]*Q+G[3]*ie+G[5],O},Ue.transformMat3=function(O,F,G){var Q=F[0],ie=F[1];return O[0]=G[0]*Q+G[3]*ie+G[6],O[1]=G[1]*Q+G[4]*ie+G[7],O},Ue.transformMat4=function(O,F,G){var Q=F[0],ie=F[1];return O[0]=G[0]*Q+G[4]*ie+G[12],O[1]=G[1]*Q+G[5]*ie+G[13],O},Ue.rotate=function(O,F,G,Q){var ie=F[0]-G[0],pe=F[1]-G[1],ge=Math.sin(Q),ae=Math.cos(Q);return O[0]=ie*ae-pe*ge+G[0],O[1]=ie*ge+pe*ae+G[1],O},Ue.angle=function(O,F){var G=O[0],Q=O[1],ie=F[0],pe=F[1],ge=Math.sqrt(G*G+Q*Q)*Math.sqrt(ie*ie+pe*pe);return Math.acos(Math.min(Math.max(ge&&(G*ie+Q*pe)/ge,-1),1))},Ue.zero=function(O){return O[0]=0,O[1]=0,O},Ue.str=function(O){return"vec2("+O[0]+", "+O[1]+")"},Ue.exactEquals=function(O,F){return O[0]===F[0]&&O[1]===F[1]},Ue.equals=function(O,F){var G=O[0],Q=O[1],ie=F[0],pe=F[1];return Math.abs(G-ie)<=i.EPSILON*Math.max(1,Math.abs(G),Math.abs(ie))&&Math.abs(Q-pe)<=i.EPSILON*Math.max(1,Math.abs(Q),Math.abs(pe))},Ue.forEach=Ue.sqrLen=Ue.sqrDist=Ue.dist=Ue.div=Ue.mul=Ue.sub=Ue.len=void 0;var i=function(O,F){if(O&&O.__esModule)return O;if(O===null||d(O)!=="object"&&typeof O!="function")return{default:O};var G=l(void 0);if(G&&G.has(O))return G.get(O);var Q={},ie=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var pe in O)if(pe!=="default"&&Object.prototype.hasOwnProperty.call(O,pe)){var ge=ie?Object.getOwnPropertyDescriptor(O,pe):null;ge&&(ge.get||ge.set)?Object.defineProperty(Q,pe,ge):Q[pe]=O[pe]}return Q.default=O,G&&G.set(O,Q),Q}(D());function l(O){if(typeof WeakMap!="function")return null;var F=new WeakMap,G=new WeakMap;return(l=function(Q){return Q?G:F})(O)}function h(){var O=new i.ARRAY_TYPE(2);return i.ARRAY_TYPE!=Float32Array&&(O[0]=0,O[1]=0),O}function v(O,F,G){return O[0]=F[0]-G[0],O[1]=F[1]-G[1],O}function p(O,F,G){return O[0]=F[0]*G[0],O[1]=F[1]*G[1],O}function x(O,F,G){return O[0]=F[0]/G[0],O[1]=F[1]/G[1],O}function M(O,F){return Math.hypot(F[0]-O[0],F[1]-O[1])}function z(O,F){var G=F[0]-O[0],Q=F[1]-O[1];return G*G+Q*Q}function V(O){return Math.hypot(O[0],O[1])}function E(O){var F=O[0],G=O[1];return F*F+G*G}Ue.len=V,Ue.sub=v,Ue.mul=p,Ue.div=x,Ue.dist=M,Ue.sqrDist=z,Ue.sqrLen=E;var L,B=(L=h(),function(O,F,G,Q,ie,pe){var ge,ae;for(F||(F=2),G||(G=0),ae=Q?Math.min(Q*F+G,O.length):O.length,ge=G;ge<ae;ge+=F)L[0]=O[ge],L[1]=O[ge+1],ie(L,L,pe),O[ge]=L[0],O[ge+1]=L[1];return O});return Ue.forEach=B,Ue}function Bt(){if(Ct)return I;function d(O){return d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(F){return typeof F}:function(F){return F&&typeof Symbol=="function"&&F.constructor===Symbol&&F!==Symbol.prototype?"symbol":typeof F},d(O)}Ct=1,Object.defineProperty(I,"__esModule",{value:!0}),I.vec4=I.vec3=I.vec2=I.quat2=I.quat=I.mat4=I.mat3=I.mat2d=I.mat2=I.glMatrix=void 0;var i=B(D());I.glMatrix=i;var l=B(W());I.mat2=l;var h=B(Z());I.mat2d=h;var v=B(_e());I.mat3=v;var p=B(ce());I.mat4=p;var x=B(Me());I.quat=x;var M=B($e());I.quat2=M;var z=B(ft());I.vec2=z;var V=B(Ee());I.vec3=V;var E=B(Pe());function L(O){if(typeof WeakMap!="function")return null;var F=new WeakMap,G=new WeakMap;return(L=function(Q){return Q?G:F})(O)}function B(O,F){if(O&&O.__esModule)return O;if(O===null||d(O)!=="object"&&typeof O!="function")return{default:O};var G=L(F);if(G&&G.has(O))return G.get(O);var Q={},ie=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var pe in O)if(pe!=="default"&&Object.prototype.hasOwnProperty.call(O,pe)){var ge=ie?Object.getOwnPropertyDescriptor(O,pe):null;ge&&(ge.get||ge.set)?Object.defineProperty(Q,pe,ge):Q[pe]=O[pe]}return Q.default=O,G&&G.set(O,Q),Q}return I.vec4=E,I}var hn,ot,en,wt,Ne=Bt(),We=function(){if(ot)return hn;function d(i,l,h,v){this.cx=3*i,this.bx=3*(h-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*l,this.by=3*(v-l)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=l,this.p2x=h,this.p2y=v}return ot=1,hn=d,d.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,l){if(l===void 0&&(l=1e-6),i<0)return 0;if(i>1)return 1;for(var h=i,v=0;v<8;v++){var p=this.sampleCurveX(h)-i;if(Math.abs(p)<l)return h;var x=this.sampleCurveDerivativeX(h);if(Math.abs(x)<1e-6)break;h-=p/x}var M=0,z=1;for(h=i,v=0;v<20&&(p=this.sampleCurveX(h),!(Math.abs(p-i)<l));v++)i>p?M=h:z=h,h=.5*(z-M)+M;return h},solve:function(i,l){return this.sampleCurveY(this.solveCurveX(i,l))}},hn}(),Sn=C(We);function Ae(){if(wt)return en;function d(i,l){this.x=i,this.y=l}return wt=1,en=d,d.prototype={clone:function(){return new d(this.x,this.y)},add:function(i){return this.clone()._add(i)},sub:function(i){return this.clone()._sub(i)},multByPoint:function(i){return this.clone()._multByPoint(i)},divByPoint:function(i){return this.clone()._divByPoint(i)},mult:function(i){return this.clone()._mult(i)},div:function(i){return this.clone()._div(i)},rotate:function(i){return this.clone()._rotate(i)},rotateAround:function(i,l){return this.clone()._rotateAround(i,l)},matMult:function(i){return this.clone()._matMult(i)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(i){return this.x===i.x&&this.y===i.y},dist:function(i){return Math.sqrt(this.distSqr(i))},distSqr:function(i){var l=i.x-this.x,h=i.y-this.y;return l*l+h*h},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(i){return Math.atan2(this.y-i.y,this.x-i.x)},angleWith:function(i){return this.angleWithSep(i.x,i.y)},angleWithSep:function(i,l){return Math.atan2(this.x*l-this.y*i,this.x*i+this.y*l)},_matMult:function(i){var l=i[2]*this.x+i[3]*this.y;return this.x=i[0]*this.x+i[1]*this.y,this.y=l,this},_add:function(i){return this.x+=i.x,this.y+=i.y,this},_sub:function(i){return this.x-=i.x,this.y-=i.y,this},_mult:function(i){return this.x*=i,this.y*=i,this},_div:function(i){return this.x/=i,this.y/=i,this},_multByPoint:function(i){return this.x*=i.x,this.y*=i.y,this},_divByPoint:function(i){return this.x/=i.x,this.y/=i.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var i=this.y;return this.y=this.x,this.x=-i,this},_rotate:function(i){var l=Math.cos(i),h=Math.sin(i),v=h*this.x+l*this.y;return this.x=l*this.x-h*this.y,this.y=v,this},_rotateAround:function(i,l){var h=Math.cos(i),v=Math.sin(i),p=l.y+v*(this.x-l.x)+h*(this.y-l.y);return this.x=l.x+h*(this.x-l.x)-v*(this.y-l.y),this.y=p,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},d.convert=function(i){return i instanceof d?i:Array.isArray(i)?new d(i[0],i[1]):i},en}var st=C(Ae());function gt(d,i){if(Array.isArray(d)){if(!Array.isArray(i)||d.length!==i.length)return!1;for(let l=0;l<d.length;l++)if(!gt(d[l],i[l]))return!1;return!0}if(typeof d=="object"&&d!==null&&i!==null){if(typeof i!="object"||Object.keys(d).length!==Object.keys(i).length)return!1;for(const l in d)if(!gt(d[l],i[l]))return!1;return!0}return d===i}const ut=Math.PI/180,tt=180/Math.PI;function nt(d){return d*ut}function tn(d){return d*tt}const un=[[0,0],[1,0],[1,1],[0,1]];function qt(d){if(d<=0)return 0;if(d>=1)return 1;const i=d*d,l=i*d;return 4*(d<.5?l:3*(d-i)+l-.75)}function an(d,i,l,h){const v=new Sn(d,i,l,h);return function(p){return v.solve(p)}}const Jt=an(.25,.1,.25,1);function Wt(d,i,l){return Math.min(l,Math.max(i,d))}function Fn(d,i,l){return(l=Wt((l-d)/(i-d),0,1))*l*(3-2*l)}function ar(d,i,l){const h=l-i,v=((d-i)%h+h)%h+i;return v===i?l:v}function bn(d,i,l){if(!d.length)return l(null,[]);let h=d.length;const v=new Array(d.length);let p=null;d.forEach((x,M)=>{i(x,(z,V)=>{z&&(p=z),v[M]=V,--h==0&&l(p,v)})})}function lr(d,...i){for(const l of i)for(const h in l)d[h]=l[h];return d}let Cn=1;function xn(){return Cn++}function Er(d){return d<=1?1:Math.pow(2,Math.ceil(Math.log(d)/Math.LN2))}function Rr(d,i){d.forEach(l=>{i[l]&&(i[l]=i[l].bind(i))})}function Wn(d,i){return d.indexOf(i,d.length-i.length)!==-1}function Mn(d,i,l){const h={};for(const v in d)h[v]=i.call(this,d[v],v,d);return h}function Ar(d,i,l){const h={};for(const v in d)i.call(this,d[v],v,d)&&(h[v]=d[v]);return h}function fi(d){return Array.isArray(d)?d.map(fi):typeof d=="object"&&d?Mn(d,fi):d}const yo={};function vr(d){yo[d]||(typeof console<"u"&&console.warn(d),yo[d]=!0)}function zi(d,i,l){return(l.y-d.y)*(i.x-d.x)>(i.y-d.y)*(l.x-d.x)}function Li(d){let i=0;for(let l,h,v=0,p=d.length,x=p-1;v<p;x=v++)l=d[v],h=d[x],i+=(h.x-l.x)*(l.y+h.y);return i}function mi([d,i,l]){const h=nt(i+90),v=nt(l);return{x:d*Math.cos(h)*Math.sin(v),y:d*Math.sin(h)*Math.sin(v),z:d*Math.cos(v),azimuthal:i,polar:l}}function ji(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function ko(d){const i={};if(d.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(l,h,v,p)=>{const x=v||p;return i[h]=!x||x.toLowerCase(),""}),i["max-age"]){const l=parseInt(i["max-age"],10);isNaN(l)?delete i["max-age"]:i["max-age"]=l}return i}let qo,Oo=null;function Pn(d,i){return[d[4*i],d[4*i+1],d[4*i+2],d[4*i+3]]}function Vt(d,i,l,h){for(;i<l;){const v=i+l>>1;d[v]<h?i=v+1:l=v}return i}function ze(d,i,l,h){for(;i<l;){const v=i+l>>1;d[v]<=h?i=v+1:l=v}return i}function Ve(d){return d>0?1/(1.001-d):1+d}function at(d){return d>0?1-1/(1.001-d):-d}const _t={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(qo==null){const d=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{qo=n.API_URL_REGEX!=null?new RegExp(n.API_URL_REGEX):d}catch{qo=d}}return qo},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!_t.API_URL)return null;try{const d=new URL(_t.API_URL);return d.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":d.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function ht(d){return _t.API_URL_REGEX.test(d)}function Mt(d){return _t.API_SPRITE_REGEX.test(d)}let Xt,At,Gt,Zt,Ht,fn;function Nt(){return Xt==null&&(Xt=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),Xt}const zt={now:()=>Zt!==void 0?Zt:performance.now(),setNow(d){Zt=d},restoreNow(){Zt=void 0},frame(d){const i=requestAnimationFrame(d);return{cancel:()=>cancelAnimationFrame(i)}},getImageData(d,i=0){const{width:l,height:h}=d;Ht||(Ht=document.createElement("canvas"));const v=Ht.getContext("2d",{willReadFrequently:!0});if(!v)throw new Error("failed to create canvas 2d context");return(l>Ht.width||h>Ht.height)&&(Ht.width=l,Ht.height=h),v.clearRect(-i,-i,l+2*i,h+2*i),v.drawImage(d,0,0,l,h),v.getImageData(-i,-i,l+2*i,h+2*i)},resolveURL:d=>(At||(At=document.createElement("a")),At.href=d,At.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(Gt==null&&(Gt=window.matchMedia("(prefers-reduced-motion: reduce)")),Gt.matches)},hasCanvasFingerprintNoise(){if(fn!==void 0)return fn;if(!Nt())return fn=!1,!1;const d=new OffscreenCanvas(85,1),i=d.getContext("2d",{willReadFrequently:!0});let l=0;for(let v=0;v<d.width;++v)i.fillStyle=`rgba(${l++},${l++},${l++}, 255)`,i.fillRect(v,0,1,1);const h=i.getImageData(0,0,d.width,d.height);l=0;for(let v=0;v<h.data.length;++v)if(v%4!=3&&l++!==h.data[v])return fn=!0,!0;return fn=!1,!1}};function yn(d,i){const l=d.indexOf("?");if(l<0)return`${d}?${new URLSearchParams(i).toString()}`;const h=new URLSearchParams(d.slice(l));for(const v in i)h.set(v,i[v]);return`${d.slice(0,l)}?${h.toString()}`}function qn(d,i={persistentParams:[]}){const l=d.indexOf("?");if(l<0)return d;const h=new URLSearchParams,v=new URLSearchParams(d.slice(l));for(const x of i.persistentParams){const M=v.get(x);M&&h.set(x,M)}const p=h.toString();return`${d.slice(0,l)}${p.length>0?`?${p}`:""}`}const Jn="mapbox-tiles";let ur=500,Cr=50;const Or=["language","worldview","jobid"];let Fr,bi;function Mi(){try{return caches}catch{}}function Wi(){const d=Mi();d&&Fr==null&&(Fr=d.open(Jn))}let Ki=1/0;const yi={supported:!1,testSupport:function(d){!ei&&Us&&(Ji?Xo(d):bs=d)}};let bs,Us,ei=!1,Ji=!1;const ns=typeof self<"u"?self:{};function Xo(d){const i=d.createTexture();d.bindTexture(d.TEXTURE_2D,i);try{if(d.texImage2D(d.TEXTURE_2D,0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,Us),d.isContextLost())return;yi.supported=!0}catch{}d.deleteTexture(i),ei=!0}ns.document&&(Us=ns.document.createElement("img"),Us.onload=function(){bs&&Xo(bs),bs=null,Ji=!0},Us.onerror=function(){ei=!0,bs=null},Us.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const Rs={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(Rs);class ld extends Error{constructor(i,l,h){l===401&&ht(h)&&(i+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(i),this.status=l,this.url=h}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Qd=ji()?()=>self.worker&&self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,Cc=function(d,i){if(!(/^file:/.test(l=d.url)||/^file:/.test(Qd())&&!/^\w+:/.test(l))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(h,v){const p=new AbortController,x=new Request(h.url,{method:h.method||"GET",body:h.body,credentials:h.credentials,headers:h.headers,referrer:Qd(),referrerPolicy:h.referrerPolicy,signal:p.signal});let M=!1,z=!1;const V=(E=x.url).indexOf("sku=")>0&&ht(E);var E;h.type==="json"&&x.headers.set("Accept","application/json");const L=(O,F,G)=>{if(z)return;if(O&&O.message!=="SecurityError"&&vr(O.toString()),F&&G)return B(F);const Q=Date.now();fetch(x).then(ie=>{if(ie.ok){const pe=V?ie.clone():null;return B(ie,pe,Q)}return v(new ld(ie.statusText,ie.status,h.url))}).catch(ie=>{ie.name!=="AbortError"&&v(new Error(`${ie.message} ${h.url}`))})},B=(O,F,G)=>{(h.type==="arrayBuffer"?O.arrayBuffer():h.type==="json"?O.json():O.text()).then(Q=>{z||(F&&G&&function(ie,pe,ge){if(Wi(),Fr==null)return;const ae=ko(pe.headers.get("Cache-Control")||"");if(ae["no-store"])return;const be={status:pe.status,statusText:pe.statusText,headers:new Headers};pe.headers.forEach((Xe,Ze)=>be.headers.set(Ze,Xe)),ae["max-age"]&&be.headers.set("Expires",new Date(ge+1e3*ae["max-age"]).toUTCString());const Te=be.headers.get("Expires");if(!Te||new Date(Te).getTime()-ge<42e4)return;let Be=qn(ie.url,{persistentParams:Or});if(pe.status===206){const Xe=ie.headers.get("Range");if(!Xe)return;be.status=200,Be=yn(Be,{range:Xe})}(function(Xe,Ze){if(bi===void 0)try{new Response(new ReadableStream),bi=!0}catch{bi=!1}bi?Ze(Xe.body):Xe.blob().then(Ze)})(pe,Xe=>{const Ze=new Response((He=pe.status)!==200&&He!==404&&[101,103,204,205,304].includes(He)?null:Xe,be);var He;Wi(),Fr!=null&&Fr.then(ct=>ct.put(Be,Ze)).catch(ct=>vr(ct.message))})}(x,F,G),M=!0,v(null,Q,O.headers.get("Cache-Control"),O.headers.get("Expires")))}).catch(Q=>{z||v(new Error(Q.message))})};return V?function(O,F){if(Wi(),Fr==null)return F(null);Fr.then(G=>{let Q=qn(O.url,{persistentParams:Or});const ie=O.headers.get("Range");ie&&(Q=yn(Q,{range:ie})),G.match(Q).then(pe=>{const ge=function(ae){if(!ae)return!1;const be=new Date(ae.headers.get("Expires")||0),Te=ko(ae.headers.get("Cache-Control")||"");return be>Date.now()&&!Te["no-cache"]}(pe);G.delete(Q),ge&&G.put(Q,pe.clone()),F(null,pe,ge)}).catch(F)}).catch(F)}(x,L):L(null,null),{cancel:()=>{z=!0,M||p.abort()}}}(d,i);if(ji()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",d,i,void 0,!0)}var l;return function(h,v){const p=new XMLHttpRequest;p.open(h.method||"GET",h.url,!0),h.type==="arrayBuffer"&&(p.responseType="arraybuffer");for(const x in h.headers)p.setRequestHeader(x,h.headers[x]);return h.type==="json"&&(p.responseType="text",p.setRequestHeader("Accept","application/json")),p.withCredentials=h.credentials==="include",p.onerror=()=>{v(new Error(p.statusText))},p.onload=()=>{if((p.status>=200&&p.status<300||p.status===0)&&p.response!==null){let x=p.response;if(h.type==="json")try{x=JSON.parse(p.response)}catch(M){return v(M)}v(null,x,p.getResponseHeader("Cache-Control"),p.getResponseHeader("Expires"))}else v(new ld(p.statusText,p.status,h.url))},p.send(h.body),{cancel:()=>p.abort()}}(d,i)},lu=function(d,i){return Cc(lr(d,{type:"arrayBuffer"}),i)};function ea(d){const i=document.createElement("a");return i.href=d,i.protocol===location.protocol&&i.host===location.host}const Os="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let rs,Do;rs=[],Do=0;const Ma=function(d,i){if(yi.supported&&(d.headers||(d.headers={}),d.headers.accept="image/webp,*/*"),Do>=_t.MAX_PARALLEL_IMAGE_REQUESTS){const p={requestParameters:d,callback:i,cancelled:!1,cancel(){this.cancelled=!0}};return rs.push(p),p}Do++;let l=!1;const h=()=>{if(!l)for(l=!0,Do--;rs.length&&Do<_t.MAX_PARALLEL_IMAGE_REQUESTS;){const p=rs.shift(),{requestParameters:x,callback:M,cancelled:z}=p;z||(p.cancel=Ma(x,M).cancel)}},v=lu(d,(p,x,M,z)=>{h(),p?i(p):x&&(self.createImageBitmap?function(V,E){const L=new Blob([new Uint8Array(V)],{type:"image/png"});createImageBitmap(L).then(B=>{E(null,B)}).catch(B=>{E(new Error(`Could not load image because of ${B.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(x,(V,E)=>i(V,E,M,z)):function(V,E){const L=new Image;L.onload=()=>{E(null,L),URL.revokeObjectURL(L.src),L.onload=null,requestAnimationFrame(()=>{L.src=Os})},L.onerror=()=>E(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const B=new Blob([new Uint8Array(V)],{type:"image/png"});L.src=V.byteLength?URL.createObjectURL(B):Os}(x,(V,E)=>i(V,E,M,z)))});return{cancel:()=>{v.cancel(),h()}}};var Wa,eh,Ou,ne={exports:{}},Ce={exports:{}},et={exports:{}},kt=function(){if(Ou)return ne.exports;Ou=1;var d=(Wa||(Wa=1,Ce.exports=function(l,h){var v,p,x,M,z,V,E,L;for(p=l.length-(v=3&l.length),x=h,z=3432918353,V=461845907,L=0;L<p;)E=255&l.charCodeAt(L)|(255&l.charCodeAt(++L))<<8|(255&l.charCodeAt(++L))<<16|(255&l.charCodeAt(++L))<<24,++L,x=27492+(65535&(M=5*(65535&(x=(x^=E=(65535&(E=(E=(65535&E)*z+(((E>>>16)*z&65535)<<16)&4294967295)<<15|E>>>17))*V+(((E>>>16)*V&65535)<<16)&4294967295)<<13|x>>>19))+((5*(x>>>16)&65535)<<16)&4294967295))+((58964+(M>>>16)&65535)<<16);switch(E=0,v){case 3:E^=(255&l.charCodeAt(L+2))<<16;case 2:E^=(255&l.charCodeAt(L+1))<<8;case 1:x^=E=(65535&(E=(E=(65535&(E^=255&l.charCodeAt(L)))*z+(((E>>>16)*z&65535)<<16)&4294967295)<<15|E>>>17))*V+(((E>>>16)*V&65535)<<16)&4294967295}return x^=l.length,x=2246822507*(65535&(x^=x>>>16))+((2246822507*(x>>>16)&65535)<<16)&4294967295,x=3266489909*(65535&(x^=x>>>13))+((3266489909*(x>>>16)&65535)<<16)&4294967295,(x^=x>>>16)>>>0}),Ce.exports),i=(eh||(eh=1,et.exports=function(l,h){for(var v,p=l.length,x=h^p,M=0;p>=4;)v=1540483477*(65535&(v=255&l.charCodeAt(M)|(255&l.charCodeAt(++M))<<8|(255&l.charCodeAt(++M))<<16|(255&l.charCodeAt(++M))<<24))+((1540483477*(v>>>16)&65535)<<16),x=1540483477*(65535&x)+((1540483477*(x>>>16)&65535)<<16)^(v=1540483477*(65535&(v^=v>>>24))+((1540483477*(v>>>16)&65535)<<16)),p-=4,++M;switch(p){case 3:x^=(255&l.charCodeAt(M+2))<<16;case 2:x^=(255&l.charCodeAt(M+1))<<8;case 1:x=1540483477*(65535&(x^=255&l.charCodeAt(M)))+((1540483477*(x>>>16)&65535)<<16)}return x=1540483477*(65535&(x^=x>>>13))+((1540483477*(x>>>16)&65535)<<16),(x^=x>>>15)>>>0}),et.exports);return ne.exports=d,ne.exports.murmur3=d,ne.exports.murmur2=i,ne.exports}(),jt=C(kt);class Ut{constructor(i,...l){lr(this,l[0]||{}),this.type=i}}class nn extends Ut{constructor(i,l={}){super("error",lr({error:i},l))}}function Xn(d,i,l){l[d]&&l[d].indexOf(i)!==-1||(l[d]=l[d]||[],l[d].push(i))}function rr(d,i,l){if(l&&l[d]){const h=l[d].indexOf(i);h!==-1&&l[d].splice(h,1)}}class Yn{on(i,l){return this._listeners=this._listeners||{},Xn(i,l,this._listeners),this}off(i,l){return rr(i,l,this._listeners),rr(i,l,this._oneTimeListeners),this}once(i,l){return l?(this._oneTimeListeners=this._oneTimeListeners||{},Xn(i,l,this._oneTimeListeners),this):new Promise(h=>this.once(i,h))}fire(i,l){const h=typeof i=="string"?new Ut(i,l):i,v=h.type;if(this.listens(v)){h.target=this;const p=this._listeners&&this._listeners[v]?this._listeners[v].slice():[];for(const z of p)z.call(this,h);const x=this._oneTimeListeners&&this._oneTimeListeners[v]?this._oneTimeListeners[v].slice():[];for(const z of x)rr(v,z,this._oneTimeListeners),z.call(this,h);const M=this._eventedParent;M&&(lr(h,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),M.fire(h))}else h instanceof nn&&console.error(h.error);return this}listens(i){return!!(this._listeners&&this._listeners[i]&&this._listeners[i].length>0||this._oneTimeListeners&&this._oneTimeListeners[i]&&this._oneTimeListeners[i].length>0||this._eventedParent&&this._eventedParent.listens(i))}setEventedParent(i,l){return this._eventedParent=i,this._eventedParentData=l,this}}var hr,Ln={},ii=function(){if(hr)return Ln;hr=1;var d={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function i(p){return(p=Math.round(p))<0?0:p>255?255:p}function l(p){return i(p[p.length-1]==="%"?parseFloat(p)/100*255:parseInt(p))}function h(p){return(x=p[p.length-1]==="%"?parseFloat(p)/100:parseFloat(p))<0?0:x>1?1:x;var x}function v(p,x,M){return M<0?M+=1:M>1&&(M-=1),6*M<1?p+(x-p)*M*6:2*M<1?x:3*M<2?p+(x-p)*(2/3-M)*6:p}try{Ln.parseCSSColor=function(p){var x,M=p.replace(/ /g,"").toLowerCase();if(M in d)return d[M].slice();if(M[0]==="#")return M.length===4?(x=parseInt(M.substr(1),16))>=0&&x<=4095?[(3840&x)>>4|(3840&x)>>8,240&x|(240&x)>>4,15&x|(15&x)<<4,1]:null:M.length===7&&(x=parseInt(M.substr(1),16))>=0&&x<=16777215?[(16711680&x)>>16,(65280&x)>>8,255&x,1]:null;var z=M.indexOf("("),V=M.indexOf(")");if(z!==-1&&V+1===M.length){var E=M.substr(0,z),L=M.substr(z+1,V-(z+1)).split(","),B=1;switch(E){case"rgba":if(L.length!==4)return null;B=h(L.pop());case"rgb":return L.length!==3?null:[l(L[0]),l(L[1]),l(L[2]),B];case"hsla":if(L.length!==4)return null;B=h(L.pop());case"hsl":if(L.length!==3)return null;var O=(parseFloat(L[0])%360+360)%360/360,F=h(L[1]),G=h(L[2]),Q=G<=.5?G*(F+1):G+F-G*F,ie=2*G-Q;return[i(255*v(ie,Q,O+1/3)),i(255*v(ie,Q,O)),i(255*v(ie,Q,O-1/3)),B];default:return null}}return null}}catch{}return Ln}();class Tr{constructor(i,l,h,v=1){this.r=i,this.g=l,this.b=h,this.a=v}static parse(i){if(!i)return;if(i instanceof Tr)return i;if(typeof i!="string")return;const l=ii.parseCSSColor(i);return l?new Tr(l[0]/255*l[3],l[1]/255*l[3],l[2]/255*l[3],l[3]):void 0}toString(){const[i,l,h,v]=this.a===0?[0,0,0,0]:[255*this.r/this.a,255*this.g/this.a,255*this.b/this.a,this.a];return`rgba(${Math.round(i)},${Math.round(l)},${Math.round(h)},${v})`}toRenderColor(i){const{r:l,g:h,b:v,a:p}=this;return new Kr(i,l,h,v,p)}}class Kr{constructor(i,l,h,v,p){if(i){const x=i.image.height,M=x*x;l=p===0?0:l/p*(x-1),h=p===0?0:h/p*(x-1),v=p===0?0:v/p*(x-1);const z=Math.floor(l),V=Math.floor(h),E=Math.floor(v),L=Math.ceil(l),B=Math.ceil(h),O=Math.ceil(v),F=l-z,G=h-V,Q=v-E,ie=i.image.data,pe=4*(z+V*M+E*x),ge=4*(z+V*M+O*x),ae=4*(z+B*M+E*x),be=4*(z+B*M+O*x),Te=4*(L+V*M+E*x),Be=4*(L+V*M+O*x),Xe=4*(L+B*M+E*x),Ze=4*(L+B*M+O*x);if(pe<0||Ze>=ie.length)throw new Error("out of range");this.r=sr(sr(sr(ie[pe],ie[ge],Q),sr(ie[ae],ie[be],Q),G),sr(sr(ie[Te],ie[Be],Q),sr(ie[Xe],ie[Ze],Q),G),F)/255*p,this.g=sr(sr(sr(ie[pe+1],ie[ge+1],Q),sr(ie[ae+1],ie[be+1],Q),G),sr(sr(ie[Te+1],ie[Be+1],Q),sr(ie[Xe+1],ie[Ze+1],Q),G),F)/255*p,this.b=sr(sr(sr(ie[pe+2],ie[ge+2],Q),sr(ie[ae+2],ie[be+2],Q),G),sr(sr(ie[Te+2],ie[Be+2],Q),sr(ie[Xe+2],ie[Ze+2],Q),G),F)/255*p,this.a=p}else this.r=l,this.g=h,this.b=v,this.a=p}toArray(){const{r:i,g:l,b:h,a:v}=this;return v===0?[0,0,0,0]:[255*i/v,255*l/v,255*h/v,v]}toArray01(){const{r:i,g:l,b:h,a:v}=this;return v===0?[0,0,0,0]:[i/v,l/v,h/v,v]}toArray01Scaled(i){const{r:l,g:h,b:v,a:p}=this;return p===0?[0,0,0]:[l/p*i,h/p*i,v/p*i]}toArray01PremultipliedAlpha(){const{r:i,g:l,b:h,a:v}=this;return[i,l,h,v]}toArray01Linear(){const{r:i,g:l,b:h,a:v}=this;return v===0?[0,0,0,0]:[Math.pow(i/v,2.2),Math.pow(l/v,2.2),Math.pow(h/v,2.2),v]}}function sr(d,i,l){return d*(1-l)+i*l}function jn(d,i,l){return d.map((h,v)=>sr(h,i[v],l))}Tr.black=new Tr(0,0,0,1),Tr.white=new Tr(1,1,1,1),Tr.transparent=new Tr(0,0,0,0),Tr.red=new Tr(1,0,0,1),Tr.blue=new Tr(0,0,1,1);var kr=Object.freeze({__proto__:null,array:jn,color:function(d,i,l){return new Tr(sr(d.r,i.r,l),sr(d.g,i.g,l),sr(d.b,i.b,l),sr(d.a,i.a,l))},number:sr});function Ri(d,...i){for(const l of i)for(const h in l)d[h]=l[h];return d}class Qi extends Error{constructor(i,l){super(l),this.message=l,this.key=i}}class Mo{constructor(i,l=[]){this.parent=i,this.bindings={};for(const[h,v]of l)this.bindings[h]=v}concat(i){return new Mo(this,i)}get(i){if(this.bindings[i])return this.bindings[i];if(this.parent)return this.parent.get(i);throw new Error(`${i} not found in scope.`)}has(i){return!!this.bindings[i]||!!this.parent&&this.parent.has(i)}}const ta={kind:"null"},On={kind:"number"},xr={kind:"string"},ai={kind:"boolean"},Gs={kind:"color"},oo={kind:"object"},ci={kind:"value"},us={kind:"collator"},Fl={kind:"formatted"},qa={kind:"resolvedImage"};function ws(d,i){return{kind:"array",itemType:d,N:i}}function co(d){if(d.kind==="array"){const i=co(d.itemType);return typeof d.N=="number"?`array<${i}, ${d.N}>`:d.itemType.kind==="value"?"array":`array<${i}>`}return d.kind}const qh=[ta,On,xr,ai,Gs,Fl,oo,ws(ci),qa];function uu(d,i){if(i.kind==="error")return null;if(d.kind==="array"){if(i.kind==="array"&&(i.N===0&&i.itemType.kind==="value"||!uu(d.itemType,i.itemType))&&(typeof d.N!="number"||d.N===i.N))return null}else{if(d.kind===i.kind)return null;if(d.kind==="value"){for(const l of qh)if(!uu(l,i))return null}}return`Expected ${co(d)} but found ${co(i)} instead.`}function na(d,i){return i.some(l=>l.kind===d.kind)}function ra(d,i){return i.some(l=>l==="null"?d===null:l==="array"?Array.isArray(d):l==="object"?d&&!Array.isArray(d)&&typeof d=="object":l===typeof d)}class Ec{constructor(i,l,h){this.sensitivity=i?l?"variant":"case":l?"accent":"base",this.locale=h,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(i,l){return this.collator.compare(i,l)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class _o{constructor(i,l,h,v,p){this.text=i.normalize?i.normalize():i,this.image=l,this.scale=h,this.fontStack=v,this.textColor=p}}class Yo{constructor(i){this.sections=i}static fromString(i){return new Yo([new _o(i,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(i=>i.text.length!==0||i.image&&i.image.namePrimary.length!==0)}static factory(i){return i instanceof Yo?i:Yo.fromString(i)}toString(){return this.sections.length===0?"":this.sections.map(i=>i.text).join("")}serialize(){const i=["format"];for(const l of this.sections){if(l.image){i.push(["image",l.image.namePrimary]);continue}i.push(l.text);const h={};l.fontStack&&(h["text-font"]=["literal",l.fontStack.split(",")]),l.scale&&(h["font-scale"]=l.scale),l.textColor&&(h["text-color"]=["rgba"].concat(l.textColor.toRenderColor(null).toArray())),i.push(h)}return i}}class Hs{constructor(i){this.namePrimary=i.namePrimary,i.nameSecondary&&(this.nameSecondary=i.nameSecondary),this.available=i.available}toString(){return this.nameSecondary?`[${this.namePrimary},${this.nameSecondary}]`:this.namePrimary}static fromString(i,l){return i?new Hs({namePrimary:i,nameSecondary:l,available:!1}):null}serialize(){return this.nameSecondary?["image",this.namePrimary,this.nameSecondary]:["image",this.namePrimary]}}function Xa(d,i,l,h){return typeof d=="number"&&d>=0&&d<=255&&typeof i=="number"&&i>=0&&i<=255&&typeof l=="number"&&l>=0&&l<=255?h===void 0||typeof h=="number"&&h>=0&&h<=1?null:`Invalid rgba value [${[d,i,l,h].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof h=="number"?[d,i,l,h]:[d,i,l]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Pa(d){if(d===null||typeof d=="string"||typeof d=="boolean"||typeof d=="number"||d instanceof Tr||d instanceof Ec||d instanceof Yo||d instanceof Hs)return!0;if(Array.isArray(d)){for(const i of d)if(!Pa(i))return!1;return!0}if(typeof d=="object"){for(const i in d)if(!Pa(d[i]))return!1;return!0}return!1}function to(d){if(d===null)return ta;if(typeof d=="string")return xr;if(typeof d=="boolean")return ai;if(typeof d=="number")return On;if(d instanceof Tr)return Gs;if(d instanceof Ec)return us;if(d instanceof Yo)return Fl;if(d instanceof Hs)return qa;if(Array.isArray(d)){const i=d.length;let l;for(const h of d){const v=to(h);if(l){if(l===v)continue;l=ci;break}l=v}return ws(l||ci,i)}return oo}function So(d){const i=typeof d;return d===null?"":i==="string"||i==="number"||i==="boolean"?String(d):d instanceof Tr||d instanceof Yo||d instanceof Hs?d.toString():JSON.stringify(d)}class Zo{constructor(i,l){this.type=i,this.value=l}static parse(i,l){if(i.length!==2)return l.error(`'literal' expression requires exactly one argument, but found ${i.length-1} instead.`);if(!Pa(i[1]))return l.error("invalid value");const h=i[1];let v=to(h);const p=l.expectedType;return v.kind!=="array"||v.N!==0||!p||p.kind!=="array"||typeof p.N=="number"&&p.N!==0||(v=p),new Zo(v,h)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Tr?["rgba"].concat(this.value.toRenderColor(null).toArray()):this.value instanceof Yo?this.value.serialize():this.value}}class zo{constructor(i){this.name="ExpressionEvaluationError",this.message=i}toJSON(){return this.message}}const th={string:xr,number:On,boolean:ai,object:oo};class va{constructor(i,l){this.type=i,this.args=l}static parse(i,l){if(i.length<2)return l.error("Expected at least one argument.");let h,v=1;const p=i[0];if(p==="array"){let M,z;if(i.length>2){const V=i[1];if(typeof V!="string"||!(V in th)||V==="object")return l.error('The item type argument of "array" must be one of string, number, boolean',1);M=th[V],v++}else M=ci;if(i.length>3){if(i[2]!==null&&(typeof i[2]!="number"||i[2]<0||i[2]!==Math.floor(i[2])))return l.error('The length argument to "array" must be a positive integer literal',2);z=i[2],v++}h=ws(M,z)}else h=th[p];const x=[];for(;v<i.length;v++){const M=l.parse(i[v],v,ci);if(!M)return null;x.push(M)}return new va(h,x)}evaluate(i){for(let l=0;l<this.args.length;l++){const h=this.args[l].evaluate(i);if(!uu(this.type,to(h)))return h;if(l===this.args.length-1)throw new zo(`The expression ${JSON.stringify(this.args[l].serialize())} evaluated to ${co(to(h))} but was expected to be of type ${co(this.type)}.`)}return null}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}serialize(){const i=this.type,l=[i.kind];if(i.kind==="array"){const h=i.itemType;if(h.kind==="string"||h.kind==="number"||h.kind==="boolean"){l.push(h.kind);const v=i.N;(typeof v=="number"||this.args.length>1)&&l.push(v)}}return l.concat(this.args.map(h=>h.serialize()))}}class _l{constructor(i){this.type=Fl,this.sections=i}static parse(i,l){if(i.length<2)return l.error("Expected at least one argument.");const h=i[1];if(!Array.isArray(h)&&typeof h=="object")return l.error("First argument must be an image or text section.");const v=[];let p=!1;for(let x=1;x<=i.length-1;++x){const M=i[x];if(p&&typeof M=="object"&&!Array.isArray(M)){p=!1;let z=null;if(M["font-scale"]&&(z=l.parseObjectValue(M["font-scale"],x,"font-scale",On),!z))return null;let V=null;if(M["text-font"]&&(V=l.parseObjectValue(M["text-font"],x,"text-font",ws(xr)),!V))return null;let E=null;if(M["text-color"]&&(E=l.parseObjectValue(M["text-color"],x,"text-color",Gs),!E))return null;const L=v[v.length-1];L.scale=z,L.font=V,L.textColor=E}else{const z=l.parse(i[x],x,ci);if(!z)return null;const V=z.type.kind;if(V!=="string"&&V!=="value"&&V!=="null"&&V!=="resolvedImage")return l.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");p=!0,v.push({content:z,scale:null,font:null,textColor:null})}}return new _l(v)}evaluate(i){return new Yo(this.sections.map(l=>{const h=l.content.evaluate(i);return to(h)===qa?new _o("",h,null,null,null):new _o(So(h),null,l.scale?l.scale.evaluate(i):null,l.font?l.font.evaluate(i).join(","):null,l.textColor?l.textColor.evaluate(i):null)}))}eachChild(i){for(const l of this.sections)i(l.content),l.scale&&i(l.scale),l.font&&i(l.font),l.textColor&&i(l.textColor)}outputDefined(){return!1}serialize(){const i=["format"];for(const l of this.sections){i.push(l.content.serialize());const h={};l.scale&&(h["font-scale"]=l.scale.serialize()),l.font&&(h["text-font"]=l.font.serialize()),l.textColor&&(h["text-color"]=l.textColor.serialize()),i.push(h)}return i}}class Nl{constructor(i,l){this.type=qa,this.inputPrimary=i,this.inputSecondary=l}static parse(i,l){if(i.length<2)return l.error("Expected two or more arguments.");const h=l.parse(i[1],1,xr);if(!h)return l.error("No image name provided.");if(i.length===2)return new Nl(h);const v=l.parse(i[2],1,xr);return v?new Nl(h,v):l.error("Secondary image variant is not a string.")}evaluate(i){const l=Hs.fromString(this.inputPrimary.evaluate(i),this.inputSecondary?this.inputSecondary.evaluate(i):void 0);return l&&i.availableImages&&(l.available=i.availableImages.indexOf(l.namePrimary)>-1,l.nameSecondary&&l.available&&i.availableImages&&(l.available=i.availableImages.indexOf(l.nameSecondary)>-1)),l}eachChild(i){i(this.inputPrimary),this.inputSecondary&&i(this.inputSecondary)}outputDefined(){return!1}serialize(){return this.inputSecondary?["image",this.inputPrimary.serialize(),this.inputSecondary.serialize()]:["image",this.inputPrimary.serialize()]}}function Bl(d){return d instanceof Number?"number":d instanceof String?"string":d instanceof Boolean?"boolean":Array.isArray(d)?"array":d===null?"null":typeof d}const ud={"to-boolean":ai,"to-color":Gs,"to-number":On,"to-string":xr};class Ws{constructor(i,l){this.type=i,this.args=l}static parse(i,l){if(i.length<2)return l.error("Expected at least one argument.");const h=i[0],v=[];let p=ta;if(h==="to-array"){if(!Array.isArray(i[1]))return null;const x=i[1].length;if(l.expectedType){if(l.expectedType.kind!=="array")return l.error(`Expected ${l.expectedType.kind} but found array.`);p=ws(l.expectedType.itemType,x)}else{if(!(x>0&&Pa(i[1][0])))return null;p=ws(to(i[1][0]),x)}for(let M=0;M<x;M++){const z=i[1][M];let V;if(Bl(z)==="array")V=l.parse(z,void 0,p.itemType);else{const E=Bl(z);if(E!==p.itemType.kind)return l.error(`Expected ${p.itemType.kind} but found ${E}.`);V=l.registry.literal.parse(["literal",z===void 0?null:z],l)}if(!V)return null;v.push(V)}}else{if((h==="to-boolean"||h==="to-string")&&i.length!==2)return l.error("Expected one argument.");p=ud[h];for(let x=1;x<i.length;x++){const M=l.parse(i[x],x,ci);if(!M)return null;v.push(M)}}return new Ws(p,v)}evaluate(i){if(this.type.kind==="boolean")return!!this.args[0].evaluate(i);if(this.type.kind==="color"){let l,h;for(const v of this.args){if(l=v.evaluate(i),h=null,l instanceof Tr)return l;if(typeof l=="string"){const p=i.parseColor(l);if(p)return p}else if(Array.isArray(l)&&(h=l.length<3||l.length>4?`Invalid rbga value ${JSON.stringify(l)}: expected an array containing either three or four numeric values.`:Xa(l[0],l[1],l[2],l[3]),!h))return new Tr(l[0]/255,l[1]/255,l[2]/255,l[3])}throw new zo(h||`Could not parse color from value '${typeof l=="string"?l:String(JSON.stringify(l))}'`)}if(this.type.kind==="number"){let l=null;for(const h of this.args){if(l=h.evaluate(i),l===null)return 0;const v=Number(l);if(!isNaN(v))return v}throw new zo(`Could not convert ${JSON.stringify(l)} to number.`)}return this.type.kind==="formatted"?Yo.fromString(So(this.args[0].evaluate(i))):this.type.kind==="resolvedImage"?Hs.fromString(So(this.args[0].evaluate(i))):this.type.kind==="array"?this.args.map(l=>l.evaluate(i)):So(this.args[0].evaluate(i))}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}serialize(){if(this.type.kind==="formatted")return new _l([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Nl(this.args[0]).serialize();const i=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(l=>{i.push(l.serialize())}),i}}const jl=["Unknown","Point","LineString","Polygon"];class ia{constructor(i,l){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=i,this.options=l}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?jl[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(i){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const i=this.featureDistanceData.center,l=this.featureDistanceData.scale,{x:h,y:v}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(h*l-i[0])+this.featureDistanceData.bearing[1]*(v*l-i[1])}return 0}parseColor(i){let l=this._parseColorCache[i];return l||(l=this._parseColorCache[i]=Tr.parse(i)),l}getConfig(i){return this.options?this.options.get(i):null}}class oa{constructor(i,l,h,v,p){this.name=i,this.type=l,this._evaluate=h,this.args=v,this._overloadIndex=p}evaluate(i){if(!this._evaluate){const l=oa.definitions[this.name];this._evaluate=Array.isArray(l)?l[2]:l.overloads[this._overloadIndex][1]}return this._evaluate(i,this.args)}eachChild(i){this.args.forEach(i)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(i=>i.serialize()))}static parse(i,l){const h=i[0],v=oa.definitions[h];if(!v)return l.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0);const p=Array.isArray(v)?v[0]:v.type,x=Array.isArray(v)?[[v[1],v[2]]]:v.overloads,M=[];let z=null,V=-1;for(const[E,L]of x){if(Array.isArray(E)&&E.length!==i.length-1)continue;M.push(E),V++,z=new xa(l.registry,l.path,null,l.scope,void 0,l._scope,l.options);const B=[];let O=!1;for(let F=1;F<i.length;F++){const G=i[F],Q=Array.isArray(E)?E[F-1]:E.type,ie=z.parse(G,1+B.length,Q);if(!ie){O=!0;break}B.push(ie)}if(!O)if(Array.isArray(E)&&E.length!==B.length)z.error(`Expected ${E.length} arguments, but found ${B.length} instead.`);else{for(let F=0;F<B.length;F++){const G=Array.isArray(E)?E[F]:E.type,Q=B[F];z.concat(F+1).checkSubtype(G,Q.type)}if(z.errors.length===0)return new oa(h,p,L,B,V)}}if(M.length===1)l.errors.push(...z.errors);else{const E=(M.length?M:x.map(([B])=>B)).map(cd).join(" | "),L=[];for(let B=1;B<i.length;B++){const O=l.parse(i[B],1+L.length);if(!O)return null;L.push(co(O.type))}l.error(`Expected arguments of type ${E}, but found (${L.join(", ")}) instead.`)}return null}static register(i,l){oa.definitions=l;for(const h in l)i[h]=oa}}function cd(d){return Array.isArray(d)?`(${d.map(co).join(", ")})`:`(${co(d.type)}...)`}class Vl{constructor(i,l,h){this.type=us,this.locale=h,this.caseSensitive=i,this.diacriticSensitive=l}static parse(i,l){if(i.length!==2)return l.error("Expected one argument.");const h=i[1];if(typeof h!="object"||Array.isArray(h))return l.error("Collator options argument must be an object.");const v=h["case-sensitive"]===void 0?l.parse(!1,1,ai):l.parseObjectValue(h["case-sensitive"],1,"case-sensitive",ai);if(!v)return null;const p=h["diacritic-sensitive"]===void 0?l.parse(!1,1,ai):l.parseObjectValue(h["diacritic-sensitive"],1,"diacritic-sensitive",ai);if(!p)return null;let x=null;return h.locale&&(x=l.parseObjectValue(h.locale,1,"locale",xr),!x)?null:new Vl(v,p,x)}evaluate(i){return new Ec(this.caseSensitive.evaluate(i),this.diacriticSensitive.evaluate(i),this.locale?this.locale.evaluate(i):null)}eachChild(i){i(this.caseSensitive),i(this.diacriticSensitive),this.locale&&i(this.locale)}outputDefined(){return!1}serialize(){const i={};return i["case-sensitive"]=this.caseSensitive.serialize(),i["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(i.locale=this.locale.serialize()),["collator",i]}}function Du(d,i,l=0,h=d.length-1,v=Ya){for(;h>l;){if(h-l>600){const z=h-l+1,V=i-l+1,E=Math.log(z),L=.5*Math.exp(2*E/3),B=.5*Math.sqrt(E*L*(z-L)/z)*(V-z/2<0?-1:1);Du(d,i,Math.max(l,Math.floor(i-V*L/z+B)),Math.min(h,Math.floor(i+(z-V)*L/z+B)),v)}const p=d[i];let x=l,M=h;for(vl(d,l,i),v(d[h],p)>0&&vl(d,l,h);x<M;){for(vl(d,x,M),x++,M--;v(d[x],p)<0;)x++;for(;v(d[M],p)>0;)M--}v(d[l],p)===0?vl(d,l,M):(M++,vl(d,M,h)),M<=i&&(l=M+1),i<=M&&(h=M-1)}}function vl(d,i,l){const h=d[i];d[i]=d[l],d[l]=h}function Ya(d,i){return d<i?-1:d>i?1:0}function zu(d){let i=0;for(let l,h,v=0,p=d.length,x=p-1;v<p;x=v++)l=d[v],h=d[x],i+=(h.x-l.x)*(l.y+h.y);return i}function qs(d,i){d[0]=Math.min(d[0],i[0]),d[1]=Math.min(d[1],i[1]),d[2]=Math.max(d[2],i[0]),d[3]=Math.max(d[3],i[1])}function $l(d,i){return!(d[0]<=i[0]||d[2]>=i[2]||d[1]<=i[1]||d[3]>=i[3])}function ca(d,i,l){const h=d[0]-i[0],v=d[1]-i[1],p=d[0]-l[0],x=d[1]-l[1];return h*x-p*v==0&&h*p<=0&&v*x<=0}function Za(d,i,l=!1){let h=!1;for(let M=0,z=i.length;M<z;M++){const V=i[M];for(let E=0,L=V.length,B=L-1;E<L;B=E++){const O=V[B],F=V[E];if(ca(d,O,F))return l;(p=O)[1]>(v=d)[1]!=(x=F)[1]>v[1]&&v[0]<(x[0]-p[0])*(v[1]-p[1])/(x[1]-p[1])+p[0]&&(h=!h)}}var v,p,x;return h}function Xh(d,i,l,h){const v=h[0]-l[0],p=h[1]-l[1],x=(d[0]-l[0])*p-v*(d[1]-l[1]),M=(i[0]-l[0])*p-v*(i[1]-l[1]);return x>0&&M<0||x<0&&M>0}function Fu(d,i,l,h){return(v=[h[0]-l[0],h[1]-l[1]])[0]*(p=[i[0]-d[0],i[1]-d[1]])[1]-v[1]*p[0]!=0&&!(!Xh(d,i,l,h)||!Xh(l,h,d,i));var v,p}const Ds=8192;function Hr(d,i){const l=(180+d[0])/360,h=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+d[1]*Math.PI/360)))/360,v=Math.pow(2,i.z);return[Math.round(l*v*Ds),Math.round(h*v*Ds)]}function cr(d,i){for(let l=0;l<i.length;l++)if(Za(d,i[l]))return!0;return!1}function xl(d,i,l){for(const h of l)for(let v=0,p=h.length,x=p-1;v<p;x=v++)if(Fu(d,i,h[x],h[v]))return!0;return!1}function Dr(d,i){for(let l=0;l<d.length;++l)if(!Za(d[l],i))return!1;for(let l=0;l<d.length-1;++l)if(xl(d[l],d[l+1],i))return!1;return!0}function Ka(d,i){for(let l=0;l<i.length;l++)if(Dr(d,i[l]))return!0;return!1}function Tc(d,i,l){const h=[];for(let v=0;v<d.length;v++){const p=[];for(let x=0;x<d[v].length;x++){const M=Hr(d[v][x],l);qs(i,M),p.push(M)}h.push(p)}return h}function Mr(d,i,l){const h=[];for(let v=0;v<d.length;v++){const p=Tc(d[v],i,l);h.push(p)}return h}function cu(d,i,l,h){if(d[0]<l[0]||d[0]>l[2]){const v=.5*h;let p=d[0]-l[0]>v?-h:l[0]-d[0]>v?h:0;p===0&&(p=d[0]-l[2]>v?-h:l[2]-d[0]>v?h:0),d[0]+=p}qs(i,d)}function Ic(d,i,l,h){const v=Math.pow(2,h.z)*Ds,p=[h.x*Ds,h.y*Ds],x=[];if(!d)return x;for(const M of d)for(const z of M){const V=[z.x+p[0],z.y+p[1]];cu(V,i,l,v),x.push(V)}return x}function dd(d,i,l,h){const v=Math.pow(2,h.z)*Ds,p=[h.x*Ds,h.y*Ds],x=[];if(!d)return x;for(const z of d){const V=[];for(const E of z){const L=[E.x+p[0],E.y+p[1]];qs(i,L),V.push(L)}x.push(V)}if(i[2]-i[0]<=v/2){(M=i)[0]=M[1]=1/0,M[2]=M[3]=-1/0;for(const z of x)for(const V of z)cu(V,i,l,v)}var M;return x}class bl{constructor(i,l){this.type=ai,this.geojson=i,this.geometries=l}static parse(i,l){if(i.length!==2)return l.error(`'within' expression requires exactly one argument, but found ${i.length-1} instead.`);if(Pa(i[1])){const h=i[1];if(h.type==="FeatureCollection")for(let v=0;v<h.features.length;++v){const p=h.features[v].geometry.type;if(p==="Polygon"||p==="MultiPolygon")return new bl(h,h.features[v].geometry)}else if(h.type==="Feature"){const v=h.geometry.type;if(v==="Polygon"||v==="MultiPolygon")return new bl(h,h.geometry)}else if(h.type==="Polygon"||h.type==="MultiPolygon")return new bl(h,h)}return l.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(i){if(i.geometry()!=null&&i.canonicalID()!=null){if(i.geometryType()==="Point")return function(l,h){const v=[1/0,1/0,-1/0,-1/0],p=[1/0,1/0,-1/0,-1/0],x=l.canonicalID();if(!x)return!1;if(h.type==="Polygon"){const M=Tc(h.coordinates,p,x),z=Ic(l.geometry(),v,p,x);if(!$l(v,p))return!1;for(const V of z)if(!Za(V,M))return!1}if(h.type==="MultiPolygon"){const M=Mr(h.coordinates,p,x),z=Ic(l.geometry(),v,p,x);if(!$l(v,p))return!1;for(const V of z)if(!cr(V,M))return!1}return!0}(i,this.geometries);if(i.geometryType()==="LineString")return function(l,h){const v=[1/0,1/0,-1/0,-1/0],p=[1/0,1/0,-1/0,-1/0],x=l.canonicalID();if(!x)return!1;if(h.type==="Polygon"){const M=Tc(h.coordinates,p,x),z=dd(l.geometry(),v,p,x);if(!$l(v,p))return!1;for(const V of z)if(!Dr(V,M))return!1}if(h.type==="MultiPolygon"){const M=Mr(h.coordinates,p,x),z=dd(l.geometry(),v,p,x);if(!$l(v,p))return!1;for(const V of z)if(!Ka(V,M))return!1}return!0}(i,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}const du={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},cs=1/298.257223563,kc=cs*(2-cs),wl=Math.PI/180;class Aa{static fromTile(i,l,h){const v=Math.PI*(1-2*(i+.5)/Math.pow(2,l)),p=Math.atan(.5*(Math.exp(v)-Math.exp(-v)))/wl;return new Aa(p,h)}static get units(){return du}constructor(i,l){if(i===void 0)throw new Error("No latitude given.");if(l&&!du[l])throw new Error(`Unknown unit ${l}. Use one of: ${Object.keys(du).join(", ")}`);const h=6378.137*wl*(l?du[l]:1),v=Math.cos(i*wl),p=1/(1-kc*(1-v*v)),x=Math.sqrt(p);this.kx=h*x*v,this.ky=h*x*p*(1-kc)}distance(i,l){const h=ho(i[0]-l[0])*this.kx,v=(i[1]-l[1])*this.ky;return Math.sqrt(h*h+v*v)}bearing(i,l){const h=ho(l[0]-i[0])*this.kx;return Math.atan2(h,(l[1]-i[1])*this.ky)/wl}destination(i,l,h){const v=h*wl;return this.offset(i,Math.sin(v)*l,Math.cos(v)*l)}offset(i,l,h){return[i[0]+l/this.kx,i[1]+h/this.ky]}lineDistance(i){let l=0;for(let h=0;h<i.length-1;h++)l+=this.distance(i[h],i[h+1]);return l}area(i){let l=0;for(let h=0;h<i.length;h++){const v=i[h];for(let p=0,x=v.length,M=x-1;p<x;M=p++)l+=ho(v[p][0]-v[M][0])*(v[p][1]+v[M][1])*(h?-1:1)}return Math.abs(l)/2*this.kx*this.ky}along(i,l){let h=0;if(l<=0)return i[0];for(let v=0;v<i.length-1;v++){const p=i[v],x=i[v+1],M=this.distance(p,x);if(h+=M,h>l)return zs(p,x,(l-(h-M))/M)}return i[i.length-1]}pointToSegmentDistance(i,l,h){let[v,p]=l,x=ho(h[0]-v)*this.kx,M=(h[1]-p)*this.ky;if(x!==0||M!==0){const z=(ho(i[0]-v)*this.kx*x+(i[1]-p)*this.ky*M)/(x*x+M*M);z>1?(v=h[0],p=h[1]):z>0&&(v+=x/this.kx*z,p+=M/this.ky*z)}return x=ho(i[0]-v)*this.kx,M=(i[1]-p)*this.ky,Math.sqrt(x*x+M*M)}pointOnLine(i,l){let h=1/0,v=i[0][0],p=i[0][1],x=0,M=0;for(let z=0;z<i.length-1;z++){let V=i[z][0],E=i[z][1],L=ho(i[z+1][0]-V)*this.kx,B=(i[z+1][1]-E)*this.ky,O=0;L===0&&B===0||(O=(ho(l[0]-V)*this.kx*L+(l[1]-E)*this.ky*B)/(L*L+B*B),O>1?(V=i[z+1][0],E=i[z+1][1]):O>0&&(V+=L/this.kx*O,E+=B/this.ky*O)),L=ho(l[0]-V)*this.kx,B=(l[1]-E)*this.ky;const F=L*L+B*B;F<h&&(h=F,v=V,p=E,x=z,M=O)}return{point:[v,p],index:x,t:Math.max(0,Math.min(1,M))}}lineSlice(i,l,h){let v=this.pointOnLine(h,i),p=this.pointOnLine(h,l);if(v.index>p.index||v.index===p.index&&v.t>p.t){const V=v;v=p,p=V}const x=[v.point],M=v.index+1,z=p.index;!hd(h[M],x[0])&&M<=z&&x.push(h[M]);for(let V=M+1;V<=z;V++)x.push(h[V]);return hd(h[z],p.point)||x.push(p.point),x}lineSliceAlong(i,l,h){let v=0;const p=[];for(let x=0;x<h.length-1;x++){const M=h[x],z=h[x+1],V=this.distance(M,z);if(v+=V,v>i&&p.length===0&&p.push(zs(M,z,(i-(v-V))/V)),v>=l)return p.push(zs(M,z,(l-(v-V))/V)),p;v>i&&p.push(z)}return p}bufferPoint(i,l){const h=l/this.ky,v=l/this.kx;return[i[0]-v,i[1]-h,i[0]+v,i[1]+h]}bufferBBox(i,l){const h=l/this.ky,v=l/this.kx;return[i[0]-v,i[1]-h,i[2]+v,i[3]+h]}insideBBox(i,l){return ho(i[0]-l[0])>=0&&ho(i[0]-l[2])<=0&&i[1]>=l[1]&&i[1]<=l[3]}}function hd(d,i){return d[0]===i[0]&&d[1]===i[1]}function zs(d,i,l){const h=ho(i[0]-d[0]);return[d[0]+h*l,d[1]+(i[1]-d[1])*l]}function ho(d){for(;d<-180;)d+=360;for(;d>180;)d-=360;return d}class Sl{constructor(i=[],l=(h,v)=>h<v?-1:h>v?1:0){if(this.data=i,this.length=this.data.length,this.compare=l,this.length>0)for(let h=(this.length>>1)-1;h>=0;h--)this._down(h)}push(i){this.data.push(i),this._up(this.length++)}pop(){if(this.length===0)return;const i=this.data[0],l=this.data.pop();return--this.length>0&&(this.data[0]=l,this._down(0)),i}peek(){return this.data[0]}_up(i){const{data:l,compare:h}=this,v=l[i];for(;i>0;){const p=i-1>>1,x=l[p];if(h(v,x)>=0)break;l[i]=x,i=p}l[i]=v}_down(i){const{data:l,compare:h}=this,v=this.length>>1,p=l[i];for(;i<v;){let x=1+(i<<1);const M=x+1;if(M<this.length&&h(l[M],l[x])<0&&(x=M),h(l[x],p)>=0)break;l[i]=l[x],i=x}l[i]=p}}var Nn=8192;function nh(d,i){return i.dist-d.dist}const Ja=100,Nu=50;function Bu(d){const i=[1/0,1/0,-1/0,-1/0];if(i.length!==d.length)return!1;for(let l=0;l<i.length;l++)if(i[l]!==d[l])return!1;return!0}function hu(d){return d[1]-d[0]+1}function Qa(d,i){const l=d[1]>=d[0]&&d[1]<i;return l||console.warn("Distance Expression: Index is out of range"),l}function Ul(d,i){if(d[0]>d[1])return[null,null];const l=hu(d);if(i){if(l===2)return[d,null];const h=Math.floor(l/2);return[[d[0],d[0]+h],[d[0]+h,d[1]]]}{if(l===1)return[d,null];const h=Math.floor(l/2)-1;return[[d[0],d[0]+h],[d[0]+h+1,d[1]]]}}function Xs(d,i){const l=[1/0,1/0,-1/0,-1/0];if(!Qa(i,d.length))return l;for(let h=i[0];h<=i[1];++h)qs(l,d[h]);return l}function fd(d){const i=[1/0,1/0,-1/0,-1/0];for(let l=0;l<d.length;++l)for(let h=0;h<d[l].length;++h)qs(i,d[l][h]);return i}function rn(d,i,l){if(Bu(d)||Bu(i))return NaN;let h=0,v=0;return d[2]<i[0]&&(h=i[0]-d[2]),d[0]>i[2]&&(h=d[0]-i[2]),d[1]>i[3]&&(v=d[1]-i[3]),d[3]<i[1]&&(v=i[1]-d[3]),l.distance([0,0],[h,v])}function wn(d){return 360*d-180}function pr(d){return 360/Math.PI*Math.atan(Math.exp((180-360*d)*Math.PI/180))-90}function Pr(d,i){const l=Math.pow(2,i.z),h=(d.y/Nn+i.y)/l;return[wn((d.x/Nn+i.x)/l),pr(h)]}function Ti(d,i){const l=[];for(let h=0;h<d.length;++h)l.push(Pr(d[h],i));return l}function di(d,i,l){const h=l.pointOnLine(i,d).point;return l.distance(d,h)}function U(d,i,l,h,v){const p=l.slice(h[0],h[1]+1);let x=1/0;for(let M=i[0];M<=i[1];++M)if((x=Math.min(x,di(d[M],p,v)))===0)return 0;return x}function m(d,i,l,h,v){const p=Math.min(v.pointToSegmentDistance(d,l,h),v.pointToSegmentDistance(i,l,h)),x=Math.min(v.pointToSegmentDistance(l,d,i),v.pointToSegmentDistance(h,d,i));return Math.min(p,x)}function b(d,i,l,h,v){if(!Qa(i,d.length)||!Qa(h,l.length))return NaN;let p=1/0;for(let x=i[0];x<i[1];++x)for(let M=h[0];M<h[1];++M){if(Fu(d[x],d[x+1],l[M],l[M+1]))return 0;p=Math.min(p,m(d[x],d[x+1],l[M],l[M+1],v))}return p}function w(d,i,l,h,v){if(!Qa(i,d.length)||!Qa(h,l.length))return NaN;let p=1/0;for(let x=i[0];x<=i[1];++x)for(let M=h[0];M<=h[1];++M)if((p=Math.min(p,v.distance(d[x],l[M])))===0)return p;return p}function R(d,i,l){if(Za(d,i,!0))return 0;let h=1/0;for(const v of i){const p=v.length;if(p<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(v[0]!==v[p-1]&&(h=Math.min(h,l.pointToSegmentDistance(d,v[p-1],v[0])))===0||(h=Math.min(h,di(d,v,l)))===0)return h}return h}function J(d,i,l,h){if(!Qa(i,d.length))return NaN;for(let p=i[0];p<=i[1];++p)if(Za(d[p],l,!0))return 0;let v=1/0;for(let p=i[0];p<i[1];++p)for(const x of l)for(let M=0,z=x.length,V=z-1;M<z;V=M++){if(Fu(d[p],d[p+1],x[V],x[M]))return 0;v=Math.min(v,m(d[p],d[p+1],x[V],x[M],h))}return v}function ve(d,i){for(const l of d)for(let h=0;h<=l.length-1;++h)if(Za(l[h],i,!0))return!0;return!1}function Ie(d,i,l,h=1/0){const v=fd(d),p=fd(i);if(h!==1/0&&rn(v,p,l)>=h)return h;if($l(v,p)){if(ve(d,i))return 0}else if(ve(i,d))return 0;let x=h;for(const M of d)for(let z=0,V=M.length,E=V-1;z<V;E=z++)for(const L of i)for(let B=0,O=L.length,F=O-1;B<O;F=B++){if(Fu(M[E],M[z],L[F],L[B]))return 0;x=Math.min(x,m(M[E],M[z],L[F],L[B],l))}return x}function je(d,i,l,h,v,p,x){if(p===null||x===null)return;const M=rn(Xs(h,p),Xs(v,x),l);M<i&&d.push({dist:M,range1:p,range2:x})}function lt(d,i,l,h,v=1/0){let p=Math.min(h.distance(d[0],l[0][0]),v);if(p===0)return p;const x=new Sl([{dist:0,range1:[0,d.length-1],range2:[0,0]}],nh),M=i?Nu:Ja,z=fd(l);for(;x.length;){const V=x.pop();if(V.dist>=p)continue;const E=V.range1;if(hu(E)<=M){if(!Qa(E,d.length))return NaN;if(i){const L=J(d,E,l,h);if((p=Math.min(p,L))===0)return p}else for(let L=E[0];L<=E[1];++L){const B=R(d[L],l,h);if((p=Math.min(p,B))===0)return p}}else{const L=Ul(E,i);if(L[0]!==null){const B=rn(Xs(d,L[0]),z,h);B<p&&x.push({dist:B,range1:L[0],range2:[0,0]})}if(L[1]!==null){const B=rn(Xs(d,L[1]),z,h);B<p&&x.push({dist:B,range1:L[1],range2:[0,0]})}}}return p}function Ft(d,i,l,h,v,p=1/0){let x=Math.min(p,v.distance(d[0],l[0]));if(x===0)return x;const M=new Sl([{dist:0,range1:[0,d.length-1],range2:[0,l.length-1]}],nh),z=i?Nu:Ja,V=h?Nu:Ja;for(;M.length;){const E=M.pop();if(E.dist>=x)continue;const L=E.range1,B=E.range2;if(hu(L)<=z&&hu(B)<=V){if(!Qa(L,d.length)||!Qa(B,l.length))return NaN;if(i&&h?x=Math.min(x,b(d,L,l,B,v)):i||h?i&&!h?x=Math.min(x,U(l,B,d,L,v)):!i&&h&&(x=Math.min(x,U(d,L,l,B,v))):x=Math.min(x,w(d,L,l,B,v)),x===0)return x}else{const O=Ul(L,i),F=Ul(B,h);je(M,x,v,d,l,O[0],F[0]),je(M,x,v,d,l,O[0],F[1]),je(M,x,v,d,l,O[1],F[0]),je(M,x,v,d,l,O[1],F[1])}}return x}function Kt(d,i,l,h,v=1/0){let p=v;const x=Xs(d,[0,d.length-1]);for(const M of l)if(!(p!==1/0&&rn(x,Xs(M,[0,M.length-1]),h)>=p)&&(p=Math.min(p,Ft(d,i,M,!0,h,p)),p===0))return p;return p}function En(d,i,l,h,v=1/0){let p=v;const x=Xs(d,[0,d.length-1]);for(const M of l){if(p!==1/0&&rn(x,fd(M),h)>=p)continue;const z=lt(d,i,M,h,p);if(isNaN(z))return z;if((p=Math.min(p,z))===0)return p}return p}function or(d){return d==="Point"||d==="MultiPoint"||d==="LineString"||d==="MultiLineString"||d==="Polygon"||d==="MultiPolygon"}class er{constructor(i,l){this.type=On,this.geojson=i,this.geometries=l}static parse(i,l){if(i.length!==2)return l.error(`'distance' expression requires either one argument, but found ' ${i.length-1} instead.`);if(Pa(i[1])){const h=i[1];if(h.type==="FeatureCollection"){for(let v=0;v<h.features.length;++v)if(or(h.features[v].geometry.type))return new er(h,h.features[v].geometry)}else if(h.type==="Feature"){if(or(h.geometry.type))return new er(h,h.geometry)}else if(or(h.type))return new er(h,h)}return l.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(i){const l=i.geometry(),h=i.canonicalID();if(l!=null&&h!=null){if(i.geometryType()==="Point")return function(v,p,x){const M=[];for(const V of v)for(const E of V)M.push(Pr(E,p));const z=new Aa(M[0][1],"meters");return x.type==="Point"||x.type==="MultiPoint"||x.type==="LineString"?Ft(M,!1,x.type==="Point"?[x.coordinates]:x.coordinates,x.type==="LineString",z):x.type==="MultiLineString"?Kt(M,!1,x.coordinates,z):x.type==="Polygon"||x.type==="MultiPolygon"?En(M,!1,x.type==="Polygon"?[x.coordinates]:x.coordinates,z):null}(l,h,this.geometries);if(i.geometryType()==="LineString")return function(v,p,x){const M=[];for(const V of v){const E=[];for(const L of V)E.push(Pr(L,p));M.push(E)}const z=new Aa(M[0][0][1],"meters");if(x.type==="Point"||x.type==="MultiPoint"||x.type==="LineString")return Kt(x.type==="Point"?[x.coordinates]:x.coordinates,x.type==="LineString",M,z);if(x.type==="MultiLineString"){let V=1/0;for(let E=0;E<x.coordinates.length;E++){const L=Kt(x.coordinates[E],!0,M,z,V);if(isNaN(L))return L;if((V=Math.min(V,L))===0)return V}return V}if(x.type==="Polygon"||x.type==="MultiPolygon"){let V=1/0;for(let E=0;E<M.length;E++){const L=En(M[E],!0,x.type==="Polygon"?[x.coordinates]:x.coordinates,z,V);if(isNaN(L))return L;if((V=Math.min(V,L))===0)return V}return V}return null}(l,h,this.geometries);if(i.geometryType()==="Polygon")return function(v,p,x){const M=[];for(const V of function(E,L){const B=E.length;if(B<=1)return[E];const O=[];let F,G;for(let Q=0;Q<B;Q++){const ie=zu(E[Q]);ie!==0&&(E[Q].area=Math.abs(ie),G===void 0&&(G=ie<0),G===ie<0?(F&&O.push(F),F=[E[Q]]):F.push(E[Q]))}return F&&O.push(F),O}(v)){const E=[];for(let L=0;L<V.length;++L)E.push(Ti(V[L],p));M.push(E)}const z=new Aa(M[0][0][0][1],"meters");if(x.type==="Point"||x.type==="MultiPoint"||x.type==="LineString")return En(x.type==="Point"?[x.coordinates]:x.coordinates,x.type==="LineString",M,z);if(x.type==="MultiLineString"){let V=1/0;for(let E=0;E<x.coordinates.length;E++){const L=En(x.coordinates[E],!0,M,z,V);if(isNaN(L))return L;if((V=Math.min(V,L))===0)return V}return V}return x.type==="Polygon"||x.type==="MultiPolygon"?function(V,E,L){let B=1/0;for(const O of V)for(const F of E){const G=Ie(O,F,L,B);if(isNaN(G))return G;if((B=Math.min(B,G))===0)return B}return B}(x.type==="Polygon"?[x.coordinates]:x.coordinates,M,z):null}(l,h,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function Nr(d,i){switch(d){case"string":return So(i);case"number":return+i;case"boolean":return!!i;case"color":return Tr.parse(i);case"formatted":return Yo.fromString(So(i));case"resolvedImage":return Hs.fromString(So(i))}return i}function Bn(d,i,l,h){return h!==void 0&&(d=h*Math.round(d/h)),i!==void 0&&d<i&&(d=i),l!==void 0&&d>l&&(d=l),d}class wr{constructor(i,l,h){this.type=i,this.key=l,this.scope=h}static parse(i,l){let h=l.expectedType;if(h==null&&(h=ci),i.length<2||i.length>3)return l.error("Invalid number of arguments for 'config' expression.");const v=l.parse(i[1],1);if(!(v instanceof Zo))return l.error("Key name of 'config' expression must be a string literal.");if(i.length>=3){const p=l.parse(i[2],2);return p instanceof Zo?new wr(h,So(v.value),So(p.value)):l.error("Scope of 'config' expression must be a string literal.")}return new wr(h,So(v.value))}evaluate(i){const l=[this.key,this.scope,i.scope].filter(Boolean).join(""),h=i.getConfig(l);if(!h)return null;const{type:v,value:p,values:x,minValue:M,maxValue:z,stepValue:V}=h,E=h.default.evaluate(i);let L=E;if(p){const B=i.scope;i.scope=(B||"").split("").slice(1).join(""),L=p.evaluate(i),i.scope=B}return v&&(L=Nr(v,L)),L===void 0||M===void 0&&z===void 0&&V===void 0||(typeof L=="number"?L=Bn(L,M,z,V):Array.isArray(L)&&(L=L.map(B=>typeof B=="number"?Bn(B,M,z,V):B))),p!==void 0&&L!==void 0&&x&&!x.includes(L)&&(L=E,v&&(L=Nr(v,L))),(v&&v!==this.type||L!==void 0&&to(L)!==this.type)&&(L=Nr(this.type.kind,L)),L}eachChild(){}outputDefined(){return!1}serialize(){const i=["config",this.key];return this.scope&&i.concat(this.key),i}}function Pi(d){if(d instanceof oa&&(d.name==="get"&&d.args.length===1||d.name==="feature-state"||d.name==="has"&&d.args.length===1||d.name==="properties"||d.name==="geometry-type"||d.name==="id"||/^filter-/.test(d.name))||d instanceof bl||d instanceof er)return!1;let i=!0;return d.eachChild(l=>{i&&!Pi(l)&&(i=!1)}),i}function Vi(d){if(d instanceof oa&&d.name==="feature-state")return!1;let i=!0;return d.eachChild(l=>{i&&!Vi(l)&&(i=!1)}),i}function Ko(d){if(d instanceof wr)return new Set([d.key]);let i=new Set;return d.eachChild(l=>{i=new Set([...i,...Ko(l)])}),i}function so(d,i){if(d instanceof oa&&i.indexOf(d.name)>=0)return!1;let l=!0;return d.eachChild(h=>{l&&!so(h,i)&&(l=!1)}),l}class ti{constructor(i,l){this.type=l.type,this.name=i,this.boundExpression=l}static parse(i,l){if(i.length!==2||typeof i[1]!="string")return l.error("'var' expression requires exactly one string literal argument.");const h=i[1];return l.scope.has(h)?new ti(h,l.scope.get(h)):l.error(`Unknown variable "${h}". Make sure "${h}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(i){return this.boundExpression.evaluate(i)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class gs{constructor(i,l=[],h,v=new Mo,p=[],x,M){this.registry=i,this.path=l,this.key=l.map(z=>typeof z=="string"?`['${z}']`:`[${z}]`).join(""),this.scope=v,this.errors=p,this.expectedType=h,this._scope=x,this.options=M}parse(i,l,h,v,p={}){return l||h?this.concat(l,null,h,v)._parse(i,p):this._parse(i,p)}parseObjectValue(i,l,h,v,p,x={}){return this.concat(l,h,v,p)._parse(i,x)}_parse(i,l){function h(v,p,x){return x==="assert"?new va(p,[v]):x==="coerce"?new Ws(p,[v]):v}if(i!==null&&typeof i!="string"&&typeof i!="boolean"&&typeof i!="number"||(i=["literal",i]),Array.isArray(i)){if(i.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const v=typeof i[0]=="string"?this.registry[i[0]]:void 0;if(v){let p=v.parse(i,this);if(!p)return null;if(this.expectedType){const x=this.expectedType,M=p.type;if(x.kind!=="string"&&x.kind!=="number"&&x.kind!=="boolean"&&x.kind!=="object"&&x.kind!=="array"||M.kind!=="value")if(x.kind!=="color"&&x.kind!=="formatted"&&x.kind!=="resolvedImage"||M.kind!=="value"&&M.kind!=="string"){if(this.checkSubtype(x,M))return null}else p=h(p,x,l.typeAnnotation||"coerce");else p=h(p,x,l.typeAnnotation||"assert")}if(!(p instanceof Zo)&&p.type.kind!=="resolvedImage"&&el(p)){const x=new ia(this._scope,this.options);try{p=new Zo(p.type,p.evaluate(x))}catch(M){return this.error(M.message),null}}return p}return Ws.parse(["to-array",i],this)}return this.error(i===void 0?"'undefined' value invalid. Use null instead.":typeof i=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof i} instead.`)}concat(i,l,h,v){let p=typeof i=="number"?this.path.concat(i):this.path;p=typeof l=="string"?p.concat(l):p;const x=v?this.scope.concat(v):this.scope;return new gs(this.registry,p,h||null,x,this.errors,this._scope,this.options)}error(i,...l){const h=`${this.key}${l.map(v=>`[${v}]`).join("")}`;this.errors.push(new Qi(h,i))}checkSubtype(i,l){const h=uu(i,l);return h&&this.error(h),h}}var xa=gs;function el(d){if(d instanceof ti)return el(d.boundExpression);if(d instanceof oa&&d.name==="error"||d instanceof Vl||d instanceof bl||d instanceof er||d instanceof wr)return!1;const i=d instanceof Ws||d instanceof va;let l=!0;return d.eachChild(h=>{l=i?l&&el(h):l&&h instanceof Zo}),!!l&&Pi(d)&&so(d,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function da(d,i){const l=d.length-1;let h,v,p=0,x=l,M=0;for(;p<=x;)if(M=Math.floor((p+x)/2),h=d[M],v=d[M+1],h<=i){if(M===l||i<v)return M;p=M+1}else{if(!(h>i))throw new zo("Input is not a number.");x=M-1}return 0}class Fs{constructor(i,l,h){this.type=i,this.input=l,this.labels=[],this.outputs=[];for(const[v,p]of h)this.labels.push(v),this.outputs.push(p)}static parse(i,l){if(i.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return l.error("Expected an even number of arguments.");const h=l.parse(i[1],1,On);if(!h)return null;const v=[];let p=null;l.expectedType&&l.expectedType.kind!=="value"&&(p=l.expectedType);for(let x=1;x<i.length;x+=2){const M=x===1?-1/0:i[x],z=i[x+1],V=x,E=x+1;if(typeof M!="number")return l.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',V);if(v.length&&v[v.length-1][0]>=M)return l.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',V);const L=l.parse(z,E,p);if(!L)return null;p=p||L.type,v.push([M,L])}return new Fs(p,h,v)}evaluate(i){const l=this.labels,h=this.outputs;if(l.length===1)return h[0].evaluate(i);const v=this.input.evaluate(i);if(v<=l[0])return h[0].evaluate(i);const p=l.length;return v>=l[p-1]?h[p-1].evaluate(i):h[da(l,v)].evaluate(i)}eachChild(i){i(this.input);for(const l of this.outputs)i(l)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}serialize(){const i=["step",this.input.serialize()];for(let l=0;l<this.labels.length;l++)l>0&&i.push(this.labels[l]),i.push(this.outputs[l].serialize());return i}}const pd=.95047,ju=1.08883,Vu=4/29,La=6/29,rh=3*La*La,Um=La*La*La,Yh=Math.PI/180,Zh=180/Math.PI;function L0(d){return d>Um?Math.pow(d,1/3):d/rh+Vu}function R0(d){return d>La?d*d*d:rh*(d-Vu)}function O0(d){return 255*(d<=.0031308?12.92*d:1.055*Math.pow(d,1/2.4)-.055)}function D0(d){return(d/=255)<=.04045?d/12.92:Math.pow((d+.055)/1.055,2.4)}function k1(d){const i=D0(d.r),l=D0(d.g),h=D0(d.b),v=L0((.4124564*i+.3575761*l+.1804375*h)/pd),p=L0((.2126729*i+.7151522*l+.072175*h)/1);return{l:116*p-16,a:500*(v-p),b:200*(p-L0((.0193339*i+.119192*l+.9503041*h)/ju)),alpha:d.a}}function M1(d){let i=(d.l+16)/116,l=isNaN(d.a)?i:i+d.a/500,h=isNaN(d.b)?i:i-d.b/200;return i=1*R0(i),l=pd*R0(l),h=ju*R0(h),new Tr(O0(3.2404542*l-1.5371385*i-.4985314*h),O0(-.969266*l+1.8760108*i+.041556*h),O0(.0556434*l-.2040259*i+1.0572252*h),d.alpha)}function eT(d,i,l){const h=i-d;return d+l*(h>180||h<-180?h-360*Math.round(h/360):h)}const Cp={forward:k1,reverse:M1,interpolate:function(d,i,l){return{l:sr(d.l,i.l,l),a:sr(d.a,i.a,l),b:sr(d.b,i.b,l),alpha:sr(d.alpha,i.alpha,l)}}},Ep={forward:function(d){const{l:i,a:l,b:h}=k1(d),v=Math.atan2(h,l)*Zh;return{h:v<0?v+360:v,c:Math.sqrt(l*l+h*h),l:i,alpha:d.a}},reverse:function(d){const i=d.h*Yh,l=d.c;return M1({l:d.l,a:Math.cos(i)*l,b:Math.sin(i)*l,alpha:d.alpha})},interpolate:function(d,i,l){return{h:eT(d.h,i.h,l),c:sr(d.c,i.c,l),l:sr(d.l,i.l,l),alpha:sr(d.alpha,i.alpha,l)}}};var P1=Object.freeze({__proto__:null,hcl:Ep,lab:Cp});class Cl{constructor(i,l,h,v,p){this.type=i,this.operator=l,this.interpolation=h,this.input=v,this.labels=[],this.outputs=[];for(const[x,M]of p)this.labels.push(x),this.outputs.push(M)}static interpolationFactor(i,l,h,v){let p=0;if(i.name==="exponential")p=z0(l,i.base,h,v);else if(i.name==="linear")p=z0(l,1,h,v);else if(i.name==="cubic-bezier"){const x=i.controlPoints;p=new Sn(x[0],x[1],x[2],x[3]).solve(z0(l,1,h,v))}return p}static parse(i,l){let[h,v,p,...x]=i;if(!Array.isArray(v)||v.length===0)return l.error("Expected an interpolation type expression.",1);if(v[0]==="linear")v={name:"linear"};else if(v[0]==="exponential"){const V=v[1];if(typeof V!="number")return l.error("Exponential interpolation requires a numeric base.",1,1);v={name:"exponential",base:V}}else{if(v[0]!=="cubic-bezier")return l.error(`Unknown interpolation type ${String(v[0])}`,1,0);{const V=v.slice(1);if(V.length!==4||V.some(E=>typeof E!="number"||E<0||E>1))return l.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);v={name:"cubic-bezier",controlPoints:V}}}if(i.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return l.error("Expected an even number of arguments.");if(p=l.parse(p,2,On),!p)return null;const M=[];let z=null;h==="interpolate-hcl"||h==="interpolate-lab"?z=Gs:l.expectedType&&l.expectedType.kind!=="value"&&(z=l.expectedType);for(let V=0;V<x.length;V+=2){const E=x[V],L=x[V+1],B=V+3,O=V+4;if(typeof E!="number")return l.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',B);if(M.length&&M[M.length-1][0]>=E)return l.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',B);const F=l.parse(L,O,z);if(!F)return null;z=z||F.type,M.push([E,F])}return z.kind==="number"||z.kind==="color"||z.kind==="array"&&z.itemType.kind==="number"&&typeof z.N=="number"?new Cl(z,h,v,p,M):l.error(`Type ${co(z)} is not interpolatable.`)}evaluate(i){const l=this.labels,h=this.outputs;if(l.length===1)return h[0].evaluate(i);const v=this.input.evaluate(i);if(v<=l[0])return h[0].evaluate(i);const p=l.length;if(v>=l[p-1])return h[p-1].evaluate(i);const x=da(l,v),M=Cl.interpolationFactor(this.interpolation,v,l[x],l[x+1]),z=h[x].evaluate(i),V=h[x+1].evaluate(i);return this.operator==="interpolate"?kr[this.type.kind.toLowerCase()](z,V,M):this.operator==="interpolate-hcl"?Ep.reverse(Ep.interpolate(Ep.forward(z),Ep.forward(V),M)):Cp.reverse(Cp.interpolate(Cp.forward(z),Cp.forward(V),M))}eachChild(i){i(this.input);for(const l of this.outputs)i(l)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}serialize(){let i;i=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const l=[this.operator,i,this.input.serialize()];for(let h=0;h<this.labels.length;h++)l.push(this.labels[h],this.outputs[h].serialize());return l}}function z0(d,i,l,h){const v=h-l,p=d-l;return v===0?0:i===1?p/v:(Math.pow(i,p)-1)/(Math.pow(i,v)-1)}class Gm{constructor(i,l){this.type=i,this.args=l}static parse(i,l){if(i.length<2)return l.error("Expectected at least one argument.");let h=null;const v=l.expectedType;v&&v.kind!=="value"&&(h=v);const p=[];for(const M of i.slice(1)){const z=l.parse(M,1+p.length,h,void 0,{typeAnnotation:"omit"});if(!z)return null;h=h||z.type,p.push(z)}const x=v&&p.some(M=>uu(v,M.type));return new Gm(x?ci:h,p)}evaluate(i){let l,h=null,v=0;for(const p of this.args){if(v++,h=p.evaluate(i),h&&h instanceof Hs&&!h.available&&(l||(l=h),h=null,v===this.args.length))return l;if(h!==null)break}return h}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}serialize(){const i=["coalesce"];return this.eachChild(l=>{i.push(l.serialize())}),i}}class Hm{constructor(i,l){this.type=l.type,this.bindings=[].concat(i),this.result=l}evaluate(i){return this.result.evaluate(i)}eachChild(i){for(const l of this.bindings)i(l[1]);i(this.result)}static parse(i,l){if(i.length<4)return l.error(`Expected at least 3 arguments, but found ${i.length-1} instead.`);const h=[];for(let p=1;p<i.length-1;p+=2){const x=i[p];if(typeof x!="string")return l.error(`Expected string, but found ${typeof x} instead.`,p);if(/[^a-zA-Z0-9_]/.test(x))return l.error("Variable names must contain only alphanumeric characters or '_'.",p);const M=l.parse(i[p+1],p+1);if(!M)return null;h.push([x,M])}const v=l.parse(i[i.length-1],i.length-1,l.expectedType,h);return v?new Hm(h,v):null}outputDefined(){return this.result.outputDefined()}serialize(){const i=["let"];for(const[l,h]of this.bindings)i.push(l,h.serialize());return i.push(this.result.serialize()),i}}class F0{constructor(i,l,h){this.type=i,this.index=l,this.input=h}static parse(i,l){if(i.length!==3)return l.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const h=l.parse(i[1],1,On),v=l.parse(i[2],2,ws(l.expectedType||ci));return h&&v?new F0(v.type.itemType,h,v):null}evaluate(i){const l=this.index.evaluate(i),h=this.input.evaluate(i);if(l<0)throw new zo(`Array index out of bounds: ${l} < 0.`);if(l>=h.length)throw new zo(`Array index out of bounds: ${l} > ${h.length-1}.`);if(l!==Math.floor(l))throw new zo(`Array index must be an integer, but found ${l} instead.`);return h[l]}eachChild(i){i(this.index),i(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class N0{constructor(i,l){this.type=ai,this.needle=i,this.haystack=l}static parse(i,l){if(i.length!==3)return l.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const h=l.parse(i[1],1,ci),v=l.parse(i[2],2,ci);return h&&v?na(h.type,[ai,xr,On,ta,ci])?new N0(h,v):l.error(`Expected first argument to be of type boolean, string, number or null, but found ${co(h.type)} instead`):null}evaluate(i){const l=this.needle.evaluate(i),h=this.haystack.evaluate(i);if(h==null)return!1;if(!ra(l,["boolean","string","number","null"]))throw new zo(`Expected first argument to be of type boolean, string, number or null, but found ${co(to(l))} instead.`);if(!ra(h,["string","array"]))throw new zo(`Expected second argument to be of type array or string, but found ${co(to(h))} instead.`);return h.indexOf(l)>=0}eachChild(i){i(this.needle),i(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class Wm{constructor(i,l,h){this.type=On,this.needle=i,this.haystack=l,this.fromIndex=h}static parse(i,l){if(i.length<=2||i.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);const h=l.parse(i[1],1,ci),v=l.parse(i[2],2,ci);if(!h||!v)return null;if(!na(h.type,[ai,xr,On,ta,ci]))return l.error(`Expected first argument to be of type boolean, string, number or null, but found ${co(h.type)} instead`);if(i.length===4){const p=l.parse(i[3],3,On);return p?new Wm(h,v,p):null}return new Wm(h,v)}evaluate(i){const l=this.needle.evaluate(i),h=this.haystack.evaluate(i);if(!ra(l,["boolean","string","number","null"]))throw new zo(`Expected first argument to be of type boolean, string, number or null, but found ${co(to(l))} instead.`);if(!ra(h,["string","array"]))throw new zo(`Expected second argument to be of type array or string, but found ${co(to(h))} instead.`);if(this.fromIndex){const v=this.fromIndex.evaluate(i);return h.indexOf(l,v)}return h.indexOf(l)}eachChild(i){i(this.needle),i(this.haystack),this.fromIndex&&i(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const i=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),i]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class B0{constructor(i,l,h,v,p,x){this.inputType=i,this.type=l,this.input=h,this.cases=v,this.outputs=p,this.otherwise=x}static parse(i,l){if(i.length<5)return l.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if(i.length%2!=1)return l.error("Expected an even number of arguments.");let h,v;l.expectedType&&l.expectedType.kind!=="value"&&(v=l.expectedType);const p={},x=[];for(let V=2;V<i.length-1;V+=2){let E=i[V];const L=i[V+1];Array.isArray(E)||(E=[E]);const B=l.concat(V);if(E.length===0)return B.error("Expected at least one branch label.");for(const F of E){if(typeof F!="number"&&typeof F!="string")return B.error("Branch labels must be numbers or strings.");if(typeof F=="number"&&Math.abs(F)>Number.MAX_SAFE_INTEGER)return B.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof F=="number"&&Math.floor(F)!==F)return B.error("Numeric branch labels must be integer values.");if(h){if(B.checkSubtype(h,to(F)))return null}else h=to(F);if(p[String(F)]!==void 0)return B.error("Branch labels must be unique.");p[String(F)]=x.length}const O=l.parse(L,V,v);if(!O)return null;v=v||O.type,x.push(O)}const M=l.parse(i[1],1,ci);if(!M)return null;const z=l.parse(i[i.length-1],i.length-1,v);return z?M.type.kind!=="value"&&l.concat(1).checkSubtype(h,M.type)?null:new B0(h,v,M,p,x,z):null}evaluate(i){const l=this.input.evaluate(i);return(to(l)===this.inputType&&this.outputs[this.cases[l]]||this.otherwise).evaluate(i)}eachChild(i){i(this.input),this.outputs.forEach(i),i(this.otherwise)}outputDefined(){return this.outputs.every(i=>i.outputDefined())&&this.otherwise.outputDefined()}serialize(){const i=["match",this.input.serialize()],l=Object.keys(this.cases).sort(),h=[],v={};for(const x of l){const M=v[this.cases[x]];M===void 0?(v[this.cases[x]]=h.length,h.push([this.cases[x],[x]])):h[M][1].push(x)}const p=x=>this.inputType.kind==="number"?Number(x):x;for(const[x,M]of h)i.push(M.length===1?p(M[0]):M.map(p)),i.push(this.outputs[x].serialize());return i.push(this.otherwise.serialize()),i}}class Tp{constructor(i,l,h){this.type=i,this.branches=l,this.otherwise=h}static parse(i,l){if(i.length<4)return l.error(`Expected at least 3 arguments, but found only ${i.length-1}.`);if(i.length%2!=0)return l.error("Expected an odd number of arguments.");let h;l.expectedType&&l.expectedType.kind!=="value"&&(h=l.expectedType);const v=[];for(let x=1;x<i.length-1;x+=2){const M=l.parse(i[x],x,ai);if(!M)return null;const z=l.parse(i[x+1],x+1,h);if(!z)return null;v.push([M,z]),h=h||z.type}const p=l.parse(i[i.length-1],i.length-1,h);return p?new Tp(h,v,p):null}evaluate(i){for(const[l,h]of this.branches)if(l.evaluate(i))return h.evaluate(i);return this.otherwise.evaluate(i)}eachChild(i){for(const[l,h]of this.branches)i(l),i(h);i(this.otherwise)}outputDefined(){return this.branches.every(([i,l])=>l.outputDefined())&&this.otherwise.outputDefined()}serialize(){const i=["case"];return this.eachChild(l=>{i.push(l.serialize())}),i}}class qm{constructor(i,l,h,v){this.type=i,this.input=l,this.beginIndex=h,this.endIndex=v}static parse(i,l){if(i.length<=2||i.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);const h=l.parse(i[1],1,ci),v=l.parse(i[2],2,On);if(!h||!v)return null;if(!na(h.type,[ws(ci),xr,ci]))return l.error(`Expected first argument to be of type array or string, but found ${co(h.type)} instead`);if(i.length===4){const p=l.parse(i[3],3,On);return p?new qm(h.type,h,v,p):null}return new qm(h.type,h,v)}evaluate(i){const l=this.input.evaluate(i),h=this.beginIndex.evaluate(i);if(!ra(l,["string","array"]))throw new zo(`Expected first argument to be of type array or string, but found ${co(to(l))} instead.`);if(this.endIndex){const v=this.endIndex.evaluate(i);return l.slice(h,v)}return l.slice(h)}eachChild(i){i(this.input),i(this.beginIndex),this.endIndex&&i(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const i=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),i]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function j0(d,i){return d==="=="||d==="!="?i.kind==="boolean"||i.kind==="string"||i.kind==="number"||i.kind==="null"||i.kind==="value":i.kind==="string"||i.kind==="number"||i.kind==="value"}function A1(d,i,l,h){return h.compare(i,l)===0}function Kh(d,i,l){const h=d!=="=="&&d!=="!=";return class Y6{constructor(p,x,M){this.type=ai,this.lhs=p,this.rhs=x,this.collator=M,this.hasUntypedArgument=p.type.kind==="value"||x.type.kind==="value"}static parse(p,x){if(p.length!==3&&p.length!==4)return x.error("Expected two or three arguments.");const M=p[0];let z=x.parse(p[1],1,ci);if(!z)return null;if(!j0(M,z.type))return x.concat(1).error(`"${M}" comparisons are not supported for type '${co(z.type)}'.`);let V=x.parse(p[2],2,ci);if(!V)return null;if(!j0(M,V.type))return x.concat(2).error(`"${M}" comparisons are not supported for type '${co(V.type)}'.`);if(z.type.kind!==V.type.kind&&z.type.kind!=="value"&&V.type.kind!=="value")return x.error(`Cannot compare types '${co(z.type)}' and '${co(V.type)}'.`);h&&(z.type.kind==="value"&&V.type.kind!=="value"?z=new va(V.type,[z]):z.type.kind!=="value"&&V.type.kind==="value"&&(V=new va(z.type,[V])));let E=null;if(p.length===4){if(z.type.kind!=="string"&&V.type.kind!=="string"&&z.type.kind!=="value"&&V.type.kind!=="value")return x.error("Cannot use collator to compare non-string types.");if(E=x.parse(p[3],3,us),!E)return null}return new Y6(z,V,E)}evaluate(p){const x=this.lhs.evaluate(p),M=this.rhs.evaluate(p);if(h&&this.hasUntypedArgument){const z=to(x),V=to(M);if(z.kind!==V.kind||z.kind!=="string"&&z.kind!=="number")throw new zo(`Expected arguments for "${d}" to be (string, string) or (number, number), but found (${z.kind}, ${V.kind}) instead.`)}if(this.collator&&!h&&this.hasUntypedArgument){const z=to(x),V=to(M);if(z.kind!=="string"||V.kind!=="string")return i(p,x,M)}return this.collator?l(p,x,M,this.collator.evaluate(p)):i(p,x,M)}eachChild(p){p(this.lhs),p(this.rhs),this.collator&&p(this.collator)}outputDefined(){return!0}serialize(){const p=[d];return this.eachChild(x=>{p.push(x.serialize())}),p}}}const tT=Kh("==",function(d,i,l){return i===l},A1),L1=Kh("!=",function(d,i,l){return i!==l},function(d,i,l,h){return!A1(0,i,l,h)}),R1=Kh("<",function(d,i,l){return i<l},function(d,i,l,h){return h.compare(i,l)<0}),Jh=Kh(">",function(d,i,l){return i>l},function(d,i,l,h){return h.compare(i,l)>0}),O1=Kh("<=",function(d,i,l){return i<=l},function(d,i,l,h){return h.compare(i,l)<=0}),D1=Kh(">=",function(d,i,l){return i>=l},function(d,i,l,h){return h.compare(i,l)>=0});class V0{constructor(i,l,h,v,p,x){this.type=xr,this.number=i,this.locale=l,this.currency=h,this.unit=v,this.minFractionDigits=p,this.maxFractionDigits=x}static parse(i,l){if(i.length!==3)return l.error("Expected two arguments.");const h=l.parse(i[1],1,On);if(!h)return null;const v=i[2];if(typeof v!="object"||Array.isArray(v))return l.error("NumberFormat options argument must be an object.");let p=null;if(v.locale&&(p=l.parseObjectValue(v.locale,2,"locale",xr),!p))return null;let x=null;if(v.currency&&(x=l.parseObjectValue(v.currency,2,"currency",xr),!x))return null;let M=null;if(v.unit&&(M=l.parseObjectValue(v.unit,2,"unit",xr),!M))return null;let z=null;if(v["min-fraction-digits"]&&(z=l.parseObjectValue(v["min-fraction-digits"],2,"min-fraction-digits",On),!z))return null;let V=null;return v["max-fraction-digits"]&&(V=l.parseObjectValue(v["max-fraction-digits"],2,"max-fraction-digits",On),!V)?null:new V0(h,p,x,M,z,V)}evaluate(i){return new Intl.NumberFormat(this.locale?this.locale.evaluate(i):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(i):void 0,unit:this.unit?this.unit.evaluate(i):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(i):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(i):void 0}).format(this.number.evaluate(i))}eachChild(i){i(this.number),this.locale&&i(this.locale),this.currency&&i(this.currency),this.unit&&i(this.unit),this.minFractionDigits&&i(this.minFractionDigits),this.maxFractionDigits&&i(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const i={};return this.locale&&(i.locale=this.locale.serialize()),this.currency&&(i.currency=this.currency.serialize()),this.unit&&(i.unit=this.unit.serialize()),this.minFractionDigits&&(i["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(i["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),i]}}class Ip{constructor(i){this.type=On,this.input=i}static parse(i,l){if(i.length!==2)return l.error(`Expected 1 argument, but found ${i.length-1} instead.`);const h=l.parse(i[1],1);return h?h.type.kind!=="array"&&h.type.kind!=="string"&&h.type.kind!=="value"?l.error(`Expected argument of type string or array, but found ${co(h.type)} instead.`):new Ip(h):null}evaluate(i){const l=this.input.evaluate(i);if(typeof l=="string"||Array.isArray(l))return l.length;throw new zo(`Expected value to be of type string or array, but found ${co(to(l))} instead.`)}eachChild(i){i(this.input)}outputDefined(){return!1}serialize(){const i=["length"];return this.eachChild(l=>{i.push(l.serialize())}),i}}function Xm(d){return function(){d=1831565813+(d|=0)|0;let i=Math.imul(d^d>>>15,1|d);return i=i+Math.imul(i^i>>>7,61|i)^i,((i^i>>>14)>>>0)/4294967296}}const Qh={"==":tT,"!=":L1,">":Jh,"<":R1,">=":D1,"<=":O1,array:va,at:F0,boolean:va,case:Tp,coalesce:Gm,collator:Vl,format:_l,image:Nl,in:N0,"index-of":Wm,interpolate:Cl,"interpolate-hcl":Cl,"interpolate-lab":Cl,length:Ip,let:Hm,literal:Zo,match:B0,number:va,"number-format":V0,object:va,slice:qm,step:Fs,string:va,"to-boolean":Ws,"to-color":Ws,"to-number":Ws,"to-string":Ws,var:ti,within:bl,distance:er,config:wr};function z1(d,[i,l,h,v]){i=i.evaluate(d),l=l.evaluate(d),h=h.evaluate(d);const p=v?v.evaluate(d):1,x=Xa(i,l,h,p);if(x)throw new zo(x);return new Tr(i/255*p,l/255*p,h/255*p,p)}function $0(d,[i,l,h,v]){i=i.evaluate(d),l=l.evaluate(d),h=h.evaluate(d);const p=v?v.evaluate(d):1,x=function(V,E,L,B){return typeof V=="number"&&V>=0&&V<=360?typeof E=="number"&&E>=0&&E<=100&&typeof L=="number"&&L>=0&&L<=100?B===void 0||typeof B=="number"&&B>=0&&B<=1?null:`Invalid hsla value [${[V,E,L,B].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof B=="number"?[V,E,L,B]:[V,E,L]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof B=="number"?[V,E,L,B]:[V,E,L]).join(", ")}]: 'h' must be between 0 and 360.`}(i,l,h,p);if(x)throw new zo(x);const M=`hsla(${i}, ${l}%, ${h}%, ${p})`,z=Tr.parse(M);if(!z)throw new zo(`Failed to parse HSLA color: ${M}`);return z}function U0(d,i){return d in i}function G0(d,i){const l=i[d];return l===void 0?null:l}function ih(d){return{type:d}}function F1(d){return{result:"success",value:d}}function md(d){return{result:"error",value:d}}function H0(d,i){return!!d&&!!d.parameters&&d.parameters.indexOf(i)>-1}function Ym(d){return d["property-type"]==="data-driven"}function W0(d){return H0(d.expression,"measure-light")}function N1(d){return H0(d.expression,"zoom")}function q0(d){return!!d.expression&&d.expression.interpolated}function Zm(d){return typeof d=="object"&&d!==null&&!Array.isArray(d)}function B1(d){return d}function j1(d,i){const l=i.type==="color",h=d.stops&&typeof d.stops[0][0]=="object",v=h||!(h||d.property!==void 0),p=d.type||(q0(i)?"exponential":"interval");if(l&&((d=Ri({},d)).stops&&(d.stops=d.stops.map(V=>[V[0],Tr.parse(V[1])])),d.default=Tr.parse(d.default?d.default:i.default)),d.colorSpace&&d.colorSpace!=="rgb"&&!P1[d.colorSpace])throw new Error(`Unknown color space: ${d.colorSpace}`);let x,M,z;if(p==="exponential")x=$1;else if(p==="interval")x=V1;else if(p==="categorical"){x=nT,M=Object.create(null);for(const V of d.stops)M[V[0]]=V[1];z=typeof d.stops[0][0]}else{if(p!=="identity")throw new Error(`Unknown function type "${p}"`);x=rT}if(h){const V={},E=[];for(let O=0;O<d.stops.length;O++){const F=d.stops[O],G=F[0].zoom;V[G]===void 0&&(V[G]={zoom:G,type:d.type,property:d.property,default:d.default,stops:[]},E.push(G)),V[G].stops.push([F[0].value,F[1]])}const L=[];for(const O of E)L.push([V[O].zoom,j1(V[O],i)]);const B={name:"linear"};return{kind:"composite",interpolationType:B,interpolationFactor:Cl.interpolationFactor.bind(void 0,B),zoomStops:L.map(O=>O[0]),evaluate:({zoom:O},F)=>$1({stops:L,base:d.base},i,O).evaluate(O,F)}}if(v){const V=p==="exponential"?{name:"exponential",base:d.base!==void 0?d.base:1}:null;return{kind:"camera",interpolationType:V,interpolationFactor:Cl.interpolationFactor.bind(void 0,V),zoomStops:d.stops.map(E=>E[0]),evaluate:({zoom:E})=>x(d,i,E,M,z)}}return{kind:"source",evaluate(V,E){const L=E&&E.properties?E.properties[d.property]:void 0;return L===void 0?kp(d.default,i.default):x(d,i,L,M,z)}}}function kp(d,i,l){return d!==void 0?d:i!==void 0?i:l!==void 0?l:void 0}function nT(d,i,l,h,v){return kp(typeof l===v?h[l]:void 0,d.default,i.default)}function V1(d,i,l){if(Bl(l)!=="number")return kp(d.default,i.default);const h=d.stops.length;if(h===1||l<=d.stops[0][0])return d.stops[0][1];if(l>=d.stops[h-1][0])return d.stops[h-1][1];const v=da(d.stops.map(p=>p[0]),l);return d.stops[v][1]}function $1(d,i,l){const h=d.base!==void 0?d.base:1;if(Bl(l)!=="number")return kp(d.default,i.default);const v=d.stops.length;if(v===1||l<=d.stops[0][0])return d.stops[0][1];if(l>=d.stops[v-1][0])return d.stops[v-1][1];const p=da(d.stops.map(E=>E[0]),l),x=function(E,L,B,O){const F=O-B,G=E-B;return F===0?0:L===1?G/F:(Math.pow(L,G)-1)/(Math.pow(L,F)-1)}(l,h,d.stops[p][0],d.stops[p+1][0]),M=d.stops[p][1],z=d.stops[p+1][1];let V=kr[i.type]||B1;if(d.colorSpace&&d.colorSpace!=="rgb"){const E=P1[d.colorSpace];V=(L,B)=>E.reverse(E.interpolate(E.forward(L),E.forward(B),x))}return typeof M.evaluate=="function"?{evaluate(...E){const L=M.evaluate.apply(void 0,E),B=z.evaluate.apply(void 0,E);if(L!==void 0&&B!==void 0)return V(L,B,x)}}:V(M,z,x)}function rT(d,i,l){return i.type==="color"?l=Tr.parse(l):i.type==="formatted"?l=Yo.fromString(l.toString()):i.type==="resolvedImage"?l=Hs.fromString(l.toString()):Bl(l)===i.type||i.type==="enum"&&i.values[l]||(l=void 0),kp(l,d.default,i.default)}oa.register(Qh,{error:[{kind:"error"},[xr],(d,[i])=>{throw new zo(i.evaluate(d))}],typeof:[xr,[ci],(d,[i])=>co(to(i.evaluate(d)))],"to-rgba":[ws(On,4),[Gs],(d,[i])=>i.evaluate(d).toRenderColor(null).toArray()],rgb:[Gs,[On,On,On],z1],rgba:[Gs,[On,On,On,On],z1],hsl:[Gs,[On,On,On],$0],hsla:[Gs,[On,On,On,On],$0],has:{type:ai,overloads:[[[xr],(d,[i])=>U0(i.evaluate(d),d.properties())],[[xr,oo],(d,[i,l])=>U0(i.evaluate(d),l.evaluate(d))]]},get:{type:ci,overloads:[[[xr],(d,[i])=>G0(i.evaluate(d),d.properties())],[[xr,oo],(d,[i,l])=>G0(i.evaluate(d),l.evaluate(d))]]},"feature-state":[ci,[xr],(d,[i])=>G0(i.evaluate(d),d.featureState||{})],properties:[oo,[],d=>d.properties()],"geometry-type":[xr,[],d=>d.geometryType()],id:[ci,[],d=>d.id()],zoom:[On,[],d=>d.globals.zoom],pitch:[On,[],d=>d.globals.pitch||0],"distance-from-center":[On,[],d=>d.distanceFromCenter()],"measure-light":[On,[xr],(d,[i])=>d.measureLight(i.evaluate(d))],"heatmap-density":[On,[],d=>d.globals.heatmapDensity||0],"line-progress":[On,[],d=>d.globals.lineProgress||0],"raster-value":[On,[],d=>d.globals.rasterValue||0],"raster-particle-speed":[On,[],d=>d.globals.rasterParticleSpeed||0],"sky-radial-progress":[On,[],d=>d.globals.skyRadialProgress||0],accumulated:[ci,[],d=>d.globals.accumulated===void 0?null:d.globals.accumulated],"+":[On,ih(On),(d,i)=>{let l=0;for(const h of i)l+=h.evaluate(d);return l}],"*":[On,ih(On),(d,i)=>{let l=1;for(const h of i)l*=h.evaluate(d);return l}],"-":{type:On,overloads:[[[On,On],(d,[i,l])=>i.evaluate(d)-l.evaluate(d)],[[On],(d,[i])=>-i.evaluate(d)]]},"/":[On,[On,On],(d,[i,l])=>i.evaluate(d)/l.evaluate(d)],"%":[On,[On,On],(d,[i,l])=>i.evaluate(d)%l.evaluate(d)],ln2:[On,[],()=>Math.LN2],pi:[On,[],()=>Math.PI],e:[On,[],()=>Math.E],"^":[On,[On,On],(d,[i,l])=>Math.pow(i.evaluate(d),l.evaluate(d))],sqrt:[On,[On],(d,[i])=>Math.sqrt(i.evaluate(d))],log10:[On,[On],(d,[i])=>Math.log(i.evaluate(d))/Math.LN10],ln:[On,[On],(d,[i])=>Math.log(i.evaluate(d))],log2:[On,[On],(d,[i])=>Math.log(i.evaluate(d))/Math.LN2],sin:[On,[On],(d,[i])=>Math.sin(i.evaluate(d))],cos:[On,[On],(d,[i])=>Math.cos(i.evaluate(d))],tan:[On,[On],(d,[i])=>Math.tan(i.evaluate(d))],asin:[On,[On],(d,[i])=>Math.asin(i.evaluate(d))],acos:[On,[On],(d,[i])=>Math.acos(i.evaluate(d))],atan:[On,[On],(d,[i])=>Math.atan(i.evaluate(d))],min:[On,ih(On),(d,i)=>Math.min(...i.map(l=>l.evaluate(d)))],max:[On,ih(On),(d,i)=>Math.max(...i.map(l=>l.evaluate(d)))],abs:[On,[On],(d,[i])=>Math.abs(i.evaluate(d))],round:[On,[On],(d,[i])=>{const l=i.evaluate(d);return l<0?-Math.round(-l):Math.round(l)}],floor:[On,[On],(d,[i])=>Math.floor(i.evaluate(d))],ceil:[On,[On],(d,[i])=>Math.ceil(i.evaluate(d))],"filter-==":[ai,[xr,ci],(d,[i,l])=>d.properties()[i.value]===l.value],"filter-id-==":[ai,[ci],(d,[i])=>d.id()===i.value],"filter-type-==":[ai,[xr],(d,[i])=>d.geometryType()===i.value],"filter-<":[ai,[xr,ci],(d,[i,l])=>{const h=d.properties()[i.value],v=l.value;return typeof h==typeof v&&h<v}],"filter-id-<":[ai,[ci],(d,[i])=>{const l=d.id(),h=i.value;return typeof l==typeof h&&l<h}],"filter->":[ai,[xr,ci],(d,[i,l])=>{const h=d.properties()[i.value],v=l.value;return typeof h==typeof v&&h>v}],"filter-id->":[ai,[ci],(d,[i])=>{const l=d.id(),h=i.value;return typeof l==typeof h&&l>h}],"filter-<=":[ai,[xr,ci],(d,[i,l])=>{const h=d.properties()[i.value],v=l.value;return typeof h==typeof v&&h<=v}],"filter-id-<=":[ai,[ci],(d,[i])=>{const l=d.id(),h=i.value;return typeof l==typeof h&&l<=h}],"filter->=":[ai,[xr,ci],(d,[i,l])=>{const h=d.properties()[i.value],v=l.value;return typeof h==typeof v&&h>=v}],"filter-id->=":[ai,[ci],(d,[i])=>{const l=d.id(),h=i.value;return typeof l==typeof h&&l>=h}],"filter-has":[ai,[ci],(d,[i])=>i.value in d.properties()],"filter-has-id":[ai,[],d=>d.id()!==null&&d.id()!==void 0],"filter-type-in":[ai,[ws(xr)],(d,[i])=>i.value.indexOf(d.geometryType())>=0],"filter-id-in":[ai,[ws(ci)],(d,[i])=>i.value.indexOf(d.id())>=0],"filter-in-small":[ai,[xr,ws(ci)],(d,[i,l])=>l.value.indexOf(d.properties()[i.value])>=0],"filter-in-large":[ai,[xr,ws(ci)],(d,[i,l])=>function(h,v,p,x){for(;p<=x;){const M=p+x>>1;if(v[M]===h)return!0;v[M]>h?x=M-1:p=M+1}return!1}(d.properties()[i.value],l.value,0,l.value.length-1)],all:{type:ai,overloads:[[[ai,ai],(d,[i,l])=>i.evaluate(d)&&l.evaluate(d)],[ih(ai),(d,i)=>{for(const l of i)if(!l.evaluate(d))return!1;return!0}]]},any:{type:ai,overloads:[[[ai,ai],(d,[i,l])=>i.evaluate(d)||l.evaluate(d)],[ih(ai),(d,i)=>{for(const l of i)if(l.evaluate(d))return!0;return!1}]]},"!":[ai,[ai],(d,[i])=>!i.evaluate(d)],"is-supported-script":[ai,[xr],(d,[i])=>{const l=d.globals&&d.globals.isSupportedScript;return!l||l(i.evaluate(d))}],upcase:[xr,[xr],(d,[i])=>i.evaluate(d).toUpperCase()],downcase:[xr,[xr],(d,[i])=>i.evaluate(d).toLowerCase()],concat:[xr,ih(ci),(d,i)=>i.map(l=>So(l.evaluate(d))).join("")],"resolved-locale":[xr,[us],(d,[i])=>i.evaluate(d).resolvedLocale()],random:[On,[On,On,ci],(d,i)=>{const[l,h,v]=i.map(x=>x.evaluate(d));if(l>h||l===h)return l;let p;if(typeof v=="string")p=function(x){let M=0;if(x.length===0)return M;for(let z=0;z<x.length;z++)M=(M<<5)-M+x.charCodeAt(z),M|=0;return M}(v);else{if(typeof v!="number")throw new zo(`Invalid seed input: ${v}`);p=v}return l+Xm(p)()*(h-l)}]});class Km{constructor(i,l,h,v){this.expression=i,this._warningHistory={},this._evaluator=new ia(h,v),this._defaultValue=l?function(p){return p.type==="color"&&(Zm(p.default)||Array.isArray(p.default))?new Tr(0,0,0,0):p.type==="color"?Tr.parse(p.default)||null:p.default===void 0?null:p.default}(l):null,this._enumValues=l&&l.type==="enum"?l.values:null}evaluateWithoutErrorHandling(i,l,h,v,p,x,M,z){return this._evaluator.globals=i,this._evaluator.feature=l,this._evaluator.featureState=h,this._evaluator.canonical=v||null,this._evaluator.availableImages=p||null,this._evaluator.formattedSection=x,this._evaluator.featureTileCoord=M||null,this._evaluator.featureDistanceData=z||null,this.expression.evaluate(this._evaluator)}evaluate(i,l,h,v,p,x,M,z){this._evaluator.globals=i,this._evaluator.feature=l||null,this._evaluator.featureState=h||null,this._evaluator.canonical=v||null,this._evaluator.availableImages=p||null,this._evaluator.formattedSection=x||null,this._evaluator.featureTileCoord=M||null,this._evaluator.featureDistanceData=z||null;try{const V=this.expression.evaluate(this._evaluator);if(V==null||typeof V=="number"&&V!=V)return this._defaultValue;if(this._enumValues&&!(V in this._enumValues))throw new zo(`Expected value to be one of ${Object.keys(this._enumValues).map(E=>JSON.stringify(E)).join(", ")}, but found ${JSON.stringify(V)} instead.`);return V}catch(V){return this._warningHistory[V.message]||(this._warningHistory[V.message]=!0,typeof console<"u"&&console.warn(`Failed to evaluate expression "${JSON.stringify(this.expression.serialize())}". ${V.message}`)),this._defaultValue}}}function Jm(d){return Array.isArray(d)&&d.length>0&&typeof d[0]=="string"&&d[0]in Qh}function Mp(d,i,l,h){const v=new xa(Qh,[],i?function(x){const M={color:Gs,string:xr,number:On,enum:xr,boolean:ai,formatted:Fl,resolvedImage:qa};return x.type==="array"?ws(M[x.value]||ci,x.length):M[x.type]}(i):void 0,void 0,void 0,l,h),p=v.parse(d,void 0,void 0,void 0,i&&i.type==="string"?{typeAnnotation:"coerce"}:void 0);return p?F1(new Km(p,i,l,h)):md(v.errors)}class X0{constructor(i,l,h){this.kind=i,this._styleExpression=l,this.isLightConstant=h,this.isStateDependent=i!=="constant"&&!Vi(l.expression),this.configDependencies=Ko(l.expression)}evaluateWithoutErrorHandling(i,l,h,v,p,x){return this._styleExpression.evaluateWithoutErrorHandling(i,l,h,v,p,x)}evaluate(i,l,h,v,p,x){return this._styleExpression.evaluate(i,l,h,v,p,x)}}class $u{constructor(i,l,h,v,p){this.kind=i,this.zoomStops=h,this._styleExpression=l,this.isStateDependent=i!=="camera"&&!Vi(l.expression),this.isLightConstant=p,this.configDependencies=Ko(l.expression),this.interpolationType=v}evaluateWithoutErrorHandling(i,l,h,v,p,x){return this._styleExpression.evaluateWithoutErrorHandling(i,l,h,v,p,x)}evaluate(i,l,h,v,p,x){return this._styleExpression.evaluate(i,l,h,v,p,x)}interpolationFactor(i,l,h){return this.interpolationType?Cl.interpolationFactor(this.interpolationType,i,l,h):0}}function U1(d,i,l,h){if((d=Mp(d,i,l,h)).result==="error")return d;const v=d.value.expression,p=Pi(v);if(!p&&!Ym(i))return md([new Qi("","data expressions not supported")]);const x=so(v,["zoom","pitch","distance-from-center"]);if(!x&&!N1(i))return md([new Qi("","zoom expressions not supported")]);const M=so(v,["measure-light"]);if(!M&&!W0(i))return md([new Qi("","measure-light expression not supported")]);const z=i.expression&&i.expression.relaxZoomRestriction,V=eg(v);return V||x||z?V instanceof Qi?md([V]):V instanceof Cl&&!q0(i)?md([new Qi("",'"interpolate" expressions cannot be used with this property')]):F1(V?new $u(p?"camera":"composite",d.value,V.labels,V instanceof Cl?V.interpolation:void 0,M):new X0(p?"constant":"source",d.value,M)):md([new Qi("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class Qm{constructor(i,l){this._parameters=i,this._specification=l,Ri(this,j1(this._parameters,this._specification))}static deserialize(i){return new Qm(i._parameters,i._specification)}static serialize(i){return{_parameters:i._parameters,_specification:i._specification}}}function eg(d){let i=null;if(d instanceof Hm)i=eg(d.result);else if(d instanceof Gm){for(const l of d.args)if(i=eg(l),i)break}else(d instanceof Fs||d instanceof Cl)&&d.input instanceof oa&&d.input.name==="zoom"&&(i=d);return i instanceof Qi||d.eachChild(l=>{const h=eg(l);h instanceof Qi?i=h:i&&h&&i!==h&&(i=new Qi("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),i}var tg,Y0,G1=function(){if(Y0)return tg;Y0=1,tg=i;var d=3;function i(l,h,v){var p=this.cells=[];if(l instanceof ArrayBuffer){this.arrayBuffer=l;var x=new Int32Array(this.arrayBuffer);l=x[0],this.d=(h=x[1])+2*(v=x[2]);for(var M=0;M<this.d*this.d;M++){var z=x[d+M],V=x[d+M+1];p.push(z===V?null:x.subarray(z,V))}var E=x[d+p.length+1];this.keys=x.subarray(x[d+p.length],E),this.bboxes=x.subarray(E),this.insert=this._insertReadonly}else{this.d=h+2*v;for(var L=0;L<this.d*this.d;L++)p.push([]);this.keys=[],this.bboxes=[]}this.n=h,this.extent=l,this.padding=v,this.scale=h/l,this.uid=0;var B=v/h*l;this.min=-B,this.max=l+B}return i.prototype.insert=function(l,h,v,p,x){this._forEachCell(h,v,p,x,this._insertCell,this.uid++),this.keys.push(l),this.bboxes.push(h),this.bboxes.push(v),this.bboxes.push(p),this.bboxes.push(x)},i.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},i.prototype._insertCell=function(l,h,v,p,x,M){this.cells[x].push(M)},i.prototype.query=function(l,h,v,p,x){var M=this.min,z=this.max;if(l<=M&&h<=M&&z<=v&&z<=p&&!x)return Array.prototype.slice.call(this.keys);var V=[];return this._forEachCell(l,h,v,p,this._queryCell,V,{},x),V},i.prototype._queryCell=function(l,h,v,p,x,M,z,V){var E=this.cells[x];if(E!==null)for(var L=this.keys,B=this.bboxes,O=0;O<E.length;O++){var F=E[O];if(z[F]===void 0){var G=4*F;(V?V(B[G+0],B[G+1],B[G+2],B[G+3]):l<=B[G+2]&&h<=B[G+3]&&v>=B[G+0]&&p>=B[G+1])?(z[F]=!0,M.push(L[F])):z[F]=!1}}},i.prototype._forEachCell=function(l,h,v,p,x,M,z,V){for(var E=this._convertToCellCoord(l),L=this._convertToCellCoord(h),B=this._convertToCellCoord(v),O=this._convertToCellCoord(p),F=E;F<=B;F++)for(var G=L;G<=O;G++){var Q=this.d*G+F;if((!V||V(this._convertFromCellCoord(F),this._convertFromCellCoord(G),this._convertFromCellCoord(F+1),this._convertFromCellCoord(G+1)))&&x.call(this,l,h,v,p,Q,M,z,V))return}},i.prototype._convertFromCellCoord=function(l){return(l-this.padding)/this.scale},i.prototype._convertToCellCoord=function(l){return Math.max(0,Math.min(this.d-1,Math.floor(l*this.scale)+this.padding))},i.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var l=this.cells,h=d+this.cells.length+1+1,v=0,p=0;p<this.cells.length;p++)v+=this.cells[p].length;var x=new Int32Array(h+v+this.keys.length+this.bboxes.length);x[0]=this.extent,x[1]=this.n,x[2]=this.padding;for(var M=h,z=0;z<l.length;z++){var V=l[z];x[d+z]=M,x.set(V,M),M+=V.length}return x[d+l.length]=M,x.set(this.keys,M),x[d+l.length+1]=M+=this.keys.length,x.set(this.bboxes,M),M+=this.bboxes.length,x.buffer},tg}(),oh=C(G1);const ef={};function ir(d,i,l={}){Object.defineProperty(d,"_classRegistryKey",{value:i,writable:!1}),ef[i]={klass:d,omit:l.omit||[]}}ir(Object,"Object"),oh.serialize=function(d,i){const l=d.toArrayBuffer();return i&&i.add(l),{buffer:l}},oh.deserialize=function(d){return new oh(d.buffer)},Object.defineProperty(oh,"name",{value:"Grid"}),ir(oh,"Grid"),ir(Tr,"Color"),ir(Error,"Error"),ir(Yo,"Formatted"),ir(_o,"FormattedSection"),ir(ld,"AJAXError"),ir(Hs,"ResolvedImage"),ir(Qm,"StylePropertyFunction"),ir(Km,"StyleExpression",{omit:["_evaluator"]}),ir($u,"ZoomDependentExpression"),ir(X0,"ZoomConstantExpression"),ir(oa,"CompoundExpression",{omit:["_evaluate"]});for(const d in Qh)ef[Qh[d]._classRegistryKey]||ir(Qh[d],`Expression${d}`);function Z0(d){return d&&typeof ArrayBuffer<"u"&&(d instanceof ArrayBuffer||d.constructor&&d.constructor.name==="ArrayBuffer")}function H1(d){return self.ImageBitmap&&d instanceof ImageBitmap}function tl(d,i){if(d==null||typeof d=="boolean"||typeof d=="number"||typeof d=="string"||d instanceof Boolean||d instanceof Number||d instanceof String||d instanceof Date||d instanceof RegExp)return d;if(Z0(d)||H1(d))return i&&i.add(d),d;if(ArrayBuffer.isView(d)){const l=d;return i&&i.add(l.buffer),l}if(d instanceof ImageData)return i&&i.add(d.data.buffer),d;if(Array.isArray(d)){const l=[];for(const h of d)l.push(tl(h,i));return l}if(d instanceof Map){const l={$name:"Map"};for(const[h,v]of d.entries())l[h]=tl(v);return l}if(d instanceof Set){const l={$name:"Set"};let h=0;for(const v of d.values())l[++h]=tl(v);return l}if(typeof d=="object"){const l=d.constructor,h=l._classRegistryKey;if(!h)throw new Error(`can't serialize object of unregistered class ${h}`);const v=l.serialize?l.serialize(d,i):{};if(!l.serialize){for(const p in d)d.hasOwnProperty(p)&&(ef[h].omit.indexOf(p)>=0||(v[p]=tl(d[p],i)));d instanceof Error&&(v.message=d.message)}if(v.$name)throw new Error("$name property is reserved for worker serialization logic.");return h!=="Object"&&(v.$name=h),v}throw new Error("can't serialize object of type "+typeof d)}function sh(d){if(d==null||typeof d=="boolean"||typeof d=="number"||typeof d=="string"||d instanceof Boolean||d instanceof Number||d instanceof String||d instanceof Date||d instanceof RegExp||Z0(d)||H1(d)||ArrayBuffer.isView(d)||d instanceof ImageData)return d;if(Array.isArray(d))return d.map(sh);if(typeof d=="object"){const i=d.$name||"Object";if(i==="Map"){const v=new Map;for(const p of Object.keys(d))p!=="$name"&&v.set(p,sh(d[p]));return v}if(i==="Set"){const v=new Set;for(const p of Object.keys(d))p!=="$name"&&v.add(sh(d[p]));return v}const{klass:l}=ef[i];if(!l)throw new Error(`can't deserialize unregistered class ${i}`);if(l.deserialize)return l.deserialize(d);const h=Object.create(l.prototype);for(const v of Object.keys(d))v!=="$name"&&(h[v]=sh(d[v]));return h}throw new Error("can't deserialize object of type "+typeof d)}const mr={"Latin-1 Supplement":d=>d>=128&&d<=255,Arabic:d=>d>=1536&&d<=1791,"Arabic Supplement":d=>d>=1872&&d<=1919,"Arabic Extended-A":d=>d>=2208&&d<=2303,"Hangul Jamo":d=>d>=4352&&d<=4607,"Unified Canadian Aboriginal Syllabics":d=>d>=5120&&d<=5759,Khmer:d=>d>=6016&&d<=6143,"Unified Canadian Aboriginal Syllabics Extended":d=>d>=6320&&d<=6399,"General Punctuation":d=>d>=8192&&d<=8303,"Letterlike Symbols":d=>d>=8448&&d<=8527,"Number Forms":d=>d>=8528&&d<=8591,"Miscellaneous Technical":d=>d>=8960&&d<=9215,"Control Pictures":d=>d>=9216&&d<=9279,"Optical Character Recognition":d=>d>=9280&&d<=9311,"Enclosed Alphanumerics":d=>d>=9312&&d<=9471,"Geometric Shapes":d=>d>=9632&&d<=9727,"Miscellaneous Symbols":d=>d>=9728&&d<=9983,"Miscellaneous Symbols and Arrows":d=>d>=11008&&d<=11263,"CJK Radicals Supplement":d=>d>=11904&&d<=12031,"Kangxi Radicals":d=>d>=12032&&d<=12255,"Ideographic Description Characters":d=>d>=12272&&d<=12287,"CJK Symbols and Punctuation":d=>d>=12288&&d<=12351,Hiragana:d=>d>=12352&&d<=12447,Katakana:d=>d>=12448&&d<=12543,Bopomofo:d=>d>=12544&&d<=12591,"Hangul Compatibility Jamo":d=>d>=12592&&d<=12687,Kanbun:d=>d>=12688&&d<=12703,"Bopomofo Extended":d=>d>=12704&&d<=12735,"CJK Strokes":d=>d>=12736&&d<=12783,"Katakana Phonetic Extensions":d=>d>=12784&&d<=12799,"Enclosed CJK Letters and Months":d=>d>=12800&&d<=13055,"CJK Compatibility":d=>d>=13056&&d<=13311,"CJK Unified Ideographs Extension A":d=>d>=13312&&d<=19903,"Yijing Hexagram Symbols":d=>d>=19904&&d<=19967,"CJK Unified Ideographs":d=>d>=19968&&d<=40959,"Yi Syllables":d=>d>=40960&&d<=42127,"Yi Radicals":d=>d>=42128&&d<=42191,"Hangul Jamo Extended-A":d=>d>=43360&&d<=43391,"Hangul Syllables":d=>d>=44032&&d<=55215,"Hangul Jamo Extended-B":d=>d>=55216&&d<=55295,"Private Use Area":d=>d>=57344&&d<=63743,"CJK Compatibility Ideographs":d=>d>=63744&&d<=64255,"Arabic Presentation Forms-A":d=>d>=64336&&d<=65023,"Vertical Forms":d=>d>=65040&&d<=65055,"CJK Compatibility Forms":d=>d>=65072&&d<=65103,"Small Form Variants":d=>d>=65104&&d<=65135,"Arabic Presentation Forms-B":d=>d>=65136&&d<=65279,"Halfwidth and Fullwidth Forms":d=>d>=65280&&d<=65519,"CJK Unified Ideographs Extension B":d=>d>=131072&&d<=173791};function ng(d){for(const i of d)if(ig(i.charCodeAt(0)))return!0;return!1}function iT(d){for(const i of d)if(!rg(i.charCodeAt(0)))return!1;return!0}function rg(d){return!(mr.Arabic(d)||mr["Arabic Supplement"](d)||mr["Arabic Extended-A"](d)||mr["Arabic Presentation Forms-A"](d)||mr["Arabic Presentation Forms-B"](d))}function ig(d){return!(d!==746&&d!==747&&(d<4352||!(mr["Bopomofo Extended"](d)||mr.Bopomofo(d)||mr["CJK Compatibility Forms"](d)&&!(d>=65097&&d<=65103)||mr["CJK Compatibility Ideographs"](d)||mr["CJK Compatibility"](d)||mr["CJK Radicals Supplement"](d)||mr["CJK Strokes"](d)||!(!mr["CJK Symbols and Punctuation"](d)||d>=12296&&d<=12305||d>=12308&&d<=12319||d===12336)||mr["CJK Unified Ideographs Extension A"](d)||mr["CJK Unified Ideographs"](d)||mr["Enclosed CJK Letters and Months"](d)||mr["Hangul Compatibility Jamo"](d)||mr["Hangul Jamo Extended-A"](d)||mr["Hangul Jamo Extended-B"](d)||mr["Hangul Jamo"](d)||mr["Hangul Syllables"](d)||mr.Hiragana(d)||mr["Ideographic Description Characters"](d)||mr.Kanbun(d)||mr["Kangxi Radicals"](d)||mr["Katakana Phonetic Extensions"](d)||mr.Katakana(d)&&d!==12540||!(!mr["Halfwidth and Fullwidth Forms"](d)||d===65288||d===65289||d===65293||d>=65306&&d<=65310||d===65339||d===65341||d===65343||d>=65371&&d<=65503||d===65507||d>=65512&&d<=65519)||!(!mr["Small Form Variants"](d)||d>=65112&&d<=65118||d>=65123&&d<=65126)||mr["Unified Canadian Aboriginal Syllabics"](d)||mr["Unified Canadian Aboriginal Syllabics Extended"](d)||mr["Vertical Forms"](d)||mr["Yijing Hexagram Symbols"](d)||mr["Yi Syllables"](d)||mr["Yi Radicals"](d))))}function Pp(d){return!(ig(d)||function(i){return!!(mr["Latin-1 Supplement"](i)&&(i===167||i===169||i===174||i===177||i===188||i===189||i===190||i===215||i===247)||mr["General Punctuation"](i)&&(i===8214||i===8224||i===8225||i===8240||i===8241||i===8251||i===8252||i===8258||i===8263||i===8264||i===8265||i===8273)||mr["Letterlike Symbols"](i)||mr["Number Forms"](i)||mr["Miscellaneous Technical"](i)&&(i>=8960&&i<=8967||i>=8972&&i<=8991||i>=8996&&i<=9e3||i===9003||i>=9085&&i<=9114||i>=9150&&i<=9165||i===9167||i>=9169&&i<=9179||i>=9186&&i<=9215)||mr["Control Pictures"](i)&&i!==9251||mr["Optical Character Recognition"](i)||mr["Enclosed Alphanumerics"](i)||mr["Geometric Shapes"](i)||mr["Miscellaneous Symbols"](i)&&!(i>=9754&&i<=9759)||mr["Miscellaneous Symbols and Arrows"](i)&&(i>=11026&&i<=11055||i>=11088&&i<=11097||i>=11192&&i<=11243)||mr["CJK Symbols and Punctuation"](i)||mr.Katakana(i)||mr["Private Use Area"](i)||mr["CJK Compatibility Forms"](i)||mr["Small Form Variants"](i)||mr["Halfwidth and Fullwidth Forms"](i)||i===8734||i===8756||i===8757||i>=9984&&i<=10087||i>=10102&&i<=10131||i===65532||i===65533)}(d))}function K0(d){return d>=1424&&d<=2303||mr["Arabic Presentation Forms-A"](d)||mr["Arabic Presentation Forms-B"](d)}function oT(d,i){return!(!i&&K0(d)||d>=2304&&d<=3583||d>=3840&&d<=4255||mr.Khmer(d))}function sT(d){for(const i of d)if(K0(i.charCodeAt(0)))return!0;return!1}const Ap="deferred",Lp="loading",og="loaded";let tf=null,Ys="unavailable",gd=null;const W1=function(d){d&&typeof d=="string"&&d.indexOf("NetworkError")>-1&&(Ys="error"),tf&&tf(d)};function J0(){Q0.fire(new Ut("pluginStateChange",{pluginStatus:Ys,pluginURL:gd}))}const Q0=new Yn,e_=function(){return Ys},t_=function(){if(Ys!==Ap||!gd)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Ys=Lp,J0(),gd&&lu({url:gd},d=>{d?W1(d):(Ys=og,J0())})},nl={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Ys===og||nl.applyArabicShaping!=null,isLoading:()=>Ys===Lp,setState(d){Ys=d.pluginStatus,gd=d.pluginURL},isParsed:()=>nl.applyArabicShaping!=null&&nl.processBidirectionalText!=null&&nl.processStyledBidirectionalText!=null,getPluginURL:()=>gd};class Fo{constructor(i,l){this.zoom=i,l?(this.now=l.now,this.fadeDuration=l.fadeDuration,this.transition=l.transition,this.pitch=l.pitch,this.brightness=l.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(i){return function(l,h){for(const v of l)if(!oT(v.charCodeAt(0),h))return!1;return!0}(i,nl.isLoaded())}}class sg{constructor(i,l,h,v){this.property=i,this.value=l,this.expression=function(p,x,M,z){if(Zm(p))return new Qm(p,x);if(Jm(p)||Array.isArray(p)&&p.length>0){const V=U1(p,x,M,z);if(V.result==="error")throw new Error(V.value.map(E=>`${E.key}: ${E.message}`).join(", "));return V.value}{let V=p;return typeof p=="string"&&x.type==="color"&&(V=Tr.parse(p)),{kind:"constant",configDependencies:new Set,evaluate:()=>V}}}(l===void 0?i.specification.default:l,i.specification,h,v)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(i,l,h){return this.property.possiblyEvaluate(this,i,l,h)}}class n_{constructor(i,l,h){this.property=i,this.value=new sg(i,void 0,l,h)}transitioned(i,l){return new X1(this.property,this.value,l,lr({},i.transition,this.transition),i.now)}untransitioned(){return new X1(this.property,this.value,null,{},0)}}class q1{constructor(i,l,h){this._properties=i,this._values=Object.create(i.defaultTransitionablePropertyValues),this._scope=l,this._options=h,this.configDependencies=new Set}getValue(i){return fi(this._values[i].value.value)}setValue(i,l){this._values.hasOwnProperty(i)||(this._values[i]=new n_(this._values[i].property,this._scope,this._options)),this._values[i].value=new sg(this._values[i].property,l===null?void 0:fi(l),this._scope,this._options),this._values[i].value.expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[i].value.expression.configDependencies]))}setTransitionOrValue(i,l){l&&(this._options=l);const h=this._properties.properties;if(i)for(const v in i){const p=i[v];if(Wn(v,"-transition")){const x=v.slice(0,-11);h[x]&&this.setTransition(x,p)}else h.hasOwnProperty(v)&&this.setValue(v,p)}}getTransition(i){return fi(this._values[i].transition)}setTransition(i,l){this._values.hasOwnProperty(i)||(this._values[i]=new n_(this._values[i].property)),this._values[i].transition=fi(l)||void 0}serialize(){const i={};for(const l of Object.keys(this._values)){const h=this.getValue(l);h!==void 0&&(i[l]=h);const v=this.getTransition(l);v!==void 0&&(i[`${l}-transition`]=v)}return i}transitioned(i,l){const h=new Y1(this._properties);for(const v of Object.keys(this._values))h._values[v]=this._values[v].transitioned(i,l._values[v]);return h}untransitioned(){const i=new Y1(this._properties);for(const l of Object.keys(this._values))i._values[l]=this._values[l].untransitioned();return i}}class X1{constructor(i,l,h,v,p){const x=v.delay||0,M=v.duration||0;p=p||0,this.property=i,this.value=l,this.begin=p+x,this.end=this.begin+M,i.specification.transition&&(v.delay||v.duration)&&(this.prior=h)}possiblyEvaluate(i,l,h){const v=i.now||0,p=this.value.possiblyEvaluate(i,l,h),x=this.prior;if(x){if(v>this.end)return this.prior=null,p;if(this.value.isDataDriven())return this.prior=null,p;if(v<this.begin)return x.possiblyEvaluate(i,l,h);{const M=(v-this.begin)/(this.end-this.begin);return this.property.interpolate(x.possiblyEvaluate(i,l,h),p,qt(M))}}return p}}class Y1{constructor(i){this._properties=i,this._values=Object.create(i.defaultTransitioningPropertyValues)}possiblyEvaluate(i,l,h){const v=new rf(this._properties);for(const p of Object.keys(this._values))v._values[p]=this._values[p].possiblyEvaluate(i,l,h);return v}hasTransition(){for(const i of Object.keys(this._values))if(this._values[i].prior)return!0;return!1}}class aT{constructor(i,l,h){this._properties=i,this._values=Object.create(i.defaultPropertyValues),this._scope=l,this._options=h,this.configDependencies=new Set}getValue(i){return fi(this._values[i].value)}setValue(i,l){this._values[i]=new sg(this._values[i].property,l===null?void 0:fi(l),this._scope,this._options),this._values[i].expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[i].expression.configDependencies]))}serialize(){const i={};for(const l of Object.keys(this._values)){const h=this.getValue(l);h!==void 0&&(i[l]=h)}return i}possiblyEvaluate(i,l,h){const v=new rf(this._properties);for(const p of Object.keys(this._values))v._values[p]=this._values[p].possiblyEvaluate(i,l,h);return v}}class nf{constructor(i,l,h){this.property=i,this.value=l,this.parameters=h}isConstant(){return this.value.kind==="constant"}constantOr(i){return this.value.kind==="constant"?this.value.value:i}evaluate(i,l,h,v){return this.property.evaluate(this.value,this.parameters,i,l,h,v)}}class rf{constructor(i){this._properties=i,this._values=Object.create(i.defaultPossiblyEvaluatedValues)}get(i){return this._values[i]}}class zn{constructor(i){this.specification=i}possiblyEvaluate(i,l){return i.expression.evaluate(l)}interpolate(i,l,h){const v=kr[this.specification.type];return v?v(i,l,h):i}}class gr{constructor(i,l){this.specification=i,this.overrides=l}possiblyEvaluate(i,l,h,v){return new nf(this,i.expression.kind==="constant"||i.expression.kind==="camera"?{kind:"constant",value:i.expression.evaluate(l,null,{},h,v)}:i.expression,l)}interpolate(i,l,h){if(i.value.kind!=="constant"||l.value.kind!=="constant")return i;if(i.value.value===void 0||l.value.value===void 0)return new nf(this,{kind:"constant",value:void 0},i.parameters);const v=kr[this.specification.type];return v?new nf(this,{kind:"constant",value:v(i.value.value,l.value.value,h)},i.parameters):i}evaluate(i,l,h,v,p,x){return i.kind==="constant"?i.value:i.evaluate(l,h,v,p,x)}}class fu{constructor(i){this.specification=i}possiblyEvaluate(i,l,h,v){return!!i.expression.evaluate(l,null,{},h,v)}interpolate(){return!1}}class vo{constructor(i){this.properties=i,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const l=new Fo(0,{});for(const h in i){const v=i[h];v.specification.overridable&&this.overridableProperties.push(h);const p=this.defaultPropertyValues[h]=new sg(v,void 0),x=this.defaultTransitionablePropertyValues[h]=new n_(v);this.defaultTransitioningPropertyValues[h]=x.untransitioned(),this.defaultPossiblyEvaluatedValues[h]=p.possiblyEvaluate(l)}}}ir(gr,"DataDrivenProperty"),ir(zn,"DataConstantProperty"),ir(fu,"ColorRampProperty");var $t=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"imports":{"type":"array","value":"import"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"},"featuresets":{"experimental":true,"type":"featuresets"}},"featuresets":{"experimental":true,"*":{"type":"featureset"}},"featureset":{"experimental":true,"selectors":{"type":"array","value":"selector"}},"selector":{"experimental":true,"layer":{"type":"string","required":true},"properties":{"type":"selectorProperty","required":false},"featureNamespace":{"type":"string","required":false}},"selectorProperty":{"experimental":true,"*":{"type":"*"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","property-type":"data-constant","expression":{},"required":true},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"property-type":"data-constant"},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"experimental":true,"type":{"required":true,"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":1}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":1}},"url":{"required":false,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"raster-particle":{"experimental":true},"hillshade":{},"model":{"experimental":true},"background":{},"sky":{},"slot":{},"clip":{"experimental":true}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{},"property-type":"data-constant","experimental":true},"clip-layer-scope":{"type":"array","value":"string","default":[],"expression":{},"property-type":"data-constant","experimental":true}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","experimental":true,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"colorTheme":{"data":{"type":"string","property-type":"data-constant","expression":{}}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"fill-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","experimental":true,"default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","experimental":true,"default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"experimental":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"fill-extrusion-line-width":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"property-type":"constant"},"line-trim-fade-range":{"type":"array","value":"number","experimental":true,"length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-trim-color":{"type":"color","experimental":true,"default":"transparent","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"property-type":"data-constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"symbol-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1},"default":"ground","experimental":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"raster-array-band":{"type":"string","required":false,"experimental":true,"property-type":"data-constant"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-particle-count":{"type":"number","default":512,"minimum":1,"property-type":"data-constant"},"raster-particle-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-particle-speed"]},"property-type":"color-ramp"},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1,"property-type":"data-constant"},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1,"property-type":"data-constant"},"raster-particle-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_background":{"background-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":[]},"property-type":"data-constant"},"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"model-front-cutoff":{"type":"array","private":true,"value":"number","property-type":"data-constant","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function Rp(d){return d instanceof Number||d instanceof String||d instanceof Boolean?d.valueOf():d}function ag(d){if(Array.isArray(d))return d.map(ag);if(d instanceof Object&&!(d instanceof Number||d instanceof String||d instanceof Boolean)){const i={};for(const l in d)i[l]=ag(d[l]);return i}return Rp(d)}function r_(d){if(d===!0||d===!1)return!0;if(!Array.isArray(d)||d.length===0)return!1;switch(d[0]){case"has":return d.length>=2&&d[1]!=="$id"&&d[1]!=="$type";case"in":return d.length>=3&&(typeof d[1]!="string"||Array.isArray(d[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return d.length!==3||Array.isArray(d[1])||Array.isArray(d[2]);case"any":case"all":for(const i of d.slice(1))if(!r_(i)&&typeof i!="boolean")return!1;return!0;default:return!0}}function pu(d,i="",l=null,h="fill"){if(d==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};r_(d)||(d=lg(d));const v=d;let p=!0;try{p=function(L){if(!of(L))return L;let B=ag(L);return ah(B),B=i_(B),B}(v)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(v,null,2)}
        `)}const x=$t[`filter_${h}`],M=Mp(p,x,i,l);let z=null;if(M.result==="error")throw new Error(M.value.map(L=>`${L.key}: ${L.message}`).join(", "));z=(L,B,O)=>M.value.evaluate(L,B,{},O);let V=null,E=null;if(p!==v){const L=Mp(v,x,i,l);if(L.result==="error")throw new Error(L.value.map(B=>`${B.key}: ${B.message}`).join(", "));V=(B,O,F,G,Q)=>L.value.evaluate(B,O,{},F,void 0,void 0,G,Q),E=!Pi(L.value.expression)}return{filter:z,dynamicFilter:V||void 0,needGeometry:Z1(p),needFeature:!!E}}function i_(d){if(!Array.isArray(d))return d;const i=function(l){if(lT.has(l[0])){for(let h=1;h<l.length;h++)if(of(l[h]))return!0}return l}(d);return i===!0?i:i.map(l=>i_(l))}function ah(d){let i=!1;const l=[];if(d[0]==="case"){for(let h=1;h<d.length-1;h+=2)i=i||of(d[h]),l.push(d[h+1]);l.push(d[d.length-1])}else if(d[0]==="match"){i=i||of(d[1]);for(let h=2;h<d.length-1;h+=2)l.push(d[h+1]);l.push(d[d.length-1])}else if(d[0]==="step"){i=i||of(d[1]);for(let h=1;h<d.length-1;h+=2)l.push(d[h+1])}i&&(d.length=0,d.push("any",...l));for(let h=1;h<d.length;h++)ah(d[h])}function of(d){if(!Array.isArray(d))return!1;if((i=d[0])==="pitch"||i==="distance-from-center")return!0;var i;for(let l=1;l<d.length;l++)if(of(d[l]))return!0;return!1}const lT=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function uT(d,i){return d<i?-1:d>i?1:0}function Z1(d){if(!Array.isArray(d))return!1;if(d[0]==="within"||d[0]==="distance")return!0;for(let i=1;i<d.length;i++)if(Z1(d[i]))return!0;return!1}function lg(d){if(!d)return!0;const i=d[0];return d.length<=1?i!=="any":i==="=="?ug(d[1],d[2],"=="):i==="!="?Dp(ug(d[1],d[2],"==")):i==="<"||i===">"||i==="<="||i===">="?ug(d[1],d[2],i):i==="any"?(l=d.slice(1),["any"].concat(l.map(lg))):i==="all"?["all"].concat(d.slice(1).map(lg)):i==="none"?["all"].concat(d.slice(1).map(lg).map(Dp)):i==="in"?cg(d[1],d.slice(2)):i==="!in"?Dp(cg(d[1],d.slice(2))):i==="has"?Op(d[1]):i!=="!has"||Dp(Op(d[1]));var l}function ug(d,i,l){switch(d){case"$type":return[`filter-type-${l}`,i];case"$id":return[`filter-id-${l}`,i];default:return[`filter-${l}`,d,i]}}function cg(d,i){if(i.length===0)return!1;switch(d){case"$type":return["filter-type-in",["literal",i]];case"$id":return["filter-id-in",["literal",i]];default:return i.length>200&&!i.some(l=>typeof l!=typeof i[0])?["filter-in-large",d,["literal",i.sort(uT)]]:["filter-in-small",d,["literal",i]]}}function Op(d){switch(d){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",d]}}function Dp(d){return["!",d]}const sf="";function K1(d,i){return i?`${d}${sf}${i}`:d}const mu="-transition",cT=new Set(["fill","line","background","hillshade","raster"]);class ba extends Yn{constructor(i,l,h,v,p){if(super(),this.id=i.id,this.fqid=K1(this.id,h),this.type=i.type,this.scope=h,this.lut=v,this.options=p,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.configDependencies=new Set,i.type!=="custom"&&(this.metadata=i.metadata,this.minzoom=i.minzoom,this.maxzoom=i.maxzoom,i.type!=="background"&&i.type!=="sky"&&i.type!=="slot"&&(this.source=i.source,this.sourceLayer=i["source-layer"],this.filter=i.filter),i.slot&&(this.slot=i.slot),l.layout&&(this._unevaluatedLayout=new aT(l.layout,this.scope,p),this.configDependencies=new Set([...this.configDependencies,...this._unevaluatedLayout.configDependencies])),l.paint)){this._transitionablePaint=new q1(l.paint,this.scope,p);for(const x in i.paint)this.setPaintProperty(x,i.paint[x]);for(const x in i.layout)this.setLayoutProperty(x,i.layout[x]);this.configDependencies=new Set([...this.configDependencies,...this._transitionablePaint.configDependencies]),this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new rf(l.paint)}}onAdd(i){}onRemove(i){}isDraped(i){return!this.is3D()&&cT.has(this.type)}getLayoutProperty(i){return i==="visibility"?this.visibility:this._unevaluatedLayout.getValue(i)}setLayoutProperty(i,l){if(this.type==="custom"&&i==="visibility")return void(this.visibility=l);const h=this._unevaluatedLayout;h._properties.properties[i]&&(h.setValue(i,l),this.configDependencies=new Set([...this.configDependencies,...h.configDependencies]),i==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0})}getPaintProperty(i){return Wn(i,mu)?this._transitionablePaint.getTransition(i.slice(0,-11)):this._transitionablePaint.getValue(i)}setPaintProperty(i,l){const h=this._transitionablePaint,v=h._properties.properties;if(Wn(i,mu)){const L=i.slice(0,-11);return v[L]&&h.setTransition(L,l||void 0),!1}if(!v[i])return!1;const p=h._values[i],x=p.value.isDataDriven(),M=p.value;h.setValue(i,l),this.configDependencies=new Set([...this.configDependencies,...h.configDependencies]),this._handleSpecialPaintPropertyUpdate(i);const z=h._values[i].value,V=z.isDataDriven(),E=Wn(i,"pattern")||i==="line-dasharray";return V||x||E||this._handleOverridablePaintPropertyUpdate(i,M,z)}_handleSpecialPaintPropertyUpdate(i){}getProgramIds(){return null}getDefaultProgramParams(i,l,h){return null}_handleOverridablePaintPropertyUpdate(i,l,h){return!1}isHidden(i){return!!(this.minzoom&&i<this.minzoom)||!!(this.maxzoom&&i>=this.maxzoom)||this.visibility==="none"}updateTransitions(i){this._transitioningPaint=this._transitionablePaint.transitioned(i,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(i,l){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(i,void 0,l)),this.paint=this._transitioningPaint.possiblyEvaluate(i,void 0,l)}serialize(){return Ar({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(i,l)=>!(i===void 0||l==="layout"&&!Object.keys(i).length||l==="paint"&&!Object.keys(i).length))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}isStateDependent(){for(const i in this.paint._values){const l=this.paint.get(i);if(l instanceof nf&&Ym(l.property.specification)&&(l.value.kind==="source"||l.value.kind==="composite")&&l.value.isStateDependent)return!0}return!1}compileFilter(i){this._filterCompiled||(this._featureFilter=pu(this.filter,this.scope,i),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(i){this._stats&&(i.renderPass==="shadow"?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}queryRadius(i){}queryIntersectsFeature(i,l,h,v,p,x,M,z,V){}queryIntersectsMatchingFeature(i,l,h,v){}}const dT={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class zp{constructor(i,l){this._structArray=i,this._pos1=l*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class fo{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(i,l){return i._trim(),l&&(i.isTransferred=!0,l.add(i.arrayBuffer)),{length:i.length,arrayBuffer:i.arrayBuffer}}static deserialize(i){const l=Object.create(this.prototype);return l.arrayBuffer=i.arrayBuffer,l.length=i.length,l.capacity=i.arrayBuffer.byteLength/l.bytesPerElement,l._refreshViews(),l}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(i){this.reserve(i),this.length=i}reserve(i){if(i>this.capacity){this.capacity=Math.max(i,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const l=this.uint8;this._refreshViews(),l&&this.uint8.set(l)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...i){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...i){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function wi(d,i=1){let l=0,h=0;return{members:d.map(v=>{const p=dT[v.type].BYTES_PER_ELEMENT,x=l=J1(l,Math.max(i,p)),M=v.components||1;return h=Math.max(h,p),l+=p*M,{name:v.name,type:v.type,components:M,offset:x}}),size:J1(l,Math.max(h,i)),alignment:i}}function J1(d,i){return Math.ceil(d/i)*i}class yd extends fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,l){const h=this.length;return this.resize(h+1),this.emplace(h,i,l)}emplace(i,l,h){const v=2*i;return this.int16[v+0]=l,this.int16[v+1]=h,i}}yd.prototype.bytesPerElement=4,ir(yd,"StructArrayLayout2i4");class dg extends fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,l,h){const v=this.length;return this.resize(v+1),this.emplace(v,i,l,h)}emplace(i,l,h,v){const p=3*i;return this.int16[p+0]=l,this.int16[p+1]=h,this.int16[p+2]=v,i}}dg.prototype.bytesPerElement=6,ir(dg,"StructArrayLayout3i6");class _d extends fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,l,h,v){const p=this.length;return this.resize(p+1),this.emplace(p,i,l,h,v)}emplace(i,l,h,v,p){const x=4*i;return this.int16[x+0]=l,this.int16[x+1]=h,this.int16[x+2]=v,this.int16[x+3]=p,i}}_d.prototype.bytesPerElement=8,ir(_d,"StructArrayLayout4i8");class hg extends fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,l,h,v,p){const x=this.length;return this.resize(x+1),this.emplace(x,i,l,h,v,p)}emplace(i,l,h,v,p,x){const M=5*i;return this.int16[M+0]=l,this.int16[M+1]=h,this.int16[M+2]=v,this.int16[M+3]=p,this.int16[M+4]=x,i}}hg.prototype.bytesPerElement=10,ir(hg,"StructArrayLayout5i10");class o_ extends fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,h,v,p,x,M){const z=this.length;return this.resize(z+1),this.emplace(z,i,l,h,v,p,x,M)}emplace(i,l,h,v,p,x,M,z){const V=6*i,E=12*i,L=3*i;return this.int16[V+0]=l,this.int16[V+1]=h,this.uint8[E+4]=v,this.uint8[E+5]=p,this.uint8[E+6]=x,this.uint8[E+7]=M,this.float32[L+2]=z,i}}o_.prototype.bytesPerElement=12,ir(o_,"StructArrayLayout2i4ub1f12");class Mc extends fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,h,v){const p=this.length;return this.resize(p+1),this.emplace(p,i,l,h,v)}emplace(i,l,h,v,p){const x=4*i;return this.float32[x+0]=l,this.float32[x+1]=h,this.float32[x+2]=v,this.float32[x+3]=p,i}}Mc.prototype.bytesPerElement=16,ir(Mc,"StructArrayLayout4f16");class vd extends fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,h){const v=this.length;return this.resize(v+1),this.emplace(v,i,l,h)}emplace(i,l,h,v){const p=3*i;return this.float32[p+0]=l,this.float32[p+1]=h,this.float32[p+2]=v,i}}vd.prototype.bytesPerElement=12,ir(vd,"StructArrayLayout3f12");class Pc extends fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,h,v,p){const x=this.length;return this.resize(x+1),this.emplace(x,i,l,h,v,p)}emplace(i,l,h,v,p,x){const M=6*i,z=3*i;return this.uint16[M+0]=l,this.uint16[M+1]=h,this.uint16[M+2]=v,this.uint16[M+3]=p,this.float32[z+2]=x,i}}Pc.prototype.bytesPerElement=12,ir(Pc,"StructArrayLayout4ui1f12");class lh extends fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,l,h,v){const p=this.length;return this.resize(p+1),this.emplace(p,i,l,h,v)}emplace(i,l,h,v,p){const x=4*i;return this.uint16[x+0]=l,this.uint16[x+1]=h,this.uint16[x+2]=v,this.uint16[x+3]=p,i}}lh.prototype.bytesPerElement=8,ir(lh,"StructArrayLayout4ui8");class fg extends fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,l,h,v,p,x){const M=this.length;return this.resize(M+1),this.emplace(M,i,l,h,v,p,x)}emplace(i,l,h,v,p,x,M){const z=6*i;return this.int16[z+0]=l,this.int16[z+1]=h,this.int16[z+2]=v,this.int16[z+3]=p,this.int16[z+4]=x,this.int16[z+5]=M,i}}fg.prototype.bytesPerElement=12,ir(fg,"StructArrayLayout6i12");class s_ extends fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,l,h,v,p,x,M,z,V,E,L,B){const O=this.length;return this.resize(O+1),this.emplace(O,i,l,h,v,p,x,M,z,V,E,L,B)}emplace(i,l,h,v,p,x,M,z,V,E,L,B,O){const F=12*i;return this.int16[F+0]=l,this.int16[F+1]=h,this.int16[F+2]=v,this.int16[F+3]=p,this.uint16[F+4]=x,this.uint16[F+5]=M,this.uint16[F+6]=z,this.uint16[F+7]=V,this.int16[F+8]=E,this.int16[F+9]=L,this.int16[F+10]=B,this.int16[F+11]=O,i}}s_.prototype.bytesPerElement=24,ir(s_,"StructArrayLayout4i4ui4i24");class a_ extends fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,h,v,p,x){const M=this.length;return this.resize(M+1),this.emplace(M,i,l,h,v,p,x)}emplace(i,l,h,v,p,x,M){const z=10*i,V=5*i;return this.int16[z+0]=l,this.int16[z+1]=h,this.int16[z+2]=v,this.float32[V+2]=p,this.float32[V+3]=x,this.float32[V+4]=M,i}}a_.prototype.bytesPerElement=20,ir(a_,"StructArrayLayout3i3f20");class l_ extends fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i){const l=this.length;return this.resize(l+1),this.emplace(l,i)}emplace(i,l){return this.uint32[1*i+0]=l,i}}l_.prototype.bytesPerElement=4,ir(l_,"StructArrayLayout1ul4");class xd extends fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,l){const h=this.length;return this.resize(h+1),this.emplace(h,i,l)}emplace(i,l,h){const v=2*i;return this.uint16[v+0]=l,this.uint16[v+1]=h,i}}xd.prototype.bytesPerElement=4,ir(xd,"StructArrayLayout2ui4");class af extends fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,l,h,v,p,x,M,z,V,E,L,B,O){const F=this.length;return this.resize(F+1),this.emplace(F,i,l,h,v,p,x,M,z,V,E,L,B,O)}emplace(i,l,h,v,p,x,M,z,V,E,L,B,O,F){const G=20*i,Q=10*i;return this.int16[G+0]=l,this.int16[G+1]=h,this.int16[G+2]=v,this.int16[G+3]=p,this.int16[G+4]=x,this.float32[Q+3]=M,this.float32[Q+4]=z,this.float32[Q+5]=V,this.float32[Q+6]=E,this.int16[G+14]=L,this.uint32[Q+8]=B,this.uint16[G+18]=O,this.uint16[G+19]=F,i}}af.prototype.bytesPerElement=40,ir(af,"StructArrayLayout5i4f1i1ul2ui40");class uh extends fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,l,h,v,p,x,M){const z=this.length;return this.resize(z+1),this.emplace(z,i,l,h,v,p,x,M)}emplace(i,l,h,v,p,x,M,z){const V=8*i;return this.int16[V+0]=l,this.int16[V+1]=h,this.int16[V+2]=v,this.int16[V+4]=p,this.int16[V+5]=x,this.int16[V+6]=M,this.int16[V+7]=z,i}}uh.prototype.bytesPerElement=16,ir(uh,"StructArrayLayout3i2i2i16");class Ra extends fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,l,h,v,p){const x=this.length;return this.resize(x+1),this.emplace(x,i,l,h,v,p)}emplace(i,l,h,v,p,x){const M=4*i,z=8*i;return this.float32[M+0]=l,this.float32[M+1]=h,this.float32[M+2]=v,this.int16[z+6]=p,this.int16[z+7]=x,i}}Ra.prototype.bytesPerElement=16,ir(Ra,"StructArrayLayout2f1f2i16");class lf extends fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,h,v,p,x){const M=this.length;return this.resize(M+1),this.emplace(M,i,l,h,v,p,x)}emplace(i,l,h,v,p,x,M){const z=20*i,V=5*i;return this.uint8[z+0]=l,this.uint8[z+1]=h,this.float32[V+1]=v,this.float32[V+2]=p,this.float32[V+3]=x,this.float32[V+4]=M,i}}lf.prototype.bytesPerElement=20,ir(lf,"StructArrayLayout2ub4f20");class sa extends fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,l,h){const v=this.length;return this.resize(v+1),this.emplace(v,i,l,h)}emplace(i,l,h,v){const p=3*i;return this.uint16[p+0]=l,this.uint16[p+1]=h,this.uint16[p+2]=v,i}}sa.prototype.bytesPerElement=6,ir(sa,"StructArrayLayout3ui6");class u_ extends fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i,l,h,v,p,x,M,z,V,E,L,B,O,F,G,Q,ie,pe,ge,ae,be){const Te=this.length;return this.resize(Te+1),this.emplace(Te,i,l,h,v,p,x,M,z,V,E,L,B,O,F,G,Q,ie,pe,ge,ae,be)}emplace(i,l,h,v,p,x,M,z,V,E,L,B,O,F,G,Q,ie,pe,ge,ae,be,Te){const Be=30*i,Xe=15*i,Ze=60*i;return this.int16[Be+0]=l,this.int16[Be+1]=h,this.int16[Be+2]=v,this.float32[Xe+2]=p,this.float32[Xe+3]=x,this.uint16[Be+8]=M,this.uint16[Be+9]=z,this.uint32[Xe+5]=V,this.uint32[Xe+6]=E,this.uint32[Xe+7]=L,this.uint16[Be+16]=B,this.uint16[Be+17]=O,this.uint16[Be+18]=F,this.float32[Xe+10]=G,this.float32[Xe+11]=Q,this.uint8[Ze+48]=ie,this.uint8[Ze+49]=pe,this.uint8[Ze+50]=ge,this.uint32[Xe+13]=ae,this.int16[Be+28]=be,this.uint8[Ze+58]=Te,i}}u_.prototype.bytesPerElement=60,ir(u_,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class c_ extends fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i,l,h,v,p,x,M,z,V,E,L,B,O,F,G,Q,ie,pe,ge,ae,be,Te,Be,Xe,Ze,He,ct,Qe,pt,St,Tt,It){const Lt=this.length;return this.resize(Lt+1),this.emplace(Lt,i,l,h,v,p,x,M,z,V,E,L,B,O,F,G,Q,ie,pe,ge,ae,be,Te,Be,Xe,Ze,He,ct,Qe,pt,St,Tt,It)}emplace(i,l,h,v,p,x,M,z,V,E,L,B,O,F,G,Q,ie,pe,ge,ae,be,Te,Be,Xe,Ze,He,ct,Qe,pt,St,Tt,It,Lt){const Yt=20*i,Rt=40*i,ln=80*i;return this.float32[Yt+0]=l,this.float32[Yt+1]=h,this.int16[Rt+4]=v,this.int16[Rt+5]=p,this.int16[Rt+6]=x,this.int16[Rt+7]=M,this.int16[Rt+8]=z,this.int16[Rt+9]=V,this.int16[Rt+10]=E,this.int16[Rt+11]=L,this.int16[Rt+12]=B,this.uint16[Rt+13]=O,this.uint16[Rt+14]=F,this.uint16[Rt+15]=G,this.uint16[Rt+16]=Q,this.uint16[Rt+17]=ie,this.uint16[Rt+18]=pe,this.uint16[Rt+19]=ge,this.uint16[Rt+20]=ae,this.uint16[Rt+21]=be,this.uint16[Rt+22]=Te,this.uint16[Rt+23]=Be,this.uint16[Rt+24]=Xe,this.uint16[Rt+25]=Ze,this.uint16[Rt+26]=He,this.uint16[Rt+27]=ct,this.uint32[Yt+14]=Qe,this.float32[Yt+15]=pt,this.float32[Yt+16]=St,this.float32[Yt+17]=Tt,this.float32[Yt+18]=It,this.uint8[ln+76]=Lt,i}}c_.prototype.bytesPerElement=80,ir(c_,"StructArrayLayout2f9i15ui1ul4f1ub80");class uf extends fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i){const l=this.length;return this.resize(l+1),this.emplace(l,i)}emplace(i,l){return this.float32[1*i+0]=l,i}}uf.prototype.bytesPerElement=4,ir(uf,"StructArrayLayout1f4");class Ac extends fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,h,v,p){const x=this.length;return this.resize(x+1),this.emplace(x,i,l,h,v,p)}emplace(i,l,h,v,p,x){const M=5*i;return this.float32[M+0]=l,this.float32[M+1]=h,this.float32[M+2]=v,this.float32[M+3]=p,this.float32[M+4]=x,i}}Ac.prototype.bytesPerElement=20,ir(Ac,"StructArrayLayout5f20");class d_ extends fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,h,v,p,x,M){const z=this.length;return this.resize(z+1),this.emplace(z,i,l,h,v,p,x,M)}emplace(i,l,h,v,p,x,M,z){const V=7*i;return this.float32[V+0]=l,this.float32[V+1]=h,this.float32[V+2]=v,this.float32[V+3]=p,this.float32[V+4]=x,this.float32[V+5]=M,this.float32[V+6]=z,i}}d_.prototype.bytesPerElement=28,ir(d_,"StructArrayLayout7f28");class Fp extends fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,l,h,v){const p=this.length;return this.resize(p+1),this.emplace(p,i,l,h,v)}emplace(i,l,h,v,p){const x=6*i;return this.uint32[3*i+0]=l,this.uint16[x+2]=h,this.uint16[x+3]=v,this.uint16[x+4]=p,i}}Fp.prototype.bytesPerElement=12,ir(Fp,"StructArrayLayout1ul3ui12");class h_ extends fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i){const l=this.length;return this.resize(l+1),this.emplace(l,i)}emplace(i,l){return this.uint16[1*i+0]=l,i}}h_.prototype.bytesPerElement=2,ir(h_,"StructArrayLayout1ui2");class Np extends fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l){const h=this.length;return this.resize(h+1),this.emplace(h,i,l)}emplace(i,l,h){const v=2*i;return this.float32[v+0]=l,this.float32[v+1]=h,i}}Np.prototype.bytesPerElement=8,ir(Np,"StructArrayLayout2f8");class Bp extends fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,h,v,p,x,M,z,V,E,L,B,O,F,G,Q){const ie=this.length;return this.resize(ie+1),this.emplace(ie,i,l,h,v,p,x,M,z,V,E,L,B,O,F,G,Q)}emplace(i,l,h,v,p,x,M,z,V,E,L,B,O,F,G,Q,ie){const pe=16*i;return this.float32[pe+0]=l,this.float32[pe+1]=h,this.float32[pe+2]=v,this.float32[pe+3]=p,this.float32[pe+4]=x,this.float32[pe+5]=M,this.float32[pe+6]=z,this.float32[pe+7]=V,this.float32[pe+8]=E,this.float32[pe+9]=L,this.float32[pe+10]=B,this.float32[pe+11]=O,this.float32[pe+12]=F,this.float32[pe+13]=G,this.float32[pe+14]=Q,this.float32[pe+15]=ie,i}}Bp.prototype.bytesPerElement=64,ir(Bp,"StructArrayLayout16f64");class pg extends fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,h,v,p,x,M){const z=this.length;return this.resize(z+1),this.emplace(z,i,l,h,v,p,x,M)}emplace(i,l,h,v,p,x,M,z){const V=10*i,E=5*i;return this.uint16[V+0]=l,this.uint16[V+1]=h,this.uint16[V+2]=v,this.uint16[V+3]=p,this.float32[E+2]=x,this.float32[E+3]=M,this.float32[E+4]=z,i}}pg.prototype.bytesPerElement=20,ir(pg,"StructArrayLayout4ui3f20");class mg extends fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i){const l=this.length;return this.resize(l+1),this.emplace(l,i)}emplace(i,l){return this.int16[1*i+0]=l,i}}mg.prototype.bytesPerElement=2,ir(mg,"StructArrayLayout1i2");class gg extends fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(i){const l=this.length;return this.resize(l+1),this.emplace(l,i)}emplace(i,l){return this.uint8[1*i+0]=l,i}}gg.prototype.bytesPerElement=1,ir(gg,"StructArrayLayout1ub1");class Q1 extends zp{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Q1.prototype.size=40;class yg extends af{get(i){return new Q1(this,i)}}ir(yg,"CollisionBoxArray");class jp extends zp{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(i){this._structArray.uint8[this._pos1+49]=i}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(i){this._structArray.uint8[this._pos1+50]=i}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(i){this._structArray.uint32[this._pos4+13]=i}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(i){this._structArray.uint8[this._pos1+58]=i}}jp.prototype.size=60;class f_ extends u_{get(i){return new jp(this,i)}}ir(f_,"PlacedSymbolArray");class eb extends zp{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(i){this._structArray.uint32[this._pos4+14]=i}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(i){this._structArray.float32[this._pos4+18]=i}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}}eb.prototype.size=80;class p_ extends c_{get(i){return new eb(this,i)}}ir(p_,"SymbolInstanceArray");class tb extends uf{getoffsetX(i){return this.float32[1*i+0]}}ir(tb,"GlyphOffsetArray");class _g extends yd{getx(i){return this.int16[2*i+0]}gety(i){return this.int16[2*i+1]}}ir(_g,"SymbolLineVertexArray");class nb extends zp{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}nb.prototype.size=12;class rb extends Fp{get(i){return new nb(this,i)}}ir(rb,"FeatureIndexArray");class ib extends xd{geta_centroid_pos0(i){return this.uint16[2*i+0]}geta_centroid_pos1(i){return this.uint16[2*i+1]}}ir(ib,"FillExtrusionCentroidArray");class ob extends zp{get a_join_normal_inside0(){return this._structArray.int16[this._pos2+0]}get a_join_normal_inside1(){return this._structArray.int16[this._pos2+1]}get a_join_normal_inside2(){return this._structArray.int16[this._pos2+2]}}ob.prototype.size=6;class m_ extends dg{get(i){return new ob(this,i)}}ir(m_,"FillExtrusionWallArray");const hT=wi([{name:"a_pos",components:2,type:"Int16"}],4),fT=wi([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class No{constructor(i=[]){this.segments=i}_prepareSegment(i,l,h,v){let p=this.segments[this.segments.length-1];return i>No.MAX_VERTEX_ARRAY_LENGTH&&vr(`Max vertices per segment is ${No.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${i}`),(!p||p.vertexLength+i>No.MAX_VERTEX_ARRAY_LENGTH||p.sortKey!==v)&&(p={vertexOffset:l,primitiveOffset:h,vertexLength:0,primitiveLength:0},v!==void 0&&(p.sortKey=v),this.segments.push(p)),p}prepareSegment(i,l,h,v){return this._prepareSegment(i,l.length,h.length,v)}get(){return this.segments}destroy(){for(const i of this.segments)for(const l in i.vaos)i.vaos[l].destroy()}static simpleSegment(i,l,h,v){return new No([{vertexOffset:i,primitiveOffset:l,vertexLength:h,primitiveLength:v,vaos:{},sortKey:0}])}}function sb(d,i){return 256*(d=Wt(Math.floor(d),0,255))+Wt(Math.floor(i),0,255)}No.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,ir(No,"SegmentVector");const pT=wi([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),mT=wi([{name:"a_dash",components:4,type:"Uint16"}]);class Vp{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(i,l,h,v){this.ids.push(ab(i)),this.positions.push(l,h,v)}eachPosition(i,l){const h=ab(i);let v=0,p=this.ids.length-1;for(;v<p;){const x=v+p>>1;this.ids[x]>=h?p=x:v=x+1}for(;this.ids[v]===h;)l(this.positions[3*v],this.positions[3*v+1],this.positions[3*v+2]),v++}static serialize(i,l){const h=new Float64Array(i.ids),v=new Uint32Array(i.positions);return cf(h,v,0,h.length-1),l&&(l.add(h.buffer),l.add(v.buffer)),{ids:h,positions:v}}static deserialize(i){const l=new Vp;let h;l.ids=i.ids,l.positions=i.positions;for(const v of l.ids)v!==h&&l.uniqueIds.push(v),h=v;return l.indexed=!0,l}}function ab(d){const i=+d;return!isNaN(i)&&Number.MIN_SAFE_INTEGER<=i&&i<=Number.MAX_SAFE_INTEGER?i:jt(String(d))}function cf(d,i,l,h){for(;l<h;){const v=d[l+h>>1];let p=l-1,x=h+1;for(;;){do p++;while(d[p]<v);do x--;while(d[x]>v);if(p>=x)break;vg(d,p,x),vg(i,3*p,3*x),vg(i,3*p+1,3*x+1),vg(i,3*p+2,3*x+2)}x-l<h-x?(cf(d,i,l,x),l=x+1):(cf(d,i,x+1,h),h=x)}}function vg(d,i,l){const h=d[i];d[i]=d[l],d[l]=h}ir(Vp,"FeaturePositionMap");class Lc{constructor(i){this.gl=i.gl,this.initialized=!1}fetchUniformLocation(i,l){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(i,l),this.initialized=!0),!!this.location}set(i,l,h){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class ch extends Lc{constructor(i){super(i),this.current=0}set(i,l,h){this.fetchUniformLocation(i,l)&&this.current!==h&&(this.current=h,this.gl.uniform1i(this.location,h))}}class wa extends Lc{constructor(i){super(i),this.current=0}set(i,l,h){this.fetchUniformLocation(i,l)&&this.current!==h&&(this.current=h,this.gl.uniform1f(this.location,h))}}class Uu extends Lc{constructor(i){super(i),this.current=[0,0]}set(i,l,h){this.fetchUniformLocation(i,l)&&(h[0]===this.current[0]&&h[1]===this.current[1]||(this.current=h,this.gl.uniform2f(this.location,h[0],h[1])))}}class g_ extends Lc{constructor(i){super(i),this.current=[0,0,0]}set(i,l,h){this.fetchUniformLocation(i,l)&&(h[0]===this.current[0]&&h[1]===this.current[1]&&h[2]===this.current[2]||(this.current=h,this.gl.uniform3f(this.location,h[0],h[1],h[2])))}}class xg extends Lc{constructor(i){super(i),this.current=[0,0,0,0]}set(i,l,h){this.fetchUniformLocation(i,l)&&(h[0]===this.current[0]&&h[1]===this.current[1]&&h[2]===this.current[2]&&h[3]===this.current[3]||(this.current=h,this.gl.uniform4f(this.location,h[0],h[1],h[2],h[3])))}}class y_ extends Lc{constructor(i){super(i),this.current=Tr.transparent.toRenderColor(null)}set(i,l,h){this.fetchUniformLocation(i,l)&&(h.r===this.current.r&&h.g===this.current.g&&h.b===this.current.b&&h.a===this.current.a||(this.current=h,this.gl.uniform4f(this.location,h.r,h.g,h.b,h.a)))}}const lb=new Float32Array(16);class $p extends Lc{constructor(i){super(i),this.current=lb}set(i,l,h){if(this.fetchUniformLocation(i,l)){if(h[12]!==this.current[12]||h[0]!==this.current[0])return this.current=h,void this.gl.uniformMatrix4fv(this.location,!1,h);for(let v=1;v<16;v++)if(h[v]!==this.current[v]){this.current=h,this.gl.uniformMatrix4fv(this.location,!1,h);break}}}}const gT=new Float32Array(9),yT=new Float32Array(4);class __ extends Lc{constructor(i){super(i),this.current=yT}set(i,l,h){if(this.fetchUniformLocation(i,l)){for(let v=0;v<4;v++)if(h[v]!==this.current[v]){this.current=h,this.gl.uniformMatrix2fv(this.location,!1,h);break}}}}function v_(d){return[sb(255*d.r,255*d.g),sb(255*d.b,255*d.a)]}class Up{constructor(i,l,h,v){this.value=i,this.uniformNames=l.map(p=>`u_${p}`),this.type=h,this.context=v}setUniform(i,l,h,v,p){const x=v.constantOr(this.value);l.set(i,p,x instanceof Tr?x.toRenderColor(this.context.lut):x)}getBinding(i,l){return this.type==="color"?new y_(i):new wa(i)}}class df{constructor(i,l){this.uniformNames=l.map(h=>`u_${h}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(i){this.pixelRatio=i.pixelRatio||1,this.pattern=i.tl.concat(i.br)}setUniform(i,l,h,v,p){const x=p==="u_pattern"||p==="u_dash"?this.pattern:p==="u_pixel_ratio"?this.pixelRatio:null;x&&l.set(i,p,x)}getBinding(i,l){return l==="u_pattern"||l==="u_dash"?new xg(i):new wa(i)}}class Gu{constructor(i,l,h,v){this.expression=i,this.type=h,this.maxValue=0,this.paintVertexAttributes=l.map(p=>({name:`a_${p}`,type:"Float32",components:h==="color"?2:1,offset:0})),this.paintVertexArray=new v}populatePaintArray(i,l,h,v,p,x,M){const z=this.paintVertexArray.length,V=this.expression.evaluate(new Fo(0,{brightness:x}),l,{},p,v,M);this.paintVertexArray.resize(i),this._setPaintValue(z,i,V,this.context)}updatePaintArray(i,l,h,v,p,x,M){const z=this.expression.evaluate({zoom:0,brightness:M},h,v,void 0,p);this._setPaintValue(i,l,z,this.context)}_setPaintValue(i,l,h,v){if(this.type==="color"){const p=v_(h.toRenderColor(v.lut));for(let x=i;x<l;x++)this.paintVertexArray.emplace(x,p[0],p[1])}else{for(let p=i;p<l;p++)this.paintVertexArray.emplace(p,h);this.maxValue=Math.max(this.maxValue,Math.abs(h))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class El{constructor(i,l,h,v,p,x){this.expression=i,this.uniformNames=l.map(M=>`u_${M}_t`),this.type=h,this.useIntegerZoom=v,this.context=p,this.maxValue=0,this.paintVertexAttributes=l.map(M=>({name:`a_${M}`,type:"Float32",components:h==="color"?4:2,offset:0})),this.paintVertexArray=new x}populatePaintArray(i,l,h,v,p,x,M){const z=this.expression.evaluate(new Fo(this.context.zoom,{brightness:x}),l,{},p,v,M),V=this.expression.evaluate(new Fo(this.context.zoom+1,{brightness:x}),l,{},p,v,M),E=this.paintVertexArray.length;this.paintVertexArray.resize(i),this._setPaintValue(E,i,z,V,this.context)}updatePaintArray(i,l,h,v,p,x,M){const z=this.expression.evaluate({zoom:this.context.zoom,brightness:M},h,v,void 0,p),V=this.expression.evaluate({zoom:this.context.zoom+1,brightness:M},h,v,void 0,p);this._setPaintValue(i,l,z,V,this.context)}_setPaintValue(i,l,h,v,p){if(this.type==="color"){const x=v_(h.toRenderColor(p.lut)),M=v_(h.toRenderColor(p.lut));for(let z=i;z<l;z++)this.paintVertexArray.emplace(z,x[0],x[1],M[0],M[1])}else{for(let x=i;x<l;x++)this.paintVertexArray.emplace(x,h,v);this.maxValue=Math.max(this.maxValue,Math.abs(h),Math.abs(v))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(i,l,h,v,p){const x=this.useIntegerZoom?Math.floor(h.zoom):h.zoom,M=Wt(this.expression.interpolationFactor(x,this.context.zoom,this.context.zoom+1),0,1);l.set(i,p,M)}getBinding(i,l){return new wa(i)}}class Hu{constructor(i,l,h,v,p){this.expression=i,this.layerId=p,this.paintVertexAttributes=(h==="array"?mT:pT).members;for(let x=0;x<l.length;++x);this.paintVertexArray=new v}populatePaintArray(i,l,h,v){const p=this.paintVertexArray.length;this.paintVertexArray.resize(i),this._setPaintValues(p,i,l.patterns&&l.patterns[this.layerId],h)}updatePaintArray(i,l,h,v,p,x,M){this._setPaintValues(i,l,h.patterns&&h.patterns[this.layerId],x)}_setPaintValues(i,l,h,v){if(!v||!h)return;const p=v[h];if(!p)return;const{tl:x,br:M,pixelRatio:z}=p;for(let V=i;V<l;V++)this.paintVertexArray.emplace(V,x[0],x[1],M[0],M[1],z)}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class dh{constructor(i,l,h=()=>!0){this.binders={},this._buffers=[],this.context=l;const v=[];for(const p in i.paint._values){const x=i.paint.get(p);if(!h(p)||!(x instanceof nf&&Ym(x.property.specification)))continue;const M=vT(p,i.type),z=x.value,V=x.property.specification.type,E=!!x.property.useIntegerZoom,L=p==="line-dasharray"||p.endsWith("pattern"),B=p==="line-dasharray"&&i.layout.get("line-cap").value.kind!=="constant";if(z.kind!=="constant"||B)if(z.kind==="source"||B||L){const O=g(p,V,"source");this.binders[p]=L?new Hu(z,M,V,O,i.id):new Gu(z,M,V,O),v.push(`/a_${p}`)}else{const O=g(p,V,"composite");this.binders[p]=new El(z,M,V,E,l,O),v.push(`/z_${p}`)}else this.binders[p]=L?new df(z.value,M):new Up(z.value,M,V,l),v.push(`/u_${p}`)}this.cacheKey=v.sort().join("")}getMaxValue(i){const l=this.binders[i];return l instanceof Gu||l instanceof El?l.maxValue:0}populatePaintArrays(i,l,h,v,p,x,M){for(const z in this.binders){const V=this.binders[z];V.context=this.context,(V instanceof Gu||V instanceof El||V instanceof Hu)&&V.populatePaintArray(i,l,h,v,p,x,M)}}setConstantPatternPositions(i){for(const l in this.binders){const h=this.binders[l];h instanceof df&&h.setConstantPatternPositions(i)}}updatePaintArrays(i,l,h,v,p,x,M,z){let V=!1;const E=Object.keys(i),L=E.length!==0,B=L?E:l.uniqueIds;this.context.lut=p.lut;for(const O in this.binders){const F=this.binders[O];if(F.context=this.context,(F instanceof Gu||F instanceof El||F instanceof Hu)&&(F.expression.isStateDependent===!0||F.expression.isLightConstant===!1)){const G=p.paint.get(O);F.expression=G.value;for(const Q of B){const ie=i[Q.toString()];l.eachPosition(Q,(pe,ge,ae)=>{const be=v.feature(pe);F.updatePaintArray(ge,ae,be,ie,x,M,z)})}if(!L)for(const Q of h.uniqueIds){const ie=i[Q.toString()];h.eachPosition(Q,(pe,ge,ae)=>{const be=v.feature(pe);F.updatePaintArray(ge,ae,be,ie,x,M,z)})}V=!0}}return V}defines(){const i=[];for(const l in this.binders){const h=this.binders[l];(h instanceof Up||h instanceof df)&&i.push(...h.uniformNames.map(v=>`#define HAS_UNIFORM_${v}`))}return i}getBinderAttributes(){const i=[];for(const l in this.binders){const h=this.binders[l];if(h instanceof Gu||h instanceof El||h instanceof Hu)for(let v=0;v<h.paintVertexAttributes.length;v++)i.push(h.paintVertexAttributes[v].name)}return i}getBinderUniforms(){const i=[];for(const l in this.binders){const h=this.binders[l];if(h instanceof Up||h instanceof df||h instanceof El)for(const v of h.uniformNames)i.push(v)}return i}getPaintVertexBuffers(){return this._buffers}getUniforms(i){const l=[];for(const h in this.binders){const v=this.binders[h];if(v instanceof Up||v instanceof df||v instanceof El)for(const p of v.uniformNames)l.push({name:p,property:h,binding:v.getBinding(i,p)})}return l}setUniforms(i,l,h,v,p){for(const{name:x,property:M,binding:z}of h)this.binders[M].setUniform(i,z,p,v.get(M),x)}updatePaintBuffers(){this._buffers=[];for(const i in this.binders){const l=this.binders[i];(l instanceof Gu||l instanceof El||l instanceof Hu)&&l.paintVertexBuffer&&this._buffers.push(l.paintVertexBuffer)}}upload(i){for(const l in this.binders){const h=this.binders[l];(h instanceof Gu||h instanceof El||h instanceof Hu)&&h.upload(i)}this.updatePaintBuffers()}destroy(){for(const i in this.binders){const l=this.binders[i];(l instanceof Gu||l instanceof El||l instanceof Hu)&&l.destroy()}}}class bd{constructor(i,l,h=()=>!0){this.programConfigurations={};for(const v of i)this.programConfigurations[v.id]=new dh(v,l,h);this.needsUpload=!1,this._featureMap=new Vp,this._featureMapWithoutIds=new Vp,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(i,l,h,v,p,x,M,z){for(const V in this.programConfigurations)this.programConfigurations[V].populatePaintArrays(i,l,v,p,x,M,z);l.id!==void 0?this._featureMap.add(l.id,h,this._bufferOffset,i):(this._featureMapWithoutIds.add(this._idlessCounter,h,this._bufferOffset,i),this._idlessCounter+=1),this._bufferOffset=i,this.needsUpload=!0}updatePaintArrays(i,l,h,v,p,x){for(const M of h)this.needsUpload=this.programConfigurations[M.id].updatePaintArrays(i,this._featureMap,this._featureMapWithoutIds,l,M,v,p,x||0)||this.needsUpload}get(i){return this.programConfigurations[i]}upload(i){if(this.needsUpload){for(const l in this.programConfigurations)this.programConfigurations[l].upload(i);this.needsUpload=!1}}destroy(){for(const i in this.programConfigurations)this.programConfigurations[i].destroy()}}const _T={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"symbol-z-offset":["z_offset"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function vT(d,i){return _T[d]||[d.replace(`${i}-`,"").replace(/-/g,"_")]}const xT={"line-pattern":{source:Pc,composite:Pc},"fill-pattern":{source:Pc,composite:Pc},"fill-extrusion-pattern":{source:Pc,composite:Pc},"line-dasharray":{source:lh,composite:lh}},ub={color:{source:Np,composite:Mc},number:{source:uf,composite:Np}};function g(d,i,l){const h=xT[d];return h&&h[l]||ub[i][l]}ir(Up,"ConstantBinder"),ir(df,"PatternConstantBinder"),ir(Gu,"SourceExpressionBinder"),ir(Hu,"PatternCompositeBinder"),ir(El,"CompositeExpressionBinder"),ir(dh,"ProgramConfiguration",{omit:["_buffers"]}),ir(bd,"ProgramConfigurationSet");const o=Nn/Math.PI/2,c=5,y=6,S=16383,T=64,A=[T,32,16],$=-o,Y=o;function ee(d,i,l,h=o){return l=nt(l),[d*Math.sin(l)*h,-i*h,d*Math.cos(l)*h]}function te(d,i,l){return ee(Math.cos(nt(d)),Math.sin(nt(d)),i,l)}const ue=63710088e-1,fe=2*Math.PI*ue;class me{constructor(i,l){if(isNaN(i)||isNaN(l))throw new Error(`Invalid LngLat object: (${i}, ${l})`);if(this.lng=+i,this.lat=+l,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new me(ar(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(i){const l=Math.PI/180,h=this.lat*l,v=i.lat*l,p=Math.sin(h)*Math.sin(v)+Math.cos(h)*Math.cos(v)*Math.cos((i.lng-this.lng)*l);return ue*Math.acos(Math.min(p,1))}toBounds(i=0){const l=360*i/40075017,h=l/Math.cos(Math.PI/180*this.lat);return new ke({lng:this.lng-h,lat:this.lat-l},{lng:this.lng+h,lat:this.lat+l})}toEcef(i){return te(this.lat,this.lng,o+i*o/ue)}static convert(i){if(i instanceof me)return i;if(Array.isArray(i)&&(i.length===2||i.length===3))return new me(Number(i[0]),Number(i[1]));if(!Array.isArray(i)&&typeof i=="object"&&i!==null)return new me(Number("lng"in i?i.lng:i.lon),Number(i.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class ke{constructor(i,l){if(i)if(l)this.setSouthWest(i).setNorthEast(l);else if(i.length===4){const h=i;this.setSouthWest([h[0],h[1]]).setNorthEast([h[2],h[3]])}else{const h=i;this.setSouthWest(h[0]).setNorthEast(h[1])}}setNorthEast(i){return this._ne=i instanceof me?new me(i.lng,i.lat):me.convert(i),this}setSouthWest(i){return this._sw=i instanceof me?new me(i.lng,i.lat):me.convert(i),this}extend(i){const l=this._sw,h=this._ne;let v,p;if(i instanceof me)v=i,p=i;else{if(!(i instanceof ke))return Array.isArray(i)?i.length===4||i.every(Array.isArray)?this.extend(ke.convert(i)):this.extend(me.convert(i)):typeof i=="object"&&i!==null&&i.hasOwnProperty("lat")&&(i.hasOwnProperty("lon")||i.hasOwnProperty("lng"))?this.extend(me.convert(i)):this;if(v=i._sw,p=i._ne,!v||!p)return this}return l||h?(l.lng=Math.min(v.lng,l.lng),l.lat=Math.min(v.lat,l.lat),h.lng=Math.max(p.lng,h.lng),h.lat=Math.max(p.lat,h.lat)):(this._sw=new me(v.lng,v.lat),this._ne=new me(p.lng,p.lat)),this}getCenter(){return new me((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new me(this.getWest(),this.getNorth())}getSouthEast(){return new me(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(i){const{lng:l,lat:h}=me.convert(i);let v=this._sw.lng<=l&&l<=this._ne.lng;return this._sw.lng>this._ne.lng&&(v=this._sw.lng>=l&&l>=this._ne.lng),this._sw.lat<=h&&h<=this._ne.lat&&v}static convert(i){if(i)return i instanceof ke?i:new ke(i)}}const Le=0,De=25.5;function Fe(d){return fe*Math.cos(d*Math.PI/180)}function Ye(d){return(180+d)/360}function Je(d){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+d*Math.PI/360)))/360}function qe(d,i){return d/Fe(i)}function it(d){return 360*d-180}function rt(d){return 360/Math.PI*Math.atan(Math.exp((180-360*d)*Math.PI/180))-90}function mt(d,i){return d*Fe(rt(i))}const dt=85.051129;function yt(d){return Math.cos(nt(Wt(d,-dt,dt)))}function Et(d,i){const l=Wt(i,Le,De),h=Math.pow(2,l);return yt(d)*fe/(512*h)}function bt(d){return 1/Math.cos(d*Math.PI/180)}function vt(d,i=0){const l=Math.exp(Math.PI*(1-(d.y+i/Nn)/(1<<d.z)*2));return 80150034*l/(l*l+1)/Nn/(1<<d.z)}class Ot{constructor(i,l,h=0){this.x=+i,this.y=+l,this.z=+h}static fromLngLat(i,l=0){const h=me.convert(i);return new Ot(Ye(h.lng),Je(h.lat),qe(l,h.lat))}toLngLat(){return new me(it(this.x),rt(this.y))}toAltitude(){return mt(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/fe*bt(rt(this.y))}}function sn(d,i,l,h,v,p,x,M,z){const V=(i+h)/2,E=(l+v)/2,L=new st(V,E);M(L),function(B,O,F,G,Q,ie){const pe=F-Q,ge=G-ie;return Math.abs((G-O)*pe-(F-B)*ge)/Math.hypot(pe,ge)}(L.x,L.y,p.x,p.y,x.x,x.y)>=z?(sn(d,i,l,V,E,p,L,M,z),sn(d,V,E,h,v,L,x,M,z)):d.push(x)}function mn(d,i,l){let h=d[0],v=h.x,p=h.y;i(h);const x=[h];for(let M=1;M<d.length;M++){const z=d[M],{x:V,y:E}=z;i(z),sn(x,v,p,V,E,h,z,i,l),v=V,p=E,h=z}return x}function on(d,i,l,h){if(h(i,l)){const v=i.add(l)._mult(.5);on(d,i,v,h),on(d,v,l,h)}else d.push(l)}function Tn(d,i){let l=d[0];const h=[l];for(let v=1;v<d.length;v++){const p=d[v];on(h,l,p,i),l=p}return h}const Dt=Math.pow(2,14)-1,dn=-Dt-1;function cn(d,i){const l=Math.round(d.x*i),h=Math.round(d.y*i);return d.x=Wt(l,dn,Dt),d.y=Wt(h,dn,Dt),(l<d.x||l>d.x+1||h<d.y||h>d.y+1)&&vr("Geometry exceeds allowed extent, reduce your vector tile buffer size"),d}function In(d,i,l){const h=d.loadGeometry(),v=d.extent,p=Nn/v;if(i&&l&&l.projection.isReprojectedInTileSpace){const x=1<<i.z,{scale:M,x:z,y:V,projection:E}=l,L=B=>{const O=it((i.x+B.x/v)/x),F=rt((i.y+B.y/v)/x),G=E.project(O,F);B.x=(G.x*M-z)*v,B.y=(G.y*M-V)*v};for(let B=0;B<h.length;B++)if(d.type!==1)h[B]=mn(h[B],L,1);else{const O=[];for(const F of h[B])F.x<0||F.x>=v||F.y<0||F.y>=v||(L(F),O.push(F));h[B]=O}}for(const x of h)for(const M of x)cn(M,p);return h}function An(d,i){return{type:d.type,id:d.id,properties:d.properties,geometry:i?In(d):[]}}function pn(d,i,l,h,v){d.emplaceBack(2*i+(h+1)/2,2*l+(v+1)/2)}function _n(d,i,l){d.emplaceBack(i.x,i.y,i.z,l[0]*16384,l[1]*16384,l[2]*16384)}class _r{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(l=>l.fqid),this.index=i.index,this.hasPattern=!1,this.projection=i.projection,this.layoutVertexArray=new yd,this.indexArray=new sa,this.segments=new No,this.programConfigurations=new bd(i.layers,{zoom:i.zoom,lut:i.lut}),this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}updateFootprints(i,l){}populate(i,l,h,v){const p=this.layers[0],x=[];let M=null;p.type==="circle"&&(M=p.layout.get("circle-sort-key"));for(const{feature:V,id:E,index:L,sourceLayerIndex:B}of i){const O=this.layers[0]._featureFilter.needGeometry,F=An(V,O);if(!this.layers[0]._featureFilter.filter(new Fo(this.zoom),F,h))continue;const G=M?M.evaluate(F,{},h):void 0,Q={id:E,properties:V.properties,type:V.type,sourceLayerIndex:B,index:L,geometry:O?F.geometry:In(V,h,v),patterns:{},sortKey:G};x.push(Q)}M&&x.sort((V,E)=>V.sortKey-E.sortKey);let z=null;v.projection.name==="globe"&&(this.globeExtVertexArray=new fg,z=v.projection);for(const V of x){const{geometry:E,index:L,sourceLayerIndex:B}=V,O=i[L].feature;this.addFeature(V,E,L,l.availableImages,h,z,l.brightness),l.featureIndex.insert(O,E,L,B,this.index)}}update(i,l,h,v,p){const x=Object.keys(i).length!==0;x&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(i,l,x?this.stateDependentLayers:this.layers,h,v,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,hT.members),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=i.createVertexBuffer(this.globeExtVertexArray,fT.members))),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(i,l,h,v,p,x,M){for(const z of l)for(const V of z){const E=V.x,L=V.y;if(E<0||E>=Nn||L<0||L>=Nn)continue;if(x){const F=x.projectTilePoint(E,L,p),G=x.upVector(p,E,L),Q=this.globeExtVertexArray;_n(Q,F,G),_n(Q,F,G),_n(Q,F,G),_n(Q,F,G)}const B=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,i.sortKey),O=B.vertexLength;pn(this.layoutVertexArray,E,L,-1,-1),pn(this.layoutVertexArray,E,L,1,-1),pn(this.layoutVertexArray,E,L,1,1),pn(this.layoutVertexArray,E,L,-1,1),this.indexArray.emplaceBack(O,O+1,O+2),this.indexArray.emplaceBack(O,O+2,O+3),B.vertexLength+=4,B.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,h,{},v,p,M)}}function Vn(d,i){for(let l=0;l<d.length;l++)if(ao(i,d[l]))return!0;for(let l=0;l<i.length;l++)if(ao(d,i[l]))return!0;return!!Ir(d,i)}function tr(d,i,l){return!!ao(d,i)||!!Qr(i,d,l)}function zr(d,i){if(d.length===1)return qi(i,d[0]);for(let l=0;l<i.length;l++){const h=i[l];for(let v=0;v<h.length;v++)if(ao(d,h[v]))return!0}for(let l=0;l<d.length;l++)if(qi(i,d[l]))return!0;for(let l=0;l<i.length;l++)if(Ir(d,i[l]))return!0;return!1}function dr(d,i,l){if(d.length>1){if(Ir(d,i))return!0;for(let h=0;h<i.length;h++)if(Qr(i[h],d,l))return!0}for(let h=0;h<d.length;h++)if(Qr(d[h],i,l))return!0;return!1}function Ir(d,i){if(d.length===0||i.length===0)return!1;for(let l=0;l<d.length-1;l++){const h=d[l],v=d[l+1];for(let p=0;p<i.length-1;p++)if(oi(h,v,i[p],i[p+1]))return!0}return!1}function oi(d,i,l,h){return zi(d,l,h)!==zi(i,l,h)&&zi(d,i,l)!==zi(d,i,h)}function Qr(d,i,l){const h=l*l;if(i.length===1)return d.distSqr(i[0])<h;for(let v=1;v<i.length;v++)if(Fi(d,i[v-1],i[v])<h)return!0;return!1}function Fi(d,i,l){const h=i.distSqr(l);if(h===0)return d.distSqr(i);const v=((d.x-i.x)*(l.x-i.x)+(d.y-i.y)*(l.y-i.y))/h;return d.distSqr(v<0?i:v>1?l:l.sub(i)._mult(v)._add(i))}function qi(d,i){let l,h,v,p=!1;for(let x=0;x<d.length;x++){l=d[x];for(let M=0,z=l.length-1;M<l.length;z=M++)h=l[M],v=l[z],h.y>i.y!=v.y>i.y&&i.x<(v.x-h.x)*(i.y-h.y)/(v.y-h.y)+h.x&&(p=!p)}return p}function ao(d,i){let l=!1;for(let h=0,v=d.length-1;h<d.length;v=h++){const p=d[h],x=d[v];p.y>i.y!=x.y>i.y&&i.x<(x.x-p.x)*(i.y-p.y)/(x.y-p.y)+p.x&&(l=!l)}return l}function Gl(d,i,l,h,v){for(const x of d)if(i<=x.x&&l<=x.y&&h>=x.x&&v>=x.y)return!0;const p=[new st(i,l),new st(i,v),new st(h,v),new st(h,l)];if(d.length>2){for(const x of p)if(ao(d,x))return!0}for(let x=0;x<d.length-1;x++)if(is(d[x],d[x+1],p))return!0;return!1}function is(d,i,l){const h=l[0],v=l[2];if(d.x<h.x&&i.x<h.x||d.x>v.x&&i.x>v.x||d.y<h.y&&i.y<h.y||d.y>v.y&&i.y>v.y)return!1;const p=zi(d,i,l[0]);return p!==zi(d,i,l[1])||p!==zi(d,i,l[2])||p!==zi(d,i,l[3])}function hi(d,i,l,h,v,p){let x=i.y-d.y,M=d.x-i.x;if(p=p||0){const z=x*x+M*M;if(z===0)return!0;const V=Math.sqrt(z);x/=V,M/=V}return!((l.x-d.x)*x+(l.y-d.y)*M-p<0||(h.x-d.x)*x+(h.y-d.y)*M-p<0||(v.x-d.x)*x+(v.y-d.y)*M-p<0)}function Hi(d,i,l,h,v,p,x){return!(hi(d,i,h,v,p,x)||hi(i,l,h,v,p,x)||hi(l,d,h,v,p,x)||hi(h,v,d,i,l,x)||hi(v,p,d,i,l,x)||hi(p,h,d,i,l,x))}function xo(d,i,l){const h=i.paint.get(d).value;return h.kind==="constant"?h.value:l.programConfigurations.get(i.id).getMaxValue(d)}function $i(d){return Math.sqrt(d[0]*d[0]+d[1]*d[1])}function ni(d,i,l,h,v){if(!i[0]&&!i[1])return d;const p=st.convert(i)._mult(v);l==="viewport"&&p._rotate(-h);const x=[];for(let M=0;M<d.length;M++)x.push(d[M].sub(p));return x}function Si(d,i,l,h){const v=st.convert(d)._mult(h);return i==="viewport"&&v._rotate(-l),v}let Oi,Bo;ir(_r,"CircleBucket",{omit:["layers"]});var os,_i={exports:{}},Ss=(os||(os=1,function(d,i){(function(l){function h(p,x,M){var z=v(256*p,256*(x=Math.pow(2,M)-x-1),M),V=v(256*(p+1),256*(x+1),M);return z[0]+","+z[1]+","+V[0]+","+V[1]}function v(p,x,M){var z=2*Math.PI*6378137/256/Math.pow(2,M);return[p*z-2*Math.PI*6378137/2,x*z-2*Math.PI*6378137/2]}l.getURL=function(p,x,M,z,V,E){return E=E||{},p+"?"+["bbox="+h(M,z,V),"format="+(E.format||"image/png"),"service="+(E.service||"WMS"),"version="+(E.version||"1.1.1"),"request="+(E.request||"GetMap"),"srs="+(E.srs||"EPSG:3857"),"width="+(E.width||256),"height="+(E.height||256),"layers="+x].join("&")},l.getTileBBox=h,l.getMercCoords=v,Object.defineProperty(l,"__esModule",{value:!0})})(i)}(0,_i.exports)),_i.exports);class Ns{constructor(i,l,h){this.z=i,this.x=l,this.y=h,this.key=Oa(0,i,i,l,h)}equals(i){return this.z===i.z&&this.x===i.x&&this.y===i.y}url(i,l){const h=Ss.getTileBBox(this.x,this.y,this.z),v=function(p,x,M){let z,V="";for(let E=p;E>0;E--)z=1<<E-1,V+=(x&z?1:0)+(M&z?2:0);return V}(this.z,this.x,this.y);return i[(this.x+this.y)%i.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(l==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",v).replace("{bbox-epsg-3857}",h)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Cs{constructor(i,l){this.wrap=i,this.canonical=l,this.key=Oa(i,l.z,l.z,l.x,l.y)}}class no{constructor(i,l,h,v,p){this.overscaledZ=i,this.wrap=l,this.canonical=new Ns(h,+v,+p),this.key=l===0&&i===h?this.canonical.key:Oa(l,i,h,v,p)}equals(i){return this.overscaledZ===i.overscaledZ&&this.wrap===i.wrap&&this.canonical.equals(i.canonical)}scaledTo(i){const l=this.canonical.z-i;return i>this.canonical.z?new no(i,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new no(i,this.wrap,i,this.canonical.x>>l,this.canonical.y>>l)}calculateScaledKey(i,l=!0){if(this.overscaledZ===i&&l)return this.key;if(i>this.canonical.z)return Oa(this.wrap*+l,i,this.canonical.z,this.canonical.x,this.canonical.y);{const h=this.canonical.z-i;return Oa(this.wrap*+l,i,i,this.canonical.x>>h,this.canonical.y>>h)}}isChildOf(i){if(i.wrap!==this.wrap)return!1;const l=this.canonical.z-i.canonical.z;return i.overscaledZ===0||i.overscaledZ<this.overscaledZ&&i.canonical.z<this.canonical.z&&i.canonical.x===this.canonical.x>>l&&i.canonical.y===this.canonical.y>>l}children(i){if(this.overscaledZ>=i)return[new no(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const l=this.canonical.z+1,h=2*this.canonical.x,v=2*this.canonical.y;return[new no(l,this.wrap,l,h,v),new no(l,this.wrap,l,h+1,v),new no(l,this.wrap,l,h,v+1),new no(l,this.wrap,l,h+1,v+1)]}isLessThan(i){return this.wrap<i.wrap||!(this.wrap>i.wrap)&&(this.overscaledZ<i.overscaledZ||!(this.overscaledZ>i.overscaledZ)&&(this.canonical.x<i.canonical.x||!(this.canonical.x>i.canonical.x)&&this.canonical.y<i.canonical.y))}wrapped(){return new no(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(i){return new no(this.overscaledZ,i,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Cs(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Oa(d,i,l,h,v){const p=1<<Math.min(l,22);let x=p*(v%p)+h%p;return d&&l<22&&(x+=p*p*((d<0?-2*d-1:2*d)%(1<<2*(22-l)))),16*(32*x+l)+(i-l)}const Da=[d=>{let i=d.canonical.x-1,l=d.wrap;return i<0&&(i=(1<<d.canonical.z)-1,l--),new no(d.overscaledZ,l,d.canonical.z,i,d.canonical.y)},d=>{let i=d.canonical.x+1,l=d.wrap;return i===1<<d.canonical.z&&(i=0,l++),new no(d.overscaledZ,l,d.canonical.z,i,d.canonical.y)},d=>new no(d.overscaledZ,d.wrap,d.canonical.z,d.canonical.x,(d.canonical.y===0?1<<d.canonical.z:d.canonical.y)-1),d=>new no(d.overscaledZ,d.wrap,d.canonical.z,d.canonical.x,d.canonical.y===(1<<d.canonical.z)-1?0:d.canonical.y+1)];ir(Ns,"CanonicalTileID"),ir(no,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const Hl=wi([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:Tl}=Hl,rl=wi([{name:"a_pos_3",components:3,type:"Int16"}]);var Wl=wi([{name:"a_pos",type:"Int16",components:2}]);class Rc{constructor(i,l){this.pos=i,this.dir=l}intersectsPlane(i,l,h){const v=Ne.vec3.dot(l,this.dir);if(Math.abs(v)<1e-6)return!1;const p=((i[0]-this.pos[0])*l[0]+(i[1]-this.pos[1])*l[1]+(i[2]-this.pos[2])*l[2])/v;return h[0]=this.pos[0]+this.dir[0]*p,h[1]=this.pos[1]+this.dir[1]*p,h[2]=this.pos[2]+this.dir[2]*p,!0}closestPointOnSphere(i,l,h){if(Ne.vec3.equals(this.pos,i)||l===0)return h[0]=h[1]=h[2]=0,!1;const[v,p,x]=this.dir,M=this.pos[0]-i[0],z=this.pos[1]-i[1],V=this.pos[2]-i[2],E=v*v+p*p+x*x,L=2*(M*v+z*p+V*x),B=L*L-4*E*(M*M+z*z+V*V-l*l);if(B<0){const O=Math.max(-L/2,0),F=M+v*O,G=z+p*O,Q=V+x*O,ie=Math.hypot(F,G,Q);return h[0]=F*l/ie,h[1]=G*l/ie,h[2]=Q*l/ie,!1}{const O=(-L-Math.sqrt(B))/(2*E);if(O<0){const F=Math.hypot(M,z,V);return h[0]=M*l/F,h[1]=z*l/F,h[2]=V*l/F,!1}return h[0]=M+v*O,h[1]=z+p*O,h[2]=V+x*O,!0}}}class wd{constructor(i,l,h,v,p){this.TL=i,this.TR=l,this.BR=h,this.BL=v,this.horizon=p}static fromInvProjectionMatrix(i,l,h){const v=[-1,1,1],p=[1,1,1],x=[1,-1,1],M=[-1,-1,1],z=Ne.vec3.transformMat4(v,v,i),V=Ne.vec3.transformMat4(p,p,i),E=Ne.vec3.transformMat4(x,x,i),L=Ne.vec3.transformMat4(M,M,i);return new wd(z,V,E,L,l/h)}}function Wu(d,i,l){let h=1/0,v=-1/0;const p=[];for(const x of d){Ne.vec3.sub(p,x,i);const M=Ne.vec3.dot(p,l);h=Math.min(h,M),v=Math.max(v,M)}return[h,v]}function hf(d,i){let l=!0;for(let h=0;h<d.planes.length;h++){const v=d.planes[h];let p=0;for(let x=0;x<i.length;x++)p+=Ne.vec3.dot(v,i[x])+v[3]>=0;if(p===0)return 0;p!==i.length&&(l=!1)}return l?2:1}function ff(d,i){for(const l of d.projections){const h=Wu(i,d.points[0],l.axis);if(l.projection[1]<h[0]||l.projection[0]>h[1])return 0}return 1}function bg(d,i){let l=0;const h=[0,0,0,0];for(let v=0;v<d.length;v++)h[0]=d[v][0],h[1]=d[v][1],h[2]=d[v][2],h[3]=1,Ne.vec4.dot(h,i)>=0&&l++;return l}class pf{constructor(i,l){this.points=i||new Array(8).fill([0,0,0]),this.planes=l||new Array(6).fill([0,0,0,0]),this.bounds=ro.fromPoints(this.points),this.projections=[],this.frustumEdges=[Ne.vec3.sub([],this.points[2],this.points[3]),Ne.vec3.sub([],this.points[0],this.points[3]),Ne.vec3.sub([],this.points[4],this.points[0]),Ne.vec3.sub([],this.points[5],this.points[1]),Ne.vec3.sub([],this.points[6],this.points[2]),Ne.vec3.sub([],this.points[7],this.points[3])];for(const h of this.frustumEdges){const v=[0,-h[2],h[1]],p=[h[2],0,-h[0]];this.projections.push({axis:v,projection:Wu(this.points,this.points[0],v)}),this.projections.push({axis:p,projection:Wu(this.points,this.points[0],p)})}}static fromInvProjectionMatrix(i,l,h,v){const p=Math.pow(2,h),x=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(V=>{const E=Ne.vec4.transformMat4([],V,i),L=1/E[3]/l*p;return Ne.vec4.mul(E,E,[L,L,v?1/E[3]:L,L])}),M=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(V=>{const E=Ne.vec3.sub([],x[V[0]],x[V[1]]),L=Ne.vec3.sub([],x[V[2]],x[V[1]]),B=Ne.vec3.normalize([],Ne.vec3.cross([],E,L)),O=-Ne.vec3.dot(B,x[V[1]]);return B.concat(O)}),z=[];for(let V=0;V<x.length;V++)z.push([x[V][0],x[V][1],x[V][2]]);return new pf(z,M)}intersectsPrecise(i,l,h){for(let v=0;v<l.length;v++)if(!bg(i,l[v]))return 0;for(let v=0;v<this.planes.length;v++)if(!bg(i,this.planes[v]))return 0;for(const v of h)for(const p of this.frustumEdges){const x=Ne.vec3.cross([],v,p),M=Ne.vec3.length(x);if(M===0)continue;Ne.vec3.scale(x,x,1/M);const z=Wu(this.points,this.points[0],x),V=Wu(i,this.points[0],x);if(z[0]>V[1]||V[0]>z[1])return 0}return 1}containsPoint(i){for(const l of this.planes){const h=l[3];if(Ne.vec3.dot([l[0],l[1],l[2]],i)+h<0)return!1}return!0}}class ro{static fromPoints(i){const l=[1/0,1/0,1/0],h=[-1/0,-1/0,-1/0];for(const v of i)Ne.vec3.min(l,l,v),Ne.vec3.max(h,h,v);return new ro(l,h)}static fromTileIdAndHeight(i,l,h){const v=1<<i.canonical.z,p=i.canonical.x,x=i.canonical.y;return new ro([p/v,x/v,l],[(p+1)/v,(x+1)/v,h])}static applyTransform(i,l){const h=i.getCorners();for(let v=0;v<h.length;++v)Ne.vec3.transformMat4(h[v],h[v],l);return ro.fromPoints(h)}static applyTransformFast(i,l){const h=[l[12],l[13],l[14]],v=[...h];for(let p=0;p<3;p++)for(let x=0;x<3;x++){const M=l[4*x+p],z=M*i.min[x],V=M*i.max[x];h[p]+=Math.min(z,V),v[p]+=Math.max(z,V)}return new ro(h,v)}static projectAabbCorners(i,l){const h=i.getCorners();for(let v=0;v<h.length;++v)Ne.vec3.transformMat4(h[v],h[v],l);return h}constructor(i,l){this.min=i,this.max=l,this.center=Ne.vec3.scale([],Ne.vec3.add([],this.min,this.max),.5)}quadrant(i){const l=[i%2==0,i<2],h=Ne.vec3.clone(this.min),v=Ne.vec3.clone(this.max);for(let p=0;p<l.length;p++)h[p]=l[p]?this.min[p]:this.center[p],v[p]=l[p]?this.center[p]:this.max[p];return v[2]=this.max[2],new ro(h,v)}distanceX(i){return Math.max(Math.min(this.max[0],i[0]),this.min[0])-i[0]}distanceY(i){return Math.max(Math.min(this.max[1],i[1]),this.min[1])-i[1]}distanceZ(i){return Math.max(Math.min(this.max[2],i[2]),this.min[2])-i[2]}getCorners(){const i=this.min,l=this.max;return[[i[0],i[1],i[2]],[l[0],i[1],i[2]],[l[0],l[1],i[2]],[i[0],l[1],i[2]],[i[0],i[1],l[2]],[l[0],i[1],l[2]],[l[0],l[1],l[2]],[i[0],l[1],l[2]]]}intersects(i){return this.intersectsAabb(i.bounds)?hf(i,this.getCorners()):0}intersectsFlat(i){return this.intersectsAabb(i.bounds)?hf(i,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(i,l){return l||this.intersects(i)?ff(i,this.getCorners()):0}intersectsPreciseFlat(i,l){return l||this.intersectsFlat(i)?ff(i,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(i){for(let l=0;l<3;++l)if(this.min[l]>i.max[l]||i.min[l]>this.max[l])return!1;return!0}intersectsAabbXY(i){return!(this.min[0]>i.max[0]||i.min[0]>this.max[0]||this.min[1]>i.max[1]||i.min[1]>this.max[1])}encapsulate(i){for(let l=0;l<3;l++)this.min[l]=Math.min(this.min[l],i.min[l]),this.max[l]=Math.max(this.max[l],i.max[l])}encapsulatePoint(i){for(let l=0;l<3;l++)this.min[l]=Math.min(this.min[l],i[l]),this.max[l]=Math.max(this.max[l],i[l])}closestPoint(i){return[Math.max(Math.min(this.max[0],i[0]),this.min[0]),Math.max(Math.min(this.max[1],i[1]),this.min[1]),Math.max(Math.min(this.max[2],i[2]),this.min[2])]}}function hh(d){return d*o/ue}ir(ro,"Aabb");const bT=[new ro([$,$,$],[Y,Y,Y]),new ro([$,$,$],[0,0,Y]),new ro([0,$,$],[Y,0,Y]),new ro([$,0,$],[0,Y,Y]),new ro([0,0,$],[Y,Y,Y])];function cb(d,i,l,h=!0){const v=Ne.vec3.scale([],d._camera.position,d.worldSize),p=[i,l,1,1];Ne.vec4.transformMat4(p,p,d.pixelMatrixInverse),Ne.vec4.scale(p,p,1/p[3]);const x=Ne.vec3.sub([],p,v),M=Ne.vec3.normalize([],x),z=d.globeMatrix,V=[z[12],z[13],z[14]],E=Ne.vec3.sub([],V,v),L=Ne.vec3.length(E),B=Ne.vec3.normalize([],E),O=d.worldSize/(2*Math.PI),F=Ne.vec3.dot(B,M),G=Math.asin(O/L);if(G<Math.acos(F)){if(!h)return null;const ct=[],Qe=[];Ne.vec3.scale(ct,M,L/F),Ne.vec3.normalize(Qe,Ne.vec3.sub(Qe,ct,E)),Ne.vec3.normalize(M,Ne.vec3.add(M,E,Ne.vec3.scale(M,Qe,Math.tan(G)*L)))}const Q=[];new Rc(v,M).closestPointOnSphere(V,O,Q);const ie=Ne.vec3.normalize([],Pn(z,0)),pe=Ne.vec3.normalize([],Pn(z,1)),ge=Ne.vec3.normalize([],Pn(z,2)),ae=Ne.vec3.dot(ie,Q),be=Ne.vec3.dot(pe,Q),Te=Ne.vec3.dot(ge,Q),Be=tn(Math.asin(-be/O));let Xe=tn(Math.atan2(ae,Te));Xe=d.center.lng+function(ct,Qe){const pt=(Qe-ct+180)%360-180;return pt<-180?pt+360:pt}(d.center.lng,Xe);const Ze=Ye(Xe),He=Wt(Je(Be),0,1);return new Ot(Ze,He)}class A${constructor(i,l,h){this.a=Ne.vec3.sub([],i,h),this.b=Ne.vec3.sub([],l,h),this.center=h;const v=Ne.vec3.normalize([],this.a),p=Ne.vec3.normalize([],this.b);this.angle=Math.acos(Ne.vec3.dot(v,p))}}function wT(d,i){if(d.angle===0)return null;let l;return l=d.a[i]===0?1/d.angle*.5*Math.PI:1/d.angle*Math.atan(d.b[i]/d.a[i]/Math.sin(d.angle)-1/Math.tan(d.angle)),l<0||l>1?null:function(h,v,p,x){const M=Math.sin(p);return h*(Math.sin((1-x)*p)/M)+v*(Math.sin(x*p)/M)}(d.a[i],d.b[i],d.angle,Wt(l,0,1))+d.center[i]}function Sd(d){if(d.z<=1)return bT[d.z+2*d.y+d.x];const i=ST(db(d));return ro.fromPoints(i)}function fh(d,i,l){return Ne.vec3.scale(d,d,1-l),Ne.vec3.scaleAndAdd(d,d,i,l)}function tL(d,i,l){for(const h of d)Ne.vec3.transformMat4(h,h,i),Ne.vec3.scale(h,h,l)}function nL(d,i,l,h){const v=i/d.worldSize,p=d.globeMatrix;if(l.z<=1){const Ze=Sd(l).getCorners();return tL(Ze,p,v),ro.fromPoints(Ze)}const x=db(l,h),M=ST(x,o+hh(d._tileCoverLift));tL(M,p,v);const z=Number.MAX_VALUE,V=[-z,-z,-z],E=[z,z,z];if(x.contains(d.center)){for(const ct of M)Ne.vec3.min(E,E,ct),Ne.vec3.max(V,V,ct);V[2]=0;const Ze=d.point,He=[Ze.x*v,Ze.y*v,0];return Ne.vec3.min(E,E,He),Ne.vec3.max(V,V,He),new ro(E,V)}if(d._tileCoverLift>0){for(const Ze of M)Ne.vec3.min(E,E,Ze),Ne.vec3.max(V,V,Ze);return new ro(E,V)}const L=[p[12]*v,p[13]*v,p[14]*v],B=x.getCenter(),O=Wt(d.center.lat,-dt,dt),F=Wt(B.lat,-dt,dt),G=Ye(d.center.lng),Q=Je(O);let ie=G-Ye(B.lng);const pe=Q-Je(F);ie>.5?ie-=1:ie<-.5&&(ie+=1);let ge=0;if(Math.abs(ie)>Math.abs(pe))ge=ie>=0?1:3;else{ge=pe>=0?0:2;const Ze=[p[4]*v,p[5]*v,p[6]*v],He=-Math.sin(nt(pe>=0?x.getSouth():x.getNorth()))*o;Ne.vec3.scaleAndAdd(L,L,Ze,He)}const ae=M[ge],be=M[(ge+1)%4],Te=new A$(ae,be,L),Be=[wT(Te,0)||ae[0],wT(Te,1)||ae[1],wT(Te,2)||ae[2]],Xe=mf(d.zoom);if(Xe>0){const Ze=function({x:ct,y:Qe,z:pt},St,Tt,It,Lt){const Yt=1/(1<<pt);let Rt=ct*Yt,ln=Rt+Yt,gn=Qe*Yt,Qt=gn+Yt,Qn=0;const $n=(Rt+ln)/2-It;return $n>.5?Qn=-1:$n<-.5&&(Qn=1),Rt=((Rt+Qn)*St-(It*=St))*Tt+It,ln=((ln+Qn)*St-It)*Tt+It,gn=(gn*St-(Lt*=St))*Tt+Lt,Qt=(Qt*St-Lt)*Tt+Lt,[[Rt,Qt,0],[ln,Qt,0],[ln,gn,0],[Rt,gn,0]]}(l,i,d._pixelsPerMercatorPixel,G,Q);for(let ct=0;ct<M.length;ct++)fh(M[ct],Ze[ct],Xe);const He=Ne.vec3.add([],Ze[ge],Ze[(ge+1)%4]);Ne.vec3.scale(He,He,.5),fh(Be,He,Xe)}for(const Ze of M)Ne.vec3.min(E,E,Ze),Ne.vec3.max(V,V,Ze);return E[2]=Math.min(ae[2],be[2]),Ne.vec3.min(E,E,Be),Ne.vec3.max(V,V,Be),new ro(E,V)}function db({x:d,y:i,z:l},h=!1){const v=1/(1<<l),p=new me(it(d*v),i===(1<<l)-1&&h?-90:rt((i+1)*v)),x=new me(it((d+1)*v),i===0&&h?90:rt(i*v));return new ke(p,x)}function ST(d,i=o){const l=nt(d.getNorth()),h=nt(d.getSouth()),v=Math.cos(l),p=Math.cos(h),x=Math.sin(l),M=Math.sin(h),z=d.getWest(),V=d.getEast();return[ee(p,M,z,i),ee(p,M,V,i),ee(v,x,V,i),ee(v,x,z,i)]}function x_(d,i,l,h){const v=1<<l.z,p=(d/Nn+l.x)/v;return te(rt((i/Nn+l.y)/v),it(p),h)}function hb({min:d,max:i}){return S/Math.max(i[0]-d[0],i[1]-d[1],i[2]-d[2])}const rL=new Float64Array(16);function fb(d){const i=hb(d),l=Ne.mat4.fromScaling(rL,[i,i,i]);return Ne.mat4.translate(l,l,Ne.vec3.negate([],d.min))}function CT(d){const i=Ne.mat4.fromTranslation(rL,d.min),l=1/hb(d);return Ne.mat4.scale(i,i,[l,l,l])}function ET(d){const i=Nn/(2*Math.PI);return d/(2*Math.PI)/i}function iL(d,i){return Nn/(512*Math.pow(2,d))*hb(Sd(i))}function oL(d,i,l,h,v){const p=ET(l),x=[d,i,-l/(2*Math.PI)],M=Ne.mat4.identity(new Float64Array(16));return Ne.mat4.translate(M,M,x),Ne.mat4.scale(M,M,[p,p,p]),Ne.mat4.rotateX(M,M,nt(-v)),Ne.mat4.rotateY(M,M,nt(-h)),M}function mf(d){return Fn(c,y,d)}function sL(d,i){const l=te(i.lat,i.lng),h=function(p){const x=te(p._center.lat,p._center.lng),M=Ne.vec3.fromValues(0,1,0);let z=Ne.vec3.cross([],M,x);const V=Ne.mat4.fromRotation([],-p.angle,x);z=Ne.vec3.transformMat4(z,z,V),Ne.mat4.fromRotation(V,-p._pitch,z);const E=Ne.vec3.normalize([],x);return Ne.vec3.scale(E,E,hh(p.cameraToCenterDistance/p.pixelsPerMeter)),Ne.vec3.transformMat4(E,E,V),Ne.vec3.add([],x,E)}(d),v=Ne.vec3.subtract([],h,l);return Ne.vec3.angle(v,l)}function TT(d,i){return sL(d,i)>Math.PI/2*1.01}const aL=nt(85),L$=Math.cos(aL),R$=Math.sin(aL),O$=Ne.mat4.create(),lL=d=>{const i=[];return d.paint.get("circle-pitch-alignment")==="map"&&i.push("PITCH_WITH_MAP"),d.paint.get("circle-pitch-scale")==="map"&&i.push("SCALE_WITH_MAP"),i};function uL(d,i,l,h,v,p,x,M,z){if(p&&d.queryGeometry.isAboveHorizon)return!1;p&&(z*=d.pixelToTileUnitsFactor);const V=d.tileID.canonical,E=l.projection.upVectorScale(V,l.center.lat,l.worldSize).metersToTile;for(const L of i)for(const B of L){const O=B.add(M),F=v&&l.elevation?l.elevation.exaggeration()*v.getElevationAt(O.x,O.y,!0):0,G=l.projection.projectTilePoint(O.x,O.y,V);if(F>0){const ge=l.projection.upVector(V,O.x,O.y);G.x+=ge[0]*E*F,G.y+=ge[1]*E*F,G.z+=ge[2]*E*F}const Q=p?O:D$(G.x,G.y,G.z,h),ie=p?d.tilespaceRays.map(ge=>F$(ge,F)):d.queryGeometry.screenGeometry,pe=Ne.vec4.transformMat4([],[G.x,G.y,G.z,1],h);if(!x&&p?z*=pe[3]/l.cameraToCenterDistance:x&&!p&&(z*=l.cameraToCenterDistance/pe[3]),p){const ge=rt((B.y/Nn+V.y)/(1<<V.z));z/=l.projection.pixelsPerMeter(ge,1)/qe(1,ge)}if(tr(ie,Q,z))return!0}return!1}function D$(d,i,l,h){const v=Ne.vec4.transformMat4([],[d,i,l,1],h);return new st(v[0]/v[3],v[1]/v[3])}const cL=Ne.vec3.fromValues(0,0,0),z$=Ne.vec3.fromValues(0,0,1);function F$(d,i){const l=Ne.vec3.create();return cL[2]=i,d.intersectsPlane(cL,z$,l),new st(l[0],l[1])}class dL extends _r{}let hL,fL,pL,mL;function gL(d,{width:i,height:l},h,v){if(v){if(v instanceof Uint8ClampedArray)v=new Uint8Array(v.buffer);else if(v.length!==i*l*h)throw new RangeError("mismatched image size")}else v=new Uint8Array(i*l*h);return d.width=i,d.height=l,d.data=v,d}function yL(d,i,l){const{width:h,height:v}=i;h===d.width&&v===d.height||(IT(d,i,{x:0,y:0},{x:0,y:0},{width:Math.min(d.width,h),height:Math.min(d.height,v)},l,null),d.width=h,d.height=v,d.data=i.data)}function IT(d,i,l,h,v,p,x,M){if(v.width===0||v.height===0)return i;if(v.width>d.width||v.height>d.height||l.x>d.width-v.width||l.y>d.height-v.height)throw new RangeError("out of range source coordinates for image copy");if(v.width>i.width||v.height>i.height||h.x>i.width-v.width||h.y>i.height-v.height)throw new RangeError("out of range destination coordinates for image copy");const z=d.data,V=i.data,E=p===4&&M;for(let L=0;L<v.height;L++){const B=((l.y+L)*d.width+l.x)*p,O=((h.y+L)*i.width+h.x)*p;if(E)for(let F=0;F<v.width;F++){const G=B+F*p+3,Q=O+F*p;V[Q+0]=255,V[Q+1]=255,V[Q+2]=255,V[Q+3]=z[G]}else if(x)for(let F=0;F<v.width;F++){const G=B+F*p,Q=O+F*p,ie=z[G+3],pe=new Tr(z[G+0]/255*ie,z[G+1]/255*ie,z[G+2]/255*ie,ie).toRenderColor(x).toArray();V[Q+0]=pe[0],V[Q+1]=pe[1],V[Q+2]=pe[2],V[Q+3]=pe[3]}else for(let F=0;F<v.width*p;F++)V[O+F]=z[B+F]}return i}ir(dL,"HeatmapBucket",{omit:["layers"]});class gf{constructor(i,l){gL(this,i,1,l)}resize(i){yL(this,new gf(i),1)}clone(){return new gf({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,l,h,v,p){IT(i,l,h,v,p,1,null)}}class za{constructor(i,l){gL(this,i,4,l)}resize(i){yL(this,new za(i),4)}replace(i,l){l?this.data.set(i):this.data=i instanceof Uint8ClampedArray?new Uint8Array(i.buffer):i}clone(){return new za({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,l,h,v,p,x,M){IT(i,l,h,v,p,4,x,M)}}class _L{constructor(i,l){this.width=i.width,this.height=i.height,this.data=l instanceof Uint8Array?new Float32Array(l.buffer):l}}function b_(d){const i={},l=d.resolution||256,h=d.clips?d.clips.length:1,v=d.image||new za({width:l,height:h}),p=(x,M,z)=>{i[d.evaluationKey]=z;const V=d.expression.evaluate(i);V&&(v.data[x+M+0]=Math.floor(255*V.r/V.a),v.data[x+M+1]=Math.floor(255*V.g/V.a),v.data[x+M+2]=Math.floor(255*V.b/V.a),v.data[x+M+3]=Math.floor(255*V.a))};if(d.clips)for(let x=0,M=0;x<h;++x,M+=4*l)for(let z=0,V=0;z<l;z++,V+=4){const E=z/(l-1),{start:L,end:B}=d.clips[x];p(M,V,L*(1-E)+B*E)}else for(let x=0,M=0;x<l;x++,M+=4)p(0,M,x/(l-1));return v}ir(gf,"AlphaImage"),ir(za,"RGBAImage");const N$=wi([{name:"a_pos",components:2,type:"Int16"}],4),{members:B$}=N$;function w_(d,i,l=2){const h=i&&i.length,v=h?i[0]*l:d.length;let p=vL(d,0,v,l,!0);const x=[];if(!p||p.next===p.prev)return x;let M,z,V;if(h&&(p=function(E,L,B,O){const F=[];for(let G=0,Q=L.length;G<Q;G++){const ie=vL(E,L[G]*O,G<Q-1?L[G+1]*O:E.length,O,!1);ie===ie.next&&(ie.steiner=!0),F.push(q$(ie))}F.sort(G$);for(let G=0;G<F.length;G++)B=H$(F[G],B);return B}(d,i,p,l)),d.length>80*l){M=1/0,z=1/0;let E=-1/0,L=-1/0;for(let B=l;B<v;B+=l){const O=d[B],F=d[B+1];O<M&&(M=O),F<z&&(z=F),O>E&&(E=O),F>L&&(L=F)}V=Math.max(E-M,L-z),V=V!==0?32767/V:0}return S_(p,x,l,M,z,V,0),x}function vL(d,i,l,h,v){let p;if(v===function(x,M,z,V){let E=0;for(let L=M,B=z-V;L<z;L+=V)E+=(x[B]-x[L])*(x[L+1]+x[B+1]),B=L;return E}(d,i,l,h)>0)for(let x=i;x<l;x+=h)p=wL(x/h|0,d[x],d[x+1],p);else for(let x=l-h;x>=i;x-=h)p=wL(x/h|0,d[x],d[x+1],p);return p&&pb(p,p.next)&&(E_(p),p=p.next),p}function Gp(d,i){if(!d)return d;i||(i=d);let l,h=d;do if(l=!1,h.steiner||!pb(h,h.next)&&Es(h.prev,h,h.next)!==0)h=h.next;else{if(E_(h),h=i=h.prev,h===h.next)break;l=!0}while(l||h!==i);return i}function S_(d,i,l,h,v,p,x){if(!d)return;!x&&p&&function(z,V,E,L){let B=z;do B.z===0&&(B.z=kT(B.x,B.y,V,E,L)),B.prevZ=B.prev,B.nextZ=B.next,B=B.next;while(B!==z);B.prevZ.nextZ=null,B.prevZ=null,function(O){let F,G=1;do{let Q,ie=O;O=null;let pe=null;for(F=0;ie;){F++;let ge=ie,ae=0;for(let Te=0;Te<G&&(ae++,ge=ge.nextZ,ge);Te++);let be=G;for(;ae>0||be>0&&ge;)ae!==0&&(be===0||!ge||ie.z<=ge.z)?(Q=ie,ie=ie.nextZ,ae--):(Q=ge,ge=ge.nextZ,be--),pe?pe.nextZ=Q:O=Q,Q.prevZ=pe,pe=Q;ie=ge}pe.nextZ=null,G*=2}while(F>1)}(B)}(d,h,v,p);let M=d;for(;d.prev!==d.next;){const z=d.prev,V=d.next;if(p?V$(d,h,v,p):j$(d))i.push(z.i,d.i,V.i),E_(d),d=V.next,M=V.next;else if((d=V)===M){x?x===1?S_(d=$$(Gp(d),i),i,l,h,v,p,2):x===2&&U$(d,i,l,h,v,p):S_(Gp(d),i,l,h,v,p,1);break}}}function j$(d){const i=d.prev,l=d,h=d.next;if(Es(i,l,h)>=0)return!1;const v=i.x,p=l.x,x=h.x,M=i.y,z=l.y,V=h.y,E=v<p?v<x?v:x:p<x?p:x,L=M<z?M<V?M:V:z<V?z:V,B=v>p?v>x?v:x:p>x?p:x,O=M>z?M>V?M:V:z>V?z:V;let F=h.next;for(;F!==i;){if(F.x>=E&&F.x<=B&&F.y>=L&&F.y<=O&&wg(v,M,p,z,x,V,F.x,F.y)&&Es(F.prev,F,F.next)>=0)return!1;F=F.next}return!0}function V$(d,i,l,h){const v=d.prev,p=d,x=d.next;if(Es(v,p,x)>=0)return!1;const M=v.x,z=p.x,V=x.x,E=v.y,L=p.y,B=x.y,O=M<z?M<V?M:V:z<V?z:V,F=E<L?E<B?E:B:L<B?L:B,G=M>z?M>V?M:V:z>V?z:V,Q=E>L?E>B?E:B:L>B?L:B,ie=kT(O,F,i,l,h),pe=kT(G,Q,i,l,h);let ge=d.prevZ,ae=d.nextZ;for(;ge&&ge.z>=ie&&ae&&ae.z<=pe;){if(ge.x>=O&&ge.x<=G&&ge.y>=F&&ge.y<=Q&&ge!==v&&ge!==x&&wg(M,E,z,L,V,B,ge.x,ge.y)&&Es(ge.prev,ge,ge.next)>=0||(ge=ge.prevZ,ae.x>=O&&ae.x<=G&&ae.y>=F&&ae.y<=Q&&ae!==v&&ae!==x&&wg(M,E,z,L,V,B,ae.x,ae.y)&&Es(ae.prev,ae,ae.next)>=0))return!1;ae=ae.nextZ}for(;ge&&ge.z>=ie;){if(ge.x>=O&&ge.x<=G&&ge.y>=F&&ge.y<=Q&&ge!==v&&ge!==x&&wg(M,E,z,L,V,B,ge.x,ge.y)&&Es(ge.prev,ge,ge.next)>=0)return!1;ge=ge.prevZ}for(;ae&&ae.z<=pe;){if(ae.x>=O&&ae.x<=G&&ae.y>=F&&ae.y<=Q&&ae!==v&&ae!==x&&wg(M,E,z,L,V,B,ae.x,ae.y)&&Es(ae.prev,ae,ae.next)>=0)return!1;ae=ae.nextZ}return!0}function $$(d,i){let l=d;do{const h=l.prev,v=l.next.next;!pb(h,v)&&xL(h,l,l.next,v)&&C_(h,v)&&C_(v,h)&&(i.push(h.i,l.i,v.i),E_(l),E_(l.next),l=d=v),l=l.next}while(l!==d);return Gp(l)}function U$(d,i,l,h,v,p){let x=d;do{let M=x.next.next;for(;M!==x.prev;){if(x.i!==M.i&&X$(x,M)){let z=bL(x,M);return x=Gp(x,x.next),z=Gp(z,z.next),S_(x,i,l,h,v,p,0),void S_(z,i,l,h,v,p,0)}M=M.next}x=x.next}while(x!==d)}function G$(d,i){return d.x-i.x}function H$(d,i){const l=function(v,p){let x=p;const M=v.x,z=v.y;let V,E=-1/0;do{if(z<=x.y&&z>=x.next.y&&x.next.y!==x.y){const G=x.x+(z-x.y)*(x.next.x-x.x)/(x.next.y-x.y);if(G<=M&&G>E&&(E=G,V=x.x<x.next.x?x:x.next,G===M))return V}x=x.next}while(x!==p);if(!V)return null;const L=V,B=V.x,O=V.y;let F=1/0;x=V;do{if(M>=x.x&&x.x>=B&&M!==x.x&&wg(z<O?M:E,z,B,O,z<O?E:M,z,x.x,x.y)){const G=Math.abs(z-x.y)/(M-x.x);C_(x,v)&&(G<F||G===F&&(x.x>V.x||x.x===V.x&&W$(V,x)))&&(V=x,F=G)}x=x.next}while(x!==L);return V}(d,i);if(!l)return i;const h=bL(l,d);return Gp(h,h.next),Gp(l,l.next)}function W$(d,i){return Es(d.prev,d,i.prev)<0&&Es(i.next,d,d.next)<0}function kT(d,i,l,h,v){return(d=1431655765&((d=858993459&((d=252645135&((d=16711935&((d=(d-l)*v|0)|d<<8))|d<<4))|d<<2))|d<<1))|(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-h)*v|0)|i<<8))|i<<4))|i<<2))|i<<1))<<1}function q$(d){let i=d,l=d;do(i.x<l.x||i.x===l.x&&i.y<l.y)&&(l=i),i=i.next;while(i!==d);return l}function wg(d,i,l,h,v,p,x,M){return(v-x)*(i-M)>=(d-x)*(p-M)&&(d-x)*(h-M)>=(l-x)*(i-M)&&(l-x)*(p-M)>=(v-x)*(h-M)}function X$(d,i){return d.next.i!==i.i&&d.prev.i!==i.i&&!function(l,h){let v=l;do{if(v.i!==l.i&&v.next.i!==l.i&&v.i!==h.i&&v.next.i!==h.i&&xL(v,v.next,l,h))return!0;v=v.next}while(v!==l);return!1}(d,i)&&(C_(d,i)&&C_(i,d)&&function(l,h){let v=l,p=!1;const x=(l.x+h.x)/2,M=(l.y+h.y)/2;do v.y>M!=v.next.y>M&&v.next.y!==v.y&&x<(v.next.x-v.x)*(M-v.y)/(v.next.y-v.y)+v.x&&(p=!p),v=v.next;while(v!==l);return p}(d,i)&&(Es(d.prev,d,i.prev)||Es(d,i.prev,i))||pb(d,i)&&Es(d.prev,d,d.next)>0&&Es(i.prev,i,i.next)>0)}function Es(d,i,l){return(i.y-d.y)*(l.x-i.x)-(i.x-d.x)*(l.y-i.y)}function pb(d,i){return d.x===i.x&&d.y===i.y}function xL(d,i,l,h){const v=gb(Es(d,i,l)),p=gb(Es(d,i,h)),x=gb(Es(l,h,d)),M=gb(Es(l,h,i));return v!==p&&x!==M||!(v!==0||!mb(d,l,i))||!(p!==0||!mb(d,h,i))||!(x!==0||!mb(l,d,h))||!(M!==0||!mb(l,i,h))}function mb(d,i,l){return i.x<=Math.max(d.x,l.x)&&i.x>=Math.min(d.x,l.x)&&i.y<=Math.max(d.y,l.y)&&i.y>=Math.min(d.y,l.y)}function gb(d){return d>0?1:d<0?-1:0}function C_(d,i){return Es(d.prev,d,d.next)<0?Es(d,i,d.next)>=0&&Es(d,d.prev,i)>=0:Es(d,i,d.prev)<0||Es(d,d.next,i)<0}function bL(d,i){const l=MT(d.i,d.x,d.y),h=MT(i.i,i.x,i.y),v=d.next,p=i.prev;return d.next=i,i.prev=d,l.next=v,v.prev=l,h.next=l,l.prev=h,p.next=h,h.prev=p,h}function wL(d,i,l,h){const v=MT(d,i,l);return h?(v.next=h.next,v.prev=h,h.next.prev=v,h.next=v):(v.prev=v,v.next=v),v}function E_(d){d.next.prev=d.prev,d.prev.next=d.next,d.prevZ&&(d.prevZ.nextZ=d.nextZ),d.nextZ&&(d.nextZ.prevZ=d.prevZ)}function MT(d,i,l){return{i:d,x:i,y:l,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function yb(d,i){const l=d.length;if(l<=1)return[d];const h=[];let v,p;for(let x=0;x<l;x++){const M=Li(d[x]);M!==0&&(d[x].area=Math.abs(M),p===void 0&&(p=M<0),p===M<0?(v&&h.push(v),v=[d[x]]):v.push(d[x]))}if(v&&h.push(v),i>1)for(let x=0;x<h.length;x++)h[x].length<=i||(Du(h[x],i,1,h[x].length-1,Y$),h[x]=h[x].slice(0,i));return h}function Y$(d,i){return i.area-d.area}function PT(d,i,l){const h=l.patternDependencies;let v=!1;for(const p of i){const x=p.paint.get(`${d}-pattern`);x.isConstant()||(v=!0);const M=x.constantOr(null);M&&(v=!0,h[M]=!0)}return v}function AT(d,i,l,h,v){const p=v.patternDependencies;for(const x of i){const M=x.paint.get(`${d}-pattern`).value;if(M.kind!=="constant"){let z=M.evaluate({zoom:h},l,{},v.availableImages);z=z&&z.name?z.name:z,p[z]=!0,l.patterns[x.id]=z}}return l}class LT{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(l=>l.fqid),this.index=i.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new yd,this.indexArray=new sa,this.indexArray2=new xd,this.programConfigurations=new bd(i.layers,{zoom:i.zoom,lut:i.lut}),this.segments=new No,this.segments2=new No,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.projection=i.projection}updateFootprints(i,l){}populate(i,l,h,v){this.hasPattern=PT("fill",this.layers,l);const p=this.layers[0].layout.get("fill-sort-key"),x=[];for(const{feature:M,id:z,index:V,sourceLayerIndex:E}of i){const L=this.layers[0]._featureFilter.needGeometry,B=An(M,L);if(!this.layers[0]._featureFilter.filter(new Fo(this.zoom),B,h))continue;const O=p?p.evaluate(B,{},h,l.availableImages):void 0,F={id:z,properties:M.properties,type:M.type,sourceLayerIndex:E,index:V,geometry:L?B.geometry:In(M,h,v),patterns:{},sortKey:O};x.push(F)}p&&x.sort((M,z)=>M.sortKey-z.sortKey);for(const M of x){const{geometry:z,index:V,sourceLayerIndex:E}=M;if(this.hasPattern){const L=AT("fill",this.layers,M,this.zoom,l);this.patternFeatures.push(L)}else this.addFeature(M,z,V,h,{},l.availableImages,l.brightness);l.featureIndex.insert(i[V].feature,z,V,E,this.index)}}update(i,l,h,v,p){const x=Object.keys(i).length!==0;x&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(i,l,x?this.stateDependentLayers:this.layers,h,v,p)}addFeatures(i,l,h,v,p,x){for(const M of this.patternFeatures)this.addFeature(M,M.geometry,M.index,l,h,v,x)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,B$),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.indexBuffer2=i.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(i,l,h,v,p,x=[],M){for(const z of yb(l,500)){let V=0;for(const G of z)V+=G.length;const E=this.segments.prepareSegment(V,this.layoutVertexArray,this.indexArray),L=E.vertexLength,B=[],O=[];for(const G of z){if(G.length===0)continue;G!==z[0]&&O.push(B.length/2);const Q=this.segments2.prepareSegment(G.length,this.layoutVertexArray,this.indexArray2),ie=Q.vertexLength;this.layoutVertexArray.emplaceBack(G[0].x,G[0].y),this.indexArray2.emplaceBack(ie+G.length-1,ie),B.push(G[0].x),B.push(G[0].y);for(let pe=1;pe<G.length;pe++)this.layoutVertexArray.emplaceBack(G[pe].x,G[pe].y),this.indexArray2.emplaceBack(ie+pe-1,ie+pe),B.push(G[pe].x),B.push(G[pe].y);Q.vertexLength+=G.length,Q.primitiveLength+=G.length}const F=w_(B,O);for(let G=0;G<F.length;G+=3)this.indexArray.emplaceBack(L+F[G],L+F[G+1],L+F[G+2]);E.vertexLength+=V,E.primitiveLength+=F.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,h,p,x,v,M)}}let SL,CL,EL,TL;ir(LT,"FillBucket",{omit:["layers","patternFeatures"]});class RT{constructor(i,l,h,v){if(this.triangleCount=l.length/3,this.min=new st(0,0),this.max=new st(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||i.length===0)return;const[p,x]=[i[0].clone(),i[0].clone()];for(let L=1;L<i.length;++L){const B=i[L];p.x=Math.min(p.x,B.x),p.y=Math.min(p.y,B.y),x.x=Math.max(x.x,B.x),x.y=Math.max(x.y,B.y)}if(v){const L=Math.ceil(Math.max(x.x-p.x,x.y-p.y)/v);h=Math.max(h,L)}if(h===0)return;this.min=p,this.max=x;const M=this.max.sub(this.min);M.x=Math.max(M.x,1),M.y=Math.max(M.y,1);const z=Math.max(M.x,M.y)/h;this.cellsX=Math.max(1,Math.ceil(M.x/z)),this.cellsY=Math.max(1,Math.ceil(M.y/z)),this.xScale=1/z,this.yScale=1/z;const V=[];for(let L=0;L<this.triangleCount;L++){const B=i[l[3*L+0]].sub(this.min),O=i[l[3*L+1]].sub(this.min),F=i[l[3*L+2]].sub(this.min),G=Cd(Math.floor(Math.min(B.x,O.x,F.x)),this.xScale,this.cellsX),Q=Cd(Math.floor(Math.max(B.x,O.x,F.x)),this.xScale,this.cellsX),ie=Cd(Math.floor(Math.min(B.y,O.y,F.y)),this.yScale,this.cellsY),pe=Cd(Math.floor(Math.max(B.y,O.y,F.y)),this.yScale,this.cellsY),ge=new st(0,0),ae=new st(0,0),be=new st(0,0),Te=new st(0,0);for(let Be=ie;Be<=pe;++Be){ge.y=ae.y=Be*z,be.y=Te.y=(Be+1)*z;for(let Xe=G;Xe<=Q;++Xe)ge.x=be.x=Xe*z,ae.x=Te.x=(Xe+1)*z,(Hi(B,O,F,ge,ae,Te)||Hi(B,O,F,ge,Te,be))&&V.push({cellIdx:Be*this.cellsX+Xe,triIdx:L})}}if(V.length===0)return;V.sort((L,B)=>L.cellIdx-B.cellIdx||L.triIdx-B.triIdx);let E=0;for(;E<V.length;){const L=V[E].cellIdx,B={start:this.payload.length,len:0};for(;E<V.length&&V[E].cellIdx===L;)++B.len,this.payload.push(V[E++].triIdx);this.cells[L]=B}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(i,l){if(this.triangleCount===0||this.cells.length===0||i.x>this.max.x||this.min.x>i.x||i.y>this.max.y||this.min.y>i.y)return;const h=Cd(i.x-this.min.x,this.xScale,this.cellsX),v=Cd(i.y-this.min.y,this.yScale,this.cellsY),p=this.cells[v*this.cellsX+h];if(p){this._lazyInitLookup();for(let x=0;x<p.len;x++){const M=this.payload[p.start+x],z=Math.floor(M/8),V=1<<M%8;if(!(this.lookup[z]&V)&&(this.lookup[z]|=V,l.push(M),l.length===this.triangleCount))return}}}query(i,l,h){if(this.triangleCount===0||this.cells.length===0||i.x>this.max.x||this.min.x>l.x||i.y>this.max.y||this.min.y>l.y)return;this._lazyInitLookup();const v=Cd(i.x-this.min.x,this.xScale,this.cellsX),p=Cd(l.x-this.min.x,this.xScale,this.cellsX),x=Cd(i.y-this.min.y,this.yScale,this.cellsY),M=Cd(l.y-this.min.y,this.yScale,this.cellsY);for(let z=x;z<=M;z++)for(let V=v;V<=p;V++){const E=this.cells[z*this.cellsX+V];if(E)for(let L=0;L<E.len;L++){const B=this.payload[E.start+L],O=Math.floor(B/8),F=1<<B%8;if(!(this.lookup[O]&F)&&(this.lookup[O]|=F,h.push(B),h.length===this.triangleCount))return}}}}function Cd(d,i,l){return Math.max(0,Math.min(l-1,Math.floor(d*i)))}ir(RT,"TriangleGridIndex");class IL{constructor(i){this.zoom=i.zoom,this.layers=i.layers,this.layerIds=this.layers.map(l=>l.fqid),this.index=i.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.footprints=[]}updateFootprints(i,l){for(const h of this.footprints)l.push({footprint:h,id:i})}populate(i,l,h,v){const p=[];for(const{feature:x,id:M,index:z,sourceLayerIndex:V}of i){const E=this.layers[0]._featureFilter.needGeometry,L=An(x,E);if(!this.layers[0]._featureFilter.filter(new Fo(this.zoom),L,h))continue;const B={id:M,properties:x.properties,type:x.type,sourceLayerIndex:V,index:z,geometry:E?L.geometry:In(x,h,v),patterns:{}};p.push(B)}for(const x of p){const{geometry:M,index:z,sourceLayerIndex:V}=x;this.addFeature(x,M,z,h,{},l.availableImages,l.brightness),l.featureIndex.insert(i[z].feature,M,z,V,this.index)}}isEmpty(){return this.footprints.length===0}uploadPending(){return!1}upload(i){}update(i,l,h,v,p){}destroy(){}addFeature(i,l,h,v,p,x=[],M){for(const z of yb(l,2)){const V=[],E=[],L=[],B=new st(1/0,1/0),O=new st(-1/0,-1/0);for(const Q of z)if(Q.length!==0){Q!==z[0]&&L.push(E.length/2);for(let ie=0;ie<Q.length;ie++)E.push(Q[ie].x),E.push(Q[ie].y),V.push(Q[ie]),B.x=Math.min(B.x,Q[ie].x),B.y=Math.min(B.y,Q[ie].y),O.x=Math.max(O.x,Q[ie].x),O.y=Math.max(O.y,Q[ie].y)}const F=w_(E,L),G=new RT(V,F,8,256);this.footprints.push({vertices:V,indices:F,grid:G,min:B,max:O})}}}ir(IL,"ClipBucket",{omit:["layers"]});const Z$=wi([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),K$=wi([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),J$=wi([{name:"a_centroid_pos",components:2,type:"Uint16"}]),Q$=wi([{name:"a_join_normal_inside",components:3,type:"Int16"}]),eU=wi([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),tU=wi([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:nU}=Z$;var OT,kL,DT,ML,zT,PL,AL,_b={};function LL(){if(kL)return OT;kL=1;var d=Ae();function i(v,p,x,M,z){this.properties={},this.extent=x,this.type=0,this._pbf=v,this._geometry=-1,this._keys=M,this._values=z,v.readFields(l,this,p)}function l(v,p,x){v==1?p.id=x.readVarint():v==2?function(M,z){for(var V=M.readVarint()+M.pos;M.pos<V;){var E=z._keys[M.readVarint()],L=z._values[M.readVarint()];z.properties[E]=L}}(x,p):v==3?p.type=x.readVarint():v==4&&(p._geometry=x.pos)}function h(v){for(var p,x,M=0,z=0,V=v.length,E=V-1;z<V;E=z++)M+=((x=v[E]).x-(p=v[z]).x)*(p.y+x.y);return M}return OT=i,i.types=["Unknown","Point","LineString","Polygon"],i.prototype.loadGeometry=function(){var v=this._pbf;v.pos=this._geometry;for(var p,x=v.readVarint()+v.pos,M=1,z=0,V=0,E=0,L=[];v.pos<x;){if(z<=0){var B=v.readVarint();M=7&B,z=B>>3}if(z--,M===1||M===2)V+=v.readSVarint(),E+=v.readSVarint(),M===1&&(p&&L.push(p),p=[]),p.push(new d(V,E));else{if(M!==7)throw new Error("unknown command "+M);p&&p.push(p[0].clone())}}return p&&L.push(p),L},i.prototype.bbox=function(){var v=this._pbf;v.pos=this._geometry;for(var p=v.readVarint()+v.pos,x=1,M=0,z=0,V=0,E=1/0,L=-1/0,B=1/0,O=-1/0;v.pos<p;){if(M<=0){var F=v.readVarint();x=7&F,M=F>>3}if(M--,x===1||x===2)(z+=v.readSVarint())<E&&(E=z),z>L&&(L=z),(V+=v.readSVarint())<B&&(B=V),V>O&&(O=V);else if(x!==7)throw new Error("unknown command "+x)}return[E,B,L,O]},i.prototype.toGeoJSON=function(v,p,x){var M,z,V=this.extent*Math.pow(2,x),E=this.extent*v,L=this.extent*p,B=this.loadGeometry(),O=i.types[this.type];function F(ie){for(var pe=0;pe<ie.length;pe++){var ge=ie[pe];ie[pe]=[360*(ge.x+E)/V-180,360/Math.PI*Math.atan(Math.exp((180-360*(ge.y+L)/V)*Math.PI/180))-90]}}switch(this.type){case 1:var G=[];for(M=0;M<B.length;M++)G[M]=B[M][0];F(B=G);break;case 2:for(M=0;M<B.length;M++)F(B[M]);break;case 3:for(B=function(ie){var pe=ie.length;if(pe<=1)return[ie];for(var ge,ae,be=[],Te=0;Te<pe;Te++){var Be=h(ie[Te]);Be!==0&&(ae===void 0&&(ae=Be<0),ae===Be<0?(ge&&be.push(ge),ge=[ie[Te]]):ge.push(ie[Te]))}return ge&&be.push(ge),be}(B),M=0;M<B.length;M++)for(z=0;z<B[M].length;z++)F(B[M][z])}B.length===1?B=B[0]:O="Multi"+O;var Q={type:"Feature",geometry:{type:O,coordinates:B},properties:this.properties};return"id"in this&&(Q.id=this.id),Q},OT}function RL(){if(ML)return DT;ML=1;var d=LL();function i(h,v){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=h,this._keys=[],this._values=[],this._features=[],h.readFields(l,this,v),this.length=this._features.length}function l(h,v,p){h===15?v.version=p.readVarint():h===1?v.name=p.readString():h===5?v.extent=p.readVarint():h===2?v._features.push(p.pos):h===3?v._keys.push(p.readString()):h===4&&v._values.push(function(x){for(var M=null,z=x.readVarint()+x.pos;x.pos<z;){var V=x.readVarint()>>3;M=V===1?x.readString():V===2?x.readFloat():V===3?x.readDouble():V===4?x.readVarint64():V===5?x.readVarint():V===6?x.readSVarint():V===7?x.readBoolean():null}return M}(p))}return DT=i,i.prototype.feature=function(h){if(h<0||h>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[h];var v=this._pbf.readVarint()+this._pbf.pos;return new d(this._pbf,v,this.extent,this._keys,this._values)},DT}function OL(){return AL||(AL=1,_b.VectorTile=function(){if(PL)return zT;PL=1;var d=RL();function i(l,h,v){if(l===3){var p=new d(v,v.readVarint()+v.pos);p.length&&(h[p.name]=p)}}return zT=function(l,h){this.layers=l.readFields(i,{},h)},zT}(),_b.VectorTileFeature=LL(),_b.VectorTileLayer=RL()),_b}var Sg=OL();class Hp extends st{constructor(i,l,h){super(i,l),this.z=h}}class DL extends Hp{constructor(i,l,h,v){super(i,l,h),this.w=v}}function vb(d,i,l,h){const v=[],p=h===0?(x,M,z,V,E,L)=>{x.push(new st(L,z+(L-M)/(V-M)*(E-z)))}:(x,M,z,V,E,L)=>{x.push(new st(M+(L-z)/(E-z)*(V-M),L))};for(const x of d){const M=[];for(const z of x){if(z.length<=2)continue;const V=[];for(let B=0;B<z.length-1;B++){const O=z[B].x,F=z[B].y,G=z[B+1].x,Q=z[B+1].y,ie=h===0?O:F,pe=h===0?G:Q;ie<i?pe>i&&p(V,O,F,G,Q,i):ie>l?pe<l&&p(V,O,F,G,Q,l):V.push(z[B]),pe<i&&ie>=i&&p(V,O,F,G,Q,i),pe>l&&ie<=l&&p(V,O,F,G,Q,l)}let E=z[z.length-1];const L=h===0?E.x:E.y;L>=i&&L<=l&&V.push(E),V.length&&(E=V[V.length-1],V[0].x===E.x&&V[0].y===E.y||V.push(V[0]),M.push(V))}M.length&&v.push(M)}return v}function zL(d,i,l,h){const v=l==="x"?"y":"x",p=(h-d[l])/(i[l]-d[l]);d[v]=d[v]+(i[v]-d[v])*p,d[l]=h,d.hasOwnProperty("z")&&(d.z=sr(d.z,i.z,p)),d.hasOwnProperty("w")&&(d.w=sr(d.w,i.w,p))}function FL(d,i,l,h){const v=l,p=h;for(const x of["x","y"]){let M=d,z=i;M[x]>=z[x]&&(M=i,z=d),M[x]<v&&z[x]>v&&zL(M,z,x,v),M[x]<p&&z[x]>p&&zL(z,M,x,p)}}const xb=Number.MAX_SAFE_INTEGER;function NL(d,i,l,h){return d.order<i||d.order===xb||!(d.clipMask&l)||function(v,p){return p.length!==0&&p.find(x=>x===v)===void 0}(h,d.clipScope)}function bb(d,i){return d.x-i.x||d.y-i.y}function BL(d,i){return bb(d.min,i.min)===0&&bb(d.max,i.max)===0}function FT(d,i){return!(d.min.x>i.max.x||d.max.x<i.min.x||d.min.y>i.max.y||d.max.y<i.min.y)}function NT(d,i){if(d.length!==i.length)return!1;for(let l=0;l<d.length;l++)if(d[l].sourceId!==i[l].sourceId||!BL(d[l],i[l])||d[l].order!==i[l].order||d[l].clipMask!==i[l].clipMask||!gt(d[l].clipScope,i[l].clipScope))return!1;return!0}function jL(d,i,l){const h=1/Nn,v=1/(1<<l.canonical.z),p=(i.x*h+l.canonical.x)*v+l.wrap,x=(i.y*h+l.canonical.y)*v;return{min:new st((d.x*h+l.canonical.x)*v+l.wrap,(d.y*h+l.canonical.y)*v),max:new st(p,x)}}function rU(d,i,l){const h=1<<l.canonical.z,v=((i.x-l.wrap)*h-l.canonical.x)*Nn,p=(i.y*h-l.canonical.y)*Nn;return{min:new st(((d.x-l.wrap)*h-l.canonical.x)*Nn,(d.y*h-l.canonical.y)*Nn),max:new st(v,p)}}function VL(d,i,l,h,v,p,x){const M=d.indices,z=d.vertices,V=[];for(let E=h;E<h+v;E+=3){const L=i[l[E+0]+p],B=i[l[E+1]+p],O=i[l[E+2]+p],F=Math.min(L.x,B.x,O.x),G=Math.max(L.x,B.x,O.x),Q=Math.min(L.y,B.y,O.y),ie=Math.max(L.y,B.y,O.y);V.length=0,d.grid.query(new st(F,Q),new st(G,ie),V);for(let pe=0;pe<V.length;pe++){const ge=V[pe];if(Hi(z[M[3*ge+0]],z[M[3*ge+1]],z[M[3*ge+2]],L,B,O,x))return!0}}return!1}function $L(d,i,l,h){if(!d||!l)return!1;let v=d.vertices;if(!i.canonical.equals(h.canonical)||i.wrap!==h.wrap){if(l.vertices.length<d.vertices.length)return $L(l,h,d,i);const p=i.canonical,x=h.canonical,M=Math.pow(2,x.z-p.z);v=d.vertices.map(z=>new st((z.x+p.x*Nn)*M-x.x*Nn,(z.y+p.y*Nn)*M-x.y*Nn))}return VL(l,v,d.indices,0,d.indices.length,0,0)}function UL(d,i,l,h){const v=Math.pow(2,h.z-l.z);return new st((d+l.x*Nn)*v-h.x*Nn,(i+l.y*Nn)*v-h.y*Nn)}function GL(d,i){const l=[];i.grid.queryPoint(d,l);const h=i.indices,v=i.vertices;for(let p=0;p<l.length;p++){const x=l[p];if(ao([v[h[3*x+0]],v[h[3*x+1]],v[h[3*x+2]]],d))return!0}return!1}const BT=[new st(0,0),new st(Nn,0),new st(Nn,Nn),new st(0,Nn)];function HL(d,i){const l=[];let h=[];if(!i||d.length<2)return[d];if(d.length===2)return is(d[0],d[1],BT)?[d]:[];for(let v=0;v<d.length+2;v++){const p=d[v%d.length],x=d[(v+1)%d.length],M=is(v===0?d[d.length-1]:d[(v-1)%d.length],p,BT),z=is(p,x,BT),V=M||z;V&&h.push(p),V&&z||h.length>0&&(h.length>1&&l.push(h),h=[])}return h.length>1&&l.push(h),l}const jT=Sg.VectorTileFeature.types,iU=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius","fill-extrusion-line-width","fill-extrusion-emissive-strength"],oU=["fill-extrusion-flood-light-ground-radius"],sU=Math.pow(2,13),aU=Math.pow(2,15)-1,WL=new st(0,1),yf=2147483648;function T_(d,i,l,h,v,p,x,M){d.emplaceBack((i<<1)+x,(l<<1)+p,(Math.floor(h*sU)<<1)+v,Math.round(M))}function I_(d,i,l){d.emplaceBack(i.x*Nn,i.y*Nn,l?1:0)}function wb(d,i,l,h,v,p){d.emplaceBack(i.x,i.y,(l.x<<1)+h,(l.y<<1)+v,p)}function k_(d,i,l){d.emplaceBack(i.x,i.y,i.z,l[0]*16384,l[1]*16384,l[2]*16384)}class qL{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class XL{constructor(){this.centroidXY=new st(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new st(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new st(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new st(this.max.x-this.min.x,this.max.y-this.min.y)}}class YL{constructor(){this.acc=new st(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(i,l){i.min.x===Number.MAX_VALUE&&(i.min.x=i.max.x=l.x,i.min.y=i.max.y=l.y)}appendEdge(i,l,h){this.accCount++,this.acc._add(l);let v=!!this.borders;l.x<i.min.x?(i.min.x=l.x,v=!0):l.x>i.max.x&&(i.max.x=l.x,v=!0),l.y<i.min.y?(i.min.y=l.y,v=!0):l.y>i.max.y&&(i.max.y=l.y,v=!0),((l.x===0||l.x===Nn)&&l.x===h.x)!=((l.y===0||l.y===Nn)&&l.y===h.y)&&this.processBorderOverlap(l,h),v&&this.checkBorderIntersection(l,h)}checkBorderIntersection(i,l){l.x<0!=i.x<0&&this.addBorderIntersection(0,sr(l.y,i.y,(0-l.x)/(i.x-l.x))),l.x>Nn!=i.x>Nn&&this.addBorderIntersection(1,sr(l.y,i.y,(Nn-l.x)/(i.x-l.x))),l.y<0!=i.y<0&&this.addBorderIntersection(2,sr(l.x,i.x,(0-l.y)/(i.y-l.y))),l.y>Nn!=i.y>Nn&&this.addBorderIntersection(3,sr(l.x,i.x,(Nn-l.y)/(i.y-l.y)))}addBorderIntersection(i,l){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const h=this.borders[i];l<h[0]&&(h[0]=l),l>h[1]&&(h[1]=l)}processBorderOverlap(i,l){if(i.x===l.x){if(i.y===l.y)return;const h=i.x===0?0:1;this.addBorderIntersection(h,l.y),this.addBorderIntersection(h,i.y)}else{const h=i.y===0?2:3;this.addBorderIntersection(h,l.x),this.addBorderIntersection(h,i.x)}}centroid(){return this.accCount===0?new st(0,0):new st(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((i,l)=>i+ +(l[0]!==Number.MAX_VALUE),0):0}}function ZL(d,i){const l=d.add(i)._unit(),h=Wt(d.x*l.x+d.y*l.y,-1,1);var v,p,x;return x=Math.acos(h),Math.min(4,Math.max(-4,Math.tan(x)))/4*aU*((v=d).x*(p=i).y-v.y*p.x<0?-1:1)}const lU=[d=>d.x<0,d=>d.x>Nn,d=>d.y<0,d=>d.y>Nn];function uU(d,i,l,h){const v=[4];if(h===0)return v;l._mult(h);const p=d.sub(l),x=i.sub(l),M=[d,i,p,x];for(let z=0;z<4;z++)for(const V of M)if(lU[z](V)){v.push(z);break}return v}class KL{constructor(i){this.vertexArray=new hg,this.indexArray=new sa,this.programConfigurations=new bd(i.layers,{zoom:i.zoom,lut:i.lut},l=>oU.includes(l)),this._segments=new No,this.hiddenByLandmarkVertexArray=new gg,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new No}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(i,l,h,v=!1){const p=i.length;if(p>2){let x=Math.max(0,this._segments.get().length-1);const M=this._segments._prepareSegment(4*p,this.vertexArray.length,2*this._segmentToGroundQuads[x].length);let z;x!==this._segments.get().length-1&&(x++,this._segmentToGroundQuads[x]=[],this._segmentToRegionTriCounts[x]=[0,0,0,0,0]);{const V=i[0],E=i[1];z=ZL(V.sub(i[p-1])._perp()._unit(),E.sub(V)._perp()._unit())}for(let V=0;V<p;V++){const E=V===p-1?0:V+1,L=i[V],B=i[E],O=i[E===p-1?0:E+1],F=B.sub(L)._perp()._unit(),G=ZL(F,O.sub(B)._perp()._unit()),Q=z,ie=G;if(VT(L,B,l)||v&&eR(L,l)&&eR(B,l)){z=G;continue}const pe=M.vertexLength;wb(this.vertexArray,L,B,1,1,Q),wb(this.vertexArray,L,B,1,0,Q),wb(this.vertexArray,L,B,0,1,ie),wb(this.vertexArray,L,B,0,0,ie),M.vertexLength+=4;const ge=uU(L,B,F,h);for(const ae of ge)this._segmentToGroundQuads[x].push({id:pe,region:ae}),this._segmentToRegionTriCounts[x][ae]+=2,M.primitiveLength+=2;z=G}}}prepareBorderSegments(){if(!this.hasData())return;const i=this._segments.get(),l=i.length;for(let h=0;h<l;h++)this._segmentToGroundQuads[h].sort((v,p)=>v.region-p.region);for(let h=0;h<l;h++){const v=this._segmentToGroundQuads[h],p=i[h],x=this._segmentToRegionTriCounts[h];x.reduce((z,V)=>z+V,0);let M=0;for(let z=0;z<=4;z++){const V=x[z];if(V!==0){let E=this.regionSegments[z];E||(E=this.regionSegments[z]=new No);const L={vertexOffset:p.vertexOffset,primitiveOffset:p.primitiveOffset+M,vertexLength:p.vertexLength,primitiveLength:V};E.get().push(L)}M+=V}for(let z=0;z<v.length;z++){const V=v[z].id;this.indexArray.emplaceBack(V,V+1,V+3),this.indexArray.emplaceBack(V,V+3,V+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(i,l,h,v,p,x){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,i,l,h,v,p,x)}upload(i){this.hasData()&&(this.vertexBuffer=i.createVertexBuffer(this.vertexArray,K$.members),this.indexBuffer=i.createIndexBuffer(this.indexArray))}uploadPaintProperties(i){this.hasData()&&this.programConfigurations.upload(i)}update(i,l,h,v,p,x){this.hasData()&&this.programConfigurations.updatePaintArrays(i,l,h,v,p,x)}updateHiddenByLandmark(i){if(!this.hasData())return;const l=i.groundVertexCount+i.groundVertexArrayOffset;if(i.groundVertexCount===0)return;const h=i.flags&yf?1:0;for(let v=i.groundVertexArrayOffset;v<l;++v)this.hiddenByLandmarkVertexArray.emplace(v,h);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(i){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=i.createVertexBuffer(this.hiddenByLandmarkVertexArray,eU.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let i=0;i<=4;i++){const l=this.regionSegments[i];l&&l.destroy()}}}}class Sb{constructor(i){this.zoom=i.zoom,this.canonical=i.canonical,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(l=>l.fqid),this.index=i.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=i.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new sa,this.footprintVertices=new yd,this.footprintSegments=[],this.layoutVertexArray=new _d,this.centroidVertexArray=new ib,this.wallVertexArray=new m_,this.indexArray=new sa,this.programConfigurations=new bd(i.layers,{zoom:i.zoom,lut:i.lut},l=>iU.includes(l)),this.segments=new No,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.groundEffect=new KL(i),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[]}updateFootprints(i,l){}populate(i,l,h,v){this.features=[],this.hasPattern=PT("fill-extrusion",this.layers,l),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=vt(h),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter,this.wallMode=this.layers[0].paint.get("fill-extrusion-line-width").constantOr(1)!==0;for(const{feature:p,id:x,index:M,sourceLayerIndex:z}of i){const V=this.layers[0]._featureFilter.needGeometry,E=An(p,V);if(!this.layers[0]._featureFilter.filter(new Fo(this.zoom),E,h))continue;const L={id:x,sourceLayerIndex:z,index:M,geometry:V?E.geometry:In(p,h,v),properties:p.properties,type:p.type,patterns:{}},B=this.layoutVertexArray.length,O=jT[L.type]==="Polygon";if(this.hasPattern)this.features.push(AT("fill-extrusion",this.layers,L,this.zoom,l));else if(this.wallMode)for(const F of L.geometry)for(const G of HL(F,O))this.addFeature(L,[G],M,h,{},l.availableImages,v,l.brightness);else this.addFeature(L,L.geometry,M,h,{},l.availableImages,v,l.brightness);l.featureIndex.insert(p,L.geometry,M,z,this.index,B)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(i,l,h,v,p,x){for(const M of this.features){const z=jT[M.type]==="Polygon",{geometry:V}=M;if(this.wallMode)for(const E of V)for(const L of HL(E,z))this.addFeature(M,[L],M.index,l,h,v,p,x);else this.addFeature(M,V,M.index,l,h,v,p,x)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(i,l,h,v,p){const x=Object.keys(i).length!==0;if(x&&!this.stateDependentLayers.length)return;const M=x?this.stateDependentLayers:this.layers;this.programConfigurations.updatePaintArrays(i,l,M,h,v,p),this.groundEffect.update(i,l,M,h,v,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,nU),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.wallVertexBuffer=i.createVertexBuffer(this.wallVertexArray,Q$.members),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=i.createVertexBuffer(this.layoutVertexExtArray,tU.members,!0)),this.groundEffect.upload(i)),this.groundEffect.uploadPaintProperties(i),this.programConfigurations.upload(i),this.uploaded=!0}uploadCentroid(i){this.groundEffect.uploadHiddenByLandmark(i),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=i.createVertexBuffer(this.centroidVertexArray,J$.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(i,l,h,v,p,x,M,z){const V=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(i,{})/this.tileToMeter,E=[new st(0,0),new st(Nn,Nn)],L=M.projection,B=L.name==="globe",O=this.wallMode||jT[i.type]==="Polygon",F=new YL;F.centroidDataIndex=this.centroidData.length;const G=new XL,Q=this.layers[0].paint.get("fill-extrusion-base").evaluate(i,{},v)<=0,ie=this.layers[0].paint.get("fill-extrusion-height").evaluate(i,{},v);let pe;if(G.height=ie,G.vertexArrayOffset=this.layoutVertexArray.length,G.groundVertexArrayOffset=this.groundEffect.vertexArray.length,B&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new fg),this.wallMode){if(B)return void vr("Non zero fill-extrusion-line-width is not yet supported on globe.");if(l.length!==1)return;pe=function(He){const ct=He[0].x===He[He.length-1].x&&He[0].y===He[He.length-1].y;(function(kn){let vn=0;const br=kn.length;for(let Zn=0;Zn<br;Zn++)vn+=(kn[(Zn+1)%br].x-kn[Zn].x)*(kn[(Zn+1)%br].y+kn[Zn].y);return vn>=0})(He)||(He=He.reverse());const pt={geometry:[],joinNormals:[],indices:[]},St=[],Tt=[],It=[];let Lt=He.length;if(Lt<(ct?3:2))return pt;for(;Lt>=2&&He[Lt-1].equals(He[Lt-2]);)Lt--;let Yt,Rt,ln,gn,Qt,Qn=0;for(;Qn<Lt-1&&He[Qn].equals(He[Qn+1]);)Qn++;ct&&(Yt=He[Lt-2],Qt=He[Qn].sub(Yt)._unit()._perp());for(let kn=Qn;kn<Lt;kn++){if(ln=kn===Lt-1?ct?He[Qn+1]:void 0:He[kn+1],ln&&He[kn].equals(ln))continue;Qt&&(gn=Qt),Yt&&(Rt=Yt),Yt=He[kn],Qt=ln?ln.sub(Yt)._unit()._perp():gn,gn=gn||Qt;let vn=gn.add(Qt);vn.x===0&&vn.y===0||vn._unit();const br=vn.x*Qt.x+vn.y*Qt.y,Zn=br!==0?1/br:1/0,nr=gn.x*Qt.y-gn.y*Qt.x>0;let Br="miter";const ri=2;Br==="miter"&&Zn>ri&&(Br="bevel"),Br==="bevel"&&(Zn>100&&(Br="flipbevel"),Zn<ri&&(Br="miter"));const Xr=(Yr,si,li,Xi)=>{const Di=new st(Yr.x,Yr.y),jr=new st(Yr.x,Yr.y);Di.x+=si.x*Xi,Di.y+=si.y*Xi,jr.x-=si.x*Math.max(li,1),jr.y-=si.y*Math.max(li,1),It.push(si),St.push(Di),Tt.push(jr)};if(Br==="miter")vn._mult(Zn),Xr(Yt,vn,0,0);else if(Br==="flipbevel")vn=Qt.mult(-1),Xr(Yt,vn,0,0),Xr(Yt,vn.mult(-1),0,0);else{const Yr=-Math.sqrt(Zn*Zn-1),si=nr?Yr:0,li=nr?0:Yr;Rt&&Xr(Yt,gn,si,li),ln&&Xr(Yt,Qt,si,li)}}pt.geometry=[...St,...Tt.reverse(),St[0]],pt.joinNormals=[...It,...It.reverse(),It[It.length-1]];const $n=pt.geometry.length-1;for(let kn=0;kn<$n/2;kn++)if(kn+1<$n/2){let vn=kn,br=kn+1,Zn=$n-1-kn,nr=$n-2-kn;vn=vn===0?$n-1:vn-1,br=br===0?$n-1:br-1,Zn=Zn===0?$n-1:Zn-1,nr=nr===0?$n-1:nr-1,pt.indices.push(Zn),pt.indices.push(br),pt.indices.push(vn),pt.indices.push(Zn),pt.indices.push(nr),pt.indices.push(br)}return pt}(l[0]),l=[pe.geometry]}const ge=(He,ct)=>He<(ct.length-1)/2||He===ct.length-1,ae=this.wallMode?[l]:yb(l,500);for(let He=ae.length-1;He>=0;He--){const ct=ae[He];(ct.length===0||(be=ct[0]).every(Qe=>Qe.x<=0)||be.every(Qe=>Qe.x>=Nn)||be.every(Qe=>Qe.y<=0)||be.every(Qe=>Qe.y>=Nn))&&ae.splice(He,1)}var be;let Te;if(B)Te=iR(ae,E,v);else{Te=[];for(const He of ae)Te.push({polygon:He,bounds:E})}const Be=O?this.edgeRadius:0,Xe=Be>0&&this.zoom<17,Ze=(He,ct)=>{if(He.length===0)return!1;const Qe=He[He.length-1];return ct.x===Qe.x&&ct.y===Qe.y};for(const{polygon:He,bounds:ct}of Te){let Qe=0,pt=0;for(const Lt of He)O&&!Lt[0].equals(Lt[Lt.length-1])&&Lt.push(Lt[0]),pt+=O?Lt.length-1:Lt.length;const St=this.segments.prepareSegment((O?5:4)*pt,this.layoutVertexArray,this.indexArray);G.footprintSegIdx<0&&(G.footprintSegIdx=this.footprintSegments.length),G.polygonSegIdx<0&&(G.polygonSegIdx=this.polygonSegments.length);const Tt={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},It=new qL;if(It.vertexOffset=this.footprintVertices.length,It.indexOffset=3*this.footprintIndices.length,It.ringIndices=[],O){const Lt=[],Yt=[];Qe=St.vertexLength;for(let ln=0;ln<He.length;ln++){const gn=He[ln];gn.length&&ln!==0&&Yt.push(Lt.length/2);const Qt=[];let Qn,$n;Qn=gn[1].sub(gn[0])._perp()._unit(),It.ringIndices.push(gn.length-1);for(let kn=1;kn<gn.length;kn++){const vn=gn[kn],br=gn[kn===gn.length-1?1:kn+1],Zn=vn.clone();if(Be){$n=br.sub(vn)._perp()._unit();const nr=Qn.add($n)._unit(),Br=Be*Math.min(4,1/(Qn.x*nr.x+Qn.y*nr.y));Zn.x+=Br*nr.x,Zn.y+=Br*nr.y,Zn.x=Math.round(Zn.x),Zn.y=Math.round(Zn.y),Qn=$n}if(!Q||Be!==0&&!Xe||Ze(Qt,Zn)||Qt.push(Zn),T_(this.layoutVertexArray,Zn.x,Zn.y,0,0,1,1,0),this.wallMode){const nr=ge(kn,gn);I_(this.wallVertexArray,pe.joinNormals[kn],!nr)}St.vertexLength++,this.footprintVertices.emplaceBack(vn.x,vn.y),Lt.push(vn.x,vn.y),B&&k_(this.layoutVertexExtArray,L.projectTilePoint(Zn.x,Zn.y,v),L.upVector(v,Zn.x,Zn.y))}Q&&(Be===0||Xe)&&(Qt.length!==0&&Ze(Qt,Qt[0])&&Qt.pop(),this.groundEffect.addData(Qt,ct,V))}const Rt=this.wallMode?pe.indices:w_(Lt,Yt);for(let ln=0;ln<Rt.length;ln+=3)this.footprintIndices.emplaceBack(It.vertexOffset+Rt[ln+0],It.vertexOffset+Rt[ln+1],It.vertexOffset+Rt[ln+2]),this.indexArray.emplaceBack(Qe+Rt[ln],Qe+Rt[ln+2],Qe+Rt[ln+1]),St.primitiveLength++;It.indexCount+=Rt.length,It.vertexCount+=this.footprintVertices.length-It.vertexOffset}for(let Lt=0;Lt<He.length;Lt++){const Yt=He[Lt];F.startRing(G,Yt[0]);let Rt=Yt.length>4&&tR(Yt[Yt.length-2],Yt[0],Yt[1]),ln=Be?cU(Yt[Yt.length-2],Yt[0],Yt[1],Be):0;const gn=[];let Qt,Qn,$n;Qn=Yt[1].sub(Yt[0])._perp()._unit();let kn=!0;for(let vn=1,br=0;vn<Yt.length;vn++){let Zn=Yt[vn-1],nr=Yt[vn];const Br=Yt[vn===Yt.length-1?1:vn+1];if(F.appendEdge(G,nr,Zn),VT(nr,Zn,ct)){Be&&(Qn=Br.sub(nr)._perp()._unit(),kn=!kn);continue}const ri=nr.sub(Zn)._perp(),Xr=ri.x/(Math.abs(ri.x)+Math.abs(ri.y)),Yr=ri.y>0?1:0,si=Zn.dist(nr);if(br+si>32768&&(br=0),Be){$n=Br.sub(nr)._perp()._unit();let jr=QL(Zn,nr,Br,JL(Qn,$n),Be);isNaN(jr)&&(jr=0);const Ii=nr.sub(Zn)._unit();Zn=Zn.add(Ii.mult(ln))._round(),nr=nr.add(Ii.mult(-jr))._round(),ln=jr,Qn=$n,Q&&this.zoom>=17&&(Ze(gn,Zn)||gn.push(Zn),Ze(gn,nr)||gn.push(nr))}const li=St.vertexLength,Xi=Yt.length>4&&tR(Zn,nr,Br);let Di=nR(br,Rt,kn);if(T_(this.layoutVertexArray,Zn.x,Zn.y,Xr,Yr,0,0,Di),T_(this.layoutVertexArray,Zn.x,Zn.y,Xr,Yr,0,1,Di),this.wallMode){const jr=ge(vn-1,Yt),Ii=pe.joinNormals[vn-1];I_(this.wallVertexArray,Ii,jr),I_(this.wallVertexArray,Ii,jr)}if(br+=si,Di=nR(br,Xi,!kn),Rt=Xi,T_(this.layoutVertexArray,nr.x,nr.y,Xr,Yr,0,0,Di),T_(this.layoutVertexArray,nr.x,nr.y,Xr,Yr,0,1,Di),this.wallMode){const jr=ge(vn,Yt),Ii=pe.joinNormals[vn];I_(this.wallVertexArray,Ii,jr),I_(this.wallVertexArray,Ii,jr)}if(St.vertexLength+=4,this.indexArray.emplaceBack(li+0,li+1,li+2),this.indexArray.emplaceBack(li+1,li+3,li+2),St.primitiveLength+=2,Be){const jr=Qe+(vn===1?Yt.length-2:vn-2),Ii=vn===1?Qe:jr+1;if(this.indexArray.emplaceBack(li+1,jr,li+3),this.indexArray.emplaceBack(jr,Ii,li+3),St.primitiveLength+=2,Qt===void 0&&(Qt=li),!VT(Br,Yt[vn],ct)){const Ai=vn===Yt.length-1?Qt:St.vertexLength;this.indexArray.emplaceBack(li+2,li+3,Ai),this.indexArray.emplaceBack(li+3,Ai+1,Ai),this.indexArray.emplaceBack(li+3,Ii,Ai+1),St.primitiveLength+=3}kn=!kn}if(B){const jr=this.layoutVertexExtArray,Ii=L.projectTilePoint(Zn.x,Zn.y,v),Ai=L.projectTilePoint(nr.x,nr.y,v),lo=L.upVector(v,Zn.x,Zn.y),Jo=L.upVector(v,nr.x,nr.y);k_(jr,Ii,lo),k_(jr,Ii,lo),k_(jr,Ai,Jo),k_(jr,Ai,Jo)}}O&&(Qe+=Yt.length-1),Q&&Be&&this.zoom>=17&&(gn.length!==0&&Ze(gn,gn[0])&&gn.pop(),this.groundEffect.addData(gn,ct,V,Be>0))}this.footprintSegments.push(It),Tt.triangleCount=this.indexArray.length-Tt.triangleArrayOffset,this.polygonSegments.push(Tt),++G.footprintSegLen,++G.polygonSegLen}if(G.vertexCount=this.layoutVertexArray.length-G.vertexArrayOffset,G.groundVertexCount=this.groundEffect.vertexArray.length-G.groundVertexArrayOffset,G.vertexCount!==0){if(G.centroidXY=F.borders?WL:this.encodeCentroid(F,G),this.centroidData.push(G),F.borders){this.featuresOnBorder.push(F);const He=this.featuresOnBorder.length-1;for(let ct=0;ct<F.borders.length;ct++)F.borders[ct][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[ct].push(He)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,h,p,x,v,z),this.groundEffect.addPaintPropertiesData(i,h,p,x,v,z),this.maxHeight=Math.max(this.maxHeight,ie)}}sortBorders(){for(let i=0;i<this.borderFeatureIndices.length;i++)this.borderFeatureIndices[i].sort((l,h)=>this.featuresOnBorder[l].borders[i][0]-this.featuresOnBorder[h].borders[i][0])}splitToSubtiles(){const i=[];for(let M=0;M<this.centroidData.length;M++){const z=this.centroidData[M],V=+(z.min.y+z.max.y>Nn),E=2*V+(+(z.min.x+z.max.x>Nn)^V);for(let L=0;L<z.polygonSegLen;L++){const B=z.polygonSegIdx+L;i.push({centroidIdx:M,subtile:E,polygonSegmentIdx:B,triangleSegmentIdx:this.polygonSegments[B].triangleSegIdx})}}const l=new sa;i.sort((M,z)=>M.triangleSegmentIdx===z.triangleSegmentIdx?M.subtile-z.subtile:M.triangleSegmentIdx-z.triangleSegmentIdx);let h=0,v=0,p=0;for(const M of i){if(M.triangleSegmentIdx!==h)break;p++}const x=i.length;for(;v!==i.length;){h=i[v].triangleSegmentIdx;let M=0,z=v,V=v;for(let E=z;E<p&&i[E].subtile===M;E++)V++;for(;z!==p;){const E=i[z];M=E.subtile;const L=this.centroidData[E.centroidIdx].min.clone(),B=this.centroidData[E.centroidIdx].max.clone(),O={vertexOffset:this.segments.segments[h].vertexOffset,primitiveOffset:l.length,vertexLength:this.segments.segments[h].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let F=z;F<V;F++){const G=i[F],Q=this.polygonSegments[G.polygonSegmentIdx],ie=this.centroidData[G.centroidIdx].min,pe=this.centroidData[G.centroidIdx].max,ge=this.indexArray.uint16;for(let ae=Q.triangleArrayOffset;ae<Q.triangleArrayOffset+Q.triangleCount;ae++)l.emplaceBack(ge[3*ae],ge[3*ae+1],ge[3*ae+2]);O.primitiveLength+=Q.triangleCount,L.x=Math.min(L.x,ie.x),L.y=Math.min(L.y,ie.y),B.x=Math.max(B.x,pe.x),B.y=Math.max(B.y,pe.y)}O.primitiveLength>0&&this.triangleSubSegments.push({segment:O,min:L,max:B}),z=V;for(let F=z;F<p&&i[F].subtile===i[z].subtile;F++)V++}v=p;for(let E=v;E<x&&i[E].triangleSegmentIdx===i[v].triangleSegmentIdx;E++)p++}l._trim(),this.indexArray=l}getVisibleSegments(i,l,h){const v=new No;if(this.wallMode){for(const G of this.triangleSubSegments)v.segments.push(G.segment);return v}let p=0,x=0;const M=1<<i.canonical.z;if(l){const G=l.getMinMaxForTile(i);G&&(p=G.min,x=G.max)}x+=this.maxHeight;const z=i.toUnwrapped();let V;const E=[z.canonical.x/M+z.wrap,z.canonical.y/M],L=[(z.canonical.x+1)/M+z.wrap,(z.canonical.y+1)/M],B=(G,Q,ie)=>[G[0]*(1-ie[0])+Q[0]*ie[0],G[1]*(1-ie[1])+Q[1]*ie[1]],O=[],F=[];for(const G of this.triangleSubSegments){O[0]=G.min.x/Nn,O[1]=G.min.y/Nn,F[0]=G.max.x/Nn,F[1]=G.max.y/Nn;const Q=B(E,L,O),ie=B(E,L,F);if(new ro([Q[0],Q[1],p],[ie[0],ie[1],x]).intersectsPrecise(h)===0){V&&(v.segments.push(V),V=void 0);continue}const pe=G.segment;V&&V.vertexOffset!==pe.vertexOffset&&(v.segments.push(V),V=void 0),V?(V.vertexLength+=pe.vertexLength,V.primitiveLength+=pe.primitiveLength):V={vertexOffset:pe.vertexOffset,primitiveLength:pe.primitiveLength,vertexLength:pe.vertexLength,primitiveOffset:pe.primitiveOffset,sortKey:void 0,vaos:{}}}return V&&v.segments.push(V),v}encodeCentroid(i,l){const h=i.centroid(),v=l.span(),p=Math.min(7,Math.round(v.x*this.tileToMeter/10)),x=Math.min(7,Math.round(v.y*this.tileToMeter/10));return new st(Wt(h.x,1,Nn-1)<<3|p,Wt(h.y,1,Nn-1)<<3|x)}encodeBorderCentroid(i){if(!i.borders)return new st(0,0);const l=i.borders,h=Number.MAX_VALUE;if(l[0][0]!==h||l[1][0]!==h){const v=l[0][0]!==h?0:1;return new st(6|(l[0][0]!==h?0:65528),(l[v][0]+l[v][1])/2<<3|6)}{const v=l[2][0]!==h?2:3;return new st((l[v][0]+l[v][1])/2<<3|6,6|(l[2][0]!==h?0:65528))}}showCentroid(i){const l=this.centroidData[i.centroidDataIndex];l.flags&=yf,l.centroidXY.x=0,l.centroidXY.y=0,this.writeCentroidToBuffer(l)}writeCentroidToBuffer(i){this.groundEffect.updateHiddenByLandmark(i);const l=i.vertexArrayOffset,h=i.vertexCount+i.vertexArrayOffset,v=i.flags&yf?WL:i.centroidXY,p=this.centroidVertexArray.geta_centroid_pos0(l);if(this.centroidVertexArray.geta_centroid_pos1(l)!==v.y||p!==v.x){for(let x=l;x<h;++x)this.centroidVertexArray.emplace(x,v.x,v.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const i of this.centroidData)this.writeCentroidToBuffer(i)}updateReplacement(i,l,h){if(l.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=l.updateTime;const v=l.getReplacementRegionsForTile(i.toUnwrapped());if(NT(this.activeReplacements,v))return;if(this.activeReplacements=v,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const x of this.centroidData)x.flags&=2147483647;const p=[];for(const x of this.activeReplacements){if(x.order<h)continue;const M=Math.pow(2,x.footprintTileId.canonical.z-i.canonical.z);for(const z of this.centroidData)if(!(z.flags&yf||x.min.x>z.max.x||z.min.x>x.max.x||x.min.y>z.max.y||z.min.y>x.max.y))for(let V=0;V<z.footprintSegLen;V++){const E=this.footprintSegments[z.footprintSegIdx+V];if(p.length=0,dU(this.footprintVertices,E.vertexOffset,E.vertexCount,x.footprintTileId.canonical,i.canonical,p),VL(x.footprint,p,this.footprintIndices.uint16,E.indexOffset,E.indexCount,-E.vertexOffset,-M)){z.flags|=yf;break}}}for(const x of this.centroidData)this.writeCentroidToBuffer(x);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(i,l,h){let v=!1;for(let p=0;p<h.footprintSegLen;p++){const x=this.footprintSegments[h.footprintSegIdx+p];let M=0;for(const z of x.ringIndices){for(let V=M,E=z+M-1;V<z+M;E=V++){const L=this.footprintVertices.int16[2*(V+x.vertexOffset)+0],B=this.footprintVertices.int16[2*(V+x.vertexOffset)+1],O=this.footprintVertices.int16[2*(E+x.vertexOffset)+1];B>l!=O>l&&i<(this.footprintVertices.int16[2*(E+x.vertexOffset)+0]-L)*(l-B)/(O-B)+L&&(v=!v)}M=z}}return v}getHeightAtTileCoord(i,l){let h=Number.NEGATIVE_INFINITY,v=!0;const p=4*(i+Nn)*Nn+(l+Nn);if(this.partLookup.hasOwnProperty(p)){const x=this.partLookup[p];return x?{height:x.height,hidden:!!(x.flags&yf)}:void 0}for(const x of this.centroidData)i>x.max.x||x.min.x>i||l>x.max.y||x.min.y>l||this.footprintContainsPoint(i,l,x)&&x&&x.height>h&&(h=x.height,this.partLookup[p]=x,v=!!(x.flags&yf));if(h!==Number.NEGATIVE_INFINITY)return{height:h,hidden:v};this.partLookup[p]=void 0}}function JL(d,i){const l=d.add(i)._unit();return d.x*l.x+d.y*l.y}function cU(d,i,l,h){const v=i.sub(d)._perp()._unit(),p=l.sub(i)._perp()._unit();return QL(d,i,l,JL(v,p),h)}function QL(d,i,l,h,v){const p=Math.sqrt(1-h*h);return Math.min(d.dist(i)/3,i.dist(l)/3,v*p/h)}function VT(d,i,l){return d.x<l[0].x&&i.x<l[0].x||d.x>l[1].x&&i.x>l[1].x||d.y<l[0].y&&i.y<l[0].y||d.y>l[1].y&&i.y>l[1].y}function eR(d,i){return d.x<i[0].x||d.x>i[1].x||d.y<i[0].y||d.y>i[1].y}function tR(d,i,l){if(d.x<0||d.x>=Nn||i.x<0||i.x>=Nn||l.x<0||l.x>=Nn)return!1;const h=l.sub(i),v=h.perp(),p=d.sub(i);return(h.x*p.x+h.y*p.y)/Math.sqrt((h.x*h.x+h.y*h.y)*(p.x*p.x+p.y*p.y))>-.866&&v.x*p.x+v.y*p.y<0}function nR(d,i,l){const h=i?2|d:-3&d;return l?1|h:-2&h}function rR(){const d=Math.PI/32,i=Math.tan(d),l=ue;return l*Math.sqrt(1+2*i*i)-l}function iR(d,i,l){const h=1<<l.z,v=it(l.x/h),p=it((l.x+1)/h),x=rt(l.y/h),M=rt((l.y+1)/h);return function(z,V,E,L,B=0,O){const F=[];if(!z.length||!E||!L)return F;const G=(Te,Be)=>{for(const Xe of Te)F.push({polygon:Xe,bounds:Be})},Q=Math.ceil(Math.log2(E)),ie=Math.ceil(Math.log2(L)),pe=Q-ie,ge=[];for(let Te=0;Te<Math.abs(pe);Te++)ge.push(pe>0?0:1);for(let Te=0;Te<Math.min(Q,ie);Te++)ge.push(0),ge.push(1);let ae=z;if(ae=vb(ae,V[0].y-B,V[1].y+B,1),ae=vb(ae,V[0].x-B,V[1].x+B,0),!ae.length)return F;const be=[];for(ge.length?be.push({polygons:ae,bounds:V,depth:0}):G(ae,V);be.length;){const Te=be.pop(),Be=Te.depth,Xe=ge[Be],Ze=Te.bounds[0],He=Te.bounds[1],ct=Xe===0?Ze.x:Ze.y,Qe=Xe===0?He.x:He.y,pt=O?O(Xe,ct,Qe):.5*(ct+Qe),St=vb(Te.polygons,ct-B,pt+B,Xe),Tt=vb(Te.polygons,pt-B,Qe+B,Xe);if(St.length){const It=[Ze,new st(Xe===0?pt:He.x,Xe===1?pt:He.y)];ge.length>Be+1?be.push({polygons:St,bounds:It,depth:Be+1}):G(St,It)}if(Tt.length){const It=[new st(Xe===0?pt:Ze.x,Xe===1?pt:Ze.y),He];ge.length>Be+1?be.push({polygons:Tt,bounds:It,depth:Be+1}):G(Tt,It)}}return F}(d,i,Math.ceil((p-v)/11.25),Math.ceil((x-M)/11.25),1,(z,V,E)=>{if(z===0)return .5*(V+E);{const L=rt((l.y+V/Nn)/h);return(Je(.5*(rt((l.y+E/Nn)/h)+L))*h-l.y)*Nn}})}function dU(d,i,l,h,v,p){const x=Math.pow(2,h.z-v.z);for(let M=0;M<l;M++){let z=d.int16[2*(M+i)+0],V=d.int16[2*(M+i)+1];z=(z+v.x*Nn)*x-h.x*Nn,V=(V+v.y*Nn)*x-h.y*Nn,p.push(new st(z,V))}}let oR,sR;function M_(d,i){return d.x*i.x+d.y*i.y}function aR(d,i){if(d.length===1){let l=0;const h=i[l++];let v;for(;!v||h.equals(v);)if(v=i[l++],!v)return 1/0;for(;l<i.length;l++){const p=i[l],x=d[0],M=v.sub(h),z=p.sub(h),V=x.sub(h),E=M_(M,M),L=M_(M,z),B=M_(z,z),O=M_(V,M),F=M_(V,z),G=E*B-L*L,Q=(B*O-L*F)/G,ie=(E*F-L*O)/G,pe=h.z*(1-Q-ie)+v.z*Q+p.z*ie;if(isFinite(pe))return pe}return 1/0}{let l=1/0;for(const h of i)l=Math.min(l,h.z);return l}}function lR(d,i,l,h,v,p,x,M){const z=x*v.getElevationAt(d,i,!0,!0),V=p[0]!==0,E=V?p[1]===0?x*(p[0]/7-450):x*function(L,B,O){const F=Math.floor(B[0]/8),G=Math.floor(B[1]/8),Q=10*(B[0]-8*F),ie=10*(B[1]-8*G),pe=L.getElevationAt(F,G,!0,!0),ge=L.getMeterToDEM(O),ae=Math.floor(.5*(Q*ge-1)),be=Math.floor(.5*(ie*ge-1)),Te=L.tileCoordToPixel(F,G),Be=2*ae+1,Xe=2*be+1,Ze=function(Tt,It,Lt,Yt,Rt){return[Tt.getElevationAtPixel(It,Lt,!0),Tt.getElevationAtPixel(It+Rt,Lt,!0),Tt.getElevationAtPixel(It,Lt+Rt,!0),Tt.getElevationAtPixel(It+Yt,Lt+Rt,!0)]}(L,Te.x-ae,Te.y-be,Be,Xe),He=Math.abs(Ze[0]-Ze[1]),ct=Math.abs(Ze[2]-Ze[3]),Qe=Math.abs(Ze[0]-Ze[2])+Math.abs(Ze[1]-Ze[3]),pt=Math.min(.25,.5*ge*(He+ct)/Be),St=Math.min(.25,.5*ge*Qe/Xe);return pe+Math.max(pt*Q,St*ie)}(v,p,M):z;return{base:z+(l===0)?-1:l,top:V?Math.max(E+h,z+l+2):z+h}}ir(Sb,"FillExtrusionBucket",{omit:["layers","features"]}),ir(XL,"PartData"),ir(qL,"FootprintSegment"),ir(YL,"BorderCentroidData"),ir(KL,"GroundEffect");const hU=wi([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),fU=wi([{name:"a_z_offset",components:1,type:"Float32"}],4),{members:pU}=hU,mU=wi([{name:"a_packed",components:4,type:"Float32"}]),{members:gU}=mU,yU=wi([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:_U}=yU;class uR{constructor(i,l){this.width=i,this.height=l,this.nextRow=0,this.image=new gf({width:i,height:l}),this.positions={},this.uploaded=!1}getDash(i,l){const h=this.getKey(i,l);return this.positions[h]}trim(){const i=this.width,l=this.height=Er(this.nextRow);this.image.resize({width:i,height:l})}getKey(i,l){return i.join(",")+l}getDashRanges(i,l,h){const v=[];let p=i.length%2==1?-i[i.length-1]*h:0,x=i[0]*h,M=!0;v.push({left:p,right:x,isDash:M,zeroLength:i[0]===0});let z=i[0];for(let V=1;V<i.length;V++){M=!M;const E=i[V];p=z*h,z+=E,x=z*h,v.push({left:p,right:x,isDash:M,zeroLength:E===0})}return v}addRoundDash(i,l,h){const v=l/2;for(let p=-h;p<=h;p++){const x=this.width*(this.nextRow+h+p);let M=0,z=i[M];for(let V=0;V<this.width;V++){V/z.right>1&&(z=i[++M]);const E=Math.abs(V-z.left),L=Math.abs(V-z.right),B=Math.min(E,L);let O;const F=p/h*(v+1);if(z.isDash){const G=v-Math.abs(F);O=Math.sqrt(B*B+G*G)}else O=v-Math.sqrt(B*B+F*F);this.image.data[x+V]=Math.max(0,Math.min(255,O+128))}}}addRegularDash(i,l){for(let z=i.length-1;z>=0;--z){const V=i[z],E=i[z+1];V.zeroLength?i.splice(z,1):E&&E.isDash===V.isDash&&(E.left=V.left,i.splice(z,1))}const h=i[0],v=i[i.length-1];h.isDash===v.isDash&&(h.left=v.left-this.width,v.right=h.right+this.width);const p=this.width*this.nextRow;let x=0,M=i[x];for(let z=0;z<this.width;z++){z/M.right>1&&(M=i[++x]);const V=Math.abs(z-M.left),E=Math.abs(z-M.right),L=Math.min(V,E);this.image.data[p+z]=Math.max(0,Math.min(255,(M.isDash?L:-L)+l+128))}}addDash(i,l){const h=this.getKey(i,l);if(this.positions[h])return this.positions[h];const v=l==="round",p=v?7:0,x=2*p+1;if(this.nextRow+x>this.height)return vr("LineAtlas out of space"),null;i.length===0&&i.push(1);let M=0;for(let E=0;E<i.length;E++)i[E]<0&&(vr("Negative value is found in line dasharray, replacing values with 0"),i[E]=0),M+=i[E];if(M!==0){const E=this.width/M,L=this.getDashRanges(i,this.width,E);v?this.addRoundDash(L,E,p):this.addRegularDash(L,l==="square"?.5*E:0)}const z=this.nextRow+p;this.nextRow+=x;const V={tl:[z,p],br:[M,0]};return this.positions[h]=V,V}}ir(uR,"LineAtlas");const vU=Sg.VectorTileFeature.types,xU=Math.cos(Math.PI/180*37.5),bU=Math.cos(Math.PI/180*5);class $T{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(l=>l.fqid),this.index=i.index,this.projection=i.projection,this.hasPattern=!1,this.hasZOffset=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(l=>{this.gradients[l.id]={}}),this.layoutVertexArray=new o_,this.layoutVertexArray2=new Mc,this.patternVertexArray=new vd,this.indexArray=new sa,this.programConfigurations=new bd(i.layers,{zoom:i.zoom,lut:i.lut}),this.segments=new No,this.maxLineLength=0,this.zOffsetVertexArray=new uf,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.tessellationStep=i.tessellationStep?i.tessellationStep:Nn/64}updateFootprints(i,l){}populate(i,l,h,v){this.hasPattern=PT("line",this.layers,l);const p=this.layers[0].layout.get("line-sort-key"),x=this.layers[0].layout.get("line-z-offset");this.hasZOffset=!x.isConstant()||!!x.constantOr(0);const M=[];for(const{feature:L,id:B,index:O,sourceLayerIndex:F}of i){const G=this.layers[0]._featureFilter.needGeometry,Q=An(L,G);if(!this.layers[0]._featureFilter.filter(new Fo(this.zoom),Q,h))continue;const ie=p?p.evaluate(Q,{},h):void 0,pe={id:B,properties:L.properties,type:L.type,sourceLayerIndex:F,index:O,geometry:G?Q.geometry:In(L,h,v),patterns:{},sortKey:ie};M.push(pe)}p&&M.sort((L,B)=>L.sortKey-B.sortKey);const{lineAtlas:z,featureIndex:V}=l,E=this.addConstantDashes(z);for(const L of M){const{geometry:B,index:O,sourceLayerIndex:F}=L;if(E&&this.addFeatureDashes(L,z),this.hasPattern){const G=AT("line",this.layers,L,this.zoom,l);this.patternFeatures.push(G)}else this.addFeature(L,B,O,h,z.positions,l.availableImages,l.brightness);V.insert(i[O].feature,B,O,F,this.index)}}addConstantDashes(i){let l=!1;for(const h of this.layers){const v=h.paint.get("line-dasharray").value,p=h.layout.get("line-cap").value;if(v.kind!=="constant"||p.kind!=="constant")l=!0;else{const x=p.value,M=v.value;if(!M)continue;i.addDash(M,x)}}return l}addFeatureDashes(i,l){const h=this.zoom;for(const v of this.layers){const p=v.paint.get("line-dasharray").value,x=v.layout.get("line-cap").value;if(p.kind==="constant"&&x.kind==="constant")continue;let M,z;if(p.kind==="constant"){if(M=p.value,!M)continue}else M=p.evaluate({zoom:h},i);z=x.kind==="constant"?x.value:x.evaluate({zoom:h},i),l.addDash(M,z),i.patterns[v.id]=l.getKey(M,z)}}update(i,l,h,v,p){const x=Object.keys(i).length!==0;x&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(i,l,x?this.stateDependentLayers:this.layers,h,v,p)}addFeatures(i,l,h,v,p,x){for(const M of this.patternFeatures)this.addFeature(M,M.geometry,M.index,l,h,v,x)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=i.createVertexBuffer(this.layoutVertexArray2,gU)),this.patternVertexArray.length!==0&&(this.patternVertexBuffer=i.createVertexBuffer(this.patternVertexArray,_U)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=i.createVertexBuffer(this.zOffsetVertexArray,fU.members,!0)),this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,pU),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(i){if(i.properties&&i.properties.hasOwnProperty("mapbox_clip_start")&&i.properties.hasOwnProperty("mapbox_clip_end"))return{start:+i.properties.mapbox_clip_start,end:+i.properties.mapbox_clip_end}}addFeature(i,l,h,v,p,x,M){const z=this.layers[0].layout,V=z.get("line-join").evaluate(i,{}),E=z.get("line-cap").evaluate(i,{}),L=z.get("line-miter-limit"),B=z.get("line-round-limit");this.lineClips=this.lineFeatureClips(i);for(const O of l)this.addLine(O,i,v,V,E,L,B);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,h,p,x,v,M)}addLine(i,l,h,v,p,x,M){this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.currentVertex=void 0;const z={zoom:this.zoom,lineProgress:void 0},V=this.layers[0].layout,E=v==="none";if(this.patternJoinNone=this.hasPattern&&E,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[],this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Te=0;Te<i.length-1;Te++)this.totalDistance+=i[Te].dist(i[Te+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const L=vU[l.type]==="Polygon";let B=i.length;for(;B>=2&&i[B-1].equals(i[B-2]);)B--;let O=0;for(;O<B-1&&i[O].equals(i[O+1]);)O++;if(B<(L?3:2))return;v==="bevel"&&(x=1.05);const F=this.overscaling<=16?15*Nn/(512*this.overscaling):0,G=this.segments.prepareSegment(10*B,this.layoutVertexArray,this.indexArray);let Q,ie,pe,ge,ae,be;this.e1=this.e2=-1,L&&(Q=i[B-2],ae=i[O].sub(Q)._unit()._perp());for(let Te=O;Te<B;Te++){if(pe=Te===B-1?L?i[O+1]:void 0:i[Te+1],pe&&i[Te].equals(pe))continue;if(ae&&(ge=ae),Q&&(ie=Q),Q=i[Te],this.hasZOffset){const It=V.get("line-z-offset").value;if(It.kind==="constant")be=It.value;else{if(this.lineClips){const Lt=this.totalDistance/(this.lineClips.end-this.lineClips.start);z.lineProgress=(Lt*this.lineClips.start+this.distance+(ie?ie.dist(Q):0))/Lt}else vr(`line-z-offset evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`),z.lineProgress=0;be=It.evaluate(z,l)}be=be||0}ae=pe?pe.sub(Q)._unit()._perp():ge,ge=ge||ae;const Be=ie&&pe;let Xe=Be?v:L||E?"butt":p;const Ze=ge.x*ae.x+ge.y*ae.y;if(E){const It=function(Lt){if(Lt.patternJoinNone){const Yt=Lt.segmentPoints.length/2,Rt=Lt.lineSoFar-Lt.segmentStart;for(let ln=0;ln<Yt;++ln){const gn=Lt.segmentPoints[2*ln+1],Qt=Math.round(Lt.segmentPoints[2*ln])+.5+.25*gn;Lt.patternVertexArray.emplaceBack(Qt,Rt,Lt.segmentStart),Lt.patternVertexArray.emplaceBack(Qt,Rt,Lt.segmentStart)}Lt.segmentPoints.length=0}Lt.e1=Lt.e2=-1};if(Be&&Ze<bU){this.updateDistance(ie,Q),this.addCurrentVertex(Q,ge,1,1,G,be),It(this),this.addCurrentVertex(Q,ae,-1,-1,G,be);continue}if(ie){if(!pe){this.updateDistance(ie,Q),this.addCurrentVertex(Q,ge,1,1,G,be),It(this);continue}Xe="miter"}}let He=ge.add(ae);He.x===0&&He.y===0||He._unit();const ct=He.x*ae.x+He.y*ae.y,Qe=ct!==0?1/ct:1/0,pt=2*Math.sqrt(2-2*ct),St=ct<xU&&ie&&pe,Tt=ge.x*ae.y-ge.y*ae.x>0;if(St&&Te>O){const It=Q.dist(ie);if(It>2*F){const Lt=Q.sub(Q.sub(ie)._mult(F/It)._round());this.updateDistance(ie,Lt),this.addCurrentVertex(Lt,ge,0,0,G,be),ie=Lt}}if(Be&&Xe==="round"&&(Qe<M?Xe="miter":Qe<=2&&(Xe="fakeround")),Xe==="miter"&&Qe>x&&(Xe="bevel"),Xe==="bevel"&&(Qe>2&&(Xe="flipbevel"),Qe<x&&(Xe="miter")),ie&&this.updateDistance(ie,Q),Xe==="miter")He._mult(Qe),this.addCurrentVertex(Q,He,0,0,G,be);else if(Xe==="flipbevel"){if(Qe>100)He=ae.mult(-1);else{const It=Qe*ge.add(ae).mag()/ge.sub(ae).mag();He._perp()._mult(It*(Tt?-1:1))}this.addCurrentVertex(Q,He,0,0,G,be),this.addCurrentVertex(Q,He.mult(-1),0,0,G,be)}else if(Xe==="bevel"||Xe==="fakeround"){const It=-Math.sqrt(Qe*Qe-1),Lt=Tt?It:0,Yt=Tt?0:It;if(ie&&this.addCurrentVertex(Q,ge,Lt,Yt,G,be),Xe==="fakeround"){const Rt=Math.round(180*pt/Math.PI/20);for(let ln=1;ln<Rt;ln++){let gn=ln/Rt;if(gn!==.5){const Qn=gn-.5;gn+=gn*Qn*(gn-1)*((1.0904+Ze*(Ze*(3.55645-1.43519*Ze)-3.2452))*Qn*Qn+(.848013+Ze*(.215638*Ze-1.06021)))}const Qt=ae.sub(ge)._mult(gn)._add(ge)._unit()._mult(Tt?-1:1);this.addHalfVertex(Q,Qt.x,Qt.y,!1,Tt,0,G,be)}}pe&&this.addCurrentVertex(Q,ae,-Lt,-Yt,G,be)}else Xe==="butt"?this.addCurrentVertex(Q,He,0,0,G,be):Xe==="square"?(ie||this.addCurrentVertex(Q,He,-1,-1,G,be),this.addCurrentVertex(Q,He,0,0,G,be),ie&&this.addCurrentVertex(Q,He,1,1,G,be)):Xe==="round"&&(ie&&(this.addCurrentVertex(Q,ge,0,0,G,be),this.addCurrentVertex(Q,ge,1,1,G,be,!0)),pe&&(this.addCurrentVertex(Q,ae,-1,-1,G,be,!0),this.addCurrentVertex(Q,ae,0,0,G,be)));if(St&&Te<B-1){const It=Q.dist(pe);if(It>2*F){const Lt=Q.add(pe.sub(Q)._mult(F/It)._round());this.updateDistance(Q,Lt),this.addCurrentVertex(Lt,ae,0,0,G,be),Q=Lt}}}}addVerticesTo(i,l,h,v,p,x,M,z,V,E){const L=(l.w-i.w)/this.tessellationStep|0;if(L>1){this.lineSoFar=i.w;const B=(l.x-i.x)/L,O=(l.y-i.y)/L,F=(l.z-i.z)/L,G=(l.w-i.w)/L;for(let Q=1;Q<L;++Q)i.x+=B,i.y+=O,i.z+=F,this.lineSoFar+=G,this.addHalfVertex(i,h,v,E,!1,M,V,i.z),this.addHalfVertex(i,p,x,E,!0,-z,V,i.z)}this.lineSoFar=l.w,this.addHalfVertex(l,h,v,E,!1,M,V,l.z),this.addHalfVertex(l,p,x,E,!0,-z,V,l.z)}addCurrentVertex(i,l,h,v,p,x,M=!1){const z=l.x+l.y*h,V=l.y-l.x*h,E=l.y*v-l.x,L=-l.y-l.x*v;if(x!=null){const O=Nn+10,F=x,G=new DL(i.x,i.y,F,this.lineSoFar),Q=cR(i,-10,O),ie=this.lineSoFar;if(this.currentVertex)if(Q){const pe=this.currentVertexIsOutside,ge=this.currentVertex,ae=new DL(i.x,i.y,F,this.lineSoFar);FL(ge,ae,-10,O),cR(ae,-10,O)||(pe&&(this.e1=this.e2=-1,this.lineSoFar=ge.w,this.addHalfVertex(ge,z,V,M,!1,h,p,ge.z),this.addHalfVertex(ge,E,L,M,!0,-v,p,ge.z)),this.addVerticesTo(ge,ae,z,V,E,L,h,v,p,M))}else{const pe=this.currentVertex;this.currentVertexIsOutside&&(FL(pe,G,-10,O),this.e1=this.e2=-1,this.lineSoFar=pe.w,this.addHalfVertex(pe,z,V,M,!1,h,p,pe.z),this.addHalfVertex(pe,E,L,M,!0,-v,p,pe.z)),this.addVerticesTo(pe,G,z,V,E,L,h,v,p,M)}else Q||(this.addHalfVertex(i,z,V,M,!1,h,p,x),this.addHalfVertex(i,E,L,M,!0,-v,p,x));this.currentVertex=G,this.currentVertexIsOutside=Q,this.lineSoFar=ie}else this.addHalfVertex(i,z,V,M,!1,h,p,x),this.addHalfVertex(i,E,L,M,!0,-v,p,x)}addHalfVertex({x:i,y:l},h,v,p,x,M,z,V){this.patternJoinNone&&(this.segmentPoints.length===0&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),x||this.segmentPoints.push(this.lineSoFar-this.segmentStart,M)),this.layoutVertexArray.emplaceBack((i<<1)+(p?1:0),(l<<1)+(x?1:0),Math.round(63*h)+128,Math.round(63*v)+128,1+(M===0?0:M<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const E=z.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,E),z.primitiveLength++),x?this.e2=E:this.e1=E,V!=null&&this.zOffsetVertexArray.emplaceBack(V)}updateScaledDistance(){if(this.lineClips){const i=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=i*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(i,l){this.distance+=i.dist(l),this.updateScaledDistance()}}function cR(d,i,l){return d.x<i||d.x>l||d.y<i||d.y>l}let dR,hR;function fR(d,i,l){return i*(Nn/(d.tileSize*Math.pow(2,l-d.tileID.overscaledZ)))}function pR(d,i){return 1/fR(d,1,i.tileZoom)}function mR(d,i,l,h){return d.translatePosMatrix(h||i.tileID.projMatrix,i,l.paint.get("line-translate"),l.paint.get("line-translate-anchor"))}ir($T,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});const gR=d=>{const i=[];yR(d)&&i.push("RENDER_LINE_DASH"),d.paint.get("line-gradient")&&i.push("RENDER_LINE_GRADIENT");const l=d.paint.get("line-trim-offset");l[0]===0&&l[1]===0||i.push("RENDER_LINE_TRIM_OFFSET"),d.paint.get("line-border-width").constantOr(1)!==0&&i.push("RENDER_LINE_BORDER");const h=d.layout.get("line-join").constantOr("miter")==="none",v=!!d.paint.get("line-pattern").constantOr(1);return h&&v&&i.push("LINE_JOIN_NONE"),i};function yR(d){const i=d.paint.get("line-dasharray").value;return i.value||i.kind!=="constant"}let UT;const _R=()=>UT||(UT={layout:dR||(dR=new vo({"line-cap":new gr($t.layout_line["line-cap"]),"line-join":new gr($t.layout_line["line-join"]),"line-miter-limit":new zn($t.layout_line["line-miter-limit"]),"line-round-limit":new zn($t.layout_line["line-round-limit"]),"line-sort-key":new gr($t.layout_line["line-sort-key"]),"line-z-offset":new gr($t.layout_line["line-z-offset"]),visibility:new zn($t.layout_line.visibility)})),paint:hR||(hR=new vo({"line-opacity":new gr($t.paint_line["line-opacity"]),"line-color":new gr($t.paint_line["line-color"]),"line-translate":new zn($t.paint_line["line-translate"]),"line-translate-anchor":new zn($t.paint_line["line-translate-anchor"]),"line-width":new gr($t.paint_line["line-width"]),"line-gap-width":new gr($t.paint_line["line-gap-width"]),"line-offset":new gr($t.paint_line["line-offset"]),"line-blur":new gr($t.paint_line["line-blur"]),"line-dasharray":new gr($t.paint_line["line-dasharray"]),"line-pattern":new gr($t.paint_line["line-pattern"]),"line-gradient":new fu($t.paint_line["line-gradient"]),"line-trim-offset":new zn($t.paint_line["line-trim-offset"]),"line-trim-fade-range":new zn($t.paint_line["line-trim-fade-range"]),"line-trim-color":new zn($t.paint_line["line-trim-color"]),"line-emissive-strength":new zn($t.paint_line["line-emissive-strength"]),"line-border-width":new gr($t.paint_line["line-border-width"]),"line-border-color":new gr($t.paint_line["line-border-color"]),"line-occlusion-opacity":new zn($t.paint_line["line-occlusion-opacity"])}))},UT);class wU extends gr{possiblyEvaluate(i,l){return l=new Fo(Math.floor(l.zoom),{now:l.now,fadeDuration:l.fadeDuration,transition:l.transition}),super.possiblyEvaluate(i,l)}evaluate(i,l,h,v){return l=lr({},l,{zoom:Math.floor(l.zoom)}),super.evaluate(i,l,h,v)}}let P_;function vR(d,i){return i>0?i+2*d:d}const SU=wi([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),CU=wi([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),EU=wi([{name:"a_projected_pos",components:4,type:"Float32"}],4);wi([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const TU=wi([{name:"a_auto_z_offset",components:1,type:"Float32"}],4),IU=wi([{name:"a_texb",components:2,type:"Uint16"}]),kU=wi([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_elevation_from_sea",components:2,type:"Float32"}]),MU=wi([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_auto_z_offset",components:1,type:"Float32"}]);wi([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const xR=wi([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),PU=wi([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);wi([{name:"triangle",components:3,type:"Uint16"}]),wi([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),wi([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"}]),wi([{type:"Float32",name:"offsetX"}]),wi([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var ha=24;const Oc=128;function GT(d,i){const{expression:l}=i;if(l.kind==="constant")return{kind:"constant",layoutSize:l.evaluate(new Fo(d+1))};if(l.kind==="source")return{kind:"source"};{const{zoomStops:h,interpolationType:v}=l;let p=0;for(;p<h.length&&h[p]<=d;)p++;p=Math.max(0,p-1);let x=p;for(;x<h.length&&h[x]<d+1;)x++;x=Math.min(h.length-1,x);const M=h[p],z=h[x];return l.kind==="composite"?{kind:"composite",minZoom:M,maxZoom:z,interpolationType:v}:{kind:"camera",minZoom:M,maxZoom:z,minSize:l.evaluate(new Fo(M)),maxSize:l.evaluate(new Fo(z)),interpolationType:v}}}function Cb(d,{uSize:i,uSizeT:l},{lowerSize:h,upperSize:v}){return d.kind==="source"?h/Oc:d.kind==="composite"?sr(h/Oc,v/Oc,l):i}function Cg(d,i){let l=0,h=0;if(d.kind==="constant")h=d.layoutSize;else if(d.kind!=="source"){const{interpolationType:v,minZoom:p,maxZoom:x}=d,M=v?Wt(Cl.interpolationFactor(v,i,p,x),0,1):0;d.kind==="camera"?h=sr(d.minSize,d.maxSize,M):l=M}return{uSizeT:l,uSize:h}}var AU=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Oc,evaluateSizeForFeature:Cb,evaluateSizeForZoom:Cg,getSizeData:GT});function LU(d,i,l){return d.sections.forEach(h=>{h.text=function(v,p,x){const M=p.layout.get("text-transform").evaluate(x,{});return M==="uppercase"?v=v.toLocaleUpperCase():M==="lowercase"&&(v=v.toLocaleLowerCase()),nl.applyArabicShaping&&(v=nl.applyArabicShaping(v)),v}(h.text,i,l)}),d}const A_={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂","←":"↑","→":"↓"};function RU(d){return d==="︶"||d==="﹈"||d==="︸"||d==="﹄"||d==="﹂"||d==="︾"||d==="︼"||d==="︺"||d==="︘"||d==="﹀"||d==="︐"||d==="︓"||d==="︔"||d==="｀"||d==="￣"||d==="︑"||d==="︒"}function OU(d){return d==="︵"||d==="﹇"||d==="︷"||d==="﹃"||d==="﹁"||d==="︽"||d==="︻"||d==="︹"||d==="︗"||d==="︿"}var bR,HT,wR,WT={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function DU(){return bR||(bR=1,WT.read=function(d,i,l,h,v){var p,x,M=8*v-h-1,z=(1<<M)-1,V=z>>1,E=-7,L=l?v-1:0,B=l?-1:1,O=d[i+L];for(L+=B,p=O&(1<<-E)-1,O>>=-E,E+=M;E>0;p=256*p+d[i+L],L+=B,E-=8);for(x=p&(1<<-E)-1,p>>=-E,E+=h;E>0;x=256*x+d[i+L],L+=B,E-=8);if(p===0)p=1-V;else{if(p===z)return x?NaN:1/0*(O?-1:1);x+=Math.pow(2,h),p-=V}return(O?-1:1)*x*Math.pow(2,p-h)},WT.write=function(d,i,l,h,v,p){var x,M,z,V=8*p-v-1,E=(1<<V)-1,L=E>>1,B=v===23?Math.pow(2,-24)-Math.pow(2,-77):0,O=h?0:p-1,F=h?1:-1,G=i<0||i===0&&1/i<0?1:0;for(i=Math.abs(i),isNaN(i)||i===1/0?(M=isNaN(i)?1:0,x=E):(x=Math.floor(Math.log(i)/Math.LN2),i*(z=Math.pow(2,-x))<1&&(x--,z*=2),(i+=x+L>=1?B/z:B*Math.pow(2,1-L))*z>=2&&(x++,z/=2),x+L>=E?(M=0,x=E):x+L>=1?(M=(i*z-1)*Math.pow(2,v),x+=L):(M=i*Math.pow(2,L-1)*Math.pow(2,v),x=0));v>=8;d[l+O]=255&M,O+=F,M/=256,v-=8);for(x=x<<v|M,V+=v;V>0;d[l+O]=255&x,O+=F,x/=256,V-=8);d[l+O-F]|=128*G}),WT}function SR(){if(wR)return HT;wR=1,HT=i;var d=DU();function i(ae){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(ae)?ae:new Uint8Array(ae||0),this.pos=0,this.type=0,this.length=this.buf.length}i.Varint=0,i.Fixed64=1,i.Bytes=2,i.Fixed32=5;var l=4294967296,h=1/l,v=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function p(ae){return ae.type===i.Bytes?ae.readVarint()+ae.pos:ae.pos+1}function x(ae,be,Te){return Te?4294967296*be+(ae>>>0):4294967296*(be>>>0)+(ae>>>0)}function M(ae,be,Te){var Be=be<=16383?1:be<=2097151?2:be<=268435455?3:Math.floor(Math.log(be)/(7*Math.LN2));Te.realloc(Be);for(var Xe=Te.pos-1;Xe>=ae;Xe--)Te.buf[Xe+Be]=Te.buf[Xe]}function z(ae,be){for(var Te=0;Te<ae.length;Te++)be.writeVarint(ae[Te])}function V(ae,be){for(var Te=0;Te<ae.length;Te++)be.writeSVarint(ae[Te])}function E(ae,be){for(var Te=0;Te<ae.length;Te++)be.writeFloat(ae[Te])}function L(ae,be){for(var Te=0;Te<ae.length;Te++)be.writeDouble(ae[Te])}function B(ae,be){for(var Te=0;Te<ae.length;Te++)be.writeBoolean(ae[Te])}function O(ae,be){for(var Te=0;Te<ae.length;Te++)be.writeFixed32(ae[Te])}function F(ae,be){for(var Te=0;Te<ae.length;Te++)be.writeSFixed32(ae[Te])}function G(ae,be){for(var Te=0;Te<ae.length;Te++)be.writeFixed64(ae[Te])}function Q(ae,be){for(var Te=0;Te<ae.length;Te++)be.writeSFixed64(ae[Te])}function ie(ae,be){return(ae[be]|ae[be+1]<<8|ae[be+2]<<16)+16777216*ae[be+3]}function pe(ae,be,Te){ae[Te]=be,ae[Te+1]=be>>>8,ae[Te+2]=be>>>16,ae[Te+3]=be>>>24}function ge(ae,be){return(ae[be]|ae[be+1]<<8|ae[be+2]<<16)+(ae[be+3]<<24)}return i.prototype={destroy:function(){this.buf=null},readFields:function(ae,be,Te){for(Te=Te||this.length;this.pos<Te;){var Be=this.readVarint(),Xe=Be>>3,Ze=this.pos;this.type=7&Be,ae(Xe,be,this),this.pos===Ze&&this.skip(Be)}return be},readMessage:function(ae,be){return this.readFields(ae,be,this.readVarint()+this.pos)},readFixed32:function(){var ae=ie(this.buf,this.pos);return this.pos+=4,ae},readSFixed32:function(){var ae=ge(this.buf,this.pos);return this.pos+=4,ae},readFixed64:function(){var ae=ie(this.buf,this.pos)+ie(this.buf,this.pos+4)*l;return this.pos+=8,ae},readSFixed64:function(){var ae=ie(this.buf,this.pos)+ge(this.buf,this.pos+4)*l;return this.pos+=8,ae},readFloat:function(){var ae=d.read(this.buf,this.pos,!0,23,4);return this.pos+=4,ae},readDouble:function(){var ae=d.read(this.buf,this.pos,!0,52,8);return this.pos+=8,ae},readVarint:function(ae){var be,Te,Be=this.buf;return be=127&(Te=Be[this.pos++]),Te<128?be:(be|=(127&(Te=Be[this.pos++]))<<7,Te<128?be:(be|=(127&(Te=Be[this.pos++]))<<14,Te<128?be:(be|=(127&(Te=Be[this.pos++]))<<21,Te<128?be:function(Xe,Ze,He){var ct,Qe,pt=He.buf;if(ct=(112&(Qe=pt[He.pos++]))>>4,Qe<128||(ct|=(127&(Qe=pt[He.pos++]))<<3,Qe<128)||(ct|=(127&(Qe=pt[He.pos++]))<<10,Qe<128)||(ct|=(127&(Qe=pt[He.pos++]))<<17,Qe<128)||(ct|=(127&(Qe=pt[He.pos++]))<<24,Qe<128)||(ct|=(1&(Qe=pt[He.pos++]))<<31,Qe<128))return x(Xe,ct,Ze);throw new Error("Expected varint not more than 10 bytes")}(be|=(15&(Te=Be[this.pos]))<<28,ae,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var ae=this.readVarint();return ae%2==1?(ae+1)/-2:ae/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var ae=this.readVarint()+this.pos,be=this.pos;return this.pos=ae,ae-be>=12&&v?function(Te,Be,Xe){return v.decode(Te.subarray(Be,Xe))}(this.buf,be,ae):function(Te,Be,Xe){for(var Ze="",He=Be;He<Xe;){var ct,Qe,pt,St=Te[He],Tt=null,It=St>239?4:St>223?3:St>191?2:1;if(He+It>Xe)break;It===1?St<128&&(Tt=St):It===2?(192&(ct=Te[He+1]))==128&&(Tt=(31&St)<<6|63&ct)<=127&&(Tt=null):It===3?(Qe=Te[He+2],(192&(ct=Te[He+1]))==128&&(192&Qe)==128&&((Tt=(15&St)<<12|(63&ct)<<6|63&Qe)<=2047||Tt>=55296&&Tt<=57343)&&(Tt=null)):It===4&&(Qe=Te[He+2],pt=Te[He+3],(192&(ct=Te[He+1]))==128&&(192&Qe)==128&&(192&pt)==128&&((Tt=(15&St)<<18|(63&ct)<<12|(63&Qe)<<6|63&pt)<=65535||Tt>=1114112)&&(Tt=null)),Tt===null?(Tt=65533,It=1):Tt>65535&&(Tt-=65536,Ze+=String.fromCharCode(Tt>>>10&1023|55296),Tt=56320|1023&Tt),Ze+=String.fromCharCode(Tt),He+=It}return Ze}(this.buf,be,ae)},readBytes:function(){var ae=this.readVarint()+this.pos,be=this.buf.subarray(this.pos,ae);return this.pos=ae,be},readPackedVarint:function(ae,be){if(this.type!==i.Bytes)return ae.push(this.readVarint(be));var Te=p(this);for(ae=ae||[];this.pos<Te;)ae.push(this.readVarint(be));return ae},readPackedSVarint:function(ae){if(this.type!==i.Bytes)return ae.push(this.readSVarint());var be=p(this);for(ae=ae||[];this.pos<be;)ae.push(this.readSVarint());return ae},readPackedBoolean:function(ae){if(this.type!==i.Bytes)return ae.push(this.readBoolean());var be=p(this);for(ae=ae||[];this.pos<be;)ae.push(this.readBoolean());return ae},readPackedFloat:function(ae){if(this.type!==i.Bytes)return ae.push(this.readFloat());var be=p(this);for(ae=ae||[];this.pos<be;)ae.push(this.readFloat());return ae},readPackedDouble:function(ae){if(this.type!==i.Bytes)return ae.push(this.readDouble());var be=p(this);for(ae=ae||[];this.pos<be;)ae.push(this.readDouble());return ae},readPackedFixed32:function(ae){if(this.type!==i.Bytes)return ae.push(this.readFixed32());var be=p(this);for(ae=ae||[];this.pos<be;)ae.push(this.readFixed32());return ae},readPackedSFixed32:function(ae){if(this.type!==i.Bytes)return ae.push(this.readSFixed32());var be=p(this);for(ae=ae||[];this.pos<be;)ae.push(this.readSFixed32());return ae},readPackedFixed64:function(ae){if(this.type!==i.Bytes)return ae.push(this.readFixed64());var be=p(this);for(ae=ae||[];this.pos<be;)ae.push(this.readFixed64());return ae},readPackedSFixed64:function(ae){if(this.type!==i.Bytes)return ae.push(this.readSFixed64());var be=p(this);for(ae=ae||[];this.pos<be;)ae.push(this.readSFixed64());return ae},skip:function(ae){var be=7&ae;if(be===i.Varint)for(;this.buf[this.pos++]>127;);else if(be===i.Bytes)this.pos=this.readVarint()+this.pos;else if(be===i.Fixed32)this.pos+=4;else{if(be!==i.Fixed64)throw new Error("Unimplemented type: "+be);this.pos+=8}},writeTag:function(ae,be){this.writeVarint(ae<<3|be)},realloc:function(ae){for(var be=this.length||16;be<this.pos+ae;)be*=2;if(be!==this.length){var Te=new Uint8Array(be);Te.set(this.buf),this.buf=Te,this.length=be}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(ae){this.realloc(4),pe(this.buf,ae,this.pos),this.pos+=4},writeSFixed32:function(ae){this.realloc(4),pe(this.buf,ae,this.pos),this.pos+=4},writeFixed64:function(ae){this.realloc(8),pe(this.buf,-1&ae,this.pos),pe(this.buf,Math.floor(ae*h),this.pos+4),this.pos+=8},writeSFixed64:function(ae){this.realloc(8),pe(this.buf,-1&ae,this.pos),pe(this.buf,Math.floor(ae*h),this.pos+4),this.pos+=8},writeVarint:function(ae){(ae=+ae||0)>268435455||ae<0?function(be,Te){var Be,Xe;if(be>=0?(Be=be%4294967296|0,Xe=be/4294967296|0):(Xe=~(-be/4294967296),4294967295^(Be=~(-be%4294967296))?Be=Be+1|0:(Be=0,Xe=Xe+1|0)),be>=18446744073709552e3||be<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");Te.realloc(10),function(Ze,He,ct){ct.buf[ct.pos++]=127&Ze|128,Ze>>>=7,ct.buf[ct.pos++]=127&Ze|128,Ze>>>=7,ct.buf[ct.pos++]=127&Ze|128,Ze>>>=7,ct.buf[ct.pos++]=127&Ze|128,ct.buf[ct.pos]=127&(Ze>>>=7)}(Be,0,Te),function(Ze,He){var ct=(7&Ze)<<4;He.buf[He.pos++]|=ct|((Ze>>>=3)?128:0),Ze&&(He.buf[He.pos++]=127&Ze|((Ze>>>=7)?128:0),Ze&&(He.buf[He.pos++]=127&Ze|((Ze>>>=7)?128:0),Ze&&(He.buf[He.pos++]=127&Ze|((Ze>>>=7)?128:0),Ze&&(He.buf[He.pos++]=127&Ze|((Ze>>>=7)?128:0),Ze&&(He.buf[He.pos++]=127&Ze)))))}(Xe,Te)}(ae,this):(this.realloc(4),this.buf[this.pos++]=127&ae|(ae>127?128:0),ae<=127||(this.buf[this.pos++]=127&(ae>>>=7)|(ae>127?128:0),ae<=127||(this.buf[this.pos++]=127&(ae>>>=7)|(ae>127?128:0),ae<=127||(this.buf[this.pos++]=ae>>>7&127))))},writeSVarint:function(ae){this.writeVarint(ae<0?2*-ae-1:2*ae)},writeBoolean:function(ae){this.writeVarint(!!ae)},writeString:function(ae){ae=String(ae),this.realloc(4*ae.length),this.pos++;var be=this.pos;this.pos=function(Be,Xe,Ze){for(var He,ct,Qe=0;Qe<Xe.length;Qe++){if((He=Xe.charCodeAt(Qe))>55295&&He<57344){if(!ct){He>56319||Qe+1===Xe.length?(Be[Ze++]=239,Be[Ze++]=191,Be[Ze++]=189):ct=He;continue}if(He<56320){Be[Ze++]=239,Be[Ze++]=191,Be[Ze++]=189,ct=He;continue}He=ct-55296<<10|He-56320|65536,ct=null}else ct&&(Be[Ze++]=239,Be[Ze++]=191,Be[Ze++]=189,ct=null);He<128?Be[Ze++]=He:(He<2048?Be[Ze++]=He>>6|192:(He<65536?Be[Ze++]=He>>12|224:(Be[Ze++]=He>>18|240,Be[Ze++]=He>>12&63|128),Be[Ze++]=He>>6&63|128),Be[Ze++]=63&He|128)}return Ze}(this.buf,ae,this.pos);var Te=this.pos-be;Te>=128&&M(be,Te,this),this.pos=be-1,this.writeVarint(Te),this.pos+=Te},writeFloat:function(ae){this.realloc(4),d.write(this.buf,ae,this.pos,!0,23,4),this.pos+=4},writeDouble:function(ae){this.realloc(8),d.write(this.buf,ae,this.pos,!0,52,8),this.pos+=8},writeBytes:function(ae){var be=ae.length;this.writeVarint(be),this.realloc(be);for(var Te=0;Te<be;Te++)this.buf[this.pos++]=ae[Te]},writeRawMessage:function(ae,be){this.pos++;var Te=this.pos;ae(be,this);var Be=this.pos-Te;Be>=128&&M(Te,Be,this),this.pos=Te-1,this.writeVarint(Be),this.pos+=Be},writeMessage:function(ae,be,Te){this.writeTag(ae,i.Bytes),this.writeRawMessage(be,Te)},writePackedVarint:function(ae,be){be.length&&this.writeMessage(ae,z,be)},writePackedSVarint:function(ae,be){be.length&&this.writeMessage(ae,V,be)},writePackedBoolean:function(ae,be){be.length&&this.writeMessage(ae,B,be)},writePackedFloat:function(ae,be){be.length&&this.writeMessage(ae,E,be)},writePackedDouble:function(ae,be){be.length&&this.writeMessage(ae,L,be)},writePackedFixed32:function(ae,be){be.length&&this.writeMessage(ae,O,be)},writePackedSFixed32:function(ae,be){be.length&&this.writeMessage(ae,F,be)},writePackedFixed64:function(ae,be){be.length&&this.writeMessage(ae,G,be)},writePackedSFixed64:function(ae,be){be.length&&this.writeMessage(ae,Q,be)},writeBytesField:function(ae,be){this.writeTag(ae,i.Bytes),this.writeBytes(be)},writeFixed32Field:function(ae,be){this.writeTag(ae,i.Fixed32),this.writeFixed32(be)},writeSFixed32Field:function(ae,be){this.writeTag(ae,i.Fixed32),this.writeSFixed32(be)},writeFixed64Field:function(ae,be){this.writeTag(ae,i.Fixed64),this.writeFixed64(be)},writeSFixed64Field:function(ae,be){this.writeTag(ae,i.Fixed64),this.writeSFixed64(be)},writeVarintField:function(ae,be){this.writeTag(ae,i.Varint),this.writeVarint(be)},writeSVarintField:function(ae,be){this.writeTag(ae,i.Varint),this.writeSVarint(be)},writeStringField:function(ae,be){this.writeTag(ae,i.Bytes),this.writeString(be)},writeFloatField:function(ae,be){this.writeTag(ae,i.Fixed32),this.writeFloat(be)},writeDoubleField:function(ae,be){this.writeTag(ae,i.Fixed64),this.writeDouble(be)},writeBooleanField:function(ae,be){this.writeVarintField(ae,!!be)}},HT}var Eb=C(SR());const qT=3;function zU(d,i,l){i.glyphs=[],d===1&&l.readMessage(FU,i)}function FU(d,i,l){if(d===3){const{id:h,bitmap:v,width:p,height:x,left:M,top:z,advance:V}=l.readMessage(NU,{});i.glyphs.push({id:h,bitmap:new gf({width:p+2*qT,height:x+2*qT},v),metrics:{width:p,height:x,left:M,top:z,advance:V}})}else d===4?i.ascender=l.readSVarint():d===5&&(i.descender=l.readSVarint())}function NU(d,i,l){d===1?i.id=l.readVarint():d===2?i.bitmap=l.readBytes():d===3?i.width=l.readVarint():d===4?i.height=l.readVarint():d===5?i.left=l.readSVarint():d===6?i.top=l.readSVarint():d===7&&(i.advance=l.readVarint())}const CR=qT,gu={horizontal:1,vertical:2,horizontalOnly:3};class L_{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(i,l){const h=new L_;return h.scale=i||1,h.fontStack=l,h}static forImage(i){const l=new L_;return l.imageName=i,l}}class Eg{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(i,l){const h=new Eg;for(let v=0;v<i.sections.length;v++){const p=i.sections[v];p.image?h.addImageSection(p):h.addTextSection(p,l)}return h}length(){return this.text.length}getSection(i){return this.sections[this.sectionIndex[i]]}getSections(){return this.sections}getSectionIndex(i){return this.sectionIndex[i]}getCodePoint(i){return this.text.codePointAt(i)}verticalizePunctuation(i){this.text=function(l,h){let v="";for(let p=0;p<l.length;p++){const x=l.charCodeAt(p+1)||null,M=l.charCodeAt(p-1)||null;v+=!h&&(x&&Pp(x)&&!A_[l[p+1]]||M&&Pp(M)&&!A_[l[p-1]])||!A_[l[p]]?l[p]:A_[l[p]]}return v}(this.text,i)}trim(){let i=0;for(let h=0;h<this.text.length&&Tb[this.text.charCodeAt(h)];h++)i++;let l=this.text.length;for(let h=this.text.length-1;h>=0&&h>=i&&Tb[this.text.charCodeAt(h)];h--)l--;this.text=this.text.substring(i,l),this.sectionIndex=this.sectionIndex.slice(i,l)}substring(i,l){const h=new Eg;return h.text=this.text.substring(i,l),h.sectionIndex=this.sectionIndex.slice(i,l),h.sections=this.sections,h}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((i,l)=>Math.max(i,this.sections[l].scale),0)}addTextSection(i,l){this.text+=i.text,this.sections.push(L_.forText(i.scale,i.fontStack||l));const h=this.sections.length-1;for(let v=0;v<i.text.length;++v)this.sectionIndex.push(h)}addImageSection(i){const l=i.image?i.image.namePrimary:"";if(l.length===0)return void vr("Can't add FormattedSection with an empty image.");const h=this.getNextImageSectionCharCode();h?(this.text+=String.fromCodePoint(h),this.sections.push(L_.forImage(l)),this.sectionIndex.push(this.sections.length-1)):vr("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function XT(d,i,l,h,v,p,x,M,z,V,E,L,B,O,F){const G=Eg.fromFeature(d,v);L===gu.vertical&&G.verticalizePunctuation(B);let Q=[];const ie=function(Te,Be,Xe,Ze,He,ct){if(!Te)return[];const Qe=[],pt=function(Lt,Yt,Rt,ln,gn,Qt){let Qn=0;for(let $n=0;$n<Lt.length();$n++){const kn=Lt.getSection($n);Qn+=ER(Lt.getCodePoint($n),kn,ln,gn,Yt,Qt)}return Qn/Math.max(1,Math.ceil(Qn/Rt))}(Te,Be,Xe,Ze,He,ct),St=Te.text.indexOf("​")>=0;let Tt=0;for(let Lt=0;Lt<Te.length();Lt++){const Yt=Te.getSection(Lt),Rt=Te.getCodePoint(Lt);if(Tb[Rt]||(Tt+=ER(Rt,Yt,Ze,He,Be,ct)),Lt<Te.length()-1){const ln=!((It=Rt)<11904||!(mr["Bopomofo Extended"](It)||mr.Bopomofo(It)||mr["CJK Compatibility Forms"](It)||mr["CJK Compatibility Ideographs"](It)||mr["CJK Compatibility"](It)||mr["CJK Radicals Supplement"](It)||mr["CJK Strokes"](It)||mr["CJK Symbols and Punctuation"](It)||mr["CJK Unified Ideographs Extension A"](It)||mr["CJK Unified Ideographs"](It)||mr["Enclosed CJK Letters and Months"](It)||mr["Halfwidth and Fullwidth Forms"](It)||mr.Hiragana(It)||mr["Ideographic Description Characters"](It)||mr["Kangxi Radicals"](It)||mr["Katakana Phonetic Extensions"](It)||mr.Katakana(It)||mr["Vertical Forms"](It)||mr["Yi Radicals"](It)||mr["Yi Syllables"](It)));(BU[Rt]||ln||Yt.imageName)&&Qe.push(IR(Lt+1,Tt,pt,Qe,jU(Rt,Te.getCodePoint(Lt+1),ln&&St),!1))}}var It;return kR(IR(Te.length(),Tt,pt,Qe,0,!0))}(G,V,p,i,h,O),{processBidirectionalText:pe,processStyledBidirectionalText:ge}=nl;if(pe&&G.sections.length===1){const Te=pe(G.toString(),ie);for(const Be of Te){const Xe=new Eg;Xe.text=Be,Xe.sections=G.sections;for(let Ze=0;Ze<Be.length;Ze++)Xe.sectionIndex.push(0);Q.push(Xe)}}else if(ge){const Te=ge(G.text,G.sectionIndex,ie);for(const Be of Te){const Xe=new Eg;Xe.text=Be[0],Xe.sectionIndex=Be[1],Xe.sections=G.sections,Q.push(Xe)}}else Q=function(Te,Be){const Xe=[],Ze=Te.text;let He=0;for(const ct of Be)Xe.push(Te.substring(He,ct)),He=ct;return He<Ze.length&&Xe.push(Te.substring(He,Ze.length)),Xe}(G,ie);const ae=[],be={positionedLines:ae,text:G.toString(),top:E[1],bottom:E[1],left:E[0],right:E[0],writingMode:L,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(Te,Be,Xe,Ze,He,ct,Qe,pt,St,Tt,It,Lt){let Yt=0,Rt=0,ln=0;const gn=pt==="right"?1:pt==="left"?0:.5;let Qt=!1;for(const Zn of He){const nr=Zn.getSections();for(const Br of nr){if(Br.imageName)continue;const ri=Be[Br.fontStack];if(ri&&(Qt=ri.ascender!==void 0&&ri.descender!==void 0,!Qt))break}if(!Qt)break}let Qn=0;for(const Zn of He){Zn.trim();const nr=Zn.getMaxScale(),Br=(nr-1)*ha,ri={positionedGlyphs:[],lineOffset:0};Te.positionedLines[Qn]=ri;const Xr=ri.positionedGlyphs;let Yr=0;if(!Zn.length()){Rt+=ct,++Qn;continue}let si=0,li=0;for(let Di=0;Di<Zn.length();Di++){const jr=Zn.getSection(Di),Ii=Zn.getSectionIndex(Di),Ai=Zn.getCodePoint(Di);let lo=jr.scale,Jo=null,hs=null,Qo=null,Po=ha,Zs=0;const ys=!(St===gu.horizontal||!It&&!ig(Ai)||It&&(Tb[Ai]||($n=Ai,mr.Arabic($n)||mr["Arabic Supplement"]($n)||mr["Arabic Extended-A"]($n)||mr["Arabic Presentation Forms-A"]($n)||mr["Arabic Presentation Forms-B"]($n))));if(jr.imageName){const fa=Ze[jr.imageName];if(!fa)continue;Qo=jr.imageName,Te.iconsInText=Te.iconsInText||!0,hs=fa.paddedRect;const io=fa.displaySize;lo=lo*ha/Lt,Jo={width:io[0],height:io[1],left:0,top:-CR,advance:ys?io[1]:io[0],localGlyph:!1},Zs=Qt?-Jo.height*lo:nr*ha-17-io[1]*lo,Po=Jo.advance;const Il=(ys?io[0]:io[1])*lo-ha*nr;Il>0&&Il>Yr&&(Yr=Il)}else{const fa=Xe[jr.fontStack];if(!fa)continue;fa[Ai]&&(hs=fa[Ai]);const io=Be[jr.fontStack];if(!io)continue;const Il=io.glyphs[Ai];if(!Il)continue;if(Jo=Il.metrics,Po=Ai!==8203?ha:0,Qt){const Bc=io.ascender!==void 0?Math.abs(io.ascender):0,Xu=io.descender!==void 0?Math.abs(io.descender):0,Yu=(Bc+Xu)*lo;si<Yu&&(si=Yu,li=(Bc-Xu)/2*lo),Zs=-Bc*lo}else Zs=(nr-lo)*ha-17}ys?(Te.verticalizable=!0,Xr.push({glyph:Ai,imageName:Qo,x:Yt,y:Rt+Zs,vertical:ys,scale:lo,localGlyph:Jo.localGlyph,fontStack:jr.fontStack,sectionIndex:Ii,metrics:Jo,rect:hs}),Yt+=Po*lo+Tt):(Xr.push({glyph:Ai,imageName:Qo,x:Yt,y:Rt+Zs,vertical:ys,scale:lo,localGlyph:Jo.localGlyph,fontStack:jr.fontStack,sectionIndex:Ii,metrics:Jo,rect:hs}),Yt+=Jo.advance*lo+Tt)}Xr.length!==0&&(ln=Math.max(Yt-Tt,ln),Qt?MR(Xr,gn,Yr,li,ct*nr/2):MR(Xr,gn,Yr,0,ct/2)),Yt=0;const Xi=ct*nr+Yr;ri.lineOffset=Math.max(Yr,Br),Rt+=Xi,++Qn}var $n;const kn=Rt,{horizontalAlign:vn,verticalAlign:br}=YT(Qe);(function(Zn,nr,Br,ri,Xr,Yr){const si=(nr-Br)*Xr,li=-Yr*ri;for(const Xi of Zn)for(const Di of Xi.positionedGlyphs)Di.x+=si,Di.y+=li})(Te.positionedLines,gn,vn,br,ln,kn),Te.top+=-br*kn,Te.bottom=Te.top+kn,Te.left+=-vn*ln,Te.right=Te.left+ln,Te.hasBaseline=Qt}(be,i,l,h,Q,x,M,z,L,V,B,F),!function(Te){for(const Be of Te)if(Be.positionedGlyphs.length!==0)return!1;return!0}(ae)&&be}const Tb={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},BU={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function ER(d,i,l,h,v,p){if(i.imageName){const x=h[i.imageName];return x?x.displaySize[0]*i.scale*ha/p+v:0}{const x=l[i.fontStack],M=x&&x.glyphs[d];return M?M.metrics.advance*i.scale+v:0}}function TR(d,i,l,h){const v=Math.pow(d-i,2);return h?d<i?v/2:2*v:v+Math.abs(l)*l}function jU(d,i,l){let h=0;return d===10&&(h-=1e4),l&&(h+=150),d!==40&&d!==65288||(h+=50),i!==41&&i!==65289||(h+=50),h}function IR(d,i,l,h,v,p){let x=null,M=TR(i,l,v,p);for(const z of h){const V=TR(i-z.x,l,v,p)+z.badness;V<=M&&(x=z,M=V)}return{index:d,x:i,priorBreak:x,badness:M}}function kR(d){return d?kR(d.priorBreak).concat(d.index):[]}function YT(d){let i=.5,l=.5;switch(d){case"right":case"top-right":case"bottom-right":i=1;break;case"left":case"top-left":case"bottom-left":i=0}switch(d){case"bottom":case"bottom-right":case"bottom-left":l=1;break;case"top":case"top-right":case"top-left":l=0}return{horizontalAlign:i,verticalAlign:l}}function MR(d,i,l,h,v){if(!(i||l||h||v))return;const p=d.length-1,x=d[p],M=(x.x+x.metrics.advance*x.scale)*i;for(let z=0;z<=p;z++)d[z].x-=M,d[z].y+=l+h+v}function VU(d,i,l,h){const{horizontalAlign:v,verticalAlign:p}=YT(h),x=l[0]-d.displaySize[0]*v,M=l[1]-d.displaySize[1]*p;return{imagePrimary:d,imageSecondary:i,top:M,bottom:M+d.displaySize[1],left:x,right:x+d.displaySize[0]}}function PR(d,i,l,h,v,p){const x=d.imagePrimary;let M;if(x.content){const Q=x.content,ie=x.pixelRatio||1;M=[Q[0]/ie,Q[1]/ie,x.displaySize[0]-Q[2]/ie,x.displaySize[1]-Q[3]/ie]}const z=i.left*p,V=i.right*p;let E,L,B,O;l==="width"||l==="both"?(O=v[0]+z-h[3],L=v[0]+V+h[1]):(O=v[0]+(z+V-x.displaySize[0])/2,L=O+x.displaySize[0]);const F=i.top*p,G=i.bottom*p;return l==="height"||l==="both"?(E=v[1]+F-h[0],B=v[1]+G+h[2]):(E=v[1]+(F+G-x.displaySize[1])/2,B=E+x.displaySize[1]),{imagePrimary:x,imageSecondary:void 0,top:E,right:L,bottom:B,left:O,collisionPadding:M}}class ph extends st{constructor(i,l,h,v,p){super(i,l),this.angle=v,this.z=h,p!==void 0&&(this.segment=p)}clone(){return new ph(this.x,this.y,this.z,this.angle,this.segment)}}function AR(d,i,l,h,v){if(i.segment===void 0)return!0;let p=i,x=i.segment+1,M=0;for(;M>-l/2;){if(x--,x<0)return!1;M-=d[x].dist(p),p=d[x]}M+=d[x].dist(d[x+1]),x++;const z=[];let V=0;for(;M<l/2;){const E=d[x],L=d[x+1];if(!L)return!1;let B=d[x-1].angleTo(E)-E.angleTo(L);for(B=Math.abs((B+3*Math.PI)%(2*Math.PI)-Math.PI),z.push({distance:M,angleDelta:B}),V+=B;M-z[0].distance>h;)V-=z.shift().angleDelta;if(V>v)return!1;x++,M+=E.dist(L)}return!0}function LR(d){let i=0;for(let l=0;l<d.length-1;l++)i+=d[l].dist(d[l+1]);return i}function RR(d,i,l){return d?.6*i*l:0}function OR(d,i){return Math.max(d?d.right-d.left:0,i?i.right-i.left:0)}function $U(d,i,l,h,v,p){const x=RR(l,v,p),M=OR(l,h)*p;let z=0;const V=LR(d)/2;for(let E=0;E<d.length-1;E++){const L=d[E],B=d[E+1],O=L.dist(B);if(z+O>V){const F=(V-z)/O,G=sr(L.x,B.x,F),Q=sr(L.y,B.y,F),ie=new ph(G,Q,0,B.angleTo(L),E);return!x||AR(d,ie,M,x,i)?ie:void 0}z+=O}}function UU(d,i,l,h,v,p,x,M,z){const V=RR(h,p,x),E=OR(h,v),L=E*x,B=d[0].x===0||d[0].x===z||d[0].y===0||d[0].y===z;return i-L<i/4&&(i=L+i/4),DR(d,B?i/2*M%i:(E/2+2*p)*x*M%i,i,V,l,L,B,!1,z)}function DR(d,i,l,h,v,p,x,M,z){const V=p/2,E=LR(d);let L=0,B=i-l,O=[];for(let F=0;F<d.length-1;F++){const G=d[F],Q=d[F+1],ie=G.dist(Q),pe=Q.angleTo(G);for(;B+l<L+ie;){B+=l;const ge=(B-L)/ie,ae=sr(G.x,Q.x,ge),be=sr(G.y,Q.y,ge);if(ae>=0&&ae<z&&be>=0&&be<z&&B-V>=0&&B+V<=E){const Te=new ph(ae,be,0,pe,F);h&&!AR(d,Te,p,h,v)||O.push(Te)}}L+=ie}return M||O.length||x||(O=DR(d,L/2,l,h,v,p,x,!0,z)),O}function zR(d,i,l,h,v){const p=[];for(let x=0;x<d.length;x++){const M=d[x];let z;for(let V=0;V<M.length-1;V++){let E=M[V],L=M[V+1];E.x<i&&L.x<i||(E.x<i?E=new st(i,E.y+(i-E.x)/(L.x-E.x)*(L.y-E.y))._round():L.x<i&&(L=new st(i,E.y+(i-E.x)/(L.x-E.x)*(L.y-E.y))._round()),E.y<l&&L.y<l||(E.y<l?E=new st(E.x+(l-E.y)/(L.y-E.y)*(L.x-E.x),l)._round():L.y<l&&(L=new st(E.x+(l-E.y)/(L.y-E.y)*(L.x-E.x),l)._round()),E.x>=h&&L.x>=h||(E.x>=h?E=new st(h,E.y+(h-E.x)/(L.x-E.x)*(L.y-E.y))._round():L.x>=h&&(L=new st(h,E.y+(h-E.x)/(L.x-E.x)*(L.y-E.y))._round()),E.y>=v&&L.y>=v||(E.y>=v?E=new st(E.x+(v-E.y)/(L.y-E.y)*(L.x-E.x),v)._round():L.y>=v&&(L=new st(E.x+(v-E.y)/(L.y-E.y)*(L.x-E.x),v)._round()),z&&E.equals(z[z.length-1])||(z=[E],p.push(z)),z.push(L)))))}}return p}function FR(d){let i=0,l=0;for(const x of d)i+=x.w*x.h,l=Math.max(l,x.w);d.sort((x,M)=>M.h-x.h);const h=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(i/.95)),l),h:1/0}];let v=0,p=0;for(const x of d)for(let M=h.length-1;M>=0;M--){const z=h[M];if(!(x.w>z.w||x.h>z.h)){if(x.x=z.x,x.y=z.y,p=Math.max(p,x.y+x.h),v=Math.max(v,x.x+x.w),x.w===z.w&&x.h===z.h){const V=h.pop();M<h.length&&(h[M]=V)}else x.h===z.h?(z.x+=x.w,z.w-=x.w):x.w===z.w?(z.y+=x.h,z.h-=x.h):(h.push({x:z.x+x.w,y:z.y,w:z.w-x.w,h:x.h}),z.y+=x.h,z.h-=x.h);break}}return{w:v,h:p,fill:i/(v*p)||0}}ir(ph,"Anchor");const R_=1;class ZT{constructor(i,{pixelRatio:l,version:h,stretchX:v,stretchY:p,content:x},M){this.paddedRect=i,this.pixelRatio=l,this.stretchX=v,this.stretchY=p,this.content=x,this.version=h,this.padding=M}get tl(){return[this.paddedRect.x+this.padding,this.paddedRect.y+this.padding]}get br(){return[this.paddedRect.x+this.paddedRect.w-this.padding,this.paddedRect.y+this.paddedRect.h-this.padding]}get displaySize(){return[(this.paddedRect.w-2*this.padding)/this.pixelRatio,(this.paddedRect.h-2*this.padding)/this.pixelRatio]}}class NR{constructor(i,l,h){const v={},p={};this.haveRenderCallbacks=[];const x=[];this.addImages(i,v,R_,x),this.addImages(l,p,2,x);const{w:M,h:z}=FR(x),V=new za({width:M||1,height:z||1});for(const E in i){const L=i[E],B=v[E].paddedRect;za.copy(L.data,V,{x:0,y:0},{x:B.x+R_,y:B.y+R_},L.data,h,L.sdf)}for(const E in l){const L=l[E],B=p[E].paddedRect;let O=p[E].padding;const F=B.x+O,G=B.y+O,Q=L.data.width,ie=L.data.height;O=O>1?O-1:O,za.copy(L.data,V,{x:0,y:0},{x:F,y:G},L.data,h),za.copy(L.data,V,{x:0,y:ie-O},{x:F,y:G-O},{width:Q,height:O},h),za.copy(L.data,V,{x:0,y:0},{x:F,y:G+ie},{width:Q,height:O},h),za.copy(L.data,V,{x:Q-O,y:0},{x:F-O,y:G},{width:O,height:ie},h),za.copy(L.data,V,{x:0,y:0},{x:F+Q,y:G},{width:O,height:ie},h),za.copy(L.data,V,{x:Q-O,y:ie-O},{x:F-O,y:G-O},{width:O,height:O},h),za.copy(L.data,V,{x:0,y:ie-O},{x:F+Q,y:G-O},{width:O,height:O},h),za.copy(L.data,V,{x:0,y:0},{x:F+Q,y:G+ie},{width:O,height:O},h),za.copy(L.data,V,{x:Q-O,y:0},{x:F-O,y:G+ie},{width:O,height:O},h)}this.image=V,this.iconPositions=v,this.patternPositions=p}addImages(i,l,h,v){for(const p in i){const x=i[p],M={x:0,y:0,w:x.data.width+2*h,h:x.data.height+2*h};v.push(M),l[p]=new ZT(M,x,h),x.hasRenderCallback&&this.haveRenderCallbacks.push(p)}}patchUpdatedImages(i,l,h){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(v=>i.hasImage(v,h)),i.dispatchRenderCallbacks(this.haveRenderCallbacks,h);for(const v in i.getUpdatedImages(h))this.patchUpdatedImage(this.iconPositions[v],i.getImage(v,h),l),this.patchUpdatedImage(this.patternPositions[v],i.getImage(v,h),l)}patchUpdatedImage(i,l,h){if(!i||!l||i.version===l.version)return;i.version=l.version;const[v,p]=i.tl;h.update(l.data,{position:{x:v,y:p}})}}ir(ZT,"ImagePosition"),ir(NR,"ImageAtlas");const O_=1e20;function BR(d,i,l,h,v,p,x,M,z){for(let V=i;V<i+h;V++)jR(d,l*p+V,p,v,x,M,z);for(let V=l;V<l+v;V++)jR(d,V*p+i,1,h,x,M,z)}function jR(d,i,l,h,v,p,x){p[0]=0,x[0]=-O_,x[1]=O_,v[0]=d[i];for(let M=1,z=0,V=0;M<h;M++){v[M]=d[i+M*l];const E=M*M;do{const L=p[z];V=(v[M]-v[L]+E-L*L)/(M-L)/2}while(V<=x[z]&&--z>-1);z++,p[z]=M,x[z]=V,x[z+1]=O_}for(let M=0,z=0;M<h;M++){for(;x[z+1]<M;)z++;const V=p[z],E=M-V;d[i+M*l]=v[V]+E*E}}const Dc=2,KT={none:0,ideographs:1,all:2};class Tg{constructor(i,l,h){this.requestManager=i,this.localGlyphMode=l,this.localFontFamily=h,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(i,l){this.urls[l]=i}getGlyphs(i,l,h){const v=[],p=this.urls[l]||_t.GLYPHS_URL;for(const x in i)for(const M of i[x])v.push({stack:x,id:M});bn(v,({stack:x,id:M},z)=>{let V=this.entries[x];V||(V=this.entries[x]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let E=V.glyphs[M];if(E!==void 0)return void z(null,{stack:x,id:M,glyph:E});if(E=this._tinySDF(V,x,M),E)return V.glyphs[M]=E,void z(null,{stack:x,id:M,glyph:E});const L=Math.floor(M/256);if(256*L>65535)return void z(new Error("glyphs > 65535 not supported"));if(V.ranges[L])return void z(null,{stack:x,id:M,glyph:E});let B=V.requests[L];B||(B=V.requests[L]=[],Tg.loadGlyphRange(x,L,p,this.requestManager,(O,F)=>{if(F){V.ascender=F.ascender,V.descender=F.descender;for(const G in F.glyphs)this._doesCharSupportLocalGlyph(+G)||(V.glyphs[+G]=F.glyphs[+G]);V.ranges[L]=!0}for(const G of B)G(O,F);delete V.requests[L]})),B.push((O,F)=>{O?z(O):F&&z(null,{stack:x,id:M,glyph:F.glyphs[M]||null})})},(x,M)=>{if(x)h(x);else if(M){const z={};for(const{stack:V,id:E,glyph:L}of M)z[V]===void 0&&(z[V]={}),z[V].glyphs===void 0&&(z[V].glyphs={}),z[V].glyphs[E]=L&&{id:L.id,bitmap:L.bitmap.clone(),metrics:L.metrics},z[V].ascender=this.entries[V].ascender,z[V].descender=this.entries[V].descender;h(null,z)}})}_doesCharSupportLocalGlyph(i){return this.localGlyphMode!==KT.none&&(this.localGlyphMode===KT.all?!!this.localFontFamily:!!this.localFontFamily&&(mr["CJK Unified Ideographs"](i)||mr["Hangul Syllables"](i)||mr.Hiragana(i)||mr.Katakana(i)||mr["CJK Symbols and Punctuation"](i)||mr["CJK Unified Ideographs Extension A"](i)||mr["CJK Unified Ideographs Extension B"](i)))}_tinySDF(i,l,h){const v=this.localFontFamily;if(!v||!this._doesCharSupportLocalGlyph(h))return;let p=i.tinySDF;if(!p){let G="400";/bold/i.test(l)?G="900":/medium/i.test(l)?G="500":/light/i.test(l)&&(G="200"),p=i.tinySDF=new Tg.TinySDF({fontFamily:v,fontWeight:G,fontSize:24*Dc,buffer:3*Dc,radius:8*Dc}),p.fontWeight=G}if(this.localGlyphs[p.fontWeight][h])return this.localGlyphs[p.fontWeight][h];const x=String.fromCodePoint(h),{data:M,width:z,height:V,glyphWidth:E,glyphHeight:L,glyphLeft:B,glyphTop:O,glyphAdvance:F}=p.draw(x);return this.localGlyphs[p.fontWeight][h]={id:h,bitmap:new gf({width:z,height:V},M),metrics:{width:E/Dc,height:L/Dc,left:B/Dc,top:O/Dc-27,advance:F/Dc,localGlyph:!0}}}}Tg.loadGlyphRange=function(d,i,l,h,v){const p=256*i,x=p+255,M=h.transformRequest(h.normalizeGlyphsURL(l).replace("{fontstack}",d).replace("{range}",`${p}-${x}`),Rs.Glyphs);lu(M,(z,V)=>{if(z)v(z);else if(V){const E={},L=function(B){return new Eb(B).readFields(zU,{})}(V);for(const B of L.glyphs)E[B.id]=B;v(null,{glyphs:E,ascender:L.ascender,descender:L.descender})}})},Tg.TinySDF=class{constructor({fontSize:d=24,buffer:i=3,radius:l=8,cutoff:h=.25,fontFamily:v="sans-serif",fontWeight:p="normal",fontStyle:x="normal"}={}){this.buffer=i,this.cutoff=h,this.radius=l;const M=this.size=d+4*i,z=this._createCanvas(M),V=this.ctx=z.getContext("2d",{willReadFrequently:!0});V.font=`${x} ${p} ${d}px ${v}`,V.textBaseline="alphabetic",V.textAlign="left",V.fillStyle="black",this.gridOuter=new Float64Array(M*M),this.gridInner=new Float64Array(M*M),this.f=new Float64Array(M),this.z=new Float64Array(M+1),this.v=new Uint16Array(M)}_createCanvas(d){const i=document.createElement("canvas");return i.width=i.height=d,i}draw(d){const{width:i,actualBoundingBoxAscent:l,actualBoundingBoxDescent:h,actualBoundingBoxLeft:v,actualBoundingBoxRight:p}=this.ctx.measureText(d),x=Math.ceil(l),M=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(p-v))),z=Math.min(this.size-this.buffer,x+Math.ceil(h)),V=M+2*this.buffer,E=z+2*this.buffer,L=Math.max(V*E,0),B=new Uint8ClampedArray(L),O={data:B,width:V,height:E,glyphWidth:M,glyphHeight:z,glyphTop:x,glyphLeft:0,glyphAdvance:i};if(M===0||z===0)return O;const{ctx:F,buffer:G,gridInner:Q,gridOuter:ie}=this;F.clearRect(G,G,M,z),F.fillText(d,G,G+x);const pe=F.getImageData(G,G,M,z);ie.fill(O_,0,L),Q.fill(0,0,L);for(let ge=0;ge<z;ge++)for(let ae=0;ae<M;ae++){const be=pe.data[4*(ge*M+ae)+3]/255;if(be===0)continue;const Te=(ge+G)*V+ae+G;if(be===1)ie[Te]=0,Q[Te]=O_;else{const Be=.5-be;ie[Te]=Be>0?Be*Be:0,Q[Te]=Be<0?Be*Be:0}}BR(ie,0,0,V,E,V,this.f,this.v,this.z),BR(Q,G,G,M,z,V,this.f,this.v,this.z);for(let ge=0;ge<L;ge++){const ae=Math.sqrt(ie[ge])-Math.sqrt(Q[ge]);B[ge]=Math.round(255-255*(ae/this.radius+this.cutoff))}return O}};const _f=R_;function VR(d,i,l,h){const v=[],p=d.imagePrimary,x=p.pixelRatio,M=p.paddedRect.w-2*_f,z=p.paddedRect.h-2*_f,V=d.right-d.left,E=d.bottom-d.top,L=p.stretchX||[[0,M]],B=p.stretchY||[[0,z]],O=(ct,Qe)=>ct+Qe[1]-Qe[0],F=L.reduce(O,0),G=B.reduce(O,0),Q=M-F,ie=z-G;let pe=0,ge=F,ae=0,be=G,Te=0,Be=Q,Xe=0,Ze=ie;if(p.content&&h){const ct=p.content;pe=Ib(L,0,ct[0]),ae=Ib(B,0,ct[1]),ge=Ib(L,ct[0],ct[2]),be=Ib(B,ct[1],ct[3]),Te=ct[0]-pe,Xe=ct[1]-ae,Be=ct[2]-ct[0]-ge,Ze=ct[3]-ct[1]-be}const He=(ct,Qe,pt,St)=>{const Tt=kb(ct.stretch-pe,ge,V,d.left),It=Mb(ct.fixed-Te,Be,ct.stretch,F),Lt=kb(Qe.stretch-ae,be,E,d.top),Yt=Mb(Qe.fixed-Xe,Ze,Qe.stretch,G),Rt=kb(pt.stretch-pe,ge,V,d.left),ln=Mb(pt.fixed-Te,Be,pt.stretch,F),gn=kb(St.stretch-ae,be,E,d.top),Qt=Mb(St.fixed-Xe,Ze,St.stretch,G),Qn=new st(Tt,Lt),$n=new st(Rt,Lt),kn=new st(Rt,gn),vn=new st(Tt,gn),br=new st(It/x,Yt/x),Zn=new st(ln/x,Qt/x),nr=i*Math.PI/180;if(nr){const li=Math.sin(nr),Xi=Math.cos(nr),Di=[Xi,-li,li,Xi];Qn._matMult(Di),$n._matMult(Di),vn._matMult(Di),kn._matMult(Di)}const Br=ct.stretch+ct.fixed,ri=pt.stretch+pt.fixed,Xr=Qe.stretch+Qe.fixed,Yr=St.stretch+St.fixed,si=d.imageSecondary;return{tl:Qn,tr:$n,bl:vn,br:kn,texPrimary:{x:p.paddedRect.x+_f+Br,y:p.paddedRect.y+_f+Xr,w:ri-Br,h:Yr-Xr},texSecondary:si?{x:si.paddedRect.x+_f+Br,y:si.paddedRect.y+_f+Xr,w:ri-Br,h:Yr-Xr}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:br,pixelOffsetBR:Zn,minFontScaleX:Be/x/V,minFontScaleY:Ze/x/E,isSDF:l}};if(h&&(p.stretchX||p.stretchY)){const ct=$R(L,Q,F),Qe=$R(B,ie,G);for(let pt=0;pt<ct.length-1;pt++){const St=ct[pt],Tt=ct[pt+1];for(let It=0;It<Qe.length-1;It++)v.push(He(St,Qe[It],Tt,Qe[It+1]))}}else v.push(He({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:M+1},{fixed:0,stretch:z+1}));return v}function Ib(d,i,l){let h=0;for(const v of d)h+=Math.max(i,Math.min(l,v[1]))-Math.max(i,Math.min(l,v[0]));return h}function $R(d,i,l){const h=[{fixed:-_f,stretch:0}];for(const[v,p]of d){const x=h[h.length-1];h.push({fixed:v-x.stretch,stretch:x.stretch}),h.push({fixed:v-x.stretch,stretch:x.stretch+(p-v)})}return h.push({fixed:i+_f,stretch:l}),h}function kb(d,i,l,h){return d/i*l+h}function Mb(d,i,l,h){return d-i*l/h}function GU(d,i,l,h){const v=i+d.positionedLines[h].lineOffset;return h===0?l+v/2:l+(v+(i+d.positionedLines[h-1].lineOffset))/2}function HU(d,i=1,l=!1){let h=1/0,v=1/0,p=-1/0,x=-1/0;const M=d[0];for(let O=0;O<M.length;O++){const F=M[O];(!O||F.x<h)&&(h=F.x),(!O||F.y<v)&&(v=F.y),(!O||F.x>p)&&(p=F.x),(!O||F.y>x)&&(x=F.y)}const z=Math.min(p-h,x-v);let V=z/2;const E=new Sl([],WU);if(z===0)return new st(h,v);for(let O=h;O<p;O+=z)for(let F=v;F<x;F+=z)E.push(new Ig(O+V,F+V,V,d));let L=function(O){let F=0,G=0,Q=0;const ie=O[0];for(let pe=0,ge=ie.length,ae=ge-1;pe<ge;ae=pe++){const be=ie[pe],Te=ie[ae],Be=be.x*Te.y-Te.x*be.y;G+=(be.x+Te.x)*Be,Q+=(be.y+Te.y)*Be,F+=3*Be}return new Ig(G/F,Q/F,0,O)}(d),B=E.length;for(;E.length;){const O=E.pop();(O.d>L.d||!L.d)&&(L=O,l&&console.log("found best %d after %d probes",Math.round(1e4*O.d)/1e4,B)),O.max-L.d<=i||(V=O.h/2,E.push(new Ig(O.p.x-V,O.p.y-V,V,d)),E.push(new Ig(O.p.x+V,O.p.y-V,V,d)),E.push(new Ig(O.p.x-V,O.p.y+V,V,d)),E.push(new Ig(O.p.x+V,O.p.y+V,V,d)),B+=4)}return l&&(console.log(`num probes: ${B}`),console.log(`best distance: ${L.d}`)),L.p}function WU(d,i){return i.max-d.max}class Ig{constructor(i,l,h,v){this.p=new st(i,l),this.h=h,this.d=function(p,x){let M=!1,z=1/0;for(let V=0;V<x.length;V++){const E=x[V];for(let L=0,B=E.length,O=B-1;L<B;O=L++){const F=E[L],G=E[O];F.y>p.y!=G.y>p.y&&p.x<(G.x-F.x)*(p.y-F.y)/(G.y-F.y)+F.x&&(M=!M),z=Math.min(z,Fi(p,F,G))}}return(M?1:-1)*Math.sqrt(z)}(this.p,v),this.max=this.d+this.h*Math.SQRT2}}const JT=Number.POSITIVE_INFINITY,qU=Math.sqrt(2);function UR(d,[i,l]){let h=0,v=0;if(l===JT){i<0&&(i=0);const p=i/qU;switch(d){case"top-right":case"top-left":v=p-7;break;case"bottom-right":case"bottom-left":v=7-p;break;case"bottom":v=7-i;break;case"top":v=i-7}switch(d){case"top-right":case"bottom-right":h=-p;break;case"top-left":case"bottom-left":h=p;break;case"left":h=i;break;case"right":h=-i}}else{switch(i=Math.abs(i),l=Math.abs(l),d){case"top-right":case"top-left":case"top":v=l-7;break;case"bottom-right":case"bottom-left":case"bottom":v=7-l}switch(d){case"top-right":case"bottom-right":case"right":h=-i;break;case"top-left":case"bottom-left":case"left":h=i}}return[h,v]}function QT(d){switch(d){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function XU(d,i,l,h,v,p,x,M,z,V,E,L,B,O,F){let G=p.textMaxSize.evaluate(i,{},L);G===void 0&&(G=x);const Q=d.layers[0].layout,ie=Q.get("icon-offset").evaluate(i,{},L),pe=HR(l.horizontal)||l.vertical,ge=B.name==="globe",ae=ha,be=x/ae,Te=d.tilePixelRatio*G/ae,Be=(Tt=d.overscaling,d.zoom>18&&Tt>2&&(Tt>>=1),Math.max(Nn/(512*Tt),1)*Q.get("symbol-spacing")),Xe=Q.get("text-padding")*d.tilePixelRatio,Ze=Q.get("icon-padding")*d.tilePixelRatio,He=nt(Q.get("text-max-angle")),ct=Q.get("text-rotation-alignment")==="map"&&Q.get("symbol-placement")!=="point",Qe=Q.get("icon-rotation-alignment")==="map"&&Q.get("symbol-placement")!=="point",pt=Q.get("symbol-placement"),St=Be/2;var Tt;const It=Q.get("icon-text-fit").evaluate(i,{},L),Lt=Q.get("icon-text-fit-padding").evaluate(i,{},L),Yt=It!=="none";let Rt;d.hasAnyIconTextFit===!1&&Yt&&(d.hasAnyIconTextFit=!0),h&&Yt&&(d.allowVerticalPlacement&&l.vertical&&(Rt=PR(h,l.vertical,It,Lt,ie,be)),pe&&(h=PR(h,pe,It,Lt,ie,be)));const ln=(gn,Qt,Qn)=>{if(Qt.x<0||Qt.x>=Nn||Qt.y<0||Qt.y>=Nn)return;let $n=null;if(ge){const{x:kn,y:vn,z:br}=B.projectTilePoint(Qt.x,Qt.y,Qn);$n={anchor:new ph(kn,vn,br,0,void 0),up:B.upVector(Qn,Qt.x,Qt.y)}}(function(kn,vn,br,Zn,nr,Br,ri,Xr,Yr,si,li,Xi,Di,jr,Ii,Ai,lo,Jo,hs,Qo,Po,Zs,ys,fa,io,Il,Bc){const Xu=kn.addToLineVertexArray(vn,Zn);let Yu,Yp,Sf,Zp,J_,hD,fD,pD=0,mD=0,gD=0,yD=0,kI=-1,MI=-1;const Ed={};let _D=jt("");const Kp=br?br.anchor:vn,PI=Yr.layout.get("icon-text-fit").evaluate(Po,{},io)!=="none";let AI=0,LI=0;if(Yr._unevaluatedLayout.getValue("text-radial-offset")===void 0?[AI,LI]=Yr.layout.get("text-offset").evaluate(Po,{},io).map(ql=>ql*ha):(AI=Yr.layout.get("text-radial-offset").evaluate(Po,{},io)*ha,LI=JT),kn.allowVerticalPlacement&&nr.vertical){const ql=nr.vertical;if(Ii)hD=eI(ql),Xr&&(fD=eI(Xr));else{const Xl=Yr.layout.get("text-rotate").evaluate(Po,{},io)+90;Sf=Pb(si,Kp,vn,li,Xi,Di,ql,jr,Xl,Ai),Xr&&(Zp=Pb(si,Kp,vn,li,Xi,Di,Xr,Jo,Xl))}}if(Br){const ql=Yr.layout.get("icon-rotate").evaluate(Po,{},io),Xl=VR(Br,ql,ys,PI),Dg=Xr?VR(Xr,ql,ys,PI):void 0;Yp=Pb(si,Kp,vn,li,Xi,Di,Br,Jo,ql),pD=4*Xl.length;const vD=kn.iconSizeData;let Jp=null;vD.kind==="source"?(Jp=[Oc*Yr.layout.get("icon-size").evaluate(Po,{},io)],Jp[0]>vf&&vr(`${kn.layerIds[0]}: Value for "icon-size" is >= ${D_}. Reduce your "icon-size".`)):vD.kind==="composite"&&(Jp=[Oc*Zs.compositeIconSizes[0].evaluate(Po,{},io),Oc*Zs.compositeIconSizes[1].evaluate(Po,{},io)],(Jp[0]>vf||Jp[1]>vf)&&vr(`${kn.layerIds[0]}: Value for "icon-size" is >= ${D_}. Reduce your "icon-size".`)),kn.addSymbols(kn.icon,Xl,Jp,Qo,hs,Po,!1,br,vn,Xu.lineStartIndex,Xu.lineLength,-1,fa,io,Il,Bc),kI=kn.icon.placedSymbolArray.length-1,Dg&&(mD=4*Dg.length,kn.addSymbols(kn.icon,Dg,Jp,Qo,hs,Po,gu.vertical,br,vn,Xu.lineStartIndex,Xu.lineLength,-1,fa,io,Il,Bc),MI=kn.icon.placedSymbolArray.length-1)}for(const ql in nr.horizontal){const Xl=nr.horizontal[ql];Yu||(_D=jt(Xl.text),Ii?J_=eI(Xl):Yu=Pb(si,Kp,vn,li,Xi,Di,Xl,jr,Yr.layout.get("text-rotate").evaluate(Po,{},io),Ai));const Dg=Xl.positionedLines.length===1;if(gD+=GR(kn,br,vn,Xl,ri,Yr,Ii,Po,Ai,Xu,nr.vertical?gu.horizontal:gu.horizontalOnly,Dg?Object.keys(nr.horizontal):[ql],Ed,kI,Zs,fa,io,Il),Dg)break}nr.vertical&&(yD+=GR(kn,br,vn,nr.vertical,ri,Yr,Ii,Po,Ai,Xu,gu.vertical,["vertical"],Ed,MI,Zs,fa,io,Il));let Cf=-1;const RI=(ql,Xl)=>ql?Math.max(ql,Xl):Xl;Cf=RI(J_,Cf),Cf=RI(hD,Cf),Cf=RI(fD,Cf);const u9=Cf>-1?1:0;kn.glyphOffsetArray.length>=65535&&vr("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Po.sortKey!==void 0&&kn.addToSortKeyRanges(kn.symbolInstances.length,Po.sortKey),kn.symbolInstances.emplaceBack(vn.x,vn.y,Kp.x,Kp.y,Kp.z,Ed.right>=0?Ed.right:-1,Ed.center>=0?Ed.center:-1,Ed.left>=0?Ed.left:-1,Ed.vertical>=0?Ed.vertical:-1,kI,MI,_D,Yu!==void 0?Yu:kn.collisionBoxArray.length,Yu!==void 0?Yu+1:kn.collisionBoxArray.length,Sf!==void 0?Sf:kn.collisionBoxArray.length,Sf!==void 0?Sf+1:kn.collisionBoxArray.length,Yp!==void 0?Yp:kn.collisionBoxArray.length,Yp!==void 0?Yp+1:kn.collisionBoxArray.length,Zp||kn.collisionBoxArray.length,Zp?Zp+1:kn.collisionBoxArray.length,li,gD,yD,pD,mD,u9,0,AI,LI,Cf,0,PI?1:0)})(d,Qt,$n,gn,l,h,v,Rt,d.layers[0],d.collisionBoxArray,i.index,i.sourceLayerIndex,d.index,Xe,ct,z,0,Ze,Qe,ie,i,p,V,E,L,O,F)};if(pt==="line")for(const gn of zR(i.geometry,0,0,Nn,Nn)){const Qt=UU(gn,Be,He,l.vertical||pe,h,ae,Te,d.overscaling,Nn);for(const Qn of Qt)pe&&YU(d,pe.text,St,Qn)||ln(gn,Qn,L)}else if(pt==="line-center"){for(const gn of i.geometry)if(gn.length>1){const Qt=$U(gn,He,l.vertical||pe,h,ae,Te);Qt&&ln(gn,Qt,L)}}else if(i.type==="Polygon")for(const gn of yb(i.geometry,0)){const Qt=HU(gn,16);ln(gn[0],new ph(Qt.x,Qt.y,0,0,void 0),L)}else if(i.type==="LineString")for(const gn of i.geometry)ln(gn,new ph(gn[0].x,gn[0].y,0,0,void 0),L);else if(i.type==="Point")for(const gn of i.geometry)for(const Qt of gn)ln([Qt],new ph(Qt.x,Qt.y,0,0,void 0),L)}const D_=255,vf=D_*Oc;function GR(d,i,l,h,v,p,x,M,z,V,E,L,B,O,F,G,Q,ie){const pe=function(be,Te,Be,Xe,Ze,He,ct,Qe){const pt=[];if(Te.positionedLines.length===0)return pt;const St=Xe.layout.get("text-rotate").evaluate(He,{})*Math.PI/180,Tt=function(ln){const gn=ln[0],Qt=ln[1],Qn=gn*Qt;return Qn>0?[gn,-Qt]:Qn<0?[-gn,Qt]:gn===0?[Qt,gn]:[Qt,-gn]}(Be);let It=Math.abs(Te.top-Te.bottom);for(const ln of Te.positionedLines)It-=ln.lineOffset;const Lt=Te.positionedLines.length,Yt=It/Lt;let Rt=Te.top-Be[1];for(let ln=0;ln<Lt;++ln){const gn=Te.positionedLines[ln];Rt=GU(Te,Yt,Rt,ln);for(const Qt of gn.positionedGlyphs){if(!Qt.rect)continue;const Qn=Qt.rect||{};let $n=CR+1,kn=!0,vn=1,br=0;if(Qt.imageName){const Qo=ct[Qt.imageName];if(!Qo)continue;if(Qo.sdf){vr("SDF images are not supported in formatted text and will be ignored.");continue}kn=!1,vn=Qo.pixelRatio,$n=R_/vn}const Zn=(Ze||Qe)&&Qt.vertical,nr=Qt.metrics.advance*Qt.scale/2,Br=Qt.metrics,ri=Qt.rect;if(ri===null)continue;Qe&&Te.verticalizable&&(br=Qt.imageName?nr-Qt.metrics.width*Qt.scale/2:0);const Xr=Ze?[Qt.x+nr,Qt.y]:[0,0];let Yr=[0,0],si=[0,0],li=!1;Ze||(Zn?(si=[Qt.x+nr+Tt[0],Qt.y+Tt[1]-br],li=!0):Yr=[Qt.x+nr+Be[0],Qt.y+Be[1]-br]);const Xi=ri.w*Qt.scale/(vn*(Qt.localGlyph?Dc:1)),Di=ri.h*Qt.scale/(vn*(Qt.localGlyph?Dc:1));let jr,Ii,Ai,lo;if(Zn){const Qo=Qt.y-Rt,Po=new st(-nr,nr-Qo),Zs=-Math.PI/2,ys=new st(...si);jr=new st(-nr+Yr[0],Yr[1]),jr._rotateAround(Zs,Po)._add(ys),jr.x+=-Qo+nr,jr.y-=(Br.left-$n)*Qt.scale;const fa=Qt.imageName?Br.advance*Qt.scale:ha*Qt.scale,io=String.fromCodePoint(Qt.glyph);RU(io)?jr.x+=(1-$n)*Qt.scale:OU(io)?jr.x+=fa-Br.height*Qt.scale+(-$n-1)*Qt.scale:jr.x+=Qt.imageName||Br.width+2*$n===ri.w&&Br.height+2*$n===ri.h?(fa-Di)/2:(fa-(Br.height+2*$n)*Qt.scale)/2,Ii=new st(jr.x,jr.y-Xi),Ai=new st(jr.x+Di,jr.y),lo=new st(jr.x+Di,jr.y-Xi)}else{const Qo=(Br.left-$n)*Qt.scale-nr+Yr[0],Po=(-Br.top-$n)*Qt.scale+Yr[1],Zs=Qo+Xi,ys=Po+Di;jr=new st(Qo,Po),Ii=new st(Zs,Po),Ai=new st(Qo,ys),lo=new st(Zs,ys)}if(St){let Qo;Qo=Ze?new st(0,0):li?new st(Tt[0],Tt[1]):new st(Be[0],Be[1]),jr._rotateAround(St,Qo),Ii._rotateAround(St,Qo),Ai._rotateAround(St,Qo),lo._rotateAround(St,Qo)}const Jo=new st(0,0),hs=new st(0,0);pt.push({tl:jr,tr:Ii,bl:Ai,br:lo,texPrimary:Qn,texSecondary:void 0,writingMode:Te.writingMode,glyphOffset:Xr,sectionIndex:Qt.sectionIndex,isSDF:kn,pixelOffsetTL:Jo,pixelOffsetBR:hs,minFontScaleX:0,minFontScaleY:0})}}return pt}(0,h,z,p,x,M,v,d.allowVerticalPlacement),ge=d.textSizeData;let ae=null;ge.kind==="source"?(ae=[Oc*p.layout.get("text-size").evaluate(M,{},Q)],ae[0]>vf&&vr(`${d.layerIds[0]}: Value for "text-size" is >= ${D_}. Reduce your "text-size".`)):ge.kind==="composite"&&(ae=[Oc*F.compositeTextSizes[0].evaluate(M,{},Q),Oc*F.compositeTextSizes[1].evaluate(M,{},Q)],(ae[0]>vf||ae[1]>vf)&&vr(`${d.layerIds[0]}: Value for "text-size" is >= ${D_}. Reduce your "text-size".`)),d.addSymbols(d.text,pe,ae,z,x,M,E,i,l,V.lineStartIndex,V.lineLength,O,G,Q,ie,!1);for(const be of L)B[be]=d.text.placedSymbolArray.length-1;return 4*pe.length}function HR(d){for(const i in d)return d[i];return null}function Pb(d,i,l,h,v,p,x,M,z,V){let E=x.top,L=x.bottom,B=x.left,O=x.right;const F=x.collisionPadding;if(F&&(B-=F[0],E-=F[1],O+=F[2],L+=F[3]),z){const G=new st(B,E),Q=new st(O,E),ie=new st(B,L),pe=new st(O,L),ge=nt(z);let ae=new st(0,0);V&&(ae=new st(V[0],V[1])),G._rotateAround(ge,ae),Q._rotateAround(ge,ae),ie._rotateAround(ge,ae),pe._rotateAround(ge,ae),B=Math.min(G.x,Q.x,ie.x,pe.x),O=Math.max(G.x,Q.x,ie.x,pe.x),E=Math.min(G.y,Q.y,ie.y,pe.y),L=Math.max(G.y,Q.y,ie.y,pe.y)}return d.emplaceBack(i.x,i.y,i.z,l.x,l.y,B,E,O,L,M,h,v,p),d.length-1}function eI(d){d.collisionPadding&&(d.top-=d.collisionPadding[1],d.bottom+=d.collisionPadding[3]);const i=d.bottom-d.top;return i>0?Math.max(10,i):null}function YU(d,i,l,h){const v=d.compareText;if(i in v){const p=v[i];for(let x=p.length-1;x>=0;x--)if(h.dist(p[x])<l)return!0}else v[i]=[];return v[i].push(h),!1}function WR(d,i){const l=d.fovAboveCenter,h=d.elevation?d.elevation.getMinElevationBelowMSL()*i:0,v=(d._camera.position[2]*d.worldSize-h)/Math.cos(d._pitch),p=Math.sin(l)*v/Math.sin(Math.max(Math.PI/2-d._pitch-l,.01));let x=Math.sin(d._pitch)*p+v;const M=v*(1/d._horizonShift);return d.elevation&&d.elevation.exaggeration()!==0||(x*=1+Math.max(d.zoom-17,0)),Math.min(1.01*x,M)}function z_(d,i){if(!i.isReprojectedInTileSpace)return{scale:1<<d.z,x:d.x,y:d.y,x2:d.x+1,y2:d.y+1,projection:i};const l=Math.pow(2,-d.z),h=d.x*l,v=(d.x+1)*l,p=d.y*l,x=(d.y+1)*l,M=it(h),z=it(v),V=rt(p),E=rt(x),L=i.project(M,V),B=i.project(z,V),O=i.project(z,E),F=i.project(M,E);let G=Math.min(L.x,B.x,O.x,F.x),Q=Math.min(L.y,B.y,O.y,F.y),ie=Math.max(L.x,B.x,O.x,F.x),pe=Math.max(L.y,B.y,O.y,F.y);const ge=l/16;function ae(Te,Be,Xe,Ze,He,ct){const Qe=(Xe+He)/2,pt=(Ze+ct)/2,St=i.project(it(Qe),rt(pt)),Tt=Math.max(0,G-St.x,Q-St.y,St.x-ie,St.y-pe);G=Math.min(G,St.x),ie=Math.max(ie,St.x),Q=Math.min(Q,St.y),pe=Math.max(pe,St.y),Tt>ge&&(ae(Te,St,Xe,Ze,Qe,pt),ae(St,Be,Qe,pt,He,ct))}ae(L,B,h,p,v,p),ae(B,O,v,p,v,x),ae(O,F,v,x,h,x),ae(F,L,h,x,h,p),G-=ge,Q-=ge,ie+=ge,pe+=ge;const be=1/Math.max(ie-G,pe-Q);return{scale:be,x:G*be,y:Q*be,x2:ie*be,y2:pe*be,projection:i}}function qR(d,{x:i,y:l},h=0){return new st(((i-h)*d.scale-d.x)*Nn,(l*d.scale-d.y)*Nn)}const ZU=Ne.mat4.identity(new Float32Array(16));class xf{constructor(i){this.spec=i,this.name=i.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(i,l){return{x:0,y:0,z:0}}unproject(i,l){return new me(0,0)}projectTilePoint(i,l,h){return{x:i,y:l,z:0}}locationPoint(i,l,h=!0){return i._coordinatePoint(i.locationCoordinate(l),h)}pixelsPerMeter(i,l){return qe(1,i)*l}pixelSpaceConversion(i,l,h){return 1}farthestPixelDistance(i){return WR(i,i.pixelsPerMeter)}pointCoordinate(i,l,h,v){const p=i.horizonLineFromTop(!1),x=new st(l,Math.max(p,h));return i.rayIntersectionCoordinate(i.pointRayIntersection(x,v))}pointCoordinate3D(i,l,h){const v=new st(l,h);if(i.elevation)return i.elevation.pointCoordinate(v);{const p=this.pointCoordinate(i,v.x,v.y,0);return[p.x,p.y,p.z]}}isPointAboveHorizon(i,l){if(i.elevation&&i.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(i,l.x,l.y);const h=i.horizonLineFromTop();return l.y<h}createInversionMatrix(i,l){return ZU}createTileMatrix(i,l,h){let v,p,x;const M=h.canonical,z=Ne.mat4.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){const V=z_(M,this);v=1,p=V.x+h.wrap*V.scale,x=V.y,Ne.mat4.scale(z,z,[v/V.scale,v/V.scale,i.pixelsPerMeter/l])}else v=l/i.zoomScale(M.z),p=(M.x+Math.pow(2,M.z)*h.wrap)*v,x=M.y*v;return Ne.mat4.translate(z,z,[p,x,0]),Ne.mat4.scale(z,z,[v/Nn,v/Nn,1]),z}upVector(i,l,h){return[0,0,1]}upVectorScale(i,l,h){return{metersToTile:1}}}class KU extends xf{constructor(i){super(i),this.range=[4,7],this.center=i.center||[-96,37.5];const[l,h]=this.parallels=i.parallels||[29.5,45.5],v=Math.sin(nt(l));this.n=(v+Math.sin(nt(h)))/2,this.c=1+v*(2*this.n-v),this.r0=Math.sqrt(this.c)/this.n}project(i,l){const{n:h,c:v,r0:p}=this,x=nt(i-this.center[0]),M=nt(l),z=Math.sqrt(v-2*h*Math.sin(M))/h;return{x:z*Math.sin(x*h),y:z*Math.cos(x*h)-p,z:0}}unproject(i,l){const{n:h,c:v,r0:p}=this,x=p+l;let M=Math.atan2(i,Math.abs(x))*Math.sign(x);x*h<0&&(M-=Math.PI*Math.sign(i)*Math.sign(x));const z=nt(this.center[0])*h;M=ar(M,-Math.PI-z,Math.PI-z);const V=Wt(tn(M/h)+this.center[0],-180,180),E=Math.asin(Wt((v-(i*i+x*x)*h*h)/(2*h),-1,1)),L=Wt(tn(E),-dt,dt);return new me(V,L)}}const F_=1.340264,N_=-.081106,B_=893e-6,j_=.003796,Ab=Math.sqrt(3)/2;class JU extends xf{project(i,l){l=l/180*Math.PI,i=i/180*Math.PI;const h=Math.asin(Ab*Math.sin(l)),v=h*h,p=v*v*v;return{x:.5*(i*Math.cos(h)/(Ab*(F_+3*N_*v+p*(7*B_+9*j_*v)))/Math.PI+.5),y:1-.5*(h*(F_+N_*v+p*(B_+j_*v))/Math.PI+1),z:0}}unproject(i,l){i=(2*i-.5)*Math.PI;let h=l=(2*(1-l)-1)*Math.PI,v=h*h,p=v*v*v;for(let E,L,B,O=0;O<12&&(L=h*(F_+N_*v+p*(B_+j_*v))-l,B=F_+3*N_*v+p*(7*B_+9*j_*v),E=L/B,h=Wt(h-E,-Math.PI/3,Math.PI/3),v=h*h,p=v*v*v,!(Math.abs(E)<1e-12));++O);const x=Ab*i*(F_+3*N_*v+p*(7*B_+9*j_*v))/Math.cos(h),M=Math.asin(Math.sin(h)/Ab),z=Wt(180*x/Math.PI,-180,180),V=Wt(180*M/Math.PI,-dt,dt);return new me(z,V)}}class QU extends xf{constructor(i){super(i),this.wrap=!0,this.supportsWorldCopies=!0}project(i,l){return{x:.5+i/360,y:.5-l/360,z:0}}unproject(i,l){const h=360*(i-.5),v=Wt(360*(.5-l),-dt,dt);return new me(h,v)}}const kg=Math.PI/2;function Lb(d){return Math.tan((kg+d)/2)}class eG extends xf{constructor(i){super(i),this.center=i.center||[0,30];const[l,h]=this.parallels=i.parallels||[30,30];let v=nt(l),p=nt(h);this.southernCenter=v+p<0,this.southernCenter&&(v=-v,p=-p);const x=Math.cos(v),M=Lb(v);this.n=v===p?Math.sin(v):Math.log(x/Math.cos(p))/Math.log(Lb(p)/M),this.f=x*Math.pow(Lb(v),this.n)/this.n}project(i,l){l=nt(l),this.southernCenter&&(l=-l),i=nt(i-this.center[0]);const h=1e-6,{n:v,f:p}=this;p>0?l<-kg+h&&(l=-kg+h):l>kg-h&&(l=kg-h);const x=p/Math.pow(Lb(l),v);let M=x*Math.sin(v*i),z=p-x*Math.cos(v*i);return M=.5*(M/Math.PI+.5),z=.5*(z/Math.PI+.5),{x:M,y:this.southernCenter?z:1-z,z:0}}unproject(i,l){i=(2*i-.5)*Math.PI,this.southernCenter&&(l=1-l),l=(2*(1-l)-.5)*Math.PI;const{n:h,f:v}=this,p=v-l,x=Math.sign(p),M=Math.sign(h)*Math.sqrt(i*i+p*p);let z=Math.atan2(i,Math.abs(p))*x;p*h<0&&(z-=Math.PI*Math.sign(i)*x);const V=Wt(tn(z/h)+this.center[0],-180,180),E=Wt(tn(2*Math.atan(Math.pow(v/M,1/h))-kg),-dt,dt);return new me(V,this.southernCenter?-E:E)}}class XR extends xf{constructor(i){super(i),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(i,l){return{x:Ye(i),y:Je(l),z:0}}unproject(i,l){const h=it(i),v=rt(l);return new me(h,v)}}const YR=nt(dt);class tG extends xf{project(i,l){const h=(l=nt(l))*l,v=h*h;return{x:.5*((i=nt(i))*(.8707-.131979*h+v*(v*(.003971*h-.001529*v)-.013791))/Math.PI+.5),y:1-.5*(l*(1.007226+h*(.015085+v*(.028874*h-.044475-.005916*v)))/Math.PI+1),z:0}}unproject(i,l){i=(2*i-.5)*Math.PI;let h=l=(2*(1-l)-1)*Math.PI,v=25,p=0,x=h*h;do{x=h*h;const V=x*x;p=(h*(1.007226+x*(.015085+V*(.028874*x-.044475-.005916*V)))-l)/(1.007226+x*(.045255+V*(.259866*x-.311325-.005916*11*V))),h=Wt(h-p,-YR,YR)}while(Math.abs(p)>1e-6&&--v>0);x=h*h;const M=Wt(tn(i/(.8707+x*(x*(x*x*x*(.003971-.001529*x)-.013791)-.131979))),-180,180),z=tn(h);return new me(M,z)}}const ZR=nt(dt);class nG extends xf{project(i,l){l=nt(l),i=nt(i);const h=Math.cos(l),v=2/Math.PI,p=Math.acos(h*Math.cos(i/2)),x=Math.sin(p)/p,M=.5*(i*v+2*h*Math.sin(i/2)/x)||0,z=.5*(l+Math.sin(l)/x)||0;return{x:.5*(M/Math.PI+.5),y:1-.5*(z/Math.PI+1),z:0}}unproject(i,l){let h=i=(2*i-.5)*Math.PI,v=l=(2*(1-l)-1)*Math.PI,p=25;const x=1e-6;let M=0,z=0;do{const V=Math.cos(v),E=Math.sin(v),L=2*E*V,B=E*E,O=V*V,F=Math.cos(h/2),G=Math.sin(h/2),Q=2*F*G,ie=G*G,pe=1-O*F*F,ge=pe?1/pe:0,ae=pe?Math.acos(V*F)*Math.sqrt(1/pe):0,be=.5*(2*ae*V*G+2*h/Math.PI)-i,Te=.5*(ae*E+v)-l,Be=.5*ge*(O*ie+ae*V*F*B)+1/Math.PI,Xe=ge*(Q*L/4-ae*E*G),Ze=.125*ge*(L*G-ae*E*O*Q),He=.5*ge*(B*F+ae*ie*V)+.5,ct=Xe*Ze-He*Be;M=(Te*Xe-be*He)/ct,z=(be*Ze-Te*Be)/ct,h=Wt(h-M,-Math.PI,Math.PI),v=Wt(v-z,-ZR,ZR)}while((Math.abs(M)>x||Math.abs(z)>x)&&--p>0);return new me(tn(h),tn(v))}}class KR extends xf{constructor(i){super(i),this.center=i.center||[0,0],this.parallels=i.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(nt(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(i,l){const{scale:h,cosPhi:v}=this;return{x:nt(i)*v*h+.5,y:-Math.sin(nt(l))/v*h+.5,z:0}}unproject(i,l){const{scale:h,cosPhi:v}=this,p=-(l-.5)/h,x=Wt(tn((i-.5)/h)/v,-180,180),M=Math.asin(Wt(p*v,-1,1)),z=Wt(tn(M),-dt,dt);return new me(x,z)}}class rG extends XR{constructor(i){super(i),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(i,l,h){const v=x_(i,l,h),p=fb(Sd(h));return Ne.vec3.transformMat4(v,v,p),{x:v[0],y:v[1],z:v[2]}}locationPoint(i,l){const h=te(l.lat,l.lng),v=Ne.vec3.normalize([],h),p=i.elevation?i.elevation.getAtPointOrZero(i.locationCoordinate(l),i._centerAltitude):i._centerAltitude,x=qe(1,0)*Nn*p;Ne.vec3.scaleAndAdd(h,h,v,x);const M=Ne.mat4.identity(new Float64Array(16));return Ne.mat4.multiply(M,i.pixelMatrix,i.globeMatrix),Ne.vec3.transformMat4(h,h,M),new st(h[0],h[1])}pixelsPerMeter(i,l){return qe(1,0)*l}pixelSpaceConversion(i,l,h){const v=qe(1,i)*l,p=sr(qe(1,45)*l,v,h);return this.pixelsPerMeter(i,l)/p}createTileMatrix(i,l,h){const v=CT(Sd(h.canonical));return Ne.mat4.multiply(new Float64Array(16),i.globeMatrix,v)}createInversionMatrix(i,l){const{center:h}=i,v=fb(Sd(l));return Ne.mat4.rotateY(v,v,nt(h.lng)),Ne.mat4.rotateX(v,v,nt(h.lat)),Ne.mat4.scale(v,v,[i._pixelsPerMercatorPixel,i._pixelsPerMercatorPixel,1]),Float32Array.from(v)}pointCoordinate(i,l,h,v){return cb(i,l,h,!0)||new Ot(0,0)}pointCoordinate3D(i,l,h){const v=this.pointCoordinate(i,l,h,0);return[v.x,v.y,v.z]}isPointAboveHorizon(i,l){return!cb(i,l.x,l.y,!1)}farthestPixelDistance(i){const l=function(v,p){const x=v.cameraToCenterDistance,M=v._centerAltitude*p,z=v._camera,V=v._camera.forward(),E=Ne.vec3.add([],Ne.vec3.scale([],V,-x),[0,0,M]),L=v.worldSize/(2*Math.PI),B=[0,0,-L],O=v.width/v.height,F=Math.tan(v.fovAboveCenter),G=Ne.vec3.scale([],z.up(),F),Q=Ne.vec3.scale([],z.right(),F*O),ie=Ne.vec3.normalize([],Ne.vec3.add([],Ne.vec3.add([],V,G),Q)),pe=[];let ge;if(new Rc(E,ie).closestPointOnSphere(B,L,pe)){const ae=Ne.vec3.add([],pe,B),be=Ne.vec3.sub([],ae,E);ge=Math.cos(v.fovAboveCenter)*Ne.vec3.length(be)}else{const ae=Ne.vec3.sub([],E,B),be=Ne.vec3.sub([],B,E);Ne.vec3.normalize(be,be);const Te=Ne.vec3.length(ae)-L;ge=Math.sqrt(Te*(Te+2*L));const Be=Math.acos(ge/(L+Te))-Math.acos(Ne.vec3.dot(V,be));ge*=Math.cos(Be)}return 1.01*ge}(i,this.pixelsPerMeter(i.center.lat,i.worldSize)),h=mf(i.zoom);if(h>0){const v=WR(i,qe(1,i.center.lat)*i.worldSize),p=i.worldSize/(2*Math.PI),x=Math.max(i.width,i.height)/i.worldSize*Math.PI;return sr(l,v+p*(1-Math.cos(x)),Math.pow(h,10))}return l}upVector(i,l,h){return x_(l,h,i,1)}upVectorScale(i){return{metersToTile:hh(hb(Sd(i)))}}}function JR(d){const i=d.parallels,l=!!i&&Math.abs(i[0]+i[1])<.01;switch(d.name){case"mercator":return new XR(d);case"equirectangular":return new QU(d);case"naturalEarth":return new tG(d);case"equalEarth":return new JU(d);case"winkelTripel":return new nG(d);case"albers":return l?new KR(d):new KU(d);case"lambertConformalConic":return l?new KR(d):new eG(d);case"globe":return new rG(d)}throw new Error(`Invalid projection name: ${d.name}`)}const iG=Sg.VectorTileFeature.types,oG=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Rb(d,i,l,h,v,p,x,M,z,V,E,L,B){const O=M?Math.min(vf,Math.round(M[0])):0,F=M?Math.min(vf,Math.round(M[1])):0;d.emplaceBack(i,l,Math.round(32*h),Math.round(32*v),p,x,(O<<1)+(z?1:0),F,16*V,16*E,256*L,256*B)}function Ob(d,i,l){d.emplaceBack(i,l)}function Db(d,i,l,h,v,p,x){d.emplaceBack(i,l,h,v,p,x)}function zb(d,i,l,h,v){d.emplaceBack(i,l,h,v),d.emplaceBack(i,l,h,v),d.emplaceBack(i,l,h,v),d.emplaceBack(i,l,h,v)}function sG(d){for(const i of d.sections)if(sT(i.text))return!0;return!1}class tI{constructor(i){this.layoutVertexArray=new s_,this.indexArray=new sa,this.programConfigurations=i,this.segments=new No,this.dynamicLayoutVertexArray=new Mc,this.opacityVertexArray=new l_,this.placedSymbolArray=new f_,this.iconTransitioningVertexArray=new xd,this.globeExtVertexArray=new a_,this.zOffsetVertexArray=new uf}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(i,l,h,v,p){this.isEmpty()||(h&&(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,SU.members),this.indexBuffer=i.createIndexBuffer(this.indexArray,l),this.dynamicLayoutVertexBuffer=i.createVertexBuffer(this.dynamicLayoutVertexArray,EU.members,!0),this.opacityVertexBuffer=i.createVertexBuffer(this.opacityVertexArray,oG,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=i.createVertexBuffer(this.iconTransitioningVertexArray,IU.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=i.createVertexBuffer(this.globeExtVertexArray,CU.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||p)&&(this.zOffsetVertexBuffer=i.createVertexBuffer(this.zOffsetVertexArray,TU.members,!0)),this.opacityVertexBuffer.itemSize=1),(h||v)&&this.programConfigurations.upload(i))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}ir(tI,"SymbolBuffers");class nI{constructor(i,l,h){this.layoutVertexArray=new i,this.layoutAttributes=l,this.indexArray=new h,this.segments=new No,this.collisionVertexArray=new lf,this.collisionVertexArrayExt=new Mc}upload(i){this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=i.createVertexBuffer(this.collisionVertexArray,kU.members,!0),this.collisionVertexBufferExt=i.createVertexBuffer(this.collisionVertexArrayExt,MU.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}ir(nI,"CollisionBuffers");class Fb{constructor(i){this.collisionBoxArray=i.collisionBoxArray,this.zoom=i.zoom,this.lut=i.lut,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(x=>x.fqid),this.index=i.index,this.pixelRatio=i.pixelRatio,this.sourceLayerIndex=i.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Ne.mat4.identity([]),this.placementViewportMatrix=Ne.mat4.identity([]);const l=this.layers[0]._unevaluatedLayout._values;this.textSizeData=GT(this.zoom,l["text-size"]),this.iconSizeData=GT(this.zoom,l["icon-size"]);const h=this.layers[0].layout,v=h.get("symbol-sort-key"),p=h.get("symbol-z-order");this.canOverlap=h.get("text-allow-overlap")||h.get("icon-allow-overlap")||h.get("text-ignore-placement")||h.get("icon-ignore-placement"),this.sortFeaturesByKey=p!=="viewport-y"&&v.constantOr(1)!==void 0,this.sortFeaturesByY=(p==="viewport-y"||p==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=h.get("text-writing-mode").map(x=>gu[x]),this.stateDependentLayerIds=this.layers.filter(x=>x.isStateDependent()).map(x=>x.id),this.sourceID=i.sourceID,this.projection=i.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=h.get("symbol-z-elevate"),this.activeReplacements=[],this.replacementUpdateTime=0}createArrays(){this.text=new tI(new bd(this.layers,{zoom:this.zoom,lut:this.lut},i=>i.startsWith("text")||i.startsWith("symbol"))),this.icon=new tI(new bd(this.layers,{zoom:this.zoom,lut:this.lut},i=>i.startsWith("icon")||i.startsWith("symbol"))),this.glyphOffsetArray=new tb,this.lineVertexArray=new _g,this.symbolInstances=new p_}calculateGlyphDependencies(i,l,h,v,p){for(let x=0;x<i.length;x++){const M=i.codePointAt(x);if(M===void 0)break;if(l[M]=!0,v&&p&&M<=65535){const z=A_[i.charAt(x)];z&&(l[z.charCodeAt(0)]=!0)}}}updateFootprints(i,l){}updateReplacement(i,l){if(l.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=l.updateTime;const h=l.getReplacementRegionsForTile(i.toUnwrapped(),!0);return!NT(this.activeReplacements,h)&&(this.activeReplacements=h,!0)}populate(i,l,h,v){const p=this.layers[0],x=p.layout,M=this.projection.name==="globe",z=x.get("text-font"),V=x.get("text-field"),E=x.get("icon-image"),L=(V.value.kind!=="constant"||V.value.value instanceof Yo&&!V.value.value.isEmpty()||V.value.value.toString().length>0)&&(z.value.kind!=="constant"||z.value.value.length>0),B=E.value.kind!=="constant"||!!E.value.value||Object.keys(E.parameters).length>0,O=x.get("symbol-sort-key");if(this.features=[],!L&&!B)return;const F=l.iconDependencies,G=l.glyphDependencies,Q=l.availableImages,ie=new Fo(this.zoom);for(const{feature:pe,id:ge,index:ae,sourceLayerIndex:be}of i){const Te=p._featureFilter.needGeometry,Be=An(pe,Te);if(!p._featureFilter.filter(ie,Be,h))continue;if(Te||(Be.geometry=In(pe,h,v)),M&&pe.type!==1&&h.z<=5){const ct=Be.geometry,Qe=.98078528056,pt=(St,Tt)=>{const It=x_(St.x,St.y,h,1),Lt=x_(Tt.x,Tt.y,h,1);return Ne.vec3.dot(It,Lt)<Qe};for(let St=0;St<ct.length;St++)ct[St]=Tn(ct[St],pt)}let Xe,Ze;if(L){const ct=p.getValueAndResolveTokens("text-field",Be,h,Q),Qe=Yo.factory(ct);sG(Qe)&&(this.hasRTLText=!0),(!this.hasRTLText||e_()==="unavailable"||this.hasRTLText&&nl.isParsed())&&(Xe=LU(Qe,p,Be))}if(B){const ct=p.getValueAndResolveTokens("icon-image",Be,h,Q);Ze=ct instanceof Hs?ct:Hs.fromString(ct)}if(!Xe&&!Ze)continue;const He=this.sortFeaturesByKey?O.evaluate(Be,{},h):void 0;if(this.features.push({id:ge,text:Xe,icon:Ze,index:ae,sourceLayerIndex:be,geometry:Be.geometry,properties:pe.properties,type:iG[pe.type],sortKey:He}),Ze&&(F[Ze.namePrimary]=!0,Ze.nameSecondary&&(F[Ze.nameSecondary]=!0)),Xe){const ct=z.evaluate(Be,{},h).join(","),Qe=x.get("text-rotation-alignment")==="map"&&x.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(gu.vertical)>=0;for(const pt of Xe.sections)if(pt.image)F[pt.image.namePrimary]=!0;else{const St=ng(Xe.toString()),Tt=pt.fontStack||ct,It=G[Tt]=G[Tt]||{};this.calculateGlyphDependencies(pt.text,It,Qe,this.allowVerticalPlacement,St)}}}x.get("symbol-placement")==="line"&&(this.features=function(pe){const ge={},ae={},be=[];let Te=0;function Be(ct){be.push(pe[ct]),Te++}function Xe(ct,Qe,pt){const St=ae[ct];return delete ae[ct],ae[Qe]=St,be[St].geometry[0].pop(),be[St].geometry[0]=be[St].geometry[0].concat(pt[0]),St}function Ze(ct,Qe,pt){const St=ge[Qe];return delete ge[Qe],ge[ct]=St,be[St].geometry[0].shift(),be[St].geometry[0]=pt[0].concat(be[St].geometry[0]),St}function He(ct,Qe,pt){const St=pt?Qe[0][Qe[0].length-1]:Qe[0][0];return`${ct}:${St.x}:${St.y}`}for(let ct=0;ct<pe.length;ct++){const Qe=pe[ct],pt=Qe.geometry,St=Qe.text?Qe.text.toString():null;if(!St){Be(ct);continue}const Tt=He(St,pt),It=He(St,pt,!0);if(Tt in ae&&It in ge&&ae[Tt]!==ge[It]){const Lt=Ze(Tt,It,pt),Yt=Xe(Tt,It,be[Lt].geometry);delete ge[Tt],delete ae[It],ae[He(St,be[Yt].geometry,!0)]=Yt,be[Lt].geometry=null}else Tt in ae?Xe(Tt,It,pt):It in ge?Ze(Tt,It,pt):(Be(ct),ge[Tt]=Te-1,ae[It]=Te-1)}return be.filter(ct=>ct.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((pe,ge)=>pe.sortKey-ge.sortKey)}update(i,l,h,v,p){const x=Object.keys(i).length!==0;if(x&&!this.stateDependentLayers.length)return;const M=x?this.stateDependentLayers:this.layers;this.text.programConfigurations.updatePaintArrays(i,l,M,h,v,p),this.icon.programConfigurations.updatePaintArrays(i,l,M,h,v,p)}updateZOffset(){const i=(p,x,M)=>{h+=x,h>p.length&&p.resize(h);for(let z=-x;z<0;z++)p.emplace(z+h,M)},l=(p,x,M)=>{v+=x,v>p.length&&p.resize(v);for(let z=-x;z<0;z++)p.emplace(z+v,M)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let h=0,v=0;for(let p=0;p<this.symbolInstances.length;p++){const x=this.symbolInstances.get(p),{numHorizontalGlyphVertices:M,numVerticalGlyphVertices:z,numIconVertices:V}=x,E=x.zOffset,L=V>0;if((M>0||z>0)&&(i(this.text.zOffsetVertexArray,M,E),i(this.text.zOffsetVertexArray,z,E)),L){const{placedIconSymbolIndex:B,verticalPlacedIconSymbolIndex:O}=x;B>=0&&l(this.icon.zOffsetVertexArray,V,E),O>=0&&l(this.icon.zOffsetVertexArray,x.numVerticalIconVertices,E)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(i){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(i),this.iconCollisionBox.upload(i)),this.text.upload(i,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(i,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=JR(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(i,l){const h=this.lineVertexArray.length;if(i.segment!==void 0)for(const{x:v,y:p}of l)this.lineVertexArray.emplaceBack(v,p);return{lineStartIndex:h,lineLength:this.lineVertexArray.length-h}}addSymbols(i,l,h,v,p,x,M,z,V,E,L,B,O,F,G,Q){const ie=i.indexArray,pe=i.layoutVertexArray,ge=i.globeExtVertexArray,ae=i.segments.prepareSegment(4*l.length,pe,ie,this.canOverlap?x.sortKey:void 0),be=this.glyphOffsetArray.length,Te=ae.vertexLength,Be=this.allowVerticalPlacement&&M===gu.vertical?Math.PI/2:0,Xe=x.text&&x.text.sections;for(let He=0;He<l.length;He++){const{tl:ct,tr:Qe,bl:pt,br:St,texPrimary:Tt,texSecondary:It,pixelOffsetTL:Lt,pixelOffsetBR:Yt,minFontScaleX:Rt,minFontScaleY:ln,glyphOffset:gn,isSDF:Qt,sectionIndex:Qn}=l[He],$n=ae.vertexLength,kn=gn[1];if(Rb(pe,V.x,V.y,ct.x,kn+ct.y,Tt.x,Tt.y,h,Qt,Lt.x,Lt.y,Rt,ln),Rb(pe,V.x,V.y,Qe.x,kn+Qe.y,Tt.x+Tt.w,Tt.y,h,Qt,Yt.x,Lt.y,Rt,ln),Rb(pe,V.x,V.y,pt.x,kn+pt.y,Tt.x,Tt.y+Tt.h,h,Qt,Lt.x,Yt.y,Rt,ln),Rb(pe,V.x,V.y,St.x,kn+St.y,Tt.x+Tt.w,Tt.y+Tt.h,h,Qt,Yt.x,Yt.y,Rt,ln),z){const{x:vn,y:br,z:Zn}=z.anchor,[nr,Br,ri]=z.up;Db(ge,vn,br,Zn,nr,Br,ri),Db(ge,vn,br,Zn,nr,Br,ri),Db(ge,vn,br,Zn,nr,Br,ri),Db(ge,vn,br,Zn,nr,Br,ri),zb(i.dynamicLayoutVertexArray,vn,br,Zn,Be)}else zb(i.dynamicLayoutVertexArray,V.x,V.y,V.z,Be);if(Q){const vn=It||Tt;Ob(i.iconTransitioningVertexArray,vn.x,vn.y),Ob(i.iconTransitioningVertexArray,vn.x+vn.w,vn.y),Ob(i.iconTransitioningVertexArray,vn.x,vn.y+vn.h),Ob(i.iconTransitioningVertexArray,vn.x+vn.w,vn.y+vn.h)}ie.emplaceBack($n,$n+1,$n+2),ie.emplaceBack($n+1,$n+2,$n+3),ae.vertexLength+=4,ae.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(gn[0]),He!==l.length-1&&Qn===l[He+1].sectionIndex||i.programConfigurations.populatePaintArrays(pe.length,x,x.index,{},O,F,G,Xe&&Xe[Qn])}const Ze=z?z.anchor:V;i.placedSymbolArray.emplaceBack(Ze.x,Ze.y,Ze.z,V.x,V.y,be,this.glyphOffsetArray.length-be,Te,E,L,V.segment,h?h[0]:0,h?h[1]:0,v[0],v[1],M,0,!1,0,B,0)}_commitLayoutVertex(i,l,h,v,p,x,M){i.emplaceBack(l,h,v,p,x,Math.round(M.x),Math.round(M.y))}_addCollisionDebugVertices(i,l,h,v,p,x,M){const z=h.segments.prepareSegment(4,h.layoutVertexArray,h.indexArray),V=z.vertexLength,E=M.tileAnchorX,L=M.tileAnchorY;for(let O=0;O<4;O++)h.collisionVertexArray.emplaceBack(0,0,0,0,0,0);this._commitDebugCollisionVertexUpdate(h.collisionVertexArrayExt,l,i.padding,M.zOffset),this._commitLayoutVertex(h.layoutVertexArray,v,p,x,E,L,new st(i.x1,i.y1)),this._commitLayoutVertex(h.layoutVertexArray,v,p,x,E,L,new st(i.x2,i.y1)),this._commitLayoutVertex(h.layoutVertexArray,v,p,x,E,L,new st(i.x2,i.y2)),this._commitLayoutVertex(h.layoutVertexArray,v,p,x,E,L,new st(i.x1,i.y2)),z.vertexLength+=4;const B=h.indexArray;B.emplaceBack(V,V+1),B.emplaceBack(V+1,V+2),B.emplaceBack(V+2,V+3),B.emplaceBack(V+3,V),z.primitiveLength+=4}_addTextDebugCollisionBoxes(i,l,h,v,p,x){for(let M=v;M<p;M++){const z=h.get(M),V=this.getSymbolInstanceTextSize(i,x,l,M);this._addCollisionDebugVertices(z,V,this.textCollisionBox,z.projectedAnchorX,z.projectedAnchorY,z.projectedAnchorZ,x)}}_addIconDebugCollisionBoxes(i,l,h,v,p,x){for(let M=v;M<p;M++){const z=h.get(M),V=this.getSymbolInstanceIconSize(i,l,x.placedIconSymbolIndex);this._addCollisionDebugVertices(z,V,this.iconCollisionBox,z.projectedAnchorX,z.projectedAnchorY,z.projectedAnchorZ,x)}}generateCollisionDebugBuffers(i,l){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new nI(uh,xR.members,xd),this.iconCollisionBox=new nI(uh,xR.members,xd);const h=Cg(this.iconSizeData,i),v=Cg(this.textSizeData,i);for(let p=0;p<this.symbolInstances.length;p++){const x=this.symbolInstances.get(p);this._addTextDebugCollisionBoxes(v,i,l,x.textBoxStartIndex,x.textBoxEndIndex,x),this._addTextDebugCollisionBoxes(v,i,l,x.verticalTextBoxStartIndex,x.verticalTextBoxEndIndex,x),this._addIconDebugCollisionBoxes(h,i,l,x.iconBoxStartIndex,x.iconBoxEndIndex,x),this._addIconDebugCollisionBoxes(h,i,l,x.verticalIconBoxStartIndex,x.verticalIconBoxEndIndex,x)}}getSymbolInstanceTextSize(i,l,h,v){const p=this.text.placedSymbolArray.get(l.rightJustifiedTextSymbolIndex>=0?l.rightJustifiedTextSymbolIndex:l.centerJustifiedTextSymbolIndex>=0?l.centerJustifiedTextSymbolIndex:l.leftJustifiedTextSymbolIndex>=0?l.leftJustifiedTextSymbolIndex:l.verticalPlacedTextSymbolIndex>=0?l.verticalPlacedTextSymbolIndex:v),x=Cb(this.textSizeData,i,p)/ha;return this.tilePixelRatio*x}getSymbolInstanceIconSize(i,l,h){const v=this.icon.placedSymbolArray.get(h),p=Cb(this.iconSizeData,i,v);return this.tilePixelRatio*p}_commitDebugCollisionVertexUpdate(i,l,h,v){i.emplaceBack(l,-h,-h,v),i.emplaceBack(l,h,-h,v),i.emplaceBack(l,h,h,v),i.emplaceBack(l,-h,h,v)}_updateTextDebugCollisionBoxes(i,l,h,v,p,x){for(let M=v;M<p;M++){const z=h.get(M),V=this.getSymbolInstanceTextSize(i,x,l,M);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,V,z.padding,x.zOffset)}}_updateIconDebugCollisionBoxes(i,l,h,v,p,x){for(let M=v;M<p;M++){const z=h.get(M),V=this.getSymbolInstanceIconSize(i,l,x.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,V,z.padding,x.zOffset)}}updateCollisionDebugBuffers(i,l){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const h=Cg(this.iconSizeData,i),v=Cg(this.textSizeData,i);for(let p=0;p<this.symbolInstances.length;p++){const x=this.symbolInstances.get(p);this._updateTextDebugCollisionBoxes(v,i,l,x.textBoxStartIndex,x.textBoxEndIndex,x),this._updateTextDebugCollisionBoxes(v,i,l,x.verticalTextBoxStartIndex,x.verticalTextBoxEndIndex,x),this._updateIconDebugCollisionBoxes(h,i,l,x.iconBoxStartIndex,x.iconBoxEndIndex,x),this._updateIconDebugCollisionBoxes(h,i,l,x.verticalIconBoxStartIndex,x.verticalIconBoxEndIndex,x)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(i,l,h,v,p,x,M,z,V){const E={};if(l<h){const{x1:L,y1:B,x2:O,y2:F,padding:G,projectedAnchorX:Q,projectedAnchorY:ie,projectedAnchorZ:pe,tileAnchorX:ge,tileAnchorY:ae,featureIndex:be}=i.get(l);E.textBox={x1:L,y1:B,x2:O,y2:F,padding:G,projectedAnchorX:Q,projectedAnchorY:ie,projectedAnchorZ:pe,tileAnchorX:ge,tileAnchorY:ae},E.textFeatureIndex=be}if(v<p){const{x1:L,y1:B,x2:O,y2:F,padding:G,projectedAnchorX:Q,projectedAnchorY:ie,projectedAnchorZ:pe,tileAnchorX:ge,tileAnchorY:ae,featureIndex:be}=i.get(v);E.verticalTextBox={x1:L,y1:B,x2:O,y2:F,padding:G,projectedAnchorX:Q,projectedAnchorY:ie,projectedAnchorZ:pe,tileAnchorX:ge,tileAnchorY:ae},E.verticalTextFeatureIndex=be}if(x<M){const{x1:L,y1:B,x2:O,y2:F,padding:G,projectedAnchorX:Q,projectedAnchorY:ie,projectedAnchorZ:pe,tileAnchorX:ge,tileAnchorY:ae,featureIndex:be}=i.get(x);E.iconBox={x1:L,y1:B,x2:O,y2:F,padding:G,projectedAnchorX:Q,projectedAnchorY:ie,projectedAnchorZ:pe,tileAnchorX:ge,tileAnchorY:ae},E.iconFeatureIndex=be}if(z<V){const{x1:L,y1:B,x2:O,y2:F,padding:G,projectedAnchorX:Q,projectedAnchorY:ie,projectedAnchorZ:pe,tileAnchorX:ge,tileAnchorY:ae,featureIndex:be}=i.get(z);E.verticalIconBox={x1:L,y1:B,x2:O,y2:F,padding:G,projectedAnchorX:Q,projectedAnchorY:ie,projectedAnchorZ:pe,tileAnchorX:ge,tileAnchorY:ae},E.verticalIconFeatureIndex=be}return E}deserializeCollisionBoxes(i){this.collisionArrays=[];for(let l=0;l<this.symbolInstances.length;l++){const h=this.symbolInstances.get(l);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(i,h.textBoxStartIndex,h.textBoxEndIndex,h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h.iconBoxStartIndex,h.iconBoxEndIndex,h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(i,l){const h=i.placedSymbolArray.get(l),v=h.vertexStartIndex+4*h.numGlyphs;for(let p=h.vertexStartIndex;p<v;p+=4)i.indexArray.emplaceBack(p,p+1,p+2),i.indexArray.emplaceBack(p+1,p+2,p+3)}getSortedSymbolIndexes(i){if(this.sortedAngle===i&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const l=Math.sin(i),h=Math.cos(i),v=[],p=[],x=[];for(let M=0;M<this.symbolInstances.length;++M){x.push(M);const z=this.symbolInstances.get(M);v.push(0|Math.round(l*z.tileAnchorX+h*z.tileAnchorY)),p.push(z.featureIndex)}return x.sort((M,z)=>v[M]-v[z]||p[z]-p[M]),x}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let i=0;i<this.symbolInstances.length;++i)this.symbolInstanceIndexesSortedZOffset.push(i)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((i,l)=>this.symbolInstances.get(l).zOffset-this.symbolInstances.get(i).zOffset)}addToSortKeyRanges(i,l){const h=this.sortKeyRanges[this.sortKeyRanges.length-1];h&&h.sortKey===l?h.symbolInstanceEnd=i+1:this.sortKeyRanges.push({sortKey:l,symbolInstanceStart:i,symbolInstanceEnd:i+1})}sortFeatures(i){if(this.sortFeaturesByY&&this.sortedAngle!==i&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(i),this.sortedAngle=i,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const l of this.symbolInstanceIndexes){const h=this.symbolInstances.get(l);this.featureSortOrder.push(h.featureIndex);const{rightJustifiedTextSymbolIndex:v,centerJustifiedTextSymbolIndex:p,leftJustifiedTextSymbolIndex:x,verticalPlacedTextSymbolIndex:M,placedIconSymbolIndex:z,verticalPlacedIconSymbolIndex:V}=h;v>=0&&this.addIndicesForPlacedSymbol(this.text,v),p>=0&&p!==v&&this.addIndicesForPlacedSymbol(this.text,p),x>=0&&x!==p&&x!==v&&this.addIndicesForPlacedSymbol(this.text,x),M>=0&&this.addIndicesForPlacedSymbol(this.text,M),z>=0&&this.addIndicesForPlacedSymbol(this.icon,z),V>=0&&this.addIndicesForPlacedSymbol(this.icon,V)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let QR,eO,rI;ir(Fb,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),Fb.addDynamicAttributes=zb;class tO{constructor(i){this.type=i.property.overrides?i.property.overrides.runtimeType:ta,this.defaultValue=i}evaluate(i){if(i.formattedSection){const l=this.defaultValue.property.overrides;if(l&&l.hasOverride(i.formattedSection))return l.getOverride(i.formattedSection)}return i.feature&&i.featureState?this.defaultValue.evaluate(i.feature,i.featureState):this.defaultValue.property.specification.default}eachChild(i){this.defaultValue.isConstant()||i(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}ir(tO,"FormatSectionOverride",{omit:["defaultValue"]});const iI=()=>rI||(rI={layout:QR||(QR=new vo({"symbol-placement":new zn($t.layout_symbol["symbol-placement"]),"symbol-spacing":new zn($t.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new zn($t.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new gr($t.layout_symbol["symbol-sort-key"]),"symbol-z-order":new zn($t.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new zn($t.layout_symbol["symbol-z-elevate"]),"icon-allow-overlap":new zn($t.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new zn($t.layout_symbol["icon-ignore-placement"]),"icon-optional":new zn($t.layout_symbol["icon-optional"]),"icon-rotation-alignment":new zn($t.layout_symbol["icon-rotation-alignment"]),"icon-size":new gr($t.layout_symbol["icon-size"]),"icon-text-fit":new gr($t.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new gr($t.layout_symbol["icon-text-fit-padding"]),"icon-image":new gr($t.layout_symbol["icon-image"]),"icon-rotate":new gr($t.layout_symbol["icon-rotate"]),"icon-padding":new zn($t.layout_symbol["icon-padding"]),"icon-keep-upright":new zn($t.layout_symbol["icon-keep-upright"]),"icon-offset":new gr($t.layout_symbol["icon-offset"]),"icon-anchor":new gr($t.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new zn($t.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new zn($t.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new zn($t.layout_symbol["text-rotation-alignment"]),"text-field":new gr($t.layout_symbol["text-field"]),"text-font":new gr($t.layout_symbol["text-font"]),"text-size":new gr($t.layout_symbol["text-size"]),"text-max-width":new gr($t.layout_symbol["text-max-width"]),"text-line-height":new gr($t.layout_symbol["text-line-height"]),"text-letter-spacing":new gr($t.layout_symbol["text-letter-spacing"]),"text-justify":new gr($t.layout_symbol["text-justify"]),"text-radial-offset":new gr($t.layout_symbol["text-radial-offset"]),"text-variable-anchor":new zn($t.layout_symbol["text-variable-anchor"]),"text-anchor":new gr($t.layout_symbol["text-anchor"]),"text-max-angle":new zn($t.layout_symbol["text-max-angle"]),"text-writing-mode":new zn($t.layout_symbol["text-writing-mode"]),"text-rotate":new gr($t.layout_symbol["text-rotate"]),"text-padding":new zn($t.layout_symbol["text-padding"]),"text-keep-upright":new zn($t.layout_symbol["text-keep-upright"]),"text-transform":new gr($t.layout_symbol["text-transform"]),"text-offset":new gr($t.layout_symbol["text-offset"]),"text-allow-overlap":new zn($t.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new zn($t.layout_symbol["text-ignore-placement"]),"text-optional":new zn($t.layout_symbol["text-optional"]),visibility:new zn($t.layout_symbol.visibility)})),paint:eO||(eO=new vo({"icon-opacity":new gr($t.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new gr($t.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new gr($t.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new gr($t.paint_symbol["text-emissive-strength"]),"icon-color":new gr($t.paint_symbol["icon-color"]),"icon-halo-color":new gr($t.paint_symbol["icon-halo-color"]),"icon-halo-width":new gr($t.paint_symbol["icon-halo-width"]),"icon-halo-blur":new gr($t.paint_symbol["icon-halo-blur"]),"icon-translate":new zn($t.paint_symbol["icon-translate"]),"icon-translate-anchor":new zn($t.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new gr($t.paint_symbol["icon-image-cross-fade"]),"text-opacity":new gr($t.paint_symbol["text-opacity"]),"text-occlusion-opacity":new gr($t.paint_symbol["text-occlusion-opacity"]),"text-color":new gr($t.paint_symbol["text-color"],{runtimeType:Gs,getOverride:d=>d.textColor,hasOverride:d=>!!d.textColor}),"text-halo-color":new gr($t.paint_symbol["text-halo-color"]),"text-halo-width":new gr($t.paint_symbol["text-halo-width"]),"text-halo-blur":new gr($t.paint_symbol["text-halo-blur"]),"text-translate":new zn($t.paint_symbol["text-translate"]),"text-translate-anchor":new zn($t.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new zn($t.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new zn($t.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new zn($t.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new zn($t.paint_symbol["icon-color-brightness-max"]),"symbol-z-offset":new gr($t.paint_symbol["symbol-z-offset"]),"symbol-elevation-reference":new zn($t.paint_symbol["symbol-elevation-reference"])}))},rI);class Nb extends ba{constructor(i,l,h,v){super(i,iI(),l,h,v),this._colorAdjustmentMatrix=Ne.mat4.identity([]),this.hasInitialOcclusionOpacityProperties=i.paint!==void 0&&("icon-occlusion-opacity"in i.paint||"text-occlusion-opacity"in i.paint)}recalculate(i,l){super.recalculate(i,l),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const h=this.layout.get("text-writing-mode");if(h){const v=[];for(const p of h)v.indexOf(p)<0&&v.push(p);this.layout._values["text-writing-mode"]=v}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(i,l,h,v){return this._saturation===i&&this._contrast===l&&this._brightnessMin===h&&this._brightnessMax===v||(this._colorAdjustmentMatrix=function(p,x,M,z){p=at(p),x=Ve(x);const V=Ne.mat4.create(),E=p/3,L=1-2*E,B=[L,E,E,0,E,L,E,0,E,E,L,0,0,0,0,1],O=.5-.5*x,F=z-M;return Ne.mat4.multiply(V,[F,0,0,0,0,F,0,0,0,0,F,0,M,M,M,1],[x,0,0,0,0,x,0,0,0,0,x,0,O,O,O,1]),Ne.mat4.multiply(V,V,B),V}(i,l,h,v),this._saturation=i,this._contrast=l,this._brightnessMin=h,this._brightnessMax=v),this._colorAdjustmentMatrix}getValueAndResolveTokens(i,l,h,v){const p=this.layout.get(i).evaluate(l,{},h,v),x=this._unevaluatedLayout._values[i];return x.isDataDriven()||Jm(x.value)||!p?p:function(M,z){return z.replace(/{([^{}]+)}/g,(V,E)=>E in M?String(M[E]):"")}(l.properties,p)}createBucket(i){return new Fb(i)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const i of iI().paint.overridableProperties){if(!Nb.hasPaintOverride(this.layout,i))continue;const l=this.paint.get(i),h=new tO(l),v=new Km(h,l.property.specification,this.scope,this.options);let p=null;p=l.value.kind==="constant"||l.value.kind==="source"?new X0("source",v):new $u("composite",v,l.value.zoomStops,l.value._interpolationType),this.paint._values[i]=new nf(l.property,p,l.parameters)}}_handleOverridablePaintPropertyUpdate(i,l,h){return!(!this.layout||l.isDataDriven()||h.isDataDriven())&&Nb.hasPaintOverride(this.layout,i)}static hasPaintOverride(i,l){const h=i.get("text-field"),v=iI().paint.properties[l];let p=!1;const x=M=>{for(const z of M)if(v.overrides&&v.overrides.hasOverride(z))return void(p=!0)};if(h.value.kind==="constant"&&h.value.value instanceof Yo)x(h.value.value.sections);else if(h.value.kind==="source"){const M=V=>{p||(V instanceof Zo&&to(V.value)===Fl?x(V.value.sections):V instanceof _l?x(V.sections):V.eachChild(M))},z=h.value;z._styleExpression&&M(z._styleExpression.expression)}return p}getProgramIds(){return["symbol"]}getDefaultProgramParams(i,l,h){return{config:new dh(this,{zoom:l,lut:h}),overrideFog:!1}}}let nO,rO,iO,oO;var oI=wi([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);function sI(d){switch(d){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.RGBA;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.DEPTH_COMPONENT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.DEPTH_STENCIL;case WebGL2RenderingContext.R8:case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.RED}}function aI(d){switch(d){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.UNSIGNED_SHORT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.UNSIGNED_INT_24_8;case WebGL2RenderingContext.R8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.FLOAT}}class lI{constructor(i,l,h,v){this.context=i,this.format=h,this.useMipmap=v&&v.useMipmap,this.texture=i.gl.createTexture(),this.update(l,{premultiply:v&&v.premultiply})}update(i,l){const h=i&&i instanceof HTMLVideoElement&&i.width===0?i.videoWidth:i.width,v=i&&i instanceof HTMLVideoElement&&i.height===0?i.videoHeight:i.height,{context:p}=this,{gl:x}=p,{x:M,y:z}=l&&l.position?l.position:{x:0,y:0},V=Math.max(M+h,this.size?this.size[0]:0),E=Math.max(z+v,this.size?this.size[1]:0);!this.size||this.size[0]===V&&this.size[1]===E||(x.bindTexture(x.TEXTURE_2D,null),x.deleteTexture(this.texture),this.texture=x.createTexture(),this.size=null),x.bindTexture(x.TEXTURE_2D,this.texture),p.pixelStoreUnpackFlipY.set(!1),p.pixelStoreUnpack.set(1),p.pixelStoreUnpackPremultiplyAlpha.set(this.format===x.RGBA8&&(!l||l.premultiply!==!1));const L=i instanceof HTMLImageElement||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement||i instanceof ImageData||ImageBitmap&&i instanceof ImageBitmap;if(!this.size&&V>0&&E>0){const B=this.useMipmap?Math.floor(Math.log2(Math.max(V,E)))+1:1;x.texStorage2D(x.TEXTURE_2D,B,this.format,V,E),this.size=[V,E]}if(this.size)if(L)x.texSubImage2D(x.TEXTURE_2D,0,M,z,sI(this.format),aI(this.format),i);else{const B=i.data;B&&x.texSubImage2D(x.TEXTURE_2D,0,M,z,h,v,sI(this.format),aI(this.format),B)}this.useMipmap&&x.generateMipmap(x.TEXTURE_2D)}bind(i,l,h=!1){const{context:v}=this,{gl:p}=v;p.bindTexture(p.TEXTURE_2D,this.texture),i!==this.minFilter&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,i),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,this.useMipmap&&!h?i===p.NEAREST?p.NEAREST_MIPMAP_NEAREST:p.LINEAR_MIPMAP_LINEAR:i),this.minFilter=i),l!==this.wrapS&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,l),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,l),this.wrapS=l)}bindExtraParam(i,l,h,v){const{context:p}=this,{gl:x}=p;x.bindTexture(x.TEXTURE_2D,this.texture),l!==this.magFilter&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MAG_FILTER,l),this.magFilter=l),i!==this.minFilter&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MIN_FILTER,this.useMipmap?i===x.NEAREST?x.NEAREST_MIPMAP_NEAREST:x.LINEAR_MIPMAP_LINEAR:i),this.minFilter=i),h!==this.wrapS&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_S,h),this.wrapS=h),v!==this.wrapT&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_T,v),this.wrapT=v)}destroy(){const{gl:i}=this.context;i.deleteTexture(this.texture),this.texture=null}}class Bb{constructor(i,l){this.context=i,this.texture=l}bind(i,l){const{context:h}=this,{gl:v}=h;v.bindTexture(v.TEXTURE_2D,this.texture),i!==this.minFilter&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,i),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,i),this.minFilter=i),l!==this.wrapS&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,l),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,l),this.wrapS=l)}}function jb(d,i,l,h,v,p,x,M){const z=[d,i,1,l,h,1,v,p,1],V=[x,M,1],E=Ne.mat3.adjoint([],z),[L,B,O]=Ne.vec3.transformMat3(V,V,E);return Ne.mat3.multiply(z,z,[L,0,0,0,B,0,0,0,O])}function sO(d,i,l,h,v,p,x,M){const z=function(V,E,L,B,O,F,G,Q){const ie=jb(0,0,1,0,1,1,0,1),pe=jb(V,E,L,B,O,F,G,Q),ge=Ne.mat3.adjoint([],ie);return Ne.mat3.multiply(pe,pe,ge)}(d,i,l,h,v,p,x,M);return[z[2]/z[8]/Nn,z[5]/z[8]/Nn]}function Vb(d){return[d[0],Math.min(Math.max(d[1],-dt),dt)]}class aO extends Yn{constructor(i,l,h,v){super(),this.id=i,this.dispatcher=h,this.coordinates=l.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(v),this.options=l,this._dirty=!1}load(i,l){if(this._loaded=l||!1,this.fire(new Ut("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return i&&(this.coordinates=i),this._loaded=!0,void this._finishLoading();this._imageRequest=Ma(this.map._requestManager.transformRequest(this.url,Rs.Image),(h,v)=>{this._imageRequest=null,this._loaded=!0,h?this.fire(new nn(h)):v&&(this.image=v instanceof HTMLImageElement?zt.getImageData(v):v,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,i&&(this.coordinates=i),this._finishLoading())})}loaded(){return this._loaded}updateImage(i){return i.url?(this._imageRequest&&i.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=i.url,this.load(i.coordinates,this._loaded),this):this}setTexture(i){if(!(i.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new Bb(this.map.painter.context,i.handle),this.width=i.dimensions[0],this.height=i.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new Ut("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(i){this.map=i,this.load()}onRemove(i){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof Bb||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(i){if(this.coordinates=i,this._boundsArray=void 0,this._unsupportedCoords=!1,!i.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let l=i[0][1],h=i[0][1];for(const p of i)p[1]>h&&(h=p[1]),p[1]<l&&(l=p[1]);const v=(h+l)/2;if(v>dt?this.onNorthPole=!0:v<-dt&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const p=i.map(Ot.fromLngLat);this.tileID=function(x){let M=1/0,z=1/0,V=-1/0,E=-1/0;for(const G of x)M=Math.min(M,G.x),z=Math.min(z,G.y),V=Math.max(V,G.x),E=Math.max(E,G.y);const L=Math.max(V-M,E-z),B=Math.max(0,Math.floor(-Math.log(L)/Math.LN2)),O=Math.pow(2,B);let F=Math.floor((M+V)/2*O);return F>1&&(F-=1),new Ns(B,F,Math.floor((z+E)/2*O))}(p),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new Ut("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(i){for(const ie in this.tiles){const pe=this.tiles[ie];pe.state!=="loaded"&&(pe.state="loaded",pe.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const l=z_(new Ns(0,0,0),this.map.transform.projection),h=[l.projection.project(this.coordinates[0][0],this.coordinates[0][1]),l.projection.project(this.coordinates[1][0],this.coordinates[1][1]),l.projection.project(this.coordinates[2][0],this.coordinates[2][1]),l.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(ie){const pe=ie[1].x-ie[0].x,ge=ie[1].y-ie[0].y,ae=ie[2].x-ie[1].x,be=ie[2].y-ie[1].y,Te=ie[3].x-ie[2].x,Be=ie[3].y-ie[2].y,Xe=ie[0].x-ie[3].x,Ze=ie[0].y-ie[3].y,He=pe*be-ae*ge,ct=ae*Be-Te*be,Qe=Te*Ze-Xe*Be,pt=Xe*ge-pe*Ze;return He>0&&ct>0&&Qe>0&&pt>0||He<0&&ct<0&&Qe<0&&pt<0}(h))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const v=z_(this.tileID,this.map.transform.projection),[p,x,M,z]=this.coordinates.map(ie=>{const pe=v.projection.project(ie[0],ie[1]);return qR(v,pe)._round()});this.perspectiveTransform=sO(p.x,p.y,x.x,x.y,M.x,M.y,z.x,z.y);const V=this._boundsArray=new _d;V.emplaceBack(p.x,p.y,0,0),V.emplaceBack(x.x,x.y,Nn,0),V.emplaceBack(z.x,z.y,0,Nn),V.emplaceBack(M.x,M.y,Nn,Nn),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=i.createVertexBuffer(V,oI.members),this.boundsSegments=No.simpleSegment(0,0,4,2);const E=[],L=[Vb((B=this.coordinates)[0]),Vb(B[1]),Vb(B[2]),Vb(B[3])];var B;const[O,F,G,Q]=function(ie){let pe=ie[0][0],ge=pe,ae=ie[0][1],be=ae;for(let Te=1;Te<ie.length;Te++)ie[Te][0]<pe?pe=ie[Te][0]:ie[Te][0]>ge&&(ge=ie[Te][0]),ie[Te][1]<ae?ae=ie[Te][1]:ie[Te][1]>be&&(be=ie[Te][1]);return[pe,ae,ge-pe,be-ae]}(L);{const ie=new _d,[pe,ge,ae,be]=function(Lt){let Yt=Lt[0].x,Rt=Yt,ln=Lt[0].y,gn=ln;for(let Qt=1;Qt<Lt.length;Qt++)Lt[Qt].x<Yt?Yt=Lt[Qt].x:Lt[Qt].x>Rt&&(Rt=Lt[Qt].x),Lt[Qt].y<ln?ln=Lt[Qt].y:Lt[Qt].y>gn&&(gn=Lt[Qt].y);return[Yt,ln,Rt-Yt,gn-ln]}(h),Te=Lt=>[(Lt.x-pe)/ae,(Lt.y-ge)/be],[Be,Xe,Ze,He]=h.map(Te),ct=function(Lt,Yt,Rt,ln,gn,Qt,Qn,$n){const kn=jb(0,0,1,0,1,1,0,1),vn=jb(Lt,Yt,Rt,ln,gn,Qt,Qn,$n),br=Ne.mat3.adjoint([],vn);return Ne.mat3.multiply(kn,kn,br)}(Be[0],Be[1],Xe[0],Xe[1],Ze[0],Ze[1],He[0],He[1]);this.elevatedGlobePerspectiveTransform=sO(Be[0],Be[1],Xe[0],Xe[1],Ze[0],Ze[1],He[0],He[1]);const Qe=(Lt,Yt)=>{E.push(Lt.lng);const Rt=Math.round((Lt.lng-O)/G*Nn),ln=Math.round((Lt.lat-F)/Q*Nn),gn=Te(Yt),Qt=Ne.vec3.transformMat3([],[gn[0],gn[1],1],ct),Qn=Math.round(Qt[0]/Qt[2]*Nn),$n=Math.round(Qt[1]/Qt[2]*Nn);ie.emplaceBack(Rt,ln,Qn,$n)},pt=h[3].x-h[0].x,St=h[3].y-h[0].y,Tt=h[2].x-h[1].x,It=h[2].y-h[1].y;for(let Lt=0;Lt<65;Lt++){const Yt=Lt/64,Rt=[h[0].x+Yt*pt,h[0].y+Yt*St],ln=[h[1].x+Yt*Tt,h[1].y+Yt*It],gn=ln[0]-Rt[0],Qt=ln[1]-Rt[1];for(let Qn=0;Qn<65;Qn++){const $n=Qn/64,kn={x:Rt[0]+gn*$n,y:Rt[1]+Qt*$n,z:0};Qe(l.projection.unproject(kn.x,kn.y),kn)}}this.elevatedGlobeVertexBuffer=i.createVertexBuffer(ie,oI.members)}{this.maxLongitudeTriangleSize=0;let ie=[],pe=new sa;const ge=(ae,be,Te)=>{pe.emplaceBack(ae,be,Te);const Be=E[ae],Xe=E[be],Ze=E[Te],He=Math.min(Math.min(Be,Xe),Ze),ct=Math.max(Math.max(Be,Xe),Ze)-He;ct>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=ct),ie.push(He+ct/2)};for(let ae=0;ae<64;ae++)for(let be=0;be<64;be++){const Te=65*ae+be,Be=Te+1,Xe=Te+65,Ze=Xe+1;ge(Te,Xe,Be),ge(Be,Xe,Ze)}[ie,pe]=function(ae,be){const Te=Array.from({length:ae.length},(Ze,He)=>He);Te.sort((Ze,He)=>ae[Ze]-ae[He]);const Be=[],Xe=new sa;for(let Ze=0;Ze<Te.length;Ze++){const He=Te[Ze];Be.push(ae[He]);const ct=3*He,Qe=ct+1;Xe.emplaceBack(be.uint16[ct],be.uint16[Qe],be.uint16[Qe+1])}return[Be,Xe]}(ie,pe),this.elevatedGlobeTrianglesCenterLongitudes=ie,this.elevatedGlobeIndexBuffer=i.createIndexBuffer(pe)}this.elevatedGlobeSegments=No.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,G/Nn,0,Q/Nn,0,0,F,O,0])}prepare(){const i=Object.keys(this.tiles).length!==0;if(this.tileID&&!i)return;const l=this.map.painter.context,h=l.gl;!this._dirty||this.texture instanceof Bb||(this.texture?this.texture.update(this.image):(this.texture=new lI(l,this.image,h.RGBA8),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE)),this._dirty=!1),i&&this._prepareData(l)}loadTile(i,l){this.tileID&&this.tileID.equals(i.tileID.canonical)?(this.tiles[String(i.tileID.wrap)]=i,i.buckets={},l(null)):(i.state="errored",l(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(i){const l=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!l)return null;const h=this.elevatedGlobeTrianglesCenterLongitudes;let v=(p=i+180)+360*Math.round((h[0]-p)/360);var p;const x=new No,M=(L,B)=>{x.segments.push({vertexOffset:0,primitiveOffset:L,vertexLength:l.segments[0].vertexLength,primitiveLength:B,sortKey:void 0,vaos:{}})},z=.51*this.maxLongitudeTriangleSize;if(Math.abs(h[0]-v)<=z){const L=ze(h,0,h.length,v+z);return L===h.length||M(L,Vt(h,L+1,h.length,v+360-z)-L),x}v<h[0]&&(v+=360);const V=Vt(h,0,h.length,v-z);if(V===h.length)return M(0,h.length),x;M(0,V-0);const E=ze(h,V+1,h.length,v+z);return E!==h.length&&M(E,h.length-E),x}}const aG=(Math.pow(256,2)-1)/16907520;class lO extends ba{constructor(i,l,h,v){super(i,{layout:iO||(iO=new vo({visibility:new zn($t.layout_raster.visibility)})),paint:oO||(oO=new vo({"raster-opacity":new zn($t.paint_raster["raster-opacity"]),"raster-color":new fu($t.paint_raster["raster-color"]),"raster-color-mix":new zn($t.paint_raster["raster-color-mix"]),"raster-color-range":new zn($t.paint_raster["raster-color-range"]),"raster-hue-rotate":new zn($t.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new zn($t.paint_raster["raster-brightness-min"]),"raster-brightness-max":new zn($t.paint_raster["raster-brightness-max"]),"raster-saturation":new zn($t.paint_raster["raster-saturation"]),"raster-contrast":new zn($t.paint_raster["raster-contrast"]),"raster-resampling":new zn($t.paint_raster["raster-resampling"]),"raster-fade-duration":new zn($t.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new zn($t.paint_raster["raster-emissive-strength"]),"raster-array-band":new zn($t.paint_raster["raster-array-band"]),"raster-elevation":new zn($t.paint_raster["raster-elevation"])}))},l,h,v),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(i){return!(i&&i._source instanceof aO&&(i._source.onNorthPole||i._source.onSouthPole))&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(i){i!=="raster-color"&&i!=="raster-color-range"||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}updateColorRamp(i){if(!this.hasColorMap()||!this._curRampRange)return;const l=this._transitionablePaint._values["raster-color"].value.expression,[h,v]=i||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(h)&&isNaN(v)||h===this._curRampRange[0]&&v===this._curRampRange[1]||(this.colorRamp=b_({expression:l,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:h,end:v}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[h,v])}}let uO,cO,dO,hO,fO;class pO extends ba{constructor(i,l,h,v){super(i,{layout:uO||(uO=new vo({visibility:new zn($t["layout_raster-particle"].visibility)})),paint:cO||(cO=new vo({"raster-particle-array-band":new zn($t["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new zn($t["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new fu($t["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new zn($t["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new zn($t["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new zn($t["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new zn($t["paint_raster-particle"]["raster-particle-reset-rate-factor"]),"raster-particle-elevation":new zn($t["paint_raster-particle"]["raster-particle-elevation"])}))},l,h,v),this._updateColorRamp(),this.lastInvalidatedAt=zt.now()}onRemove(i){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return this.visibility!=="none"}isDraped(i){return!1}_handleSpecialPaintPropertyUpdate(i){i!=="raster-particle-color"&&i!=="raster-particle-max-speed"||(this._updateColorRamp(),this._invalidateAnimationState()),i==="raster-particle-count"&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const i=this._transitionablePaint._values["raster-particle-color"].value.expression,l=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=b_({expression:i,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:l}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=zt.now()}tileCoverLift(){return this.paint.get("raster-particle-elevation")}}class lG extends ba{constructor(i,l){super(i,{},l,null),this.implementation=i,i.slot&&(this.slot=i.slot)}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isDraped(i){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(i){this.implementation.onAdd&&this.implementation.onAdd(i,i.painter.context.gl)}onRemove(i){this.implementation.onRemove&&this.implementation.onRemove(i,i.painter.context.gl)}}function uI(d,i,l){const h=[0,0,1],v=Ne.quat.identity([]);return Ne.quat.rotateY(v,v,l?-nt(d)+Math.PI:nt(d)),Ne.quat.rotateX(v,v,-nt(i)),Ne.vec3.transformQuat(h,h,v),Ne.vec3.normalize(h,h)}function mO(d,i){const l=$b(d.projection,d.zoom,d.width,d.height),h=function(p,x,M,z,V){const E=new me(M.lng-180*bf,M.lat),L=new me(M.lng+180*bf,M.lat),B=p.project(E.lng,E.lat),O=p.project(L.lng,L.lat),F=-Math.atan2(O.y-B.y,O.x-B.x),G=Ot.fromLngLat(M);G.y=Wt(G.y,-1+bf,1-bf);const Q=G.toLngLat(),ie=p.project(Q.lng,Q.lat),pe=Ot.fromLngLat(Q);pe.x+=bf;const ge=pe.toLngLat(),ae=p.project(ge.lng,ge.lat),be=yO(ae.x-ie.x,ae.y-ie.y,F),Te=Ot.fromLngLat(Q);Te.y+=bf;const Be=Te.toLngLat(),Xe=p.project(Be.lng,Be.lat),Ze=yO(Xe.x-ie.x,Xe.y-ie.y,F),He=Math.abs(be.x)/Math.abs(Ze.y),ct=Ne.mat4.identity([]);Ne.mat4.rotateZ(ct,ct,-F*(1-(V?0:z)));const Qe=Ne.mat4.identity([]);return Ne.mat4.scale(Qe,Qe,[1,1-(1-He)*z,1]),Qe[4]=-Ze.x/Ze.y*z,Ne.mat4.rotateZ(Qe,Qe,F),Ne.mat4.multiply(Qe,ct,Qe),Qe}(d.projection,0,d.center,l,i),v=gO(d);return Ne.mat4.scale(h,h,[v,v,1]),h}function gO(d){const i=d.projection,l=$b(d.projection,d.zoom,d.width,d.height),h=cI(i,d.center),v=cI(i,me.convert(i.center));return Math.pow(2,h*l+(1-l)*v)}function $b(d,i,l,h,v=1/0){const p=d.range;if(!p)return 0;const x=Math.min(v,Math.max(l,h)),M=Math.log(x/1024)/Math.LN2;return Fn(p[0]+M,p[1]+M,i)}const bf=1/4e4;function cI(d,i){const l=Wt(i.lat,-dt,dt),h=new me(i.lng-180*bf,l),v=new me(i.lng+180*bf,l),p=d.project(h.lng,l),x=d.project(v.lng,l),M=Ot.fromLngLat(h),z=Ot.fromLngLat(v),V=x.x-p.x,E=x.y-p.y,L=z.x-M.x,B=z.y-M.y,O=Math.sqrt((L*L+B*B)/(V*V+E*E));return Math.log(O)/Math.LN2}function yO(d,i,l){const h=Math.cos(l),v=Math.sin(l);return{x:d*h-i*v,y:d*v+i*h}}function _O(d,i,l){Ne.mat4.identity(d),Ne.mat4.rotateZ(d,d,nt(i[2])),Ne.mat4.rotateX(d,d,nt(i[0])),Ne.mat4.rotateY(d,d,nt(i[1])),Ne.mat4.scale(d,d,l),Ne.mat4.multiply(d,d,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function Ub(d,i,l,h,v,p,x,M){const z=[l[0]-i[0],l[1]-i[1],0],V=[h[0]-i[0],h[1]-i[1],0];if(Ne.vec3.length(z)<1e-12||Ne.vec3.length(V)<1e-12)return Ne.quat.identity(d);const E=Ne.vec3.cross([],z,V);Ne.vec3.normalize(E,E),Ne.vec3.subtract(V,h,i),z[2]=(p-v)*M,V[2]=(x-v)*M;const L=z;return Ne.vec3.cross(L,z,V),Ne.vec3.normalize(L,L),Ne.quat.rotationTo(d,E,L)}function dI(d,i,l=!1){const h=mf(i.zoom),v=function(p,x,M){const z=x.worldSize,V=[p[12],p[13],p[14]],E=rt(V[1]/z),L=it(V[0]/z),B=Ne.mat4.identity([]),O=qe(1,E)*z,F=qe(1,0)*z*Et(E,x.zoom),G=1/ET(z);let Q=F*G;if(M){const ae=$b(x.projection,x.zoom,x.width,x.height,1024);Q=G*x.projection.pixelSpaceConversion(x.center.lat,z,ae)}const ie=te(E,L);Ne.vec3.add(ie,ie,Ne.vec3.scale([],Ne.vec3.normalize([],ie),O*Q*V[2]));const pe=function(ae){const be=[ae[0],ae[1],ae[2]];let Te=[0,1,0];const Be=Ne.vec3.cross([],Te,be);return Ne.vec3.cross(Te,be,Be),Ne.vec3.squaredLength(Te)===0&&(Te=[0,1,0],Ne.vec3.cross(Be,be,Te)),Ne.vec3.normalize(Be,Be),Ne.vec3.normalize(Te,Te),Ne.vec3.normalize(be,be),[Be[0],Be[1],Be[2],0,Te[0],Te[1],Te[2],0,be[0],be[1],be[2],0,ae[0],ae[1],ae[2],1]}(ie);Ne.mat4.scale(B,B,[Q,Q,Q*O]),Ne.mat4.translate(B,B,[-V[0],-V[1],-V[2]]);const ge=Ne.mat4.multiply([],x.globeMatrix,pe);return Ne.mat4.multiply(ge,ge,B),Ne.mat4.multiply(ge,ge,p),ge}(d,i,l);if(h>0){const p=function(x,M){const z=M.worldSize,V=qe(1,0)*z*Et(M.center.lat,M.zoom)/ET(z),E=qe(1,M.center.lat)*z,L=Ne.mat4.identity([]);return Ne.mat4.rotateY(L,L,nt(M.center.lng)),Ne.mat4.rotateX(L,L,nt(M.center.lat)),Ne.mat4.translate(L,L,[0,0,o]),Ne.mat4.scale(L,L,[V,V,V*E]),Ne.mat4.translate(L,L,[M.point.x-.5*z,M.point.y-.5*z,0]),Ne.mat4.multiply(L,L,x),Ne.mat4.multiply(L,M.globeMatrix,L)}(d,i);return function(x,M,z){const V=(F,G,Q)=>{const ie=Ne.vec3.length(F),pe=Ne.vec3.length(G),ge=fh(F,G,Q);return Ne.vec3.scale(ge,ge,1/Ne.vec3.length(ge)*sr(ie,pe,Q))},E=V([x[0],x[1],x[2]],[M[0],M[1],M[2]],z),L=V([x[4],x[5],x[6]],[M[4],M[5],M[6]],z),B=V([x[8],x[9],x[10]],[M[8],M[9],M[10]],z),O=fh([x[12],x[13],x[14]],[M[12],M[13],M[14]],z);return[E[0],E[1],E[2],0,L[0],L[1],L[2],0,B[0],B[1],B[2],0,O[0],O[1],O[2],1]}(v,p,h)}return v}function vO(d,i,l,h){const v=ro.projectAabbCorners(h,l);let p=Number.MAX_VALUE,x=-1;for(let V=0;V<v.length;++V){const E=v[V];E[0]=(.5*E[0]+.5)*i.width,E[1]=(.5-.5*E[1])*i.height,E[2]<p&&(x=V,p=E[2])}const M=V=>new st(v[V][0],v[V][1]);let z;switch(x){case 0:case 6:z=[M(1),M(5),M(4),M(7),M(3),M(2),M(1)];break;case 1:case 7:z=[M(0),M(4),M(5),M(6),M(2),M(3),M(0)];break;case 3:case 5:z=[M(1),M(0),M(4),M(7),M(6),M(2),M(1)];break;default:z=[M(1),M(5),M(6),M(7),M(3),M(0),M(1)]}if(Vn(d,z))return p}const uG=wi([{name:"a_pos_3f",components:3,type:"Float32"}]),cG=wi([{name:"a_color_3f",components:3,type:"Float32"}]),dG=wi([{name:"a_color_4f",components:4,type:"Float32"}]),hG=wi([{name:"a_uv_2f",components:2,type:"Float32"}]),fG=wi([{name:"a_normal_3f",components:3,type:"Float32"}]),pG=wi([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),mG=wi([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]),xO={None:0,Model:1,Symbol:2,FillExtrusion:4,All:7};class Gb{constructor(i,l,h,v){this.message=(i?`${i}: `:"")+h,v&&(this.identifier=v),l!=null&&l.__line__&&(this.line=l.__line__)}}function bO(d,i){const l=d.indexOf("://")===-1;try{return new URL(d,l&&i?"http://example.com":void 0),!0}catch{return!1}}class wO{constructor(i,l){this.feature=i,this.instancedDataOffset=l,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class SO{constructor(){this.instancedDataArray=new Bp,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class hI{constructor(i){this.zoom=i.zoom,this.canonical=i.canonical,this.layers=i.layers,this.layerIds=this.layers.map(l=>l.fqid),this.projection=i.projection,this.index=i.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0}updateFootprints(i,l){}populate(i,l,h,v){this.tileToMeter=vt(h);const p=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:x,id:M,index:z,sourceLayerIndex:V}of i){const E=M??(x.properties&&x.properties.hasOwnProperty("id")?x.properties.id:void 0),L=An(x,p);if(!this.layers[0]._featureFilter.filter(new Fo(this.zoom),L,h))continue;const B={id:E,sourceLayerIndex:V,index:z,geometry:p?L.geometry:In(x,h,v),properties:x.properties,type:x.type,patterns:{}},O=this.addFeature(B,B.geometry,L);O&&l.featureIndex.insert(x,B.geometry,z,V,this.index,this.instancesPerModel[O].instancedDataArray.length,Nn/32)}this.lookup=null}update(i,l,h,v){for(const p in this.instancesPerModel){const x=this.instancesPerModel[p];for(const M in i)x.idToFeaturesIndex.hasOwnProperty(M)&&(this.evaluate(x.features[x.idToFeaturesIndex[M]],i[M],x,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let i=!1;for(const l in this.instancesPerModel){const h=this.instancesPerModel[l];for(const v of h.features){const p=this.layers[0],x=v.feature,M=this.canonical,z=p.paint.get("model-rotation").evaluate(x,{},M),V=p.paint.get("model-scale").evaluate(x,{},M),E=p.paint.get("model-translation").evaluate(x,{},M);Ne.vec3.exactEquals(v.rotation,z)&&Ne.vec3.exactEquals(v.scale,V)&&Ne.vec3.exactEquals(v.translation,E)||(this.evaluate(v,v.featureStates,h,!0),i=!0)}}return i}updateReplacement(i,l,h,v){if(l.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=l.updateTime;const p=l.getReplacementRegionsForTile(i.toUnwrapped(),!0);if(NT(this.activeReplacements,p))return!1;this.activeReplacements=p;let x=!1;for(const M in this.instancesPerModel){const z=this.instancesPerModel[M],V=z.instancedDataArray;for(const E of z.features){const L=E.instancedDataOffset,B=E.instancedDataCount;for(let O=0;O<B;O++){const F=16*(O+L);let G=V.float32[F+0];const Q=G>Nn;G=Q?G-Nn:G;const ie=Math.floor(G),pe=V.float32[F+1];let ge=!1;for(const ae of this.activeReplacements)if(!NL(ae,h,xO.Model,v)&&!(ae.min.x>ie||ie>ae.max.x||ae.min.y>pe||pe>ae.max.y)&&(ge=GL(UL(ie,pe,i.canonical,ae.footprintTileId.canonical),ae.footprint),ge))break;V.float32[F]=ge?G+Nn:G,x=x||ge!==Q}}}return x}isEmpty(){for(const i in this.instancesPerModel)if(this.instancesPerModel[i].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(i){if(!this.uploaded)for(const l in this.instancesPerModel){const h=this.instancesPerModel[l];h.instancedDataArray.length<0||h.instancedDataArray.length===0||(h.instancedDataBuffer?h.instancedDataBuffer.updateData(h.instancedDataArray):h.instancedDataBuffer=i.createVertexBuffer(h.instancedDataArray,pG.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const l in this.instancesPerModel){const h=this.instancesPerModel[l];h.instancedDataArray.length!==0&&h.instancedDataBuffer&&h.instancedDataBuffer.destroy()}const i=this.layers[0].modelManager;if(i&&this.modelUris)for(const l of this.modelUris)i.removeModel(l,"")}addFeature(i,l,h){const v=this.layers[0],p=v.layout.get("model-id").evaluate(h,{},this.canonical);if(!p)return vr(`modelId is not evaluated for layer ${v.id} and it is not going to get rendered.`),p;bO(p,!1)&&(this.modelUris.includes(p)||this.modelUris.push(p)),this.instancesPerModel[p]||(this.instancesPerModel[p]=new SO);const x=this.instancesPerModel[p],M=x.instancedDataArray,z=new wO(h,M.length);for(const V of l)for(const E of V){if(E.x<0||E.x>=Nn||E.y<0||E.y>=Nn)continue;const L=(this.lookupDim-1)/Nn,B=this.lookupDim*(E.y*L|0)+E.x*L|0;if(this.lookup){if(this.lookup[B]!==0)continue;this.lookup[B]=1}this.instanceCount++;const O=M.length;M.resize(O+1),x.instancesEvaluatedElevation.push(0),M.float32[16*O]=E.x,M.float32[16*O+1]=E.y}return z.instancedDataCount=x.instancedDataArray.length-z.instancedDataOffset,z.instancedDataCount>0&&(i.id&&(x.idToFeaturesIndex[i.id]=x.features.length),x.features.push(z),this.evaluate(z,{},x,!1)),p}getModelUris(){return this.modelUris}evaluate(i,l,h,v){const p=this.layers[0],x=i.feature,M=this.canonical,z=i.rotation=p.paint.get("model-rotation").evaluate(x,l,M),V=i.scale=p.paint.get("model-scale").evaluate(x,l,M),E=i.translation=p.paint.get("model-translation").evaluate(x,l,M),L=p.paint.get("model-color").evaluate(x,l,M);L.a=p.paint.get("model-color-mix-intensity").evaluate(x,l,M);const B=[];this.maxVerticalOffset<E[2]&&(this.maxVerticalOffset=E[2]),this.maxScale=Math.max(Math.max(this.maxScale,V[0]),Math.max(V[1],V[2])),_O(B,z,V);const O=Math.round(100*L.a)+L.b/1.05;for(let F=0;F<i.instancedDataCount;++F){const G=i.instancedDataOffset+F,Q=16*G,ie=h.instancedDataArray.float32;let pe=0;v&&(pe=ie[Q+6]-h.instancesEvaluatedElevation[G]);const ge=0|ie[Q+1];ie[Q]=(0|ie[Q])+L.r/1.05,ie[Q+1]=ge+L.g/1.05,ie[Q+2]=O,ie[Q+3]=1/(M.z>10?this.tileToMeter:vt(M,ge)),ie[Q+4]=E[0],ie[Q+5]=E[1],ie[Q+6]=E[2]+pe,ie[Q+7]=B[0],ie[Q+8]=B[1],ie[Q+9]=B[2],ie[Q+10]=B[4],ie[Q+11]=B[5],ie[Q+12]=B[6],ie[Q+13]=B[8],ie[Q+14]=B[9],ie[Q+15]=B[10],h.instancesEvaluatedElevation[G]=E[2]}}}let CO,EO;ir(hI,"ModelBucket",{omit:["layers"]}),ir(SO,"PerModelAttributes"),ir(wO,"ModelFeature");const Wp=64,Mg={CoordinateSpaceTile:1,CoordinateSpaceYUp:2,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function TO(d,i,l,h,v,p,x,M,z,V=!1){const E=l.zoom,L=l.project(h),B=Et(h.lat,E),O=1/B;Ne.mat4.identity(d),Ne.mat4.translate(d,d,[L.x+x[0]*O,L.y+x[1]*O,x[2]]);let F=1,G=1;const Q=l.worldSize;if(V){if(l.projection.name==="mercator"){let ae=0;l.elevation&&(ae=l.elevation.getAtPointOrZero(new Ot(L.x/Q,L.y/Q),0));const be=Ne.vec4.transformMat4([],[L.x,L.y,ae,1],l.projMatrix)[3]/l.cameraToCenterDistance;F=be,G=be*Et(l.center.lat,E)}else if(l.projection.name==="globe"){const ae=dI(d,l),be=Ne.mat4.multiply([],l.projMatrix,ae),Te=[0,0,0,1];Ne.vec4.transformMat4(Te,Te,be);const Be=Te[3]/l.cameraToCenterDistance,Xe=mf(E),Ze=l.projection.pixelsPerMeter(h.lat,Q)*Et(h.lat,E),He=l.projection.pixelsPerMeter(l.center.lat,Q)*Et(l.center.lat,E);F=Be/sr(Ze,yt(l.center.lat),Xe),G=Be*B/Ze,F*=He,G*=He}}else F=O;Ne.mat4.scale(d,d,[F,F,G]);const ie=[...d],pe=i.orientation,ge=[];if(_O(ge,[pe[0]+v[0],pe[1]+v[1],pe[2]+v[2]],p),Ne.mat4.multiply(d,ie,ge),M&&l.elevation){let ae=0;const be=[];if(z&&l.elevation){ae=function(Xe,Ze,He,ct,Qe){const pt=Ze.elevation;if(!pt)return 0;const St=ro.projectAabbCorners(He,ct),Tt=qe(1,Qe.lat)*Ze.worldSize,It=function(br,Zn){const nr=[0,0,1],Br=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const ri of Br){const Xr=br[ri.corners[0]],Yr=br[ri.corners[1]],si=br[ri.corners[2]],li=[Yr[0]-Xr[0],Yr[1]-Xr[1],Zn*(Yr[2]-Xr[2])],Xi=Ne.vec3.cross(li,li,[si[0]-Xr[0],si[1]-Xr[1],Zn*(si[2]-Xr[2])]);Ne.vec3.normalize(Xi,Xi),ri.dotProductWithUp=Ne.vec3.dot(Xi,nr)}return Br.sort((ri,Xr)=>ri.dotProductWithUp-Xr.dotProductWithUp),Br[0].corners}(St,Tt),Lt=St[It[0]],Yt=St[It[1]],Rt=St[It[2]],ln=St[It[3]],gn=pt.getAtPointOrZero(new Ot(Lt[0]/Ze.worldSize,Lt[1]/Ze.worldSize),0),Qt=pt.getAtPointOrZero(new Ot(Yt[0]/Ze.worldSize,Yt[1]/Ze.worldSize),0),Qn=pt.getAtPointOrZero(new Ot(Rt[0]/Ze.worldSize,Rt[1]/Ze.worldSize),0),$n=pt.getAtPointOrZero(new Ot(ln[0]/Ze.worldSize,ln[1]/Ze.worldSize),0),kn=(gn+$n)/2,vn=(Qt+Qn)/2;return kn>vn?Qt<Qn?Ub(Xe,Yt,ln,Lt,Qt,$n,gn,Tt):Ub(Xe,Rt,Lt,ln,Qn,gn,$n,Tt):gn<$n?Ub(Xe,Lt,Yt,Rt,gn,Qt,Qn,Tt):Ub(Xe,ln,Rt,Yt,$n,Qn,Qt,Tt),Math.max(kn,vn)}(be,l,i.aabb,d,h);const Te=Ne.mat4.fromQuat([],be),Be=Ne.mat4.multiply([],Te,ge);Ne.mat4.multiply(d,ie,Be)}else ae=l.elevation.getAtPointOrZero(new Ot(L.x/Q,L.y/Q),0);ae!==0&&(d[14]+=ae)}}function V_(d,i,l=!1){d.uploaded||(d.gfxTexture=new lI(i,d.image,l?i.gl.R8:i.gl.RGBA8,{useMipmap:d.sampler.minFilter>=i.gl.NEAREST_MIPMAP_NEAREST}),d.uploaded=!0,d.image=null)}function gG(d,i,l){d.indexBuffer=i.createIndexBuffer(d.indexArray,!1,!0),d.vertexBuffer=i.createVertexBuffer(d.vertexArray,uG.members,!1,!0),d.normalArray&&(d.normalBuffer=i.createVertexBuffer(d.normalArray,fG.members,!1,!0)),d.texcoordArray&&(d.texcoordBuffer=i.createVertexBuffer(d.texcoordArray,hG.members,!1,!0)),d.colorArray&&(d.colorBuffer=i.createVertexBuffer(d.colorArray,(d.colorArray.bytesPerElement===12?cG:dG).members,!1,!0)),d.featureArray&&(d.pbrBuffer=i.createVertexBuffer(d.featureArray,mG.members,!0)),d.segments=No.simpleSegment(0,0,d.vertexArray.length,d.indexArray.length);const h=d.material;h.pbrMetallicRoughness.baseColorTexture&&V_(h.pbrMetallicRoughness.baseColorTexture,i),h.pbrMetallicRoughness.metallicRoughnessTexture&&V_(h.pbrMetallicRoughness.metallicRoughnessTexture,i),h.normalTexture&&V_(h.normalTexture,i),h.occlusionTexture&&V_(h.occlusionTexture,i,l),h.emissionTexture&&V_(h.emissionTexture,i)}function fI(d,i,l){if(d.meshes)for(const h of d.meshes)gG(h,i,l);if(d.children)for(const h of d.children)fI(h,i,l)}function Hb(d){if(d.meshes)for(const i of d.meshes)i.indexArray.destroy(),i.vertexArray.destroy(),i.colorArray&&i.colorArray.destroy(),i.normalArray&&i.normalArray.destroy(),i.texcoordArray&&i.texcoordArray.destroy(),i.featureArray&&i.featureArray.destroy();if(d.children)for(const i of d.children)Hb(i)}function pI(d){if(d.meshes)for(const l of d.meshes)l.vertexBuffer&&(l.vertexBuffer.destroy(),l.indexBuffer.destroy(),l.normalBuffer&&l.normalBuffer.destroy(),l.texcoordBuffer&&l.texcoordBuffer.destroy(),l.colorBuffer&&l.colorBuffer.destroy(),l.pbrBuffer&&l.pbrBuffer.destroy(),l.segments.destroy(),l.material&&((i=l.material).pbrMetallicRoughness.baseColorTexture&&i.pbrMetallicRoughness.baseColorTexture.gfxTexture&&i.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),i.pbrMetallicRoughness.metallicRoughnessTexture&&i.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&i.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),i.normalTexture&&i.normalTexture.gfxTexture&&i.normalTexture.gfxTexture.destroy(),i.emissionTexture&&i.emissionTexture.gfxTexture&&i.emissionTexture.gfxTexture.destroy(),i.occlusionTexture&&i.occlusionTexture.gfxTexture&&i.occlusionTexture.gfxTexture.destroy()));var i;if(d.children)for(const l of d.children)pI(l)}class Pg{constructor(i,l,h){this._demTile=i,this._dem=this._demTile.dem,this._scale=l,this._offset=h}static create(i,l,h){const v=h||i.findDEMTileFor(l);if(!v||!v.dem)return;const p=v.dem,x=v.tileID,M=1<<l.canonical.z-x.canonical.z;return new Pg(v,p.dim/Nn/M,[(l.canonical.x/M-x.canonical.x)*p.dim,(l.canonical.y/M-x.canonical.y)*p.dim])}tileCoordToPixel(i,l){const h=l*this._scale+this._offset[1],v=Math.floor(i*this._scale+this._offset[0]),p=Math.floor(h);return new st(v,p)}getElevationAt(i,l,h,v){const p=i*this._scale+this._offset[0],x=l*this._scale+this._offset[1],M=Math.floor(p),z=Math.floor(x),V=this._dem;return v=!!v,h?sr(sr(V.get(M,z,v),V.get(M,z+1,v),x-z),sr(V.get(M+1,z,v),V.get(M+1,z+1,v),x-z),p-M):V.get(M,z,v)}getElevationAtPixel(i,l,h){return this._dem.get(i,l,!!h)}getMeterToDEM(i){return(1<<this._demTile.tileID.canonical.z)*qe(1,i)*this._dem.stride}}const mI=new Float32Array(262144),qp=new Uint8Array(262144);function IO(d){let i=0;if(d.meshes)for(const l of d.meshes)i=Math.max(i,l.aabb.max[2]);if(d.children)for(const l of d.children)i=Math.max(i,IO(l));return i}function kO(d,i,l){if(d.meshes)for(const h of d.meshes)h.aabb.min[0]!==1/0&&l.insert(i,h.aabb.min[0],h.aabb.min[1],h.aabb.max[0],h.aabb.max[1]);if(d.children)for(const h of d.children)kO(h,i,l)}const MO=["","wall","door","roof","window","lamp","logo"];class PO{constructor(i){this.node=i,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.cameraCollisionOpacity=1,this.feature={type:"Point",id:i.id,geometry:[],properties:{height:IO(i)}},this.aabb=this._getLocalBounds()}_getLocalBounds(){if(!this.node.meshes)return new ro([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let i=0;const l=new ro([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const h of this.node.meshes)this.node.lightMeshIndex!==i&&(h.transformedAabb=ro.applyTransformFast(h.aabb,this.node.matrix),l.encapsulate(h.transformedAabb)),i++;this.aabb=l}return this.aabb}}class Wb{constructor(i,l,h,v,p,x){this.id=l,this.modelTraits|=Mg.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,h&&(this.modelTraits|=Mg.HasMapboxMeshFeatures),v&&(this.modelTraits|=Mg.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=p,this.dirty=!0,this.needsUpload=!1,this.nodesInfo=[];for(const M of i)this.nodesInfo.push(new PO(M)),kO(M,x.featureIndexArray.length,x.grid),x.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,x.bucketLayerIDs.length-1,0)}updateFootprints(i,l){for(const h of this.getNodesInfo()){const v=h.node;v.footprint&&l.push({footprint:v.footprint,id:i})}}update(){console.log("Update 3D model bucket")}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(i){if(!this.needsUpload)return;const l=this.getNodesInfo();for(const h of l){const v=h.node;this.uploaded?this.updatePbrBuffer(v):fI(v,i,!0)}for(const h of l)Hb(h.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(i){let l=!1;if(!i.meshes)return l;for(const h of i.meshes)h.pbrBuffer&&(h.pbrBuffer.updateData(h.featureArray),l=!0);return l}needsReEvaluation(i,l,h){const v=i.transform.projectionOptions,p=i.style.getBrightness(),x=this.brightness!==p;return!!(!this.uploaded||this.dirty||v.name!==this.projection.name||$_(h.paint.get("model-color").value,x)||$_(h.paint.get("model-color-mix-intensity").value,x)||$_(h.paint.get("model-roughness").value,x)||$_(h.paint.get("model-emissive-strength").value,x)||$_(h.paint.get("model-height-based-emissive-strength-multiplier").value,x))&&(this.projection=v,this.brightness=p,!0)}evaluateScale(i,l){if(i.transform.zoom===this.zoom)return;this.zoom=i.transform.zoom;const h=this.getNodesInfo(),v=this.id.canonical;for(const p of h){const x=p.feature;p.evaluatedScale=l.paint.get("model-scale").evaluate(x,{},v)}}evaluate(i){const l=this.getNodesInfo();for(const h of l){if(!h.node.meshes)continue;const v=h.feature,p=h.node.meshes&&h.node.meshes[0].featureData,x=h.evaluatedColor[2],M=h.evaluatedRMEA[2],z=this.id.canonical;if(h.hasTranslucentParts=!1,p){for(let V=0;V<MO.length;V++){const E=MO[V];E.length&&(v.properties.part=E);const L=i.paint.get("model-color").evaluate(v,{},z).toRenderColor(null),B=i.paint.get("model-color-mix-intensity").evaluate(v,{},z);h.evaluatedColor[V]=[L.r,L.g,L.b,B],h.evaluatedRMEA[V][0]=i.paint.get("model-roughness").evaluate(v,{},z),h.evaluatedRMEA[V][2]=i.paint.get("model-emissive-strength").evaluate(v,{},z),h.evaluatedRMEA[V][3]=L.a,h.emissionHeightBasedParams[V]=i.paint.get("model-height-based-emissive-strength-multiplier").evaluate(v,{},z),!h.hasTranslucentParts&&L.a<1&&(h.hasTranslucentParts=!0)}delete v.properties.part,_G(h,x!==h.evaluatedColor[2]||M!==h.evaluatedRMEA[2],this.modelTraits)}else h.evaluatedRMEA[0][2]=i.paint.get("model-emissive-strength").evaluate(v,{},z);h.evaluatedScale=i.paint.get("model-scale").evaluate(v,{},z),this.updatePbrBuffer(h.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(i,l,h,v){const p=i.findDEMTileFor(h);if(p&&(p.tileID.canonical!==this.terrainTile||l!==this.terrainExaggeration)){if(p.dem&&p.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=p.tileID.overscaledZ;const x=Pg.create(i,h,p);if(!x)return;this.modelTraits&Mg.HasMapboxMeshFeatures&&this.updateDEM(i,x,h,v);for(const M of this.getNodesInfo()){const z=M.node;if(!z.footprint||!z.footprint.vertices||!z.footprint.vertices.length)continue;const V=z.footprint.vertices;let E=x.getElevationAt(V[0].x,V[0].y,!0,!0);for(let L=1;L<V.length;L++)E=Math.min(E,x.getElevationAt(V[L].x,V[L].y,!0,!0));z.elevation=E}}this.terrainTile=p.tileID.canonical,this.terrainExaggeration=l}}updateDEM(i,l,h,v){let p=l._dem._modifiedForSources[v];if(p===void 0&&(l._dem._modifiedForSources[v]=[],p=l._dem._modifiedForSources[v]),p.includes(h.canonical))return;const x=l._dem.dim;p.push(h.canonical);let M=!1;for(const z of this.getNodesInfo()){const V=z.node;if(!V.footprint||!V.footprint.grid)continue;const E=V.footprint.grid,L=l.tileCoordToPixel(E.min.x,E.min.y),B=l.tileCoordToPixel(E.max.x,E.max.y),O=Math.min(Math.min(x-B.y,L.x),Math.min(L.y,x-B.x));if(O<0)continue;const F=Wt(O,2,5);let G=Math.max(0,L.x-F),Q=Math.max(0,L.y-F),ie=Math.min(B.x+F,x-1),pe=Math.min(B.y+F,x-1);for(let Te=Q;Te<=pe;++Te)for(let Be=G;Be<=ie;++Be)qp[Te*x+Be]=255;let ge=0,ae=0;for(let Te=0;Te<E.cellsY;++Te)for(let Be=0;Be<E.cellsX;++Be){if(!E.cells[Te*E.cellsX+Be])continue;const Xe=l.tileCoordToPixel(E.min.x+Be/E.xScale,E.min.y+Te/E.yScale),Ze=l.tileCoordToPixel(E.min.x+(Be+1)/E.xScale,E.min.y+(Te+1)/E.yScale);for(let He=Xe.y;He<=Math.min(Ze.y+1,x-1);++He)for(let ct=Xe.x;ct<=Math.min(Ze.x+1,x-1);++ct)qp[He*x+ct]===255&&(qp[He*x+ct]=0,ge+=l.getElevationAtPixel(ct,He),ae++)}const be=ge/ae;G=Math.max(1,L.x-F),Q=Math.max(1,L.y-F),ie=Math.min(B.x+F,x-2),pe=Math.min(B.y+F,x-2),M=!0;for(let Te=Q;Te<=pe;++Te)for(let Be=G;Be<=ie;++Be)qp[Te*x+Be]===0&&(mI[Te*x+Be]=l._dem.set(Be,Te,be));for(let Te=1;Te<F;++Te){G=Math.max(1,L.x-Te),Q=Math.max(1,L.y-Te),ie=Math.min(B.x+Te,x-2),pe=Math.min(B.y+Te,x-2);for(let Be=Q;Be<=pe;++Be)for(let Xe=G;Xe<=ie;++Xe){const Ze=Be*x+Xe;if(qp[Ze]===255){let He=0,ct=0,Qe=-1,pt=-1;for(let St=-1;St<=1;++St)for(let Tt=-1;Tt<=1;++Tt){const It=(Be+St)*x+Xe+Tt;if(qp[It]>=Te)continue;const Lt=mI[It],Yt=Math.abs(Lt);Yt>ct&&(He=Lt,ct=Yt,Qe=Tt,pt=St)}if(ct>.1){const St=1-(Te+.5*Math.abs(Qe*pt))/F;let Tt=l._dem.get(Xe,Be)+He*St;const It=l._dem.get(Xe+Qe,Be+pt),Lt=l._dem.get(Xe-Qe,Be-pt,!0);(Tt-It)*(Tt-Lt)>0&&(Tt=(It+Lt)/2),mI[Ze]=l._dem.set(Xe,Be,Tt),qp[Ze]=Te}}}}}M&&(l._demTile.needsDEMTextureUpload=!0,l._dem._timestamp=zt.now())}getNodesInfo(){return this.nodesInfo}destroy(){const i=this.getNodesInfo();for(const l of i)Hb(l.node),pI(l.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(i,l){if(l.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=l.updateTime;const h=l.getReplacementRegionsForTile(i.toUnwrapped()),v=this.getNodesInfo();for(let p=0;p<this.nodesInfo.length;p++){const x=v[p].node;v[p].hiddenByReplacement=!!x.footprint&&!h.find(M=>M.footprint===x.footprint)}}getHeightAtTileCoord(i,l){const h=this.getNodesInfo(),v=[],p=[0,0,0],x=Ne.mat4.identity([]);for(let M=0;M<this.nodesInfo.length;M++){const z=h[M],V=z.node.meshes[0],E=V.transformedAabb;if(i<E.min[0]||l<E.min[1]||i>E.max[0]||l>E.max[1])continue;if(z.node.hidden===!0)return{height:1/0,maxHeight:z.feature.properties.height,hidden:!1,verticalScale:z.evaluatedScale[2]};Ne.mat4.invert(x,z.node.matrix),p[0]=i,p[1]=l,Ne.vec3.transformMat4(p,p,x);const L=(p[0]-V.aabb.min[0])/(V.aabb.max[0]-V.aabb.min[0])*Wp|0,B=Math.min(63,(p[1]-V.aabb.min[1])/(V.aabb.max[1]-V.aabb.min[1])*Wp|0)*Wp+Math.min(63,L),O=V.heightmap[B];if(!(O<0&&z.node.footprint))return z.hiddenByReplacement?void 0:{height:O,maxHeight:z.feature.properties.height,hidden:!1,verticalScale:z.evaluatedScale[2]};if(z.node.footprint.grid.query(new st(i,l),new st(i,l),v),v.length>0)return{height:void 0,maxHeight:z.feature.properties.height,hidden:z.hiddenByReplacement,verticalScale:z.evaluatedScale[2]}}}}function $_(d,i){return!d.isLightConstant&&i}function yG(d,i,l,h,v,p,x,M){let z=(61440&i|(61440&i)>>4)>>8,V=(3840&i|(3840&i)>>4)>>4,E=240&i|(240&i)>>4;l[3]>0&&(z=sr(z,255*l[0],l[3]),V=sr(V,255*l[1],l[3]),E=sr(E,255*l[2],l[3]));const L=z<<8|V,B=E<<8|Math.floor(255*h[3]),O=function(Te){const Be=Wt(Te,0,2);return Math.min(Math.round(.5*Be*255),255)}(h[2])<<8|15*h[0]<<4|15*h[1],F=Wt(v[0],0,1),G=Wt(v[1],0,1),Q=Wt(v[2],0,1),ie=Wt(v[3],0,1);let pe,ge,ae,be;if(F!==G&&x!==p&&G!==F){const Te=x-p;ge=1/(Te*(G-F)),ae=-(p+Te*F)/(Te*(G-F));const Be=Wt(v[4],-1,1);be=Math.pow(10,Be),pe=255*Q<<8|255*ie}else pe=65535,ge=0,ae=1,be=1;if(d.emplaceBack(L,B,O,pe,ge,ae,be),M){const Te=M.length;M.clear();for(let Be=0;Be<Te;Be++)M.emplaceBack(L,B,O,pe,ge,ae,be)}}function _G(d,i,l){const h=d.node;let v=0;const p=l&Mg.HasMeshoptCompression;for(const x of h.meshes){if(h.lights&&h.lightMeshIndex===v||!x.featureData)continue;x.featureArray=new pg,x.featureArray.reserve(x.featureData.length);let M=i;for(const z of x.featureData){const V=p?65535&z:z>>16&65535,E=p?z>>16&65535:65535&z,L=(15&E)<8?15&E:0,B=d.evaluatedRMEA[L],O=d.evaluatedColor[L],F=d.emissionHeightBasedParams[L];let G;if(M&&L===2&&h.lights&&(G=new pg,G.resize(10*h.lights.length)),yG(x.featureArray,V,O,B,F,x.aabb.min[2],x.aabb.max[2],G),G&&M){M=!1;const Q=h.meshes[h.lightMeshIndex];Q.featureArray=G,Q.featureArray._trim()}}x.featureArray._trim(),v++}}function AO(d,i,l,h){const v=1<<d.z;i.lat=rt((h/Nn+d.y)/v),i.lng=it((l/Nn+d.x)/v)}ir(Wb,"Tiled3dModelBucket",{omit:["layers"]}),ir(PO,"Tiled3dModelFeature");const vG={circle:class extends ba{constructor(d,i,l,h){super(d,{layout:Oi||(Oi=new vo({"circle-sort-key":new gr($t.layout_circle["circle-sort-key"]),visibility:new zn($t.layout_circle.visibility)})),paint:Bo||(Bo=new vo({"circle-radius":new gr($t.paint_circle["circle-radius"]),"circle-color":new gr($t.paint_circle["circle-color"]),"circle-blur":new gr($t.paint_circle["circle-blur"]),"circle-opacity":new gr($t.paint_circle["circle-opacity"]),"circle-translate":new zn($t.paint_circle["circle-translate"]),"circle-translate-anchor":new zn($t.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new zn($t.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new zn($t.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new gr($t.paint_circle["circle-stroke-width"]),"circle-stroke-color":new gr($t.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new gr($t.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new zn($t.paint_circle["circle-emissive-strength"])}))},i,l,h)}createBucket(d){return new _r(d)}queryRadius(d){const i=d;return xo("circle-radius",this,i)+xo("circle-stroke-width",this,i)+$i(this.paint.get("circle-translate"))}queryIntersectsFeature(d,i,l,h,v,p,x,M){const z=Si(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),p.angle,d.pixelToTileUnitsFactor),V=this.paint.get("circle-radius").evaluate(i,l)+this.paint.get("circle-stroke-width").evaluate(i,l);return uL(d,h,p,x,M,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",z,V)}getProgramIds(){return["circle"]}getDefaultProgramParams(d,i,l){const h=lL(this);return{config:new dh(this,{zoom:i,lut:l}),defines:h,overrideFog:!1}}},heatmap:class extends ba{createBucket(d){return new dL(d)}constructor(d,i,l,h){super(d,{layout:hL||(hL=new vo({visibility:new zn($t.layout_heatmap.visibility)})),paint:fL||(fL=new vo({"heatmap-radius":new gr($t.paint_heatmap["heatmap-radius"]),"heatmap-weight":new gr($t.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new zn($t.paint_heatmap["heatmap-intensity"]),"heatmap-color":new fu($t.paint_heatmap["heatmap-color"]),"heatmap-opacity":new zn($t.paint_heatmap["heatmap-opacity"])}))},i,l,h),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(d){d==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=b_({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(d){return xo("heatmap-radius",this,d)}queryIntersectsFeature(d,i,l,h,v,p,x,M){const z=this.paint.get("heatmap-radius").evaluate(i,l);return uL(d,h,p,x,M,!0,!0,new st(0,0),z)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(d,i,l){return d==="heatmap"?{config:new dh(this,{zoom:i,lut:l}),overrideFog:!1}:{}}},hillshade:class extends ba{constructor(d,i,l,h){super(d,{layout:pL||(pL=new vo({visibility:new zn($t.layout_hillshade.visibility)})),paint:mL||(mL=new vo({"hillshade-illumination-direction":new zn($t.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new zn($t.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new zn($t.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new zn($t.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new zn($t.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new zn($t.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new zn($t.paint_hillshade["hillshade-emissive-strength"])}))},i,l,h)}shouldRedrape(){return this.hasOffscreenPass()&&this.paint.get("hillshade-illumination-anchor")==="viewport"}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(d,i,l){return{overrideFog:!1}}},fill:class extends ba{constructor(d,i,l,h){super(d,{layout:SL||(SL=new vo({"fill-sort-key":new gr($t.layout_fill["fill-sort-key"]),visibility:new zn($t.layout_fill.visibility)})),paint:CL||(CL=new vo({"fill-antialias":new zn($t.paint_fill["fill-antialias"]),"fill-opacity":new gr($t.paint_fill["fill-opacity"]),"fill-color":new gr($t.paint_fill["fill-color"]),"fill-outline-color":new gr($t.paint_fill["fill-outline-color"]),"fill-translate":new zn($t.paint_fill["fill-translate"]),"fill-translate-anchor":new zn($t.paint_fill["fill-translate-anchor"]),"fill-pattern":new gr($t.paint_fill["fill-pattern"]),"fill-emissive-strength":new zn($t.paint_fill["fill-emissive-strength"]),"fill-z-offset":new gr($t.paint_fill["fill-z-offset"])}))},i,l,h)}getProgramIds(){const d=this.paint.get("fill-pattern"),i=d&&d.constantOr(1),l=[i?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&l.push(i&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),l}getDefaultProgramParams(d,i,l){return{config:new dh(this,{zoom:i,lut:l}),overrideFog:!1}}recalculate(d,i){super.recalculate(d,i);const l=this.paint._values["fill-outline-color"];l.value.kind==="constant"&&l.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(d){return new LT(d)}queryRadius(){return $i(this.paint.get("fill-translate"))}queryIntersectsFeature(d,i,l,h,v,p){return!d.queryGeometry.isAboveHorizon&&zr(ni(d.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),p.angle,d.pixelToTileUnitsFactor),h)}isTileClipped(){return!0}is3D(){return this.paint.get("fill-z-offset").constantOr(1)!==0}},"fill-extrusion":class extends ba{constructor(d,i,l,h){super(d,{layout:oR||(oR=new vo({visibility:new zn($t["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new zn($t["layout_fill-extrusion"]["fill-extrusion-edge-radius"])})),paint:sR||(sR=new vo({"fill-extrusion-opacity":new zn($t["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new gr($t["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new zn($t["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new zn($t["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new gr($t["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new gr($t["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new gr($t["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new zn($t["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new zn($t["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new zn($t["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new zn($t["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new zn($t["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new zn($t["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new zn($t["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new zn($t["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new gr($t["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new gr($t["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new zn($t["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new zn($t["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new zn($t["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new zn($t["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new gr($t["paint_fill-extrusion"]["fill-extrusion-emissive-strength"]),"fill-extrusion-line-width":new gr($t["paint_fill-extrusion"]["fill-extrusion-line-width"]),"fill-extrusion-cast-shadows":new zn($t["paint_fill-extrusion"]["fill-extrusion-cast-shadows"])}))},i,l,h),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(d){return new Sb(d)}queryRadius(){return $i(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}hasShadowPass(){return this.paint.get("fill-extrusion-cast-shadows")}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(d,i,l,h,v,p,x,M,z){const V=Si(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),p.angle,d.pixelToTileUnitsFactor),E=this.paint.get("fill-extrusion-height").evaluate(i,l),L=this.paint.get("fill-extrusion-base").evaluate(i,l),B=[0,0],O=M&&p.elevation,F=p.elevation?p.elevation.exaggeration():1,G=d.tile.getBucket(this);if(O&&G instanceof Sb){const ae=G.centroidVertexArray,be=z+1;be<ae.length&&(B[0]=ae.geta_centroid_pos0(be),B[1]=ae.geta_centroid_pos1(be))}if(B[0]===0&&B[1]===1)return!1;p.projection.name==="globe"&&(h=iR([h],[new st(0,0),new st(Nn,Nn)],d.tileID.canonical).map(ae=>ae.polygon).flat());const Q=O?M:null,[ie,pe]=function(ae,be,Te,Be,Xe,Ze,He,ct,Qe,pt,St){return ae.projection.name==="globe"?function(Tt,It,Lt,Yt,Rt,ln,gn,Qt,Qn,$n,kn){const vn=[],br=[],Zn=Tt.projection.upVectorScale(kn,Tt.center.lat,Tt.worldSize).metersToTile,nr=[0,0,0,1],Br=[0,0,0,1],ri=(Yr,si,li,Xi)=>{Yr[0]=si,Yr[1]=li,Yr[2]=Xi,Yr[3]=1},Xr=rR();Lt>0&&(Lt+=Xr),Yt+=Xr;for(const Yr of It){const si=[],li=[];for(const Xi of Yr){const Di=Xi.x+Rt.x,jr=Xi.y+Rt.y,Ii=Tt.projection.projectTilePoint(Di,jr,kn),Ai=Tt.projection.upVector(kn,Xi.x,Xi.y);let lo=Lt,Jo=Yt;if(gn){const hs=lR(Di,jr,Lt,Yt,gn,Qt,Qn,$n);lo+=hs.base,Jo+=hs.top}Lt!==0?ri(nr,Ii.x+Ai[0]*Zn*lo,Ii.y+Ai[1]*Zn*lo,Ii.z+Ai[2]*Zn*lo):ri(nr,Ii.x,Ii.y,Ii.z),ri(Br,Ii.x+Ai[0]*Zn*Jo,Ii.y+Ai[1]*Zn*Jo,Ii.z+Ai[2]*Zn*Jo),Ne.vec3.transformMat4(nr,nr,ln),Ne.vec3.transformMat4(Br,Br,ln),si.push(new Hp(nr[0],nr[1],nr[2])),li.push(new Hp(Br[0],Br[1],Br[2]))}vn.push(si),br.push(li)}return[vn,br]}(ae,be,Te,Be,Xe,Ze,He,ct,Qe,pt,St):He?function(Tt,It,Lt,Yt,Rt,ln,gn,Qt,Qn){const $n=[],kn=[],vn=[0,0,0,1];for(const br of Tt){const Zn=[],nr=[];for(const Br of br){const ri=Br.x+Yt.x,Xr=Br.y+Yt.y,Yr=lR(ri,Xr,It,Lt,ln,gn,Qt,Qn);vn[0]=ri,vn[1]=Xr,vn[2]=Yr.base,vn[3]=1,Ne.vec4.transformMat4(vn,vn,Rt),vn[3]=Math.max(vn[3],1e-5);const si=new Hp(vn[0]/vn[3],vn[1]/vn[3],vn[2]/vn[3]);vn[0]=ri,vn[1]=Xr,vn[2]=Yr.top,vn[3]=1,Ne.vec4.transformMat4(vn,vn,Rt),vn[3]=Math.max(vn[3],1e-5);const li=new Hp(vn[0]/vn[3],vn[1]/vn[3],vn[2]/vn[3]);Zn.push(si),nr.push(li)}$n.push(Zn),kn.push(nr)}return[$n,kn]}(be,Te,Be,Xe,Ze,He,ct,Qe,pt):function(Tt,It,Lt,Yt,Rt){const ln=[],gn=[],Qt=Rt[8]*It,Qn=Rt[9]*It,$n=Rt[10]*It,kn=Rt[11]*It,vn=Rt[8]*Lt,br=Rt[9]*Lt,Zn=Rt[10]*Lt,nr=Rt[11]*Lt;for(const Br of Tt){const ri=[],Xr=[];for(const Yr of Br){const si=Yr.x+Yt.x,li=Yr.y+Yt.y,Xi=Rt[0]*si+Rt[4]*li+Rt[12],Di=Rt[1]*si+Rt[5]*li+Rt[13],jr=Rt[2]*si+Rt[6]*li+Rt[14],Ii=Rt[3]*si+Rt[7]*li+Rt[15],Ai=Xi+Qt,lo=Di+Qn,Jo=jr+$n,hs=Math.max(Ii+kn,1e-5),Qo=Xi+vn,Po=Di+br,Zs=jr+Zn,ys=Math.max(Ii+nr,1e-5);ri.push(new Hp(Ai/hs,lo/hs,Jo/hs)),Xr.push(new Hp(Qo/ys,Po/ys,Zs/ys))}ln.push(ri),gn.push(Xr)}return[ln,gn]}(be,Te,Be,Xe,Ze)}(p,h,L,E,V,x,Q,B,F,p.center.lat,d.tileID.canonical),ge=d.queryGeometry;return function(ae,be,Te){let Be=1/0;zr(Te,be)&&(Be=aR(Te,be[0]));for(let Xe=0;Xe<be.length;Xe++){const Ze=be[Xe],He=ae[Xe];for(let ct=0;ct<Ze.length-1;ct++){const Qe=Ze[ct],pt=[Qe,Ze[ct+1],He[ct+1],He[ct],Qe];Vn(Te,pt)&&(Be=Math.min(Be,aR(Te,pt)))}}return Be!==1/0&&Be}(ie,pe,ge.isPointQuery()?ge.screenBounds:ge.screenGeometry)}},line:class extends ba{constructor(d,i,l,h){const v=_R();super(d,v,i,l,h),v.layout&&(this.layout=new rf(v.layout)),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(d){if(d==="line-gradient"){const i=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=i._styleExpression&&i._styleExpression.expression instanceof Fs,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(d,i){super.recalculate(d,i),this.paint._values["line-floorwidth"]=(()=>{if(P_)return P_;const l=_R();return P_=new wU(l.paint.properties["line-width"].specification),P_.useIntegerZoom=!0,P_})().possiblyEvaluate(this._transitioningPaint._values["line-width"].value,d)}createBucket(d){return new $T(d)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(d,i,l){const h=gR(this);return{config:new dh(this,{zoom:i,lut:l}),defines:h,overrideFog:!1}}queryRadius(d){const i=d,l=vR(xo("line-width",this,i),xo("line-gap-width",this,i)),h=xo("line-offset",this,i);return l/2+Math.abs(h)+$i(this.paint.get("line-translate"))}queryIntersectsFeature(d,i,l,h,v,p){if(d.queryGeometry.isAboveHorizon)return!1;const x=ni(d.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),p.angle,d.pixelToTileUnitsFactor),M=d.pixelToTileUnitsFactor/2*vR(this.paint.get("line-width").evaluate(i,l),this.paint.get("line-gap-width").evaluate(i,l)),z=this.paint.get("line-offset").evaluate(i,l);return z&&(h=function(V,E){const L=[],B=new st(0,0);for(let O=0;O<V.length;O++){const F=V[O],G=[];for(let Q=0;Q<F.length;Q++){const ie=F[Q],pe=F[Q+1],ge=Q===0?B:ie.sub(F[Q-1])._unit()._perp(),ae=Q===F.length-1?B:pe.sub(ie)._unit()._perp(),be=ge._add(ae)._unit();be._mult(1/(be.x*ae.x+be.y*ae.y)),G.push(be._mult(E)._add(ie))}L.push(G)}return L}(h,z*d.pixelToTileUnitsFactor)),function(V,E,L){for(let B=0;B<E.length;B++){const O=E[B];if(V.length>=3){for(let F=0;F<O.length;F++)if(ao(V,O[F]))return!0}if(dr(V,O,L))return!0}return!1}(x,h,M)}isTileClipped(){return!0}isDraped(d){const i=this.layout.get("line-z-offset");return i.isConstant()&&!i.constantOr(0)}},symbol:Nb,background:class extends ba{constructor(d,i,l,h){super(d,{layout:nO||(nO=new vo({visibility:new zn($t.layout_background.visibility)})),paint:rO||(rO=new vo({"background-pitch-alignment":new zn($t.paint_background["background-pitch-alignment"]),"background-color":new zn($t.paint_background["background-color"]),"background-pattern":new zn($t.paint_background["background-pattern"]),"background-opacity":new zn($t.paint_background["background-opacity"]),"background-emissive-strength":new zn($t.paint_background["background-emissive-strength"])}))},i,l,h)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(d,i,l){return{overrideFog:!1}}is3D(){return this.paint.get("background-pitch-alignment")==="viewport"}},raster:lO,"raster-particle":pO,sky:class extends ba{constructor(d,i,l,h){super(d,{layout:dO||(dO=new vo({visibility:new zn($t.layout_sky.visibility)})),paint:hO||(hO=new vo({"sky-type":new zn($t.paint_sky["sky-type"]),"sky-atmosphere-sun":new zn($t.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new zn($t.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new zn($t.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new zn($t.paint_sky["sky-gradient-radius"]),"sky-gradient":new fu($t.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new zn($t.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new zn($t.paint_sky["sky-atmosphere-color"]),"sky-opacity":new zn($t.paint_sky["sky-opacity"])}))},i,l,h),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(d){d==="sky-gradient"?this._updateColorRamp():d!=="sky-atmosphere-sun"&&d!=="sky-atmosphere-halo-color"&&d!=="sky-atmosphere-color"&&d!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=b_({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(d){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const i=d.style.light.properties.get("position");return this._lightPosition.azimuthal!==i.azimuthal||this._lightPosition.polar!==i.polar}return!1}getCenter(d,i){if(this.paint.get("sky-type")==="atmosphere"){const h=this.paint.get("sky-atmosphere-sun"),v=!h,p=d.style.light,x=p.properties.get("position");return v&&p.properties.get("anchor")==="viewport"&&vr("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),v?uI(x.azimuthal,90-x.polar,i):uI(h[0],90-h[1],i)}const l=this.paint.get("sky-gradient-center");return uI(l[0],90-l[1],i)}isSky(){return!0}markSkyboxValid(d){this._skyboxInvalidated=!1,this._lightPosition=d.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const d=this.paint.get("sky-type");return d==="atmosphere"?["skyboxCapture","skybox"]:d==="gradient"?["skyboxGradient"]:null}},slot:class extends ba{constructor(d,i,l,h){super(d,{paint:fO||(fO=new vo({}))},i,null)}},model:class extends ba{constructor(d,i,l,h){super(d,{layout:CO||(CO=new vo({visibility:new zn($t.layout_model.visibility),"model-id":new gr($t.layout_model["model-id"])})),paint:EO||(EO=new vo({"model-opacity":new zn($t.paint_model["model-opacity"]),"model-rotation":new gr($t.paint_model["model-rotation"]),"model-scale":new gr($t.paint_model["model-scale"]),"model-translation":new gr($t.paint_model["model-translation"]),"model-color":new gr($t.paint_model["model-color"]),"model-color-mix-intensity":new gr($t.paint_model["model-color-mix-intensity"]),"model-type":new zn($t.paint_model["model-type"]),"model-cast-shadows":new zn($t.paint_model["model-cast-shadows"]),"model-receive-shadows":new zn($t.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new zn($t.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new gr($t.paint_model["model-emissive-strength"]),"model-roughness":new gr($t.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new gr($t.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new zn($t.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new zn($t.paint_model["model-front-cutoff"])}))},i,l,h),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(d){return new hI(d)}getProgramIds(){return["model"]}is3D(){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(d){return d instanceof Wb?Nn-1:0}queryIntersectsFeature(d,i,l,h,v,p){if(!this.modelManager)return!1;const x=this.modelManager,M=d.tile.getBucket(this);if(!(M&&M instanceof hI))return!1;const z=M;for(const V in z.instancesPerModel){const E=z.instancesPerModel[V],L=i.id!==void 0?i.id:i.properties&&i.properties.hasOwnProperty("id")?i.properties.id:void 0;if(E.idToFeaturesIndex.hasOwnProperty(L)){const B=E.features[E.idToFeaturesIndex[L]],O=x.getModel(V,this.scope);if(!O)return!1;let F=Ne.mat4.create();const G=new me(0,0),Q=z.canonical;let ie=Number.MAX_VALUE;for(let pe=0;pe<B.instancedDataCount;++pe){const ge=16*(B.instancedDataOffset+pe),ae=E.instancedDataArray.float32,be=[ae[ge+4],ae[ge+5],ae[ge+6]];AO(Q,G,ae[ge],0|ae[ge+1]),TO(F,O,p,G,B.rotation,B.scale,be,!1,!1,!1),p.projection.name==="globe"&&(F=dI(F,p));const Te=Ne.mat4.multiply([],p.projMatrix,F),Be=d.queryGeometry,Xe=vO(Be.isPointQuery()?Be.screenBounds:Be.screenGeometry,p,Te,O.aabb);Xe!=null&&(ie=Math.min(Xe,ie))}return ie!==Number.MAX_VALUE&&ie}}return!1}_handleOverridablePaintPropertyUpdate(d,i,l){return!(!this.layout||i.isDataDriven()||l.isDataDriven()||d!=="model-color"&&d!=="model-color-mix-intensity"&&d!=="model-rotation"&&d!=="model-scale"&&d!=="model-translation"&&d!=="model-emissive-strength")}_isPropertyZoomDependent(d){const i=this._transitionablePaint._values[d];return i!=null&&i.value!=null&&i.value.expression!=null&&i.value.expression instanceof $u}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}queryIntersectsMatchingFeature(d,i,l,h){const v=d.tile,p=v.getBucket(this);let x=null,M=Number.MAX_VALUE;if(!(p&&p instanceof Wb))return{queryFeature:x,intersectionZ:M};const z=p.getNodesInfo()[i];if(z.hiddenByReplacement||!z.node.meshes||!l.filter(new Fo(v.tileID.overscaledZ),z.feature,v.tileID.canonical))return{queryFeature:x,intersectionZ:M};const V=z.node,E=h.calculatePosMatrix(v.tileID.toUnwrapped(),h.worldSize),L=z.evaluatedScale;let B=0;h.elevation&&V.elevation&&(B=V.elevation*h.elevation.exaggeration()),Ne.mat4.translate(E,E,[(V.anchor?V.anchor[0]:0)*(L[0]-1),(V.anchor?V.anchor[1]:0)*(L[1]-1),B]),Ne.mat4.scale(E,E,L),Ne.mat4.multiply(E,E,V.matrix);const O=d.queryGeometry,F=O.isPointQuery()?O.screenBounds:O.screenGeometry,G=function(ie){const pe=Ne.mat4.multiply([],E,ie.matrix),ge=Ne.mat4.multiply(pe,h.expandedFarZProjMatrix,pe);for(let ae=0;ae<ie.meshes.length;++ae){const be=ie.meshes[ae];if(ae===ie.lightMeshIndex)continue;const Te=vO(F,h,ge,be.aabb);Te!=null&&(M=Math.min(Te,M))}if(ie.children)for(const ae of ie.children)G(ae)};if(G(V),M===Number.MAX_VALUE)return{queryFeature:x,intersectionZ:M};const Q=new me(0,0);return AO(v.tileID.canonical,Q,z.node.anchor[0],z.node.anchor[1]),x={type:"Feature",geometry:{type:"Point",coordinates:[Q.lng,Q.lat]},properties:z.feature.properties,id:z.feature.id,state:{},layer:this.serialize()},{queryFeature:x,intersectionZ:M}}},clip:class extends ba{constructor(d,i,l,h){super(d,{layout:EL||(EL=new vo({"clip-layer-types":new zn($t.layout_clip["clip-layer-types"]),"clip-layer-scope":new zn($t.layout_clip["clip-layer-scope"])})),paint:TL||(TL=new vo({}))},i,l,h)}recalculate(d,i){super.recalculate(d,i)}createBucket(d){return new IL(d)}isTileClipped(){return!0}is3D(){return!0}}};class xG{constructor(i){this._callback=i,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class bG{constructor(){this.tasks={},this.taskQueue=[],Rr(["process"],this),this.invoker=new xG(this.process),this.nextId=0}add(i,l){const h=this.nextId++,v=function({type:p,isSymbolTile:x,zoom:M}){return M=M||0,p==="message"?0:p!=="maybePrepare"||x?p!=="parseTile"||x?p==="parseTile"&&x?300-M:p==="maybePrepare"&&x?400-M:500:200-M:100-M}(l);if(v===0){try{i()}finally{}return null}return this.tasks[h]={fn:i,metadata:l,priority:v,id:h},this.taskQueue.push(h),this.invoker.trigger(),{cancel:()=>{delete this.tasks[h]}}}process(){try{if(this.taskQueue=this.taskQueue.filter(h=>!!this.tasks[h]),!this.taskQueue.length)return;const i=this.pick();if(i===null)return;const l=this.tasks[i];if(delete this.tasks[i],this.taskQueue.length&&this.invoker.trigger(),!l)return;l.fn()}finally{}}pick(){let i=null,l=1/0;for(let v=0;v<this.taskQueue.length;v++){const p=this.tasks[this.taskQueue[v]];p.priority<l&&(l=p.priority,i=v)}if(i===null)return null;const h=this.taskQueue[i];return this.taskQueue.splice(i,1),h}remove(){this.invoker.remove()}}class LO{constructor(i,l,h){this.target=i,this.parent=l,this.mapId=h,this.callbacks={},this.cancelCallbacks={},Rr(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new bG}send(i,l,h,v,p=!1,x){const M=Math.round(1e18*Math.random()).toString(36).substring(0,10);h&&(h.metadata=x,this.callbacks[M]=h);const z=new Set;return this.target.postMessage({id:M,type:i,hasCallback:!!h,targetMapId:v,mustQueue:p,sourceMapId:this.mapId,data:tl(l,z)},z),{cancel:()=>{h&&delete this.callbacks[M],this.target.postMessage({id:M,type:"<cancel>",targetMapId:v,sourceMapId:this.mapId})}}}receive(i){const l=i.data,h=l.id;if(h&&(!l.targetMapId||this.mapId===l.targetMapId))if(l.type==="<cancel>"){const v=this.cancelCallbacks[h];delete this.cancelCallbacks[h],v&&v.cancel()}else if(l.mustQueue||ji()){const v=this.callbacks[h],p=this.scheduler.add(()=>this.processTask(h,l),v&&v.metadata||{type:"message"});p&&(this.cancelCallbacks[h]=p)}else this.processTask(h,l)}processTask(i,l){if(delete this.cancelCallbacks[i],l.type==="<response>"){const h=this.callbacks[i];delete this.callbacks[i],h&&(l.error?h(sh(l.error)):h(null,sh(l.data)))}else{const h=new Set,v=l.hasCallback?(x,M)=>{this.target.postMessage({id:i,type:"<response>",sourceMapId:this.mapId,error:x?tl(x):null,data:tl(M,h)},h)}:x=>{},p=sh(l.data);if(this.parent[l.type])this.parent[l.type](l.sourceMapId,p,v);else if(this.parent.getWorkerSource){const x=l.type.split(".");this.parent.getWorkerSource(l.sourceMapId,x[0],p.source,p.scope)[x[1]](p,v)}else v(new Error(`Could not find function ${l.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}class Ag{constructor(i,l){this.workerPool=i,this.actors=[],this.currentActor=0,this.id=xn();const h=this.workerPool.acquire(this.id);for(let v=0;v<h.length;v++){const p=new Ag.Actor(h[v],l,this.id);p.name=`Worker ${v}`,this.actors.push(p)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(i,l,h){bn(this.actors,(v,p)=>{v.send(i,l,p)},h=h||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(i=>{i.remove()}),this.actors=[],this.workerPool.release(this.id)}}Ag.Actor=LO;class RO{constructor(i){this.size=i,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(i,l){const h=this.toIdx(i,l);return{min:this.minimums[h],max:this.maximums[h]}}isLeaf(i,l){return this.leaves[this.toIdx(i,l)]}toIdx(i,l){return l*this.size+i}}function OO(d,i,l,h){let v=0,p=Number.MAX_VALUE;for(let x=0;x<3;x++)if(Math.abs(h[x])<1e-15){if(l[x]<d[x]||l[x]>i[x])return null}else{const M=1/h[x];let z=(d[x]-l[x])*M,V=(i[x]-l[x])*M;if(z>V){const E=z;z=V,V=E}if(z>v&&(v=z),V<p&&(p=V),v>p)return null}return v}function DO(d,i,l,h,v,p,x,M,z,V,E){const L=h-d,B=v-i,O=p-l,F=x-d,G=M-i,Q=z-l,ie=E[1]*Q-E[2]*G,pe=E[2]*F-E[0]*Q,ge=E[0]*G-E[1]*F,ae=L*ie+B*pe+O*ge;if(Math.abs(ae)<1e-15)return null;const be=1/ae,Te=V[0]-d,Be=V[1]-i,Xe=V[2]-l,Ze=(Te*ie+Be*pe+Xe*ge)*be;if(Ze<0||Ze>1)return null;const He=Be*O-Xe*B,ct=Xe*L-Te*O,Qe=Te*B-Be*L,pt=(E[0]*He+E[1]*ct+E[2]*Qe)*be;return pt<0||Ze+pt>1?null:(F*He+G*ct+Q*Qe)*be}function zO(d,i,l){return(d-i)/(l-i)}function FO(d,i,l,h,v,p,x,M,z){const V=1<<l,E=p-h,L=x-v,B=(d+1)/V*E+h,O=(i+0)/V*L+v,F=(i+1)/V*L+v;M[0]=(d+0)/V*E+h,M[1]=O,z[0]=B,z[1]=F}class NO{constructor(i){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=i,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const l=function(p){const x=Math.ceil(Math.log2(p.dim/8)),M=[];let z=Math.ceil(Math.pow(2,x));const V=1/z,E=(O,F,G,Q,ie)=>{const pe=Q?1:0,ge=(O+1)*G-pe,ae=F*G,be=(F+1)*G-pe;ie[0]=O*G,ie[1]=ae,ie[2]=ge,ie[3]=be};let L=new RO(z);const B=[];for(let O=0;O<z*z;O++){E(O%z,Math.floor(O/z),V,!1,B);const F=wf(B[0],B[1],p),G=wf(B[2],B[1],p),Q=wf(B[2],B[3],p),ie=wf(B[0],B[3],p);L.minimums.push(Math.min(F,G,Q,ie)),L.maximums.push(Math.max(F,G,Q,ie)),L.leaves.push(1)}for(M.push(L),z/=2;z>=1;z/=2){const O=M[M.length-1];L=new RO(z);for(let F=0;F<z*z;F++){E(F%z,Math.floor(F/z),2,!0,B);const G=O.getElevation(B[0],B[1]),Q=O.getElevation(B[2],B[1]),ie=O.getElevation(B[2],B[3]),pe=O.getElevation(B[0],B[3]),ge=O.isLeaf(B[0],B[1]),ae=O.isLeaf(B[2],B[1]),be=O.isLeaf(B[2],B[3]),Te=O.isLeaf(B[0],B[3]),Be=Math.min(G.min,Q.min,ie.min,pe.min),Xe=Math.max(G.max,Q.max,ie.max,pe.max),Ze=ge&&ae&&be&&Te;L.maximums.push(Xe),L.minimums.push(Be),L.leaves.push(Xe-Be<=5&&Ze?1:0)}M.push(L)}return M}(this.dem),h=l.length-1,v=l[h];this._addNode(v.minimums[0],v.maximums[0],v.leaves[0]),this._construct(l,0,0,h,0)}raycastRoot(i,l,h,v,p,x,M=1){return OO([i,l,-100],[h,v,this.maximums[0]*M],p,x)}raycast(i,l,h,v,p,x,M=1){if(!this.nodeCount)return null;const z=this.raycastRoot(i,l,h,v,p,x,M);if(z==null)return null;const V=[],E=[],L=[],B=[],O=[{idx:0,t:z,nodex:0,nodey:0,depth:0}];for(;O.length>0;){const{idx:F,t:G,nodex:Q,nodey:ie,depth:pe}=O.pop();if(this.leaves[F]){FO(Q,ie,pe,i,l,h,v,L,B);const ae=1<<pe,be=(Q+0)/ae,Te=(Q+1)/ae,Be=(ie+0)/ae,Xe=(ie+1)/ae,Ze=wf(be,Be,this.dem)*M,He=wf(Te,Be,this.dem)*M,ct=wf(Te,Xe,this.dem)*M,Qe=wf(be,Xe,this.dem)*M,pt=DO(L[0],L[1],Ze,B[0],L[1],He,B[0],B[1],ct,p,x),St=DO(B[0],B[1],ct,L[0],B[1],Qe,L[0],L[1],Ze,p,x),Tt=Math.min(pt!==null?pt:Number.MAX_VALUE,St!==null?St:Number.MAX_VALUE);if(Tt!==Number.MAX_VALUE)return Tt;{const It=Ne.vec3.scaleAndAdd([],p,x,G);if(BO(Ze,He,Qe,ct,zO(It[0],L[0],B[0]),zO(It[1],L[1],B[1]))>=It[2])return G}continue}let ge=0;for(let ae=0;ae<this._siblingOffset.length;ae++){FO((Q<<1)+this._siblingOffset[ae][0],(ie<<1)+this._siblingOffset[ae][1],pe+1,i,l,h,v,L,B),L[2]=-100,B[2]=this.maximums[this.childOffsets[F]+ae]*M;const be=OO(L,B,p,x);if(be!=null){const Te=be;V[ae]=Te;let Be=!1;for(let Xe=0;Xe<ge&&!Be;Xe++)Te>=V[E[Xe]]&&(E.splice(Xe,0,ae),Be=!0);Be||(E[ge]=ae),ge++}}for(let ae=0;ae<ge;ae++){const be=E[ae];O.push({idx:this.childOffsets[F]+be,t:V[be],nodex:(Q<<1)+this._siblingOffset[be][0],nodey:(ie<<1)+this._siblingOffset[be][1],depth:pe+1})}}return null}_addNode(i,l,h){return this.minimums.push(i),this.maximums.push(l),this.leaves.push(h),this.childOffsets.push(0),this.nodeCount++}_construct(i,l,h,v,p){if(i[v].isLeaf(l,h)===1)return;this.childOffsets[p]||(this.childOffsets[p]=this.nodeCount);const x=v-1,M=i[x];let z=0,V=0;for(let E=0;E<this._siblingOffset.length;E++){const L=2*l+this._siblingOffset[E][0],B=2*h+this._siblingOffset[E][1],O=M.getElevation(L,B),F=M.isLeaf(L,B),G=this._addNode(O.min,O.max,F);F&&(z|=1<<E),V||(V=G)}for(let E=0;E<this._siblingOffset.length;E++)z&1<<E||this._construct(i,2*l+this._siblingOffset[E][0],2*h+this._siblingOffset[E][1],x,V+E)}}function BO(d,i,l,h,v,p){return sr(sr(d,l,p),sr(i,h,p),v)}function wf(d,i,l){const h=l.dim,v=Wt(d*h-.5,0,h-1),p=Wt(i*h-.5,0,h-1),x=Math.floor(v),M=Math.floor(p),z=Math.min(x+1,h-1),V=Math.min(M+1,h-1);return BO(l.get(x,M),l.get(z,M),l.get(x,V),l.get(z,V),v-x,p-M)}const wG={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function SG(d,i,l){return(256*d*256+256*i+l)/10-1e4}function CG(d,i,l){return 256*d+i+l/256-32768}class qb{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(i,l,h,v=!1){if(this.uid=i,l.height!==l.width)throw new RangeError("DEM tiles must be square");if(h&&h!=="mapbox"&&h!=="terrarium")return void vr(`"${h}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=l.height;const p=this.dim=l.height-2,x=new Uint32Array(l.data.buffer);if(this.pixels=new Uint8Array(l.data.buffer),this.floatView=new Float32Array(l.data.buffer),this.borderReady=v,this._modifiedForSources={},!v){for(let z=0;z<p;z++)x[this._idx(-1,z)]=x[this._idx(0,z)],x[this._idx(p,z)]=x[this._idx(p-1,z)],x[this._idx(z,-1)]=x[this._idx(z,0)],x[this._idx(z,p)]=x[this._idx(z,p-1)];x[this._idx(-1,-1)]=x[this._idx(0,0)],x[this._idx(p,-1)]=x[this._idx(p-1,0)],x[this._idx(-1,p)]=x[this._idx(0,p-1)],x[this._idx(p,p)]=x[this._idx(p-1,p-1)]}const M=h==="terrarium"?CG:SG;for(let z=0;z<x.length;++z){const V=4*z;this.floatView[z]=M(this.pixels[V],this.pixels[V+1],this.pixels[V+2])}this._timestamp=zt.now()}_buildQuadTree(){this._tree=new NO(this)}get(i,l,h=!1){h&&(i=Wt(i,-1,this.dim),l=Wt(l,-1,this.dim));const v=this._idx(i,l);return this.floatView[v]}set(i,l,h){const v=this._idx(i,l),p=this.floatView[v];return this.floatView[v]=h,h-p}static getUnpackVector(i){return wG[i]}_idx(i,l){if(i<-1||i>=this.dim+1||l<-1||l>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(l+1)*this.stride+(i+1)}static pack(i,l){const h=[0,0,0,0],v=qb.getUnpackVector(l);let p=Math.floor((i+v[3])/v[2]);return h[2]=p%256,p=Math.floor(p/256),h[1]=p%256,p=Math.floor(p/256),h[0]=p,h}getPixels(){return new _L({width:this.stride,height:this.stride},this.pixels)}backfillBorder(i,l,h){if(this.dim!==i.dim)throw new Error("dem dimension mismatch");let v=l*this.dim,p=l*this.dim+this.dim,x=h*this.dim,M=h*this.dim+this.dim;switch(l){case-1:v=p-1;break;case 1:p=v+1}switch(h){case-1:x=M-1;break;case 1:M=x+1}const z=-l*this.dim,V=-h*this.dim;for(let E=x;E<M;E++)for(let L=v;L<p;L++){const B=4*this._idx(L,E),O=4*this._idx(L+z,E+V);this.pixels[B+0]=i.pixels[O+0],this.pixels[B+1]=i.pixels[O+1],this.pixels[B+2]=i.pixels[O+2],this.pixels[B+3]=i.pixels[O+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}function EG(d,i,l){d===1?i.header_length=l.readFixed32():d===2?i.x=l.readVarint():d===3?i.y=l.readVarint():d===4?i.z=l.readVarint():d===5&&i.layers.push(function(h,v){return h.readFields(PG,{version:0,name:"",units:"",tilesize:0,buffer:0,pixel_format:0,data_index:[]},v)}(l,l.readVarint()+l.pos))}function TG(d,i,l){d===1?(i.delta_filter=function(h,v){return h.readFields(IG,{block_size:0},v)}(l,l.readVarint()+l.pos),i.filter="delta_filter"):d===2?(l.readVarint(),i.filter="zigzag_filter"):d===3?(l.readVarint(),i.filter="bitshuffle_filter"):d===4&&(l.readVarint(),i.filter="byteshuffle_filter")}function IG(d,i,l){d===1&&(i.block_size=l.readVarint())}function kG(d,i,l){d===1?(l.readVarint(),i.codec="gzip_data"):d===2?(l.readVarint(),i.codec="jpeg_image"):d===3?(l.readVarint(),i.codec="webp_image"):d===4&&(l.readVarint(),i.codec="png_image")}function MG(d,i,l){d===1?i.first_byte=l.readFixed64():d===2?i.last_byte=l.readFixed64():d===3?i.filters.push(function(h,v){return h.readFields(TG,{},v)}(l,l.readVarint()+l.pos)):d===4?i.codec=function(h,v){return h.readFields(kG,{},v)}(l,l.readVarint()+l.pos):d===5?i.deprecated_offset=l.readFloat():d===6?i.deprecated_scale=l.readFloat():d===7?i.bands.push(l.readString()):d===8?i.offset=l.readDouble():d===9&&(i.scale=l.readDouble())}function PG(d,i,l){d===1?i.version=l.readVarint():d===2?i.name=l.readString():d===3?i.units=l.readString():d===4?i.tilesize=l.readVarint():d===5?i.buffer=l.readVarint():d===6?i.pixel_format=l.readVarint():d===7&&i.data_index.push(function(h,v){return h.readFields(MG,{first_byte:0,last_byte:0,filters:[],codec:null,offset:0,scale:0,deprecated_offset:0,deprecated_scale:0,bands:[]},v)}(l,l.readVarint()+l.pos))}function AG(d,i,l){if(d===2)(function(h,v,p){h.readFields(LG,p,v)})(l,l.readVarint()+l.pos,i);else if(d===3)throw new Error("Not implemented")}function LG(d,i,l){if(d===1){let h=0;const v=l.readVarint()+l.pos;for(;l.pos<v;)i[h++]=l.readVarint()}}ir(qb,"DEMData"),ir(NO,"DemMinMaxQuadTree",{omit:["dem"]});class RG{constructor(i){this.capacity=i,this.cache=new Map}get(i){if(!this.cache.has(i))return;const l=this.cache.get(i);return this.cache.delete(i),this.cache.set(i,l),l}put(i,l){this.cache.has(i)?this.cache.delete(i):this.cache.size===this.capacity&&this.cache.delete(this.cache.keys().next().value),this.cache.set(i,l)}}function OG(d,i){if(i.length!==4)throw new Error(`Expected data of dimension 4 but got ${i.length}.`);let l=i[3];for(let h=2;h>=1;h--){const v=h===1?1:0,p=h===2?1:0;for(let x=0;x<i[0];x++){const M=i[1]*x;for(let z=v;z<i[1];z++){const V=i[2]*(z+M);for(let E=p;E<i[2];E++){const L=i[3]*(E+V);for(let B=0;B<i[3];B++){const O=L+B;d[O]+=d[O-l]}}}}l*=i[h]}return d}function DG(d){for(let i=0,l=d.length;i<l;i++)d[i]=d[i]>>>1^-(1&d[i]);return d}function zG(d,i){switch(i){case"uint32":return d;case"uint16":for(let l=0;l<d.length;l+=2){const h=d[l],v=d[l+1];d[l]=(240&h)>>4|(61440&h)>>8|(240&v)<<4|61440&v,d[l+1]=15&h|(3840&h)>>4|(15&v)<<8|(3840&v)<<4}return d;case"uint8":for(let l=0;l<d.length;l+=4){const h=d[l],v=d[l+1],p=d[l+2],x=d[l+3];d[l+0]=(192&h)>>6|(192&v)>>4|(192&p)>>2|192&x,d[l+1]=(48&h)>>4|(48&v)>>2|48&p|(48&x)<<2,d[l+2]=(12&h)>>2|12&v|(12&p)<<2|(12&x)<<4,d[l+3]=3&h|(3&v)<<2|(3&p)<<4|(3&x)<<6}return d;default:throw new Error(`Invalid pixel format, "${i}"`)}}var yu=Uint8Array,U_=Uint16Array,FG=Int32Array,jO=new yu([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),VO=new yu([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),NG=new yu([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),$O=function(d,i){for(var l=new U_(31),h=0;h<31;++h)l[h]=i+=1<<d[h-1];var v=new FG(l[30]);for(h=1;h<30;++h)for(var p=l[h];p<l[h+1];++p)v[p]=p-l[h]<<5|h;return{b:l,r:v}},UO=$O(jO,2),GO=UO.b,BG=UO.r;GO[28]=258,BG[258]=28;for(var jG=$O(VO,0).b,HO=new U_(32768),ds=0;ds<32768;++ds){var Lg=(43690&ds)>>1|(21845&ds)<<1;HO[ds]=((65280&(Lg=(61680&(Lg=(52428&Lg)>>2|(13107&Lg)<<2))>>4|(3855&Lg)<<4))>>8|(255&Lg)<<8)>>1}var G_=function(d,i,l){for(var h=d.length,v=0,p=new U_(i);v<h;++v)d[v]&&++p[d[v]-1];var x,M=new U_(i);for(v=1;v<i;++v)M[v]=M[v-1]+p[v-1]<<1;x=new U_(1<<i);var z=15-i;for(v=0;v<h;++v)if(d[v])for(var V=v<<4|d[v],E=i-d[v],L=M[d[v]-1]++<<E,B=L|(1<<E)-1;L<=B;++L)x[HO[L]>>z]=V;return x},H_=new yu(288);for(ds=0;ds<144;++ds)H_[ds]=8;for(ds=144;ds<256;++ds)H_[ds]=9;for(ds=256;ds<280;++ds)H_[ds]=7;for(ds=280;ds<288;++ds)H_[ds]=8;var WO=new yu(32);for(ds=0;ds<32;++ds)WO[ds]=5;var VG=G_(H_,9),$G=G_(WO,5),gI=function(d){for(var i=d[0],l=1;l<d.length;++l)d[l]>i&&(i=d[l]);return i},zc=function(d,i,l){var h=i/8|0;return(d[h]|d[h+1]<<8)>>(7&i)&l},yI=function(d,i){var l=i/8|0;return(d[l]|d[l+1]<<8|d[l+2]<<16)>>(7&i)},UG=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Fc=function(d,i,l){var h=new Error(i||UG[d]);if(h.code=d,Error.captureStackTrace&&Error.captureStackTrace(h,Fc),!l)throw h;return h},GG=new yu(0),HG=typeof TextDecoder<"u"&&new TextDecoder;try{HG.decode(GG,{stream:!0})}catch{}const WG={gzip_data:"gzip"};class qu extends Error{constructor(i){super(i),this.name="MRTError"}}const qG={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},qO={uint32:1,uint16:2,uint8:4},XG={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};let _I;class vI{constructor(i=5){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=i}getLayer(i){const l=this.layers[i];if(!l)throw new qu(`Layer '${i}' not found`);return l}getHeaderLength(i){const l=new Uint8Array(i),h=new DataView(i);if(l[0]!==13)throw new qu("File is not a valid MRT.");return h.getUint32(1,!0)}parseHeader(i){const l=new Uint8Array(i),h=this.getHeaderLength(i);if(l.length<h)throw new qu(`Expected header with length >= ${h} but got buffer of length ${l.length}`);const v=function(p,x){return p.readFields(EG,{header_length:0,x:0,y:0,z:0,layers:[]},void 0)}(new _I(l.subarray(0,h)));if(!isNaN(this.x)&&(this.x!==v.x||this.y!==v.y||this.z!==v.z))throw new qu(`Invalid attempt to parse header ${v.z}/${v.x}/${v.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=v.x,this.y=v.y,this.z=v.z;for(const p of v.layers)this.layers[p.name]=new YG(p,{cacheSize:this._cacheSize});return this}createDecodingTask(i){const l=[],h=this.getLayer(i.layerName);for(let v of i.blockIndices){const p=h.dataIndex[v],x=p.first_byte-i.firstByte,M=p.last_byte-i.firstByte;if(h._blocksInProgress.has(v))continue;const z={layerName:h.name,firstByte:x,lastByte:M,pixelFormat:h.pixelFormat,blockIndex:v,blockShape:[p.bands.length].concat(h.bandShape),buffer:h.buffer,codec:p.codec.codec,filters:p.filters.map(V=>V.filter)};h._blocksInProgress.add(v),l.push(z)}return new XO(l,()=>{l.forEach(v=>h._blocksInProgress.delete(v.blockIndex))},(v,p)=>{if(l.forEach(x=>h._blocksInProgress.delete(x.blockIndex)),v)throw v;p.forEach(x=>{this.getLayer(x.layerName).processDecodedData(x)})})}}class YG{constructor({version:i,name:l,units:h,tilesize:v,pixel_format:p,buffer:x,data_index:M},z){if(this.version=i,this.version!==1)throw new qu(`Cannot parse raster layer encoded with MRT version ${i}`);this.name=l,this.units=h,this.tileSize=v,this.buffer=x,this.pixelFormat=qG[p],this.dataIndex=M,this.bandShape=[v+2*x,v+2*x,qO[this.pixelFormat]],this._decodedBlocks=new RG(z?z.cacheSize:5),this._blocksInProgress=new Set}get dimension(){return qO[this.pixelFormat]}get cacheSize(){return this._decodedBlocks.capacity}getBandList(){return this.dataIndex.map(({bands:i})=>i).flat()}processDecodedData(i){const l=i.blockIndex.toString();this._decodedBlocks.get(l)||this._decodedBlocks.put(l,i.data)}getBlockForBand(i){let l=0;switch(typeof i){case"string":for(const[h,v]of this.dataIndex.entries()){for(const[p,x]of v.bands.entries())if(x===i)return{bandIndex:l+p,blockIndex:h,blockBandIndex:p};l+=v.bands.length}break;case"number":for(const[h,v]of this.dataIndex.entries()){if(i>=l&&i<l+v.bands.length)return{bandIndex:i,blockIndex:h,blockBandIndex:i-l};l+=v.bands.length}break;default:throw new qu(`Invalid band \`${JSON.stringify(i)}\`. Expected string or integer.`)}throw new qu(`Band not found: ${JSON.stringify(i)}`)}getDataRange(i){let l=1/0,h=-1/0;const v=[],p=new Set;for(const x of i){const{blockIndex:M}=this.getBlockForBand(x);if(M<0)throw new qu(`Invalid band: ${JSON.stringify(x)}`);const z=this.dataIndex[M];v.includes(M)||v.push(M),p.add(M),l=Math.min(l,z.first_byte),h=Math.max(h,z.last_byte)}if(p.size>this.cacheSize)throw new qu(`Number of blocks to decode (${p.size}) exceeds cache size (${this.cacheSize}).`);return{layerName:this.name,firstByte:l,lastByte:h,blockIndices:v}}hasBand(i){const{blockIndex:l}=this.getBlockForBand(i);return l>=0}hasDataForBand(i){const{blockIndex:l}=this.getBlockForBand(i);return l>=0&&!!this._decodedBlocks.get(l.toString())}getBandView(i){const{blockIndex:l,blockBandIndex:h}=this.getBlockForBand(i),v=this._decodedBlocks.get(l.toString());if(!v)throw new qu(`Data for band ${JSON.stringify(i)} of layer "${this.name}" not decoded.`);const p=this.dataIndex[l],x=this.bandShape.reduce((V,E)=>V*E,1),M=h*x,z=v.subarray(M,M+x);return{data:z,bytes:new Uint8Array(z.buffer).subarray(z.byteOffset,z.byteOffset+z.byteLength),tileSize:this.tileSize,buffer:this.buffer,pixelFormat:this.pixelFormat,dimension:this.dimension,offset:p.offset!==0?p.offset:p.deprecated_offset,scale:p.scale!==0?p.scale:p.deprecated_scale}}}vI.setPbf=function(d){_I=d};class XO{constructor(i,l,h){this.tasks=i,this._onCancel=l,this._onComplete=h,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(i,l){this._finalized||(this._onComplete(i,l),this._finalized=!0)}}vI.performDecoding=function(d,i){const l=new Uint8Array(d);return Promise.all(i.tasks.map(h=>{const{layerName:v,firstByte:p,lastByte:x,pixelFormat:M,blockShape:z,blockIndex:V,filters:E,codec:L}=h,B=l.subarray(p,x+1),O=new Uint32Array(z[0]*z[1]*z[2]);let F;if(L!=="gzip_data")throw new qu(`Unhandled codec: ${L}`);return F=function(G,Q){if(!globalThis.DecompressionStream&&Q==="gzip_data")return Promise.resolve(((ae=function(Be){Be[0]==31&&Be[1]==139&&Be[2]==8||Fc(6,"invalid gzip data");var Xe=Be[3],Ze=10;4&Xe&&(Ze+=2+(Be[10]|Be[11]<<8));for(var He=(Xe>>3&1)+(Xe>>4&1);He>0;He-=!Be[Ze++]);return Ze+(2&Xe)}(ge=G))+8>ge.length&&Fc(6,"invalid gzip data"),function(Be,Xe,Ze,He){var ct=Be.length;if(!ct||Xe.f&&!Xe.l)return Ze||new yu(0);var Qe=!Ze,pt=Qe||Xe.i!=2,St=Xe.i;Qe&&(Ze=new yu(3*ct));var Tt,It,Lt=function(Sf){var Zp=Ze.length;if(Sf>Zp){var J_=new yu(Math.max(2*Zp,Sf));J_.set(Ze),Ze=J_}},Yt=Xe.f||0,Rt=Xe.p||0,ln=Xe.b||0,gn=Xe.l,Qt=Xe.d,Qn=Xe.m,$n=Xe.n,kn=8*ct;do{if(!gn){Yt=zc(Be,Rt,1);var vn=zc(Be,Rt+1,3);if(Rt+=3,!vn){var br=Be[(jr=4+((Rt+7)/8|0))-4]|Be[jr-3]<<8,Zn=jr+br;if(Zn>ct){St&&Fc(0);break}pt&&Lt(ln+br),Ze.set(Be.subarray(jr,Zn),ln),Xe.b=ln+=br,Xe.p=Rt=8*Zn,Xe.f=Yt;continue}if(vn==1)gn=VG,Qt=$G,Qn=9,$n=5;else if(vn==2){var nr=zc(Be,Rt,31)+257,Br=zc(Be,Rt+10,15)+4,ri=nr+zc(Be,Rt+5,31)+1;Rt+=14;for(var Xr=new yu(ri),Yr=new yu(19),si=0;si<Br;++si)Yr[NG[si]]=zc(Be,Rt+3*si,7);Rt+=3*Br;var li=gI(Yr),Xi=(1<<li)-1,Di=G_(Yr,li);for(si=0;si<ri;){var jr,Ii=Di[zc(Be,Rt,Xi)];if(Rt+=15&Ii,(jr=Ii>>4)<16)Xr[si++]=jr;else{var Ai=0,lo=0;for(jr==16?(lo=3+zc(Be,Rt,3),Rt+=2,Ai=Xr[si-1]):jr==17?(lo=3+zc(Be,Rt,7),Rt+=3):jr==18&&(lo=11+zc(Be,Rt,127),Rt+=7);lo--;)Xr[si++]=Ai}}var Jo=Xr.subarray(0,nr),hs=Xr.subarray(nr);Qn=gI(Jo),$n=gI(hs),gn=G_(Jo,Qn),Qt=G_(hs,$n)}else Fc(1);if(Rt>kn){St&&Fc(0);break}}pt&&Lt(ln+131072);for(var Qo=(1<<Qn)-1,Po=(1<<$n)-1,Zs=Rt;;Zs=Rt){var ys=(Ai=gn[yI(Be,Rt)&Qo])>>4;if((Rt+=15&Ai)>kn){St&&Fc(0);break}if(Ai||Fc(2),ys<256)Ze[ln++]=ys;else{if(ys==256){Zs=Rt,gn=null;break}var fa=ys-254;ys>264&&(fa=zc(Be,Rt,(1<<(Bc=jO[si=ys-257]))-1)+GO[si],Rt+=Bc);var io=Qt[yI(Be,Rt)&Po],Il=io>>4;if(io||Fc(3),Rt+=15&io,hs=jG[Il],Il>3){var Bc=VO[Il];hs+=yI(Be,Rt)&(1<<Bc)-1,Rt+=Bc}if(Rt>kn){St&&Fc(0);break}pt&&Lt(ln+131072);var Xu=ln+fa;if(ln<hs){var Yu=0-hs,Yp=Math.min(hs,Xu);for(Yu+ln<0&&Fc(3);ln<Yp;++ln)Ze[ln]=(void 0)[Yu+ln]}for(;ln<Xu;++ln)Ze[ln]=Ze[ln-hs]}}Xe.l=gn,Xe.p=Zs,Xe.b=ln,Xe.f=Yt,gn&&(Yt=1,Xe.m=Qn,Xe.d=Qt,Xe.n=$n)}while(!Yt);return ln!=Ze.length&&Qe?(Tt=Ze,((It=ln)==null||It>Tt.length)&&(It=Tt.length),new yu(Tt.subarray(0,It))):Ze.subarray(0,ln)}(ge.subarray(ae,-8),{i:2},new yu(((ie=ge)[(pe=ie.length)-4]|ie[pe-3]<<8|ie[pe-2]<<16|ie[pe-1]<<24)>>>0))));var ie,pe,ge,ae;const be=WG[Q];if(!be)throw new Error(`Unhandled codec: ${Q}`);const Te=new globalThis.DecompressionStream(be);return new Response(new Blob([G]).stream().pipeThrough(Te)).arrayBuffer().then(Be=>new Uint8Array(Be))}(B,L).then(G=>(function(Q,ie){Q.readFields(AG,ie)}(new _I(G),O),new XG[M](O.buffer))),F.then(G=>{for(let Q=E.length-1;Q>=0;Q--)switch(E[Q]){case"delta_filter":OG(G,z);break;case"zigzag_filter":DG(G);break;case"bitshuffle_filter":zG(G,M);break;default:throw new qu(`Unhandled filter "${E[Q]}"`)}return{layerName:v,blockIndex:V,data:G}}).catch(G=>{throw G})}))},ir(XO,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]});var W_={workerUrl:"",workerClass:null,workerParams:void 0};const xI="mapboxgl_preloaded_worker_pool";class q_{constructor(){this.active={}}acquire(i){if(!this.workers)for(this.workers=[];this.workers.length<q_.workerCount;)this.workers.push(W_.workerClass!=null?new W_.workerClass:new self.Worker(W_.workerUrl,W_.workerParams));return this.active[i]=!0,this.workers.slice()}release(i){delete this.active[i],this.workers&&this.numActive()===0&&(this.workers.forEach(l=>{l.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[xI]}numActive(){return Object.keys(this.active).length}}let X_;function Xb(){return X_||(X_=new q_),X_}q_.workerCount=2;let Y_,bI,Nc,Rg,wI,Og=null;function YO(){return ji()&&self.worker&&self.worker.dracoUrl?self.worker.dracoUrl:bI||_t.DRACO_URL}function ZO(){if(ji()&&self.worker&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(Rg)return Rg;const d=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if(typeof WebAssembly!="object")throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return Rg=WebAssembly.validate(d)?_t.MESHOPT_SIMD_URL:_t.MESHOPT_URL,Rg}const Yb={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},ZG={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},Z_={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function KO(d,i,l){const h=l.json.bufferViews.length,v=l.buffers.length;i.bufferView=h,l.json.bufferViews[h]={buffer:v,byteLength:d.byteLength},l.buffers[v]=d}const SI="KHR_draco_mesh_compression";function KG(d,i){const l=d.extensions&&d.extensions[SI];if(!l)return;const h=new Nc.Decoder,v=tD(i,l.bufferView),p=new Nc.Mesh;if(!h.DecodeArrayToMesh(v,v.byteLength,p))throw new Error("Failed to decode Draco mesh");const x=i.json.accessors[d.indices],M=Yb[x.componentType],z=x.count*M.BYTES_PER_ELEMENT,V=Nc._malloc(z);M===Uint16Array?h.GetTrianglesUInt16Array(p,z,V):h.GetTrianglesUInt32Array(p,z,V),KO(Nc.memory.buffer.slice(V,V+z),x,i),Nc._free(V);for(const E of Object.keys(l.attributes)){const L=h.GetAttributeByUniqueId(p,l.attributes[E]),B=i.json.accessors[d.attributes[E]],O=ZG[B.componentType],F=B.count*Z_[B.type]*Yb[B.componentType].BYTES_PER_ELEMENT,G=Nc._malloc(F);h.GetAttributeDataArrayForAllPoints(p,L,Nc[O],F,G),KO(Nc.memory.buffer.slice(G,G+F),B,i),Nc._free(G)}h.destroy(),p.destroy(),delete d.extensions[SI]}const Zb="EXT_meshopt_compression";function JG(d,i){if(!d.extensions||!d.extensions[Zb])return;const l=d.extensions[Zb],h=new Uint8Array(i.buffers[l.buffer],l.byteOffset||0,l.byteLength||0),v=new Uint8Array(l.count*l.byteStride);wI.decodeGltfBuffer(v,l.count,l.byteStride,h,l.mode,l.filter),d.buffer=i.buffers.length,d.byteOffset=0,i.buffers[d.buffer]=v.buffer,delete d.extensions[Zb]}const JO=1179937895,QO=new TextDecoder("utf8");function eD(d,i){return new URL(d,i).href}function QG(d,i,l,h){return fetch(eD(d.uri,h)).then(v=>v.arrayBuffer()).then(v=>{i.buffers[l]=v})}function tD(d,i){const l=d.json.bufferViews[i];return new Uint8Array(d.buffers[l.buffer],l.byteOffset||0,l.byteLength)}function e9(d,i,l,h){if(d.uri){const v=eD(d.uri,h);return fetch(v).then(p=>p.blob()).then(p=>createImageBitmap(p)).then(p=>{i.images[l]=p})}if(d.bufferView!==void 0){const v=tD(i,d.bufferView),p=new Blob([v],{type:d.mimeType});return createImageBitmap(p).then(x=>{i.images[l]=x})}}function nD(d,i=0,l){const h={json:null,images:[],buffers:[]};if(new Uint32Array(d,i,1)[0]===JO){const E=new Uint32Array(d,i);let L=2;const B=(E[L++]>>2)-3,O=E[L++]>>2;if(L++,h.json=JSON.parse(QO.decode(E.subarray(L,L+O))),L+=O,L<B){const F=E[L++];L++;const G=i+(L<<2);h.buffers[0]=d.slice(G,G+F)}}else h.json=JSON.parse(QO.decode(new Uint8Array(d,i)));const{buffers:v,images:p,meshes:x,extensionsUsed:M,bufferViews:z}=h.json;let V=Promise.resolve();if(v){const E=[];for(let L=0;L<v.length;L++){const B=v[L];B.uri?E.push(QG(B,h,L,l)):h.buffers[L]||(h.buffers[L]=null)}V=Promise.all(E)}return V.then(()=>{const E=[],L=M&&M.includes(SI),B=M&&M.includes(Zb);if(L&&E.push(function(){if(!Nc)return Y_??(Y_=function(O){let F,G=null;function Q(){F=new Uint8Array(G.buffer)}function ie(){throw new Error("Unexpected Draco error.")}const pe={a:{a:ie,d:function(ge,ae,be){return F.copyWithin(ge,ae,ae+be)},c:function(ge){const ae=F.length,be=Math.max(ge>>>0,Math.ceil(1.2*ae)),Te=Math.ceil((be-ae)/65536);try{return G.grow(Te),Q(),!0}catch{return!1}},b:ie}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(O,pe):O.then(ge=>ge.arrayBuffer()).then(ge=>WebAssembly.instantiate(ge,pe))).then(ge=>{const{Rb:ae,Qb:be,P:Te,T:Be,X:Xe,Ja:Ze,La:He,Qa:ct,Va:Qe,Wa:pt,eb:St,jb:Tt,f:It,e:Lt,yb:Yt,zb:Rt,Ab:ln,Bb:gn,Db:Qt,Gb:Qn}=ge.instance.exports;G=Lt;const $n=(()=>{let kn=0,vn=0,br=0,Zn=0;return nr=>{br&&(ae(Zn),ae(kn),vn+=br,br=kn=0),kn||(vn+=128,kn=be(vn));const Br=nr.length+7&-8;let ri=kn;Br>=vn&&(br=Br,ri=Zn=be(Br));for(let Xr=0;Xr<nr.length;Xr++)F[ri+Xr]=nr[Xr];return ri}})();return Q(),It(),{memory:Lt,_free:ae,_malloc:be,Mesh:class{constructor(){this.ptr=Te()}destroy(){Be(this.ptr)}},Decoder:class{constructor(){this.ptr=Ze()}destroy(){Tt(this.ptr)}DecodeArrayToMesh(kn,vn,br){const Zn=$n(kn),nr=He(this.ptr,Zn,vn,br.ptr);return!!Xe(nr)}GetAttributeByUniqueId(kn,vn){return{ptr:ct(this.ptr,kn.ptr,vn)}}GetTrianglesUInt16Array(kn,vn,br){Qe(this.ptr,kn.ptr,vn,br)}GetTrianglesUInt32Array(kn,vn,br){pt(this.ptr,kn.ptr,vn,br)}GetAttributeDataArrayForAllPoints(kn,vn,br,Zn,nr){St(this.ptr,kn.ptr,vn.ptr,br,Zn,nr)}},DT_INT8:Yt(),DT_UINT8:Rt(),DT_INT16:ln(),DT_UINT16:gn(),DT_UINT32:Qt(),DT_FLOAT32:Qn()}})}(fetch(YO())),Y_.then(O=>{Nc=O,Y_=void 0}))}()),B&&E.push(function(){if(wI)return;const O=function(F){let G;const Q=WebAssembly.instantiateStreaming(F,{}).then(ge=>{G=ge.instance,G.exports.__wasm_call_ctors()}),ie={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},pe={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:Q,supported:!0,decodeGltfBuffer(ge,ae,be,Te,Be,Xe){(function(Ze,He,ct,Qe,pt,St,Tt){const It=Ze.exports.sbrk,Lt=Qe+3&-4,Yt=It(Lt*pt),Rt=It(St.length),ln=new Uint8Array(Ze.exports.memory.buffer);ln.set(St,Rt);const gn=He(Yt,Qe,pt,Rt,St.length);if(gn===0&&Tt&&Tt(Yt,Lt,pt),ct.set(ln.subarray(Yt,Yt+Qe*pt)),It(Yt-It(0)),gn!==0)throw new Error(`Malformed buffer data: ${gn}`)})(G,G.exports[pe[Be]],ge,ae,be,Te,G.exports[ie[Xe]])}}}(fetch(ZO()));return O.ready.then(()=>{wI=O})}()),p)for(let O=0;O<p.length;O++)E.push(e9(p[O],h,O,l));return(E.length?Promise.all(E):Promise.resolve()).then(()=>{if(L&&x)for(const{primitives:O}of x)for(const F of O)KG(F,h);if(B&&x&&z)for(const O of z)JG(O,h);return h})})}function Xp(d,i){const l=d.json.bufferViews[i.bufferView],h=Yb[i.componentType];return new h(d.buffers[l.buffer],(i.byteOffset||0)+(l.byteOffset||0),i.count*(l.byteStride&&l.byteStride!==Z_[i.type]*h.BYTES_PER_ELEMENT?l.byteStride/h.BYTES_PER_ELEMENT:Z_[i.type]))}function CI(d,i,l,h){const v=Yb[i.componentType],p=function(E){switch(E){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(v),x=d.json.bufferViews[i.bufferView],M=x.byteStride?x.byteStride/v.BYTES_PER_ELEMENT:Z_[i.type],z=l.float32,V=z.length/l.capacity;for(let E=0,L=0;E<i.count*M;E+=M,L+=V)for(let B=0;B<V;B++)z[L+B]=h[E+B]*p;l._trim()}function t9(d,i,l){const h=d.indices,v=d.attributes,p={};p.indexArray=new sa;const x=i.json.accessors[h],M=x.count/3;p.indexArray.reserve(M);const z=Xp(i,x);for(let B=0;B<M;B++)p.indexArray.emplaceBack(z[3*B],z[3*B+1],z[3*B+2]);p.indexArray._trim(),p.vertexArray=new vd;const V=i.json.accessors[v.POSITION];p.vertexArray.reserve(V.count);const E=Xp(i,V);for(let B=0;B<V.count;B++)p.vertexArray.emplaceBack(E[3*B],E[3*B+1],E[3*B+2]);if(p.vertexArray._trim(),p.aabb=new ro(V.min,V.max),p.centroid=function(B,O){const F=[0,0,0],G=B.length;if(G>0){for(let Q=0;Q<G;Q++){const ie=3*B[Q];F[0]+=O[ie],F[1]+=O[ie+1],F[2]+=O[ie+2]}F[0]/=G,F[1]/=G,F[2]/=G}return F}(z,E),v.COLOR_0!==void 0){const B=i.json.accessors[v.COLOR_0],O=Z_[B.type],F=Xp(i,B);p.colorArray=O===3?new vd:new Mc,p.colorArray.resize(B.count),CI(i,B,p.colorArray,F)}if(v.NORMAL!==void 0){p.normalArray=new vd;const B=i.json.accessors[v.NORMAL];p.normalArray.resize(B.count);const O=Xp(i,B);CI(i,B,p.normalArray,O)}if(v.TEXCOORD_0!==void 0&&l.length>0){p.texcoordArray=new Np;const B=i.json.accessors[v.TEXCOORD_0];p.texcoordArray.resize(B.count);const O=Xp(i,B);CI(i,B,p.texcoordArray,O)}if(v._FEATURE_ID_RGBA4444!==void 0){const B=i.json.accessors[v._FEATURE_ID_RGBA4444];i.json.extensionsUsed&&i.json.extensionsUsed.includes("EXT_meshopt_compression")&&(p.featureData=Xp(i,B))}v._FEATURE_RGBA4444!==void 0&&(p.featureData=new Uint32Array(Xp(i,i.json.accessors[v._FEATURE_RGBA4444]).buffer));const L=d.material;return p.material=function(B,O){const{emissiveFactor:F=[0,0,0],alphaMode:G="OPAQUE",alphaCutoff:Q=.5,normalTexture:ie,occlusionTexture:pe,emissiveTexture:ge,doubleSided:ae}=B,{baseColorFactor:be=[1,1,1,1],metallicFactor:Te=1,roughnessFactor:Be=1,baseColorTexture:Xe,metallicRoughnessTexture:Ze}=B.pbrMetallicRoughness||{},He=pe?O[pe.index]:void 0;if(pe&&pe.extensions&&pe.extensions.KHR_texture_transform&&He){const ct=pe.extensions.KHR_texture_transform;He.offsetScale=[ct.offset[0],ct.offset[1],ct.scale[0],ct.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new Tr(...be),metallicFactor:Te,roughnessFactor:Be,baseColorTexture:Xe?O[Xe.index]:void 0,metallicRoughnessTexture:Ze?O[Ze.index]:void 0},doubleSided:ae,emissiveFactor:F,alphaMode:G,alphaCutoff:Q,normalTexture:ie?O[ie.index]:void 0,occlusionTexture:He,emissionTexture:ge?O[ge.index]:void 0,defined:B.defined===void 0}}(L!==void 0?i.json.materials[L]:{defined:!1},l),p}function rD(d,i,l){const{matrix:h,rotation:v,translation:p,scale:x,mesh:M,extras:z,children:V}=d,E={};if(E.matrix=h||Ne.mat4.fromRotationTranslationScale([],v||[0,0,0,1],p||[0,0,0],x||[1,1,1]),M!==void 0){E.meshes=l[M];const L=E.anchor=[0,0];for(const B of E.meshes){const{min:O,max:F}=B.aabb;L[0]+=O[0]+F[0],L[1]+=O[1]+F[1]}L[0]=Math.floor(L[0]/E.meshes.length/2),L[1]=Math.floor(L[1]/E.meshes.length/2)}if(z&&(z.id&&(E.id=z.id),z.lights&&(E.lights=function(L){if(!L.length)return[];const B=function(ie){const pe=atob(ie),ge=new Uint8Array(pe.length);for(let ae=0;ae<pe.length;ae++)ge[ae]=pe.codePointAt(ae);return ge}(L),O=[],F=B.length/24,G=new Uint16Array(B.buffer),Q=new Float32Array(B.buffer);for(let ie=0;ie<F;ie++){const pe=G[2*ie*6]/30,ge=G[2*ie*6+1]/30,ae=G[2*ie*6+10]/100,be=Q[6*ie+1],Te=Q[6*ie+2],Be=Q[6*ie+3],Xe=Q[6*ie+4],Ze=Be-be,He=Xe-Te,ct=Math.hypot(Ze,He);O.push({pos:[be+.5*Ze,Te+.5*He,ge],normal:[He/ct,-Ze/ct,0],width:ct,height:pe,depth:ae,points:[be,Te,Be,Xe]})}return O}(z.lights))),V){const L=[];for(const B of V)L.push(rD(i.json.nodes[B],i,l));E.children=L}return E}function n9(d){if(d.vertices.length===0||d.indices.length===0)return null;const i=new RT(d.vertices,d.indices,8,256),[l,h]=[i.min.clone(),i.max.clone()];return{vertices:d.vertices,indices:d.indices,grid:i,min:l,max:h}}function r9(d){if(!d.extras||!d.extras.ground)return null;const i=d.extras.ground;if(!i||!Array.isArray(i)||i.length===0)return null;const l=i[0];if(!l||!Array.isArray(l)||l.length===0)return null;const h=[];for(const x of l){if(!Array.isArray(x)||x.length!==2)continue;const M=x[0],z=x[1];typeof M=="number"&&typeof z=="number"&&h.push(new st(M,z))}if(h.length<3)return null;h.length>1&&h[h.length-1].equals(h[0])&&h.pop();let v=0;for(let x=0;x<h.length;x++){const M=h[x],z=h[(x+1)%h.length],V=h[(x+2)%h.length];v+=(M.x-z.x)*(V.y-z.y)-(V.x-z.x)*(M.y-z.y)}v>0&&h.reverse();const p=w_(h.flatMap(x=>[x.x,x.y]),[]);return p.length===0?null:{vertices:h,indices:p}}function i9(d,i){const l=[],h=[];let v=0;const p=[];for(const x of d){v=l.length;const M=x.vertexArray.float32,z=x.indexArray.uint16;for(let V=0;V<x.vertexArray.length;V++)p[0]=M[3*V+0],p[1]=M[3*V+1],p[2]=M[3*V+2],Ne.vec3.transformMat4(p,p,i),l.push(new st(p[0],p[1]));for(let V=0;V<3*x.indexArray.length;V++)h.push(z[V]+v)}if(h.length%3!=0)return null;for(let x=0;x<h.length;x+=3){const M=l[h[x+0]],z=l[h[x+1]],V=l[h[x+2]];(M.x-z.x)*(V.y-z.y)-(V.x-z.x)*(M.y-z.y)>0&&([h[x+1],h[x+2]]=[h[x+2],h[x+1]])}return{vertices:l,indices:h}}function iD(d){const i=function(z,V){const E=[],L=WebGL2RenderingContext;if(z.json.textures)for(const B of z.json.textures){const O={magFilter:L.LINEAR,minFilter:L.NEAREST,wrapS:L.REPEAT,wrapT:L.REPEAT};B.sampler!==void 0&&Object.assign(O,z.json.samplers[B.sampler]),E.push({image:V[B.source],sampler:O,uploaded:!1})}return E}(d,d.images),l=function(z,V){const E=[];for(const L of z.json.meshes){const B=[];for(const O of L.primitives)B.push(t9(O,z,V));E.push(B)}return E}(d,i),{scenes:h,scene:v,nodes:p}=d.json,x=h?h[v||0].nodes:p,M=[];for(const z of x)M.push(rD(p[z],d,l));return function(z,V,E){const L={},B=new Set;for(let O=0;O<z.length;O++){const F=E[V[O]];if(!F.extras)continue;const G=F.extras["mapbox:footprint:version"],Q=F.extras["mapbox:footprint:id"];(G||Q)&&B.add(O),G==="1.0.0"&&Q&&(L[Q]=O)}for(let O=0;O<z.length;O++){if(B.has(O))continue;const F=z[O],G=E[V[O]];if(!G.extras)continue;let Q=null;F.id in L&&(Q=i9(z[L[F.id]].meshes,F.matrix)),Q||(Q=r9(G)),Q&&(F.footprint=n9(Q))}if(B.size>0){const O=Array.from(B.values()).sort((F,G)=>F-G);for(let F=O.length-1;F>=0;F--)z.splice(O[F],1)}}(M,x,d.json.nodes),M}function o9(d){d.heightmap=new Float32Array(4096),d.heightmap.fill(-1);const i=d.vertexArray.float32,l=d.aabb.min[0]-1,h=d.aabb.min[1]-1,v=Wp/(d.aabb.max[0]-l+2),p=Wp/(d.aabb.max[1]-h+2);for(let x=0;x<i.length;x+=3){const M=i[x+2],z=(i[x+0]-l)*v|0,V=(i[x+1]-h)*p|0;M>d.heightmap[V*Wp+z]&&(d.heightmap[V*Wp+z]=M)}}function s9(d,i){const l={};l.indexArray=new sa,l.indexArray.reserve(4*d.length),l.vertexArray=new vd,l.vertexArray.reserve(10*d.length),l.colorArray=new Mc,l.vertexArray.reserve(10*d.length);let h=0;for(const x of d){const M=Math.min(10,Math.max(4,1.3*x.height))*i,z=[-x.normal[1],x.normal[0],0],V=Math.min(.29,.1*x.width/x.depth),E=x.width-2*x.depth*i*(V+.01),L=Ne.vec3.scaleAndAdd([],x.pos,z,E/2),B=Ne.vec3.scaleAndAdd([],x.pos,z,-E/2),O=[L[0],L[1],L[2]+x.height],F=[B[0],B[1],B[2]+x.height],G=Ne.vec3.scaleAndAdd([],x.normal,z,V);Ne.vec3.scale(G,G,M);const Q=Ne.vec3.scaleAndAdd([],x.normal,z,-V);Ne.vec3.scale(Q,Q,M),Ne.vec3.add(G,L,G),Ne.vec3.add(Q,B,Q),L[2]+=.1,B[2]+=.1,l.vertexArray.emplaceBack(G[0],G[1],G[2]),l.vertexArray.emplaceBack(Q[0],Q[1],Q[2]),l.vertexArray.emplaceBack(L[0],L[1],L[2]),l.vertexArray.emplaceBack(B[0],B[1],B[2]),l.vertexArray.emplaceBack(O[0],O[1],O[2]),l.vertexArray.emplaceBack(F[0],F[1],F[2]),l.vertexArray.emplaceBack(L[0],L[1],L[2]),l.vertexArray.emplaceBack(B[0],B[1],B[2]),l.vertexArray.emplaceBack(G[0],G[1],G[2]),l.vertexArray.emplaceBack(Q[0],Q[1],Q[2]);const ie=E/M/2;l.colorArray.emplaceBack(-ie-V,-1,ie,.8),l.colorArray.emplaceBack(ie+V,-1,ie,.8),l.colorArray.emplaceBack(-ie,0,ie,1.3),l.colorArray.emplaceBack(ie,0,ie,1.3),l.colorArray.emplaceBack(ie+V,-.8,ie,.7),l.colorArray.emplaceBack(ie+V,-.8,ie,.7),l.colorArray.emplaceBack(0,0,ie,1.3),l.colorArray.emplaceBack(0,0,ie,1.3),l.colorArray.emplaceBack(ie+V,-1.2,ie,.8),l.colorArray.emplaceBack(ie+V,-1.2,ie,.8),l.indexArray.emplaceBack(6+h,4+h,8+h),l.indexArray.emplaceBack(7+h,9+h,5+h),l.indexArray.emplaceBack(0+h,1+h,2+h),l.indexArray.emplaceBack(1+h,3+h,2+h),h+=10}const v={defined:!0,emissiveFactor:[0,0,0]},p={};return p.baseColorFactor=Tr.white,v.pbrMetallicRoughness=p,l.material=v,l.aabb=new ro([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),l}class oD{constructor(i){this._stringToNumber={},this._numberToString=[];for(let l=0;l<i.length;l++){const h=i[l];this._stringToNumber[h]=l,this._numberToString[l]=h}}encode(i){return this._stringToNumber[i]}decode(i){return this._numberToString[i]}}const a9=["id","tile","layer","source","sourceLayer","state"];class sD{constructor(i,l,h,v,p){this.type="Feature",this._vectorTileFeature=i,this._z=l,this._x=h,this._y=v,this.properties=i.properties,this.id=p}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(i){this._geometry=i}toJSON(){const i={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(const l of a9)this[l]!==void 0&&(i[l]=this[l]);return i}}class aD{constructor(i,l){this.tileID=i,this.x=i.canonical.x,this.y=i.canonical.y,this.z=i.canonical.z,this.grid=new oh(Nn,16,0),this.featureIndexArray=new rb,this.promoteId=l,this.is3DTile=!1}insert(i,l,h,v,p,x=0,M=0){const z=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(h,v,p,x);const V=this.grid;for(let E=0;E<l.length;E++){const L=l[E],B=[1/0,1/0,-1/0,-1/0];for(let O=0;O<L.length;O++){const F=L[O];B[0]=Math.min(B[0],F.x),B[1]=Math.min(B[1],F.y),B[2]=Math.max(B[2],F.x),B[3]=Math.max(B[3],F.y)}M!==0&&(B[0]-=M,B[1]-=M,B[2]+=M,B[3]+=M),B[0]<Nn&&B[1]<Nn&&B[2]>=0&&B[3]>=0&&V.insert(z,B[0],B[1],B[2],B[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Sg.VectorTile(new Eb(this.rawTileData)).layers,this.sourceLayerCoder=new oD(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const i in this.vtLayers)this.vtFeatures[i]=[]}return this.vtLayers}query(i,l,h,v){this.loadVTLayers();const p=i.params||{},x=pu(p.filter),M=i.tileResult,z=i.transform,V=M.bufferedTilespaceBounds,E=this.grid.query(V.min.x,V.min.y,V.max.x,V.max.y,(F,G,Q,ie)=>Gl(M.bufferedTilespaceGeometry,F,G,Q,ie));E.sort(l9);let L=null;z.elevation&&E.length>0&&(L=Pg.create(z.elevation,this.tileID));const B={};let O;for(let F=0;F<E.length;F++){const G=E[F];if(G===O)continue;O=G;const Q=this.featureIndexArray.get(G);let ie=null;if(this.is3DTile){const pe=this.bucketLayerIDs[0][0],ge=l[pe];if(ge.type!=="model")continue;const{queryFeature:ae,intersectionZ:be}=ge.queryIntersectsMatchingFeature(M,Q.featureIndex,x,z);ae&&this.appendToResult(B,pe,Q.featureIndex,ae,be)}else this.loadMatchingFeature(B,Q,x,p.layers,p.availableImages,l,h,v,(pe,ge,ae,be=0)=>(ie||(ie=In(pe,this.tileID.canonical,i.tileTransform)),ge.queryIntersectsFeature(M,pe,ae,ie,this.z,i.transform,i.pixelPosMatrix,L,be)))}return B}loadMatchingFeature(i,l,h,v,p,x,M,z,V){const{featureIndex:E,bucketIndex:L,sourceLayerIndex:B,layoutVertexArrayOffset:O}=l,F=this.bucketLayerIDs[L];if(v&&!function(pe,ge){for(let ae=0;ae<pe.length;ae++)if(ge.indexOf(pe[ae])>=0)return!0;return!1}(v,F))return;const G=this.sourceLayerCoder.decode(B),Q=this.vtLayers[G].feature(E);if(h.needGeometry){const pe=An(Q,!0);if(!h.filter(new Fo(this.tileID.overscaledZ),pe,this.tileID.canonical))return}else if(!h.filter(new Fo(this.tileID.overscaledZ),Q))return;const ie=this.getId(Q,G);for(let pe=0;pe<F.length;pe++){const ge=F[pe];if(v&&v.indexOf(ge)<0)continue;const ae=x[ge];if(!ae)continue;let be={};ie!==void 0&&z&&(be=z.getState(ae.sourceLayer||"_geojsonTileLayer",ie));const Te=!V||V(Q,ae,be,O);if(!Te)continue;const Be=new sD(Q,this.z,this.x,this.y,ie),Xe=lr({},M[ge]);Xe.paint=lD(Xe.paint,ae.paint,Q,be,p),Xe.layout=lD(Xe.layout,ae.layout,Q,be,p),Be.layer=Xe,this.appendToResult(i,ge,E,Be,Te)}}appendToResult(i,l,h,v,p){let x=i[l];x===void 0&&(x=i[l]=[]),x.push({featureIndex:h,feature:v,intersectionZ:p})}lookupSymbolFeatures(i,l,h,v,p,x,M,z){const V={};this.loadVTLayers();const E=pu(p);for(const L of i)this.loadMatchingFeature(V,{bucketIndex:h,sourceLayerIndex:v,featureIndex:L,layoutVertexArrayOffset:0},E,x,M,z,l);return V}loadFeature(i){const{featureIndex:l,sourceLayerIndex:h}=i;this.loadVTLayers();const v=this.sourceLayerCoder.decode(h),p=this.vtFeatures[v];if(p[l])return p[l];const x=this.vtLayers[v].feature(l);return p[l]=x,x}hasLayer(i){for(const l of this.bucketLayerIDs)for(const h of l)if(i===h)return!0;return!1}getId(i,l){let h=i.id;if(this.promoteId){const v=typeof this.promoteId=="string"?this.promoteId:this.promoteId[l];v!=null&&(h=i.properties[v]),typeof h=="boolean"&&(h=Number(h))}return h}}function lD(d,i,l,h,v){return Mn(d,(p,x)=>{const M=i instanceof rf?i.get(x):null;return M&&M.evaluate?M.evaluate(l,h,v):M})}function l9(d,i){return i-d}ir(aD,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const uD=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class EI{static from(i){if(!(i instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[l,h]=new Uint8Array(i,0,2);if(l!==219)throw new Error("Data does not appear to be in a KDBush format.");const v=h>>4;if(v!==1)throw new Error(`Got v${v} data when expected v1.`);const p=uD[15&h];if(!p)throw new Error("Unrecognized array type.");const[x]=new Uint16Array(i,2,1),[M]=new Uint32Array(i,4,1);return new EI(M,x,p,i)}constructor(i,l=64,h=Float64Array,v){if(isNaN(i)||i<0)throw new Error(`Unpexpected numItems value: ${i}.`);this.numItems=+i,this.nodeSize=Math.min(Math.max(+l,2),65535),this.ArrayType=h,this.IndexArrayType=i<65536?Uint16Array:Uint32Array;const p=uD.indexOf(this.ArrayType),x=2*i*this.ArrayType.BYTES_PER_ELEMENT,M=i*this.IndexArrayType.BYTES_PER_ELEMENT,z=(8-M%8)%8;if(p<0)throw new Error(`Unexpected typed array class: ${h}.`);v&&v instanceof ArrayBuffer?(this.data=v,this.ids=new this.IndexArrayType(this.data,8,i),this.coords=new this.ArrayType(this.data,8+M+z,2*i),this._pos=2*i,this._finished=!0):(this.data=new ArrayBuffer(8+x+M+z),this.ids=new this.IndexArrayType(this.data,8,i),this.coords=new this.ArrayType(this.data,8+M+z,2*i),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+p]),new Uint16Array(this.data,2,1)[0]=l,new Uint32Array(this.data,4,1)[0]=i)}add(i,l){const h=this._pos>>1;return this.ids[h]=h,this.coords[this._pos++]=i,this.coords[this._pos++]=l,h}finish(){const i=this._pos>>1;if(i!==this.numItems)throw new Error(`Added ${i} items when expected ${this.numItems}.`);return TI(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(i,l,h,v){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:p,coords:x,nodeSize:M}=this,z=[0,p.length-1,0],V=[];for(;z.length;){const E=z.pop()||0,L=z.pop()||0,B=z.pop()||0;if(L-B<=M){for(let Q=B;Q<=L;Q++){const ie=x[2*Q],pe=x[2*Q+1];ie>=i&&ie<=h&&pe>=l&&pe<=v&&V.push(p[Q])}continue}const O=B+L>>1,F=x[2*O],G=x[2*O+1];F>=i&&F<=h&&G>=l&&G<=v&&V.push(p[O]),(E===0?i<=F:l<=G)&&(z.push(B),z.push(O-1),z.push(1-E)),(E===0?h>=F:v>=G)&&(z.push(O+1),z.push(L),z.push(1-E))}return V}within(i,l,h){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:v,coords:p,nodeSize:x}=this,M=[0,v.length-1,0],z=[],V=h*h;for(;M.length;){const E=M.pop()||0,L=M.pop()||0,B=M.pop()||0;if(L-B<=x){for(let Q=B;Q<=L;Q++)dD(p[2*Q],p[2*Q+1],i,l)<=V&&z.push(v[Q]);continue}const O=B+L>>1,F=p[2*O],G=p[2*O+1];dD(F,G,i,l)<=V&&z.push(v[O]),(E===0?i-h<=F:l-h<=G)&&(M.push(B),M.push(O-1),M.push(1-E)),(E===0?i+h>=F:l+h>=G)&&(M.push(O+1),M.push(L),M.push(1-E))}return z}}function TI(d,i,l,h,v,p){if(v-h<=l)return;const x=h+v>>1;cD(d,i,x,h,v,p),TI(d,i,l,h,x-1,1-p),TI(d,i,l,x+1,v,1-p)}function cD(d,i,l,h,v,p){for(;v>h;){if(v-h>600){const V=v-h+1,E=l-h+1,L=Math.log(V),B=.5*Math.exp(2*L/3),O=.5*Math.sqrt(L*B*(V-B)/V)*(E-V/2<0?-1:1);cD(d,i,l,Math.max(h,Math.floor(l-E*B/V+O)),Math.min(v,Math.floor(l+(V-E)*B/V+O)),p)}const x=i[2*l+p];let M=h,z=v;for(K_(d,i,h,l),i[2*v+p]>x&&K_(d,i,h,v);M<z;){for(K_(d,i,M,z),M++,z--;i[2*M+p]<x;)M++;for(;i[2*z+p]>x;)z--}i[2*h+p]===x?K_(d,i,h,z):(z++,K_(d,i,z,v)),z<=l&&(h=z+1),l<=z&&(v=z-1)}}function K_(d,i,l,h){II(d,l,h),II(i,2*l,2*h),II(i,2*l+1,2*h+1)}function II(d,i,l){const h=d[i];d[i]=d[l],d[l]=h}function dD(d,i,l,h){const v=d-l,p=i-h;return v*v+p*p}r.$=q1,r.A=class extends Gb{},r.B=Bl,r.C=Ri,r.D=Rp,r.E=Yn,r.F=q0,r.G=Ym,r.H=N1,r.I=ZT,r.J=Jm,r.K=ag,r.L=U1,r.M=Mp,r.N=Vi,r.O=so,r.P=st,r.Q=Pi,r.R=Rs,r.S=oa,r.T=lI,r.U=ii,r.V=Gb,r.W=r_,r.X=Zm,r.Y=W0,r.Z=function(d){const i=d.value;let l=[];if(!i)return l;const h=Bl(i);return h!=="string"?(l=l.concat([new Gb(d.key,i,`string expected, "${h}" found`)]),l):(bO(i,!0)||(l=l.concat([new Gb(d.key,i,`invalid url "${i}"`)])),l)},r._=$t,r.a=function(d){return _t.API_CDN_URL_REGEX.test(d)},r.a$=h_,r.a0=vo,r.a1=zn,r.a2=class{constructor(d){this.specification=d}possiblyEvaluate(d,i){return mi(d.expression.evaluate(i))}interpolate(d,i,l){return{x:sr(d.x,i.x,l),y:sr(d.y,i.y,l),z:sr(d.z,i.z,l),azimuthal:sr(d.azimuthal,i.azimuthal,l),polar:sr(d.polar,i.polar,l)}}},r.a3=Fo,r.a4=$u,r.a5=Ot,r.a6=Ne,r.a7=Fn,r.a8=rf,r.a9=mf,r.aA=no,r.aB=lO,r.aC=pO,r.aD=aO,r.aE=function(d,i){const l=document.createElement("video");l.muted=!0,l.onloadstart=function(){i(null,l)};for(let h=0;h<d.length;h++){const v=document.createElement("source");ea(d[h])||(l.crossOrigin="Anonymous"),v.src=d[h],l.appendChild(v)}return{cancel:()=>{}}},r.aF=Bb,r.aG=function(d){return fetch(d).then(i=>i.arrayBuffer()).then(i=>nD(i,0,d))},r.aH=iD,r.aI=class{constructor(d,i,l,h){this.id=d,this.position=i!=null?new me(i[0],i[1]):new me(0,0),this.orientation=l??[0,0,0],this.nodes=h,this.uploaded=!1,this.aabb=new ro([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(d,i){if(Ne.mat4.multiply(d.matrix,i,d.matrix),d.meshes)for(const l of d.meshes){const h=ro.applyTransformFast(l.aabb,d.matrix);this.aabb.encapsulate(h)}if(d.children)for(const l of d.children)this._applyTransformations(l,d.matrix)}computeBoundsAndApplyParent(){const d=Ne.mat4.identity([]);for(const i of this.nodes)this._applyTransformations(i,d)}computeModelMatrix(d,i,l,h,v,p,x=!1){TO(this.matrix,this,d.transform,this.position,i,l,h,v,p,x)}upload(d){if(!this.uploaded){for(const i of this.nodes)fI(i,d);for(const i of this.nodes)Hb(i);this.uploaded=!0}}destroy(){for(const d of this.nodes)pI(d)}},r.aJ=Rr,r.aK=z_,r.aL=it,r.aM=rt,r.aN=_d,r.aO=sa,r.aP=xn,r.aQ=yg,r.aR=Fb,r.aS=function(){nl.isLoading()||nl.isLoaded()||e_()!=="deferred"||t_()},r.aT=pu,r.aU=An,r.aV=sD,r.aW=ko,r.aX=$T,r.aY=LT,r.aZ=In,r.a_=yd,r.aa=sr,r.ab=Nn,r.ac=jn,r.ad=class{constructor(d){this.specification=d}possiblyEvaluate(d,i){return function([l,h]){const v=mi([1,l,h]);return{x:v.x,y:v.y,z:v.z}}(d.expression.evaluate(i))}interpolate(d,i,l){return{x:sr(d.x,i.x,l),y:sr(d.y,i.y,l),z:sr(d.z,i.z,l)}}},r.ae=function(d,i,l=0,h=!0){const v=new st(l,l),p=d.sub(v),x=i.add(v),M=[p,new st(x.x,p.y),x,new st(p.x,x.y)];return h&&M.push(p.clone()),M},r.af=function(d,i){const l=[];for(let h=0;h<d.length;h++){const v=ar(h-1,-1,d.length-1),p=ar(h+1,-1,d.length-1),x=d[h],M=d[p],z=d[v].sub(x).unit(),V=M.sub(x).unit(),E=V.angleWithSep(z.x,z.y),L=z.add(V).unit().mult(-1*i/Math.sin(E/2));l.push(x.add(L))}return l},r.ag=qR,r.ah=Gl,r.ai=function(d,i,l=0){return Ne.vec3.fromValues(((i.x-l)*d.scale-d.x)*Nn,(i.y*d.scale-d.y)*Nn,mt(i.z,i.y))},r.aj=Rc,r.ak=fR,r.al=function(d){let i=1/0,l=1/0,h=-1/0,v=-1/0;for(const p of d)i=Math.min(i,p.x),l=Math.min(l,p.y),h=Math.max(h,p.x),v=Math.max(v,p.y);return{min:new st(i,l),max:new st(h,v)}},r.am=Ye,r.an=ao,r.ao=mn,r.ap=Wt,r.aq=o,r.ar=function(d,i){const l={};for(let h=0;h<i.length;h++){const v=i[h];v in d&&(l[v]=d[v])}return l},r.as=ke,r.at=Je,r.au=class{constructor(d){this.entries={},this.scheduler=d}request(d,i,l,h){const v=this.entries[d]=this.entries[d]||{callbacks:[]};if(v.result){const[p,x]=v.result;return this.scheduler?this.scheduler.add(()=>{h(p,x)},i):h(p,x),()=>{}}return v.callbacks.push(h),v.cancel||(v.cancel=l((p,x)=>{v.result=[p,x];for(const M of v.callbacks)this.scheduler?this.scheduler.add(()=>{M(p,x)},i):M(p,x);setTimeout(()=>delete this.entries[d],3e3)})),()=>{v.result||(v.callbacks=v.callbacks.filter(p=>p!==h),v.callbacks.length||(v.cancel(),delete this.entries[d]))}}},r.av=K1,r.aw=function(d,i,l){const h=JSON.stringify(d.request);return d.data&&(this.deduped.entries[h]={result:[null,d.data]}),this.deduped.request(h,{type:"parseTile",isSymbolTile:d.isSymbolTile,zoom:d.tileZoom},v=>{const p=lu(d.request,(x,M,z,V)=>{x?v(x):M&&v(null,{vectorTile:l?void 0:new Sg.VectorTile(new Eb(M)),rawData:M,cacheControl:z,expires:V})});return()=>{p.cancel(),v()}},i)},r.ax=function(d){Ki++,Ki>Cr&&(d.getActor().send("enforceCacheSizeLimit",ur),Ki=0)},r.ay=Nt,r.az=function(d){return d<=1?1:Math.pow(2,Math.floor(Math.log(d)/Math.LN2))},r.b=function(d){return _t.API_FONTS_REGEX.test(d)},r.b$=function(d){const{x:i,y:l}=d.point,{lng:h,lat:v}=d._center;return oL(i,l,d.worldSize,h,v)},r.b0=Wl,r.b1=No,r.b2=w_,r.b3=oI,r.b4=function(d,i){const l=mf(i.zoom);if(l===0)return Sd(d);const h=db(d),v=ST(h),p=Ye(h.getWest())*i.worldSize,x=Ye(h.getEast())*i.worldSize,M=Je(h.getNorth())*i.worldSize,z=Je(h.getSouth())*i.worldSize,V=[p,M,0],E=[x,M,0],L=[p,z,0],B=[x,z,0],O=Ne.mat4.invert([],i.globeMatrix);return Ne.vec3.transformMat4(V,V,O),Ne.vec3.transformMat4(E,E,O),Ne.vec3.transformMat4(L,L,O),Ne.vec3.transformMat4(B,B,O),v[0]=fh(v[0],L,l),v[1]=fh(v[1],B,l),v[2]=fh(v[2],E,l),v[3]=fh(v[3],V,l),ro.fromPoints(v)},r.b5=fb,r.b6=x_,r.b7=fh,r.b8=dg,r.b9=rl,r.bA=ar,r.bB=nt,r.bC=Pn,r.bD=qe,r.bE=function(d,i,l){d[4*i+0]=l[0],d[4*i+1]=l[1],d[4*i+2]=l[2],d[4*i+3]=l[3]},r.bF=$p,r.bG=Uu,r.bH=g_,r.bI=wa,r.bJ=ch,r.bK=me,r.bL=JR,r.bM=Cs,r.bN=pf,r.bO=gO,r.bP=Ns,r.bQ=nL,r.bR=function(d,i,l,h,v,p,x,M,z){if(z.name==="globe")return nL(d,i,new Ns(l,h,v),!1);const V=z_({z:l,x:h,y:v},z);return new ro([(p+V.x/V.scale)*i,i*(V.y/V.scale),x],[(p+V.x2/V.scale)*i,i*(V.y2/V.scale),M])},r.bS=function(d,i,l){let h=0;for(let v=0;v<2;++v)d[v]>0&&(h+=(d[v]-0)*(d[v]-0)),i[v]<0&&(h+=(0-i[v])*(0-i[v]));return h},r.bT=dt,r.bU=y,r.bV=function(d){const i=Ne.mat4.identity(new Float64Array(16));Ne.mat4.multiply(i,d.pixelMatrix,d.globeMatrix);const l=[0,$,0],h=[0,Y,0];return Ne.vec3.transformMat4(l,l,i),Ne.vec3.transformMat4(h,h,i),[l[0]>0&&l[0]<=d.width&&l[1]>0&&l[1]<=d.height&&!TT(d,new me(d.center.lat,90)),h[0]>0&&h[0]<=d.width&&h[1]>0&&h[1]<=d.height&&!TT(d,new me(d.center.lat,-90))]},r.bW=function(d,i){const{scale:l}=d.tileTransform,h=l*Nn/(d.tileSize*Math.pow(2,i.zoom-d.tileID.overscaledZ+d.tileID.canonical.z));return Ne.mat2.scale(new Float32Array(4),i.inverseAdjustmentMatrix,[h,h])},r.bX=$b,r.bY=mO,r.bZ=function(d){const i=mO(d,!0);return Ne.mat2.invert([],[i[0],i[1],i[4],i[5]])},r.b_=wd,r.ba=vI,r.bb=Eb,r.bc=lu,r.bd=function(d){const i=[];for(const l in d)i.push(d[l]);return i},r.be=function(d,i){const l=[];for(const h in d)h in i||l.push(h);return l},r.bf=bn,r.bg=["type","source","source-layer","minzoom","maxzoom","filter","layout"],r.bh=gt,r.bi=function(d,i){const{x:l,y:h}=d.point,v=oL(l,h,d.worldSize/d._pixelsPerMercatorPixel,0,0);return Ne.mat4.multiply(v,v,CT(Sd(i)))},r.bj=Cg,r.bk=gu,r.bl=Cb,r.bm=function(d,i,l,h,v){const p=5*i+2;d.float32[p+0]=l,d.float32[p+1]=h,d.float32[p+2]=v},r.bn=zb,r.bo=zR,r.bp=Vn,r.bq=ha,r.br=NL,r.bs=xO,r.bt=UL,r.bu=GL,r.bv=QT,r.bw=UR,r.bx=YT,r.by=EI,r.bz=Tr,r.c=Mt,r.c$=Da,r.c0=tn,r.c1=Oa,r.c2=c,r.c3=function(d){const i=Math.round((d+45+360)%360/90)%4;return un[i]},r.c4=45,r.c5=Fe,r.c6=xg,r.c7=function(d,i,l){const h=Math.sqrt(d*d+i*i+l*l),v=h>0?Math.acos(l/h)*tt:0;let p=d!==0||i!==0?Math.atan2(-i,-d)*tt+90:0;return p<0&&(p+=360),[h,p,v]},r.c8=vt,r.c9=ro,r.cA=function(d){const i=dt-5;d=Wt(d,-i,i)/i*90;const l=Math.pow(Math.abs(Math.sin(nt(d))),3);return Math.round(l*(A.length-1))},r.cB=function(d,i,l,h){const v=i.getNorth(),p=i.getSouth(),x=i.getWest(),M=i.getEast(),z=1<<d.z,V=M-x,E=v-p,L=V/T,B=-E/A[l],O=[0,L,0,B,0,0,v,x,0];if(d.z>0){const F=180/h;Ne.mat3.multiply(O,O,[F/V+1,0,0,0,F/E+1,0,-.5*F/L,.5*F/B,1])}return O[2]=z,O[5]=d.x,O[8]=d.y,O},r.cC=Sd,r.cD=function(d,i,l){const h=Ne.mat4.identity(new Float64Array(16)),v=(i/(1<<d)-.5)*Math.PI*2;return Ne.mat4.rotateY(h,l.globeMatrix,v),Float32Array.from(h)},r.cE=class{isDataAvailableAtPoint(d){const i=this._source();if(this.isUsingMockSource()||!i||d.y<0||d.y>1)return!1;const l=i.getSource().maxzoom,h=1<<l,v=Math.floor(d.x),p=Math.floor((d.x-v)*h),x=Math.floor(d.y*h),M=this.findDEMTileFor(new no(l,v,l,p,x));return!(!M||!M.dem)}getAtPointOrZero(d,i=0){return this.getAtPoint(d,i)||0}getAtPoint(d,i,l=!0){if(this.isUsingMockSource())return null;i==null&&(i=null);const h=this._source();if(!h||d.y<0||d.y>1)return i;const v=h.getSource().maxzoom,p=1<<v,x=Math.floor(d.x),M=d.x-x,z=new no(v,x,v,Math.floor(M*p),Math.floor(d.y*p)),V=this.findDEMTileFor(z);if(!V||!V.dem)return i;const E=V.dem,L=1<<V.tileID.canonical.z,B=(M*L-V.tileID.canonical.x)*E.dim,O=(d.y*L-V.tileID.canonical.y)*E.dim,F=Math.floor(B),G=Math.floor(O);return(l?this.exaggeration():1)*sr(sr(E.get(F,G),E.get(F,G+1),O-G),sr(E.get(F+1,G),E.get(F+1,G+1),O-G),B-F)}getAtTileOffset(d,i,l){const h=1<<d.canonical.z;return this.getAtPointOrZero(new Ot(d.wrap+(d.canonical.x+i/Nn)/h,(d.canonical.y+l/Nn)/h))}getAtTileOffsetFunc(d,i,l,h){return v=>{const p=this.getAtTileOffset(d,v.x,v.y),x=h.upVector(d.canonical,v.x,v.y),M=h.upVectorScale(d.canonical,i,l).metersToTile;return Ne.vec3.scale(x,x,p*M),x}}getForTilePoints(d,i,l,h){if(this.isUsingMockSource())return!1;const v=Pg.create(this,d,h);return!!v&&(i.forEach(p=>{p[2]=this.exaggeration()*v.getElevationAt(p[0],p[1],l)}),!0)}getMinMaxForTile(d){if(this.isUsingMockSource())return null;const i=this.findDEMTileFor(d);if(!i||!i.dem)return null;const l=i.dem.tree,h=i.tileID,v=1<<d.canonical.z-h.canonical.z;let p=d.canonical.x/v-h.canonical.x,x=d.canonical.y/v-h.canonical.y,M=0;for(let z=0;z<d.canonical.z-h.canonical.z&&!l.leaves[M];z++){p*=2,x*=2;const V=2*Math.floor(x)+Math.floor(p);M=l.childOffsets[M]+V,p%=1,x%=1}return{min:this.exaggeration()*l.minimums[M],max:this.exaggeration()*l.maximums[M]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(d,i,l){throw new Error("Pure virtual method called.")}pointCoordinate(d){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(d){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const d=this.visibleDemTiles;if(d.length===0)return null;let i=!1,l=Number.MAX_VALUE,h=Number.MIN_VALUE;for(const v of d){const p=this.getMinMaxForTile(v.tileID);p&&(l=Math.min(l,p.min),h=Math.max(h,p.max),i=!0)}return i?{min:l,max:h}:null}},r.cF=_L,r.cG=hh,r.cH=function(d,i){return[Math.pow(d[0],2.2)*i,Math.pow(d[1],2.2)*i,Math.pow(d[2],2.2)*i]},r.cI=iL,r.cJ=at,r.cK=Ve,r.cL=256,r.cM=function(d,i){const l=[0,0,0],h=fb(Sd(i.canonical));return Ne.vec3.transformMat4(l,l,h),Ne.vec3.transformMat4(l,l,d),l},r.cN=d=>({u_camera_to_center_distance:new wa(d),u_extrude_scale:new __(d),u_device_pixel_ratio:new wa(d),u_matrix:new $p(d),u_inv_rot_matrix:new $p(d),u_merc_center:new Uu(d),u_tile_id:new g_(d),u_zoom_transition:new wa(d),u_up_dir:new g_(d),u_emissive_strength:new wa(d)}),r.cO=d=>({u_matrix:new $p(d),u_pixels_to_tile_units:new __(d),u_device_pixel_ratio:new wa(d),u_units_to_pixels:new Uu(d),u_dash_image:new ch(d),u_gradient_image:new ch(d),u_image_height:new wa(d),u_texsize:new Uu(d),u_tile_units_to_pixels:new wa(d),u_alpha_discard_threshold:new wa(d),u_trim_offset:new Uu(d),u_trim_fade_range:new Uu(d),u_trim_color:new xg(d),u_emissive_strength:new wa(d)}),r.cP=d=>({u_matrix:new $p(d),u_texsize:new Uu(d),u_pixels_to_tile_units:new __(d),u_device_pixel_ratio:new wa(d),u_image:new ch(d),u_units_to_pixels:new Uu(d),u_tile_units_to_pixels:new wa(d),u_alpha_discard_threshold:new wa(d),u_trim_offset:new Uu(d)}),r.cQ=Ra,r.cR=PU,r.cS=AU,r.cT=lL,r.cU=(d,i,l,h,v,p)=>{const x=d.transform,M=x.projection.name==="globe";let z;if(p.paint.get("circle-pitch-alignment")==="map")if(M){const E=iL(x.zoom,i.canonical)*x._pixelsPerMercatorPixel;z=Float32Array.from([E,0,0,E])}else z=x.calculatePixelsToTileUnitsMatrix(l);else z=new Float32Array([x.pixelsToGLUnits[0],0,0,x.pixelsToGLUnits[1]]);const V={u_camera_to_center_distance:d.transform.getCameraToCenterDistance(x.projection),u_matrix:d.translatePosMatrix(i.projMatrix,l,p.paint.get("circle-translate"),p.paint.get("circle-translate-anchor")),u_device_pixel_ratio:zt.devicePixelRatio,u_extrude_scale:z,u_inv_rot_matrix:O$,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:p.paint.get("circle-emissive-strength")};if(M){V.u_inv_rot_matrix=h,V.u_merc_center=v,V.u_tile_id=[i.canonical.x,i.canonical.y,1<<i.canonical.z],V.u_zoom_transition=mf(x.zoom);const E=v[0]*Nn,L=v[1]*Nn;V.u_up_dir=x.projection.upVector(new Ns(0,0,0),E,L)}return V},r.cV=gR,r.cW=(d,i,l,h,v,p)=>{const x=d.transform;return{u_matrix:mR(d,i,l,h),u_texsize:i.imageAtlasTexture?i.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:x.calculatePixelsToTileUnitsMatrix(i),u_device_pixel_ratio:v,u_image:0,u_tile_units_to_pixels:pR(i,x),u_units_to_pixels:[1/x.pixelsToGLUnits[0],1/x.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:p}},r.cX=(d,i,l,h,v,p,x)=>{const M=d.transform,z=M.calculatePixelsToTileUnitsMatrix(i);return{u_matrix:mR(d,i,l,h),u_pixels_to_tile_units:z,u_device_pixel_ratio:p,u_units_to_pixels:[1/M.pixelsToGLUnits[0],1/M.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:v,u_texsize:yR(l)&&i.lineAtlasTexture?i.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:pR(i,d.transform),u_alpha_discard_threshold:0,u_trim_offset:x,u_trim_fade_range:l.paint.get("line-trim-fade-range"),u_trim_color:l.paint.get("line-trim-color").toRenderColor(l.lut).toArray01(),u_emissive_strength:l.paint.get("line-emissive-strength")}},r.cY=Er,r.cZ=b_,r.c_=rR,r.ca=mi,r.cb=function(d){return[Math.pow(d[0],1/2.2),Math.pow(d[1],1/2.2),Math.pow(d[2],1/2.2)]},r.cc=function(d){return d({pluginStatus:Ys,pluginURL:gd}),Q0.on("pluginStateChange",d),d},r.cd=Ag,r.ce=Xb,r.cf=Tg,r.cg=KT,r.ch=Qd,r.ci=W1,r.cj=qn,r.ck=jt,r.cl=fi,r.cm=function(d){const i=d.indexOf(sf);return i>=0?d.slice(0,i):d},r.cn=function(d){return d.indexOf(sf)>=0},r.co=function(d){const i=d.indexOf(sf);return i>=0?d.slice(i+1):""},r.cp=function(d){const i=[],l=d.id;return l===void 0&&i.push({message:`layers.${l}: missing required property "id"`}),d.render===void 0&&i.push({message:`layers.${l}: missing required method "render"`}),d.renderingMode&&d.renderingMode!=="2d"&&d.renderingMode!=="3d"&&i.push({message:`layers.${l}: property "renderingMode" must be either "2d" or "3d"`}),i},r.cq=function(d,i,l,h){return d.type==="custom"?new lG(d,i):new vG[d.type](d,i,l,h)},r.cr=Ar,r.cs=Q0,r.ct=Cc,r.cu=y_,r.cv=class extends Lc{constructor(d){super(d),this.current=gT}set(d,i,l){if(this.fetchUniformLocation(d,i)){for(let h=0;h<9;h++)if(l[h]!==this.current[h]){this.current=l,this.gl.uniformMatrix3fv(this.location,!1,l);break}}}},r.cw=qt,r.cx=function(d,i,l){const h=mf(l.zoom),v=d.style.map._antialias,p=i.options.extStandardDerivativesForceOff||d.terrain&&d.terrain.exaggeration()>0;return h===0&&!v&&!p},r.cy=function(d){const i=d.pixelsPerMeter,l=i/qe(1,d.center.lat),h=Ne.mat4.identity(new Float64Array(16));return Ne.mat4.translate(h,h,[d.point.x,d.point.y,0]),Ne.mat4.scale(h,h,[l,l,i]),Float32Array.from(h)},r.cz=db,r.d=function(d){return _t.API_TILEJSON_REGEX.test(d)},r.d$=C,r.d0=Sb,r.d1=yf,r.d2=450,r.d3=7,r.d4=aG,r.d5=wi,r.d6=mg,r.d7=256,r.d8=CT,r.d9=vd,r.dA=sL,r.dB=function(d){const i=[0,0,0],l=Ne.mat4.identity(new Float64Array(16));return Ne.mat4.multiply(l,d.pixelMatrix,d.globeMatrix),Ne.vec3.transformMat4(i,i,l),new st(i[0],i[1])},r.dC=function(d,i,l=!1){if(Ys===Ap||Ys===Lp||Ys===og)throw new Error("setRTLTextPlugin cannot be called multiple times.");gd=zt.resolveURL(d),Ys=Ap,tf=i,J0(),l||t_()},r.dD=e_,r.dE=function(){Xb().acquire(xI)},r.dF=function(){const d=X_;d&&(d.isPreloaded()&&d.numActive()===1?(d.release(xI),X_=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},r.dG=q_,r.dH=function(d){const i=Mi();if(!i)return;const l=i.delete(Jn);d&&l.catch(d).then(()=>d())},r.dI=W_,r.dJ=YO,r.dK=function(d){bI=zt.resolveURL(d),Og||(Og=new Ag(Xb(),new Yn)),Og.broadcast("setDracoUrl",bI)},r.dL=ZO,r.dM=function(d){Rg=zt.resolveURL(d),Og||(Og=new Ag(Xb(),new Yn)),Og.broadcast("setMeshoptUrl",Rg)},r.dN=ir,r.dO=gf,r.dP=Dc,r.dQ=oD,r.dR=aD,r.dS=uR,r.dT=Mn,r.dU=NR,r.dV=function(d,i,l,h,v,p,x,M,z,V,E){d.createArrays(),d.tilePixelRatio=Nn/(512*d.overscaling),d.compareText={},d.iconsNeedLinear=!1;const L=d.layers[0].layout,B=d.layers[0]._unevaluatedLayout._values,O={};if(d.textSizeData.kind==="composite"){const{minZoom:ie,maxZoom:pe}=d.textSizeData;O.compositeTextSizes=[B["text-size"].possiblyEvaluate(new Fo(ie),M),B["text-size"].possiblyEvaluate(new Fo(pe),M)]}if(d.iconSizeData.kind==="composite"){const{minZoom:ie,maxZoom:pe}=d.iconSizeData;O.compositeIconSizes=[B["icon-size"].possiblyEvaluate(new Fo(ie),M),B["icon-size"].possiblyEvaluate(new Fo(pe),M)]}O.layoutTextSize=B["text-size"].possiblyEvaluate(new Fo(z+1),M),O.layoutIconSize=B["icon-size"].possiblyEvaluate(new Fo(z+1),M),O.textMaxSize=B["text-size"].possiblyEvaluate(new Fo(18),M);const F=L.get("text-rotation-alignment")==="map"&&L.get("symbol-placement")!=="point",G=L.get("text-size");let Q=!1;for(const ie of d.features)if(ie.icon&&ie.icon.nameSecondary){Q=!0;break}for(const ie of d.features){const pe=L.get("text-font").evaluate(ie,{},M).join(","),ge=G.evaluate(ie,{},M),ae=O.layoutTextSize.evaluate(ie,{},M),be=(O.layoutIconSize.evaluate(ie,{},M),{horizontal:{},vertical:void 0}),Te=ie.text;let Be,Xe=[0,0];if(Te){const ct=Te.toString(),Qe=L.get("text-letter-spacing").evaluate(ie,{},M)*ha,pt=L.get("text-line-height").evaluate(ie,{},M)*ha,St=iT(ct)?Qe:0,Tt=L.get("text-anchor").evaluate(ie,{},M),It=L.get("text-variable-anchor");if(!It){const gn=L.get("text-radial-offset").evaluate(ie,{},M);Xe=gn?UR(Tt,[gn*ha,JT]):L.get("text-offset").evaluate(ie,{},M).map(Qt=>Qt*ha)}let Lt=F?"center":L.get("text-justify").evaluate(ie,{},M);const Yt=L.get("symbol-placement")==="point",Rt=Yt?L.get("text-max-width").evaluate(ie,{},M)*ha:1/0,ln=gn=>{d.allowVerticalPlacement&&ng(ct)&&(be.vertical=XT(Te,i,l,v,pe,Rt,pt,Tt,gn,St,Xe,gu.vertical,!0,ae,ge))};if(!F&&It){const gn=Lt==="auto"?It.map(Qn=>QT(Qn)):[Lt];let Qt=!1;for(let Qn=0;Qn<gn.length;Qn++){const $n=gn[Qn];if(!be.horizontal[$n])if(Qt)be.horizontal[$n]=be.horizontal[0];else{const kn=XT(Te,i,l,v,pe,Rt,pt,"center",$n,St,Xe,gu.horizontal,!1,ae,ge);kn&&(be.horizontal[$n]=kn,Qt=kn.positionedLines.length===1)}}ln("left")}else{if(Lt==="auto"&&(Lt=QT(Tt)),Yt||L.get("text-writing-mode").indexOf("horizontal")>=0||!ng(ct)){const gn=XT(Te,i,l,v,pe,Rt,pt,Tt,Lt,St,Xe,gu.horizontal,!1,ae,ge);gn&&(be.horizontal[Lt]=gn)}ln(Yt?"left":Lt)}}let Ze=!1;if(ie.icon&&ie.icon.namePrimary){const ct=h[ie.icon.namePrimary];ct&&(Be=VU(v[ie.icon.namePrimary],ie.icon.nameSecondary?v[ie.icon.nameSecondary]:void 0,L.get("icon-offset").evaluate(ie,{},M),L.get("icon-anchor").evaluate(ie,{},M)),Ze=ct.sdf,d.sdfIcons===void 0?d.sdfIcons=ct.sdf:d.sdfIcons!==ct.sdf&&vr("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(ct.pixelRatio!==d.pixelRatio||L.get("icon-rotate").constantOr(1)!==0)&&(d.iconsNeedLinear=!0))}const He=HR(be.horizontal)||be.vertical;d.iconsInText||(d.iconsInText=!!He&&He.iconsInText),(He||Be)&&XU(d,ie,be,Be,h,O,ae,0,Xe,Ze,x,M,V,E,Q)}p&&d.generateCollisionDebugBuffers(z,d.collisionBoxArray)},r.dW=Sg,r.dX=qb,r.dY=Ae,r.dZ=OL,r.d_=SR,r.da=Ac,r.db=d_,r.dc=function(d,i,l,h,v){return Wt((d-i)/(l-i)*(v-h)+h,h,v)},r.dd=Xm,r.de=Et,r.df=class{constructor(d,i,l,h){this.context=d,this.format=h,this.size=l,this.texture=d.gl.createTexture();const[v,p,x]=this.size,{gl:M}=d;M.bindTexture(M.TEXTURE_3D,this.texture),d.pixelStoreUnpackFlipY.set(!1),d.pixelStoreUnpack.set(1),d.pixelStoreUnpackPremultiplyAlpha.set(!1),M.texImage3D(M.TEXTURE_3D,0,this.format,v,p,x,0,sI(this.format),aI(this.format),i.data)}bind(d,i){const{context:l}=this,{gl:h}=l;h.bindTexture(h.TEXTURE_3D,this.texture),d!==this.minFilter&&(h.texParameteri(h.TEXTURE_3D,h.TEXTURE_MAG_FILTER,d),h.texParameteri(h.TEXTURE_3D,h.TEXTURE_MIN_FILTER,d),this.minFilter=d),i!==this.wrapS&&(h.texParameteri(h.TEXTURE_3D,h.TEXTURE_WRAP_S,i),h.texParameteri(h.TEXTURE_3D,h.TEXTURE_WRAP_T,i),this.wrapS=i)}destroy(){const{gl:d}=this.context;d.deleteTexture(this.texture),this.texture=null}},r.dg=dI,r.dh=[1,1,1],r.di=Pg,r.dj=Mg,r.dk=xd,r.dl=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new st(1/0,1/0),max:new st(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(d,i=!1){const l=jL(new st(0,0),new st(Nn,Nn),d),h=[];if(i&&!FT(l,this._globalClipBounds))return h;for(const v of this._activeRegions){if(v.hiddenByOverlap||!FT(l,v))continue;const p=rU(v.min,v.max,d);h.push({min:p.min,max:p.max,sourceId:this._sourceIds[v.priority],footprint:v.footprint,footprintTileId:v.tileId,order:v.order,clipMask:v.clipMask,clipScope:v.clipScope})}return h}setSources(d){this._setSources(d.map(i=>({getSourceId:()=>i.cache.id,getFootprints:()=>{const l=[];for(const h of i.cache.getVisibleCoordinates()){const v=i.cache.getTile(h).buckets[i.layer];v&&v.updateFootprints(h.toUnwrapped(),l)}return l},getOrder:()=>i.order,getClipMask:()=>i.clipMask,getClipScope:()=>i.clipScope})))}_addSource(d){const i=d.getFootprints();if(i.length===0)return;const l=d.getOrder(),h=d.getClipMask(),v=d.getClipScope();for(const p of i){if(!p.footprint)continue;const x=jL(p.footprint.min,p.footprint.max,p.id);this._activeRegions.push({min:x.min,max:x.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:p.id,footprint:p.footprint,order:l,clipMask:h,clipScope:v})}this._sourceIds.push(d.getSourceId())}_computeReplacement(){this._activeRegions.sort((i,l)=>i.priority-l.priority||bb(i.min,l.min)||bb(i.max,l.max)||i.order-l.order||i.clipMask-l.clipMask||function(h,v){const p=(x,M)=>x+M;return h.length-v.length||h.reduce(p,"").localeCompare(v.reduce(p,""))}(i.clipScope,l.clipScope));let d=this._activeRegions.length!==this._prevRegions.length;if(!d){let i=0;for(;!d&&i!==this._activeRegions.length;){const l=this._activeRegions[i],h=this._prevRegions[i];d=l.priority!==h.priority||!BL(l,h)||l.order!==h.order||l.clipMask!==h.clipMask||!gt(l.clipScope,h.clipScope),++i}}if(d){++this._updateTime;for(const l of this._activeRegions)l.order!==xb&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,l.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,l.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,l.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,l.max.y));const i=l=>{const h=this._activeRegions;if(l>=h.length)return l;const v=h[l].priority;for(;l<h.length&&h[l].priority===v;)++l;return l};if(this._sourceIds.length>1){let l=0,h=i(l);for(;l!==h;){let v=l;const p=l;for(;v!==h;){const x=this._activeRegions[v];x.hiddenByOverlap=!1;for(let M=0;M<p;M++){const z=this._activeRegions[M];if(!z.hiddenByOverlap&&x.order===xb&&FT(x,z)&&(x.hiddenByOverlap=$L(x.footprint,x.tileId,z.footprint,z.tileId),x.hiddenByOverlap))break}++v}l=h,h=i(l)}}}}_setSources(d){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let i=d.length-1;i>=0;i--)this._addSource(d[i]);this._computeReplacement()}},r.dm=class{constructor(d){this._createGrid(d),this._createPoles(d)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const d of this._poleSegments)d.destroy();for(const d of this._gridSegments)d.withSkirts.destroy(),d.withoutSkirts.destroy()}_fillGridMeshWithLods(d,i){const l=new yd,h=new sa,v=[],p=d+1+2,x=i[0]+1,M=i[0]+1+(1+i.length),z=(V,E,L)=>{let B=V===p-1?V-2:V===0?V:V-1;return B+=L?24575:0,[B,E]};for(let V=0;V<p;++V)l.emplaceBack(...z(V,0,!0));for(let V=0;V<x;++V)for(let E=0;E<p;++E)l.emplaceBack(...z(E,V,(E===0||E===p-1)&&!0));for(let V=0;V<i.length;++V){const E=i[V];for(let L=0;L<p;++L)l.emplaceBack(...z(L,E,!0))}for(let V=0;V<i.length;++V){const E=h.length,L=i[V]+1+2,B=new sa;for(let G=0;G<L-1;G++){const Q=G===L-2,ie=Q?p*(M-i.length+V-G):p;for(let pe=0;pe<p-1;pe++){const ge=G*p+pe;G===0||Q||pe===0||pe===p-2?(B.emplaceBack(ge+1,ge,ge+ie),B.emplaceBack(ge+ie,ge+ie+1,ge+1)):(h.emplaceBack(ge+1,ge,ge+ie),h.emplaceBack(ge+ie,ge+ie+1,ge+1))}}const O=No.simpleSegment(0,E,l.length,h.length-E);for(let G=0;G<B.uint16.length;G+=3)h.emplaceBack(B.uint16[G],B.uint16[G+1],B.uint16[G+2]);const F=No.simpleSegment(0,E,l.length,h.length-E);v.push({withoutSkirts:O,withSkirts:F})}return{vertices:l,indices:h,segments:v}}_createGrid(d){const i=this._fillGridMeshWithLods(T,A);this._gridSegments=i.segments,this._gridBuffer=d.createVertexBuffer(i.vertices,Wl.members),this._gridIndexBuffer=d.createIndexBuffer(i.indices,!0)}_createPoles(d){const i=new sa;for(let x=0;x<=T;x++)i.emplaceBack(0,x+1,x+2);this._poleIndexBuffer=d.createIndexBuffer(i,!0);const l=new Ac,h=new Ac,v=new Ac,p=new Ac;this._poleSegments=[];for(let x=0,M=0;x<c;x++){const z=360/(1<<x);l.emplaceBack(0,-o,0,.5,0),h.emplaceBack(0,-o,0,.5,1),v.emplaceBack(0,-o,0,.5,.5),p.emplaceBack(0,-o,0,.5,.5);for(let V=0;V<=T;V++){let E=V/T,L=0;const B=sr(0,z,E),[O,F,G]=ee(L$,R$,B,o);l.emplaceBack(O,F,G,E,L),h.emplaceBack(O,F,G,E,1-L);const Q=nt(B);E=.5+.5*Math.sin(Q),L=.5+.5*Math.cos(Q),v.emplaceBack(O,F,G,E,L),p.emplaceBack(O,F,G,E,1-L)}this._poleSegments.push(No.simpleSegment(M,0,66,64)),M+=66}this._poleNorthVertexBuffer=d.createVertexBuffer(l,Tl,!1),this._poleSouthVertexBuffer=d.createVertexBuffer(h,Tl,!1),this._texturedPoleNorthVertexBuffer=d.createVertexBuffer(v,Tl,!1),this._texturedPoleSouthVertexBuffer=d.createVertexBuffer(p,Tl,!1)}getGridBuffers(d,i){return[this._gridBuffer,this._gridIndexBuffer,i?this._gridSegments[d].withSkirts:this._gridSegments[d].withoutSkirts]}getPoleBuffers(d,i){return[i?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,i?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[d]]}},r.dn=xb,r.dp=an,r.dq=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},r.dr=Jt,r.ds=bt,r.dt=te,r.du=function([d,i,l]){const h=Math.hypot(d,i,l),v=Math.atan2(d,l),p=.5*Math.PI-Math.acos(-i/h);return new me(tn(v),tn(p))},r.dv=cI,r.dw=ue,r.dx=function(d){const i=d.navigator?d.navigator.userAgent:null;return!!function(l){if(Oo==null){const h=l.navigator?l.navigator.userAgent:null;Oo=!!l.safari||!(!h||!(/\b(iPad|iPhone|iPod)\b/.test(h)||h.match("Safari")&&!h.match("Chrome")))}return Oo}(d)&&i&&(i.match("Version/15.4")||i.match("Version/15.5")||i.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},r.dy=function(d,i){ur=d,Cr=i},r.dz=TT,r.e=_t,r.e0=function(d){let i=0;if(new Uint32Array(d,0,1)[0]!==JO){const l=new Uint32Array(d,0,7),[,,h,v,p,x]=l;i=l.byteLength+v+p+x+p,(h!==d.byteLength||i>=d.byteLength)&&vr("Invalid b3dm header information.")}return nD(d,i)},r.e1=function(d,i){const l=iD(d);for(const h of l){for(const v of h.meshes)o9(v);h.lights&&(h.lightMeshIndex=h.meshes.length,h.meshes.push(s9(h.lights,i)))}return l},r.e2=Wb,r.e3=LO,r.e4=nl,r.e5=function(d){Wi(),Fr!=null&&Fr.then(i=>{i.keys().then(l=>{for(let h=0;h<l.length-d;h++)i.delete(l[h])})})},r.f=function(d){return d.indexOf("mapbox:")===0},r.g=function(d,i){return Cc(lr(d,{method:"GET"}),i)},r.h=ht,r.i=function(d){return _t.API_STYLE_REGEX.test(d)&&!Mt(d)},r.j=function(d){return decodeURIComponent(atob(d).split("").map(i=>"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)).join(""))},r.k=function(d){return btoa(encodeURIComponent(d).replace(/%([0-9A-F]{2})/g,(i,l)=>String.fromCharCode(+("0x"+l))))},r.l=lr,r.m=yi,r.n=function(d,i){return Cc(lr(d,{type:"json"}),i)},r.o=Ma,r.p=function(d,i){return Cc(lr(d,{method:"POST"}),i)},r.q=zt,r.r=za,r.s=function(d){try{const i=self[d];return i.setItem("_mapbox_test_",1),i.removeItem("_mapbox_test_"),!0}catch{return!1}},r.t=nn,r.u=function(){return function d(i){return i?(i^Math.random()*(16>>i/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,d)}()},r.v=function(d){return!!d&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(d)},r.w=vr,r.x=Ut,r.y=2,r.z=FR}),f(["./shared"],function(r){function C(Vt){const ze=Vt?Vt.url.toString():void 0;return ze?performance.getEntriesByName(ze):[]}function k(Vt){if(typeof Vt=="number"||typeof Vt=="boolean"||typeof Vt=="string"||Vt==null)return JSON.stringify(Vt);if(Array.isArray(Vt)){let Ve="[";for(const at of Vt)Ve+=`${k(at)},`;return`${Ve}]`}let ze="{";for(const Ve of Object.keys(Vt).sort())ze+=`${Ve}:${k(Vt[Ve])},`;return`${ze}}`}function I(Vt){let ze="";for(const Ve of r.bg)ze+=`/${k(Vt[Ve])}`;return ze}class P{constructor(ze){this.keyCache={},this._layers={},this._layerConfigs={},ze&&this.replace(ze)}replace(ze,Ve){this._layerConfigs={},this._layers={},this.update(ze,[],Ve)}update(ze,Ve,at){this._options=at;for(const ht of ze)this._layerConfigs[ht.id]=ht,(this._layers[ht.id]=r.cq(ht,this.scope,null,this._options)).compileFilter(at),this.keyCache[ht.id]&&delete this.keyCache[ht.id];for(const ht of Ve)delete this.keyCache[ht],delete this._layerConfigs[ht],delete this._layers[ht];this.familiesBySource={};const _t=function(ht,Mt){const Xt={};for(let Gt=0;Gt<ht.length;Gt++){const Zt=Mt&&Mt[ht[Gt].id]||I(ht[Gt]);Mt&&(Mt[ht[Gt].id]=Zt);let Ht=Xt[Zt];Ht||(Ht=Xt[Zt]=[]),Ht.push(ht[Gt])}const At=[];for(const Gt in Xt)At.push(Xt[Gt]);return At}(r.bd(this._layerConfigs),this.keyCache);for(const ht of _t){const Mt=ht.map(fn=>this._layers[fn.id]),Xt=Mt[0];if(Xt.visibility==="none")continue;const At=Xt.source||"";let Gt=this.familiesBySource[At];Gt||(Gt=this.familiesBySource[At]={});const Zt=Xt.sourceLayer||"_geojsonTileLayer";let Ht=Gt[Zt];Ht||(Ht=Gt[Zt]=[]),Ht.push(Mt)}}}const D=1*r.dP;class N{constructor(ze){const Ve={},at=[];for(const Xt in ze){const At=ze[Xt],Gt=Ve[Xt]={};for(const Zt in At.glyphs){const Ht=At.glyphs[+Zt];if(!Ht||Ht.bitmap.width===0||Ht.bitmap.height===0)continue;const fn=Ht.metrics.localGlyph?D:1,Nt={x:0,y:0,w:Ht.bitmap.width+2*fn,h:Ht.bitmap.height+2*fn};at.push(Nt),Gt[Zt]=Nt}}const{w:_t,h:ht}=r.z(at),Mt=new r.dO({width:_t||1,height:ht||1});for(const Xt in ze){const At=ze[Xt];for(const Gt in At.glyphs){const Zt=At.glyphs[+Gt];if(!Zt||Zt.bitmap.width===0||Zt.bitmap.height===0)continue;const Ht=Ve[Xt][Gt],fn=Zt.metrics.localGlyph?D:1;r.dO.copy(Zt.bitmap,Mt,{x:0,y:0},{x:Ht.x+fn,y:Ht.y+fn},Zt.bitmap)}}this.image=Mt,this.positions=Ve}}r.dN(N,"GlyphAtlas");class j{constructor(ze){this.tileID=new r.aA(ze.tileID.overscaledZ,ze.tileID.wrap,ze.tileID.canonical.z,ze.tileID.canonical.x,ze.tileID.canonical.y),this.tileZoom=ze.tileZoom,this.uid=ze.uid,this.zoom=ze.zoom,this.lut=ze.lut,this.canonical=ze.tileID.canonical,this.pixelRatio=ze.pixelRatio,this.tileSize=ze.tileSize,this.source=ze.source,this.scope=ze.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=ze.showCollisionBoxes,this.collectResourceTiming=!!ze.collectResourceTiming,this.promoteId=ze.promoteId,this.isSymbolTile=ze.isSymbolTile,this.tileTransform=r.aK(ze.tileID.canonical,ze.projection),this.projection=ze.projection,this.brightness=ze.brightness,this.extraShadowCaster=!!ze.extraShadowCaster,this.tessellationStep=ze.tessellationStep}parse(ze,Ve,at,_t,ht){this.status="parsing",this.data=ze,this.collisionBoxArray=new r.aQ;const Mt=new r.dQ(Object.keys(ze.layers).sort()),Xt=new r.dR(this.tileID,this.promoteId);Xt.bucketLayerIDs=[];const At={},Gt=new r.dS(256,256),Zt={featureIndex:Xt,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:Gt,availableImages:at,brightness:this.brightness},Ht=Ve.familiesBySource[this.source];for(const ur in Ht){const Cr=ze.layers[ur];if(!Cr)continue;let Or=!1,Fr=!1,bi=!1;for(const Ki of Ht[ur])Ki[0].type==="symbol"?Or=!0:Fr=!0,Ki[0].is3D()&&Ki[0].type!=="model"&&(bi=!0);if(this.extraShadowCaster&&!bi||this.isSymbolTile===!0&&!Or||this.isSymbolTile===!1&&!Fr)continue;Cr.version===1&&r.w(`Vector tile source "${this.source}" layer "${ur}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Mi=Mt.encode(ur),Wi=[];for(let Ki=0;Ki<Cr.length;Ki++){const yi=Cr.feature(Ki),bs=Xt.getId(yi,ur);Wi.push({feature:yi,id:bs,index:Ki,sourceLayerIndex:Mi})}for(const Ki of Ht[ur]){const yi=Ki[0];(!this.extraShadowCaster||yi.is3D()&&yi.type!=="model")&&(this.isSymbolTile!==void 0&&yi.type==="symbol"!==this.isSymbolTile||yi.minzoom&&this.zoom<Math.floor(yi.minzoom)||yi.maxzoom&&this.zoom>=yi.maxzoom||yi.visibility!=="none"&&(W(Ki,this.zoom,Zt.brightness,at),(At[yi.id]=yi.createBucket({index:Xt.bucketLayerIDs.length,layers:Ki,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Mi,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep})).populate(Wi,Zt,this.tileID.canonical,this.tileTransform),Xt.bucketLayerIDs.push(Ki.map(bs=>bs.id))))}}let fn,Nt,zt,yn;Gt.trim();const qn={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},Jn=()=>{if(fn)return this.status="done",ht(fn);if(this.extraShadowCaster)this.status="done",ht(null,{buckets:r.bd(At).filter(ur=>!ur.isEmpty()),featureIndex:Xt,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:Zt.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(Nt&&zt&&yn){const ur=new N(Nt),Cr=new r.dU(zt,yn,this.lut);for(const Or in At){const Fr=At[Or];Fr instanceof r.aR?(W(Fr.layers,this.zoom,Zt.brightness,at),r.dV(Fr,Nt,ur.positions,zt,Cr.iconPositions,this.showCollisionBoxes,at,this.tileID.canonical,this.tileZoom,this.projection,this.brightness)):Fr.hasPattern&&(Fr instanceof r.aX||Fr instanceof r.aY||Fr instanceof r.d0)&&(W(Fr.layers,this.zoom,Zt.brightness,at),Fr.addFeatures(Zt,this.tileID.canonical,Cr.patternPositions,at,this.tileTransform,this.brightness))}this.status="done",ht(null,{buckets:r.bd(At).filter(Or=>!Or.isEmpty()),featureIndex:Xt,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:ur.image,lineAtlas:Gt,imageAtlas:Cr,brightness:Zt.brightness})}};if(!this.extraShadowCaster){const ur=r.dT(Zt.glyphDependencies,Fr=>Object.keys(Fr).map(Number));Object.keys(ur).length?_t.send("getGlyphs",{uid:this.uid,stacks:ur,scope:this.scope},(Fr,bi)=>{fn||(fn=Fr,Nt=bi,Jn())},void 0,!1,qn):Nt={};const Cr=Object.keys(Zt.iconDependencies);Cr.length?_t.send("getImages",{icons:Cr,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(Fr,bi)=>{fn||(fn=Fr,zt=bi,Jn())},void 0,!1,qn):zt={};const Or=Object.keys(Zt.patternDependencies);Or.length?_t.send("getImages",{icons:Or,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(Fr,bi)=>{fn||(fn=Fr,yn=bi,Jn())},void 0,!1,qn):yn={}}Jn()}}function W(Vt,ze,Ve,at){const _t=new r.a3(ze,{brightness:Ve});for(const ht of Vt)ht.recalculate(_t,at)}class H extends r.E{constructor(ze,Ve,at,_t,ht,Mt){super(),this.actor=ze,this.layerIndex=Ve,this.availableImages=at,this.loadVectorData=ht||r.aw,this.loading={},this.loaded={},this.deduped=new r.au(ze.scheduler),this.isSpriteLoaded=_t,this.scheduler=ze.scheduler,this.brightness=Mt}loadTile(ze,Ve){const at=ze.uid,_t=ze&&ze.request,ht=_t&&_t.collectResourceTiming,Mt=this.loading[at]=new j(ze);Mt.abort=this.loadVectorData(ze,(Xt,At)=>{const Gt=!this.loading[at];if(delete this.loading[at],Gt||Xt||!At)return Mt.status="done",Gt||(this.loaded[at]=Mt),Ve(Xt);const Zt=At.rawData,Ht={};At.expires&&(Ht.expires=At.expires),At.cacheControl&&(Ht.cacheControl=At.cacheControl),Mt.vectorTile=At.vectorTile||new r.dW.VectorTile(new r.bb(Zt));const fn=()=>{Mt.parse(Mt.vectorTile,this.layerIndex,this.availableImages,this.actor,(Nt,zt)=>{if(Nt||!zt)return Ve(Nt);const yn={};if(ht){const qn=C(_t);qn.length>0&&(yn.resourceTiming=JSON.parse(JSON.stringify(qn)))}Ve(null,r.l({rawTileData:Zt.slice(0)},zt,Ht,yn))})};this.isSpriteLoaded?fn():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(fn,{type:"parseTile",isSymbolTile:ze.isSymbolTile,zoom:ze.tileZoom}):fn()}),this.loaded=this.loaded||{},this.loaded[at]=Mt})}reloadTile(ze,Ve){const at=this.loaded,_t=ze.uid;if(at&&at[_t]){const ht=at[_t];ht.showCollisionBoxes=ze.showCollisionBoxes,ht.projection=ze.projection,ht.brightness=ze.brightness,ht.tileTransform=r.aK(ze.tileID.canonical,ze.projection),ht.extraShadowCaster=ze.extraShadowCaster,ht.lut=ze.lut;const Mt=(Xt,At)=>{const Gt=ht.reloadCallback;Gt&&(delete ht.reloadCallback,ht.parse(ht.vectorTile,this.layerIndex,this.availableImages,this.actor,Gt)),Ve(Xt,At)};ht.status==="parsing"?ht.reloadCallback=Mt:ht.status==="done"&&(ht.vectorTile?ht.parse(ht.vectorTile,this.layerIndex,this.availableImages,this.actor,Mt):Mt())}else Ve(null,void 0)}abortTile(ze,Ve){const at=ze.uid,_t=this.loading[at];_t&&(_t.abort&&_t.abort(),delete this.loading[at]),Ve()}removeTile(ze,Ve){const at=this.loaded,_t=ze.uid;at&&at[_t]&&delete at[_t],Ve()}}class q{loadTile(ze,Ve){const{uid:at,encoding:_t,rawImageData:ht,padding:Mt}=ze,Xt=ImageBitmap&&ht instanceof ImageBitmap?this.getImageData(ht,Mt):ht;Ve(null,new r.dX(at,Xt,_t,Mt<1))}getImageData(ze,Ve){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(ze.width,ze.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=ze.width,this.offscreenCanvas.height=ze.height,this.offscreenCanvasContext.drawImage(ze,0,0,ze.width,ze.height);const at=this.offscreenCanvasContext.getImageData(-Ve,-Ve,ze.width+2*Ve,ze.height+2*Ve);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),at}}r.ba.setPbf(r.bb);class Z{decodeRasterArray({task:ze,buffer:Ve},at){r.ba.performDecoding(Ve,ze).then(_t=>{at(null,_t)},_t=>{at(_t)})}}const re=r.dW.VectorTileFeature.prototype.toGeoJSON;class le{constructor(ze){this._feature=ze,this.extent=r.ab,this.type=ze.type,this.properties=ze.tags,"id"in ze&&!isNaN(ze.id)&&(this.id=parseInt(ze.id,10))}loadGeometry(){if(this._feature.type===1){const ze=[];for(const Ve of this._feature.geometry)ze.push([new r.P(Ve[0],Ve[1])]);return ze}{const ze=[];for(const Ve of this._feature.geometry){const at=[];for(const _t of Ve)at.push(new r.P(_t[0],_t[1]));ze.push(at)}return ze}}toGeoJSON(ze,Ve,at){return re.call(this,ze,Ve,at)}}class _e{constructor(ze){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=r.ab,this.length=ze.length,this._features=ze}feature(ze){return new le(this._features[ze])}}const ye=64/4096,de=128;class ce{constructor(){this.features=new Map}clear(){this.features.clear()}load(ze=[],Ve){for(const at of ze){const _t=at.id;if(_t==null)continue;let ht=this.features.get(_t);ht&&this.updateCache(ht,Ve),at.geometry?(ht=xe(at),this.updateCache(ht,Ve),this.features.set(_t,ht)):this.features.delete(_t),this.updateCache(ht,Ve)}}updateCache(ze,Ve){for(const{canonical:at,uid:_t}of Object.values(Ve)){const{z:ht,x:Mt,y:Xt}=at;oe(ze,Math.pow(2,ht),Mt,Xt)&&delete Ve[_t]}}getTile(ze,Ve,at){const _t=Math.pow(2,ze),ht=[];for(const Mt of this.features.values())oe(Mt,_t,Ve,at)&&ht.push(we(Mt,_t,Ve,at));return{features:ht}}getFeatures(){return[...this.features.values()]}}function oe({minX:Vt,minY:ze,maxX:Ve,maxY:at},_t,ht,Mt){return Vt<(ht+1+ye)/_t&&ze<(Mt+1+ye)/_t&&Ve>(ht-ye)/_t&&at>(Mt-ye)/_t}function xe(Vt){const{id:ze,geometry:Ve,properties:at}=Vt;if(!Ve)return;if(Ve.type==="GeometryCollection")throw new Error("GeometryCollection not supported in dynamic mode.");const{type:_t,coordinates:ht}=Ve,Mt={id:ze,type:1,geometry:[],tags:at,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},Xt=Mt.geometry;if(_t==="Point")he(ht,Xt,Mt);else if(_t==="MultiPoint")for(const At of ht)he(At,Xt,Mt);else if(_t==="LineString")Mt.type=2,Ee(ht,Xt,Mt);else if(_t==="MultiLineString")Mt.type=2,se(ht,Xt,Mt);else if(_t==="Polygon")Mt.type=3,se(ht,Xt,Mt,!0);else{if(_t!=="MultiPolygon")throw new Error("Input data is not a valid GeoJSON object.");Mt.type=3;for(const At of ht)se(At,Xt,Mt,!0)}return Mt}function he([Vt,ze],Ve,at){const _t=r.am(Vt);let ht=r.at(ze);ht=ht<0?0:ht>1?1:ht,Ve.push(_t,ht),at.minX=Math.min(at.minX,_t),at.minY=Math.min(at.minY,ht),at.maxX=Math.max(at.maxX,_t),at.maxY=Math.max(at.maxY,ht)}function Ee(Vt,ze,Ve,at=!1,_t=!1){const ht=[];for(const Mt of Vt)he(Mt,ht,Ve);ze.push(ht),at&&function(Mt,Xt){let At=0;for(let Gt=0,Zt=Mt.length,Ht=Zt-2;Gt<Zt;Ht=Gt,Gt+=2)At+=(Mt[Gt]-Mt[Ht])*(Mt[Gt+1]+Mt[Ht+1]);if(At>0===Xt)for(let Gt=0,Zt=Mt.length;Gt<Zt/2;Gt+=2){const Ht=Mt[Gt],fn=Mt[Gt+1];Mt[Gt]=Mt[Zt-2-Gt],Mt[Gt+1]=Mt[Zt-1-Gt],Mt[Zt-2-Gt]=Ht,Mt[Zt-1-Gt]=fn}}(ht,_t)}function se(Vt,ze,Ve,at=!1){for(let _t=0;_t<Vt.length;_t++)Ee(Vt[_t],ze,Ve,at,_t===0)}function we(Vt,ze,Ve,at){const{id:_t,type:ht,geometry:Mt,tags:Xt}=Vt,At=[];if(ht===1)(function(Gt,Zt,Ht,fn,Nt){for(let zt=0;zt<Gt.length;zt+=2){const yn=Math.round(r.ab*(Gt[zt+0]*Zt-Ht)),qn=Math.round(r.ab*(Gt[zt+1]*Zt-fn));Nt.push([yn,qn])}})(Mt,ze,Ve,at,At);else for(const Gt of Mt)Se(Gt,ze,Ve,at,At);return{id:_t,type:ht,geometry:At,tags:Xt}}function Se(Vt,ze,Ve,at,_t){const ht=-de,Mt=r.ab+de;let Xt;for(let At=0;At<Vt.length-2;At+=2){let Gt=Math.round(r.ab*(Vt[At+0]*ze-Ve)),Zt=Math.round(r.ab*(Vt[At+1]*ze-at)),Ht=Math.round(r.ab*(Vt[At+2]*ze-Ve)),fn=Math.round(r.ab*(Vt[At+3]*ze-at));const Nt=Ht-Gt,zt=fn-Zt;Gt<ht&&Ht<ht||(Gt<ht?(Zt+=Math.round(zt*((ht-Gt)/Nt)),Gt=ht):Ht<ht&&(fn=Zt+Math.round(zt*((ht-Gt)/Nt)),Ht=ht),Zt<ht&&fn<ht||(Zt<ht?(Gt+=Math.round(Nt*((ht-Zt)/zt)),Zt=ht):fn<ht&&(Ht=Gt+Math.round(Nt*((ht-Zt)/zt)),fn=ht),Gt>=Mt&&Ht>=Mt||(Gt>=Mt?(Zt+=Math.round(zt*((Mt-Gt)/Nt)),Gt=Mt):Ht>=Mt&&(fn=Zt+Math.round(zt*((Mt-Gt)/Nt)),Ht=Mt),Zt>=Mt&&fn>=Mt||(Zt>=Mt?(Gt+=Math.round(Nt*((Mt-Zt)/zt)),Zt=Mt):fn>=Mt&&(Ht=Gt+Math.round(Nt*((Mt-Zt)/zt)),fn=Mt),Xt&&Gt===Xt[Xt.length-1][0]&&Zt===Xt[Xt.length-1][1]||(Xt=[[Gt,Zt]],_t.push(Xt)),Xt.push([Ht,fn])))))}}var Pe,Me,Re,Oe={exports:{}},$e=function(){if(Re)return Oe.exports;Re=1;var Vt=r.d_(),ze=function(){if(Me)return Pe;Me=1;var Zt=r.dY(),Ht=r.dZ().VectorTileFeature;function fn(zt,yn){this.options=yn||{},this.features=zt,this.length=zt.length}function Nt(zt,yn){this.id=typeof zt.id=="number"?zt.id:void 0,this.type=zt.type,this.rawGeometry=zt.type===1?[zt.geometry]:zt.geometry,this.properties=zt.tags,this.extent=yn||4096}return Pe=fn,fn.prototype.feature=function(zt){return new Nt(this.features[zt],this.options.extent)},Nt.prototype.loadGeometry=function(){var zt=this.rawGeometry;this.geometry=[];for(var yn=0;yn<zt.length;yn++){for(var qn=zt[yn],Jn=[],ur=0;ur<qn.length;ur++)Jn.push(new Zt(qn[ur][0],qn[ur][1]));this.geometry.push(Jn)}return this.geometry},Nt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var zt=this.geometry,yn=1/0,qn=-1/0,Jn=1/0,ur=-1/0,Cr=0;Cr<zt.length;Cr++)for(var Or=zt[Cr],Fr=0;Fr<Or.length;Fr++){var bi=Or[Fr];yn=Math.min(yn,bi.x),qn=Math.max(qn,bi.x),Jn=Math.min(Jn,bi.y),ur=Math.max(ur,bi.y)}return[yn,Jn,qn,ur]},Nt.prototype.toGeoJSON=Ht.prototype.toGeoJSON,Pe}();function Ve(Zt){var Ht=new Vt;return function(fn,Nt){for(var zt in fn.layers)Nt.writeMessage(3,at,fn.layers[zt])}(Zt,Ht),Ht.finish()}function at(Zt,Ht){var fn;Ht.writeVarintField(15,Zt.version||1),Ht.writeStringField(1,Zt.name||""),Ht.writeVarintField(5,Zt.extent||4096);var Nt={keys:[],values:[],keycache:{},valuecache:{}};for(fn=0;fn<Zt.length;fn++)Nt.feature=Zt.feature(fn),Ht.writeMessage(2,_t,Nt);var zt=Nt.keys;for(fn=0;fn<zt.length;fn++)Ht.writeStringField(3,zt[fn]);var yn=Nt.values;for(fn=0;fn<yn.length;fn++)Ht.writeMessage(4,Gt,yn[fn])}function _t(Zt,Ht){var fn=Zt.feature;fn.id!==void 0&&Ht.writeVarintField(1,fn.id),Ht.writeMessage(2,ht,Zt),Ht.writeVarintField(3,fn.type),Ht.writeMessage(4,At,fn)}function ht(Zt,Ht){var fn=Zt.feature,Nt=Zt.keys,zt=Zt.values,yn=Zt.keycache,qn=Zt.valuecache;for(var Jn in fn.properties){var ur=fn.properties[Jn],Cr=yn[Jn];if(ur!==null){Cr===void 0&&(Nt.push(Jn),yn[Jn]=Cr=Nt.length-1),Ht.writeVarint(Cr);var Or=typeof ur;Or!=="string"&&Or!=="boolean"&&Or!=="number"&&(ur=JSON.stringify(ur));var Fr=Or+":"+ur,bi=qn[Fr];bi===void 0&&(zt.push(ur),qn[Fr]=bi=zt.length-1),Ht.writeVarint(bi)}}}function Mt(Zt,Ht){return(Ht<<3)+(7&Zt)}function Xt(Zt){return Zt<<1^Zt>>31}function At(Zt,Ht){for(var fn=Zt.loadGeometry(),Nt=Zt.type,zt=0,yn=0,qn=fn.length,Jn=0;Jn<qn;Jn++){var ur=fn[Jn],Cr=1;Nt===1&&(Cr=ur.length),Ht.writeVarint(Mt(1,Cr));for(var Or=Nt===3?ur.length-1:ur.length,Fr=0;Fr<Or;Fr++){Fr===1&&Nt!==1&&Ht.writeVarint(Mt(2,Or-1));var bi=ur[Fr].x-zt,Mi=ur[Fr].y-yn;Ht.writeVarint(Xt(bi)),Ht.writeVarint(Xt(Mi)),zt+=bi,yn+=Mi}Nt===3&&Ht.writeVarint(Mt(7,1))}}function Gt(Zt,Ht){var fn=typeof Zt;fn==="string"?Ht.writeStringField(1,Zt):fn==="boolean"?Ht.writeBooleanField(7,Zt):fn==="number"&&(Zt%1!=0?Ht.writeDoubleField(3,Zt):Zt<0?Ht.writeSVarintField(6,Zt):Ht.writeVarintField(5,Zt))}return Oe.exports=Ve,Oe.exports.fromVectorTileJs=Ve,Oe.exports.fromGeojsonVt=function(Zt,Ht){Ht=Ht||{};var fn={};for(var Nt in Zt)fn[Nt]=new ze(Zt[Nt].features,Ht),fn[Nt].name=Nt,fn[Nt].version=Ht.version,fn[Nt].extent=Ht.extent;return Ve({layers:fn})},Oe.exports.GeoJSONWrapper=ze,Oe.exports}(),Ke=r.d$($e);const Ct={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Vt=>Vt},Ue=Math.fround||(ft=new Float32Array(1),Vt=>(ft[0]=+Vt,ft[0]));var ft;const Bt=3,hn=5,ot=6;class en{constructor(ze){this.options=Object.assign(Object.create(Ct),ze),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ze){const{log:Ve,minZoom:at,maxZoom:_t}=this.options;Ve&&console.time("total time");const ht=`prepare ${ze.length} points`;Ve&&console.time(ht),this.points=ze;const Mt=[];for(let At=0;At<ze.length;At++){const Gt=ze[At];if(!Gt.geometry)continue;const[Zt,Ht]=Gt.geometry.coordinates,fn=Ue(We(Zt)),Nt=Ue(Sn(Ht));Mt.push(fn,Nt,1/0,At,-1,1),this.options.reduce&&Mt.push(0)}let Xt=this.trees[_t+1]=this._createTree(Mt);Ve&&console.timeEnd(ht);for(let At=_t;At>=at;At--){const Gt=+Date.now();Xt=this.trees[At]=this._createTree(this._cluster(Xt,At)),Ve&&console.log("z%d: %d clusters in %dms",At,Xt.numItems,+Date.now()-Gt)}return Ve&&console.timeEnd("total time"),this}getClusters(ze,Ve){let at=((ze[0]+180)%360+360)%360-180;const _t=Math.max(-90,Math.min(90,ze[1]));let ht=ze[2]===180?180:((ze[2]+180)%360+360)%360-180;const Mt=Math.max(-90,Math.min(90,ze[3]));if(ze[2]-ze[0]>=360)at=-180,ht=180;else if(at>ht){const Ht=this.getClusters([at,_t,180,Mt],Ve),fn=this.getClusters([-180,_t,ht,Mt],Ve);return Ht.concat(fn)}const Xt=this.trees[this._limitZoom(Ve)],At=Xt.range(We(at),Sn(Mt),We(ht),Sn(_t)),Gt=Xt.data,Zt=[];for(const Ht of At){const fn=this.stride*Ht;Zt.push(Gt[fn+hn]>1?wt(Gt,fn,this.clusterProps):this.points[Gt[fn+Bt]])}return Zt}getChildren(ze){const Ve=this._getOriginId(ze),at=this._getOriginZoom(ze),_t="No cluster with the specified id.",ht=this.trees[at];if(!ht)throw new Error(_t);const Mt=ht.data;if(Ve*this.stride>=Mt.length)throw new Error(_t);const Xt=this.options.radius/(this.options.extent*Math.pow(2,at-1)),At=ht.within(Mt[Ve*this.stride],Mt[Ve*this.stride+1],Xt),Gt=[];for(const Zt of At){const Ht=Zt*this.stride;Mt[Ht+4]===ze&&Gt.push(Mt[Ht+hn]>1?wt(Mt,Ht,this.clusterProps):this.points[Mt[Ht+Bt]])}if(Gt.length===0)throw new Error(_t);return Gt}getLeaves(ze,Ve,at){const _t=[];return this._appendLeaves(_t,ze,Ve=Ve||10,at=at||0,0),_t}getTile(ze,Ve,at){const _t=this.trees[this._limitZoom(ze)],ht=Math.pow(2,ze),{extent:Mt,radius:Xt}=this.options,At=Xt/Mt,Gt=(at-At)/ht,Zt=(at+1+At)/ht,Ht={features:[]};return this._addTileFeatures(_t.range((Ve-At)/ht,Gt,(Ve+1+At)/ht,Zt),_t.data,Ve,at,ht,Ht),Ve===0&&this._addTileFeatures(_t.range(1-At/ht,Gt,1,Zt),_t.data,ht,at,ht,Ht),Ve===ht-1&&this._addTileFeatures(_t.range(0,Gt,At/ht,Zt),_t.data,-1,at,ht,Ht),Ht.features.length?Ht:null}getClusterExpansionZoom(ze){let Ve=this._getOriginZoom(ze)-1;for(;Ve<=this.options.maxZoom;){const at=this.getChildren(ze);if(Ve++,at.length!==1)break;ze=at[0].properties.cluster_id}return Ve}_appendLeaves(ze,Ve,at,_t,ht){const Mt=this.getChildren(Ve);for(const Xt of Mt){const At=Xt.properties;if(At&&At.cluster?ht+At.point_count<=_t?ht+=At.point_count:ht=this._appendLeaves(ze,At.cluster_id,at,_t,ht):ht<_t?ht++:ze.push(Xt),ze.length===at)break}return ht}_createTree(ze){const Ve=new r.by(ze.length/this.stride|0,this.options.nodeSize,Float32Array);for(let at=0;at<ze.length;at+=this.stride)Ve.add(ze[at],ze[at+1]);return Ve.finish(),Ve.data=ze,Ve}_addTileFeatures(ze,Ve,at,_t,ht,Mt){for(const Xt of ze){const At=Xt*this.stride,Gt=Ve[At+hn]>1;let Zt,Ht,fn;if(Gt)Zt=Ne(Ve,At,this.clusterProps),Ht=Ve[At],fn=Ve[At+1];else{const yn=this.points[Ve[At+Bt]];Zt=yn.properties;const[qn,Jn]=yn.geometry.coordinates;Ht=We(qn),fn=Sn(Jn)}const Nt={type:1,geometry:[[Math.round(this.options.extent*(Ht*ht-at)),Math.round(this.options.extent*(fn*ht-_t))]],tags:Zt};let zt;zt=Gt||this.options.generateId?Ve[At+Bt]:this.points[Ve[At+Bt]].id,zt!==void 0&&(Nt.id=zt),Mt.features.push(Nt)}}_limitZoom(ze){return Math.max(this.options.minZoom,Math.min(Math.floor(+ze),this.options.maxZoom+1))}_cluster(ze,Ve){const{radius:at,extent:_t,reduce:ht,minPoints:Mt}=this.options,Xt=at/(_t*Math.pow(2,Ve)),At=ze.data,Gt=[],Zt=this.stride;for(let Ht=0;Ht<At.length;Ht+=Zt){if(At[Ht+2]<=Ve)continue;At[Ht+2]=Ve;const fn=At[Ht],Nt=At[Ht+1],zt=ze.within(At[Ht],At[Ht+1],Xt),yn=At[Ht+hn];let qn=yn;for(const Jn of zt){const ur=Jn*Zt;At[ur+2]>Ve&&(qn+=At[ur+hn])}if(qn>yn&&qn>=Mt){let Jn,ur=fn*yn,Cr=Nt*yn,Or=-1;const Fr=(Ht/Zt<<5)+(Ve+1)+this.points.length;for(const bi of zt){const Mi=bi*Zt;if(At[Mi+2]<=Ve)continue;At[Mi+2]=Ve;const Wi=At[Mi+hn];ur+=At[Mi]*Wi,Cr+=At[Mi+1]*Wi,At[Mi+4]=Fr,ht&&(Jn||(Jn=this._map(At,Ht,!0),Or=this.clusterProps.length,this.clusterProps.push(Jn)),ht(Jn,this._map(At,Mi)))}At[Ht+4]=Fr,Gt.push(ur/qn,Cr/qn,1/0,Fr,-1,qn),ht&&Gt.push(Or)}else{for(let Jn=0;Jn<Zt;Jn++)Gt.push(At[Ht+Jn]);if(qn>1)for(const Jn of zt){const ur=Jn*Zt;if(!(At[ur+2]<=Ve)){At[ur+2]=Ve;for(let Cr=0;Cr<Zt;Cr++)Gt.push(At[ur+Cr])}}}}return Gt}_getOriginId(ze){return ze-this.points.length>>5}_getOriginZoom(ze){return(ze-this.points.length)%32}_map(ze,Ve,at){if(ze[Ve+hn]>1){const Mt=this.clusterProps[ze[Ve+ot]];return at?Object.assign({},Mt):Mt}const _t=this.points[ze[Ve+Bt]].properties,ht=this.options.map(_t);return at&&ht===_t?Object.assign({},ht):ht}}function wt(Vt,ze,Ve){return{type:"Feature",id:Vt[ze+Bt],properties:Ne(Vt,ze,Ve),geometry:{type:"Point",coordinates:[(at=Vt[ze],360*(at-.5)),Ae(Vt[ze+1])]}};var at}function Ne(Vt,ze,Ve){const at=Vt[ze+hn],_t=at>=1e4?`${Math.round(at/1e3)}k`:at>=1e3?Math.round(at/100)/10+"k":at,ht=Vt[ze+ot],Mt=ht===-1?{}:Object.assign({},Ve[ht]);return Object.assign(Mt,{cluster:!0,cluster_id:Vt[ze+Bt],point_count:at,point_count_abbreviated:_t})}function We(Vt){return Vt/360+.5}function Sn(Vt){const ze=Math.sin(Vt*Math.PI/180),Ve=.5-.25*Math.log((1+ze)/(1-ze))/Math.PI;return Ve<0?0:Ve>1?1:Ve}function Ae(Vt){const ze=(180-360*Vt)*Math.PI/180;return 360*Math.atan(Math.exp(ze))/Math.PI-90}function st(Vt,ze,Ve,at){let _t=at;const ht=ze+(Ve-ze>>1);let Mt,Xt=Ve-ze;const At=Vt[ze],Gt=Vt[ze+1],Zt=Vt[Ve],Ht=Vt[Ve+1];for(let fn=ze+3;fn<Ve;fn+=3){const Nt=gt(Vt[fn],Vt[fn+1],At,Gt,Zt,Ht);if(Nt>_t)Mt=fn,_t=Nt;else if(Nt===_t){const zt=Math.abs(fn-ht);zt<Xt&&(Mt=fn,Xt=zt)}}_t>at&&(Mt-ze>3&&st(Vt,ze,Mt,at),Vt[Mt+2]=_t,Ve-Mt>3&&st(Vt,Mt,Ve,at))}function gt(Vt,ze,Ve,at,_t,ht){let Mt=_t-Ve,Xt=ht-at;if(Mt!==0||Xt!==0){const At=((Vt-Ve)*Mt+(ze-at)*Xt)/(Mt*Mt+Xt*Xt);At>1?(Ve=_t,at=ht):At>0&&(Ve+=Mt*At,at+=Xt*At)}return Mt=Vt-Ve,Xt=ze-at,Mt*Mt+Xt*Xt}function ut(Vt,ze,Ve,at){const _t={id:Vt??null,type:ze,geometry:Ve,tags:at,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(ze==="Point"||ze==="MultiPoint"||ze==="LineString")tt(_t,Ve);else if(ze==="Polygon")tt(_t,Ve[0]);else if(ze==="MultiLineString")for(const ht of Ve)tt(_t,ht);else if(ze==="MultiPolygon")for(const ht of Ve)tt(_t,ht[0]);return _t}function tt(Vt,ze){for(let Ve=0;Ve<ze.length;Ve+=3)Vt.minX=Math.min(Vt.minX,ze[Ve]),Vt.minY=Math.min(Vt.minY,ze[Ve+1]),Vt.maxX=Math.max(Vt.maxX,ze[Ve]),Vt.maxY=Math.max(Vt.maxY,ze[Ve+1])}function nt(Vt,ze,Ve,at){if(!ze.geometry)return;const _t=ze.geometry.coordinates;if(_t&&_t.length===0)return;const ht=ze.geometry.type,Mt=Math.pow(Ve.tolerance/((1<<Ve.maxZoom)*Ve.extent),2);let Xt=[],At=ze.id;if(Ve.promoteId?At=ze.properties[Ve.promoteId]:Ve.generateId&&(At=at||0),ht==="Point")tn(_t,Xt);else if(ht==="MultiPoint")for(const Gt of _t)tn(Gt,Xt);else if(ht==="LineString")un(_t,Xt,Mt,!1);else if(ht==="MultiLineString"){if(Ve.lineMetrics){for(const Gt of _t)Xt=[],un(Gt,Xt,Mt,!1),Vt.push(ut(At,"LineString",Xt,ze.properties));return}qt(_t,Xt,Mt,!1)}else if(ht==="Polygon")qt(_t,Xt,Mt,!0);else{if(ht!=="MultiPolygon"){if(ht==="GeometryCollection"){for(const Gt of ze.geometry.geometries)nt(Vt,{id:At,geometry:Gt,properties:ze.properties},Ve,at);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Gt of _t){const Zt=[];qt(Gt,Zt,Mt,!0),Xt.push(Zt)}}Vt.push(ut(At,ht,Xt,ze.properties))}function tn(Vt,ze){ze.push(an(Vt[0]),Jt(Vt[1]),0)}function un(Vt,ze,Ve,at){let _t,ht,Mt=0;for(let At=0;At<Vt.length;At++){const Gt=an(Vt[At][0]),Zt=Jt(Vt[At][1]);ze.push(Gt,Zt,0),At>0&&(Mt+=at?(_t*Zt-Gt*ht)/2:Math.sqrt(Math.pow(Gt-_t,2)+Math.pow(Zt-ht,2))),_t=Gt,ht=Zt}const Xt=ze.length-3;ze[2]=1,st(ze,0,Xt,Ve),ze[Xt+2]=1,ze.size=Math.abs(Mt),ze.start=0,ze.end=ze.size}function qt(Vt,ze,Ve,at){for(let _t=0;_t<Vt.length;_t++){const ht=[];un(Vt[_t],ht,Ve,at),ze.push(ht)}}function an(Vt){return Vt/360+.5}function Jt(Vt){const ze=Math.sin(Vt*Math.PI/180),Ve=.5-.25*Math.log((1+ze)/(1-ze))/Math.PI;return Ve<0?0:Ve>1?1:Ve}function Wt(Vt,ze,Ve,at,_t,ht,Mt,Xt){if(at/=ze,ht>=(Ve/=ze)&&Mt<at)return Vt;if(Mt<Ve||ht>=at)return null;const At=[];for(const Gt of Vt){const Zt=Gt.geometry;let Ht=Gt.type;const fn=_t===0?Gt.minX:Gt.minY,Nt=_t===0?Gt.maxX:Gt.maxY;if(fn>=Ve&&Nt<at){At.push(Gt);continue}if(Nt<Ve||fn>=at)continue;let zt=[];if(Ht==="Point"||Ht==="MultiPoint")Fn(Zt,zt,Ve,at,_t);else if(Ht==="LineString")ar(Zt,zt,Ve,at,_t,!1,Xt.lineMetrics);else if(Ht==="MultiLineString")lr(Zt,zt,Ve,at,_t,!1);else if(Ht==="Polygon")lr(Zt,zt,Ve,at,_t,!0);else if(Ht==="MultiPolygon")for(const yn of Zt){const qn=[];lr(yn,qn,Ve,at,_t,!0),qn.length&&zt.push(qn)}if(zt.length){if(Xt.lineMetrics&&Ht==="LineString"){for(const yn of zt)At.push(ut(Gt.id,Ht,yn,Gt.tags));continue}Ht!=="LineString"&&Ht!=="MultiLineString"||(zt.length===1?(Ht="LineString",zt=zt[0]):Ht="MultiLineString"),Ht!=="Point"&&Ht!=="MultiPoint"||(Ht=zt.length===3?"Point":"MultiPoint"),At.push(ut(Gt.id,Ht,zt,Gt.tags))}}return At.length?At:null}function Fn(Vt,ze,Ve,at,_t){for(let ht=0;ht<Vt.length;ht+=3){const Mt=Vt[ht+_t];Mt>=Ve&&Mt<=at&&Cn(ze,Vt[ht],Vt[ht+1],Vt[ht+2])}}function ar(Vt,ze,Ve,at,_t,ht,Mt){let Xt=bn(Vt);const At=_t===0?xn:Er;let Gt,Zt,Ht=Vt.start;for(let qn=0;qn<Vt.length-3;qn+=3){const Jn=Vt[qn],ur=Vt[qn+1],Cr=Vt[qn+2],Or=Vt[qn+3],Fr=Vt[qn+4],bi=_t===0?Jn:ur,Mi=_t===0?Or:Fr;let Wi=!1;Mt&&(Gt=Math.sqrt(Math.pow(Jn-Or,2)+Math.pow(ur-Fr,2))),bi<Ve?Mi>Ve&&(Zt=At(Xt,Jn,ur,Or,Fr,Ve),Mt&&(Xt.start=Ht+Gt*Zt)):bi>at?Mi<at&&(Zt=At(Xt,Jn,ur,Or,Fr,at),Mt&&(Xt.start=Ht+Gt*Zt)):Cn(Xt,Jn,ur,Cr),Mi<Ve&&bi>=Ve&&(Zt=At(Xt,Jn,ur,Or,Fr,Ve),Wi=!0),Mi>at&&bi<=at&&(Zt=At(Xt,Jn,ur,Or,Fr,at),Wi=!0),!ht&&Wi&&(Mt&&(Xt.end=Ht+Gt*Zt),ze.push(Xt),Xt=bn(Vt)),Mt&&(Ht+=Gt)}let fn=Vt.length-3;const Nt=Vt[fn],zt=Vt[fn+1],yn=_t===0?Nt:zt;yn>=Ve&&yn<=at&&Cn(Xt,Nt,zt,Vt[fn+2]),fn=Xt.length-3,ht&&fn>=3&&(Xt[fn]!==Xt[0]||Xt[fn+1]!==Xt[1])&&Cn(Xt,Xt[0],Xt[1],Xt[2]),Xt.length&&ze.push(Xt)}function bn(Vt){const ze=[];return ze.size=Vt.size,ze.start=Vt.start,ze.end=Vt.end,ze}function lr(Vt,ze,Ve,at,_t,ht){for(const Mt of Vt)ar(Mt,ze,Ve,at,_t,ht,!1)}function Cn(Vt,ze,Ve,at){Vt.push(ze,Ve,at)}function xn(Vt,ze,Ve,at,_t,ht){const Mt=(ht-ze)/(at-ze);return Cn(Vt,ht,Ve+(_t-Ve)*Mt,1),Mt}function Er(Vt,ze,Ve,at,_t,ht){const Mt=(ht-Ve)/(_t-Ve);return Cn(Vt,ze+(at-ze)*Mt,ht,1),Mt}function Rr(Vt,ze){const Ve=[];for(let at=0;at<Vt.length;at++){const _t=Vt[at],ht=_t.type;let Mt;if(ht==="Point"||ht==="MultiPoint"||ht==="LineString")Mt=Wn(_t.geometry,ze);else if(ht==="MultiLineString"||ht==="Polygon"){Mt=[];for(const Xt of _t.geometry)Mt.push(Wn(Xt,ze))}else if(ht==="MultiPolygon"){Mt=[];for(const Xt of _t.geometry){const At=[];for(const Gt of Xt)At.push(Wn(Gt,ze));Mt.push(At)}}Ve.push(ut(_t.id,ht,Mt,_t.tags))}return Ve}function Wn(Vt,ze){const Ve=[];Ve.size=Vt.size,Vt.start!==void 0&&(Ve.start=Vt.start,Ve.end=Vt.end);for(let at=0;at<Vt.length;at+=3)Ve.push(Vt[at]+ze,Vt[at+1],Vt[at+2]);return Ve}function Mn(Vt,ze){if(Vt.transformed)return Vt;const Ve=1<<Vt.z,at=Vt.x,_t=Vt.y;for(const ht of Vt.features){const Mt=ht.geometry,Xt=ht.type;if(ht.geometry=[],Xt===1)for(let At=0;At<Mt.length;At+=2)ht.geometry.push(Ar(Mt[At],Mt[At+1],ze,Ve,at,_t));else for(let At=0;At<Mt.length;At++){const Gt=[];for(let Zt=0;Zt<Mt[At].length;Zt+=2)Gt.push(Ar(Mt[At][Zt],Mt[At][Zt+1],ze,Ve,at,_t));ht.geometry.push(Gt)}}return Vt.transformed=!0,Vt}function Ar(Vt,ze,Ve,at,_t,ht){return[Math.round(Ve*(Vt*at-_t)),Math.round(Ve*(ze*at-ht))]}function fi(Vt,ze,Ve,at,_t){const ht=ze===_t.maxZoom?0:_t.tolerance/((1<<ze)*_t.extent),Mt={features:[],numPoints:0,numSimplified:0,numFeatures:Vt.length,source:null,x:Ve,y:at,z:ze,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Xt of Vt)yo(Mt,Xt,ht,_t);return Mt}function yo(Vt,ze,Ve,at){const _t=ze.geometry,ht=ze.type,Mt=[];if(Vt.minX=Math.min(Vt.minX,ze.minX),Vt.minY=Math.min(Vt.minY,ze.minY),Vt.maxX=Math.max(Vt.maxX,ze.maxX),Vt.maxY=Math.max(Vt.maxY,ze.maxY),ht==="Point"||ht==="MultiPoint")for(let Xt=0;Xt<_t.length;Xt+=3)Mt.push(_t[Xt],_t[Xt+1]),Vt.numPoints++,Vt.numSimplified++;else if(ht==="LineString")vr(Mt,_t,Vt,Ve,!1,!1);else if(ht==="MultiLineString"||ht==="Polygon")for(let Xt=0;Xt<_t.length;Xt++)vr(Mt,_t[Xt],Vt,Ve,ht==="Polygon",Xt===0);else if(ht==="MultiPolygon")for(let Xt=0;Xt<_t.length;Xt++){const At=_t[Xt];for(let Gt=0;Gt<At.length;Gt++)vr(Mt,At[Gt],Vt,Ve,!0,Gt===0)}if(Mt.length){let Xt=ze.tags||null;if(ht==="LineString"&&at.lineMetrics){Xt={};for(const Gt in ze.tags)Xt[Gt]=ze.tags[Gt];Xt.mapbox_clip_start=_t.start/_t.size,Xt.mapbox_clip_end=_t.end/_t.size}const At={geometry:Mt,type:ht==="Polygon"||ht==="MultiPolygon"?3:ht==="LineString"||ht==="MultiLineString"?2:1,tags:Xt};ze.id!==null&&(At.id=ze.id),Vt.features.push(At)}}function vr(Vt,ze,Ve,at,_t,ht){const Mt=at*at;if(at>0&&ze.size<(_t?Mt:at))return void(Ve.numPoints+=ze.length/3);const Xt=[];for(let At=0;At<ze.length;At+=3)(at===0||ze[At+2]>Mt)&&(Ve.numSimplified++,Xt.push(ze[At],ze[At+1])),Ve.numPoints++;_t&&function(At,Gt){let Zt=0;for(let Ht=0,fn=At.length,Nt=fn-2;Ht<fn;Nt=Ht,Ht+=2)Zt+=(At[Ht]-At[Nt])*(At[Ht+1]+At[Nt+1]);if(Zt>0===Gt)for(let Ht=0,fn=At.length;Ht<fn/2;Ht+=2){const Nt=At[Ht],zt=At[Ht+1];At[Ht]=At[fn-2-Ht],At[Ht+1]=At[fn-1-Ht],At[fn-2-Ht]=Nt,At[fn-1-Ht]=zt}}(Xt,ht),Vt.push(Xt)}const zi={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Li{constructor(ze,Ve){const at=(Ve=this.options=function(ht,Mt){for(const Xt in Mt)ht[Xt]=Mt[Xt];return ht}(Object.create(zi),Ve)).debug;if(at&&console.time("preprocess data"),Ve.maxZoom<0||Ve.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Ve.promoteId&&Ve.generateId)throw new Error("promoteId and generateId cannot be used together.");let _t=function(ht,Mt){const Xt=[];if(ht.type==="FeatureCollection")for(let At=0;At<ht.features.length;At++)nt(Xt,ht.features[At],Mt,At);else nt(Xt,ht.type==="Feature"?ht:{geometry:ht},Mt);return Xt}(ze,Ve);this.tiles={},this.tileCoords=[],at&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Ve.indexMaxZoom,Ve.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),_t=function(ht,Mt){const Xt=Mt.buffer/Mt.extent;let At=ht;const Gt=Wt(ht,1,-1-Xt,Xt,0,-1,2,Mt),Zt=Wt(ht,1,1-Xt,2+Xt,0,-1,2,Mt);return(Gt||Zt)&&(At=Wt(ht,1,-Xt,1+Xt,0,-1,2,Mt)||[],Gt&&(At=Rr(Gt,1).concat(At)),Zt&&(At=At.concat(Rr(Zt,-1)))),At}(_t,Ve),_t.length&&this.splitTile(_t,0,0,0),at&&(_t.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(ze,Ve,at,_t,ht,Mt,Xt){const At=[ze,Ve,at,_t],Gt=this.options,Zt=Gt.debug;for(;At.length;){_t=At.pop(),at=At.pop(),Ve=At.pop(),ze=At.pop();const Ht=1<<Ve,fn=mi(Ve,at,_t);let Nt=this.tiles[fn];if(!Nt&&(Zt>1&&console.time("creation"),Nt=this.tiles[fn]=fi(ze,Ve,at,_t,Gt),this.tileCoords.push({z:Ve,x:at,y:_t}),Zt)){Zt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Ve,at,_t,Nt.numFeatures,Nt.numPoints,Nt.numSimplified),console.timeEnd("creation"));const Wi=`z${Ve}`;this.stats[Wi]=(this.stats[Wi]||0)+1,this.total++}if(Nt.source=ze,ht==null){if(Ve===Gt.indexMaxZoom||Nt.numPoints<=Gt.indexMaxPoints)continue}else{if(Ve===Gt.maxZoom||Ve===ht)continue;if(ht!=null){const Wi=ht-Ve;if(at!==Mt>>Wi||_t!==Xt>>Wi)continue}}if(Nt.source=null,ze.length===0)continue;Zt>1&&console.time("clipping");const zt=.5*Gt.buffer/Gt.extent,yn=.5-zt,qn=.5+zt,Jn=1+zt;let ur=null,Cr=null,Or=null,Fr=null,bi=Wt(ze,Ht,at-zt,at+qn,0,Nt.minX,Nt.maxX,Gt),Mi=Wt(ze,Ht,at+yn,at+Jn,0,Nt.minX,Nt.maxX,Gt);ze=null,bi&&(ur=Wt(bi,Ht,_t-zt,_t+qn,1,Nt.minY,Nt.maxY,Gt),Cr=Wt(bi,Ht,_t+yn,_t+Jn,1,Nt.minY,Nt.maxY,Gt),bi=null),Mi&&(Or=Wt(Mi,Ht,_t-zt,_t+qn,1,Nt.minY,Nt.maxY,Gt),Fr=Wt(Mi,Ht,_t+yn,_t+Jn,1,Nt.minY,Nt.maxY,Gt),Mi=null),Zt>1&&console.timeEnd("clipping"),At.push(ur||[],Ve+1,2*at,2*_t),At.push(Cr||[],Ve+1,2*at,2*_t+1),At.push(Or||[],Ve+1,2*at+1,2*_t),At.push(Fr||[],Ve+1,2*at+1,2*_t+1)}}getTile(ze,Ve,at){ze=+ze,Ve=+Ve,at=+at;const _t=this.options,{extent:ht,debug:Mt}=_t;if(ze<0||ze>24)return null;const Xt=1<<ze,At=mi(ze,Ve=Ve+Xt&Xt-1,at);if(this.tiles[At])return Mn(this.tiles[At],ht);Mt>1&&console.log("drilling down to z%d-%d-%d",ze,Ve,at);let Gt,Zt=ze,Ht=Ve,fn=at;for(;!Gt&&Zt>0;)Zt--,Ht>>=1,fn>>=1,Gt=this.tiles[mi(Zt,Ht,fn)];return Gt&&Gt.source?(Mt>1&&(console.log("found parent tile z%d-%d-%d",Zt,Ht,fn),console.time("drilling down")),this.splitTile(Gt.source,Zt,Ht,fn,ze,Ve,at),Mt>1&&console.timeEnd("drilling down"),this.tiles[At]?Mn(this.tiles[At],ht):null):null}}function mi(Vt,ze,Ve){return 32*((1<<Vt)*Ve+ze)+Vt}function ji(Vt,ze){const Ve=Vt.tileID.canonical;if(!this._geoJSONIndex)return void ze(null,null);const at=this._geoJSONIndex.getTile(Ve.z,Ve.x,Ve.y);if(!at)return void ze(null,null);const _t=new _e(at.features);let ht=Ke(_t);ht.byteOffset===0&&ht.byteLength===ht.buffer.byteLength||(ht=new Uint8Array(ht)),ze(null,{vectorTile:_t,rawData:ht.buffer})}class ko extends H{constructor(ze,Ve,at,_t,ht,Mt){super(ze,Ve,at,_t,ji,Mt),ht&&(this.loadGeoJSON=ht),this._dynamicIndex=new ce}loadData(ze,Ve){const at=ze&&ze.request,_t=at&&at.collectResourceTiming;this.loadGeoJSON(ze,(ht,Mt)=>{if(ht||!Mt)return Ve(ht);if(typeof Mt!="object")return Ve(new Error(`Input data given to '${ze.source}' is not a valid GeoJSON object.`));{try{if(ze.filter){const At=r.M(ze.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(At.result==="error")throw new Error(At.value.map(Gt=>`${Gt.key}: ${Gt.message}`).join(", "));Mt.features=Mt.features.filter(Gt=>At.value.evaluate({zoom:0},Gt))}ze.dynamic?(Mt.type==="Feature"&&(Mt={type:"FeatureCollection",features:[Mt]}),ze.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(Mt.features,this.loaded),ze.cluster&&(Mt.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=ze.cluster?new en(function({superclusterOptions:At,clusterProperties:Gt}){if(!Gt||!At)return At;const Zt={},Ht={},fn={accumulated:null,zoom:0},Nt={properties:null},zt=Object.keys(Gt);for(const yn of zt){const[qn,Jn]=Gt[yn],ur=r.M(Jn),Cr=r.M(typeof qn=="string"?[qn,["accumulated"],["get",yn]]:qn);Zt[yn]=ur.value,Ht[yn]=Cr.value}return At.map=yn=>{Nt.properties=yn;const qn={};for(const Jn of zt)qn[Jn]=Zt[Jn].evaluate(fn,Nt);return qn},At.reduce=(yn,qn)=>{Nt.properties=qn;for(const Jn of zt)fn.accumulated=yn[Jn],yn[Jn]=Ht[Jn].evaluate(fn,Nt)},At}(ze)).load(Mt.features):ze.dynamic?this._dynamicIndex:function(At,Gt){return new Li(At,Gt)}(Mt,ze.geojsonVtOptions)}catch(At){return Ve(At)}const Xt={};if(_t){const At=C(at);At&&(Xt.resourceTiming={},Xt.resourceTiming[ze.source]=JSON.parse(JSON.stringify(At)))}Ve(null,Xt)}})}reloadTile(ze,Ve){const at=this.loaded;return at&&at[ze.uid]?ze.partial?Ve(null,void 0):super.reloadTile(ze,Ve):this.loadTile(ze,Ve)}loadGeoJSON(ze,Ve){if(ze.request)r.n(ze.request,Ve);else{if(typeof ze.data!="string")return Ve(new Error(`Input data given to '${ze.source}' is not a valid GeoJSON object.`));try{return Ve(null,JSON.parse(ze.data))}catch{return Ve(new Error(`Input data given to '${ze.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(ze,Ve){try{Ve(null,this._geoJSONIndex.getClusterExpansionZoom(ze.clusterId))}catch(at){Ve(at)}}getClusterChildren(ze,Ve){try{Ve(null,this._geoJSONIndex.getChildren(ze.clusterId))}catch(at){Ve(at)}}getClusterLeaves(ze,Ve){try{Ve(null,this._geoJSONIndex.getLeaves(ze.clusterId,ze.limit,ze.offset))}catch(at){Ve(at)}}}class qo{constructor(ze,Ve){this.tileID=new r.aA(ze.tileID.overscaledZ,ze.tileID.wrap,ze.tileID.canonical.z,ze.tileID.canonical.x,ze.tileID.canonical.y),this.tileZoom=ze.tileZoom,this.uid=ze.uid,this.zoom=ze.zoom,this.canonical=ze.tileID.canonical,this.pixelRatio=ze.pixelRatio,this.tileSize=ze.tileSize,this.source=ze.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=ze.projection,this.brightness=Ve}parse(ze,Ve,at,_t){this.status="parsing";const ht=new r.aA(at.tileID.overscaledZ,at.tileID.wrap,at.tileID.canonical.z,at.tileID.canonical.x,at.tileID.canonical.y),Mt={},Xt=Ve.familiesBySource[at.source],At=new r.dR(ht,at.promoteId);return At.bucketLayerIDs=[],At.is3DTile=!0,r.e0(ze).then(Gt=>{if(!Gt)return _t(new Error("Could not parse tile"));const Zt=r.e1(Gt,1/r.c8(at.tileID.canonical)),Ht=Gt.json.extensionsUsed&&Gt.json.extensionsUsed.includes("MAPBOX_mesh_features")||Gt.json.asset.extras&&Gt.json.asset.extras.MAPBOX_mesh_features,fn=Gt.json.extensionsUsed&&Gt.json.extensionsUsed.includes("EXT_meshopt_compression"),Nt=new r.a3(this.zoom,{brightness:this.brightness});for(const zt in Xt)for(const yn of Xt[zt]){const qn=yn[0];At.bucketLayerIDs.push(yn.map(ur=>ur.id)),qn.recalculate(Nt,[]);const Jn=new r.e2(Zt,ht,Ht,fn,this.brightness,At);Ht||(Jn.needsUpload=!0),Mt[qn.fqid]=Jn,Jn.evaluate(qn)}this.status="done",_t(null,{buckets:Mt,featureIndex:At})}).catch(Gt=>_t(new Error(Gt.message)))}}class Oo{constructor(ze,Ve,at,_t,ht,Mt){this.actor=ze,this.layerIndex=Ve,this.brightness=Mt,this.loading={},this.loaded={}}loadTile(ze,Ve){const at=ze.uid,_t=this.loading[at]=new qo(ze,this.brightness);r.bc(ze.request,(ht,Mt)=>{const Xt=!this.loading[at];return delete this.loading[at],Xt||ht?(_t.status="done",Xt||(this.loaded[at]=_t),Ve(ht)):Mt&&Mt.byteLength!==0?void _t.parse(Mt,this.layerIndex,ze,(At,Gt)=>{_t.status="done",this.loaded=this.loaded||{},this.loaded[at]=_t,At||!Gt?Ve(At):Ve(null,Gt)}):(_t.status="done",this.loaded[at]=_t,Ve())})}reloadTile(ze,Ve){const at=this.loaded,_t=ze.uid;if(at&&at[_t]){const ht=at[_t];ht.projection=ze.projection,ht.brightness=ze.brightness;const Mt=(Xt,At)=>{ht.reloadCallback&&(delete ht.reloadCallback,this.loadTile(ze,Ve)),Ve(Xt,At)};ht.status==="parsing"?ht.reloadCallback=Mt:ht.status==="done"&&this.loadTile(ze,Ve)}}abortTile(ze,Ve){const at=ze.uid;this.loading[at]&&delete this.loading[at],Ve()}removeTile(ze,Ve){const at=this.loaded,_t=ze.uid;at&&at[_t]&&delete at[_t],Ve()}}class Pn{constructor(ze){this.self=ze,this.actor=new r.e3(ze,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=r.bL({name:"mercator"}),this.workerSourceTypes={vector:H,geojson:ko,"batched-model":Oo},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(Ve,at)=>{if(this.workerSourceTypes[Ve])throw new Error(`Worker source with name "${Ve}" already registered.`);this.workerSourceTypes[Ve]=at},this.self.registerRTLTextPlugin=Ve=>{if(r.e4.isParsed())throw new Error("RTL text plugin already registered.");r.e4.applyArabicShaping=Ve.applyArabicShaping,r.e4.processBidirectionalText=Ve.processBidirectionalText,r.e4.processStyledBidirectionalText=Ve.processStyledBidirectionalText}}clearCaches(ze,Ve,at){delete this.layerIndexes[ze],delete this.availableImages[ze],delete this.workerSources[ze],delete this.demWorkerSources[ze],delete this.rasterArrayWorkerSource,at()}checkIfReady(ze,Ve,at){at()}setReferrer(ze,Ve){this.referrer=Ve}spriteLoaded(ze,{scope:Ve,isLoaded:at}){if(this.isSpriteLoaded[ze]||(this.isSpriteLoaded[ze]={}),this.isSpriteLoaded[ze][Ve]=at,this.workerSources[ze]&&this.workerSources[ze][Ve])for(const _t in this.workerSources[ze][Ve]){const ht=this.workerSources[ze][Ve][_t];for(const Mt in ht){const Xt=ht[Mt];Xt instanceof H&&(Xt.isSpriteLoaded=at,Xt.fire(new r.x("isSpriteLoaded")))}}}setImages(ze,{scope:Ve,images:at},_t){if(this.availableImages[ze]||(this.availableImages[ze]={}),this.availableImages[ze][Ve]=at,this.workerSources[ze]&&this.workerSources[ze][Ve]){for(const ht in this.workerSources[ze][Ve]){const Mt=this.workerSources[ze][Ve][ht];for(const Xt in Mt)Mt[Xt].availableImages=at}_t()}else _t()}setProjection(ze,Ve){this.projections[ze]=r.bL(Ve)}setBrightness(ze,Ve,at){this.brightness=Ve,at()}setLayers(ze,Ve,at){this.getLayerIndex(ze,Ve.scope).replace(Ve.layers,Ve.options),at()}updateLayers(ze,Ve,at){this.getLayerIndex(ze,Ve.scope).update(Ve.layers,Ve.removedIds,Ve.options),at()}loadTile(ze,Ve,at){Ve.projection=this.projections[ze]||this.defaultProjection,this.getWorkerSource(ze,Ve.type,Ve.source,Ve.scope).loadTile(Ve,at)}loadDEMTile(ze,Ve,at){this.getDEMWorkerSource(ze,Ve.source,Ve.scope).loadTile(Ve,at)}decodeRasterArray(ze,Ve,at){this.getRasterArrayWorkerSource().decodeRasterArray(Ve,at)}reloadTile(ze,Ve,at){Ve.projection=this.projections[ze]||this.defaultProjection,this.getWorkerSource(ze,Ve.type,Ve.source,Ve.scope).reloadTile(Ve,at)}abortTile(ze,Ve,at){this.getWorkerSource(ze,Ve.type,Ve.source,Ve.scope).abortTile(Ve,at)}removeTile(ze,Ve,at){this.getWorkerSource(ze,Ve.type,Ve.source,Ve.scope).removeTile(Ve,at)}removeSource(ze,Ve,at){if(!(this.workerSources[ze]&&this.workerSources[ze][Ve.scope]&&this.workerSources[ze][Ve.scope][Ve.type]&&this.workerSources[ze][Ve.scope][Ve.type][Ve.source]))return;const _t=this.workerSources[ze][Ve.scope][Ve.type][Ve.source];delete this.workerSources[ze][Ve.scope][Ve.type][Ve.source],_t.removeSource!==void 0?_t.removeSource(Ve,at):at()}loadWorkerSource(ze,Ve,at){try{this.self.importScripts(Ve.url),at()}catch(_t){at(_t.toString())}}syncRTLPluginState(ze,Ve,at){try{r.e4.setState(Ve);const _t=r.e4.getPluginURL();if(r.e4.isLoaded()&&!r.e4.isParsed()&&_t!=null){this.self.importScripts(_t);const ht=r.e4.isParsed();at(ht?void 0:new Error(`RTL Text Plugin failed to import scripts from ${_t}`),ht)}}catch(_t){at(_t.toString())}}setDracoUrl(ze,Ve){this.dracoUrl=Ve}getAvailableImages(ze,Ve){this.availableImages[ze]||(this.availableImages[ze]={});let at=this.availableImages[ze][Ve];return at||(at=[]),at}getLayerIndex(ze,Ve){this.layerIndexes[ze]||(this.layerIndexes[ze]={});let at=this.layerIndexes[ze][Ve];return at||(at=this.layerIndexes[ze][Ve]=new P,at.scope=Ve),at}getWorkerSource(ze,Ve,at,_t){return this.workerSources[ze]||(this.workerSources[ze]={}),this.workerSources[ze][_t]||(this.workerSources[ze][_t]={}),this.workerSources[ze][_t][Ve]||(this.workerSources[ze][_t][Ve]={}),this.isSpriteLoaded[ze]||(this.isSpriteLoaded[ze]={}),this.workerSources[ze][_t][Ve][at]||(this.workerSources[ze][_t][Ve][at]=new this.workerSourceTypes[Ve]({send:(ht,Mt,Xt,At,Gt,Zt)=>{this.actor.send(ht,Mt,Xt,ze,Gt,Zt)},scheduler:this.actor.scheduler},this.getLayerIndex(ze,_t),this.getAvailableImages(ze,_t),this.isSpriteLoaded[ze][_t],void 0,this.brightness)),this.workerSources[ze][_t][Ve][at]}getDEMWorkerSource(ze,Ve,at){return this.demWorkerSources[ze]||(this.demWorkerSources[ze]={}),this.demWorkerSources[ze][at]||(this.demWorkerSources[ze][at]={}),this.demWorkerSources[ze][at][Ve]||(this.demWorkerSources[ze][at][Ve]=new q),this.demWorkerSources[ze][at][Ve]}getRasterArrayWorkerSource(){return this.rasterArrayWorkerSource||(this.rasterArrayWorkerSource=new Z),this.rasterArrayWorkerSource}enforceCacheSizeLimit(ze,Ve){r.e5(Ve)}getWorkerPerformanceMetrics(ze,Ve,at){at(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Pn(self)),Pn}),f(["./shared"],function(r){var C="3.7.0";const k={create:"create",load:"load",fullLoad:"fullLoad"},I={mark(g){performance.mark(g)},measure(g,o,c){performance.measure(g,o,c)}};function P(g){const o=g.name.split("?")[0];return r.a(o)&&o.includes("mapbox-gl.js")?"javascript":r.a(o)&&o.includes("mapbox-gl.css")?"css":r.b(o)?"fontRange":r.c(o)?"sprite":r.i(o)?"style":r.d(o)?"tilejson":"other"}var D,N={},j=function(){if(D)return N;function g(y){return!o(y)}function o(y){return typeof window>"u"||typeof document>"u"?"not a browser":function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var T,A,$=new Blob([""],{type:"text/javascript"}),Y=URL.createObjectURL($);try{A=new Worker(Y),T=!0}catch{T=!1}return A&&A.terminate(),URL.revokeObjectURL(Y),T}()?function(){var T=document.createElement("canvas");T.width=T.height=1;var A=T.getContext("2d");if(!A)return!1;var $=A.getImageData(0,0,1,1);return $&&$.width===T.width}()?(c[S=y&&y.failIfMajorPerformanceCaveat]===void 0&&(c[S]=function(T){var A,$=function(Y){var ee=document.createElement("canvas"),te=Object.create(g.webGLContextAttributes);return te.failIfMajorPerformanceCaveat=Y,ee.getContext("webgl2",te)}(T);if(!$)return!1;try{A=$.createShader($.VERTEX_SHADER)}catch{return!1}return!(!A||$.isContextLost())&&($.shaderSource(A,"void main() {}"),$.compileShader(A),$.getShaderParameter(A,$.COMPILE_STATUS)===!0)}(S)),c[S]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var S}D=1,N.supported=g,N.notSupportedReason=o;var c={};return g.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0},N}();function W(g,o,c){const y=document.createElement(g);return o!=null&&(y.className=o),c&&c.appendChild(y),y}function H(g,o,c){const y=document.createElementNS("http://www.w3.org/2000/svg",g);for(const S of Object.keys(o))y.setAttributeNS(null,S,String(o[S]));return c&&c.appendChild(y),y}const q=typeof document<"u"?document.documentElement&&document.documentElement.style:null,Z=q&&q.userSelect!==void 0?"userSelect":"WebkitUserSelect";let re;function le(){q&&Z&&(re=q[Z],q[Z]="none")}function _e(){q&&Z&&(q[Z]=re)}function ye(g){g.preventDefault(),g.stopPropagation(),window.removeEventListener("click",ye,!0)}function de(){window.addEventListener("click",ye,!0),window.setTimeout(()=>{window.removeEventListener("click",ye,!0)},0)}function ce(g,o){const c=g.getBoundingClientRect();return he(g,c,o)}function oe(g,o){const c=g.getBoundingClientRect(),y=[];for(let S=0;S<o.length;S++)y.push(he(g,c,o[S]));return y}function xe(g){return window.InstallTrigger!==void 0&&g.button===2&&g.ctrlKey&&window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:g.button}function he(g,o,c){const y=g.offsetWidth===o.width?1:g.offsetWidth/o.width;return new r.P((c.clientX-o.left)*y,(c.clientY-o.top)*y)}const Ee="01",se="NO_ACCESS_TOKEN";class we{constructor(o,c,y){this._transformRequestFn=o,this._customAccessToken=c,this._silenceAuthErrors=!!y,this._createSkuToken()}_createSkuToken(){const o=function(){let c="";for(let y=0;y<10;y++)c+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Ee,c].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=o.token,this._skuTokenExpiresAt=o.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(o,c){return this._transformRequestFn&&this._transformRequestFn(o,c)||{url:o}}normalizeStyleURL(o,c){if(!r.f(o))return o;const y=Pe(o);return y.params.push(`sdk=js-${C}`),y.path=`/styles/v1${y.path}`,this._makeAPIURL(y,this._customAccessToken||c)}normalizeGlyphsURL(o,c){if(!r.f(o))return o;const y=Pe(o);return y.path=`/fonts/v1${y.path}`,this._makeAPIURL(y,this._customAccessToken||c)}normalizeModelURL(o,c){if(!r.f(o))return o;const y=Pe(o);return y.path=`/models/v1${y.path}`,this._makeAPIURL(y,this._customAccessToken||c)}normalizeSourceURL(o,c,y,S){if(!r.f(o))return o;const T=Pe(o);return T.path=`/v4/${T.authority}.json`,T.params.push("secure"),y&&T.params.push(`language=${y}`),S&&T.params.push(`worldview=${S}`),this._makeAPIURL(T,this._customAccessToken||c)}normalizeSpriteURL(o,c,y,S){const T=Pe(o);return r.f(o)?(T.path=`/styles/v1${T.path}/sprite${c}${y}`,this._makeAPIURL(T,this._customAccessToken||S)):(T.path+=`${c}${y}`,Me(T))}normalizeTileURL(o,c,y){if(this._isSkuTokenExpired()&&this._createSkuToken(),o&&!r.f(o))return o;const S=Pe(o);S.path=S.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${c||y&&S.authority!=="raster"&&y===512?"@2x":""}${r.m.supported?".webp":"$1"}`),S.authority==="raster"?S.path=`/${r.e.RASTER_URL_PREFIX}${S.path}`:S.authority==="rasterarrays"?S.path=`/${r.e.RASTERARRAYS_URL_PREFIX}${S.path}`:S.authority==="3dtiles"?S.path=`/${r.e.TILES3D_URL_PREFIX}${S.path}`:(S.path=S.path.replace(/^.+\/v4\//,"/"),S.path=`/${r.e.TILE_URL_VERSION}${S.path}`);const T=this._customAccessToken||function(A){for(const $ of A){const Y=$.match(/^access_token=(.*)$/);if(Y)return Y[1]}return null}(S.params)||r.e.ACCESS_TOKEN;return r.e.REQUIRE_ACCESS_TOKEN&&T&&this._skuToken&&S.params.push(`sku=${this._skuToken}`),this._makeAPIURL(S,T)}canonicalizeTileURL(o,c){const y=Pe(o);if(!y.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!y.path.match(/\.[\w]+$/))return o;let S="mapbox://";y.path.match(/^\/raster\/v1\//)?S+=`raster/${y.path.replace(`/${r.e.RASTER_URL_PREFIX}/`,"")}`:y.path.match(/^\/rasterarrays\/v1\//)?S+=`rasterarrays/${y.path.replace(`/${r.e.RASTERARRAYS_URL_PREFIX}/`,"")}`:S+=`tiles/${y.path.replace(`/${r.e.TILE_URL_VERSION}/`,"")}`;let T=y.params;return c&&(T=T.filter(A=>!A.match(/^access_token=/))),T.length&&(S+=`?${T.join("&")}`),S}canonicalizeTileset(o,c){const y=!!c&&r.f(c),S=[];for(const T of o.tiles||[])r.h(T)?S.push(this.canonicalizeTileURL(T,y)):S.push(T);return S}_makeAPIURL(o,c){const y="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",S=Pe(r.e.API_URL);if(o.protocol=S.protocol,o.authority=S.authority,o.protocol==="http"){const T=o.params.indexOf("secure");T>=0&&o.params.splice(T,1)}if(S.path!=="/"&&(o.path=`${S.path}${o.path}`),!r.e.REQUIRE_ACCESS_TOKEN)return Me(o);if(c=c||r.e.ACCESS_TOKEN,!this._silenceAuthErrors){if(!c)throw new Error(`An API access token is required to use Mapbox GL. ${y}`);if(c[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${y}`)}return o.params=o.params.filter(T=>T.indexOf("access_token")===-1),o.params.push(`access_token=${c||""}`),Me(o)}}const Se=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Pe(g){const o=g.match(Se);if(!o)throw new Error("Unable to parse URL object");return{protocol:o[1],authority:o[2],path:o[3]||"/",params:o[4]?o[4].split("&"):[]}}function Me(g){const o=g.params.length?`?${g.params.join("&")}`:"";return`${g.protocol}://${g.authority}${g.path}${o}`}const Re="mapbox.eventData";function Oe(g){if(!g)return null;const o=g.split(".");if(!o||o.length!==3)return null;try{return JSON.parse(r.j(o[1]))}catch{return null}}class $e{constructor(o){this.type=o,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(o){const c=Oe(r.e.ACCESS_TOKEN);let y="";return y=c&&c.u?r.k(c.u):r.e.ACCESS_TOKEN||"",o?`${Re}.${o}:${y}`:`${Re}:${y}`}fetchEventData(){const o=r.s("localStorage"),c=this.getStorageKey(),y=this.getStorageKey("uuid");if(o)try{const S=localStorage.getItem(c);S&&(this.eventData=JSON.parse(S));const T=localStorage.getItem(y);T&&(this.anonId=T)}catch{r.w("Unable to read from LocalStorage")}}saveEventData(){const o=r.s("localStorage"),c=this.getStorageKey(),y=this.getStorageKey("uuid"),S=this.anonId;if(o&&S)try{localStorage.setItem(y,S),Object.keys(this.eventData).length>=1&&localStorage.setItem(c,JSON.stringify(this.eventData))}catch{r.w("Unable to write to LocalStorage")}}processRequests(o){}postEvent(o,c,y,S){if(!r.e.EVENTS_URL)return;const T=Pe(r.e.EVENTS_URL);T.params.push(`access_token=${S||r.e.ACCESS_TOKEN||""}`);const A={event:this.type,created:new Date(o).toISOString()},$=c?r.l(A,c):A,Y={url:Me(T),headers:{"Content-Type":"text/plain"},body:JSON.stringify([$])};this.pendingRequest=r.p(Y,ee=>{this.pendingRequest=null,y(ee),this.saveEventData(),this.processRequests(S)})}queueRequest(o,c){this.queue.push(o),this.processRequests(c)}}const Ke=new class extends $e{constructor(g){super("appUserTurnstile"),this._customAccessToken=g}postTurnstileEvent(g,o){r.e.EVENTS_URL&&r.e.ACCESS_TOKEN&&Array.isArray(g)&&g.some(c=>r.f(c)||r.h(c))&&this.queueRequest(Date.now(),o)}processRequests(g){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const o=Oe(r.e.ACCESS_TOKEN),c=o?o.u:r.e.ACCESS_TOKEN;let y=c!==this.eventData.tokenU;r.v(this.anonId)||(this.anonId=r.u(),y=!0);const S=this.queue.shift();if(this.eventData.lastSuccess){const T=new Date(this.eventData.lastSuccess),A=new Date(S),$=(S-this.eventData.lastSuccess)/864e5;y=y||$>=1||$<-1||T.getDate()!==A.getDate()}else y=!0;y?this.postEvent(S,{sdkIdentifier:"mapbox-gl-js",sdkVersion:C,skuId:Ee,"enabled.telemetry":!1,userId:this.anonId},T=>{T||(this.eventData.lastSuccess=S,this.eventData.tokenU=c)},g):this.processRequests()}},Ct=Ke.postTurnstileEvent.bind(Ke),Ue=new class extends $e{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(g,o,c,y){this.skuToken=o,this.errorCb=y,r.e.EVENTS_URL&&(c||r.e.ACCESS_TOKEN?this.queueRequest({id:g,timestamp:Date.now()},c):this.errorCb(new Error(se)))}processRequests(g){if(this.pendingRequest||this.queue.length===0)return;const{id:o,timestamp:c}=this.queue.shift();o&&this.success[o]||(this.anonId||this.fetchEventData(),r.v(this.anonId)||(this.anonId=r.u()),this.postEvent(c,{sdkIdentifier:"mapbox-gl-js",sdkVersion:C,skuId:Ee,skuToken:this.skuToken,userId:this.anonId},y=>{y?this.errorCb(y):o&&(this.success[o]=!0)},g))}remove(){this.errorCb=null}},ft=Ue.postMapLoadEvent.bind(Ue),Bt=new class extends $e{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(g){let o=this.mapInstanceIdMap.get(g);return o||(o=r.u(),this.mapInstanceIdMap.set(g,o)),o}getEventId(g){const o=this.eventIdPerMapInstanceMap.get(g)||0;return this.eventIdPerMapInstanceMap.set(g,o+1),o}postStyleLoadEvent(g,o){const{map:c,style:y,importedStyles:S}=o;if(!r.e.EVENTS_URL||!g&&!r.e.ACCESS_TOKEN)return;const T=this.getMapInstanceId(c),A={mapInstanceId:T,eventId:this.getEventId(T),style:y};S.length&&(A.importedStyles=S),this.queueRequest({timestamp:Date.now(),payload:A},g)}processRequests(g){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:o,payload:c}=this.queue.shift();this.postEvent(o,c,()=>{},g)}},hn=Bt.postStyleLoadEvent.bind(Bt),ot=new class extends $e{constructor(){super("gljs.performance")}postPerformanceEvent(g,o){r.e.EVENTS_URL&&(g||r.e.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:o},g)}processRequests(g){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:o,performanceData:c}=this.queue.shift(),y=function(S){const T=performance.getEntriesByType("resource"),A=performance.getEntriesByType("mark"),$=function(me){const ke={};if(me){for(const Le in me)if(Le!=="other")for(const De of me[Le]){const Fe=`${Le}ResolveRangeMin`,Ye=`${Le}ResolveRangeMax`,Je=`${Le}RequestCount`,qe=`${Le}RequestCachedCount`;ke[Fe]=Math.min(ke[Fe]||1/0,De.startTime),ke[Ye]=Math.max(ke[Ye]||-1/0,De.responseEnd);const it=rt=>{ke[rt]===void 0&&(ke[rt]=0),++ke[rt]};De.transferSize!==void 0&&De.transferSize===0&&it(qe),it(Je)}}return ke}(function(me,ke){const Le={};if(me)for(const De of me){const Fe=ke(De);Le[Fe]===void 0&&(Le[Fe]=[]),Le[Fe].push(De)}return Le}(T,P)),Y=window.devicePixelRatio,ee=navigator.connection||navigator.mozConnection||navigator.webkitConnection,te=ee?ee.effectiveType:void 0,ue={counters:[],metadata:[],attributes:[]},fe=(me,ke,Le)=>{Le!=null&&me.push({name:ke,value:Le.toString()})};for(const me in $)fe(ue.counters,me,$[me]);if(S.interactionRange[0]!==1/0&&S.interactionRange[1]!==-1/0&&(fe(ue.counters,"interactionRangeMin",S.interactionRange[0]),fe(ue.counters,"interactionRangeMax",S.interactionRange[1])),A)for(const me of Object.keys(k)){const ke=k[me],Le=A.find(De=>De.name===ke);Le&&fe(ue.counters,ke,Le.startTime)}return fe(ue.counters,"visibilityHidden",S.visibilityHidden),fe(ue.attributes,"style",function(me){if(me)for(const ke of me){const Le=ke.name.split("?")[0];if(r.i(Le)){const De=Le.split("/").slice(-2);if(De.length===2)return`mapbox://styles/${De[0]}/${De[1]}`}}}(T)),fe(ue.attributes,"terrainEnabled",S.terrainEnabled?"true":"false"),fe(ue.attributes,"fogEnabled",S.fogEnabled?"true":"false"),fe(ue.attributes,"projection",S.projection),fe(ue.attributes,"zoom",S.zoom),fe(ue.metadata,"devicePixelRatio",Y),fe(ue.metadata,"connectionEffectiveType",te),fe(ue.metadata,"navigatorUserAgent",navigator.userAgent),fe(ue.metadata,"screenWidth",window.screen.width),fe(ue.metadata,"screenHeight",window.screen.height),fe(ue.metadata,"windowWidth",window.innerWidth),fe(ue.metadata,"windowHeight",window.innerHeight),fe(ue.metadata,"mapWidth",S.width/Y),fe(ue.metadata,"mapHeight",S.height/Y),fe(ue.metadata,"webglRenderer",S.renderer),fe(ue.metadata,"webglVendor",S.vendor),fe(ue.metadata,"sdkVersion",C),fe(ue.metadata,"sdkIdentifier","mapbox-gl-js"),ue}(c);for(const S of y.metadata);for(const S of y.counters);for(const S of y.attributes);this.postEvent(o,y,()=>{},g)}},en=ot.postPerformanceEvent.bind(ot),wt=new class extends $e{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(g,o,c,y){if(!r.e.API_URL||!r.e.SESSION_PATH)return;const S=Pe(r.e.API_URL+r.e.SESSION_PATH);S.params.push(`sku=${o||""}`),S.params.push(`access_token=${y||r.e.ACCESS_TOKEN||""}`);const T={url:Me(S),headers:{"Content-Type":"text/plain"}};this.pendingRequest=r.g(T,A=>{this.pendingRequest=null,c(A),this.saveEventData(),this.processRequests(y)})}getSessionAPI(g,o,c,y){this.skuToken=o,this.errorCb=y,r.e.SESSION_PATH&&r.e.API_URL&&(c||r.e.ACCESS_TOKEN?this.queueRequest({id:g,timestamp:Date.now()},c):this.errorCb(new Error(se)))}processRequests(g){if(this.pendingRequest||this.queue.length===0)return;const{id:o,timestamp:c}=this.queue.shift();o&&this.success[o]||this.getSession(c,this.skuToken,y=>{y?this.errorCb(y):o&&(this.success[o]=!0)},g)}remove(){this.errorCb=null}},Ne=wt.getSessionAPI.bind(wt),We=new Set;function Sn(g,o){o?We.add(g):We.delete(g)}class Ae{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages=new Set}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(o,c){this._updatedSourceCaches[o]=c,this.setDirty()}discardSourceCacheUpdate(o){delete this._updatedSourceCaches[o]}updateLayer(o){const c=o.scope;this._updatedLayers[c]=this._updatedLayers[c]||new Set,this._updatedLayers[c].add(o.id),this.setDirty()}removeLayer(o){const c=o.scope;this._removedLayers[c]=this._removedLayers[c]||{},this._updatedLayers[c]=this._updatedLayers[c]||new Set,this._removedLayers[c][o.id]=o,this._updatedLayers[c].delete(o.id),this._updatedPaintProps.delete(o.fqid),this.setDirty()}getRemovedLayer(o){return this._removedLayers[o.scope]?this._removedLayers[o.scope][o.id]:null}discardLayerRemoval(o){this._removedLayers[o.scope]&&delete this._removedLayers[o.scope][o.id]}getLayerUpdatesByScope(){const o={};for(const c in this._updatedLayers)o[c]=o[c]||{},o[c].updatedIds=Array.from(this._updatedLayers[c].values());for(const c in this._removedLayers)o[c]=o[c]||{},o[c].removedIds=Object.keys(this._removedLayers[c]);return o}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(o){this._updatedPaintProps.add(o.fqid),this.setDirty()}getUpdatedImages(){return Array.from(this._updatedImages.values())}updateImage(o){this._updatedImages.add(o),this.setDirty()}resetUpdatedImages(){this._updatedImages.clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages.clear()}}function st(g){const{userImage:o}=g;return!!(o&&o.render&&o.render())&&(g.data.replace(new Uint8Array(o.data.buffer)),!0)}class gt extends r.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.atlasImage={},this.atlasTexture={},this.dirty=!0}createScope(o){this.images[o]={},this.loaded[o]=!1,this.updatedImages[o]={},this.patterns[o]={},this.callbackDispatchedThisFrame[o]={},this.atlasImage[o]=new r.r({width:1,height:1})}isLoaded(){for(const o in this.loaded)if(!this.loaded[o])return!1;return!0}setLoaded(o,c){if(this.loaded[c]!==o&&(this.loaded[c]=o,o)){for(const{ids:y,callback:S}of this.requestors)this._notify(y,c,S);this.requestors=[]}}hasImage(o,c){return!!this.getImage(o,c)}getImage(o,c){return this.images[c][o]}addImage(o,c,y){this._validate(o,y)&&(this.images[c][o]=y)}_validate(o,c){let y=!0;return this._validateStretch(c.stretchX,c.data&&c.data.width)||(this.fire(new r.t(new Error(`Image "${o}" has invalid "stretchX" value`))),y=!1),this._validateStretch(c.stretchY,c.data&&c.data.height)||(this.fire(new r.t(new Error(`Image "${o}" has invalid "stretchY" value`))),y=!1),this._validateContent(c.content,c)||(this.fire(new r.t(new Error(`Image "${o}" has invalid "content" value`))),y=!1),y}_validateStretch(o,c){if(!o)return!0;let y=0;for(const S of o){if(S[0]<y||S[1]<S[0]||c<S[1])return!1;y=S[1]}return!0}_validateContent(o,c){return!(o&&(o.length!==4||o[0]<0||c.data.width<o[0]||o[1]<0||c.data.height<o[1]||o[2]<0||c.data.width<o[2]||o[3]<0||c.data.height<o[3]||o[2]<o[0]||o[3]<o[1]))}updateImage(o,c,y){y.version=this.images[c][o].version+1,this.images[c][o]=y,this.updatedImages[c][o]=!0}removeImage(o,c){const y=this.images[c][o];delete this.images[c][o],delete this.patterns[c][o],y.userImage&&y.userImage.onRemove&&y.userImage.onRemove()}listImages(o){return Object.keys(this.images[o])}getImages(o,c,y){let S=!0;const T=!!this.loaded[c];if(!T)for(const A of o)this.images[c][A]||(S=!1);T||S?this._notify(o,c,y):this.requestors.push({ids:o,scope:c,callback:y})}getUpdatedImages(o){return this.updatedImages[o]}_notify(o,c,y){const S={};for(const T of o){this.images[c][T]||this.fire(new r.x("styleimagemissing",{id:T}));const A=this.images[c][T];A?S[T]={data:A.data.clone(),pixelRatio:A.pixelRatio,sdf:A.sdf,version:A.version,stretchX:A.stretchX,stretchY:A.stretchY,content:A.content,hasRenderCallback:!!(A.userImage&&A.userImage.render)}:r.w(`Image "${T}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}y(null,S)}getPixelSize(o){const{width:c,height:y}=this.atlasImage[o];return{width:c,height:y}}getPattern(o,c,y){const S=this.patterns[c][o],T=this.getImage(o,c);if(!T)return null;if(S&&S.position.version===T.version)return S.position;if(S)S.position.version=T.version;else{const A={w:T.data.width+2*r.y,h:T.data.height+2*r.y,x:0,y:0},$=new r.I(A,T,r.y);this.patterns[c][o]={bin:A,position:$}}return this._updatePatternAtlas(c,y),this.patterns[c][o].position}bind(o,c){const y=o.gl;let S=this.atlasTexture[c];S?this.dirty&&(S.update(this.atlasImage[c]),this.dirty=!1):(S=new r.T(o,this.atlasImage[c],y.RGBA8),this.atlasTexture[c]=S),S.bind(y.LINEAR,y.CLAMP_TO_EDGE)}_updatePatternAtlas(o,c){const y=[];for(const $ in this.patterns[o])y.push(this.patterns[o][$].bin);const{w:S,h:T}=r.z(y),A=this.atlasImage[o];A.resize({width:S||1,height:T||1});for(const $ in this.patterns[o]){const{bin:Y,position:ee}=this.patterns[o][$];let te=ee.padding;const ue=Y.x+te,fe=Y.y+te,me=this.images[o][$].data,ke=me.width,Le=me.height;te=te>1?te-1:te,r.r.copy(me,A,{x:0,y:0},{x:ue,y:fe},{width:ke,height:Le},c),r.r.copy(me,A,{x:0,y:Le-te},{x:ue,y:fe-te},{width:ke,height:te},c),r.r.copy(me,A,{x:0,y:0},{x:ue,y:fe+Le},{width:ke,height:te},c),r.r.copy(me,A,{x:ke-te,y:0},{x:ue-te,y:fe},{width:te,height:Le},c),r.r.copy(me,A,{x:0,y:0},{x:ue+ke,y:fe},{width:te,height:Le},c),r.r.copy(me,A,{x:ke-te,y:Le-te},{x:ue-te,y:fe-te},{width:te,height:te},c),r.r.copy(me,A,{x:0,y:Le-te},{x:ue+ke,y:fe-te},{width:te,height:te},c),r.r.copy(me,A,{x:0,y:0},{x:ue+ke,y:fe+Le},{width:te,height:te},c),r.r.copy(me,A,{x:ke-te,y:0},{x:ue-te,y:fe+Le},{width:te,height:te},c)}this.dirty=!0}beginFrame(){for(const o in this.images)this.callbackDispatchedThisFrame[o]={}}dispatchRenderCallbacks(o,c){for(const y of o){if(this.callbackDispatchedThisFrame[c][y])continue;this.callbackDispatchedThisFrame[c][y]=!0;const S=this.images[c][y];st(S)&&this.updateImage(y,c,S)}}}function ut(g){const o=g.key,c=g.value,y=g.valueSpec||{},S=g.objectElementValidators||{},T=g.style,A=g.styleSpec;let $=[];const Y=r.B(c);if(Y!=="object")return[new r.V(o,c,`object expected, ${Y} found`)];for(const ee in c){const te=ee.split(".")[0];let ue;S[te]?ue=S[te]:y[te]?ue=vr:S["*"]?ue=S["*"]:y["*"]&&(ue=vr),ue?$=$.concat(ue({key:(o&&`${o}.`)+ee,value:c[ee],valueSpec:y[te]||y["*"],style:T,styleSpec:A,object:c,objectKey:ee},c)):$.push(new r.A(o,c[ee],`unknown property "${ee}"`))}for(const ee in y)S[ee]||y[ee].required&&y[ee].default===void 0&&c[ee]===void 0&&$.push(new r.V(o,c,`missing required property "${ee}"`));return $}function tt(g){const o=g.value,c=g.valueSpec,y=g.style,S=g.styleSpec,T=g.key,A=g.arrayElementValidator||vr;if(r.B(o)!=="array")return[new r.V(T,o,`array expected, ${r.B(o)} found`)];if(c.length&&o.length!==c.length)return[new r.V(T,o,`array length ${c.length} expected, length ${o.length} found`)];if(c["min-length"]&&o.length<c["min-length"])return[new r.V(T,o,`array length at least ${c["min-length"]} expected, length ${o.length} found`)];let $={type:c.value,values:c.values,minimum:c.minimum,maximum:c.maximum,function:void 0};S.$version<7&&($.function=c.function),r.B(c.value)==="object"&&($=c.value);let Y=[];for(let ee=0;ee<o.length;ee++)Y=Y.concat(A({array:o,arrayIndex:ee,value:o[ee],valueSpec:$,style:y,styleSpec:S,key:`${T}[${ee}]`},!0));return Y}function nt(g){const o=g.key,c=g.value,y=g.valueSpec;let S=r.B(c);if(S==="number"&&c!=c&&(S="NaN"),S!=="number")return[new r.V(o,c,`number expected, ${S} found`)];if("minimum"in y){let T=y.minimum;if(r.B(y.minimum)==="array"&&(T=y.minimum[g.arrayIndex]),c<T)return[new r.V(o,c,`${c} is less than the minimum value ${T}`)]}if("maximum"in y){let T=y.maximum;if(r.B(y.maximum)==="array"&&(T=y.maximum[g.arrayIndex]),c>T)return[new r.V(o,c,`${c} is greater than the maximum value ${T}`)]}return[]}function tn(g){const o=g.valueSpec,c=r.D(g.value.type);let y,S,T,A={};const $=c!=="categorical"&&g.value.property===void 0,Y=!$,ee=r.B(g.value.stops)==="array"&&r.B(g.value.stops[0])==="array"&&r.B(g.value.stops[0][0])==="object",te=ut({key:g.key,value:g.value,valueSpec:g.styleSpec.function,style:g.style,styleSpec:g.styleSpec,objectElementValidators:{stops:function(me){if(c==="identity")return[new r.V(me.key,me.value,'identity function may not have a "stops" property')];let ke=[];const Le=me.value;return ke=ke.concat(tt({key:me.key,value:Le,valueSpec:me.valueSpec,style:me.style,styleSpec:me.styleSpec,arrayElementValidator:ue})),r.B(Le)==="array"&&Le.length===0&&ke.push(new r.V(me.key,Le,"array must have at least one stop")),ke},default:function(me){return vr({key:me.key,value:me.value,valueSpec:o,style:me.style,styleSpec:me.styleSpec})}}});return c==="identity"&&$&&te.push(new r.V(g.key,g.value,'missing required property "property"')),c==="identity"||g.value.stops||te.push(new r.V(g.key,g.value,'missing required property "stops"')),c==="exponential"&&g.valueSpec.expression&&!r.F(g.valueSpec)&&te.push(new r.V(g.key,g.value,"exponential functions not supported")),g.styleSpec.$version>=8&&(Y&&!r.G(g.valueSpec)?te.push(new r.V(g.key,g.value,"property functions not supported")):$&&!r.H(g.valueSpec)&&te.push(new r.V(g.key,g.value,"zoom functions not supported"))),c!=="categorical"&&!ee||g.value.property!==void 0||te.push(new r.V(g.key,g.value,'"property" property is required')),te;function ue(me){let ke=[];const Le=me.value,De=me.key;if(r.B(Le)!=="array")return[new r.V(De,Le,`array expected, ${r.B(Le)} found`)];if(Le.length!==2)return[new r.V(De,Le,`array length 2 expected, length ${Le.length} found`)];if(ee){if(r.B(Le[0])!=="object")return[new r.V(De,Le,`object expected, ${r.B(Le[0])} found`)];if(Le[0].zoom===void 0)return[new r.V(De,Le,"object stop key must have zoom")];if(Le[0].value===void 0)return[new r.V(De,Le,"object stop key must have value")];const Fe=r.D(Le[0].zoom);if(typeof Fe!="number")return[new r.V(De,Le[0].zoom,"stop zoom values must be numbers")];if(T&&T>Fe)return[new r.V(De,Le[0].zoom,"stop zoom values must appear in ascending order")];Fe!==T&&(T=Fe,S=void 0,A={}),ke=ke.concat(ut({key:`${De}[0]`,value:Le[0],valueSpec:{zoom:{}},style:me.style,styleSpec:me.styleSpec,objectElementValidators:{zoom:nt,value:fe}}))}else ke=ke.concat(fe({key:`${De}[0]`,value:Le[0],valueSpec:{},style:me.style,styleSpec:me.styleSpec},Le));return r.J(r.K(Le[1]))?ke.concat([new r.V(`${De}[1]`,Le[1],"expressions are not allowed in function stops.")]):ke.concat(vr({key:`${De}[1]`,value:Le[1],valueSpec:o,style:me.style,styleSpec:me.styleSpec}))}function fe(me,ke){const Le=r.B(me.value),De=r.D(me.value),Fe=me.value!==null?me.value:ke;if(y){if(Le!==y)return[new r.V(me.key,Fe,`${Le} stop domain type must match previous stop domain type ${y}`)]}else y=Le;if(Le!=="number"&&Le!=="string"&&Le!=="boolean"&&typeof De!="number"&&typeof De!="string"&&typeof De!="boolean")return[new r.V(me.key,Fe,"stop domain value must be a number, string, or boolean")];if(Le!=="number"&&c!=="categorical"){let Ye=`number expected, ${Le} found`;return r.G(o)&&c===void 0&&(Ye+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new r.V(me.key,Fe,Ye)]}return c!=="categorical"||Le!=="number"||typeof De=="number"&&isFinite(De)&&Math.floor(De)===De?c!=="categorical"&&Le==="number"&&typeof De=="number"&&typeof S=="number"&&S!==void 0&&De<S?[new r.V(me.key,Fe,"stop domain values must appear in ascending order")]:(S=De,c==="categorical"&&De in A?[new r.V(me.key,Fe,"stop domain values must be unique")]:(A[De]=!0,[])):[new r.V(me.key,Fe,`integer expected, found ${String(De)}`)]}}function un(g){const o=(g.expressionContext==="property"?r.L:r.M)(r.K(g.value),g.valueSpec);if(o.result==="error")return o.value.map(y=>new r.V(`${g.key}${y.key}`,g.value,y.message));const c=o.value.expression||o.value._styleExpression.expression;if(g.expressionContext==="property"&&g.propertyKey==="text-font"&&!c.outputDefined())return[new r.V(g.key,g.value,`Invalid data expression for "${g.propertyKey}". Output values must be contained as literals within the expression.`)];if(g.expressionContext==="property"&&g.propertyType==="layout"&&!r.N(c))return[new r.V(g.key,g.value,'"feature-state" data expressions are not supported with layout properties.')];if(g.expressionContext==="filter")return qt(c,g);if(g.expressionContext&&g.expressionContext.indexOf("cluster")===0){if(!r.O(c,["zoom","feature-state"]))return[new r.V(g.key,g.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(g.expressionContext==="cluster-initial"&&!r.Q(c))return[new r.V(g.key,g.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function qt(g,o){const c=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(o.valueSpec&&o.valueSpec.expression)for(const S of o.valueSpec.expression.parameters)c.delete(S);if(c.size===0)return[];const y=[];return g instanceof r.S&&c.has(g.name)?[new r.V(o.key,o.value,`["${g.name}"] expression is not supported in a filter for a ${o.object.type} layer with id: ${o.object.id}`)]:(g.eachChild(S=>{y.push(...qt(S,o))}),y)}function an(g){const o=g.key,c=g.value,y=g.valueSpec,S=[];return Array.isArray(y.values)?y.values.indexOf(r.D(c))===-1&&S.push(new r.V(o,c,`expected one of [${y.values.join(", ")}], ${JSON.stringify(c)} found`)):Object.keys(y.values).indexOf(r.D(c))===-1&&S.push(new r.V(o,c,`expected one of [${Object.keys(y.values).join(", ")}], ${JSON.stringify(c)} found`)),S}function Jt(g){return r.W(r.K(g.value))?un(r.C({},g,{expressionContext:"filter",valueSpec:g.styleSpec[`filter_${g.layerType||"fill"}`]})):Wt(g)}function Wt(g){const o=g.value,c=g.key;if(r.B(o)!=="array")return[new r.V(c,o,`array expected, ${r.B(o)} found`)];const y=g.styleSpec;let S,T=[];if(o.length<1)return[new r.V(c,o,"filter array must have at least 1 element")];switch(T=T.concat(an({key:`${c}[0]`,value:o[0],valueSpec:y.filter_operator,style:g.style,styleSpec:g.styleSpec})),r.D(o[0])){case"<":case"<=":case">":case">=":o.length>=2&&r.D(o[1])==="$type"&&T.push(new r.V(c,o,`"$type" cannot be use with operator "${o[0]}"`));case"==":case"!=":o.length!==3&&T.push(new r.V(c,o,`filter array for operator "${o[0]}" must have 3 elements`));case"in":case"!in":o.length>=2&&(S=r.B(o[1]),S!=="string"&&T.push(new r.V(`${c}[1]`,o[1],`string expected, ${S} found`)));for(let A=2;A<o.length;A++)S=r.B(o[A]),r.D(o[1])==="$type"?T=T.concat(an({key:`${c}[${A}]`,value:o[A],valueSpec:y.geometry_type,style:g.style,styleSpec:g.styleSpec})):S!=="string"&&S!=="number"&&S!=="boolean"&&T.push(new r.V(`${c}[${A}]`,o[A],`string, number, or boolean expected, ${S} found`));break;case"any":case"all":case"none":for(let A=1;A<o.length;A++)T=T.concat(Wt({key:`${c}[${A}]`,value:o[A],style:g.style,styleSpec:g.styleSpec}));break;case"has":case"!has":S=r.B(o[1]),o.length!==2?T.push(new r.V(c,o,`filter array for "${o[0]}" operator must have 2 elements`)):S!=="string"&&T.push(new r.V(`${c}[1]`,o[1],`string expected, ${S} found`))}return T}function Fn(g,o){const c=g.key,y=g.style,S=g.layer,T=g.styleSpec,A=g.value,$=g.objectKey,Y=T[`${o}_${g.layerType}`];if(!Y)return[];const ee=$.match(/^(.*)-transition$/);if(o==="paint"&&ee&&Y[ee[1]]&&Y[ee[1]].transition)return vr({key:c,value:A,valueSpec:T.transition,style:y,styleSpec:T});const te=g.valueSpec||Y[$];if(!te)return[new r.A(c,A,`unknown property "${$}"`)];let ue;if(r.B(A)==="string"&&r.G(te)&&!te.tokens&&(ue=/^{([^}]+)}$/.exec(A))){const me=`\`{ "type": "identity", "property": ${ue?JSON.stringify(ue[1]):'"_"'} }\``;return[new r.V(c,A,`"${$}" does not support interpolation syntax
Use an identity property function instead: ${me}.`)]}const fe=[];if(g.layerType==="symbol")$!=="text-field"||!y||y.glyphs||y.imports||fe.push(new r.V(c,A,'use of "text-field" requires a style "glyphs" property')),$==="text-font"&&r.X(r.K(A))&&r.D(A.type)==="identity"&&fe.push(new r.V(c,A,'"text-font" does not support identity functions'));else if(g.layerType==="model"&&o==="paint"&&S&&S.layout&&S.layout.hasOwnProperty("model-id")&&r.G(te)&&(r.Y(te)||r.H(te))){const me=r.L(r.K(A),te),ke=me.value.expression||me.value._styleExpression.expression;ke&&!r.O(ke,["measure-light"])&&($==="model-emissive-strength"&&r.Q(ke)&&r.N(ke)||fe.push(new r.V(c,A,`${$} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return fe.concat(vr({key:g.key,value:A,valueSpec:te,style:y,styleSpec:T,expressionContext:"property",propertyType:o,propertyKey:$}))}function ar(g){return Fn(g,"paint")}function bn(g){return Fn(g,"layout")}function lr(g){let o=[];const c=g.value,y=g.key,S=g.style,T=g.styleSpec;c.type||c.ref||o.push(new r.V(y,c,'either "type" or "ref" is required'));let A=r.D(c.type);const $=r.D(c.ref);if(c.id){const Y=r.D(c.id);for(let ee=0;ee<g.arrayIndex;ee++){const te=S.layers[ee];r.D(te.id)===Y&&o.push(new r.V(y,c.id,`duplicate layer id "${c.id}", previously used at line ${te.id.__line__}`))}}if("ref"in c){let Y;["type","source","source-layer","filter","layout"].forEach(ee=>{ee in c&&o.push(new r.V(y,c[ee],`"${ee}" is prohibited for ref layers`))}),S.layers.forEach(ee=>{r.D(ee.id)===$&&(Y=ee)}),Y?Y.ref?o.push(new r.V(y,c.ref,"ref cannot reference another ref layer")):A=r.D(Y.type):typeof $=="string"&&o.push(new r.V(y,c.ref,`ref layer "${$}" not found`))}else if(A!=="background"&&A!=="sky"&&A!=="slot")if(c.source){const Y=S.sources&&S.sources[c.source],ee=Y&&r.D(Y.type);Y?ee==="vector"&&A==="raster"?o.push(new r.V(y,c.source,`layer "${c.id}" requires a raster source`)):ee==="raster"&&A!=="raster"?o.push(new r.V(y,c.source,`layer "${c.id}" requires a vector source`)):ee!=="vector"||c["source-layer"]?ee==="raster-dem"&&A!=="hillshade"?o.push(new r.V(y,c.source,"raster-dem source can only be used with layer type 'hillshade'.")):ee!=="raster-array"||["raster","raster-particle"].includes(A)?A!=="line"||!c.paint||!c.paint["line-gradient"]&&!c.paint["line-trim-offset"]||ee==="geojson"&&Y.lineMetrics?A==="raster-particle"&&ee!=="raster-array"&&o.push(new r.V(y,c.source,`layer "${c.id}" requires a 'raster-array' source.`)):o.push(new r.V(y,c,`layer "${c.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):o.push(new r.V(y,c.source,"raster-array source can only be used with layer type 'raster'.")):o.push(new r.V(y,c,`layer "${c.id}" must specify a "source-layer"`)):o.push(new r.V(y,c.source,`source "${c.source}" not found`))}else o.push(new r.V(y,c,'missing required property "source"'));return o=o.concat(ut({key:y,value:c,valueSpec:T.layer,style:g.style,styleSpec:g.styleSpec,objectElementValidators:{"*":()=>[],type:()=>vr({key:`${y}.type`,value:c.type,valueSpec:T.layer.type,style:g.style,styleSpec:g.styleSpec,object:c,objectKey:"type"}),filter:Y=>Jt(r.C({layerType:A},Y)),layout:Y=>ut({layer:c,key:Y.key,value:Y.value,valueSpec:{},style:Y.style,styleSpec:Y.styleSpec,objectElementValidators:{"*":ee=>bn(r.C({layerType:A},ee))}}),paint:Y=>ut({layer:c,key:Y.key,value:Y.value,valueSpec:{},style:Y.style,styleSpec:Y.styleSpec,objectElementValidators:{"*":ee=>ar(r.C({layerType:A,layer:c},ee))}})}})),o}function Cn(g){const o=g.value,c=g.key,y=r.B(o);return y!=="string"?[new r.V(c,o,`string expected, ${y} found`)]:[]}const xn={promoteId:function({key:g,value:o}){if(r.B(o)==="string")return Cn({key:g,value:o});{const c=[];for(const y in o)c.push(...Cn({key:`${g}.${y}`,value:o[y]}));return c}}};function Er(g){const o=g.value,c=g.key,y=g.styleSpec,S=g.style;if(!o.type)return[new r.V(c,o,'"type" is required')];const T=r.D(o.type);let A=[];switch(["vector","raster","raster-dem","raster-array"].includes(T)&&(o.url||o.tiles||A.push(new r.A(c,o,'Either "url" or "tiles" is required.'))),T){case"vector":case"raster":case"raster-dem":case"raster-array":return A=A.concat(ut({key:c,value:o,valueSpec:y[`source_${T.replace("-","_")}`],style:g.style,styleSpec:y,objectElementValidators:xn})),A;case"geojson":if(A=ut({key:c,value:o,valueSpec:y.source_geojson,style:S,styleSpec:y,objectElementValidators:xn}),o.cluster)for(const $ in o.clusterProperties){const[Y,ee]=o.clusterProperties[$],te=typeof Y=="string"?[Y,["accumulated"],["get",$]]:Y;A.push(...un({key:`${c}.${$}.map`,value:ee,expressionContext:"cluster-map"})),A.push(...un({key:`${c}.${$}.reduce`,value:te,expressionContext:"cluster-reduce"}))}return A;case"video":return ut({key:c,value:o,valueSpec:y.source_video,style:S,styleSpec:y});case"image":return ut({key:c,value:o,valueSpec:y.source_image,style:S,styleSpec:y});case"canvas":return[new r.V(c,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return an({key:`${c}.type`,value:o.type,valueSpec:{values:Rr(y)},style:S,styleSpec:y})}}function Rr(g){return g.source.reduce((o,c)=>{const y=g[c];return y.type.type==="enum"&&(o=o.concat(Object.keys(y.type.values))),o},[])}function Wn(g){const o=g.value,c=g.styleSpec,y=c.light,S=g.style;let T=[];const A=r.B(o);if(o===void 0)return T;if(A!=="object")return T=T.concat([new r.V("light",o,`object expected, ${A} found`)]),T;for(const $ in o){const Y=$.match(/^(.*)-transition$/);T=T.concat(Y&&y[Y[1]]&&y[Y[1]].transition?vr({key:$,value:o[$],valueSpec:c.transition,style:S,styleSpec:c}):y[$]?vr({key:$,value:o[$],valueSpec:y[$],style:S,styleSpec:c}):[new r.V($,o[$],`unknown property "${$}"`)])}return T}function Mn(g){const o=g.value;let c=[];if(!o)return c;const y=r.B(o);if(y!=="object")return c=c.concat([new r.V("light-3d",o,`object expected, ${y} found`)]),c;const S=g.styleSpec,T=S["light-3d"],A=g.key,$=g.style,Y=g.style.lights;for(const ue of["type","id"])if(!(ue in o))return c=c.concat([new r.V("light-3d",o,`missing property ${ue} on light`)]),c;if(o.type&&Y)for(let ue=0;ue<g.arrayIndex;ue++){const fe=r.D(o.type),me=Y[ue];r.D(me.type)===fe&&c.push(new r.V(A,o.id,`duplicate light type "${o.type}", previously defined at line ${me.id.__line__}`))}const ee=`properties_light_${o.type}`;if(!(ee in S))return c=c.concat([new r.V("light-3d",o,`Invalid light type ${o.type}`)]),c;const te=S[ee];for(const ue in o)if(ue==="properties"){const fe=o[ue],me=r.B(fe);if(me!=="object")return c=c.concat([new r.V("properties",fe,`object expected, ${me} found`)]),c;for(const ke in fe)c=c.concat(te[ke]?vr({key:ke,value:fe[ke],valueSpec:te[ke],style:$,styleSpec:S}):[new r.A(g.key,fe[ke],`unknown property "${ke}"`)])}else{const fe=ue.match(/^(.*)-transition$/);c=c.concat(fe&&T[fe[1]]&&T[fe[1]].transition?vr({key:ue,value:o[ue],valueSpec:S.transition,style:$,styleSpec:S}):T[ue]?vr({key:ue,value:o[ue],valueSpec:T[ue],style:$,styleSpec:S}):[new r.A(ue,o[ue],`unknown property "${ue}"`)])}return c}function Ar(g){const o=g.value,c=g.key,y=g.style,S=g.styleSpec,T=S.terrain;let A=[];const $=r.B(o);if(o===void 0||$==="null")return A;if($!=="object")return A=A.concat([new r.V("terrain",o,`object expected, ${$} found`)]),A;for(const Y in o){const ee=Y.match(/^(.*)-transition$/);A=A.concat(ee&&T[ee[1]]&&T[ee[1]].transition?vr({key:Y,value:o[Y],valueSpec:S.transition,style:y,styleSpec:S}):T[Y]?vr({key:Y,value:o[Y],valueSpec:T[Y],style:y,styleSpec:S}):[new r.A(Y,o[Y],`unknown property "${Y}"`)])}if(o.source){const Y=y.sources&&y.sources[o.source],ee=Y&&r.D(Y.type);Y?ee!=="raster-dem"&&A.push(new r.V(c,o.source,`terrain cannot be used with a source of type ${String(ee)}, it only be used with a "raster-dem" source type`)):A.push(new r.V(c,o.source,`source "${o.source}" not found`))}else A.push(new r.V(c,o,'terrain is missing required property "source"'));return A}function fi(g){const o=g.value,c=g.style,y=g.styleSpec,S=y.fog;let T=[];const A=r.B(o);if(o===void 0)return T;if(A!=="object")return T=T.concat([new r.V("fog",o,`object expected, ${A} found`)]),T;for(const $ in o){const Y=$.match(/^(.*)-transition$/);T=T.concat(Y&&S[Y[1]]&&S[Y[1]].transition?vr({key:$,value:o[$],valueSpec:y.transition,style:c,styleSpec:y}):S[$]?vr({key:$,value:o[$],valueSpec:S[$],style:c,styleSpec:y}):[new r.A($,o[$],`unknown property "${$}"`)])}return T}const yo={"*":()=>[],array:tt,boolean:function(g){const o=g.value,c=g.key,y=r.B(o);return y!=="boolean"?[new r.V(c,o,`boolean expected, ${y} found`)]:[]},number:nt,color:function(g){const o=g.key,c=g.value,y=r.B(c);return y!=="string"?[new r.V(o,c,`color expected, ${y} found`)]:r.U.parseCSSColor(c)===null?[new r.V(o,c,`color expected, "${c}" found`)]:[]},enum:an,filter:Jt,function:tn,layer:lr,object:ut,source:Er,model:r.Z,light:Wn,"light-3d":Mn,terrain:Ar,fog:fi,string:Cn,formatted:function(g){return Cn(g).length===0?[]:un(g)},resolvedImage:function(g){return Cn(g).length===0?[]:un(g)},projection:function(g){const o=g.value,c=g.styleSpec,y=c.projection,S=g.style;let T=[];const A=r.B(o);if(A==="object")for(const $ in o)T=T.concat(vr({key:$,value:o[$],valueSpec:y[$],style:S,styleSpec:c}));else A!=="string"&&(T=T.concat([new r.V("projection",o,`object or string expected, ${A} found`)]));return T},import:function(g){const{value:o,styleSpec:c}=g,{data:y,...S}=o;Object.defineProperty(S,"__line__",{value:o.__line__,enumerable:!1});let T=ut(r.C({},g,{value:S,valueSpec:c.import}));return r.D(S.id)===""&&T.push(new r.V(`${g.key}.id`,S,"import id can't be an empty string")),y&&(T=T.concat(Li(y,c,{key:`${g.key}.data`}))),T}};function vr(g,o=!1){const c=g.value,y=g.valueSpec,S=g.styleSpec;if(y.expression&&r.X(r.D(c)))return tn(g);if(y.expression&&r.J(r.K(c)))return un(g);if(y.type&&yo[y.type]){const T=yo[y.type](g);return o===!0&&T.length>0&&r.B(g.value)==="array"?un(g):T}return ut(r.C({},g,{valueSpec:y.type?S[y.type]:y}))}function zi(g){const o=g.value,c=g.key,y=Cn(g);return y.length||(o.indexOf("{fontstack}")===-1&&y.push(new r.V(c,o,'"glyphs" url must include a "{fontstack}" token')),o.indexOf("{range}")===-1&&y.push(new r.V(c,o,'"glyphs" url must include a "{range}" token'))),y}function Li(g,o=r._,c={}){return vr({key:c.key||"",value:g,valueSpec:o.$root,styleSpec:o,style:g,objectElementValidators:{glyphs:zi,"*":()=>[]}})}function mi(g,o=r._){return ht(Li(g,o))}const ji=g=>ht(Er(g)),ko=g=>ht(Wn(g)),qo=g=>ht(Mn(g)),Oo=g=>ht(Ar(g)),Pn=g=>ht(fi(g)),Vt=g=>ht(lr(g)),ze=g=>ht(Jt(g)),Ve=g=>ht(ar(g)),at=g=>ht(bn(g)),_t=g=>ht(r.Z(g));function ht(g){return g.slice().sort((o,c)=>o.line&&c.line?o.line-c.line:0)}function Mt(g,o){let c=!1;if(o&&o.length)for(const y of o)y instanceof r.A?r.w(y.message):(g.fire(new r.t(new Error(y.message))),c=!0);return c}let Xt;class At extends r.E{constructor(o,c="flat"){super(),this._transitionable=new r.$(Xt||(Xt=new r.a0({anchor:new r.a1(r._.light.anchor),position:new r.a2(r._.light.position),color:new r.a1(r._.light.color),intensity:new r.a1(r._.light.intensity)}))),this.setLight(o,c),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(o,c,y={}){this._validate(ko,o,y)||(this._transitionable.setTransitionOrValue(o),this.id=c)}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,c,y){return(!y||y.validate!==!1)&&Mt(this,o.call(mi,r.l({value:c,style:{glyphs:!0,sprite:!0},styleSpec:r._})))}}const Gt=new r.a0({source:new r.a1(r._.terrain.source),exaggeration:new r.a1(r._.terrain.exaggeration)});let Zt=class extends r.E{constructor(g,o,c,y){super(),this.scope=c,this._transitionable=new r.$(Gt,c,y),this._transitionable.setTransitionOrValue(g,y),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=o}get(){return this._transitionable.serialize()}set(g,o){this._transitionable.setTransitionOrValue(g,o)}updateTransitions(g){this._transitioning=this._transitionable.transitioned(g,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(g){this.properties=this._transitioning.possiblyEvaluate(g)}getExaggeration(g){return this._transitioning.possiblyEvaluate(new r.a3(g)).get("exaggeration")}isZoomDependent(){const g=this._transitionable._values.exaggeration;return g!=null&&g.value!=null&&g.value.expression!=null&&g.value.expression instanceof r.a4}};const Ht=45,fn=65,Nt=.05;function zt(g,o,c,y){const S=r.a7(Ht,fn,c),[T,A]=yn(g,y);let $=1-Math.min(1,Math.exp((o-T)/(A-T)*-6));return $*=$*$,$=Math.min(1,1.00747*$),$*S*g.alpha}function yn(g,o){const c=.5/Math.tan(.5*o);return[g.range[0]+c,g.range[1]+c]}function qn(g,o,c,y,S){const T=r.a6.vec3.transformMat4([],[o,c,y],S.mercatorFogMatrix);return zt(g,r.a6.vec3.length(T),S.pitch,S._fov)}function Jn(g,o,c,y,S,T,A){const $=[[c,y,0],[S,y,0],[S,T,0],[c,T,0]];let Y=Number.MAX_VALUE,ee=-Number.MAX_VALUE;for(const te of $){const ue=r.a6.vec3.transformMat4([],te,o),fe=r.a6.vec3.length(ue);Y=Math.min(Y,fe),ee=Math.max(ee,fe)}return[zt(g,Y,A.pitch,A._fov),zt(g,ee,A.pitch,A._fov)]}const ur=new r.a0({range:new r.a1(r._.fog.range),color:new r.a1(r._.fog.color),"high-color":new r.a1(r._.fog["high-color"]),"space-color":new r.a1(r._.fog["space-color"]),"horizon-blend":new r.a1(r._.fog["horizon-blend"]),"star-intensity":new r.a1(r._.fog["star-intensity"]),"vertical-range":new r.a1(r._.fog["vertical-range"])});class Cr extends r.E{constructor(o,c,y,S){super(),this._transitionable=new r.$(ur,y,new Map(S)),this.set(o,S),this._transitioning=this._transitionable.untransitioned(),this._transform=c,this.properties=new r.a8(ur),this.scope=y}get state(){const o=this._transform,c=o.projection.name==="globe",y=r.a9(o.zoom),S=this.properties.get("range"),T=[.5,3];return{range:c?[r.aa(T[0],S[0],y),r.aa(T[1],S[1],y)]:S,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(o,c,y={}){if(this._validate(Pn,o,y))return;const S=r.l({},o);for(const T of Object.keys(r._.fog))S[T]===void 0&&(S[T]=r._.fog[T].default);this._options=S,this._transitionable.setTransitionOrValue(this._options,c)}getOpacity(o){if(!this._transform.projection.supportsFog)return 0;const c=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:r.a7(Ht,fn,o))*c.a}getOpacityAtLatLng(o,c){return this._transform.projection.supportsFog?function(y,S,T){const A=r.a5.fromLngLat(S),$=T.elevation?T.elevation.getAtPointOrZero(A):0;return qn(y,A.x,A.y,$,T)}(this.state,o,c):0}getOpacityForTile(o){if(!this._transform.projection.supportsFog)return[1,1];const c=this._transform.calculateFogTileMatrix(o.toUnwrapped());return Jn(this.state,c,0,0,r.ab,r.ab,this._transform)}getOpacityForBounds(o,c,y,S,T){return this._transform.projection.supportsFog?Jn(this.state,o,c,y,S,T,this._transform):[1,1]}getFovAdjustedRange(o){return this._transform.projection.supportsFog?yn(this.state,o):[0,1]}isVisibleOnFrustum(o){if(!this._transform.projection.supportsFog)return!1;const c=[4,5,6,7];for(const y of c){const S=o.points[y];let T;if(S[2]>=0)T=S;else{const A=o.points[y-4];T=r.ac(A,S,A[2]/(A[2]-S[2]))}if(qn(this.state,T[0],T[1],0,this._transform)>=Nt)return!0}return!1}updateConfig(o){this._transitionable.setTransitionOrValue(this._options,new Map(o))}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,c,y){return(!y||y.validate!==!1)&&Mt(this,o.call(mi,r.l({value:c,style:{glyphs:!0,sprite:!0},styleSpec:r._})))}}class Or extends r.E{constructor(o,c,y,S){super(),this.scope=y,this._options=o,this.properties=new r.a8(c),this._transitionable=new r.$(c,y,new Map(S)),this._transitionable.setTransitionOrValue(o.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(o){this._transitionable.setTransitionOrValue(this._options.properties,new Map(o))}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(o,c){this._options=o,this._transitionable.setTransitionOrValue(o.properties,c)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}let Fr,bi;class Mi{constructor(o,c,y,S){this.screenBounds=o,this.cameraPoint=c,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=y,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,S)}static createFromScreenPoints(o,c){let y,S;if(o instanceof r.P||typeof o[0]=="number"){const T=r.P.convert(o);y=[T],S=c.isPointAboveHorizon(T)}else{const T=r.P.convert(o[0]),A=r.P.convert(o[1]);y=[T,A],S=r.ae(T,A).every($=>c.isPointAboveHorizon($))}return new Mi(y,c.getCameraPoint(),S,c)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(o){return r.ae(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],o)}bufferedCameraGeometry(o){const c=this.screenBounds[0],y=this.screenBounds.length===1?this.screenBounds[0].add(new r.P(1,1)):this.screenBounds[1],S=r.ae(c,y,0,!1);return this.cameraPoint.y>y.y&&(this.cameraPoint.x>c.x&&this.cameraPoint.x<y.x?S.splice(3,0,this.cameraPoint):this.cameraPoint.x>=y.x?S[2]=this.cameraPoint:this.cameraPoint.x<=c.x&&(S[3]=this.cameraPoint)),r.af(S,o)}bufferedCameraGeometryGlobe(o){const c=this.screenBounds[0],y=this.screenBounds.length===1?this.screenBounds[0].add(new r.P(1,1)):this.screenBounds[1],S=r.ae(c,y,o),T=this.cameraPoint.clone();switch(3*((T.y>c.y)+(T.y>y.y))+((T.x>c.x)+(T.x>y.x))){case 0:S[0]=T,S[4]=T.clone();break;case 1:S.splice(1,0,T);break;case 2:S[1]=T;break;case 3:S.splice(4,0,T);break;case 5:S.splice(2,0,T);break;case 6:S[3]=T;break;case 7:S.splice(3,0,T);break;case 8:S[2]=T}return S}containsTile(o,c,y,S=0){const T=o.queryPadding/c._pixelsPerMercatorPixel+1,A=y?this._bufferedCameraMercator(T,c):this._bufferedScreenMercator(T,c);let $=o.tileID.wrap+(A.unwrapped?S:0);const Y=A.polygon.map(De=>r.ag(o.tileTransform,De,$));if(!r.ah(Y,0,0,r.ab,r.ab))return;$=o.tileID.wrap+(this.screenGeometryMercator.unwrapped?S:0);const ee=this.screenGeometryMercator.polygon.map(De=>r.ai(o.tileTransform,De,$)),te=ee.map(De=>new r.P(De[0],De[1])),ue=c.getFreeCameraOptions().position||new r.a5(0,0,0),fe=r.ai(o.tileTransform,ue,$),me=ee.map(De=>{const Fe=r.a6.vec3.sub(De,De,fe);return r.a6.vec3.normalize(Fe,Fe),new r.aj(fe,Fe)}),ke=r.ak(o,1,c.zoom)*c._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:te,tilespaceRays:me,bufferedTilespaceGeometry:Y,bufferedTilespaceBounds:(Le=r.al(Y),Le.min.x=r.ap(Le.min.x,0,r.ab),Le.min.y=r.ap(Le.min.y,0,r.ab),Le.max.x=r.ap(Le.max.x,0,r.ab),Le.max.y=r.ap(Le.max.y,0,r.ab),Le),tile:o,tileID:o.tileID,pixelToTileUnitsFactor:ke};var Le}_bufferedScreenMercator(o,c){const y=yi(o);if(this._screenRaycastCache[y])return this._screenRaycastCache[y];{let S;return S=c.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(o),c):{polygon:this.bufferedScreenGeometry(o).map(T=>c.pointCoordinate3D(T)),unwrapped:!0},this._screenRaycastCache[y]=S,S}}_bufferedCameraMercator(o,c){const y=yi(o);if(this._cameraRaycastCache[y])return this._cameraRaycastCache[y];{let S;return S=c.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(o),c):{polygon:this.bufferedCameraGeometry(o).map(T=>c.pointCoordinate3D(T)),unwrapped:!0},this._cameraRaycastCache[y]=S,S}}_projectAndResample(o,c){const y=function(T,A){const $=r.a6.mat4.multiply([],A.pixelMatrix,A.globeMatrix),Y=[0,-r.aq,0,1],ee=[0,r.aq,0,1],te=[0,0,0,1];r.a6.vec4.transformMat4(Y,Y,$),r.a6.vec4.transformMat4(ee,ee,$),r.a6.vec4.transformMat4(te,te,$);const ue=new r.P(Y[0]/Y[3],Y[1]/Y[3]),fe=new r.P(ee[0]/ee[3],ee[1]/ee[3]),me=r.an(T,ue)&&Y[3]<te[3],ke=r.an(T,fe)&&ee[3]<te[3];if(!me&&!ke)return null;const Le=function(mt,dt,yt){for(let Et=1;Et<mt.length;Et++){const bt=Ki(dt.pointCoordinate3D(mt[Et-1]).x),vt=Ki(dt.pointCoordinate3D(mt[Et]).x);if(yt<0){if(bt<vt)return{idx:Et,t:-bt/(vt-1-bt)}}else if(vt<bt)return{idx:Et,t:(1-bt)/(vt+1-bt)}}return null}(T,A,me?-1:1);if(!Le)return null;const{idx:De,t:Fe}=Le;let Ye=De>1?Wi(T.slice(0,De),A):[],Je=De<T.length?Wi(T.slice(De),A):[];Ye=Ye.map(mt=>new r.P(Ki(mt.x),mt.y)),Je=Je.map(mt=>new r.P(Ki(mt.x),mt.y));const qe=[...Ye];qe.length===0&&qe.push(Je[Je.length-1]);const it=r.aa(qe[qe.length-1].y,(Je.length===0?Ye[0]:Je[0]).y,Fe);let rt;return rt=me?[new r.P(0,it),new r.P(0,0),new r.P(1,0),new r.P(1,it)]:[new r.P(1,it),new r.P(1,1),new r.P(0,1),new r.P(0,it)],qe.push(...rt),Je.length===0?qe.push(Ye[0]):qe.push(...Je),{polygon:qe.map(mt=>new r.a5(mt.x,mt.y)),unwrapped:!1}}(o,c);if(y)return y;const S=function(T,A){let $=!1,Y=-1/0,ee=0;for(let ue=0;ue<T.length-1;ue++)T[ue].x>Y&&(Y=T[ue].x,ee=ue);for(let ue=0;ue<T.length-1;ue++){const fe=(ee+ue)%(T.length-1),me=T[fe],ke=T[fe+1];Math.abs(me.x-ke.x)>.5&&(me.x<ke.x?(me.x+=1,fe===0&&(T[T.length-1].x+=1)):(ke.x+=1,fe+1===T.length-1&&(T[0].x+=1)),$=!0)}const te=r.am(A.center.lng);return $&&te<Math.abs(te-1)&&T.forEach(ue=>{ue.x-=1}),{polygon:T,unwrapped:$}}(Wi(o,c).map(T=>new r.P(Ki(T.x),T.y)),c);return{polygon:S.polygon.map(T=>new r.a5(T.x,T.y)),unwrapped:S.unwrapped}}}function Wi(g,o){return r.ao(g,c=>{const y=o.pointCoordinate3D(c);c.x=y.x,c.y=y.y},1/256)}function Ki(g){return g<0?1+g%1:g%1}function yi(g){return 100*g|0}function bs(g,o,c,y,S){const T=function($,Y){if($)return S($);if(Y){if(g.url&&Y.tiles&&g.tiles&&delete g.tiles,Y.variants){if(!Array.isArray(Y.variants))return S(new Error("variants must be an array"));for(const te of Y.variants){if(te==null||typeof te!="object"||te.constructor!==Object)return S(new Error("variant must be an object"));if(!Array.isArray(te.capabilities))return S(new Error("capabilities must be an array"));if(te.capabilities.length===1&&te.capabilities[0]==="meshopt"){Y=r.l(Y,te);break}}}const ee=r.ar(r.l(Y,g),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);Y.vector_layers&&(ee.vectorLayers=Y.vector_layers,ee.vectorLayerIds=ee.vectorLayers.map(te=>te.id)),Y.raster_layers&&(ee.rasterLayers=Y.raster_layers,ee.rasterLayerIds=ee.rasterLayers.map(te=>te.id)),ee.tiles=o.canonicalizeTileset(ee,g.url),S(null,ee)}},A=function($,Y,ee){if(!$)return null;if(!Y&&!ee)return $;ee=ee||$.worldview_default;const te=Object.values($.language||{});if(te.length===0)return null;const ue=Object.values($.worldview||{});if(ue.length===0)return null;const fe=te.every(ke=>ke===Y),me=ue.every(ke=>ke===ee);return fe&&me?$:Y in($.language_options||{})||ee in($.worldview_options||{})?null:$.language_options&&$.worldview_options?$:null}(g.data,c,y);return A?r.q.frame(()=>T(null,A)):g.url?r.n(o.transformRequest(o.normalizeSourceURL(g.url,null,c,y),r.R.Source),T):r.q.frame(()=>{const{data:$,...Y}=g;T(null,Y)})}class Us{constructor(o,c,y){this.bounds=r.as.convert(this.validateBounds(o)),this.minzoom=c||0,this.maxzoom=y||24}validateBounds(o){return Array.isArray(o)&&o.length===4?[Math.max(-180,o[0]),Math.max(-90,o[1]),Math.min(180,o[2]),Math.min(90,o[3])]:[-180,-90,180,90]}contains(o){const c=Math.pow(2,o.z),y=Math.floor(r.am(this.bounds.getWest())*c),S=Math.floor(r.at(this.bounds.getNorth())*c),T=Math.ceil(r.am(this.bounds.getEast())*c),A=Math.ceil(r.at(this.bounds.getSouth())*c);return o.x>=y&&o.x<T&&o.y>=S&&o.y<A}}class ei extends r.E{constructor(o,c,y,S){if(super(),this.id=o,this.dispatcher=y,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,r.l(this,r.ar(c,["url","scheme","tileSize","promoteId"])),this._options=r.l({type:"vector"},c),this._collectResourceTiming=!!c.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(S),this._tileWorkers={},this._deduped=new r.au}load(o){this._loaded=!1,this.fire(new r.x("dataloading",{dataType:"source"}));const c=Array.isArray(this.map._language)?this.map._language.join():this.map._language,y=this.map._worldview;this._tileJSONRequest=bs(this._options,this.map._requestManager,c,y,(S,T)=>{this._tileJSONRequest=null,this._loaded=!0,S?(c&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${c}`),y&&y.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${y}`),this.fire(new r.t(S))):T&&(r.l(this,T),T.bounds&&(this.tileBounds=new Us(T.bounds,this.minzoom,this.maxzoom)),Ct(T.tiles,this.map._requestManager._customAccessToken),this.fire(new r.x("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.x("data",{dataType:"source",sourceDataType:"content"}))),o&&o(S)})}loaded(){return this._loaded}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}onAdd(o){this.map=o,this.load()}reload(){this.cancelTileJSONRequest();const o=r.av(this.id,this.scope);this.load(()=>this.map.style.clearSource(o))}setTiles(o){return this._options.tiles=o,this.reload(),this}setUrl(o){return this.url=o,this._options.url=o,this.reload(),this}onRemove(o){this.cancelTileJSONRequest()}serialize(){return r.l({},this._options)}loadTile(o,c){const y=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme)),S=this.map._requestManager.transformRequest(y,r.R.Tile),T=this.map.style?this.map.style.getLut(this.scope):null,A={request:S,data:void 0,uid:o.uid,tileID:o.tileID,tileZoom:o.tileZoom,zoom:o.tileID.overscaledZ,lut:T?{image:T.image.clone()}:null,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:r.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:o.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:o.isExtraShadowCaster,tessellationStep:this.map._tessellationStep};if(A.request.collectResourceTiming=this._collectResourceTiming,o.actor&&o.state!=="expired")o.state==="loading"?o.reloadCallback=c:o.request=o.actor.send("reloadTile",A,$.bind(this));else if(o.actor=this._tileWorkers[y]=this._tileWorkers[y]||this.dispatcher.getActor(),this.dispatcher.ready)o.request=o.actor.send("loadTile",A,$.bind(this),void 0,!0);else{const Y=r.aw.call({deduped:this._deduped},A,(ee,te)=>{ee||!te?$.call(this,ee):(A.data={cacheControl:te.cacheControl,expires:te.expires,rawData:te.rawData.slice(0)},o.actor&&o.actor.send("loadTile",A,$.bind(this),void 0,!0))},!0);o.request={cancel:Y}}function $(Y,ee){return delete o.request,o.aborted?c(null):Y&&Y.status!==404?c(Y):(ee&&ee.resourceTiming&&(o.resourceTiming=ee.resourceTiming),this.map._refreshExpiredTiles&&ee&&o.setExpiryData(ee),o.loadVectorData(ee,this.map.painter),r.ax(this.dispatcher),c(null),void(o.reloadCallback&&(this.loadTile(o,o.reloadCallback),o.reloadCallback=null)))}}abortTile(o){o.request&&(o.request.cancel(),delete o.request),o.actor&&o.actor.send("abortTile",{uid:o.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(o,c){o.actor&&o.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id,scope:this.scope}),o.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Ji extends r.E{constructor(o,c,y,S){super(),this.id=o,this.dispatcher=y,this.setEventedParent(S),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=r.l({type:"raster"},c),r.l(this,r.ar(c,["url","scheme","tileSize"]))}load(o){this._loaded=!1,this.fire(new r.x("dataloading",{dataType:"source"})),this._tileJSONRequest=bs(this._options,this.map._requestManager,null,null,(c,y)=>{this._tileJSONRequest=null,this._loaded=!0,c?this.fire(new r.t(c)):y&&(r.l(this,y),y.bounds&&(this.tileBounds=new Us(y.bounds,this.minzoom,this.maxzoom)),Ct(y.tiles),this.fire(new r.x("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.x("data",{dataType:"source",sourceDataType:"content"}))),o&&o(c)})}loaded(){return this._loaded}onAdd(o){this.map=o,this.load()}reload(){this.cancelTileJSONRequest();const o=r.av(this.id,this.scope);this.load(()=>this.map.style.clearSource(o))}setTiles(o){return this._options.tiles=o,this.reload(),this}setUrl(o){return this.url=o,this._options.url=o,this.reload(),this}onRemove(o){this.cancelTileJSONRequest()}serialize(){return r.l({},this._options)}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}loadTile(o,c){const y=r.q.devicePixelRatio>=2,S=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),y,this.tileSize);o.request=r.o(this.map._requestManager.transformRequest(S,r.R.Tile),(T,A,$,Y)=>(delete o.request,o.aborted?(o.state="unloaded",c(null)):T?(o.state="errored",c(T)):A?(this.map._refreshExpiredTiles&&o.setExpiryData({cacheControl:$,expires:Y}),o.setTexture(A,this.map.painter),o.state="loaded",r.ax(this.dispatcher),void c(null)):c(null)))}abortTile(o,c){o.request&&(o.request.cancel(),delete o.request),c&&c()}unloadTile(o,c){o.texture&&o.texture instanceof r.T?(o.destroy(!0),o.texture&&o.texture instanceof r.T&&this.map.painter.saveTileTexture(o.texture)):o.destroy(),c&&c()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class ns extends Ji{constructor(o,c,y,S){super(o,c,y,S),this.type="raster-array",this.maxzoom=22,this._options=r.l({type:"raster-array"},c)}triggerRepaint(o){const c=this.map.painter._terrain,y=this.map.style.getSourceCache(this.id);c&&c.enabled&&y&&c._clearRenderCacheForTile(y.id,o.tileID),this.map.triggerRepaint()}loadTile(o,c){const y=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),S=this.map._requestManager.transformRequest(y,r.R.Tile);o.requestParams=S,o.actor||(o.actor=this.dispatcher.getActor()),o.request=o.fetchHeader(void 0,(T,A,$,Y)=>{if(delete o.request,o.aborted)return o.state="unloaded",c(null);if(T)return T.code===20?void 0:(o.state="errored",c(T));this.map._refreshExpiredTiles&&o.setExpiryData({cacheControl:$,expires:Y}),o.state="empty",c(null)})}unloadTile(o,c){const y=o.texture;y&&y instanceof r.T?(o.destroy(!0),this.map.painter.saveTileTexture(y)):(o.destroy(),o.flushQueues(),o._isHeaderLoaded=!1,delete o._mrt,delete o.textureDescriptor),o.fbo&&(o.fbo.destroy(),delete o.fbo),delete o.request,delete o.requestParams,delete o.neighboringTiles,o.state="unloaded"}prepareTile(o,c,y){o._isHeaderLoaded&&(o.state!=="empty"&&(o.state="reloading"),o.fetchBand(c,y,(S,T)=>{if(S)return o.state="errored",this.fire(new r.t(S)),void this.triggerRepaint(o);T&&(o.setTexture(T,this.map.painter),o.state="loaded",this.triggerRepaint(o))}))}getInitialBand(o){if(!this.rasterLayers)return 0;const c=this.rasterLayers.find(({id:T})=>T===o),y=c&&c.fields,S=y&&y.bands&&y.bands;return S?S[0]:0}getTextureDescriptor(o,c,y){if(!o)return;const S=c.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!S)return;let T=null;c instanceof r.aB?T=c.paint.get("raster-array-band"):c instanceof r.aC&&(T=c.paint.get("raster-particle-array-band"));const A=T||this.getInitialBand(S);if(A!=null)if(o.textureDescriptor){if(!o.updateNeeded(S,A)||y)return Object.assign({},o.textureDescriptor,{texture:o.texture})}else this.prepareTile(o,S,A)}}const Xo={vector:ei,raster:Ji,"raster-dem":class extends Ji{constructor(g,o,c,y){super(g,o,c,y),this.type="raster-dem",this.maxzoom=22,this._options=r.l({type:"raster-dem"},o),this.encoding=o.encoding||"mapbox"}loadTile(g,o){const c=this.map._requestManager.normalizeTileURL(g.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function y(S,T){S&&(g.state="errored",o(S)),T&&(g.dem=T,g.dem.onDeserialize(),g.needsHillshadePrepare=!0,g.needsDEMTextureUpload=!0,g.state="loaded",o(null))}g.request=r.o(this.map._requestManager.transformRequest(c,r.R.Tile),(function(S,T,A,$){if(delete g.request,g.aborted)g.state="unloaded",o(null);else if(S)g.state="errored",o(S);else if(T){this.map._refreshExpiredTiles&&g.setExpiryData({cacheControl:A,expires:$});const Y=ImageBitmap&&T instanceof ImageBitmap&&r.ay(),ee=1-(T.width-r.az(T.width))/2;ee<1||g.neighboringTiles||(g.neighboringTiles=this._getNeighboringTiles(g.tileID));const te=Y?T:r.q.getImageData(T,ee),ue={uid:g.uid,coord:g.tileID,source:this.id,scope:this.scope,rawImageData:te,encoding:this.encoding,padding:ee};g.actor&&g.state!=="expired"||(g.actor=this.dispatcher.getActor(),g.actor.send("loadDEMTile",ue,y.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(g){const o=g.canonical,c=Math.pow(2,o.z),y=(o.x-1+c)%c,S=o.x===0?g.wrap-1:g.wrap,T=(o.x+1+c)%c,A=o.x+1===c?g.wrap+1:g.wrap,$={};return $[new r.aA(g.overscaledZ,S,o.z,y,o.y).key]={backfilled:!1},$[new r.aA(g.overscaledZ,A,o.z,T,o.y).key]={backfilled:!1},o.y>0&&($[new r.aA(g.overscaledZ,S,o.z,y,o.y-1).key]={backfilled:!1},$[new r.aA(g.overscaledZ,g.wrap,o.z,o.x,o.y-1).key]={backfilled:!1},$[new r.aA(g.overscaledZ,A,o.z,T,o.y-1).key]={backfilled:!1}),o.y+1<c&&($[new r.aA(g.overscaledZ,S,o.z,y,o.y+1).key]={backfilled:!1},$[new r.aA(g.overscaledZ,g.wrap,o.z,o.x,o.y+1).key]={backfilled:!1},$[new r.aA(g.overscaledZ,A,o.z,T,o.y+1).key]={backfilled:!1}),$}},"raster-array":ns,geojson:class extends r.E{constructor(g,o,c,y){super(),this.id=g,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=c.getActor(),this.setEventedParent(y),this._data=o.data,this._options=r.l({},o),this._collectResourceTiming=o.collectResourceTiming,o.maxzoom!==void 0&&(this.maxzoom=o.maxzoom),o.minzoom!==void 0&&(this.minzoom=o.minzoom),o.type&&(this.type=o.type),o.attribution&&(this.attribution=o.attribution),this.promoteId=o.promoteId;const S=r.ab/this.tileSize;this.workerOptions=r.l({source:this.id,scope:this.scope,cluster:o.cluster||!1,geojsonVtOptions:{buffer:(o.buffer!==void 0?o.buffer:128)*S,tolerance:(o.tolerance!==void 0?o.tolerance:.375)*S,extent:r.ab,maxZoom:this.maxzoom,lineMetrics:o.lineMetrics||!1,generateId:o.generateId||!1},superclusterOptions:{maxZoom:o.clusterMaxZoom!==void 0?o.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,o.clusterMinPoints||2),extent:r.ab,radius:(o.clusterRadius!==void 0?o.clusterRadius:50)*S,log:!1,generateId:o.generateId||!1},clusterProperties:o.clusterProperties,filter:o.filter,dynamic:o.dynamic},o.workerOptions)}onAdd(g){this.map=g,this.setData(this._data)}setData(g){return this._data=g,this._updateWorkerData(),this}updateData(g){if(!this._options.dynamic)return this.fire(new r.t(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")));if(typeof g!="string"&&(g.type==="Feature"&&(g={type:"FeatureCollection",features:[g]}),g.type!=="FeatureCollection"))return this.fire(new r.t(new Error("Data to update should be a feature or a feature collection.")));if(this._coalesce&&typeof g!="string"&&typeof this._data!="string"&&this._data.type==="FeatureCollection"){const o=new Map;for(const c of this._data.features)o.set(c.id,c);for(const c of g.features)o.set(c.id,c);this._data.features=[...o.values()]}else this._data=g;return this._updateWorkerData(!0),this}getClusterExpansionZoom(g,o){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:g,source:this.id,scope:this.scope},o),this}getClusterChildren(g,o){return this.actor.send("geojson.getClusterChildren",{clusterId:g,source:this.id,scope:this.scope},o),this}getClusterLeaves(g,o,c,y){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:g,limit:o,offset:c},y),this}_updateWorkerData(g=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new r.x("dataloading",{dataType:"source"})),this._loaded=!1;const o=r.l({append:g},this.workerOptions);o.scope=this.scope;const c=this._data;typeof c=="string"?(o.request=this.map._requestManager.transformRequest(r.q.resolveURL(c),r.R.Source),o.request.collectResourceTiming=this._collectResourceTiming):o.data=JSON.stringify(c),this._pendingLoad=this.actor.send(`${this.type}.loadData`,o,(y,S)=>{if(this._loaded=!0,this._pendingLoad=null,y)this.fire(new r.t(y));else{const T={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&S&&S.resourceTiming&&S.resourceTiming[this.id]&&(T.resourceTiming=S.resourceTiming[this.id]),g&&(this._partialReload=!0),this.fire(new r.x("data",T)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(g),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(g,o){const c=g.actor?"reloadTile":"loadTile";g.actor=this.actor;const y=this.map.style?this.map.style.getLut(this.scope):null,S=this._partialReload,T={type:this.type,uid:g.uid,tileID:g.tileID,tileZoom:g.tileZoom,zoom:g.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:y?{image:y.image.clone()}:null,scope:this.scope,pixelRatio:r.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,partial:S};g.request=this.actor.send(c,T,(A,$)=>S&&!$?(g.state="loaded",o(null)):(delete g.request,g.destroy(),g.aborted?o(null):A?o(A):(g.loadVectorData($,this.map.painter,c==="reloadTile"),o(null))),void 0,c==="loadTile")}abortTile(g){g.request&&(g.request.cancel(),delete g.request),g.aborted=!0}unloadTile(g,o){this.actor.send("removeTile",{uid:g.uid,type:this.type,source:this.id,scope:this.scope}),g.destroy()}onRemove(g){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return r.l({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends r.aD{constructor(g,o,c,y){super(g,o,c,y),this.roundZoom=!0,this.type="video",this.options=o}load(){this._loaded=!1;const g=this.options;this.urls=[];for(const o of g.urls)this.urls.push(this.map._requestManager.transformRequest(o,r.R.Source).url);r.aE(this.urls,(o,c)=>{this._loaded=!0,o?this.fire(new r.t(o)):c&&(this.video=c,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(g){if(this.video){const o=this.video.seekable;g<o.start(0)||g>o.end(0)?this.fire(new r.t(new r.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${o.start(0)} and ${o.end(0)}-second mark.`))):this.video.currentTime=g}}getVideo(){return this.video}onAdd(g){this.map||(this.map=g,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const g=this.map.painter.context,o=g.gl;this.texture?this.video.paused||(this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),o.texSubImage2D(o.TEXTURE_2D,0,0,0,o.RGBA,o.UNSIGNED_BYTE,this.video)):(this.texture=new r.T(g,this.video,o.RGBA8),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(g)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:r.aD,model:class extends r.E{constructor(g,o,c,y){super(),this.id=g,this.type="model",this.models=[],this._loaded=!1,this._options=o}load(){const g=[];for(const o in this._options.models){const c=this._options.models[o],y=r.aG(this.map._requestManager.transformRequest(c.uri,r.R.Model).url).then(S=>{if(!S)return;const T=r.aH(S),A=new r.aI(o,c.position,c.orientation,T);A.computeBoundsAndApplyParent(),this.models.push(A)}).catch(S=>{this.fire(new r.t(new Error(`Could not load model ${o} from ${c.uri}: ${S.message}`)))});g.push(y)}return Promise.allSettled(g).then(()=>{this._loaded=!0,this.fire(new r.x("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(o=>{this.fire(new r.t(new Error(`Could not load models: ${o.message}`)))})}onAdd(g){this.map=g,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(g,o){}serialize(){return{type:"model"}}},"batched-model":class extends r.E{constructor(g,o,c,y){super(),this.type="batched-model",this.id=g,this.tileSize=512,this._options=o,this.tiles=this._options.tiles,this.maxzoom=o.maxzoom||19,this.minzoom=o.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=c,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(y)}onAdd(g){this.map=g,this.load()}load(g){this._loaded=!1,this.fire(new r.x("dataloading",{dataType:"source"}));const o=Array.isArray(this.map._language)?this.map._language.join():this.map._language,c=this.map._worldview;this._tileJSONRequest=bs(this._options,this.map._requestManager,o,c,(y,S)=>{this._tileJSONRequest=null,this._loaded=!0,y?(o&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${o}`),c&&c.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${c}`),this.fire(new r.t(y))):S&&(r.l(this,S),S.bounds&&(this.tileBounds=new Us(S.bounds,this.minzoom,this.maxzoom)),Ct(S.tiles,this.map._requestManager._customAccessToken),this.fire(new r.x("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.x("data",{dataType:"source",sourceDataType:"content"}))),g&&g(y)})}hasTransition(){return!1}hasTile(g){return!this.tileBounds||this.tileBounds.contains(g.canonical)}loaded(){return this._loaded}loadTile(g,o){const c=this.map._requestManager.normalizeTileURL(g.tileID.canonical.url(this.tiles,this.scheme)),y={request:this.map._requestManager.transformRequest(c,r.R.Tile),data:void 0,uid:g.uid,tileID:g.tileID,tileZoom:g.tileZoom,zoom:g.tileID.overscaledZ,tileSize:this.tileSize*g.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:g.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0};if(g.actor&&g.state!=="expired")if(g.state==="loading")g.reloadCallback=o;else{if(g.buckets){const T=Object.values(g.buckets);for(const A of T)A.dirty=!0;return void(g.state="loaded")}g.request=g.actor.send("reloadTile",y,S.bind(this))}else g.actor=this.dispatcher.getActor(),g.request=g.actor.send("loadTile",y,S.bind(this),void 0,!0);function S(T,A){return g.aborted?o(null):T&&T.status!==404?o(T):(A&&(A.resourceTiming&&(g.resourceTiming=A.resourceTiming),this.map._refreshExpiredTiles&&g.setExpiryData(A),g.buckets={...g.buckets,...A.buckets},A.featureIndex&&(g.latestFeatureIndex=A.featureIndex)),g.state="loaded",void o(null))}}serialize(){return r.l({},this._options)}},canvas:class extends r.aD{constructor(g,o,c,y){super(g,o,c,y),o.coordinates?Array.isArray(o.coordinates)&&o.coordinates.length===4&&!o.coordinates.some(S=>!Array.isArray(S)||S.length!==2||S.some(T=>typeof T!="number"))||this.fire(new r.t(new r.V(`sources.${g}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new r.t(new r.V(`sources.${g}`,null,'missing required property "coordinates"'))),o.animate&&typeof o.animate!="boolean"&&this.fire(new r.t(new r.V(`sources.${g}`,null,'optional "animate" property must be a boolean value'))),o.canvas?typeof o.canvas=="string"||o.canvas instanceof HTMLCanvasElement||this.fire(new r.t(new r.V(`sources.${g}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new r.t(new r.V(`sources.${g}`,null,'missing required property "canvas"'))),this.options=o,this.animate=o.animate===void 0||o.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new r.t(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(g){this.map=g,this.load(),this.canvas&&this.animate&&this.play()}onRemove(g){this.pause()}prepare(){let g=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,g=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,g=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const o=this.map.painter.context;this.texture?!g&&!this._playing||this.texture instanceof r.aF||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new r.T(o,this.canvas,o.gl.RGBA8,{premultiply:!0}),this._prepareData(o)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const g of[this.canvas.width,this.canvas.height])if(isNaN(g)||g<=0)return!0;return!1}},custom:class extends r.E{constructor(g,o,c,y){super(),this.id=g,this.type="custom",this._dataType="raster",this._dispatcher=c,this._implementation=o,this.setEventedParent(y),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new r.t(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new r.t(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Us(this._implementation.bounds,this.minzoom,this.maxzoom)),o.update=this._update.bind(this),o.clearTiles=this._clearTiles.bind(this),o.coveringTiles=this._coveringTiles.bind(this),r.l(this,r.ar(o,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return r.ar(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new r.x("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.x("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(g){this.map=g,this._loaded=!1,this.fire(new r.x("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(g),this.load()}onRemove(g){this._implementation.onRemove&&this._implementation.onRemove(g)}hasTile(g){if(this._implementation.hasTile){const{x:o,y:c,z:y}=g.canonical;return this._implementation.hasTile({x:o,y:c,z:y})}return!this.tileBounds||this.tileBounds.contains(g.canonical)}loadTile(g,o){const{x:c,y,z:S}=g.tileID.canonical,T=new AbortController;g.request=Promise.resolve(this._implementation.loadTile({x:c,y,z:S},{signal:T.signal})).then((function(A){return delete g.request,g.aborted?(g.state="unloaded",o(null)):A===void 0?(g.state="errored",o(null)):A===null?(this.loadTileData(g,{width:this.tileSize,height:this.tileSize,data:null}),g.state="loaded",o(null)):function($){return $ instanceof ImageData||$ instanceof HTMLCanvasElement||$ instanceof ImageBitmap||$ instanceof HTMLImageElement}(A)?(this.loadTileData(g,A),g.state="loaded",void o(null)):(g.state="errored",o(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(A=>{A.code!==20&&(g.state="errored",o(A))}),g.request.cancel=()=>T.abort()}loadTileData(g,o){g.setTexture(o,this.map.painter)}unloadTile(g,o){if(g.texture&&g.texture instanceof r.T?(g.destroy(!0),g.texture&&g.texture instanceof r.T&&this.map.painter.saveTileTexture(g.texture)):g.destroy(),this._implementation.unloadTile){const{x:c,y,z:S}=g.tileID.canonical;this._implementation.unloadTile({x:c,y,z:S})}o&&o()}abortTile(g,o){g.request&&g.request.cancel&&(g.request.cancel(),delete g.request),o&&o()}hasTransition(){return!1}_coveringTiles(){return this.map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(g=>({x:g.canonical.x,y:g.canonical.y,z:g.canonical.z}))}_clearTiles(){const g=r.av(this.id,this.scope);this.map.style.clearSource(g)}_update(){this.fire(new r.x("data",{dataType:"source",sourceDataType:"content"}))}}},Rs=function(g,o,c,y){const S=new Xo[o.type](g,o,c,y);if(S.id!==g)throw new Error(`Expected Source id to be ${g} instead of ${S.id}`);return r.aJ(["load","abort","unload","serialize","prepare"],S),S};function ld(g,o){const c=r.a6.mat4.identity([]);return r.a6.mat4.scale(c,c,[.5*g.width,.5*-g.height,1]),r.a6.mat4.translate(c,c,[1,-1,0]),r.a6.mat4.multiply(c,c,g.calculateProjMatrix(o.toUnwrapped())),Float32Array.from(c)}function Qd(g,o,c,y,S,T,A,$=!1){const Y=g.tilesIn(y,A,$);Y.sort(lu);const ee=[];for(const ue of Y)ee.push({wrappedTileID:ue.tile.tileID.wrapped().key,queryResults:ue.tile.queryRenderedFeatures(o,c,g._state,ue,S,T,ld(g.transform,ue.tile.tileID),$)});const te=function(ue){const fe={},me={};for(const ke of ue){const Le=ke.queryResults,De=ke.wrappedTileID,Fe=me[De]=me[De]||{};for(const Ye in Le){const Je=Le[Ye],qe=Fe[Ye]=Fe[Ye]||{},it=fe[Ye]=fe[Ye]||[];for(const rt of Je)qe[rt.featureIndex]||(qe[rt.featureIndex]=!0,it.push(rt))}}return fe}(ee);for(const ue in te)te[ue].forEach(fe=>{const me=fe.feature,ke=me.layer;ke&&ke.type!=="background"&&ke.type!=="sky"&&ke.type!=="slot"&&(me.source=ke.source,ke["source-layer"]&&(me.sourceLayer=ke["source-layer"]),me.state=me.id!==void 0?g.getFeatureState(ke["source-layer"],me.id):{})});return te}function Cc(g,o){const c=g.getRenderableIds().map(T=>g.getTileByID(T)),y=[],S={};for(let T=0;T<c.length;T++){const A=c[T],$=A.tileID.canonical.key;S[$]||(S[$]=!0,A.querySourceFeatures(y,o))}return y}function lu(g,o){const c=g.tileID,y=o.tileID;return c.overscaledZ-y.overscaledZ||c.canonical.y-y.canonical.y||c.wrap-y.wrap||c.canonical.x-y.canonical.x}const ea=32,Os=33,rs=new Uint16Array(8184);for(let g=0;g<2046;g++){let o=g+2,c=0,y=0,S=0,T=0,A=0,$=0;for(1&o?S=T=A=ea:c=y=$=ea;(o>>=1)>1;){const ee=c+S>>1,te=y+T>>1;1&o?(S=c,T=y,c=A,y=$):(c=S,y=T,S=A,T=$),A=ee,$=te}const Y=4*g;rs[Y+0]=c,rs[Y+1]=y,rs[Y+2]=S,rs[Y+3]=T}const Do=new Uint16Array(2178),Ma=new Uint8Array(1089),Wa=new Uint16Array(1089);function eh(g){return g===0?-.03125:g===32?.03125:0}const Ou={type:2,extent:r.ab,loadGeometry:()=>[[new r.P(0,0),new r.P(r.ab+1,0),new r.P(r.ab+1,r.ab+1),new r.P(0,r.ab+1),new r.P(0,0)]]};class ne{constructor(o,c,y,S,T){this.tileID=o,this.uid=r.aP(),this.uses=0,this.tileSize=c,this.tileZoom=y,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=T,S&&S.style&&(this._lastUpdatedBrightness=S.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",S&&S.transform&&(this.projection=S.transform.projection)}registerFadeDuration(o){const c=o+this.timeAdded;c<r.q.now()||this.fadeEndTime&&c<this.fadeEndTime||(this.fadeEndTime=c)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=r.aK(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(o,c,y){if(this.unloadVectorData(),this.state="loaded",o){o.featureIndex&&(this.latestFeatureIndex=o.featureIndex,o.rawTileData?(this.latestRawTileData=o.rawTileData,this.latestFeatureIndex.rawTileData=o.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=o.collisionBoxArray,this.buckets=function(S,T){const A={};if(!T)return A;for(const $ of S){const Y=$.layerIds.map(ee=>T.getLayer(ee)).filter(Boolean);if(Y.length!==0){$.layers=Y,$.stateDependentLayerIds&&($.stateDependentLayers=$.stateDependentLayerIds.map(ee=>Y.filter(te=>te.id===ee)[0]));for(const ee of Y)A[ee.fqid]=$}}return A}(o.buckets,c.style),this.hasSymbolBuckets=!1;for(const S in this.buckets){const T=this.buckets[S];if(T instanceof r.aR){if(this.hasSymbolBuckets=!0,!y)break;T.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const S in this.buckets){const T=this.buckets[S];if(T instanceof r.aR&&T.hasRTLText){this.hasRTLText=!0,r.aS();break}}this.queryPadding=0;for(const S in this.buckets){const T=this.buckets[S],A=c.style.getOwnLayer(S);if(!A)continue;const $=A.queryRadius(T);this.queryPadding=Math.max(this.queryPadding,$)}o.imageAtlas&&(this.imageAtlas=o.imageAtlas),o.glyphAtlasImage&&(this.glyphAtlasImage=o.glyphAtlasImage),o.lineAtlas&&(this.lineAtlas=o.lineAtlas),this._lastUpdatedBrightness=o.brightness}else this.collisionBoxArray=new r.aQ}unloadVectorData(){if(this.hasData()){for(const o in this.buckets)this.buckets[o].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(o){return this.buckets[o.fqid]}upload(o){for(const S in this.buckets){const T=this.buckets[S];T.uploadPending()&&T.upload(o)}const c=o.gl,y=this.imageAtlas;if(y&&!y.uploaded){const S=!!Object.keys(y.patternPositions).length;this.imageAtlasTexture=new r.T(o,y.image,c.RGBA8,{useMipmap:S}),this.imageAtlas.uploaded=!0}this.glyphAtlasImage&&(this.glyphAtlasTexture=new r.T(o,this.glyphAtlasImage,c.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new r.T(o,this.lineAtlas.image,c.R8),this.lineAtlas.uploaded=!0)}prepare(o,c,y){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(o,this.imageAtlasTexture,y),!c||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const S=c.style.getBrightness();(this._lastUpdatedBrightness||S)&&(this._lastUpdatedBrightness&&S&&Math.abs(this._lastUpdatedBrightness-S)<.001||(this._lastUpdatedBrightness=S,this.updateBuckets(c)))}queryRenderedFeatures(o,c,y,S,T,A,$,Y){return this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)?this.latestFeatureIndex.query({tileResult:S,pixelPosMatrix:$,transform:A,params:T,tileTransform:this.tileTransform},o,c,y):{}}querySourceFeatures(o,c){const y=this.latestFeatureIndex;if(!y||!y.rawTileData)return;const S=y.loadVTLayers(),T=c?c.sourceLayer:"",A=S._geojsonTileLayer||S[T];if(!A)return;const $=r.aT(c&&c.filter),{z:Y,x:ee,y:te}=this.tileID.canonical,ue={z:Y,x:ee,y:te};for(let fe=0;fe<A.length;fe++){const me=A.feature(fe);if($.needGeometry){const De=r.aU(me,!0);if(!$.filter(new r.a3(this.tileID.overscaledZ),De,this.tileID.canonical))continue}else if(!$.filter(new r.a3(this.tileID.overscaledZ),me))continue;const ke=y.getId(me,T),Le=new r.aV(me,Y,ee,te,ke);Le.tile=ue,o.push(Le)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(o){const c=this.expirationTime;if(o.cacheControl){const y=r.aW(o.cacheControl);y["max-age"]&&(this.expirationTime=Date.now()+1e3*y["max-age"])}else o.expires&&(this.expirationTime=new Date(o.expires).getTime());if(this.expirationTime){const y=Date.now();let S=!1;if(this.expirationTime>y)S=!1;else if(c)if(this.expirationTime<c)S=!0;else{const T=this.expirationTime-c;T?this.expirationTime=y+Math.max(T,3e4):S=!0}else S=!0;S?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(o,c){this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(o).length!==0&&c&&this.updateBuckets(c)}updateBuckets(o){if(!this.latestFeatureIndex)return;const c=this.latestFeatureIndex.loadVTLayers(),y=o.style.listImages(),S=o.style.getBrightness();for(const T in this.buckets){if(!o.style.hasLayer(T))continue;const A=this.buckets[T],$=A.layers[0].sourceLayer||"_geojsonTileLayer",Y=c[$],ee=o.style.getOwnSourceCache(A.layers[0].source);let te={};ee&&(te=ee._state.getState($,void 0)),A.update(te,Y,y,this.imageAtlas&&this.imageAtlas.patternPositions||{},S),(A instanceof r.aX||A instanceof r.aY)&&o._terrain&&o._terrain.enabled&&ee&&A.programConfigurations.needsUpload&&o._terrain._clearRenderCacheForTile(ee.id,this.tileID);const ue=o&&o.style&&o.style.getOwnLayer(T);ue&&(this.queryPadding=Math.max(this.queryPadding,ue.queryRadius(A)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<r.q.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(o){this.symbolFadeHoldUntil=r.q.now()+o}setTexture(o,c){const y=c.context,S=y.gl;this.texture=this.texture||c.getTileTexture(o.width),this.texture&&this.texture instanceof r.T?this.texture.update(o):(this.texture=new r.T(y,o,S.RGBA8,{useMipmap:!0}),this.texture.bind(S.LINEAR,S.CLAMP_TO_EDGE))}setDependencies(o,c){const y={};for(const S of c)y[S]=!0;this.dependencies[o]=y}hasDependency(o,c){for(const y of o){const S=this.dependencies[y];if(S){for(const T of c)if(S[T])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(o,c){if(!c||c.name==="mercator"||this._tileDebugBuffer)return;const y=r.aZ(Ou,this.tileID.canonical,this.tileTransform)[0],S=new r.a_,T=new r.a$;for(let A=0;A<y.length;A++){const{x:$,y:Y}=y[A];S.emplaceBack($,Y),T.emplaceBack(A)}T.emplaceBack(0),this._tileDebugIndexBuffer=o.createIndexBuffer(T),this._tileDebugBuffer=o.createVertexBuffer(S,r.b0.members),this._tileDebugSegments=r.b1.simpleSegment(0,0,S.length,T.length)}_makeTileBoundsBuffers(o,c){if(this._tileBoundsBuffer||!c||c.name==="mercator")return;const y=r.aZ(Ou,this.tileID.canonical,this.tileTransform)[0];let S,T;if(this.isRaster){const A=function($,Y){const ee=r.aK($,Y),te=Math.pow(2,$.z);for(let De=0;De<Os;De++)for(let Fe=0;Fe<Os;Fe++){const Ye=r.aL(($.x+(Fe+eh(Fe))/ea)/te),Je=r.aM(($.y+(De+eh(De))/ea)/te),qe=Y.project(Ye,Je),it=De*Os+Fe;Do[2*it+0]=Math.round((qe.x*ee.scale-ee.x)*r.ab),Do[2*it+1]=Math.round((qe.y*ee.scale-ee.y)*r.ab)}Ma.fill(0),Wa.fill(0);for(let De=2045;De>=0;De--){const Fe=4*De,Ye=rs[Fe+0],Je=rs[Fe+1],qe=rs[Fe+2],it=rs[Fe+3],rt=Ye+qe>>1,mt=Je+it>>1,dt=rt+mt-Je,yt=mt+Ye-rt,Et=Je*Os+Ye,bt=it*Os+qe,vt=mt*Os+rt,Ot=Math.hypot((Do[2*Et+0]+Do[2*bt+0])/2-Do[2*vt+0],(Do[2*Et+1]+Do[2*bt+1])/2-Do[2*vt+1])>=16;Ma[vt]=Ma[vt]||(Ot?1:0),De<1022&&(Ma[vt]=Ma[vt]||Ma[(Je+yt>>1)*Os+(Ye+dt>>1)]||Ma[(it+yt>>1)*Os+(qe+dt>>1)])}const ue=new r.aN,fe=new r.aO;let me=0;function ke(De,Fe){const Ye=Fe*Os+De;return Wa[Ye]===0&&(ue.emplaceBack(Do[2*Ye+0],Do[2*Ye+1],De*r.ab/ea,Fe*r.ab/ea),Wa[Ye]=++me),Wa[Ye]-1}function Le(De,Fe,Ye,Je,qe,it){const rt=De+Ye>>1,mt=Fe+Je>>1;if(Math.abs(De-qe)+Math.abs(Fe-it)>1&&Ma[mt*Os+rt])Le(qe,it,De,Fe,rt,mt),Le(Ye,Je,qe,it,rt,mt);else{const dt=ke(De,Fe),yt=ke(Ye,Je),Et=ke(qe,it);fe.emplaceBack(dt,yt,Et)}}return Le(0,0,ea,ea,ea,0),Le(ea,ea,0,0,0,ea),{vertices:ue,indices:fe}}(this.tileID.canonical,c);S=A.vertices,T=A.indices}else{S=new r.aN,T=new r.aO;for(const{x:$,y:Y}of y)S.emplaceBack($,Y,0,0);const A=r.b2(S.int16,void 0,4);for(let $=0;$<A.length;$+=3)T.emplaceBack(A[$],A[$+1],A[$+2])}this._tileBoundsBuffer=o.createVertexBuffer(S,r.b3.members),this._tileBoundsIndexBuffer=o.createIndexBuffer(T),this._tileBoundsSegments=r.b1.simpleSegment(0,0,S.length,T.length)}_makeGlobeTileDebugBuffers(o,c){const y=c.projection;if(!y||y.name!=="globe"||c.freezeTileCoverage)return;const S=this.tileID.canonical,T=r.b4(S,c),A=r.b5(T),$=r.a9(c.zoom);let Y;$>0&&(Y=r.a6.mat4.invert(new Float64Array(16),c.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(o,S,c,A,Y,$),this._makeGlobeTileDebugTextBuffer(o,S,c,A,Y,$)}_globePoint(o,c,y,S,T,A,$){let Y=r.b6(o,c,y);if(A){const ee=1<<y.z,te=r.am(S.center.lng),ue=r.at(S.center.lat),fe=(y.x+.5)/ee-te;let me=0;fe>.5?me=-1:fe<-.5&&(me=1);let ke=(o/r.ab+y.x)/ee+me,Le=(c/r.ab+y.y)/ee;ke=(ke-te)*S._pixelsPerMercatorPixel+te,Le=(Le-ue)*S._pixelsPerMercatorPixel+ue;const De=[ke*S.worldSize,Le*S.worldSize,0];r.a6.vec3.transformMat4(De,De,A),Y=r.b7(Y,De,$)}return r.a6.vec3.transformMat4(Y,Y,T)}_makeGlobeTileDebugBorderBuffer(o,c,y,S,T,A){const $=new r.a_,Y=new r.a$,ee=new r.b8,te=(fe,me,ke,Le,De)=>{const Fe=(ke-fe)/(De-1),Ye=(Le-me)/(De-1),Je=$.length;for(let qe=0;qe<De;qe++){const it=fe+qe*Fe,rt=me+qe*Ye;$.emplaceBack(it,rt);const mt=this._globePoint(it,rt,c,y,S,T,A);ee.emplaceBack(mt[0],mt[1],mt[2]),Y.emplaceBack(Je+qe)}},ue=r.ab;te(0,0,ue,0,16),te(ue,0,ue,ue,16),te(ue,ue,0,ue,16),te(0,ue,0,0,16),this._tileDebugIndexBuffer=o.createIndexBuffer(Y),this._tileDebugBuffer=o.createVertexBuffer($,r.b0.members),this._globeTileDebugBorderBuffer=o.createVertexBuffer(ee,r.b9.members),this._tileDebugSegments=r.b1.simpleSegment(0,0,$.length,Y.length)}_makeGlobeTileDebugTextBuffer(o,c,y,S,T,A){const $=r.ab/4,Y=new r.a_,ee=new r.aO,te=new r.b8,ue=25;ee.reserve(32),Y.reserve(ue),te.reserve(ue);const fe=(me,ke)=>ue*me+ke;for(let me=0;me<ue;me++){const ke=me*$;for(let Le=0;Le<ue;Le++){const De=Le*$;Y.emplaceBack(De,ke);const Fe=this._globePoint(De,ke,c,y,S,T,A);te.emplaceBack(Fe[0],Fe[1],Fe[2])}}for(let me=0;me<4;me++)for(let ke=0;ke<4;ke++){const Le=fe(me,ke),De=fe(me,ke+1),Fe=fe(me+1,ke),Ye=fe(me+1,ke+1);ee.emplaceBack(Le,De,Fe),ee.emplaceBack(Fe,De,Ye)}this._tileDebugTextIndexBuffer=o.createIndexBuffer(ee),this._tileDebugTextBuffer=o.createVertexBuffer(Y,r.b0.members),this._globeTileDebugTextBuffer=o.createVertexBuffer(te,r.b9.members),this._tileDebugTextSegments=r.b1.simpleSegment(0,0,ue,32)}destroy(o=!1){for(const c in this.buckets)this.buckets[c].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!o&&this.texture&&this.texture instanceof r.T&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}r.ba.setPbf(r.bb);class Ce extends ne{constructor(o,c,y,S,T){super(o,c,y,S,T),this._workQueue=[],this._fetchQueue=[],this._isHeaderLoaded=!1}setTexture(o,c){const y=c.context,S=y.gl;this.texture=this.texture||c.getTileTexture(o.width),this.texture&&this.texture instanceof r.T?this.texture.update(o,{premultiply:!1}):this.texture=new r.T(y,o,S.RGBA8,{premultiply:!1})}flushQueues(){for(;this._workQueue.length;)this._workQueue.pop()();for(;this._fetchQueue.length;)this._fetchQueue.pop()()}fetchHeader(o=16384,c){const y=this._mrt=new r.ba(30),S=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(o-1)}});return this.entireBuffer=null,this.request=r.bc(S,(T,A,$,Y)=>{if(T)c(T);else try{const ee=y.getHeaderLength(A);if(ee>o)return void(this.request=this.fetchHeader(ee,c));y.parseHeader(A),this._isHeaderLoaded=!0;let te=0;for(const ue of Object.values(y.layers))te=Math.max(te,ue.dataIndex[ue.dataIndex.length-1].last_byte);A.byteLength>=te&&(this.entireBuffer=A),c(null,this.entireBuffer||A,$,Y)}catch(ee){c(ee)}}),this.request}fetchBand(o,c,y){const S=this._mrt;if(!this._isHeaderLoaded||!S)return void y(new Error("Tile header is not ready"));const T=this.actor;if(!T)return void y(new Error("Can't fetch tile band without an actor"));let A;const $=(ue,fe)=>{A.complete(ue,fe),ue?y(ue):(this.updateTextureDescriptor(o,c),y(null,this.textureDescriptor&&this.textureDescriptor.img))},Y=(ue,fe)=>{if(ue)return y(ue);const me=T.send("decodeRasterArray",{buffer:fe,task:A},$,void 0,!0);this._workQueue.push(()=>{me&&me.cancel(),A.cancel()})},ee=S.getLayer(o);if(!ee)return void y(new Error(`Unknown sourceLayer "${o}"`));if(ee.hasDataForBand(c))return this.updateTextureDescriptor(o,c),void y(null,this.textureDescriptor?this.textureDescriptor.img:null);const te=ee.getDataRange([c]);if(A=S.createDecodingTask(te),!A||A.tasks.length)if(this.flushQueues(),this.entireBuffer)Y(null,this.entireBuffer.slice(te.firstByte,te.lastByte+1));else{const ue=Object.assign({},this.requestParams,{headers:{Range:`bytes=${te.firstByte}-${te.lastByte}`}}),fe=r.bc(ue,Y);this._fetchQueue.push(()=>{fe.cancel(),A.cancel()})}else y(null)}updateNeeded(o,c){return(!this.textureDescriptor||this.textureDescriptor.band!==c||this.textureDescriptor.layer!==o)&&this.state!=="errored"}updateTextureDescriptor(o,c){if(!this._mrt)return;const y=this._mrt.getLayer(o);if(!y||!y.hasBand(c)||!y.hasDataForBand(c))return;const{bytes:S,tileSize:T,buffer:A,offset:$,scale:Y}=y.getBandView(c),ee=T+2*A,te={data:S,width:ee,height:ee},ue=this.texture;ue&&ue instanceof r.T&&ue.update(te,{premultiply:!1}),this.textureDescriptor={layer:o,band:c,img:te,buffer:A,offset:$,tileSize:T,format:y.pixelFormat,mix:[Y,256*Y,65536*Y,16777216*Y]}}}class et{constructor(o,c){this.max=o,this.onRemove=c,this.reset()}reset(){for(const o in this.data)for(const c of this.data[o])c.timeout&&clearTimeout(c.timeout),this.onRemove(c.value);return this.data={},this.order=[],this}add(o,c,y){const S=o.wrapped().key;this.data[S]===void 0&&(this.data[S]=[]);const T={value:c,timeout:void 0};if(y!==void 0&&(T.timeout=setTimeout(()=>{this.remove(o,T)},y)),this.data[S].push(T),this.order.push(S),this.order.length>this.max){const A=this._getAndRemoveByKey(this.order[0]);A&&this.onRemove(A)}return this}has(o){return o.wrapped().key in this.data}getAndRemove(o){return this.has(o)?this._getAndRemoveByKey(o.wrapped().key):null}_getAndRemoveByKey(o){const c=this.data[o].shift();return c.timeout&&clearTimeout(c.timeout),this.data[o].length===0&&delete this.data[o],this.order.splice(this.order.indexOf(o),1),c.value}getByKey(o){const c=this.data[o];return c?c[0].value:null}get(o){return this.has(o)?this.data[o.wrapped().key][0].value:null}remove(o,c){if(!this.has(o))return this;const y=o.wrapped().key,S=c===void 0?0:this.data[y].indexOf(c),T=this.data[y][S];return this.data[y].splice(S,1),T.timeout&&clearTimeout(T.timeout),this.data[y].length===0&&delete this.data[y],this.onRemove(T.value),this.order.splice(this.order.indexOf(y),1),this}setMaxSize(o){for(this.max=o;this.order.length>this.max;){const c=this._getAndRemoveByKey(this.order[0]);c&&this.onRemove(c)}return this}filter(o){const c=[];for(const y in this.data)for(const S of this.data[y])o(S.value)||c.push(S);for(const y of c)this.remove(y.value.tileID,y)}}class kt{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(o,c,y){const S=String(c);if(this.stateChanges[o]=this.stateChanges[o]||{},this.stateChanges[o][S]=this.stateChanges[o][S]||{},r.l(this.stateChanges[o][S],y),this.deletedStates[o]===null){this.deletedStates[o]={};for(const T in this.state[o])T!==S&&(this.deletedStates[o][T]=null)}else if(this.deletedStates[o]&&this.deletedStates[o][S]===null){this.deletedStates[o][S]={};for(const T in this.state[o][S])y[T]||(this.deletedStates[o][S][T]=null)}else for(const T in y)this.deletedStates[o]&&this.deletedStates[o][S]&&this.deletedStates[o][S][T]===null&&delete this.deletedStates[o][S][T]}removeFeatureState(o,c,y){if(this.deletedStates[o]===null)return;const S=String(c);if(this.deletedStates[o]=this.deletedStates[o]||{},y&&c!==void 0)this.deletedStates[o][S]!==null&&(this.deletedStates[o][S]=this.deletedStates[o][S]||{},this.deletedStates[o][S][y]=null);else if(c!==void 0)if(this.stateChanges[o]&&this.stateChanges[o][S])for(y in this.deletedStates[o][S]={},this.stateChanges[o][S])this.deletedStates[o][S][y]=null;else this.deletedStates[o][S]=null;else this.deletedStates[o]=null}getState(o,c){const y=this.state[o]||{},S=this.stateChanges[o]||{},T=this.deletedStates[o];if(T===null)return{};if(c!==void 0){const $=String(c),Y=r.l({},y[$],S[$]);if(T){const ee=T[c];if(ee===null)return{};for(const te in ee)delete Y[te]}return Y}const A=r.l({},y,S);if(T)for(const $ in T)delete A[$];return A}initializeTileState(o,c){o.setFeatureState(this.state,c)}coalesceChanges(o,c){const y={};for(const S in this.stateChanges){this.state[S]=this.state[S]||{};const T={};for(const A in this.stateChanges[S])this.state[S][A]||(this.state[S][A]={}),r.l(this.state[S][A],this.stateChanges[S][A]),T[A]=this.state[S][A];y[S]=T}for(const S in this.deletedStates){this.state[S]=this.state[S]||{};const T={};if(this.deletedStates[S]===null)for(const A in this.state[S])T[A]={},this.state[S][A]={};else for(const A in this.deletedStates[S]){if(this.deletedStates[S][A]===null)this.state[S][A]={};else if(this.state[S][A])for(const $ of Object.keys(this.deletedStates[S][A]))delete this.state[S][A][$];T[A]=this.state[S][A]}y[S]=y[S]||{},r.l(y[S],T)}if(this.stateChanges={},this.deletedStates={},Object.keys(y).length!==0)for(const S in o)o[S].setFeatureState(y,c)}}class jt extends r.E{constructor(o,c,y){super(),this.id=o,this._onlySymbols=y,c.on("data",S=>{S.dataType==="source"&&S.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&S.dataType==="source"&&S.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),c.on("error",()=>{this._sourceErrored=!0}),this._source=c,this._tiles={},this._cache=new et(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=c.minTileCacheSize,this._maxTileCacheSize=c.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new kt,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="raster-array"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(o){this.map=o,this._minTileCacheSize=this._minTileCacheSize===void 0&&o?o._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&o?o._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const o in this._tiles){const c=this._tiles[o];if(c.state!=="loaded"&&c.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const o=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,o&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(o,c){return o.isSymbolTile=this._onlySymbols,o.isExtraShadowCaster=this._shadowCasterTiles[o.tileID.key],this._source.loadTile(o,c)}_unloadTile(o){if(this._source.unloadTile)return this._source.unloadTile(o)}_abortTile(o){if(this._source.abortTile)return this._source.abortTile(o)}serialize(){return this._source.serialize()}prepare(o){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const c in this._tiles){const y=this._tiles[c];y.upload(o),y.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return r.bd(this._tiles).map(o=>o.tileID).sort(Ut).map(o=>o.key)}getRenderableIds(o,c){const y=[];for(const S in this._tiles)this._isIdRenderable(+S,o,c)&&y.push(this._tiles[S]);return o?y.sort((S,T)=>{const A=S.tileID,$=T.tileID,Y=new r.P(A.canonical.x,A.canonical.y)._rotate(this.transform.angle),ee=new r.P($.canonical.x,$.canonical.y)._rotate(this.transform.angle);return A.overscaledZ-$.overscaledZ||ee.y-Y.y||ee.x-Y.x}).map(S=>S.tileID.key):y.map(S=>S.tileID).sort(Ut).map(S=>S.key)}hasRenderableParent(o){const c=this.findLoadedParent(o,0);return!!c&&this._isIdRenderable(c.tileID.key)}_isIdRenderable(o,c,y){return this._tiles[o]&&this._tiles[o].hasData()&&!this._coveredTiles[o]&&(c||!this._tiles[o].holdingForFade())&&(y||!this._shadowCasterTiles[o])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const o in this._tiles)this._tiles[o].state!=="errored"&&this._reloadTile(+o,"reloading")}}_reloadTile(o,c){const y=this._tiles[o];y&&(y.state!=="loading"&&(y.state=c),this._loadTile(y,this._tileLoaded.bind(this,y,o,c)))}_tileLoaded(o,c,y,S){if(S)if(o.state="errored",S.status!==404)this._source.fire(new r.t(S,{tile:o}));else{if(this._source.fire(new r.x("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id,tile:o})),!(o.tileID.key in this._loadedParentTiles))return;if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const T=this.map.painter.terrain;this.update(this.transform,T.getScaledDemTileSize(),!0),T.resetTileLookupCache(this.id)}else this.update(this.transform)}else o.timeAdded=r.q.now(),y==="expired"&&(o.refreshedUponExpiration=!0),this._setTileReloadTimer(c,o),this._source.type==="raster-dem"&&o.dem&&this._backfillDEM(o),this._state.initializeTileState(o,this.map?this.map.painter:null),this._source.fire(new r.x("data",{dataType:"source",tile:o,coord:o.tileID,sourceCacheId:this.id}))}_backfillDEM(o){const c=this.getRenderableIds();for(let S=0;S<c.length;S++){const T=c[S];if(o.neighboringTiles&&o.neighboringTiles[T]){const A=this.getTileByID(T);y(o,A),y(A,o)}}function y(S,T){if(!S.dem||S.dem.borderReady)return;S.needsHillshadePrepare=!0,S.needsDEMTextureUpload=!0;let A=T.tileID.canonical.x-S.tileID.canonical.x;const $=T.tileID.canonical.y-S.tileID.canonical.y,Y=Math.pow(2,S.tileID.canonical.z),ee=T.tileID.key;A===0&&$===0||Math.abs($)>1||(Math.abs(A)>1&&(Math.abs(A+Y)===1?A+=Y:Math.abs(A-Y)===1&&(A-=Y)),T.dem&&S.dem&&(S.dem.backfillBorder(T.dem,A,$),S.neighboringTiles&&S.neighboringTiles[ee]&&(S.neighboringTiles[ee].backfilled=!0)))}}getTile(o){return this.getTileByID(o.key)}getTileByID(o){return this._tiles[o]}_retainLoadedChildren(o,c,y,S){for(const T in this._tiles){let A=this._tiles[T];if(S[T]||!A.hasData()||A.tileID.overscaledZ<=c||A.tileID.overscaledZ>y)continue;let $=A.tileID;for(;A&&A.tileID.overscaledZ>c+1;){const ee=A.tileID.scaledTo(A.tileID.overscaledZ-1);A=this._tiles[ee.key],A&&A.hasData()&&($=ee)}let Y=$;for(;Y.overscaledZ>c;)if(Y=Y.scaledTo(Y.overscaledZ-1),o[Y.key]){S[$.key]=$;break}}}findLoadedParent(o,c){if(o.key in this._loadedParentTiles){const y=this._loadedParentTiles[o.key];return y&&y.tileID.overscaledZ>=c?y:null}for(let y=o.overscaledZ-1;y>=c;y--){const S=o.scaledTo(y),T=this._getLoadedTile(S);if(T)return T}}_getLoadedTile(o){const c=this._tiles[o.key];return c&&c.hasData()?c:this._cache.getByKey(this._source.reparseOverscaled?o.wrapped().key:o.canonical.key)}updateCacheSize(o,c){c=c||this._source.tileSize;const y=Math.ceil(o.width/c)+1,S=Math.ceil(o.height/c)+1,T=Math.floor(y*S*5),A=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,T):T,$=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,A):A;this._cache.setMaxSize($)}handleWrapJump(o){const c=Math.round((o-(this._prevLng===void 0?o:this._prevLng))/360);if(this._prevLng=o,c){const y={};for(const S in this._tiles){const T=this._tiles[S];T.tileID=T.tileID.unwrapTo(T.tileID.wrap+c),y[T.tileID.key]=T}this._tiles=y;for(const S in this._timers)clearTimeout(this._timers[S]),delete this._timers[S];for(const S in this._tiles)this._setTileReloadTimer(+S,this._tiles[S])}}update(o,c,y,S){if(this.transform=o,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!y)return;this.updateCacheSize(o,c),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={};const T=this._source.type==="batched-model";let A;if(this.used||this.usedForTerrain){if(this._source.tileID)A=o.getVisibleUnwrappedCoordinates(this._source.tileID).map(ee=>new r.aA(ee.canonical.z,ee.wrap,ee.canonical.z,ee.canonical.x,ee.canonical.y));else if(this.tileCoverLift!==0){const ee=o.clone();ee.tileCoverLift=this.tileCoverLift,A=ee.coveringTiles({tileSize:c||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!y,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:T}),this._source.minzoom<=1&&o.projection.name==="globe"&&(A.push(new r.aA(1,0,1,0,0)),A.push(new r.aA(1,0,1,1,0)),A.push(new r.aA(1,0,1,0,1)),A.push(new r.aA(1,0,1,1,1)))}else if(A=o.coveringTiles({tileSize:c||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!y,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:T}),this._source.hasTile){const ee=this._source.hasTile.bind(this._source);A=A.filter(te=>ee(te))}}else A=[];if(A.length>0&&this.castsShadows&&S&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!nn(this._source.type)){const ee=o.coveringZoomLevel({tileSize:c||this._source.tileSize,roundZoom:this._source.roundZoom&&!y}),te=Math.min(ee,this._source.maxzoom);if(T){const ue=o.extendTileCover(A,te);for(const fe of ue)A.push(fe)}else{const ue=o.extendTileCover(A,te,S);for(const fe of ue)this._shadowCasterTiles[fe.key]=!0,A.push(fe)}}const $=this._updateRetainedTiles(A);if(nn(this._source.type)&&A.length!==0){const ee={},te={},ue=Object.keys($);for(const me of ue){const ke=$[me],Le=this._tiles[me];if(!Le||Le.fadeEndTime&&Le.fadeEndTime<=r.q.now())continue;const De=this.findLoadedParent(ke,Math.max(ke.overscaledZ-jt.maxOverzooming,this._source.minzoom));De&&(this._addTile(De.tileID),ee[De.tileID.key]=De.tileID),te[me]=ke}const fe=A[A.length-1].overscaledZ;for(const me in this._tiles){const ke=this._tiles[me];if($[me]||!ke.hasData())continue;let Le=ke.tileID;for(;Le.overscaledZ>fe;){Le=Le.scaledTo(Le.overscaledZ-1);const De=this._tiles[Le.key];if(De&&De.hasData()&&te[Le.key]){$[me]=ke.tileID;break}}}for(const me in ee)$[me]||(this._coveredTiles[me]=!0,$[me]=ee[me])}for(const ee in $)this._tiles[ee].clearFadeHold();const Y=r.be(this._tiles,$);for(const ee of Y){const te=this._tiles[ee];te.hasSymbolBuckets&&!te.holdingForFade()?te.setHoldDuration(this.map._fadeDuration):te.hasSymbolBuckets&&!te.symbolFadeFinished()||this._removeTile(+ee)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const o in this._tiles)this._tiles[o].holdingForFade()&&this._removeTile(+o)}_updateRetainedTiles(o){const c={};if(o.length===0)return c;const y={},S=o.reduce((ee,te)=>Math.min(ee,te.overscaledZ),1/0),T=o[0].overscaledZ,A=Math.max(T-jt.maxOverzooming,this._source.minzoom),$=Math.max(T+jt.maxUnderzooming,this._source.minzoom),Y={};for(const ee of o){const te=this._addTile(ee);c[ee.key]=ee,te.hasData()||S<this._source.maxzoom&&(Y[ee.key]=ee)}this._retainLoadedChildren(Y,S,$,c);for(const ee of o){let te=this._tiles[ee.key];if(te.hasData())continue;if(ee.canonical.z>=this._source.maxzoom){const fe=ee.children(this._source.maxzoom)[0],me=this.getTile(fe);if(me&&me.hasData()){c[fe.key]=fe;continue}}else{const fe=ee.children(this._source.maxzoom);if(c[fe[0].key]&&c[fe[1].key]&&c[fe[2].key]&&c[fe[3].key])continue}let ue=te.wasRequested();for(let fe=ee.overscaledZ-1;fe>=A;--fe){const me=ee.scaledTo(fe);if(y[me.key]||(y[me.key]=!0,te=this.getTile(me),!te&&ue&&(te=this._addTile(me)),te&&(c[me.key]=me,ue=te.wasRequested(),te.hasData())))break}}return c}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const o in this._tiles){const c=[];let y,S=this._tiles[o].tileID;for(;S.overscaledZ>0;){if(S.key in this._loadedParentTiles){y=this._loadedParentTiles[S.key];break}c.push(S.key);const T=S.scaledTo(S.overscaledZ-1);if(y=this._getLoadedTile(T),y)break;S=T}for(const T of c)this._loadedParentTiles[T]=y}}_addTile(o){let c=this._tiles[o.key];if(c)return c.isExtraShadowCaster!==!0||this._shadowCasterTiles[o.key]||this._reloadTile(o.key,"reloading"),c;c=this._cache.getAndRemove(o),c&&(this._setTileReloadTimer(o.key,c),c.tileID=o,this._state.initializeTileState(c,this.map?this.map.painter:null),this._cacheTimers[o.key]&&(clearTimeout(this._cacheTimers[o.key]),delete this._cacheTimers[o.key],this._setTileReloadTimer(o.key,c)));const y=!!c;if(!y){const S=this.map?this.map.painter:null,T=this._source.tileSize*o.overscaleFactor();c=this._source.type==="raster-array"?new Ce(o,T,this.transform.tileZoom,S,this._isRaster):new ne(o,T,this.transform.tileZoom,S,this._isRaster),this._loadTile(c,this._tileLoaded.bind(this,c,o.key,c.state))}return c?(c.uses++,this._tiles[o.key]=c,y||this._source.fire(new r.x("dataloading",{tile:c,coord:c.tileID,dataType:"source"})),c):null}_setTileReloadTimer(o,c){o in this._timers&&(clearTimeout(this._timers[o]),delete this._timers[o]);const y=c.getExpiryTimeout();y&&(this._timers[o]=setTimeout(()=>{this._reloadTile(o,"expired"),delete this._timers[o]},y))}_removeTile(o){const c=this._tiles[o];c&&(c.uses--,delete this._tiles[o],this._timers[o]&&(clearTimeout(this._timers[o]),delete this._timers[o]),c.uses>0||(c.hasData()&&c.state!=="reloading"||c.state==="empty"?this._cache.add(c.tileID,c,c.getExpiryTimeout()):(c.aborted=!0,this._abortTile(c),this._unloadTile(c))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const o in this._tiles)this._removeTile(+o);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(o,c,y){const S=[],T=this.transform;if(!T)return S;const A=T.projection.name==="globe",$=r.am(T.center.lng);for(const Y in this._tiles){const ee=this._tiles[Y];if(y&&ee.clearQueryDebugViz(),ee.holdingForFade())continue;let te;if(A){const ue=ee.tileID.canonical;if(ue.z===0){const fe=[Math.abs(r.ap($,...Xn(ue,-1))-$),Math.abs(r.ap($,...Xn(ue,1))-$)];te=[0,2*fe.indexOf(Math.min(...fe))-1]}else{const fe=[Math.abs(r.ap($,...Xn(ue,-1))-$),Math.abs(r.ap($,...Xn(ue,0))-$),Math.abs(r.ap($,...Xn(ue,1))-$)];te=[fe.indexOf(Math.min(...fe))-1]}}else te=[0];for(const ue of te){const fe=o.containsTile(ee,T,c,ue);fe&&S.push(fe)}}return S}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(o){return this._getRenderableCoordinates(o)}_getRenderableCoordinates(o,c){const y=this.getRenderableIds(o,c).map(T=>this._tiles[T].tileID),S=this.transform.projection.name==="globe";for(const T of y)T.projMatrix=this.transform.calculateProjMatrix(T.toUnwrapped()),T.expandedProjMatrix=S?this.transform.calculateProjMatrix(T.toUnwrapped(),!1,!0):T.projMatrix;return y}sortCoordinatesByDistance(o){const c=o.slice(),y=this.transform._camera.position,S=this.transform._camera.forward(),T={};for(const A of c){const $=1/(1<<A.canonical.z);T[A.key]=((A.canonical.x+.5)*$+A.wrap-y[0])*S[0]+((A.canonical.y+.5)*$-y[1])*S[1]-y[2]*S[2]}return c.sort((A,$)=>T[A.key]-T[$.key]),c}hasTransition(){if(this._source.hasTransition())return!0;if(nn(this._source.type))for(const o in this._tiles){const c=this._tiles[o];if(c.fadeEndTime!==void 0&&c.fadeEndTime>=r.q.now())return!0}return!1}setFeatureState(o,c,y){this._state.updateState(o=o||"_geojsonTileLayer",c,y)}removeFeatureState(o,c,y){this._state.removeFeatureState(o=o||"_geojsonTileLayer",c,y)}getFeatureState(o,c){return this._state.getState(o=o||"_geojsonTileLayer",c)}setDependencies(o,c,y){const S=this._tiles[o];S&&S.setDependencies(c,y)}reloadTilesForDependencies(o,c){for(const y in this._tiles)this._tiles[y].hasDependency(o,c)&&this._reloadTile(+y,"reloading");this._cache.filter(y=>!y.hasDependency(o,c))}_preloadTiles(o,c){if(!this._sourceLoaded){const Y=()=>{this._sourceLoaded&&(this._source.off("data",Y),this._preloadTiles(o,c))};return void this._source.on("data",Y)}const y=new Map,S=Array.isArray(o)?o:[o],T=this.map.painter.terrain,A=this.usedForTerrain&&T?T.getScaledDemTileSize():this._source.tileSize;for(const Y of S){const ee=Y.coveringTiles({tileSize:A,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const te of ee)y.set(te.key,te);this.usedForTerrain&&Y.updateElevation(!1)}const $=Array.from(y.values());r.bf($,(Y,ee)=>{const te=new ne(Y,this._source.tileSize*Y.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(te,ue=>{this._source.type==="raster-dem"&&te.dem&&this._backfillDEM(te),ee(ue,te)})},c)}}function Ut(g,o){const c=Math.abs(2*g.wrap)-+(g.wrap<0),y=Math.abs(2*o.wrap)-+(o.wrap<0);return g.overscaledZ-o.overscaledZ||y-c||o.canonical.y-g.canonical.y||o.canonical.x-g.canonical.x}function nn(g){return g==="raster"||g==="image"||g==="video"||g==="custom"}function Xn(g,o){const c=1<<g.z;return[g.x/c+o,(g.x+1)/c+o]}jt.maxOverzooming=10,jt.maxUnderzooming=3;class rr{constructor(o){this.style=o,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const o=!1,c=!1;for(const y in this.style._mergedLayers){const S=this.style._mergedLayers[y];if(S.type==="fill-extrusion")this.layers.push({layer:S,visible:o,visibilityChanged:c});else if(S.type==="model"){const T=this.style.getLayerSource(S);T&&T.type==="batched-model"&&this.layers.push({layer:S,visible:o,visibilityChanged:c})}}}onNewFrame(o){this.layersGotHidden=!1;for(const c of this.layers){const y=c.layer;let S=!1;y.type==="fill-extrusion"?S=!y.isHidden(o)&&y.paint.get("fill-extrusion-opacity")>0:y.type==="model"&&(S=!y.isHidden(o)&&y.paint.get("model-opacity")>0),this.layersGotHidden=this.layersGotHidden||!S&&c.visible,c.visible=S}}updateZOffset(o,c){this.currentBuildingBuckets=[];for(const S of this.layers){const T=S.layer,A=this.style.getLayerSourceCache(T);let $=1;T.type==="fill-extrusion"&&($=S.visible?T.paint.get("fill-extrusion-vertical-scale"):0);let Y=A?A.getTile(c):null;if(!Y&&A&&c.canonical.z>A.getSource().minzoom){let ee=c.scaledTo(Math.min(A.getSource().maxzoom,c.overscaledZ-1));for(;ee.overscaledZ>=A.getSource().minzoom&&(Y=A.getTile(ee),!Y&&ee.overscaledZ!==0);)ee=ee.scaledTo(ee.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:Y?Y.getBucket(T):null,tileID:Y?Y.tileID:c,verticalScale:$})}o.hasAnyZOffset=!1;let y=!1;for(let S=0;S<o.symbolInstances.length;S++){const T=o.symbolInstances.get(S),A=T.zOffset,$=this._getHeightAtTileOffset(c,T.tileAnchorX,T.tileAnchorY);T.zOffset=$!==Number.NEGATIVE_INFINITY?$:A,y||A===T.zOffset||(y=!0),o.hasAnyZOffset||T.zOffset===0||(o.hasAnyZOffset=!0)}y&&(o.zOffsetBuffersNeedUpload=!0,o.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(o,c,y,S){let T=c,A=y;if(o.canonical.z!==S.canonical.z){const $=S.canonical,Y=1/(1<<o.canonical.z-$.z);T=(c+o.canonical.x*r.ab)*Y-$.x*r.ab|0,A=(y+o.canonical.y*r.ab)*Y-$.y*r.ab|0}return{tileX:T,tileY:A}}_getHeightAtTileOffset(o,c,y){let S,T;for(let A=0;A<this.layers.length;++A){if(this.layers[A].layer.type!=="fill-extrusion")continue;const{bucket:$,tileID:Y,verticalScale:ee}=this.currentBuildingBuckets[A];if(!$)continue;const{tileX:te,tileY:ue}=this._mapCoordToOverlappingTile(o,c,y,Y),fe=$.getHeightAtTileCoord(te,ue);fe&&fe.height!==void 0&&(fe.hidden?S=fe.height:T=Math.max(fe.height*ee,T||0))}if(T!==void 0)return T;for(let A=0;A<this.layers.length;++A){const $=this.layers[A];if($.layer.type!=="model"||!$.visible)continue;const{bucket:Y,tileID:ee}=this.currentBuildingBuckets[A];if(!Y)continue;const{tileX:te,tileY:ue}=this._mapCoordToOverlappingTile(o,c,y,ee),fe=Y.getHeightAtTileCoord(te,ue);if(fe&&!fe.hidden)return fe.height===void 0&&S!==void 0?Math.min(fe.maxHeight,S)*fe.verticalScale:fe.height?fe.height*fe.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function Yn(g,o){const c={};for(const y in g)y!=="ref"&&(c[y]=g[y]);return r.bg.forEach(y=>{y in o&&(c[y]=o[y])}),c}function hr(g){g=g.slice();const o=Object.create(null);for(let c=0;c<g.length;c++)o[g[c].id]=g[c];for(let c=0;c<g.length;c++)"ref"in g[c]&&(g[c]=Yn(g[c],o[g[c].ref]));return g}const Ln={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport"};function ii(g,o,c){c.push({command:Ln.addSource,args:[g,o[g]]})}function Tr(g,o,c){o.push({command:Ln.removeSource,args:[g]}),c[g]=!0}function Kr(g,o,c,y){Tr(g,c,y),ii(g,o,c)}function sr(g,o,c){let y;for(y in g[c])if(g[c].hasOwnProperty(y)&&y!=="data"&&!r.bh(g[c][y],o[c][y]))return!1;for(y in o[c])if(o[c].hasOwnProperty(y)&&y!=="data"&&!r.bh(g[c][y],o[c][y]))return!1;return!0}function jn(g,o,c,y,S,T){let A;for(A in o=o||{},g=g||{})g.hasOwnProperty(A)&&(r.bh(g[A],o[A])||c.push({command:T,args:[y,A,o[A],S]}));for(A in o)o.hasOwnProperty(A)&&!g.hasOwnProperty(A)&&(r.bh(g[A],o[A])||c.push({command:T,args:[y,A,o[A],S]}))}function kr(g){return g.id}function Ri(g,o){return g[o.id]=o,g}class Qi{constructor(o,c){this.reset(o,c)}reset(o,c){this.points=o||[],this._distances=[0];for(let y=1;y<this.points.length;y++)this._distances[y]=this._distances[y-1]+this.points[y].dist(this.points[y-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(c||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(o){if(this.points.length===1)return this.points[0];o=r.ap(o,0,1);let c=1,y=this._distances[c];const S=o*this.paddedLength+this.padding;for(;y<S&&c<this._distances.length;)y=this._distances[++c];const T=c-1,A=this._distances[T],$=y-A,Y=$>0?(S-A)/$:0;return this.points[T].mult(1-Y).add(this.points[c].mult(Y))}}class Mo{constructor(o,c,y){const S=this.boxCells=[],T=this.circleCells=[];this.xCellCount=Math.ceil(o/y),this.yCellCount=Math.ceil(c/y);for(let A=0;A<this.xCellCount*this.yCellCount;A++)S.push([]),T.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=o,this.height=c,this.xScale=this.xCellCount/o,this.yScale=this.yCellCount/c,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(o,c,y,S,T){this._forEachCell(c,y,S,T,this._insertBoxCell,this.boxUid++),this.boxKeys.push(o),this.bboxes.push(c),this.bboxes.push(y),this.bboxes.push(S),this.bboxes.push(T)}insertCircle(o,c,y,S){this._forEachCell(c-S,y-S,c+S,y+S,this._insertCircleCell,this.circleUid++),this.circleKeys.push(o),this.circles.push(c),this.circles.push(y),this.circles.push(S)}_insertBoxCell(o,c,y,S,T,A){this.boxCells[T].push(A)}_insertCircleCell(o,c,y,S,T,A){this.circleCells[T].push(A)}_query(o,c,y,S,T,A){if(y<0||o>this.width||S<0||c>this.height)return!T&&[];const $=[];if(o<=0&&c<=0&&this.width<=y&&this.height<=S){if(T)return!0;for(let Y=0;Y<this.boxKeys.length;Y++)$.push({key:this.boxKeys[Y],x1:this.bboxes[4*Y],y1:this.bboxes[4*Y+1],x2:this.bboxes[4*Y+2],y2:this.bboxes[4*Y+3]});for(let Y=0;Y<this.circleKeys.length;Y++){const ee=this.circles[3*Y],te=this.circles[3*Y+1],ue=this.circles[3*Y+2];$.push({key:this.circleKeys[Y],x1:ee-ue,y1:te-ue,x2:ee+ue,y2:te+ue})}return A?$.filter(A):$}return this._forEachCell(o,c,y,S,this._queryCell,$,{hitTest:T,seenUids:{box:{},circle:{}}},A),T?$.length>0:$}_queryCircle(o,c,y,S,T){const A=o-y,$=o+y,Y=c-y,ee=c+y;if($<0||A>this.width||ee<0||Y>this.height)return!S&&[];const te=[];return this._forEachCell(A,Y,$,ee,this._queryCellCircle,te,{hitTest:S,circle:{x:o,y:c,radius:y},seenUids:{box:{},circle:{}}},T),S?te.length>0:te}query(o,c,y,S,T){return this._query(o,c,y,S,!1,T)}hitTest(o,c,y,S,T){return this._query(o,c,y,S,!0,T)}hitTestCircle(o,c,y,S){return this._queryCircle(o,c,y,!0,S)}_queryCell(o,c,y,S,T,A,$,Y){const ee=$.seenUids,te=this.boxCells[T];if(te!==null){const fe=this.bboxes;for(const me of te)if(!ee.box[me]){ee.box[me]=!0;const ke=4*me;if(o<=fe[ke+2]&&c<=fe[ke+3]&&y>=fe[ke+0]&&S>=fe[ke+1]&&(!Y||Y(this.boxKeys[me]))){if($.hitTest)return A.push(!0),!0;A.push({key:this.boxKeys[me],x1:fe[ke],y1:fe[ke+1],x2:fe[ke+2],y2:fe[ke+3]})}}}const ue=this.circleCells[T];if(ue!==null){const fe=this.circles;for(const me of ue)if(!ee.circle[me]){ee.circle[me]=!0;const ke=3*me;if(this._circleAndRectCollide(fe[ke],fe[ke+1],fe[ke+2],o,c,y,S)&&(!Y||Y(this.circleKeys[me]))){if($.hitTest)return A.push(!0),!0;{const Le=fe[ke],De=fe[ke+1],Fe=fe[ke+2];A.push({key:this.circleKeys[me],x1:Le-Fe,y1:De-Fe,x2:Le+Fe,y2:De+Fe})}}}}}_queryCellCircle(o,c,y,S,T,A,$,Y){const ee=$.circle,te=$.seenUids,ue=this.boxCells[T];if(ue!==null){const me=this.bboxes;for(const ke of ue)if(!te.box[ke]){te.box[ke]=!0;const Le=4*ke;if(this._circleAndRectCollide(ee.x,ee.y,ee.radius,me[Le+0],me[Le+1],me[Le+2],me[Le+3])&&(!Y||Y(this.boxKeys[ke])))return A.push(!0),!0}}const fe=this.circleCells[T];if(fe!==null){const me=this.circles;for(const ke of fe)if(!te.circle[ke]){te.circle[ke]=!0;const Le=3*ke;if(this._circlesCollide(me[Le],me[Le+1],me[Le+2],ee.x,ee.y,ee.radius)&&(!Y||Y(this.circleKeys[ke])))return A.push(!0),!0}}}_forEachCell(o,c,y,S,T,A,$,Y){const ee=this._convertToXCellCoord(o),te=this._convertToYCellCoord(c),ue=this._convertToXCellCoord(y),fe=this._convertToYCellCoord(S);for(let me=ee;me<=ue;me++)for(let ke=te;ke<=fe;ke++)if(T.call(this,o,c,y,S,this.xCellCount*ke+me,A,$,Y))return}_convertToXCellCoord(o){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(o*this.xScale)))}_convertToYCellCoord(o){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(o*this.yScale)))}_circlesCollide(o,c,y,S,T,A){const $=S-o,Y=T-c,ee=y+A;return ee*ee>$*$+Y*Y}_circleAndRectCollide(o,c,y,S,T,A,$){const Y=(A-S)/2,ee=Math.abs(o-(S+Y));if(ee>Y+y)return!1;const te=($-T)/2,ue=Math.abs(c-(T+te));if(ue>te+y)return!1;if(ee<=Y||ue<=te)return!0;const fe=ee-Y,me=ue-te;return fe*fe+me*me<=y*y}}const ta={unknown:0,flipRequired:1,flipNotRequired:2},On=Math.tan(85*Math.PI/180);function xr(g,o,c,y,S,T,A){const $=r.a6.mat4.create();if(c)if(T.name==="globe"){const Y=r.bi(S,o);r.a6.mat4.multiply($,$,Y)}else{const Y=r.a6.mat2.invert([],A);$[0]=Y[0],$[1]=Y[1],$[4]=Y[2],$[5]=Y[3],y||r.a6.mat4.rotateZ($,$,S.angle)}else r.a6.mat4.multiply($,S.labelPlaneMatrix,g);return $}function ai(g,o,c,y,S,T,A){const $=xr(g,o,c,y,S,T,A);return T.name==="globe"&&c||($[2]=$[6]=$[10]=$[14]=0),$}function Gs(g,o,c,y,S,T,A){if(c){if(T.name==="globe"){const $=xr(g,o,c,y,S,T,A);return r.a6.mat4.invert($,$),r.a6.mat4.multiply($,g,$),$}{const $=r.a6.mat4.clone(g),Y=r.a6.mat4.identity([]);return Y[0]=A[0],Y[1]=A[1],Y[4]=A[2],Y[5]=A[3],r.a6.mat4.multiply($,$,Y),y||r.a6.mat4.rotateZ($,$,-S.angle),$}}return S.glCoordMatrix}function oo(g,o,c,y){const S=[g,o,c,1];c?r.a6.vec4.transformMat4(S,S,y):Ec(S,S,y);const T=S[3];return S[0]/=T,S[1]/=T,S[2]/=T,S}function ci(g,o){return Math.min(.5+g/o*.5,1.5)}function us(g,o){const c=g[0]/g[3],y=g[1]/g[3];return c>=-o[0]&&c<=o[0]&&y>=-o[1]&&y<=o[1]}function Fl(g,o,c,y,S,T,A,$,Y,ee){const te=c.transform,ue=y?g.textSizeData:g.iconSizeData,fe=r.bj(ue,c.transform.zoom),me=te.projection.name==="globe",ke=[256/c.width*2+1,256/c.height*2+1],Le=y?g.text.dynamicLayoutVertexArray:g.icon.dynamicLayoutVertexArray;Le.clear();let De=null;me&&(De=y?g.text.globeExtVertexArray:g.icon.globeExtVertexArray);const Fe=g.lineVertexArray,Ye=y?g.text.placedSymbolArray:g.icon.placedSymbolArray,Je=c.transform.width/c.transform.height;let qe,it=!1;for(let rt=0;rt<Ye.length;rt++){const mt=Ye.get(rt),{numGlyphs:dt,writingMode:yt}=mt;if(yt!==r.bk.vertical||it||qe===r.bk.horizontal||(it=!0),qe=yt,(mt.hidden||yt===r.bk.vertical)&&!it){ra(dt,Le);continue}it=!1;const Et=new r.P(mt.tileAnchorX,mt.tileAnchorY);let{x:bt,y:vt,z:Ot}=te.projection.projectTilePoint(Et.x,Et.y,ee.canonical);if(Y){const[pn,_n,_r]=Y(Et);bt+=pn,vt+=_n,Ot+=_r}const sn=[bt,vt,Ot,1];if(r.a6.vec4.transformMat4(sn,sn,o),!us(sn,ke)){ra(dt,Le);continue}const mn=sn[3],on=ci(c.transform.getCameraToCenterDistance(te.projection),mn),Tn=r.bl(ue,fe,mt),Dt=A?Tn/on:Tn*on,dn=oo(bt,vt,Ot,S);if(dn[3]<=0){ra(dt,Le);continue}let cn={};const In=A?null:Y,An=co(mt,Dt,!1,$,o,S,T,g.glyphOffsetArray,Fe,Le,De,dn,Et,cn,Je,In,te.projection,ee,A);it=An.useVertical,In&&An.needsFlipping&&(cn={}),(An.notEnoughRoom||it||An.needsFlipping&&co(mt,Dt,!0,$,o,S,T,g.glyphOffsetArray,Fe,Le,De,dn,Et,cn,Je,In,te.projection,ee,A).notEnoughRoom)&&ra(dt,Le)}y?(g.text.dynamicLayoutVertexBuffer.updateData(Le),De&&g.text.globeExtVertexBuffer&&g.text.globeExtVertexBuffer.updateData(De)):(g.icon.dynamicLayoutVertexBuffer.updateData(Le),De&&g.icon.globeExtVertexBuffer&&g.icon.globeExtVertexBuffer.updateData(De))}function qa(g,o,c,y,S,T,A,$,Y,ee,te,ue,fe,me,ke,Le){const{lineStartIndex:De,glyphStartIndex:Fe,segment:Ye}=$,Je=Fe+$.numGlyphs,qe=De+$.lineLength,it=o.getoffsetX(Fe),rt=o.getoffsetX(Je-1),mt=na(g*it,c,y,S,T,A,Ye,De,qe,Y,ee,te,ue,fe,!0,me,ke,Le);if(!mt)return null;const dt=na(g*rt,c,y,S,T,A,Ye,De,qe,Y,ee,te,ue,fe,!0,me,ke,Le);return dt?{first:mt,last:dt}:null}function ws(g,o,c,y){return g===r.bk.horizontal&&Math.abs(y)>Math.abs(c)?{useVertical:!0}:g===r.bk.vertical?y>0?{needsFlipping:!0}:null:o!==ta.unknown&&function(S,T){return S===0||Math.abs(T/S)>On}(c,y)?o===ta.flipRequired?{needsFlipping:!0}:null:c<0?{needsFlipping:!0}:null}function co(g,o,c,y,S,T,A,$,Y,ee,te,ue,fe,me,ke,Le,De,Fe,Ye){const Je=o/24,qe=g.lineOffsetX*Je,it=g.lineOffsetY*Je,{lineStartIndex:rt,glyphStartIndex:mt,numGlyphs:dt,segment:yt,writingMode:Et,flipState:bt}=g,vt=rt+g.lineLength,Ot=sn=>{if(te){const[Dt,dn,cn]=sn.up,In=ee.length;r.bm(te,In+0,Dt,dn,cn),r.bm(te,In+1,Dt,dn,cn),r.bm(te,In+2,Dt,dn,cn),r.bm(te,In+3,Dt,dn,cn)}const[mn,on,Tn]=sn.point;r.bn(ee,mn,on,Tn,sn.angle)};if(dt>1){const sn=qa(Je,$,qe,it,c,ue,fe,g,Y,T,me,Le,!1,De,Fe,Ye);if(!sn)return{notEnoughRoom:!0};if(y&&!c){let[mn,on,Tn]=sn.first.point,[Dt,dn,cn]=sn.last.point;[mn,on]=oo(mn,on,Tn,A),[Dt,dn]=oo(Dt,dn,cn,A);const In=ws(Et,bt,(Dt-mn)*ke,dn-on);if(g.flipState=In&&In.needsFlipping?ta.flipRequired:ta.flipNotRequired,In)return In}Ot(sn.first);for(let mn=mt+1;mn<mt+dt-1;mn++){const on=na(Je*$.getoffsetX(mn),qe,it,c,ue,fe,yt,rt,vt,Y,T,me,Le,!1,!1,De,Fe,Ye);if(!on)return ee.length-=4*(mn-mt),{notEnoughRoom:!0};Ot(on)}Ot(sn.last)}else{if(y&&!c){const mn=oo(fe.x,fe.y,0,S),on=rt+yt+1,Tn=new r.P(Y.getx(on),Y.gety(on)),Dt=oo(Tn.x,Tn.y,0,S),dn=Dt[3]>0?Dt:uu(fe,Tn,mn,1,S,void 0,De,Fe.canonical),cn=ws(Et,bt,(dn[0]-mn[0])*ke,dn[1]-mn[1]);if(g.flipState=cn&&cn.needsFlipping?ta.flipRequired:ta.flipNotRequired,cn)return cn}const sn=na(Je*$.getoffsetX(mt),qe,it,c,ue,fe,yt,rt,vt,Y,T,me,Le,!1,!1,De,Fe,Ye);if(!sn)return{notEnoughRoom:!0};Ot(sn)}return{}}function qh(g,o,c,y,S){const{x:T,y:A,z:$}=y.projectTilePoint(g.x,g.y,o);if(!S)return oo(T,A,$,c);const[Y,ee,te]=S(g);return oo(T+Y,A+ee,$+te,c)}function uu(g,o,c,y,S,T,A,$){const Y=qh(g.sub(o)._unit()._add(g),$,S,A,T);return r.a6.vec3.sub(Y,c,Y),r.a6.vec3.normalize(Y,Y),r.a6.vec3.scaleAndAdd(Y,c,Y,y)}function na(g,o,c,y,S,T,A,$,Y,ee,te,ue,fe,me,ke,Le,De,Fe){const Ye=y?g-o:g+o;let Je=Ye>0?1:-1,qe=0;y&&(Je*=-1,qe=Math.PI),Je<0&&(qe+=Math.PI);let it=$+A+(Je>0?0:1)|0,rt=S,mt=S,dt=0,yt=0;const Et=Math.abs(Ye),bt=[],vt=[];let Ot=T,sn=Ot;const mn=()=>uu(sn,Ot,mt,Et-dt+1,te,fe,Le,De.canonical);for(;dt+yt<=Et;){if(it+=Je,it<$||it>=Y)return null;if(mt=rt,sn=Ot,bt.push(mt),me&&vt.push(sn),Ot=new r.P(ee.getx(it),ee.gety(it)),rt=ue[it],!rt){const _n=qh(Ot,De.canonical,te,Le,fe);rt=_n[3]>0?ue[it]=_n:mn()}dt+=yt,yt=r.a6.vec3.distance(mt,rt)}ke&&fe&&(ue[it]&&(rt=mn(),yt=r.a6.vec3.distance(mt,rt)),ue[it]=rt);const on=(Et-dt)/yt,Tn=Ot.sub(sn)._mult(on)._add(sn),Dt=r.a6.vec3.sub([],rt,mt),dn=r.a6.vec3.scaleAndAdd([],mt,Dt,on);let cn=[0,0,1],In=Dt[0],An=Dt[1];if(Fe&&(cn=Le.upVector(De.canonical,Tn.x,Tn.y),cn[0]!==0||cn[1]!==0||cn[2]!==1)){const _n=[cn[2],0,-cn[0]],_r=r.a6.vec3.cross([],cn,_n);r.a6.vec3.normalize(_n,_n),r.a6.vec3.normalize(_r,_r),In=r.a6.vec3.dot(Dt,_n),An=r.a6.vec3.dot(Dt,_r)}if(c){const _n=r.a6.vec3.cross([],cn,Dt);r.a6.vec3.normalize(_n,_n),r.a6.vec3.scaleAndAdd(dn,dn,_n,c*Je)}const pn=qe+Math.atan2(An,In);return bt.push(dn),me&&vt.push(Tn),{point:dn,angle:pn,path:bt,tilePath:vt,up:cn}}function ra(g,o){const c=o.length,y=c+4*g;o.resize(y),o.float32.fill(-1/0,4*c,4*y)}function Ec(g,o,c){const y=o[0],S=o[1];return g[0]=c[0]*y+c[4]*S+c[12],g[1]=c[1]*y+c[5]*S+c[13],g[3]=c[3]*y+c[7]*S+c[15],g}const _o=100;class Yo{constructor(o,c,y=new Mo(o.width+200,o.height+200,25),S=new Mo(o.width+200,o.height+200,25)){this.transform=o,this.grid=y,this.ignoredGrid=S,this.pitchfactor=Math.cos(o._pitch)*o.cameraToCenterDistance,this.screenRightBoundary=o.width+_o,this.screenBottomBoundary=o.height+_o,this.gridRightBoundary=o.width+200,this.gridBottomBoundary=o.height+200,this.fogState=c}placeCollisionBox(o,c,y,S,T,A,$,Y){let ee=y.projectedAnchorX,te=y.projectedAnchorY,ue=y.projectedAnchorZ;const fe=y.elevation,me=y.tileID,ke=o.getProjection();if(fe&&me){const[rt,mt,dt]=ke.upVector(me.canonical,y.tileAnchorX,y.tileAnchorY),yt=ke.upVectorScale(me.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;ee+=rt*fe*yt,te+=mt*fe*yt,ue+=dt*fe*yt}const Le=this.projectAndGetPerspectiveRatio($,ee,te,ue,y.tileID,ke.name==="globe"||!!fe||this.transform.pitch>0,ke),De=A*Le.perspectiveRatio,Fe=(y.x1*c+S.x-y.padding)*De+Le.point.x,Ye=(y.y1*c+S.y-y.padding)*De+Le.point.y,Je=(y.x2*c+S.x+y.padding)*De+Le.point.x,qe=(y.y2*c+S.y+y.padding)*De+Le.point.y,it=Le.perspectiveRatio<=.55||Le.occluded;return!this.isInsideGrid(Fe,Ye,Je,qe)||!T&&this.grid.hitTest(Fe,Ye,Je,qe,Y)||it?{box:[],offscreen:!1,occluded:Le.occluded}:{box:[Fe,Ye,Je,qe],offscreen:this.isOffscreen(Fe,Ye,Je,qe),occluded:!1}}placeCollisionCircles(o,c,y,S,T,A,$,Y,ee,te,ue,fe,me,ke,Le){const De=[],Fe=this.transform.elevation,Ye=o.getProjection(),Je=Fe?Fe.getAtTileOffsetFunc(Le,this.transform.center.lat,this.transform.worldSize,Ye):null,qe=new r.P(y.tileAnchorX,y.tileAnchorY);let{x:it,y:rt,z:mt}=Ye.projectTilePoint(qe.x,qe.y,Le.canonical);if(Je){const[Tn,Dt,dn]=Je(qe);it+=Tn,rt+=Dt,mt+=dn}const dt=Ye.name==="globe",yt=this.projectAndGetPerspectiveRatio($,it,rt,mt,Le,dt||!!Fe||this.transform.pitch>0,Ye),{perspectiveRatio:Et}=yt,bt=(ue?A/Et:A*Et)/r.bq,vt=oo(it,rt,mt,Y),Ot=yt.signedDistanceFromCamera>0?qa(bt,T,y.lineOffsetX*bt,y.lineOffsetY*bt,!1,vt,qe,y,S,Y,{},Fe&&!ue?Je:null,ue&&!!Fe,Ye,Le,ue):null;let sn=!1,mn=!1,on=!0;if(Ot&&!yt.occluded){const Tn=.5*me*Et+ke,Dt=new r.P(-100,-100),dn=new r.P(this.screenRightBoundary,this.screenBottomBoundary),cn=new Qi,{first:In,last:An}=Ot,pn=In.path.length;let _n=[];for(let tr=pn-1;tr>=1;tr--)_n.push(In.path[tr]);for(let tr=1;tr<An.path.length;tr++)_n.push(An.path[tr]);const _r=2.5*Tn;ee&&(_n=_n.map(([tr,zr,dr],Ir)=>(Je&&!dt&&(dr=Je(Ir<pn-1?In.tilePath[pn-1-Ir]:An.tilePath[Ir-pn+2])[2]),oo(tr,zr,dr,ee))),_n.some(tr=>tr[3]<=0)&&(_n=[]));let Vn=[];if(_n.length>0){let tr=1/0,zr=-1/0,dr=1/0,Ir=-1/0;for(const oi of _n)tr=Math.min(tr,oi[0]),dr=Math.min(dr,oi[1]),zr=Math.max(zr,oi[0]),Ir=Math.max(Ir,oi[1]);zr>=Dt.x&&tr<=dn.x&&Ir>=Dt.y&&dr<=dn.y&&(Vn=[_n.map(oi=>new r.P(oi[0],oi[1]))],(tr<Dt.x||zr>dn.x||dr<Dt.y||Ir>dn.y)&&(Vn=r.bo(Vn,Dt.x,Dt.y,dn.x,dn.y)))}for(const tr of Vn){cn.reset(tr,.25*Tn);let zr=0;zr=cn.length<=.5*Tn?1:Math.ceil(cn.paddedLength/_r)+1;for(let dr=0;dr<zr;dr++){const Ir=dr/Math.max(zr-1,1),oi=cn.lerp(Ir),Qr=oi.x+_o,Fi=oi.y+_o;De.push(Qr,Fi,Tn,0);const qi=Qr-Tn,ao=Fi-Tn,Gl=Qr+Tn,is=Fi+Tn;if(on=on&&this.isOffscreen(qi,ao,Gl,is),mn=mn||this.isInsideGrid(qi,ao,Gl,is),!c&&this.grid.hitTestCircle(Qr,Fi,Tn,fe)&&(sn=!0,!te))return{circles:[],offscreen:!1,collisionDetected:sn,occluded:!1}}}}return{circles:!te&&sn||!mn?[]:De,offscreen:on,collisionDetected:sn,occluded:yt.occluded}}queryRenderedSymbols(o){if(o.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const c=[];let y=1/0,S=1/0,T=-1/0,A=-1/0;for(const te of o){const ue=new r.P(te.x+_o,te.y+_o);y=Math.min(y,ue.x),S=Math.min(S,ue.y),T=Math.max(T,ue.x),A=Math.max(A,ue.y),c.push(ue)}const $=this.grid.query(y,S,T,A).concat(this.ignoredGrid.query(y,S,T,A)),Y={},ee={};for(const te of $){const ue=te.key;if(Y[ue.bucketInstanceId]===void 0&&(Y[ue.bucketInstanceId]={}),Y[ue.bucketInstanceId][ue.featureIndex])continue;const fe=[new r.P(te.x1,te.y1),new r.P(te.x2,te.y1),new r.P(te.x2,te.y2),new r.P(te.x1,te.y2)];r.bp(c,fe)&&(Y[ue.bucketInstanceId][ue.featureIndex]=!0,ee[ue.bucketInstanceId]===void 0&&(ee[ue.bucketInstanceId]=[]),ee[ue.bucketInstanceId].push(ue.featureIndex))}return ee}insertCollisionBox(o,c,y,S,T){(c?this.ignoredGrid:this.grid).insert({bucketInstanceId:y,featureIndex:S,collisionGroupID:T},o[0],o[1],o[2],o[3])}insertCollisionCircles(o,c,y,S,T){const A=c?this.ignoredGrid:this.grid,$={bucketInstanceId:y,featureIndex:S,collisionGroupID:T};for(let Y=0;Y<o.length;Y+=4)A.insertCircle($,o[Y],o[Y+1],o[Y+2])}projectAndGetPerspectiveRatio(o,c,y,S,T,A,$){const Y=[c,y,S,1];let ee=!1;S||this.transform.pitch>0?(r.a6.vec4.transformMat4(Y,Y,o),this.fogState&&T&&$.name!=="globe"&&(ee=function(fe,me,ke,Le,De,Fe){const Ye=Fe.calculateFogTileMatrix(De),Je=[me,ke,Le];return r.a6.vec3.transformMat4(Je,Je,Ye),zt(fe,r.a6.vec3.length(Je),Fe.pitch,Fe._fov)}(this.fogState,c,y,S,T.toUnwrapped(),this.transform)>.9)):Ec(Y,Y,o);const te=Y[3];return{point:new r.P((Y[0]/te+1)/2*this.transform.width+_o,(-Y[1]/te+1)/2*this.transform.height+_o),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance($)/te*.5,1.5),signedDistanceFromCamera:te,occluded:A&&Y[2]>te||ee}}isOffscreen(o,c,y,S){return y<_o||o>=this.screenRightBoundary||S<_o||c>this.screenBottomBoundary}isInsideGrid(o,c,y,S){return y>=0&&o<this.gridRightBoundary&&S>=0&&c<this.gridBottomBoundary}getViewportMatrix(){const o=r.a6.mat4.identity([]);return r.a6.mat4.translate(o,o,[-100,-100,0]),o}}function Hs(g,o,c){const y=o.createTileMatrix(g,g.worldSize,c.toUnwrapped());return r.a6.mat4.multiply(new Float32Array(16),g.projMatrix,y)}function Xa(g,o,c){if(o.projection.name===c.projection.name)return g.projMatrix;const y=c.clone();return y.setProjection(o.projection),Hs(y,o.getProjection(),g)}function Pa(g,o,c){return o.name===c.projection.name?g.projMatrix:Hs(c,o,g)}class to{constructor(o,c,y,S){this.opacity=o?Math.max(0,Math.min(1,o.opacity+(o.placed?c:-c))):S&&y?1:0,this.placed=y}isHidden(){return this.opacity===0&&!this.placed}}class So{constructor(o,c,y,S,T,A=!1){this.text=new to(o?o.text:null,c,y,T),this.icon=new to(o?o.icon:null,c,S,T),this.clipped=A}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Zo{constructor(o,c,y,S=!1){this.text=o,this.icon=c,this.skipFade=y,this.clipped=S}}class zo{constructor(){this.invProjMatrix=r.a6.mat4.create(),this.viewportMatrix=r.a6.mat4.create(),this.circles=[]}}class th{constructor(o,c,y,S,T){this.bucketInstanceId=o,this.featureIndex=c,this.sourceLayerIndex=y,this.bucketIndex=S,this.tileID=T}}class va{constructor(o){this.crossSourceCollisions=o,this.maxGroupID=0,this.collisionGroups={}}get(o){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[o]){const c=++this.maxGroupID;this.collisionGroups[o]={ID:c,predicate:y=>y.collisionGroupID===c}}return this.collisionGroups[o]}}function _l(g,o,c,y,S){const{horizontalAlign:T,verticalAlign:A}=r.bx(g),$=-(T-.5)*o,Y=-(A-.5)*c,ee=r.bw(g,y);return new r.P($+ee[0]*S,Y+ee[1]*S)}function Nl(g,o,c,y,S){const T=new r.P(g,o);return c&&T._rotate(y?S:-S),T}class Bl{constructor(o,c,y,S,T,A){this.transform=o.clone(),this.projection=o.projection.name,this.collisionIndex=new Yo(this.transform,T),this.buildingIndex=A,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=c,this.retainedQueryData={},this.collisionGroups=new va(y),this.collisionCircleArrays={},this.prevPlacement=S,S&&(S.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(o,c,y,S){const T=y.getBucket(c),A=y.latestFeatureIndex;if(!T||!A||c.fqid!==T.layerIds[0])return;const $=T.layers[0].layout,Y=T.layers[0].paint,ee=y.collisionBoxArray,te=Math.pow(2,this.transform.zoom-y.tileID.overscaledZ),ue=y.tileSize/r.ab,fe=y.tileID.toUnwrapped();this.transform.setProjection(T.projection);const me=(ke=y.tileID,Le=T.getProjection(),De=this.transform,Le.name===this.projection?De.calculateProjMatrix(ke.toUnwrapped()):Hs(De,Le,ke));var ke,Le,De;const Fe=$.get("text-pitch-alignment")==="map",Ye=$.get("text-rotation-alignment")==="map";c.compileFilter();const Je=c.dynamicFilter(),qe=c.dynamicFilterNeedsFeature(),it=this.transform.calculatePixelsToTileUnitsMatrix(y),rt=ai(me,y.tileID.canonical,Fe,Ye,this.transform,T.getProjection(),it);let mt=null;if(Fe){const Et=Gs(me,y.tileID.canonical,Fe,Ye,this.transform,T.getProjection(),it);mt=r.a6.mat4.multiply([],this.transform.labelPlaneMatrix,Et)}let dt=null;Je&&y.latestFeatureIndex&&(dt={unwrappedTileID:fe,dynamicFilter:Je,dynamicFilterNeedsFeature:qe}),this.retainedQueryData[T.bucketInstanceId]=new th(T.bucketInstanceId,A,T.sourceLayerIndex,T.index,y.tileID);const yt={bucket:T,layout:$,paint:Y,posMatrix:me,textLabelPlaneMatrix:rt,labelToScreenMatrix:mt,clippingData:dt,scale:te,textPixelRatio:ue,holdingForFade:y.holdingForFade(),collisionBoxArray:ee,partiallyEvaluatedTextSize:r.bj(T.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:r.bj(T.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(T.sourceID),latestFeatureIndex:y.latestFeatureIndex};if(S)for(const Et of T.sortKeyRanges){const{sortKey:bt,symbolInstanceStart:vt,symbolInstanceEnd:Ot}=Et;o.push({sortKey:bt,symbolInstanceStart:vt,symbolInstanceEnd:Ot,parameters:yt})}else o.push({symbolInstanceStart:0,symbolInstanceEnd:T.symbolInstances.length,parameters:yt})}attemptAnchorPlacement(o,c,y,S,T,A,$,Y,ee,te,ue,fe,me,ke,Le,De,Fe,Ye){const{textOffset0:Je,textOffset1:qe,crossTileID:it}=fe,rt=[Je,qe],mt=_l(o,y,S,rt,T),dt=this.collisionIndex.placeCollisionBox(ke,T,c,Nl(mt.x,mt.y,A,$,this.transform.angle),ue,Y,ee,te.predicate);if(De){const yt=ke.getSymbolInstanceIconSize(Ye,this.transform.zoom,fe.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(ke,yt,De,Nl(mt.x,mt.y,A,$,this.transform.angle),ue,Y,ee,te.predicate).box.length===0)return}if(dt.box.length>0){let yt;return this.prevPlacement&&this.prevPlacement.variableOffsets[it]&&this.prevPlacement.placements[it]&&this.prevPlacement.placements[it].text&&(yt=this.prevPlacement.variableOffsets[it].anchor),this.variableOffsets[it]={textOffset:rt,width:y,height:S,anchor:o,textScale:T,prevAnchor:yt},this.markUsedJustification(ke,o,fe,Le),ke.allowVerticalPlacement&&(this.markUsedOrientation(ke,Le,fe),this.placedOrientations[it]=Le),{shift:mt,placedGlyphBoxes:dt}}}placeLayerBucketPart(o,c,y,S){const{bucket:T,layout:A,paint:$,posMatrix:Y,textLabelPlaneMatrix:ee,labelToScreenMatrix:te,clippingData:ue,textPixelRatio:fe,holdingForFade:me,collisionBoxArray:ke,partiallyEvaluatedTextSize:Le,partiallyEvaluatedIconSize:De,collisionGroup:Fe,latestFeatureIndex:Ye}=o.parameters,Je=A.get("text-optional"),qe=A.get("icon-optional"),it=A.get("text-allow-overlap"),rt=A.get("icon-allow-overlap"),mt=A.get("text-rotation-alignment")==="map",dt=A.get("text-pitch-alignment")==="map",yt=A.get("symbol-z-elevate"),Et=$.get("symbol-z-offset"),bt=$.get("symbol-elevation-reference")==="sea";this.transform.setProjection(T.projection);let vt=it&&(rt||!T.hasIconData()||qe),Ot=rt&&(it||!T.hasTextData()||Je);const sn=!Et.isConstant();!T.collisionArrays&&ke&&T.deserializeCollisionBoxes(ke),y&&S&&T.updateCollisionDebugBuffers(this.transform.zoom,ke);const mn=(on,Tn,Dt)=>{const{crossTileID:dn,numVerticalGlyphVertices:cn}=on;let In=null;if(ue&&ue.dynamicFilterNeedsFeature||sn){const ni=this.retainedQueryData[T.bucketInstanceId];In=Ye.loadFeature({featureIndex:on.featureIndex,bucketIndex:ni.bucketIndex,sourceLayerIndex:ni.sourceLayerIndex,layoutVertexArrayOffset:0})}if(ue&&!(0,ue.dynamicFilter)({zoom:this.transform.zoom,pitch:this.transform.pitch},In,this.retainedQueryData[T.bucketInstanceId].tileID.canonical,new r.P(on.tileAnchorX,on.tileAnchorY),this.transform.calculateDistanceTileData(ue.unwrappedTileID)))return this.placements[dn]=new Zo(!1,!1,!1,!0),void c.add(dn);const An=Et.evaluate(In,{});if(c.has(dn))return;if(me)return void(this.placements[dn]=new Zo(!1,!1,!1));let pn=!1,_n=!1,_r=!0,Vn=!1,tr=!1,zr=null,dr={box:null,offscreen:null,occluded:null},Ir={box:null,offscreen:null,occluded:null},oi=null,Qr=null,Fi=null,qi=0,ao=0,Gl=0;Dt.textFeatureIndex?qi=Dt.textFeatureIndex:on.useRuntimeCollisionCircles&&(qi=on.featureIndex),Dt.verticalTextFeatureIndex&&(ao=Dt.verticalTextFeatureIndex);const is=ni=>{ni.tileID=this.retainedQueryData[T.bucketInstanceId].tileID;const Si=this.transform.elevation;ni.elevation=bt?An:An+(Si?Si.getAtTileOffset(ni.tileID,ni.tileAnchorX,ni.tileAnchorY):0),ni.elevation+=on.zOffset},hi=Dt.textBox;if(hi){is(hi);const ni=Oi=>{let Bo=r.bk.horizontal;if(T.allowVerticalPlacement&&!Oi&&this.prevPlacement){const os=this.prevPlacement.placedOrientations[dn];os&&(this.placedOrientations[dn]=os,Bo=os,this.markUsedOrientation(T,Bo,on))}return Bo},Si=(Oi,Bo)=>{if(T.allowVerticalPlacement&&cn>0&&Dt.verticalTextBox){for(const os of T.writingModes)if(os===r.bk.vertical?(dr=Bo(),Ir=dr):dr=Oi(),dr&&dr.box&&dr.box.length)break}else dr=Oi()};if(A.get("text-variable-anchor")){let Oi=A.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[dn]){const _i=this.prevPlacement.variableOffsets[dn];Oi.indexOf(_i.anchor)>0&&(Oi=Oi.filter(Ss=>Ss!==_i.anchor),Oi.unshift(_i.anchor))}const Bo=(_i,Ss,Ns)=>{const Cs=T.getSymbolInstanceTextSize(Le,on,this.transform.zoom,Tn),no=(_i.x2-_i.x1)*Cs+2*_i.padding,Oa=(_i.y2-_i.y1)*Cs+2*_i.padding,Da=on.hasIconTextFit&&!rt?Ss:null;Da&&is(Da);let Hl={box:[],offscreen:!1,occluded:!1};const Tl=it?2*Oi.length:Oi.length;for(let rl=0;rl<Tl;++rl){const Wl=this.attemptAnchorPlacement(Oi[rl%Oi.length],_i,no,Oa,Cs,mt,dt,fe,Y,Fe,rl>=Oi.length,on,Tn,T,Ns,Da,Le,De);if(Wl&&(Hl=Wl.placedGlyphBoxes,Hl&&Hl.box&&Hl.box.length)){pn=!0,zr=Wl.shift;break}}return Hl};Si(()=>Bo(hi,Dt.iconBox,r.bk.horizontal),()=>{const _i=Dt.verticalTextBox;return _i&&is(_i),T.allowVerticalPlacement&&!(dr&&dr.box&&dr.box.length)&&cn>0&&_i?Bo(_i,Dt.verticalIconBox,r.bk.vertical):{box:null,offscreen:null,occluded:null}}),dr&&(pn=dr.box,_r=dr.offscreen,Vn=dr.occluded);const os=ni(!(!dr||!dr.box));if(!pn&&this.prevPlacement){const _i=this.prevPlacement.variableOffsets[dn];_i&&(this.variableOffsets[dn]=_i,this.markUsedJustification(T,_i.anchor,on,os))}}else{const Oi=(Bo,os)=>{const _i=T.getSymbolInstanceTextSize(Le,on,this.transform.zoom,Tn),Ss=this.collisionIndex.placeCollisionBox(T,_i,Bo,new r.P(0,0),it,fe,Y,Fe.predicate);return Ss&&Ss.box&&Ss.box.length&&(this.markUsedOrientation(T,os,on),this.placedOrientations[dn]=os),Ss};Si(()=>Oi(hi,r.bk.horizontal),()=>{const Bo=Dt.verticalTextBox;return T.allowVerticalPlacement&&cn>0&&Bo?(is(Bo),Oi(Bo,r.bk.vertical)):{box:null,offscreen:null,occluded:null}}),ni(!!(dr&&dr.box&&dr.box.length))}}if(oi=dr,pn=oi&&oi.box&&oi.box.length>0,_r=oi&&oi.offscreen,Vn=oi&&oi.occluded,on.useRuntimeCollisionCircles){const ni=T.text.placedSymbolArray.get(on.centerJustifiedTextSymbolIndex>=0?on.centerJustifiedTextSymbolIndex:on.verticalPlacedTextSymbolIndex),Si=r.bl(T.textSizeData,Le,ni),Oi=A.get("text-padding");Qr=this.collisionIndex.placeCollisionCircles(T,it,ni,T.lineVertexArray,T.glyphOffsetArray,Si,Y,ee,te,y,dt,Fe.predicate,on.collisionCircleDiameter*Si/r.bq,Oi,this.retainedQueryData[T.bucketInstanceId].tileID),pn=it||Qr.circles.length>0&&!Qr.collisionDetected,_r=_r&&Qr.offscreen,Vn=Qr.occluded}if(Dt.iconFeatureIndex&&(Gl=Dt.iconFeatureIndex),Dt.iconBox){const ni=Si=>{is(Si);const Oi=on.hasIconTextFit&&zr?Nl(zr.x,zr.y,mt,dt,this.transform.angle):new r.P(0,0),Bo=T.getSymbolInstanceIconSize(De,this.transform.zoom,on.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(T,Bo,Si,Oi,rt,fe,Y,Fe.predicate)};Ir&&Ir.box&&Ir.box.length&&Dt.verticalIconBox?(Fi=ni(Dt.verticalIconBox),_n=Fi.box.length>0):(Fi=ni(Dt.iconBox),_n=Fi.box.length>0),_r=_r&&Fi.offscreen,tr=Fi.occluded}const Hi=Je||on.numHorizontalGlyphVertices===0&&cn===0,xo=qe||on.numIconVertices===0;if(Hi||xo?xo?Hi||(_n=_n&&pn):pn=_n&&pn:_n=pn=_n&&pn,pn&&oi&&oi.box&&this.collisionIndex.insertCollisionBox(oi.box,A.get("text-ignore-placement"),T.bucketInstanceId,Ir&&Ir.box&&ao?ao:qi,Fe.ID),_n&&Fi&&this.collisionIndex.insertCollisionBox(Fi.box,A.get("icon-ignore-placement"),T.bucketInstanceId,Gl,Fe.ID),Qr&&(pn&&this.collisionIndex.insertCollisionCircles(Qr.circles,A.get("text-ignore-placement"),T.bucketInstanceId,qi,Fe.ID),y)){const ni=T.bucketInstanceId;let Si=this.collisionCircleArrays[ni];Si===void 0&&(Si=this.collisionCircleArrays[ni]=new zo);for(let Oi=0;Oi<Qr.circles.length;Oi+=4)Si.circles.push(Qr.circles[Oi+0]),Si.circles.push(Qr.circles[Oi+1]),Si.circles.push(Qr.circles[Oi+2]),Si.circles.push(Qr.collisionDetected?1:0)}const $i=T.projection.name!=="globe";vt=vt&&($i||!Vn),Ot=Ot&&($i||!tr),this.placements[dn]=new Zo(pn||vt,_n||Ot,_r||T.justReloaded),c.add(dn)};if(yt&&this.buildingIndex&&(this.buildingIndex.updateZOffset(T,this.retainedQueryData[T.bucketInstanceId].tileID),T.updateZOffset()),T.sortFeaturesByY){const on=T.getSortedSymbolIndexes(this.transform.angle);for(let Tn=on.length-1;Tn>=0;--Tn){const Dt=on[Tn];mn(T.symbolInstances.get(Dt),Dt,T.collisionArrays[Dt])}T.hasAnyZOffset&&r.w(`${T.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(T.hasAnyZOffset){const on=T.getSortedIndexesByZOffset();for(let Tn=0;Tn<on.length;++Tn){const Dt=on[Tn];mn(T.symbolInstances.get(Dt),Dt,T.collisionArrays[Dt])}}else for(let on=o.symbolInstanceStart;on<o.symbolInstanceEnd;on++)mn(T.symbolInstances.get(on),on,T.collisionArrays[on]);if(y&&T.bucketInstanceId in this.collisionCircleArrays){const on=this.collisionCircleArrays[T.bucketInstanceId];r.a6.mat4.invert(on.invProjMatrix,Y),on.viewportMatrix=this.collisionIndex.getViewportMatrix()}T.justReloaded=!1}markUsedJustification(o,c,y,S){const{leftJustifiedTextSymbolIndex:T,centerJustifiedTextSymbolIndex:A,rightJustifiedTextSymbolIndex:$,verticalPlacedTextSymbolIndex:Y,crossTileID:ee}=y,te=r.bv(c),ue=S===r.bk.vertical?Y:te==="left"?T:te==="center"?A:te==="right"?$:-1;T>=0&&(o.text.placedSymbolArray.get(T).crossTileID=ue>=0&&T!==ue?0:ee),A>=0&&(o.text.placedSymbolArray.get(A).crossTileID=ue>=0&&A!==ue?0:ee),$>=0&&(o.text.placedSymbolArray.get($).crossTileID=ue>=0&&$!==ue?0:ee),Y>=0&&(o.text.placedSymbolArray.get(Y).crossTileID=ue>=0&&Y!==ue?0:ee)}markUsedOrientation(o,c,y){const S=c===r.bk.horizontal||c===r.bk.horizontalOnly?c:0,T=c===r.bk.vertical?c:0,{leftJustifiedTextSymbolIndex:A,centerJustifiedTextSymbolIndex:$,rightJustifiedTextSymbolIndex:Y,verticalPlacedTextSymbolIndex:ee}=y,te=o.text.placedSymbolArray;A>=0&&(te.get(A).placedOrientation=S),$>=0&&(te.get($).placedOrientation=S),Y>=0&&(te.get(Y).placedOrientation=S),ee>=0&&(te.get(ee).placedOrientation=T)}commit(o){this.commitTime=o,this.zoomAtLastRecencyCheck=this.transform.zoom;const c=this.prevPlacement;let y=!1;this.prevZoomAdjustment=c?c.zoomAdjustment(this.transform.zoom):0;const S=c?c.symbolFadeChange(o):1,T=c?c.opacities:{},A=c?c.variableOffsets:{},$=c?c.placedOrientations:{};for(const Y in this.placements){const ee=this.placements[Y],te=T[Y];te?(this.opacities[Y]=new So(te,S,ee.text,ee.icon,null,ee.clipped),y=y||ee.text!==te.text.placed||ee.icon!==te.icon.placed):(this.opacities[Y]=new So(null,S,ee.text,ee.icon,ee.skipFade,ee.clipped),y=y||ee.text||ee.icon)}for(const Y in T){const ee=T[Y];if(!this.opacities[Y]){const te=new So(ee,S,!1,!1);te.isHidden()||(this.opacities[Y]=te,y=y||ee.text.placed||ee.icon.placed)}}for(const Y in A)this.variableOffsets[Y]||!this.opacities[Y]||this.opacities[Y].isHidden()||(this.variableOffsets[Y]=A[Y]);for(const Y in $)this.placedOrientations[Y]||!this.opacities[Y]||this.opacities[Y].isHidden()||(this.placedOrientations[Y]=$[Y]);y?this.lastPlacementChangeTime=o:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=c?c.lastPlacementChangeTime:o)}updateLayerOpacities(o,c,y,S){const T=new Set;for(const A of c){const $=A.getBucket(o);$&&A.latestFeatureIndex&&o.fqid===$.layerIds[0]&&(this.updateBucketOpacities($,T,A,A.collisionBoxArray,y,S,A.tileID,o.scope),$.layers[0].layout.get("symbol-z-elevate")&&this.buildingIndex&&(this.buildingIndex.updateZOffset($,A.tileID),$.updateZOffset()))}}updateBucketOpacities(o,c,y,S,T,A,$,Y){o.hasTextData()&&o.text.opacityVertexArray.clear(),o.hasIconData()&&o.icon.opacityVertexArray.clear(),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexArray.clear(),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexArray.clear();const ee=o.layers[0].layout,te=o.layers[0].paint,ue=!!o.layers[0].dynamicFilter(),fe=new So(null,0,!1,!1,!0),me=ee.get("text-allow-overlap"),ke=ee.get("icon-allow-overlap"),Le=ee.get("text-variable-anchor"),De=ee.get("text-rotation-alignment")==="map",Fe=ee.get("text-pitch-alignment")==="map",Ye=te.get("symbol-z-offset"),Je=te.get("symbol-elevation-reference")==="sea",qe=!Ye.isConstant(),it=new So(null,0,me&&(ke||!o.hasIconData()||ee.get("icon-optional")),ke&&(me||!o.hasTextData()||ee.get("text-optional")),!0);!o.collisionArrays&&S&&(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData())&&o.deserializeCollisionBoxes(S);const rt=(dt,yt,Et)=>{for(let bt=0;bt<yt/4;bt++)dt.opacityVertexArray.emplaceBack(Et)};let mt=0;A&&o.updateReplacement($,A);for(let dt=0;dt<o.symbolInstances.length;dt++){const yt=o.symbolInstances.get(dt),{numHorizontalGlyphVertices:Et,numVerticalGlyphVertices:bt,crossTileID:vt,numIconVertices:Ot,tileAnchorX:sn,tileAnchorY:mn}=yt;let on=null;if(yt&&qe){const Vn=this.retainedQueryData[o.bucketInstanceId];on=y.latestFeatureIndex.loadFeature({featureIndex:yt.featureIndex,bucketIndex:Vn.bucketIndex,sourceLayerIndex:Vn.sourceLayerIndex,layoutVertexArrayOffset:0})}const Tn=Ye.evaluate(on,{}),Dt=c.has(vt);let dn=this.opacities[vt];Dt?dn=fe:dn||(dn=it,this.opacities[vt]=dn),c.add(vt);const cn=Et>0||bt>0,In=Ot>0,An=this.placedOrientations[vt],pn=An===r.bk.vertical,_n=An===r.bk.horizontal||An===r.bk.horizontalOnly;!cn&&!In||dn.isHidden()||mt++;let _r=!1;if((cn||In)&&A)for(const Vn of o.activeReplacements){if(r.br(Vn,T,r.bs.Symbol,Y)||Vn.min.x>sn||sn>Vn.max.x||Vn.min.y>mn||mn>Vn.max.y)continue;const tr=r.bt(sn,mn,$.canonical,Vn.footprintTileId.canonical);if(_r=r.bu(tr,Vn.footprint),_r)break}if(cn){const Vn=_r?Ya:vl(dn.text);rt(o.text,Et,pn?Ya:Vn),rt(o.text,bt,_n?Ya:Vn);const tr=dn.text.isHidden(),{leftJustifiedTextSymbolIndex:zr,centerJustifiedTextSymbolIndex:dr,rightJustifiedTextSymbolIndex:Ir,verticalPlacedTextSymbolIndex:oi}=yt,Qr=o.text.placedSymbolArray,Fi=tr||pn?1:0;zr>=0&&(Qr.get(zr).hidden=Fi),dr>=0&&(Qr.get(dr).hidden=Fi),Ir>=0&&(Qr.get(Ir).hidden=Fi),oi>=0&&(Qr.get(oi).hidden=tr||_n?1:0);const qi=this.variableOffsets[vt];qi&&this.markUsedJustification(o,qi.anchor,yt,An);const ao=this.placedOrientations[vt];ao&&(this.markUsedJustification(o,"left",yt,ao),this.markUsedOrientation(o,ao,yt))}if(In){const Vn=_r?Ya:vl(dn.icon),{placedIconSymbolIndex:tr,verticalPlacedIconSymbolIndex:zr}=yt,dr=o.icon.placedSymbolArray,Ir=dn.icon.isHidden()?1:0;tr>=0&&(rt(o.icon,Ot,pn?Ya:Vn),dr.get(tr).hidden=Ir),zr>=0&&(rt(o.icon,yt.numVerticalIconVertices,_n?Ya:Vn),dr.get(zr).hidden=Ir)}if(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData()){const Vn=o.collisionArrays[dt];if(Vn){let tr=new r.P(0,0),zr=!0;if(Vn.textBox||Vn.verticalTextBox){if(Le){const Ir=this.variableOffsets[vt];Ir?(tr=_l(Ir.anchor,Ir.width,Ir.height,Ir.textOffset,Ir.textScale),De&&tr._rotate(Fe?this.transform.angle:-this.transform.angle)):zr=!1}ue&&(zr=!dn.clipped),Vn.textBox&&ud(o.textCollisionBox.collisionVertexArray,dn.text.placed,!zr||pn,Tn,Je,tr.x,tr.y),Vn.verticalTextBox&&ud(o.textCollisionBox.collisionVertexArray,dn.text.placed,!zr||_n,Tn,Je,tr.x,tr.y)}const dr=zr&&!!(!_n&&Vn.verticalIconBox);Vn.iconBox&&ud(o.iconCollisionBox.collisionVertexArray,dn.icon.placed,dr,Tn,Je,yt.hasIconTextFit?tr.x:0,yt.hasIconTextFit?tr.y:0),Vn.verticalIconBox&&ud(o.iconCollisionBox.collisionVertexArray,dn.icon.placed,!dr,Tn,Je,yt.hasIconTextFit?tr.x:0,yt.hasIconTextFit?tr.y:0)}}}if(o.fullyClipped=mt===0,o.sortFeatures(this.transform.angle),this.retainedQueryData[o.bucketInstanceId]&&(this.retainedQueryData[o.bucketInstanceId].featureSortOrder=o.featureSortOrder),o.hasTextData()&&o.text.opacityVertexBuffer&&o.text.opacityVertexBuffer.updateData(o.text.opacityVertexArray),o.hasIconData()&&o.icon.opacityVertexBuffer&&o.icon.opacityVertexBuffer.updateData(o.icon.opacityVertexArray),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexBuffer&&o.iconCollisionBox.collisionVertexBuffer.updateData(o.iconCollisionBox.collisionVertexArray),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexBuffer&&o.textCollisionBox.collisionVertexBuffer.updateData(o.textCollisionBox.collisionVertexArray),o.bucketInstanceId in this.collisionCircleArrays){const dt=this.collisionCircleArrays[o.bucketInstanceId];o.placementInvProjMatrix=dt.invProjMatrix,o.placementViewportMatrix=dt.viewportMatrix,o.collisionCircleArray=dt.circles,delete this.collisionCircleArrays[o.bucketInstanceId]}}symbolFadeChange(o){return this.fadeDuration===0?1:(o-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(o){return Math.max(0,(this.transform.zoom-o)/1.5)}hasTransitions(o){return this.stale||o-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(o,c){const y=this.zoomAtLastRecencyCheck===c?1-this.zoomAdjustment(c):1;return this.zoomAtLastRecencyCheck=c,this.commitTime+this.fadeDuration*y>o}setStale(){this.stale=!0}}function ud(g,o,c,y,S,T,A){g.emplaceBack(o?1:0,c?1:0,T||0,A||0,y,S?1:0),g.emplaceBack(o?1:0,c?1:0,T||0,A||0,y,S?1:0),g.emplaceBack(o?1:0,c?1:0,T||0,A||0,y,S?1:0),g.emplaceBack(o?1:0,c?1:0,T||0,A||0,y,S?1:0)}const Ws=Math.pow(2,25),jl=Math.pow(2,24),ia=Math.pow(2,17),oa=Math.pow(2,16),cd=Math.pow(2,9),Vl=Math.pow(2,8),Du=Math.pow(2,1);function vl(g){if(g.opacity===0&&!g.placed)return 0;if(g.opacity===1&&g.placed)return 4294967295;const o=g.placed?1:0,c=Math.floor(127*g.opacity);return c*Ws+o*jl+c*ia+o*oa+c*cd+o*Vl+c*Du+o}const Ya=0;class zu{constructor(o){this._sortAcrossTiles=o.layout.get("symbol-z-order")!=="viewport-y"&&o.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(o,c,y,S,T){const A=this._bucketParts;for(;this._currentTileIndex<o.length;)if(c.getBucketParts(A,S,o[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,T())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,A.sort(($,Y)=>$.sortKey-Y.sortKey));this._currentPartIndex<A.length;){const $=A[this._currentPartIndex];if(c.placeLayerBucketPart($,this._seenCrossTileIDs,y,$.symbolInstanceStart===0),this._currentPartIndex++,T())return!0}return!1}}class qs{constructor(o,c,y,S,T,A,$,Y,ee){this.placement=new Bl(o,T,A,$,Y,ee),this._currentPlacementIndex=c.length-1,this._forceFullPlacement=y,this._showCollisionBoxes=S,this._done=!1}isDone(){return this._done}continuePlacement(o,c,y,S){const T=r.q.now(),A=()=>{const $=r.q.now()-T;return!this._forceFullPlacement&&$>2};for(;this._currentPlacementIndex>=0;){const $=c[o[this._currentPlacementIndex]],Y=this.placement.collisionIndex.transform.zoom;if($.type==="symbol"&&(!$.minzoom||$.minzoom<=Y)&&(!$.maxzoom||$.maxzoom>Y)){const ee=$,te=ee.layout.get("symbol-z-elevate"),ue=ee.layout.get("symbol-sort-key").constantOr(1)!==void 0,fe=ee.layout.get("symbol-z-order"),me=fe==="viewport-y"||fe==="auto"&&!(fe!=="viewport-y"&&ue),ke=ee.layout.get("text-allow-overlap")||ee.layout.get("icon-allow-overlap")||ee.layout.get("text-ignore-placement")||ee.layout.get("icon-ignore-placement"),Le=me&&ke,De=this._inProgressLayer=this._inProgressLayer||new zu(ee),Fe=r.av($.source,$.scope);if(De.continuePlacement(te||Le?S[Fe]:y[Fe],this.placement,this._showCollisionBoxes,$,A))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(o){return this.placement.commit(o),this.placement}}const $l=512/r.ab/2;class ca{constructor(o,c,y){this.tileID=o,this.bucketInstanceId=y,this.index=new r.by(c.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const S=o.canonical.x*r.ab,T=o.canonical.y*r.ab;for(let A=0;A<c.length;A++){const{key:$,crossTileID:Y,tileAnchorX:ee,tileAnchorY:te}=c.get(A),ue=Math.floor((S+ee)*$l),fe=Math.floor((T+te)*$l);this.index.add(ue,fe),this.keys.push($),this.crossTileIDs.push(Y)}this.index.finish()}findMatches(o,c,y){const S=this.tileID.canonical.z<c.canonical.z?1:Math.pow(2,this.tileID.canonical.z-c.canonical.z),T=$l/Math.pow(2,c.canonical.z-this.tileID.canonical.z),A=c.canonical.x*r.ab,$=c.canonical.y*r.ab;for(let Y=0;Y<o.length;Y++){const ee=o.get(Y);if(ee.crossTileID)continue;const{key:te,tileAnchorX:ue,tileAnchorY:fe}=ee,me=Math.floor((A+ue)*T),ke=Math.floor(($+fe)*T),Le=this.index.range(me-S,ke-S,me+S,ke+S);for(const De of Le){const Fe=this.crossTileIDs[De];if(this.keys[De]===te&&!y.has(Fe)){y.add(Fe),ee.crossTileID=Fe;break}}}}}class Za{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Xh{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(o){const c=Math.round((o-this.lng)/360);if(c!==0)for(const y in this.indexes){const S=this.indexes[y],T={};for(const A in S){const $=S[A];$.tileID=$.tileID.unwrapTo($.tileID.wrap+c),T[$.tileID.key]=$}this.indexes[y]=T}this.lng=o}addBucket(o,c,y){if(this.indexes[o.overscaledZ]&&this.indexes[o.overscaledZ][o.key]){if(this.indexes[o.overscaledZ][o.key].bucketInstanceId===c.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(o.overscaledZ,this.indexes[o.overscaledZ][o.key])}for(let T=0;T<c.symbolInstances.length;T++)c.symbolInstances.get(T).crossTileID=0;this.usedCrossTileIDs[o.overscaledZ]||(this.usedCrossTileIDs[o.overscaledZ]=new Set);const S=this.usedCrossTileIDs[o.overscaledZ];for(const T in this.indexes){const A=this.indexes[T];if(Number(T)>o.overscaledZ)for(const $ in A){const Y=A[$];Y.tileID.isChildOf(o)&&Y.findMatches(c.symbolInstances,o,S)}else{const $=A[o.scaledTo(Number(T)).key];$&&$.findMatches(c.symbolInstances,o,S)}}for(let T=0;T<c.symbolInstances.length;T++){const A=c.symbolInstances.get(T);A.crossTileID||(A.crossTileID=y.generate(),S.add(A.crossTileID))}return this.indexes[o.overscaledZ]===void 0&&(this.indexes[o.overscaledZ]={}),this.indexes[o.overscaledZ][o.key]=new ca(o,c.symbolInstances,c.bucketInstanceId),!0}removeBucketCrossTileIDs(o,c){for(const y of c.crossTileIDs)this.usedCrossTileIDs[o].delete(y)}removeStaleBuckets(o){let c=!1;for(const y in this.indexes){const S=this.indexes[y];for(const T in S)o[S[T].bucketInstanceId]||(this.removeBucketCrossTileIDs(y,S[T]),delete S[T],c=!0)}return c}}class Fu{constructor(){this.layerIndexes={},this.crossTileIDs=new Za,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(o,c,y,S){let T=this.layerIndexes[o.fqid];T===void 0&&(T=this.layerIndexes[o.fqid]=new Xh);let A=!1;const $={};S.name!=="globe"&&T.handleWrapJump(y);for(const Y of c){const ee=Y.getBucket(o);ee&&o.fqid===ee.layerIds[0]&&(ee.bucketInstanceId||(ee.bucketInstanceId=++this.maxBucketInstanceId),T.addBucket(Y.tileID,ee,this.crossTileIDs)&&(A=!0),$[ee.bucketInstanceId]=!0)}return T.removeStaleBuckets($)&&(A=!0),A}pruneUnusedLayers(o){const c={};o.forEach(y=>{c[y]=!0});for(const y in this.layerIndexes)c[y]||delete this.layerIndexes[y]}}const Ds=771;class Hr{constructor(o,c,y,S){this.blendFunction=o,this.blendColor=c,this.mask=y,this.blendEquation=S}}Hr.Replace=[1,0,1,0],Hr.disabled=new Hr(Hr.Replace,r.bz.transparent,[!1,!1,!1,!1]),Hr.unblended=new Hr(Hr.Replace,r.bz.transparent,[!0,!0,!0,!0]),Hr.alphaBlended=new Hr([1,Ds,1,Ds],r.bz.transparent,[!0,!0,!0,!0]),Hr.alphaBlendedNonPremultiplied=new Hr([770,Ds,770,Ds],r.bz.transparent,[!0,!0,!0,!0]),Hr.multiply=new Hr([774,0,774,0],r.bz.transparent,[!0,!0,!0,!0]);class cr{constructor(o,c,y){this.func=o,this.mask=c,this.range=y}}cr.ReadOnly=!1,cr.ReadWrite=!0,cr.disabled=new cr(519,cr.ReadOnly,[0,1]);const xl=7680;class Dr{constructor(o,c,y,S,T,A){this.test=o,this.ref=c,this.mask=y,this.fail=S,this.depthFail=T,this.pass=A}}Dr.disabled=new Dr({func:519,mask:0},0,0,xl,xl,xl);const Ka=1029,Tc=2305;class Mr{constructor(o,c,y){this.enable=o,this.mode=c,this.frontFace=y}}function cu(g,o){const c=r.bC(g,3);r.a6.mat4.fromQuat(g,o),r.bE(g,3,c)}function Ic(g,o){const c=r.a6.quat.identity([]);return r.a6.quat.rotateZ(c,c,-o),r.a6.quat.rotateX(c,c,-g),c}function dd(g,o){const c=[g[0],g[1],0],y=[o[0],o[1],0];if(r.a6.vec3.length(c)>=1e-15){const A=r.a6.vec3.normalize([],c);r.a6.vec3.scale(y,A,r.a6.vec3.dot(y,A)),o[0]=y[0],o[1]=y[1]}const S=r.a6.vec3.cross([],o,g);if(r.a6.vec3.len(S)<1e-15)return null;const T=Math.atan2(-S[1],S[0]);return Ic(Math.atan2(Math.sqrt(g[0]*g[0]+g[1]*g[1]),-g[2]),T)}Mr.disabled=new Mr(!1,Ka,Tc),Mr.backCCW=new Mr(!0,Ka,Tc),Mr.backCW=new Mr(!0,Ka,2304),Mr.frontCW=new Mr(!0,1028,2304),Mr.frontCCW=new Mr(!0,1028,Tc);class bl{constructor(o,c){this.position=o,this.orientation=c}get position(){return this._position}set position(o){if(o){const c=o instanceof r.a5?o:new r.a5(o[0],o[1],o[2]);this._renderWorldCopies&&(c.x=r.bA(c.x,0,1)),this._position=c}else this._position=null}lookAtPoint(o,c){if(this.orientation=null,!this.position)return;const y=this.position,S=this._elevation?this._elevation.getAtPointOrZero(r.a5.fromLngLat(o)):0,T=r.a5.fromLngLat(o,S),A=[T.x-y.x,T.y-y.y,T.z-y.z];c||(c=[0,0,1]),c[2]=Math.abs(c[2]),this.orientation=dd(A,c)}setPitchBearing(o,c){this.orientation=Ic(r.bB(o),r.bB(-c))}}class du{constructor(o,c){this._transform=r.a6.mat4.identity([]),this.orientation=c,this.position=o}get mercatorPosition(){const o=this.position;return new r.a5(o[0],o[1],o[2])}get position(){const o=r.bC(this._transform,3);return[o[0],o[1],o[2]]}set position(o){var c;o&&r.bE(this._transform,3,[(c=o)[0],c[1],c[2],1])}get orientation(){return this._orientation}set orientation(o){this._orientation=o||r.a6.quat.identity([]),o&&cu(this._transform,this._orientation)}getPitchBearing(){const o=this.forward(),c=this.right();return{bearing:Math.atan2(-c[1],c[0]),pitch:Math.atan2(Math.sqrt(o[0]*o[0]+o[1]*o[1]),-o[2])}}setPitchBearing(o,c){this._orientation=Ic(o,c),cu(this._transform,this._orientation)}forward(){const o=r.bC(this._transform,2);return[-o[0],-o[1],-o[2]]}up(){const o=r.bC(this._transform,1);return[-o[0],-o[1],-o[2]]}right(){const o=r.bC(this._transform,0);return[o[0],o[1],o[2]]}getCameraToWorld(o,c){const y=new Float64Array(16);return r.a6.mat4.invert(y,this.getWorldToCamera(o,c)),y}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(o,c,y){const S=this.position;r.a6.vec3.scale(S,S,-o);const T=new Float64Array(16);return r.a6.mat4.fromScaling(T,[y,y,y]),r.a6.mat4.translate(T,T,S),T[10]*=c,T}getWorldToCamera(o,c){const y=new Float64Array(16),S=new Float64Array(4),T=this.position;return r.a6.quat.conjugate(S,this._orientation),r.a6.vec3.scale(T,T,-o),r.a6.mat4.fromQuat(y,S),r.a6.mat4.translate(y,y,T),y[1]*=-1,y[5]*=-1,y[9]*=-1,y[13]*=-1,y[8]*=c,y[9]*=c,y[10]*=c,y[11]*=c,y}getCameraToClipPerspective(o,c,y,S){const T=new Float64Array(16);return r.a6.mat4.perspective(T,o,c,y,S),T}getCameraToClipOrthographic(o,c,y,S,T,A){const $=new Float64Array(16);return r.a6.mat4.ortho($,o,c,y,S,T,A),$}getDistanceToElevation(o,c=!1){const y=o===0?0:r.bD(o,c?r.aM(this.position[1]):this.position[1]),S=this.forward();return(y-this.position[2])/S[2]}clone(){return new du([...this.position],[...this.orientation])}}const cs={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,LUT:10,ShadowMap0:11};class kc{constructor(o=0,c=0,y=0,S=0){if(isNaN(o)||o<0||isNaN(c)||c<0||isNaN(y)||y<0||isNaN(S)||S<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=o,this.bottom=c,this.left=y,this.right=S}interpolate(o,c,y){return c.top!=null&&o.top!=null&&(this.top=r.aa(o.top,c.top,y)),c.bottom!=null&&o.bottom!=null&&(this.bottom=r.aa(o.bottom,c.bottom,y)),c.left!=null&&o.left!=null&&(this.left=r.aa(o.left,c.left,y)),c.right!=null&&o.right!=null&&(this.right=r.aa(o.right,c.right,y)),this}getCenter(o,c){const y=r.ap((this.left+o-this.right)/2,0,o),S=r.ap((this.top+c-this.bottom)/2,0,c);return new r.P(y,S)}equals(o){return this.top===o.top&&this.bottom===o.bottom&&this.left===o.left&&this.right===o.right}clone(){return new kc(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const wl=(g,o,c)=>(1-c)*g+c*o,Aa=g=>g*g*g*g*g;class hd{constructor(o,c,y,S,T,A,$){this.tileSize=512,this._renderWorldCopies=T===void 0||T,this._minZoom=o||0,this._maxZoom=c||22,this._minPitch=y??0,this._maxPitch=S??60,this.setProjection(A),this.setMaxBounds($),this.width=0,this.height=0,this._center=new r.bK(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new kc,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new du,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1}clone(){const o=new hd(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return o._elevation=this._elevation,o._centerAltitude=this._centerAltitude,o._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,o.tileSize=this.tileSize,o.mercatorFromTransition=this.mercatorFromTransition,o.width=this.width,o.height=this.height,o.cameraElevationReference=this.cameraElevationReference,o._center=this._center,o._setZoom(this.zoom),o._seaLevelZoom=this._seaLevelZoom,o.angle=this.angle,o._fov=this._fov,o._pitch=this._pitch,o._nearZ=this._nearZ,o._farZ=this._farZ,o._averageElevation=this._averageElevation,o._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,o._unmodified=this._unmodified,o._edgeInsets=this._edgeInsets.clone(),o._camera=this._camera.clone(),o._calcMatrices(),o.freezeTileCoverage=this.freezeTileCoverage,o.frustumCorners=this.frustumCorners,o}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<15}get elevation(){return this._elevation}set elevation(o){this._elevation!==o&&(this._elevation=o,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(o,c=!1){const y=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||y)&&this._updateCameraOnTerrain(),(o||y)&&this._constrainCamera(c),this._calcMatrices()}getProjection(){return r.ar(this.projection,["name","center","parallels"])}setProjection(o){this.projectionOptions=o||{name:"mercator"};const c=this.projection?this.getProjection():void 0;this.projection=r.bL(this.projectionOptions);const y=this.getProjection(),S=!r.bh(c,y);return S&&this._calcMatrices(),this.mercatorFromTransition=!1,S}setOrthographicProjectionAtLowPitch(o){return this._orthographicProjectionAtLowPitch!==o&&(this._orthographicProjectionAtLowPitch=o,this._calcMatrices(),!0)}setMercatorFromTransition(){const o=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=r.bL({name:"mercator"});const c=o!==this.projection.name;return c&&this._calcMatrices(),c}get minZoom(){return this._minZoom}set minZoom(o){this._minZoom!==o&&(this._minZoom=o,this.zoom=Math.max(this.zoom,o))}get maxZoom(){return this._maxZoom}set maxZoom(o){this._maxZoom!==o&&(this._maxZoom=o,this.zoom=Math.min(this.zoom,o))}get minPitch(){return this._minPitch}set minPitch(o){this._minPitch!==o&&(this._minPitch=o,this.pitch=Math.max(this.pitch,o))}get maxPitch(){return this._maxPitch}set maxPitch(o){this._maxPitch!==o&&(this._maxPitch=o,this.pitch=Math.min(this.pitch,o))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(o){o===void 0?o=!0:o===null&&(o=!1),this._renderWorldCopies=o}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const o=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(o))}get cameraWorldSize(){const o=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(o))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return r.bD(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new r.P(this.width,this.height)}get bearing(){return r.bA(this.rotation,-180,180)}set bearing(o){this.rotation=o}get rotation(){return-this.angle/Math.PI*180}set rotation(o){const c=-o*Math.PI/180;this.angle!==c&&(this._unmodified=!1,this.angle=c,this._calcMatrices(),this.rotationMatrix=r.a6.mat2.create(),r.a6.mat2.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(o){const c=r.ap(o,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==c&&(this._unmodified=!1,this._pitch=c,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const o=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/o)}set fov(o){o=Math.max(.01,Math.min(60,o)),this._fov!==o&&(this._unmodified=!1,this._fov=r.bB(o),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(o){this._averageElevation=o,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(o){const c=Math.min(Math.max(o,this.minZoom),this.maxZoom);this._zoom!==c&&(this._unmodified=!1,this._setZoom(c),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(o){this._zoom=o,this.scale=this.zoomScale(o),this.tileZoom=Math.floor(o),this.zoomFraction=o-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(o){this._tileCoverLift!==o&&(this._tileCoverLift=o)}_updateCameraOnTerrain(){const o=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,c=this.elevation&&o===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||o===Number.NEGATIVE_INFINITY&&(!c||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const y=this._elevation;c||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&y.exaggeration()&&this._centerAltitudeValidForExaggeration!==y.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*y.exaggeration(),this._centerAltitudeValidForExaggeration=y.exaggeration()):(this._centerAltitude=o||0,this._centerAltitudeValidForExaggeration=y.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const o=this._elevation,c=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],y=this.horizonLineFromTop();let S=0,T=0;for(let A=0;A<c.length;A++){const $=new r.P(c[A][0]*this.width,y+c[A][1]*(this.height-y)),Y=o.pointCoordinate($);if(!Y)continue;const ee=1/Math.hypot(Y[0]-this._camera.position[0],Y[1]-this._camera.position[1]);S+=Y[3]*ee,T+=ee}return T===0?NaN:S/T}get center(){return this._center}set center(o){o.lat===this._center.lat&&o.lng===this._center.lng||(this._unmodified=!1,this._center=o,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const o=this._seaLevelZoom,c=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),y=this.pixelsPerMeter/this.worldSize*c,S=this._mercatorZfromZoom(o),T=this._mercatorZfromZoom(this._maxZoom),A=Math.max(S-y,T);this._setZoom(this._zoomFromMercatorZ(A))}get padding(){return this._edgeInsets.toJSON()}set padding(o){this._edgeInsets.equals(o)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,o,1),this._calcMatrices())}computeZoomRelativeTo(o){const c=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,o.toAltitude()));let y;y=o.z<this._camera.position[2]?[c.x,c.y,c.z]:[o.x,o.y,o.z];const S=r.a6.vec3.length(r.a6.vec3.sub([],this._camera.position,y));return r.ap(this._zoomFromMercatorZ(S),this._minZoom,this._maxZoom)}setFreeCameraOptions(o){if(!this.height||!o.position&&!o.orientation)return;this._updateCameraState();let c=!1;if(o.orientation&&!r.a6.quat.exactEquals(o.orientation,this._camera.orientation)&&(c=this._setCameraOrientation(o.orientation)),o.position){const y=[o.position.x,o.position.y,o.position.z];r.a6.vec3.exactEquals(y,this._camera.position)||(this._setCameraPosition(y),c=!0)}c&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const o=this._camera.position,c=new bl;return c.position=new r.a5(o[0],o[1],o[2]),c.orientation=this._camera.orientation,c._elevation=this.elevation,c._renderWorldCopies=this.renderWorldCopies,c}_setCameraOrientation(o){if(!r.a6.quat.length(o))return!1;r.a6.quat.normalize(o,o);const c=r.a6.vec3.transformQuat([],[0,0,-1],o),y=r.a6.vec3.transformQuat([],[0,-1,0],o);if(y[2]<0)return!1;const S=dd(c,y);return!!S&&(this._camera.orientation=S,!0)}_setCameraPosition(o){const c=this.zoomScale(this.minZoom)*this.tileSize,y=this.zoomScale(this.maxZoom)*this.tileSize,S=this.cameraToCenterDistance;o[2]=r.ap(o[2],S/y,S/c),this._camera.position=o}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(o){return this._edgeInsets.equals(o)}interpolatePadding(o,c,y){this._unmodified=!1,this._edgeInsets.interpolate(o,c,y),this._constrain(),this._calcMatrices()}coveringZoomLevel(o){const c=(o.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/o.tileSize));return Math.max(0,c)}getVisibleUnwrappedCoordinates(o){const c=[new r.bM(0,o)];if(this.renderWorldCopies){const y=this.pointCoordinate(new r.P(0,0)),S=this.pointCoordinate(new r.P(this.width,0)),T=this.pointCoordinate(new r.P(this.width,this.height)),A=this.pointCoordinate(new r.P(0,this.height)),$=Math.floor(Math.min(y.x,S.x,T.x,A.x)),Y=Math.floor(Math.max(y.x,S.x,T.x,A.x)),ee=1;for(let te=$-ee;te<=Y+ee;te++)te!==0&&c.push(new r.bM(te,o))}return c}isLODDisabled(o){return(!o||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCover(o,c,y){let S=[];const T=y!==void 0,A=!T;if(A&&this.zoom<c||T&&y[0]===0&&y[1]===0)return S;const $=new Set,Y=(te,ue,fe,me,ke)=>{const Le=r.c1(ue,te,fe,me,ke);$.has(Le)||(S.push(new r.aA(te,ue,fe,me,ke)),$.add(Le))};for(let te=0;te<o.length;te++){const ue=o[te];if(A&&ue.canonical.z!==c)continue;const fe=ue.canonical,me=ue.overscaledZ,ke=ue.wrap,Le=1<<fe.z,De=fe.x+1<Le,Fe=fe.x>0,Ye=fe.y+1<Le,Je=fe.y>0,qe=ue.wrap-(Fe?0:1),it=ue.wrap+(De?0:1),rt=Fe?fe.x-1:Le-1,mt=De?fe.x+1:0;if(T)y[0]<0?(Y(me,it,fe.z,mt,fe.y),y[1]<0&&Ye&&(Y(me,ke,fe.z,fe.x,fe.y+1),Y(me,it,fe.z,mt,fe.y+1)),y[1]>0&&Je&&(Y(me,ke,fe.z,fe.x,fe.y-1),Y(me,it,fe.z,mt,fe.y-1))):y[0]>0?(Y(me,qe,fe.z,rt,fe.y),y[1]<0&&Ye&&(Y(me,ke,fe.z,fe.x,fe.y+1),Y(me,qe,fe.z,rt,fe.y+1)),y[1]>0&&Je&&(Y(me,ke,fe.z,fe.x,fe.y-1),Y(me,qe,fe.z,rt,fe.y-1))):y[1]<0&&Ye?Y(me,ke,fe.z,fe.x,fe.y+1):Je&&Y(me,ke,fe.z,fe.x,fe.y-1);else{const dt=ue.visibleQuadrants;1&dt&&(Y(me,qe,fe.z,rt,fe.y),Je&&(Y(me,ke,fe.z,fe.x,fe.y-1),Y(me,qe,fe.z,rt,fe.y-1))),2&dt&&(Y(me,it,fe.z,mt,fe.y),Je&&(Y(me,ke,fe.z,fe.x,fe.y-1),Y(me,it,fe.z,mt,fe.y-1))),4&dt&&(Y(me,qe,fe.z,rt,fe.y),Ye&&(Y(me,ke,fe.z,fe.x,fe.y+1),Y(me,qe,fe.z,rt,fe.y+1))),8&dt&&(Y(me,it,fe.z,mt,fe.y),Ye&&(Y(me,ke,fe.z,fe.x,fe.y+1),Y(me,it,fe.z,mt,fe.y+1)))}}const ee=[];for(const te of S)S.some(ue=>te.isChildOf(ue))||ee.push(te);if(S=ee.filter(te=>!o.some(ue=>!!(te.overscaledZ<c&&ue.isChildOf(te))||te.equals(ue)||te.isChildOf(ue))),A){const te=1<<c,ue=this.projection.name==="globe"?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),fe=[te*ue.x,te*ue.y],me=4,ke=me*me;S=S.filter(Le=>{const De=Le.canonical.x+.5-fe[0],Fe=Le.canonical.y+.5-fe[1];return De*De+Fe*Fe<ke})}return S}coveringTiles(o){let c=this.coveringZoomLevel(o);const y=c,S=this.elevation&&this.elevation.exaggeration(),T=S&&!o.isTerrainDEM,A=this.projection.name==="mercator";if(o.minzoom!==void 0&&c<o.minzoom)return[];o.maxzoom!==void 0&&c>o.maxzoom&&(c=o.maxzoom);const $=this.locationCoordinate(this.center),Y=this.center.lat,ee=1<<c,te=[ee*$.x,ee*$.y,0],ue=this.projection.name==="globe",fe=!ue,me=r.bN.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,c,fe),ke=ue?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),Le=ee*r.bD(1,this.center.lat),De=this._camera.position[2]/r.bD(1,this.center.lat),Fe=[ee*ke.x,ee*ke.y,De*(fe?1:Le)],Ye=ue||S,Je=this.cameraToCenterDistance/o.tileSize*(o.roundZoom?1:.502),qe=this.isLODDisabled(!0)?c:0;let it;if(this._elevation&&o.isTerrainDEM)it=1e4*this._elevation.exaggeration();else if(this._elevation){const Dt=this._elevation.getMinMaxForVisibleTiles();it=Dt?Dt.max:this._centerAltitude}else it=this._centerAltitude;const rt=o.isTerrainDEM?-it:this._elevation?this._elevation.getMinElevationBelowMSL():0,mt=this.projection.isReprojectedInTileSpace?r.bO(this):1,dt=Dt=>{const cn=new r.a5(Dt.x+25e-6,Dt.y,Dt.z),In=new r.a5(Dt.x,Dt.y+25e-6,Dt.z),An=Dt.toLngLat(),pn=cn.toLngLat(),_n=In.toLngLat(),_r=this.locationCoordinate(An),Vn=this.locationCoordinate(pn),tr=this.locationCoordinate(_n),zr=Math.hypot(Vn.x-_r.x,Vn.y-_r.y),dr=Math.hypot(tr.x-_r.x,tr.y-_r.y);return Math.sqrt(zr*dr)*mt/25e-6},yt=Dt=>{const dn=it,cn=rt;return{aabb:r.bR(this,ee,0,0,0,Dt,cn,dn,this.projection),zoom:0,x:0,y:0,minZ:cn,maxZ:dn,wrap:Dt,fullyVisible:!1}},Et=[];let bt=[];const vt=c,Ot=o.reparseOverscaled?y:c,sn=(De-this._centerAltitude)*Le,mn=Dt=>{if(!this._elevation||!Dt.tileID||!A)return;const dn=this._elevation.getMinMaxForTile(Dt.tileID),cn=Dt.aabb;dn?(cn.min[2]=dn.min,cn.max[2]=dn.max,cn.center[2]=(cn.min[2]+cn.max[2])/2):(Dt.shouldSplit=Tn(Dt),Dt.shouldSplit||(cn.min[2]=cn.max[2]=cn.center[2]=this._centerAltitude))},on=(Dt,dn)=>{if(.707*dn<Dt)return 1;const cn=dn/Dt;return cn/(1.4144271570014144+(Math.pow(1.1,cn-1.4144271570014144+1)-1)/(1.1-1)-1)},Tn=Dt=>{if(Dt.zoom<qe)return!0;if(Dt.zoom===vt)return!1;if(Dt.shouldSplit!=null)return Dt.shouldSplit;const dn=Dt.aabb.distanceX(Fe),cn=Dt.aabb.distanceY(Fe);let In=sn,An=1;if(ue){In=Dt.aabb.distanceZ(Fe);const dr=Math.pow(2,Dt.zoom),Ir=r.aM((Dt.y+1)/dr),oi=r.aM(Dt.y/dr),Qr=Math.min(Math.max(Y,Ir),oi),Fi=r.c5(Qr)/r.c5(Y);if(An=Qr===Y?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Fi/this._mercatorScaleRatio),this.zoom<=r.c2&&Dt.zoom===vt-1&&Fi>=.9)return!0}else if(T&&(In=Dt.aabb.distanceZ(Fe)*Le),this.projection.isReprojectedInTileSpace&&y<=5){const dr=Math.pow(2,Dt.zoom),Ir=dt(new r.a5((Dt.x+.5)/dr,(Dt.y+.5)/dr));An=Ir>.85?1:Ir}if(!A){const dr=Math.sqrt(dn*dn+cn*cn+In*In);let Ir=(1<<vt-Dt.zoom)*Je*An;return Ir*=on(Math.max(In,sn),dr),dr<Ir}let pn=Number.MAX_VALUE,_n=0;const _r=Dt.aabb.getCorners(),Vn=[];for(const dr of _r){r.a6.vec3.sub(Vn,dr,Fe),ue||(T?Vn[2]*=Le:Vn[2]=sn);const Ir=r.a6.vec3.dot(Vn,this._camera.forward());Ir<pn&&(pn=Ir,_n=Math.abs(Vn[2]))}let tr=(1<<vt-Dt.zoom)*Je*An;if(tr*=on(Math.max(_n,sn),pn),pn<tr)return!0;const zr=Dt.aabb.closestPoint(te);return zr[0]===te[0]&&zr[1]===te[1]};if(this.renderWorldCopies)for(let Dt=1;Dt<=3;Dt++)Et.push(yt(-Dt)),Et.push(yt(Dt));for(Et.push(yt(0));Et.length>0;){const Dt=Et.pop(),dn=Dt.x,cn=Dt.y;let In=Dt.fullyVisible;const An=()=>this.projection.name==="globe"&&(Dt.y===0||Dt.y===(1<<Dt.zoom)-1);if(!In){let pn=Ye?Dt.aabb.intersects(me):Dt.aabb.intersectsFlat(me);if(pn===0&&An()){const _n=new r.bP(Dt.zoom,dn,cn);pn=r.bQ(this,ee,_n,!0).intersects(me)}if(pn===0)continue;In=pn===2}if(Dt.zoom!==vt&&Tn(Dt))for(let pn=0;pn<4;pn++){const _n=(dn<<1)+pn%2,_r=(cn<<1)+(pn>>1),Vn={aabb:A?Dt.aabb.quadrant(pn):r.bR(this,ee,Dt.zoom+1,_n,_r,Dt.wrap,Dt.minZ,Dt.maxZ,this.projection),zoom:Dt.zoom+1,x:_n,y:_r,wrap:Dt.wrap,fullyVisible:In,tileID:void 0,shouldSplit:void 0,minZ:Dt.minZ,maxZ:Dt.maxZ};T&&!ue&&(Vn.tileID=new r.aA(Dt.zoom+1===vt?Ot:Dt.zoom+1,Dt.wrap,Dt.zoom+1,_n,_r),mn(Vn)),Et.push(Vn)}else{const pn=Dt.zoom===vt?Ot:Dt.zoom;if(o.minzoom&&o.minzoom>pn)continue;let _n=0;if(!In){let zr=Ye?Dt.aabb.intersectsPrecise(me):Dt.aabb.intersectsPreciseFlat(me);if(zr===0&&An()){const dr=new r.bP(Dt.zoom,dn,cn);zr=r.bQ(this,ee,dr,!0).intersectsPrecise(me)}if(zr===0)continue;if(o.calculateQuadrantVisibility)if(me.containsPoint(Dt.aabb.center))_n=15;else for(let dr=0;dr<4;dr++)Dt.aabb.quadrant(dr).intersects(me)!==0&&(_n|=1<<dr)}const _r=te[0]-(.5+dn+(Dt.wrap<<Dt.zoom))*(1<<c-Dt.zoom),Vn=te[1]-.5-cn,tr=Dt.tileID?Dt.tileID:new r.aA(pn,Dt.wrap,Dt.zoom,dn,cn);o.calculateQuadrantVisibility&&(tr.visibleQuadrants=_n),bt.push({tileID:tr,distanceSq:_r*_r+Vn*Vn})}}if(this.fogCullDistSq){const Dt=this.fogCullDistSq,dn=this.horizonLineFromTop();bt=bt.filter(cn=>{const In=[0,0,0,1],An=[r.ab,r.ab,0,1],pn=this.calculateFogTileMatrix(cn.tileID.toUnwrapped());r.a6.vec4.transformMat4(In,In,pn),r.a6.vec4.transformMat4(An,An,pn);const _n=r.a6.vec4.min([],In,An),_r=r.a6.vec4.max([],In,An),Vn=r.bS(_n,_r);if(Vn===0)return!0;let tr=!1;const zr=this._elevation;if(zr&&Vn>Dt&&dn!==0){const dr=this.calculateProjMatrix(cn.tileID.toUnwrapped());let Ir;o.isTerrainDEM||(Ir=zr.getMinMaxForTile(cn.tileID)),Ir||(Ir={min:rt,max:it});const oi=r.c3(this.rotation),Qr=[oi[0]*r.ab,oi[1]*r.ab,Ir.max];r.a6.vec3.transformMat4(Qr,Qr,dr),tr=(1-Qr[1])*this.height*.5<dn}return Vn<Dt||tr})}return bt.sort((Dt,dn)=>Dt.distanceSq-dn.distanceSq).map(Dt=>Dt.tileID)}resize(o,c){this.width=o,this.height=c,this.pixelsToGLUnits=[2/o,-2/c],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(o){return Math.pow(2,o)}scaleZoom(o){return Math.log(o)/Math.LN2}project(o){const c=r.ap(o.lat,-r.bT,r.bT),y=this.projection.project(o.lng,c);return new r.P(y.x*this.worldSize,y.y*this.worldSize)}unproject(o){return this.projection.unproject(o.x/this.worldSize,o.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/r.bD(1,this.center.lat)/this.worldSize}setLocationAtPoint(o,c){let y,S;const T=this.centerPoint;if(this.projection.name==="globe"){const $=this.worldSize;y=(c.x-T.x)/$,S=(c.y-T.y)/$}else{const $=this.pointCoordinate(c),Y=this.pointCoordinate(T);y=$.x-Y.x,S=$.y-Y.y}const A=this.locationCoordinate(o);this.setLocation(new r.a5(A.x-y,A.y-S))}setLocation(o){this.center=this.coordinateLocation(o),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(o){return this.projection.locationPoint(this,o)}locationPoint3D(o){return this.projection.locationPoint(this,o,!0)}pointLocation(o){return this.coordinateLocation(this.pointCoordinate(o))}pointLocation3D(o){return this.coordinateLocation(this.pointCoordinate3D(o))}locationCoordinate(o,c){const y=c?r.bD(c,o.lat):void 0,S=this.projection.project(o.lng,o.lat);return new r.a5(S.x,S.y,y)}coordinateLocation(o){return this.projection.unproject(o.x,o.y)}pointRayIntersection(o,c){const y=c??this._centerAltitude,S=[o.x,o.y,0,1],T=[o.x,o.y,1,1];r.a6.vec4.transformMat4(S,S,this.pixelMatrixInverse),r.a6.vec4.transformMat4(T,T,this.pixelMatrixInverse);const A=T[3];r.a6.vec4.scale(S,S,1/S[3]),r.a6.vec4.scale(T,T,1/A);const $=S[2],Y=T[2];return{p0:S,p1:T,t:$===Y?0:(y-$)/(Y-$)}}screenPointToMercatorRay(o){const c=[o.x,o.y,0,1],y=[o.x,o.y,1,1];return r.a6.vec4.transformMat4(c,c,this.pixelMatrixInverse),r.a6.vec4.transformMat4(y,y,this.pixelMatrixInverse),r.a6.vec4.scale(c,c,1/c[3]),r.a6.vec4.scale(y,y,1/y[3]),c[2]=r.bD(c[2],this._center.lat)*this.worldSize,y[2]=r.bD(y[2],this._center.lat)*this.worldSize,r.a6.vec4.scale(c,c,1/this.worldSize),r.a6.vec4.scale(y,y,1/this.worldSize),new r.aj([c[0],c[1],c[2]],r.a6.vec3.normalize([],r.a6.vec3.sub([],y,c)))}rayIntersectionCoordinate(o){const{p0:c,p1:y,t:S}=o,T=r.bD(c[2],this._center.lat),A=r.bD(y[2],this._center.lat);return new r.a5(r.aa(c[0],y[0],S)/this.worldSize,r.aa(c[1],y[1],S)/this.worldSize,r.aa(T,A,S))}pointCoordinate(o,c=this._centerAltitude){return this.projection.pointCoordinate(this,o.x,o.y,c)}pointCoordinate3D(o){if(!this.elevation)return this.pointCoordinate(o);let c=this.projection.pointCoordinate3D(this,o.x,o.y);if(c)return new r.a5(c[0],c[1],c[2]);let y=0,S=this.horizonLineFromTop();if(o.y>S)return this.pointCoordinate(o);const T=.02*S,A=o.clone();for(let $=0;$<10&&S-y>T;$++){A.y=r.aa(y,S,.66);const Y=this.projection.pointCoordinate3D(this,A.x,A.y);Y?(S=A.y,c=Y):y=A.y}return c?new r.a5(c[0],c[1],c[2]):this.pointCoordinate(o)}isPointAboveHorizon(o){return this.projection.isPointAboveHorizon(this,o)}isPointOnSurface(o){if(o.y<0||o.y>this.height||o.x<0||o.x>this.width)return!1;if(this.elevation||this.zoom>=r.bU)return!this.isPointAboveHorizon(o);const c=this.pointCoordinate(o);return c.y>=0&&c.y<=1}_coordinatePoint(o,c){const y=c&&this.elevation?this.elevation.getAtPointOrZero(o,this._centerAltitude):this._centerAltitude,S=[o.x*this.worldSize,o.y*this.worldSize,y+o.toAltitude(),1];return r.a6.vec4.transformMat4(S,S,this.pixelMatrix),S[3]>0?new r.P(S[0]/S[3],S[1]/S[3]):new r.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:o,left:c}=this._edgeInsets,y=this.height-this._edgeInsets.bottom,S=this.width-this._edgeInsets.right,T=this.pointLocation3D(new r.P(c,o)),A=this.pointLocation3D(new r.P(S,o)),$=this.pointLocation3D(new r.P(S,y)),Y=this.pointLocation3D(new r.P(c,y));let ee=Math.min(T.lng,A.lng,$.lng,Y.lng),te=Math.max(T.lng,A.lng,$.lng,Y.lng),ue=Math.min(T.lat,A.lat,$.lat,Y.lat),fe=Math.max(T.lat,A.lat,$.lat,Y.lat);const me=Math.pow(2,-this.zoom)/16*270,ke=this.projection.name==="globe"?1:4,Le=(De,Fe,Ye,Je,qe)=>{const it=(De+Ye)/2,rt=(Fe+Je)/2,mt=new r.P(it,rt),{lng:dt,lat:yt}=this.pointLocation3D(mt),Et=Math.max(0,ee-dt,ue-yt,dt-te,yt-fe);ee=Math.min(ee,dt),te=Math.max(te,dt),ue=Math.min(ue,yt),fe=Math.max(fe,yt),(qe<ke||Et>me)&&(Le(De,Fe,it,rt,qe+1),Le(it,rt,Ye,Je,qe+1))};if(Le(c,o,S,o,1),Le(S,o,S,y,1),Le(S,y,c,y,1),Le(c,y,c,o,1),this.projection.name==="globe"){const[De,Fe]=r.bV(this);De?(fe=90,te=180,ee=-180):Fe&&(ue=-90,te=180,ee=-180)}return new r.as(new r.bK(ee,ue),new r.bK(te,fe))}_getBoundsRectangular(o,c){const{top:y,left:S}=this._edgeInsets,T=this.height-this._edgeInsets.bottom,A=this.width-this._edgeInsets.right,$=new r.P(S,y),Y=new r.P(A,y),ee=new r.P(A,T),te=new r.P(S,T);let ue=this.pointCoordinate($,o),fe=this.pointCoordinate(Y,o);const me=this.pointCoordinate(ee,c),ke=this.pointCoordinate(te,c),Le=(De,Fe)=>(Fe.y-De.y)/(Fe.x-De.x);return ue.y>1&&fe.y>=0?ue=new r.a5((1-ke.y)/Le(ke,ue)+ke.x,1):ue.y<0&&fe.y<=1&&(ue=new r.a5(-ke.y/Le(ke,ue)+ke.x,0)),fe.y>1&&ue.y>=0?fe=new r.a5((1-me.y)/Le(me,fe)+me.x,1):fe.y<0&&ue.y<=1&&(fe=new r.a5(-me.y/Le(me,fe)+me.x,0)),new r.as().extend(this.coordinateLocation(ue)).extend(this.coordinateLocation(fe)).extend(this.coordinateLocation(ke)).extend(this.coordinateLocation(me))}_getBoundsRectangularTerrain(){const o=this.elevation;if(!o.visibleDemTiles.length||o.isUsingMockSource())return this._getBoundsRectangular(0,0);const c=o.visibleDemTiles.reduce((y,S)=>{if(S.dem){const T=S.dem.tree;y.min=Math.min(y.min,T.minimums[0]),y.max=Math.max(y.max,T.maximums[0])}return y},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(c.min*o.exaggeration(),c.max*o.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(o=!0){const c=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,y=this.height/2-c*(1-this._horizonShift);return o?Math.max(0,y):y}getMaxBounds(){return this.maxBounds}setMaxBounds(o){this.maxBounds=o,this.minLat=-r.bT,this.maxLat=r.bT,this.minLng=-180,this.maxLng=180,o&&(this.minLat=o.getSouth(),this.maxLat=o.getNorth(),this.minLng=o.getWest(),this.maxLng=o.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=r.am(this.minLng)*this.tileSize,this.worldMaxX=r.am(this.maxLng)*this.tileSize,this.worldMinY=r.at(this.maxLat)*this.tileSize,this.worldMaxY=r.at(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(o,c){return this.projection.createTileMatrix(this,c,o)}calculateDistanceTileData(o){const c=o.key,y=this._distanceTileDataCache;if(y[c])return y[c];const S=o.canonical,T=1/this.height,A=this.cameraWorldSize,$=A/this.zoomScale(S.z),Y=(S.x+Math.pow(2,S.z)*o.wrap)*$,ee=S.y*$,te=this.point;te.x*=A/this.worldSize,te.y*=A/this.worldSize;const ue=this.angle,fe=Math.sin(-ue),me=-Math.cos(-ue);return y[c]={bearing:[fe,me],center:[(te.x-Y)*T,(te.y-ee)*T],scale:$/r.ab*T},y[c]}calculateFogTileMatrix(o){const c=o.key,y=this._fogTileMatrixCache;if(y[c])return y[c];const S=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,o);return r.a6.mat4.multiply(S,this.worldToFogMatrix,S),y[c]=new Float32Array(S),y[c]}calculateProjMatrix(o,c=!1,y=!1){const S=o.key;let T;if(T=y?this._expandedProjMatrixCache:c?this._alignedProjMatrixCache:this._projMatrixCache,T[S])return T[S];const A=this.calculatePosMatrix(o,this.worldSize);let $;return $=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:y?this.expandedFarZProjMatrix:c?this.alignedProjMatrix:this.projMatrix,r.a6.mat4.multiply(A,$,A),T[S]=new Float32Array(A),T[S]}calculatePixelsToTileUnitsMatrix(o){const c=o.tileID.key,y=this._pixelsToTileUnitsCache;if(y[c])return y[c];const S=r.bW(o,this);return y[c]=S,y[c]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const o=1/this.worldSize,c=r.a6.mat4.fromScaling([],[o,o,o]);return r.a6.mat4.multiply(c,c,this.globeMatrix),c}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const o=this._elevation;this._updateCameraState();const c=r.bD(1,this._center.lat)*this.worldSize,y=this._computeCameraPosition(c),S=this._camera.forward(),T=r.bD(1,this._center.lat);y[2]/=T,S[2]/=T,r.a6.vec3.normalize(S,S);const A=o.raycast(y,S,o.exaggeration());if(A){const $=r.a6.vec3.scaleAndAdd([],y,S,A),Y=new r.a5($[0],$[1],r.bD($[2],r.aM($[1]))),ee=(Y.z+r.a6.vec3.length([Y.x-y[0],Y.y-y[1],Y.z-y[2]*T]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(ee),this._centerAltitude=Y.toAltitude(),this._center=this.coordinateLocation(Y),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(o=!1){if(!this._elevation)return;const c=this._elevation,y=r.bD(1,this._center.lat)*this.worldSize,S=this._computeCameraPosition(y),T=c.getAtPointOrZero(new r.a5(...S)),A=this.pixelsPerMeter/this.worldSize*T,$=this._minimumHeightOverTerrain(),Y=S[2]-A;if(Y<=$)if(Y<0||o){const ee=this.locationCoordinate(this._center,this._centerAltitude),te=[S[0],S[1],ee.z-S[2]],ue=r.a6.vec3.length(te);te[2]-=($-Y)/this._pixelsPerMercatorPixel;const fe=r.a6.vec3.length(te);if(fe===0)return;r.a6.vec3.scale(te,te,ue/fe*this._pixelsPerMercatorPixel),this._camera.position=[S[0],S[1],ee.z*this._pixelsPerMercatorPixel-te[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const o=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||o){const fe=this.center;return fe.lat=r.ap(fe.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!o)&&(fe.lng=r.ap(fe.lng,this.minLng,this.maxLng)),this.center=fe,void(this._constraining=!1)}const c=this._unmodified,{x:y,y:S}=this.point;let T=0,A=y,$=S;const Y=this.width/2,ee=this.height/2,te=this.worldMinY*this.scale,ue=this.worldMaxY*this.scale;if(S-ee<te&&($=te+ee),S+ee>ue&&($=ue-ee),ue-te<this.height&&(T=Math.max(T,this.height/(ue-te)),$=(ue+te)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const fe=this.worldMinX*this.scale,me=this.worldMaxX*this.scale,ke=this.worldSize/2-(fe+me)/2;A=(y+ke+this.worldSize)%this.worldSize-ke,A-Y<fe&&(A=fe+Y),A+Y>me&&(A=me-Y),me-fe<this.width&&(T=Math.max(T,this.width/(me-fe)),A=(me+fe)/2)}A===y&&$===S||(this.center=this.unproject(new r.P(A,$))),T&&(this.zoom+=this.scaleZoom(T)),this._constrainCamera(),this._unmodified=c,this._constraining=!1}_minZoomForBounds(){let o=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(o=Math.max(o,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),o}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const o=this.centerOffset,c=this.projection.name==="globe",y=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=r.bD(1,this.center.lat)/r.bD(1,r.c4));const S=r.bX(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,S),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const T=this.projection.zAxisUnit==="meters"?y:1,A=this._camera.getWorldToCamera(this.worldSize,T);let $;const Y=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(Y[8]=2*-o.x/this.width,Y[9]=2*o.y/this.height,this.isOrthographic){let yt=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),Et=yt*this.aspect,bt=-Et,vt=-yt;Et-=o.x,bt-=o.x,yt+=o.y,vt+=o.y,$=this._camera.getCameraToClipOrthographic(bt,Et,vt,yt,this._nearZ,this._farZ),((Ot,sn,mn,on)=>{for(let Tn=0;Tn<16;Tn++)Ot[Tn]=wl(sn[Tn],mn[Tn],on)})($,$,Y,Aa(this.pitch>=15?1:this.pitch/15))}else $=Y;const ee=r.a6.mat4.mul([],Y,A);let te=r.a6.mat4.mul([],$,A);if(this.projection.isReprojectedInTileSpace){const yt=this.locationCoordinate(this.center),Et=r.a6.mat4.identity([]);r.a6.mat4.translate(Et,Et,[yt.x*this.worldSize,yt.y*this.worldSize,0]),r.a6.mat4.multiply(Et,Et,r.bY(this)),r.a6.mat4.translate(Et,Et,[-yt.x*this.worldSize,-yt.y*this.worldSize,0]),r.a6.mat4.multiply(te,te,Et),r.a6.mat4.multiply(ee,ee,Et),this.inverseAdjustmentMatrix=r.bZ(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=r.a6.mat4.scale([],te,[this.worldSize,this.worldSize,this.worldSize/T,1]),this.projMatrix=te,this.invProjMatrix=r.a6.mat4.invert(new Float64Array(16),this.projMatrix),c){const yt=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);yt[8]=2*-o.x/this.width,yt[9]=2*o.y/this.height,this.expandedFarZProjMatrix=r.a6.mat4.mul([],yt,A)}else this.expandedFarZProjMatrix=this.projMatrix;const ue=r.a6.mat4.invert([],$);this.frustumCorners=r.b_.fromInvProjectionMatrix(ue,this.horizonLineFromTop(),this.height),this.cameraFrustum=r.bN.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!c);const fe=new Float32Array(16);r.a6.mat4.identity(fe),r.a6.mat4.scale(fe,fe,[1,-1,1]),r.a6.mat4.rotateX(fe,fe,this._pitch),r.a6.mat4.rotateZ(fe,fe,this.angle);const me=r.a6.mat4.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=r.a6.mat4.clone(me);const ke=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;me[8]=2*-o.x/this.width,me[9]=2*(o.y+ke)/this.height,this.skyboxMatrix=r.a6.mat4.multiply(fe,me,fe);const Le=this.point,De=Le.x,Fe=Le.y,Ye=this.width%2/2,Je=this.height%2/2,qe=Math.cos(this.angle),it=Math.sin(this.angle),rt=De-Math.round(De)+qe*Ye+it*Je,mt=Fe-Math.round(Fe)+qe*Je+it*Ye,dt=new Float64Array(te);if(r.a6.mat4.translate(dt,dt,[rt>.5?rt-1:rt,mt>.5?mt-1:mt,0]),this.alignedProjMatrix=dt,te=r.a6.mat4.create(),r.a6.mat4.scale(te,te,[this.width/2,-this.height/2,1]),r.a6.mat4.translate(te,te,[1,-1,0]),this.labelPlaneMatrix=te,te=r.a6.mat4.create(),r.a6.mat4.scale(te,te,[1,-1,1]),r.a6.mat4.translate(te,te,[-1,-1,0]),r.a6.mat4.scale(te,te,[2/this.width,2/this.height,1]),this.glCoordMatrix=te,this.pixelMatrix=r.a6.mat4.multiply(new Float64Array(16),this.labelPlaneMatrix,ee),this._calcFogMatrices(),this._distanceTileDataCache={},te=r.a6.mat4.invert(new Float64Array(16),this.pixelMatrix),!te)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=te,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=r.b$(this);const yt=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=r.a6.vec3.transformMat4(yt,yt,A),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=te;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const o=this.cameraWorldSizeForFog,c=this.cameraPixelsPerMeter,y=this._camera.position,S=1/this.height/this._pixelsPerMercatorPixel,T=[o,o,c];r.a6.vec3.scale(T,T,S),r.a6.vec3.scale(y,y,-1),r.a6.vec3.multiply(y,y,T);const A=r.a6.mat4.create();r.a6.mat4.translate(A,A,y),r.a6.mat4.scale(A,A,T),this.mercatorFogMatrix=A,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(o,c,S)}_computeCameraPosition(o){const c=(o=o||this.pixelsPerMeter)/this.pixelsPerMeter,y=this._camera.forward(),S=this.point,T=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*c-o/this.worldSize*this._centerAltitude;return[S.x/this.worldSize-y[0]*T,S.y/this.worldSize-y[1]*T,o/this.worldSize*this._centerAltitude-y[2]*T]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(o){const c=this._maxCameraBoundsDistance()*Math.cos(this._pitch),y=this._camera.position[2],S=o[2];let T=1;this.projection.wrap&&(this.center=this.center.wrap()),S>0&&(T=Math.min((c-y)/S,1)),this._camera.position=r.a6.vec3.scaleAndAdd([],this._camera.position,o,T),this._updateStateFromCamera()}_updateStateFromCamera(){const o=this._camera.position,c=this._camera.forward(),{pitch:y,bearing:S}=this._camera.getPitchBearing(),T=r.bD(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,A=this._mercatorZfromZoom(this._maxZoom)*Math.cos(r.bB(this._maxPitch)),$=Math.max((o[2]-T)/Math.cos(y),A),Y=this._zoomFromMercatorZ($);r.a6.vec3.scaleAndAdd(o,o,c,$),this._pitch=r.ap(y,r.bB(this.minPitch),r.bB(this.maxPitch)),this.angle=r.bA(S,-Math.PI,Math.PI),this._setZoom(r.ap(Y,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new r.a5(o[0],o[1],o[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(o){return Math.pow(2,o)*this.tileSize}_mercatorZfromZoom(o){return this.cameraToCenterDistance/this._worldSizeFromZoom(o)}_minimumHeightOverTerrain(){const o=Math.min(this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(o)}_zoomFromMercatorZ(o){return this.scaleZoom(this.cameraToCenterDistance/(o*this.tileSize))}zoomFromMercatorZAdjusted(o){let c=0,y=r.bU,S=0,T=1/0;for(;y-c>1e-6&&y>c;){const A=c+.5*(y-c),$=this.tileSize*Math.pow(2,A),Y=this.getCameraToCenterDistance(this.projection,A,$),ee=this.scaleZoom(Y/(o*this.tileSize)),te=Math.abs(A-ee);te<T&&(T=te,S=A),A<ee?c=A:y=A}return S}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(r.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(o,c){const y=Math.min(o.x,c.x),S=Math.max(o.x,c.x),T=Math.min(o.y,c.y),A=Math.max(o.y,c.y);if(T<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const $=[new r.P(y,T),new r.P(S,A),new r.P(y,A),new r.P(S,T)],Y=this.renderWorldCopies?-3:0,ee=this.renderWorldCopies?4:1;for(const te of $){const ue=this.pointRayIntersection(te);if(ue.t<0)return!0;const fe=this.rayIntersectionCoordinate(ue);if(fe.x<Y||fe.y<0||fe.x>ee||fe.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+r.c0(this.fovAboveCenter)>88||this.anyCornerOffEdge(new r.P(0,0),new r.P(this.width,this.height))}zoomDeltaToMovement(o,c){const y=r.a6.vec3.length(r.a6.vec3.sub([],this._camera.position,o)),S=this._zoomFromMercatorZ(y)+c;return y-this._mercatorZfromZoom(S)}getCameraPoint(){if(this.projection.name==="globe"){const o=function([c,y,S],T){const A=[c,y,S,1];r.a6.vec4.transformMat4(A,A,T);const $=A[3]=Math.max(A[3],1e-6);return A[0]/=$,A[1]/=$,A[2]/=$,A}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new r.P(o[0],o[1])}{const o=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new r.P(0,o))}}getCameraToCenterDistance(o,c=this.zoom,y=this.worldSize){const S=r.bX(o,c,this.width,this.height,1024),T=o.pixelSpaceConversion(this.center.lat,y,S);let A=.5/Math.tan(.5*this._fov)*this.height*T;return this.isOrthographic&&(A=wl(1,A,Aa(this.pitch>=15?1:this.pitch/15))),A}getWorldToCameraMatrix(){const o=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&r.a6.mat4.multiply(o,o,this.globeMatrix),o}getFrustum(o){return r.bN.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,o,this.projection.zAxisUnit==="meters")}}const zs=(g,o)=>{if(o>0&&g.terrain&&r.w("Cutoff is currently disabled on terrain"),o<=0||g.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const c=g.transform,y=Math.max(Math.abs(c._zoom-(g.minCutoffZoom-1)),1),S=c.isLODDisabled(!1)?r.a7(60,45,c.pitch):r.a7(30,15,c.pitch),T=c._farZ-c._nearZ,A=o*c.height,$=((1-(Y=S))*c.cameraToCenterDistance+Y*(c._farZ+A))*y;var Y;return{shouldRenderCutoff:S<1,uniformValues:{u_cutoff_params:[c._nearZ,c._farZ,($-c._nearZ)/T,($-A-c._nearZ)/T]}}},ho={cascadeCount:2,normalOffset:3,shadowMapResolution:2048};class Sl{constructor(o,c){this.aabb=o,this.lastCascade=c}}class Nn{add(o,c){const y=this.receivers[o.key];y!==void 0?(y.aabb.min[0]=Math.min(y.aabb.min[0],c.min[0]),y.aabb.min[1]=Math.min(y.aabb.min[1],c.min[1]),y.aabb.min[2]=Math.min(y.aabb.min[2],c.min[2]),y.aabb.max[0]=Math.max(y.aabb.max[0],c.max[0]),y.aabb.max[1]=Math.max(y.aabb.max[1],c.max[1]),y.aabb.max[2]=Math.max(y.aabb.max[2],c.max[2])):this.receivers[o.key]=new Sl(c,null)}clear(){this.receivers={}}get(o){return this.receivers[o.key]}computeRequiredCascades(o,c,y){const S=r.c9.fromPoints(o.points);let T=0;for(const A in this.receivers){const $=this.receivers[A];if(!$||!S.intersectsAabb($.aabb))continue;$.aabb.min=S.closestPoint($.aabb.min),$.aabb.max=S.closestPoint($.aabb.max);const Y=$.aabb.getCorners();for(let ee=0;ee<y.length;ee++){let te=!0;for(const ue of Y){const fe=[ue[0]*c,ue[1]*c,ue[2]];if(r.a6.vec3.transformMat4(fe,fe,y[ee].matrix),fe[0]<-1||fe[0]>1||fe[1]<-1||fe[1]>1){te=!1;break}}if($.lastCascade=ee,T=Math.max(T,ee),te)break}}return T+1}}class nh{constructor(o){this.painter=o,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new Nn,this._depthMode=new cr(o.context.gl.LEQUAL,cr.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,o.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},()=>{this.painter.style.map.triggerRepaint()}),o.tp.registerParameter(ho,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),o.tp.registerParameter(ho,["Shadows"],"normalOffset",{min:0,max:10,step:.05}),o.tp.registerParameter(ho,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),o.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(const o of this._cascades)o.texture.destroy(),o.framebuffer.destroy();this._cascades=[]}updateShadowParameters(o,c){const y=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!c||!c.properties)return;const S=c.properties.get("shadow-intensity");if(!c.shadowsEnabled()||S<=0||(this._shadowLayerCount=y.style.order.reduce((ke,Le)=>{const De=y.style._mergedLayers[Le];return ke+(De.hasShadowPass()&&!De.isHidden(o.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this.enabled))return;const T=y.context,A=ho.shadowMapResolution,$=ho.shadowMapResolution;if(this._cascades.length===0||ho.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let ke=0;ke<ho.cascadeCount;++ke){const Le=y._shadowMapDebug,De=T.gl,Fe=T.createFramebuffer(A,$,Le,"texture"),Ye=new r.T(T,{width:A,height:$,data:null},De.DEPTH_COMPONENT16);if(Fe.depthAttachment.set(Ye.texture),Le){const Je=new r.T(T,{width:A,height:$,data:null},De.RGBA8);Fe.colorAttachment.set(Je.texture)}this._cascades.push({framebuffer:Fe,texture:Ye,matrix:[],far:0,boundingSphereRadius:0,frustum:new r.bN,scale:0})}}this.shadowDirection=Nu(c);let Y=0;if(o.elevation){const ke=o.elevation,Le=[1e4,-1e4];ke.visibleDemTiles.filter(De=>De.dem).forEach(De=>{const Fe=De.dem.tree;Le[0]=Math.min(Le[0],Fe.minimums[0]),Le[1]=Math.max(Le[1],Fe.maximums[0])}),Le[0]!==1e4&&(Y=(Le[1]-Le[0])*ke.exaggeration())}const ee=1.5*o.cameraToCenterDistance,te=3*ee,ue=new Float64Array(16);for(let ke=0;ke<this._cascades.length;++ke){const Le=this._cascades[ke];let De=o.height/50,Fe=1;ho.cascadeCount===1?Fe=te:ke===0?Fe=ee:(De=ee,Fe=te);const[Ye,Je]=hu(o,this.shadowDirection,De,Fe,ho.shadowMapResolution,Y);Le.scale=o.scale,Le.matrix=Ye,Le.boundingSphereRadius=Je,r.a6.mat4.invert(ue,Le.matrix),Le.frustum=r.bN.fromInvProjectionMatrix(ue,1,0,!0),Le.far=Fe}const fe=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[fe].far,this._cascades[fe].far],this._uniformValues.u_shadow_intensity=S,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/ho.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=ho.shadowMapResolution,this._uniformValues.u_shadowmap_0=cs.ShadowMap0,this._uniformValues.u_shadowmap_1=cs.ShadowMap0+1,this._groundShadowTiles=y.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const me=y.transform.elevation;for(const ke of this._groundShadowTiles){let Le={min:0,max:0};if(me){const De=me.getMinMaxForTile(ke);De&&(Le=De)}this.addShadowReceiver(ke.toUnwrapped(),Le.min,Le.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(o){this._enabled=o}drawShadowPass(o,c){if(!this.enabled)return;const y=this.painter,S=y.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(y.transform.getFrustum(0),y.transform.worldSize,this._cascades),S.viewport.set([0,0,ho.shadowMapResolution,ho.shadowMapResolution]);for(let T=0;T<this._numCascadesToRender;++T){y.currentShadowCascade=T,S.bindFramebuffer.set(this._cascades[T].framebuffer.framebuffer),S.clear({color:r.bz.white,depth:1});for(const A of o.order){const $=o._mergedLayers[A];if(!$.hasShadowPass()||$.isHidden(y.transform.zoom))continue;const Y=o.getLayerSourceCache($),ee=Y?c[Y.id]:void 0;($.type==="model"||ee&&ee.length)&&y.renderLayer(y,Y,$,ee)}}y.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;const o=this.painter,c=o.style,y=o.context,S=c.directionalLight,T=c.ambientLight;if(!S||!T)return;const A=[],$=zs(o,o.longestCutoffRange);$.shouldRenderCutoff&&A.push("RENDER_CUTOFF");const Y=Bu(c,S,T),ee=new cr(y.gl.LEQUAL,cr.ReadOnly,o.depthRangeFor3D);for(const te of this._groundShadowTiles){const ue=te.toUnwrapped(),fe=o.isTileAffectedByFog(te),me=o.getOrCreateProgram("groundShadow",{defines:A,overrideFog:fe});this.setupShadows(ue,me),o.uploadCommonUniforms(y,me,ue,null,$);const ke={u_matrix:o.transform.calculateProjMatrix(ue),u_ground_shadow_factor:Y};me.draw(o,y.gl.TRIANGLES,ee,Dr.disabled,Hr.multiply,Mr.disabled,ke,"ground_shadow",o.tileExtentBuffer,o.quadTriangleIndexBuffer,o.tileExtentSegments,{},o.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?Hr.unblended:Hr.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(o){const c=this.painter.transform,y=c.calculatePosMatrix(o,c.worldSize);return r.a6.mat4.multiply(y,this._cascades[this.painter.currentShadowCascade].matrix,y),Float32Array.from(y)}calculateShadowPassMatrixFromMatrix(o){return r.a6.mat4.multiply(o,this._cascades[this.painter.currentShadowCascade].matrix,o),Float32Array.from(o)}setupShadows(o,c,y,S=0){if(!this.enabled)return;const T=this.painter.transform,A=this.painter.context,$=A.gl,Y=this._uniformValues,ee=new Float64Array(16),te=T.calculatePosMatrix(o,T.worldSize);for(let ue=0;ue<this._cascades.length;ue++)r.a6.mat4.multiply(ee,this._cascades[ue].matrix,te),Y[ue===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(ee),A.activeTexture.set($.TEXTURE0+cs.ShadowMap0+ue),this._cascades[ue].texture.bind($.NEAREST,$.CLAMP_TO_EDGE);if(this.useNormalOffset=!!y,this.useNormalOffset){const ue=r.c8(o.canonical),fe=2/T.tileSize*r.ab/ho.shadowMapResolution,me=fe*this._cascades[0].boundingSphereRadius,ke=fe*this._cascades[this._cascades.length-1].boundingSphereRadius,Le=(y==="vector-tile"?1:3)/Math.pow(2,S-o.canonical.z-(1-T.zoom+Math.floor(T.zoom)));Y.u_shadow_normal_offset=[ue,me*Le,ke*Le],Y.u_shadow_bias=[6e-5,.0012,.012]}else Y.u_shadow_bias=[36e-5,.0012,.012];c.setShadowUniformValues(A,Y)}setupShadowsFromMatrix(o,c,y=!1){if(!this.enabled)return;const S=this.painter.context,T=S.gl,A=this._uniformValues,$=new Float64Array(16);for(let Y=0;Y<ho.cascadeCount;Y++)r.a6.mat4.multiply($,this._cascades[Y].matrix,o),A[Y===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from($),S.activeTexture.set(T.TEXTURE0+cs.ShadowMap0+Y),this._cascades[Y].texture.bind(T.NEAREST,T.CLAMP_TO_EDGE);if(this.useNormalOffset=y,y){const Y=ho.normalOffset;A.u_shadow_normal_offset=[1,Y,Y],A.u_shadow_bias=[6e-5,.0012,.012]}else A.u_shadow_bias=[36e-5,.0012,.012];c.setShadowUniformValues(S,A)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(o,c,y,S){if(S[2]>=0)return{};const T=function(Y,ee,te){const ue=te/(1<<Y.canonical.z);return new r.c9([Y.canonical.x*ue+Y.wrap*te,Y.canonical.y*ue+Y.wrap*te,0],[(Y.canonical.x+1)*ue+Y.wrap*te,(Y.canonical.y+1)*ue+Y.wrap*te,ee])}(o,c,y).getCorners(),A=c/-S[2];S[0]<0?(r.a6.vec3.add(T[0],T[0],[S[0]*A,0,0]),r.a6.vec3.add(T[3],T[3],[S[0]*A,0,0])):S[0]>0&&(r.a6.vec3.add(T[1],T[1],[S[0]*A,0,0]),r.a6.vec3.add(T[2],T[2],[S[0]*A,0,0])),S[1]<0?(r.a6.vec3.add(T[0],T[0],[0,S[1]*A,0]),r.a6.vec3.add(T[1],T[1],[0,S[1]*A,0])):S[1]>0&&(r.a6.vec3.add(T[2],T[2],[0,S[1]*A,0]),r.a6.vec3.add(T[3],T[3],[0,S[1]*A,0]));const $={};return $.vertices=T,$.planes=[Ja(T[1],T[0],T[4]),Ja(T[2],T[1],T[5]),Ja(T[3],T[2],T[6]),Ja(T[0],T[3],T[7])],$}addShadowReceiver(o,c,y){this._receivers.add(o,r.c9.fromTileIdAndHeight(o,c,y))}getMaxCascadeForTile(o){const c=this._receivers.get(o);return c&&c.lastCascade?c.lastCascade:0}}function Ja(g,o,c){const y=r.a6.vec3.sub([],c,o),S=r.a6.vec3.sub([],g,o),T=r.a6.vec3.cross([],y,S),A=r.a6.vec3.length(T);return A===0?[0,0,1,0]:(r.a6.vec3.scale(T,T,1/A),[T[0],T[1],T[2],-r.a6.vec3.dot(T,o)])}function Nu(g){const o=g.properties.get("direction"),c=r.c7(o.x,o.y,o.z);c[2]=r.ap(c[2],0,75);const y=r.ca([c[0],c[1],c[2]]);return r.a6.vec3.fromValues(y.x,y.y,y.z)}function Bu(g,o,c){const y=o.properties.get("color"),S=o.properties.get("intensity"),T=o.properties.get("direction"),A=[T.x,T.y,T.z],$=c.properties.get("color"),Y=c.properties.get("intensity"),ee=Math.max(r.a6.vec3.dot([0,0,1],A),0),te=[0,0,0];r.a6.vec3.scale(te,$.toRenderColor(g.getLut(o.scope)).toArray01Linear().slice(0,3),Y);const ue=[0,0,0];return r.a6.vec3.scale(ue,y.toRenderColor(g.getLut(c.scope)).toArray01Linear().slice(0,3),ee*S),r.cb([te[0]>0?te[0]/(te[0]+ue[0]):0,te[1]>0?te[1]/(te[1]+ue[1]):0,te[2]>0?te[2]/(te[2]+ue[2]):0])}function hu(g,o,c,y,S,T){const A=g.zoom,$=g.scale,Y=g.worldSize,ee=1/Y,te=g.aspect,ue=Math.sqrt(1+te*te)*Math.tan(.5*g.fovX),fe=ue*ue,me=y-c,ke=y+c;let Le,De;fe>me/ke?(Le=y,De=y*ue):(Le=.5*ke*(1+fe),De=.5*Math.sqrt(me*me+2*(y*y+c*c)*fe+ke*ke*fe*fe));const Fe=g.projection.pixelsPerMeter(g.center.lat,Y),Ye=g._camera.getCameraToWorldMercator(),Je=[0,0,-Le*ee];r.a6.vec3.transformMat4(Je,Je,Ye);let qe=De*ee;const it=g._edgeInsets;if(!(it.left===0&&it.top===0&&it.right===0&&it.bottom===0||it.left===it.right&&it.top===it.bottom)){const In=g._camera.getWorldToCamera(g.worldSize,g.projection.zAxisUnit==="meters"?Fe:1),An=g._camera.getCameraToClipPerspective(g._fov,g.width/g.height,c,y);An[8]=2*-g.centerOffset.x/g.width,An[9]=2*g.centerOffset.y/g.height;const pn=new Float64Array(16);r.a6.mat4.mul(pn,An,In);const _n=new Float64Array(16);r.a6.mat4.invert(_n,pn);const _r=r.bN.fromInvProjectionMatrix(_n,Y,A,!0);for(const Vn of _r.points){const tr=((rt=Vn)[0]/=$,rt[1]/=$,rt[2]=r.bD(rt[2],g._center.lat),rt);qe=Math.max(qe,r.a6.vec3.len(r.a6.vec3.subtract([],Je,tr)))}}var rt;qe*=S/(S-1);const mt=Math.acos(o[2]),dt=Math.atan2(-o[0],-o[1]),yt=new du;yt.position=Je,yt.setPitchBearing(mt,dt);const Et=yt.getWorldToCamera(Y,Fe),bt=qe*Y,vt=Math.min(g._mercatorZfromZoom(17)*Y*-2,-2*bt),Ot=yt.getCameraToClipOrthographic(-bt,bt,-bt,bt,vt,(bt+T*Fe)/o[2]),sn=new Float64Array(16);r.a6.mat4.multiply(sn,Ot,Et);const mn=r.a6.vec3.fromValues(Math.floor(1e6*Je[0])/1e6*Y,Math.floor(1e6*Je[1])/1e6*Y,0),on=.5*S,Tn=[0,0,0];r.a6.vec3.transformMat4(Tn,mn,sn),r.a6.vec3.scale(Tn,Tn,on);const Dt=[Math.floor(Tn[0]),Math.floor(Tn[1]),Math.floor(Tn[2])],dn=[0,0,0];r.a6.vec3.sub(dn,Tn,Dt),r.a6.vec3.scale(dn,dn,-1/on);const cn=new Float64Array(16);return r.a6.mat4.identity(cn),r.a6.mat4.translate(cn,cn,dn),r.a6.mat4.multiply(sn,cn,sn),[sn,bt]}class Qa extends r.E{constructor(o){super(),this.requestManager=o,this.models={"":{}},this.numModelsLoading={}}loadModel(o,c){return r.aG(this.requestManager.transformRequest(c,r.R.Model).url).then(y=>{if(!y)return;const S=r.aH(y),T=new r.aI(o,void 0,void 0,S);return T.computeBoundsAndApplyParent(),T}).catch(y=>{if(y&&y.status===404)return null;this.fire(new r.t(new Error(`Could not load model ${o} from ${c}: ${y.message}`)))})}load(o,c){this.models[c]||(this.models[c]={});const y=Object.keys(o);this.numModelsLoading[c]=(this.numModelsLoading[c]||0)+y.length;const S=[];for(const T of y)S.push(this.loadModel(T,o[T]));Promise.allSettled(S).then(T=>{for(let A=0;A<T.length;A++){const{status:$,value:Y}=T[A];$==="fulfilled"&&Y&&(this.models[c][y[A]]={model:Y,numReferences:1})}this.numModelsLoading[c]-=y.length,this.fire(new r.x("data",{dataType:"style"}))}).catch(T=>{this.fire(new r.t(new Error(`Could not load models: ${T.message}`)))})}isLoaded(){for(const o in this.numModelsLoading)if(this.numModelsLoading[o]>0)return!1;return!0}hasModel(o,c){return!!this.getModel(o,c)}getModel(o,c){return this.models[c]||(this.models[c]={}),this.models[c][o]?this.models[c][o].model:void 0}addModel(o,c,y){this.models[y]||(this.models[y]={}),this.hasModel(o,y)&&this.models[y][o].numReferences++,this.load({[o]:this.requestManager.normalizeModelURL(c)},y)}addModels(o,c){this.models[c]||(this.models[c]={});const y={};for(const S in o)this.models[c][S]={},y[S]=this.requestManager.normalizeModelURL(o[S]);this.load(y,c)}addModelsFromBucket(o,c){this.models[c]||(this.models[c]={});const y={};for(const S of o)this.hasModel(S,c)?this.models[c][S].numReferences++:y[S]=this.requestManager.normalizeModelURL(S);this.load(y,c)}removeModel(o,c){if(this.models[c]&&this.models[c][o]&&(this.models[c][o].numReferences--,this.models[c][o].numReferences===0)){const y=this.models[c][o].model;delete this.models[c][o],y.destroy()}}listModels(o){return this.models[o]||(this.models[o]={}),Object.keys(this.models[o])}upload(o,c){this.models[c]||(this.models[c]={});for(const y in this.models[c])this.models[c][y].model&&this.models[c][y].model.upload(o.context)}}const Ul=new r.a0({data:new r.a1(r._.colorTheme.data)}),Xs=(g,o)=>Mt(g,o&&o.filter(c=>c.identifier!=="source.canvas")),fd=r.ar(Ln,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection","setCamera","addImport","removeImport","updateImport"]),rn=r.ar(Ln,["setCenter","setZoom","setBearing","setPitch"]),wn={version:8,layers:[],sources:{}},pr={duration:300,delay:0};class Pr extends r.E{constructor(o,c={}){super(),this.map=o,this.scope=c.scope||"",this.globalId=null,this.fragments=[],this.importDepth=c.importDepth||0,this.importsCache=c.importsCache||new Map,this.resolvedImports=c.resolvedImports||new Set,this.transition=r.l({},pr),this._buildingIndex=new rr(this),this.crossTileSymbolIndex=new Fu,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._clipLayerPresent=!1,this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=c.styleChanges||new Ae,this.dispatcher=c.dispatcher?c.dispatcher:new r.cd(r.ce(),this),c.imageManager?this.imageManager=c.imageManager:(this.imageManager=new gt,this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=c.glyphManager?c.glyphManager:new r.cf(o._requestManager,c.localFontFamily?r.cg.all:c.localIdeographFontFamily?r.cg.ideographs:r.cg.none,c.localFontFamily||c.localIdeographFontFamily),c.modelManager?this.modelManager=c.modelManager:(this.modelManager=new Qa(o._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._order=[],this._markersNeedUpdate=!1,this._styleColorTheme={lut:null,lutLoading:!1,lutLoadingCorrelationID:0,colorTheme:null},this._styleColorThemeForScope={},this.options=c.configOptions?c.configOptions:new Map,this._configDependentLayers=c.configDependentLayers?c.configDependentLayers:new Set,this._config=c.config,this._initialConfig=c.initialConfig,this.dispatcher.broadcast("setReferrer",r.ch());const y=this;this._rtlTextPluginCallback=Pr.registerForPluginStateChange(S=>{y.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:S.pluginStatus,pluginURL:S.pluginURL},(T,A)=>{if(r.ci(T),A&&A.every($=>$))for(const $ in y._sourceCaches){const Y=y._sourceCaches[$],ee=Y.getSource().type;ee!=="vector"&&ee!=="geojson"||Y.reload()}})}),this.on("data",S=>{if(S.dataType!=="source"||S.sourceDataType!=="metadata")return;const T=this.getOwnSource(S.sourceId);if(T&&T.vectorLayerIds)for(const A in this._layers){const $=this._layers[A];$.source===T.id&&this._validateLayer($)}})}load(o){return o?(typeof o=="string"?this.loadURL(o):this.loadJSON(o),this):this}_getGlobalId(o){if(!o)return null;if(typeof o=="string"){if(r.f(o))return o;const c=r.cj(o);if(!c.startsWith("http"))try{return new URL(c,location.href).toString()}catch{return c}return c}return`json://${r.ck(JSON.stringify(o))}`}_diffStyle(o,c,y){this.globalId=this._getGlobalId(o);const S=(T,A)=>{try{A(null,this.setState(T,y))}catch($){A($,!1)}};if(typeof o=="string"){const T=this.map._requestManager.normalizeStyleURL(o),A=this.map._requestManager.transformRequest(T,r.R.Style);r.n(A,($,Y)=>{$?this.fire(new r.t($)):Y&&S(Y,c)})}else typeof o=="object"&&S(o,c)}loadURL(o,c={}){this.fire(new r.x("dataloading",{dataType:"style"}));const y=typeof c.validate=="boolean"?c.validate:!r.f(o);this.globalId=this._getGlobalId(o),o=this.map._requestManager.normalizeStyleURL(o,c.accessToken),this.resolvedImports.add(o);const S=this.importsCache.get(o);if(S)return this._load(S,y);const T=this.map._requestManager.transformRequest(o,r.R.Style);this._request=r.n(T,(A,$)=>{if(this._request=null,A)this.fire(new r.t(A));else if($)return this.importsCache.set(o,$),this._load($,y)})}loadJSON(o,c={}){this.fire(new r.x("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(o),this._request=r.q.frame(()=>{this._request=null,this._load(o,c.validate!==!1)})}loadEmpty(){this.fire(new r.x("dataloading",{dataType:"style"})),this._load(wn,!1)}_loadImports(o,c,y){if(this.importDepth>=4)return r.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const S=[];for(const T of o){const A=this._createFragmentStyle(T),$=new Promise(te=>{A.once("style.import.load",te),A.once("error",te)}).then(()=>this.mergeAll());if(S.push($),this.resolvedImports.has(T.url)){A.loadEmpty();continue}const Y=T.data||this.importsCache.get(T.url);Y?(A.loadJSON(Y,{validate:c}),this._isInternalStyle(Y)&&(A.globalId=null)):T.url?A.loadURL(T.url,{validate:c}):A.loadEmpty();const ee={style:A,id:T.id,config:T.config};if(y){const te=this.fragments.findIndex(({id:ue})=>ue===y);this.fragments=this.fragments.slice(0,te).concat(ee).concat(this.fragments.slice(te))}else this.fragments.push(ee)}return Promise.allSettled(S)}getImportGlobalIds(o=this,c=new Set){for(const y of o.fragments)y.style.globalId&&c.add(y.style.globalId),this.getImportGlobalIds(y.style,c);return[...c.values()]}_createFragmentStyle(o){const c=this.scope?r.av(o.id,this.scope):o.id;let y;const S=this._initialConfig&&this._initialConfig[c];(o.config||S)&&(y=r.l({},o.config,S));const T=new Pr(this.map,{scope:c,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:y,configOptions:this.options,configDependentLayers:this._configDependentLayers});return T.setEventedParent(this.map,{style:T}),T}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.map._precompilePrograms&&this.isRootStyle()}_isInternalStyle(o){return this.isRootStyle()&&(o.fragment||!!o.schema&&o.fragment!==!1)}_load(o,c){const y=o.schema;if(this._isInternalStyle(o)){const A=r.l({},wn,{imports:[{id:"basemap",data:o,url:""}]});return void this._load(A,c)}if(this.updateConfig(this._config,y),c&&Xs(this,mi(o)))return;this._loaded=!0,this.stylesheet=r.cl(o);const S=()=>{for(const ee in o.sources)this.addSource(ee,o.sources[ee],{validate:!1,isInitialLoad:!0});o.sprite?this._loadSprite(o.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.glyphManager.setURL(o.glyphs,this.scope);const A=hr(this.stylesheet.layers);if(this._order=A.map(ee=>ee.id),this.stylesheet.light&&r.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const ee=this.stylesheet.lights[0];this.light=new At(ee.properties,ee.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new At(this.stylesheet.light)),this._layers={},this._serializedLayers={};for(const ee of A){const te=r.cq(ee,this.scope,this._styleColorTheme.lut,this.options);te.configDependencies.size!==0&&this._configDependentLayers.add(te.fqid),te.setEventedParent(this,{layer:{id:te.id}}),this._layers[te.id]=te,this._serializedLayers[te.id]=te.serialize();const ue=this.getOwnLayerSourceCache(te),fe=!!this.directionalLight&&this.directionalLight.shadowsEnabled();ue&&te.canCastShadows()&&fe&&(ue.castsShadows=!0)}this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);const $=this.stylesheet.terrain;$&&(this.checkCanvasFingerprintNoise(),this.disableElevatedTerrain||this.terrainSetForDrapingOnly()||this._createTerrain($,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new r.x("data",{dataType:"style"}));const Y=this.isRootStyle();o.imports?this._loadImports(o.imports,c).then(()=>{this._reloadImports(),this.fire(new r.x(Y?"style.load":"style.import.load"))}):(this._reloadImports(),this.fire(new r.x(Y?"style.load":"style.import.load")))},T=this.stylesheet["color-theme"];if(this._styleColorTheme.colorTheme=T,T){const A=this._evaluateColorThemeData(T);this._loadColorTheme(A).then(()=>{S()}).catch($=>{r.w(`Couldn't load color theme from the stylesheet: ${$}`),S()})}else this._styleColorTheme.lut=null,S()}isRootStyle(){return this.importDepth===0}mergeAll(){let o,c,y,S,T,A,$,Y;const ee={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(te=>{if(te.stylesheet){if(te.light!=null&&(o=te.light),te.stylesheet.lights)for(const ue of te.stylesheet.lights)ue.type==="ambient"&&te.ambientLight!=null&&(c=te.ambientLight),ue.type==="directional"&&te.directionalLight!=null&&(y=te.directionalLight);S=this._prioritizeTerrain(S,te.terrain,te.stylesheet.terrain),te.stylesheet.fog&&te.fog!=null&&(T=te.fog),te.stylesheet.camera!=null&&(Y=te.stylesheet.camera),te.stylesheet.projection!=null&&(A=te.stylesheet.projection),te.stylesheet.transition!=null&&($=te.stylesheet.transition),ee[te.scope]=te._styleColorTheme}}),this.light=o,this.ambientLight=c,this.directionalLight=y,this.fog=T,this._styleColorThemeForScope=ee,S===null?delete this.terrain:this.terrain=S,this.camera=Y||{"camera-projection":"perspective"},this.projection=A||{name:"mercator"},this.transition=r.l({},pr,$),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(o){const c=y=>{for(const S of y.fragments)c(S.style);o(y)};c(this)}_prioritizeTerrain(o,c,y){const S=o&&o.drapeRenderMode===0;return y===null?c&&c.drapeRenderMode===0?c:S?o:null:c!=null&&(!o||S||c&&c.drapeRenderMode===1)?c:o}mergeTerrain(){let o;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(c=>{o=this._prioritizeTerrain(o,c.terrain,c.stylesheet.terrain)}),o===null?delete this.terrain:this.terrain=o}mergeProjection(){let o;this.forEachFragmentStyle(c=>{c.stylesheet.projection!=null&&(o=c.stylesheet.projection)}),this.projection=o||{name:"mercator"}}mergeSources(){const o={},c={},y={};this.forEachFragmentStyle(S=>{for(const T in S._sourceCaches){const A=r.av(T,S.scope);o[A]=S._sourceCaches[T]}for(const T in S._otherSourceCaches){const A=r.av(T,S.scope);c[A]=S._otherSourceCaches[T]}for(const T in S._symbolSourceCaches){const A=r.av(T,S.scope);y[A]=S._symbolSourceCaches[T]}}),this._mergedSourceCaches=o,this._mergedOtherSourceCaches=c,this._mergedSymbolSourceCaches=y}mergeLayers(){const o={},c=[],y={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(T=>{for(const A of T._order){const $=T._layers[A];if($.type==="slot"){const Y=r.cm(A);if(o[Y])continue;o[Y]=[]}$.slot&&o[$.slot]?o[$.slot].push($):c.push($)}}),this._mergedOrder=[];const S=(T=[])=>{for(const A of T)if(A.type==="slot"){const $=r.cm(A.id);o[$]&&S(o[$]),this._mergedSlots.push($)}else{const $=r.av(A.id,A.scope);this._mergedOrder.push($),y[$]=A,A.is3D()&&(this._has3DLayers=!0),A.type==="circle"&&(this._hasCircleLayers=!0),A.type==="symbol"&&(this._hasSymbolLayers=!0),A.type==="clip"&&(this._clipLayerPresent=!0)}};S(c),this._mergedOrder.sort((T,A)=>{const $=y[T],Y=y[A];return $.hasInitialOcclusionOpacityProperties?Y.is3D()?1:0:$.is3D()&&Y.hasInitialOcclusionOpacityProperties?-1:0}),this._mergedLayers=y,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(o){return this.stylesheet.camera=r.l({},this.stylesheet.camera,o),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(o){return o.data?function(c,y,S){const T=r.l({},y);for(const $ of Object.keys(r._.colorTheme))T[$]===void 0&&(T[$]=r._.colorTheme[$].default);const A=new r.$(Ul,c,new Map(S));return A.setTransitionOrValue(T,S),A.untransitioned().possiblyEvaluate(new r.a3(0))}(this.scope,o,this.options).get("data"):null}_loadColorTheme(o){this._styleColorTheme.lutLoading=!0,this._styleColorTheme.lutLoadingCorrelationID+=1;const c=this._styleColorTheme.lutLoadingCorrelationID;return new Promise((y,S)=>{const T="data:image/png;base64,";if(!o||o.length===0)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void y();let A=o;A.startsWith(T)||(A=T+A);const $="mapbox-reserved-lut",Y=new Image;Y.src=A,Y.onerror=()=>{this._styleColorTheme.lutLoading=!1,S(new Error("Failed to load image data"))},Y.onload=()=>{if(this._styleColorTheme.lutLoadingCorrelationID!==c)return void y();this._styleColorTheme.lutLoading=!1;const{width:ee,height:te,data:ue}=r.q.getImageData(Y);if(te>32)return void S(new Error("The height of the image must be less than or equal to 32 pixels."));if(ee!==te*te)return void S(new Error("The width of the image must be equal to the height squared."));this.getImage($)&&this.removeImage($),this.addImage($,{data:new r.r({width:ee,height:te},ue),pixelRatio:1,sdf:!1,version:0});const fe=this.imageManager.getImage($,this.scope);fe?(this._styleColorTheme.lut={image:fe.data,data:o},y()):S(new Error("Missing LUT image."))}})}getLut(o){const c=this._styleColorThemeForScope[o];return c?c.lut:null}setProjection(o){o?this.stylesheet.projection=o:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(o){this._spriteRequest=function(c,y,S){let T,A,$;const Y=r.q.devicePixelRatio>1?"@2x":"";let ee=r.n(y.transformRequest(y.normalizeSpriteURL(c,Y,".json"),r.R.SpriteJSON),(fe,me)=>{ee=null,$||($=fe,T=me,ue())}),te=r.o(y.transformRequest(y.normalizeSpriteURL(c,Y,".png"),r.R.SpriteImage),(fe,me)=>{te=null,$||($=fe,A=me,ue())});function ue(){if($)S($);else if(T&&A){const fe=r.q.getImageData(A),me={};for(const ke in T){const{width:Le,height:De,x:Fe,y:Ye,sdf:Je,pixelRatio:qe,stretchX:it,stretchY:rt,content:mt}=T[ke],dt=new r.r({width:Le,height:De});r.r.copy(fe,dt,{x:Fe,y:Ye},{x:0,y:0},{width:Le,height:De},null),me[ke]={data:dt,pixelRatio:qe,sdf:Je,stretchX:it,stretchY:rt,content:mt}}S(null,me)}}return{cancel(){ee&&(ee.cancel(),ee=null),te&&(te.cancel(),te=null)}}}(o,this.map._requestManager,(c,y)=>{if(this._spriteRequest=null,c)this.fire(new r.t(c));else if(y)for(const S in y)this.imageManager.addImage(S,this.scope,y[S]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new r.x("data",{dataType:"style"}))})}_validateLayer(o){const c=this.getOwnSource(o.source);if(!c)return;const y=o.sourceLayer;y&&(c.type==="geojson"||c.vectorLayerIds&&c.vectorLayerIds.indexOf(y)===-1)&&this.fire(new r.t(new Error(`Source layer "${y}" does not exist on source "${c.id}" as specified by style layer "${o.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const o in this._sourceCaches)if(!this._sourceCaches[o].loaded())return!1;if(!this.imageManager.isLoaded()||!this.modelManager.isLoaded()||this._styleColorTheme.lutLoading)return!1;for(const{style:o}of this.fragments)if(!o.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((o,c)=>{const y=this.fragments[c];return y&&y.style&&(o.data=y.style.serialize()),o})}_serializeSources(){const o={};for(const c in this._sourceCaches){const y=this._sourceCaches[c].getSource();o[y.id]||(o[y.id]=y.serialize())}return o}_serializeLayers(o){const c=[];for(const y of o){const S=this._layers[y];S&&S.type!=="custom"&&c.push(S.serialize())}return c}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition())return!0;for(const o in this._sourceCaches)if(this._sourceCaches[o].hasTransition())return!0;for(const o in this._layers)if(this._layers[o].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}isLayerDraped(o){return!!this.terrain&&o.isDraped(this.getLayerSourceCache(o))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(o){const c=this.getOwnLayer(o);if(c)return c;this.fire(new r.t(new Error(`The layer '${o}' does not exist in the map's style.`)))}_checkSource(o){const c=this.getOwnSource(o);if(c)return c;this.fire(new r.t(new Error(`The source '${o}' does not exist in the map's style.`)))}precompilePrograms(o,c){const y=this.map.painter;if(y)for(let S=o.minzoom||0;S<(o.maxzoom||25.5);S++){const T=o.getProgramIds();if(T)for(const A of T){const $=o.getDefaultProgramParams(A,c.zoom,this._styleColorTheme.lut);$&&(y.style=this,this.fog&&(y._fogVisible=!0,$.overrideFog=!0,y.getOrCreateProgram(A,$)),y._fogVisible=!1,$.overrideFog=!1,y.getOrCreateProgram(A,$),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&($.overrideRtt=!0,y.getOrCreateProgram(A,$)))}}}update(o){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(o),this.directionalLight&&this.directionalLight.recalculate(o);const c=this.calculateLightsBrightness();o.brightness=c||0,c!==this._brightness&&(this._brightness=c,this.dispatcher.broadcast("setBrightness",c));const y=this._changes.isDirty();let S=!1;if(this._changes.isDirty()){const A=this._changes.getLayerUpdatesByScope();for(const $ in A){const{updatedIds:Y,removedIds:ee}=A[$];(Y||ee)&&(this._updateWorkerLayers($,Y,ee),S=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(o),this.light&&this.light.updateTransitions(o),this.ambientLight&&this.ambientLight.updateTransitions(o),this.directionalLight&&this.directionalLight.updateTransitions(o),this.fog&&this.fog.updateTransitions(o),this._changes.reset()}const T={};for(const A in this._mergedSourceCaches){const $=this._mergedSourceCaches[A];T[A]=$.used,$.used=!1,$.tileCoverLift=0}for(const A of this._mergedOrder){const $=this._mergedLayers[A];if($.recalculate(o,this._availableImages),!$.isHidden(o.zoom)){const Y=this.getLayerSourceCache($);Y&&(Y.used=!0,Y.tileCoverLift=Math.max(Y.tileCoverLift,$.tileCoverLift()))}!this._precompileDone&&this._shouldPrecompile&&("requestIdleCallback"in window?requestIdleCallback(()=>{this.precompilePrograms($,o)}):this.precompilePrograms($,o))}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&S&&this.mergeLayers();for(const A in T){const $=this._mergedSourceCaches[A];T[A]!==$.used&&$.getSource().fire(new r.x("data",{sourceDataType:"visibility",dataType:"source",sourceId:$.getSource().id}))}this.light&&this.light.recalculate(o),this.terrain&&this.terrain.recalculate(o),this.fog&&this.fog.recalculate(o),this.z=o.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),y&&this.fire(new r.x("data",{dataType:"style"}))}_updateTilesForChangedImages(){const o=this._changes.getUpdatedImages();if(o.length){for(const c in this._sourceCaches)this._sourceCaches[c].reloadTilesForDependencies(["icons","patterns"],o);this._changes.resetUpdatedImages()}}_updateWorkerLayers(o,c,y){const S=this.getFragmentStyle(o);S&&this.dispatcher.broadcast("updateLayers",{layers:c?S._serializeLayers(c):[],scope:o,removedIds:y||[],options:S.options})}setState(o,c){if(this._checkLoaded(),Xs(this,mi(o)))return!1;(o=r.cl(o)).layers=hr(o.layers);const y=function(A,$){if(!A)return[{command:Ln.setStyle,args:[$]}];let Y=[];try{if(!r.bh(A.version,$.version))return[{command:Ln.setStyle,args:[$]}];if(r.bh(A.center,$.center)||Y.push({command:Ln.setCenter,args:[$.center]}),r.bh(A.zoom,$.zoom)||Y.push({command:Ln.setZoom,args:[$.zoom]}),r.bh(A.bearing,$.bearing)||Y.push({command:Ln.setBearing,args:[$.bearing]}),r.bh(A.pitch,$.pitch)||Y.push({command:Ln.setPitch,args:[$.pitch]}),r.bh(A.sprite,$.sprite)||Y.push({command:Ln.setSprite,args:[$.sprite]}),r.bh(A.glyphs,$.glyphs)||Y.push({command:Ln.setGlyphs,args:[$.glyphs]}),r.bh(A.imports,$.imports)||function(me=[],ke=[],Le){ke=ke||[];const De=(me=me||[]).map(kr),Fe=ke.map(kr),Ye=me.reduce(Ri,{}),Je=ke.reduce(Ri,{}),qe=De.slice();let it,rt,mt,dt;for(it=0,rt=0;it<De.length;it++)mt=De[it],Je.hasOwnProperty(mt)?rt++:(Le.push({command:Ln.removeImport,args:[mt]}),qe.splice(qe.indexOf(mt,rt),1));for(it=0,rt=0;it<Fe.length;it++)mt=Fe[Fe.length-1-it],qe[qe.length-1-it]!==mt&&(Ye.hasOwnProperty(mt)?(Le.push({command:Ln.removeImport,args:[mt]}),qe.splice(qe.lastIndexOf(mt,qe.length-rt),1)):rt++,dt=qe[qe.length-it],Le.push({command:Ln.addImport,args:[Je[mt],dt]}),qe.splice(qe.length-it,0,mt));for(const yt of ke){const Et=Ye[yt.id];Et&&!r.bh(Et,yt)&&Le.push({command:Ln.updateImport,args:[yt.id,yt]})}}(A.imports,$.imports,Y),r.bh(A.transition,$.transition)||Y.push({command:Ln.setTransition,args:[$.transition]}),r.bh(A.light,$.light)||Y.push({command:Ln.setLight,args:[$.light]}),r.bh(A.fog,$.fog)||Y.push({command:Ln.setFog,args:[$.fog]}),r.bh(A.projection,$.projection)||Y.push({command:Ln.setProjection,args:[$.projection]}),r.bh(A.lights,$.lights)||Y.push({command:Ln.setLights,args:[$.lights]}),r.bh(A.camera,$.camera)||Y.push({command:Ln.setCamera,args:[$.camera]}),!r.bh(A["color-theme"],$["color-theme"]))return[{command:Ln.setStyle,args:[$]}];const ee={},te=[];(function(me,ke,Le,De){let Fe;for(Fe in ke=ke||{},me=me||{})me.hasOwnProperty(Fe)&&(ke.hasOwnProperty(Fe)||Tr(Fe,Le,De));for(Fe in ke){if(!ke.hasOwnProperty(Fe))continue;const Ye=ke[Fe];me.hasOwnProperty(Fe)?r.bh(me[Fe],Ye)||(me[Fe].type==="geojson"&&Ye.type==="geojson"&&sr(me,ke,Fe)?Le.push({command:Ln.setGeoJSONSourceData,args:[Fe,Ye.data]}):Kr(Fe,ke,Le,De)):ii(Fe,ke,Le)}})(A.sources,$.sources,te,ee);const ue=[];A.layers&&A.layers.forEach(me=>{me.source&&ee[me.source]?Y.push({command:Ln.removeLayer,args:[me.id]}):ue.push(me)});let fe=A.terrain;fe&&ee[fe.source]&&(Y.push({command:Ln.setTerrain,args:[void 0]}),fe=void 0),Y=Y.concat(te),r.bh(fe,$.terrain)||Y.push({command:Ln.setTerrain,args:[$.terrain]}),function(me,ke,Le){ke=ke||[];const De=(me=me||[]).map(kr),Fe=ke.map(kr),Ye=me.reduce(Ri,{}),Je=ke.reduce(Ri,{}),qe=De.slice(),it=Object.create(null);let rt,mt,dt,yt,Et,bt,vt;for(rt=0,mt=0;rt<De.length;rt++)dt=De[rt],Je.hasOwnProperty(dt)?mt++:(Le.push({command:Ln.removeLayer,args:[dt]}),qe.splice(qe.indexOf(dt,mt),1));for(rt=0,mt=0;rt<Fe.length;rt++)dt=Fe[Fe.length-1-rt],qe[qe.length-1-rt]!==dt&&(Ye.hasOwnProperty(dt)?(Le.push({command:Ln.removeLayer,args:[dt]}),qe.splice(qe.lastIndexOf(dt,qe.length-mt),1)):mt++,bt=qe[qe.length-rt],Le.push({command:Ln.addLayer,args:[Je[dt],bt]}),qe.splice(qe.length-rt,0,dt),it[dt]=!0);for(rt=0;rt<Fe.length;rt++)if(dt=Fe[rt],yt=Ye[dt],Et=Je[dt],!it[dt]&&!r.bh(yt,Et))if(r.bh(yt.source,Et.source)&&r.bh(yt["source-layer"],Et["source-layer"])&&r.bh(yt.type,Et.type)){for(vt in jn(yt.layout,Et.layout,Le,dt,null,Ln.setLayoutProperty),jn(yt.paint,Et.paint,Le,dt,null,Ln.setPaintProperty),r.bh(yt.slot,Et.slot)||Le.push({command:Ln.setSlot,args:[dt,Et.slot]}),r.bh(yt.filter,Et.filter)||Le.push({command:Ln.setFilter,args:[dt,Et.filter]}),r.bh(yt.minzoom,Et.minzoom)&&r.bh(yt.maxzoom,Et.maxzoom)||Le.push({command:Ln.setLayerZoomRange,args:[dt,Et.minzoom,Et.maxzoom]}),yt)yt.hasOwnProperty(vt)&&vt!=="layout"&&vt!=="paint"&&vt!=="filter"&&vt!=="metadata"&&vt!=="minzoom"&&vt!=="maxzoom"&&vt!=="slot"&&(vt.indexOf("paint.")===0?jn(yt[vt],Et[vt],Le,dt,vt.slice(6),Ln.setPaintProperty):r.bh(yt[vt],Et[vt])||Le.push({command:Ln.setLayerProperty,args:[dt,vt,Et[vt]]}));for(vt in Et)Et.hasOwnProperty(vt)&&!yt.hasOwnProperty(vt)&&vt!=="layout"&&vt!=="paint"&&vt!=="filter"&&vt!=="metadata"&&vt!=="minzoom"&&vt!=="maxzoom"&&vt!=="slot"&&(vt.indexOf("paint.")===0?jn(yt[vt],Et[vt],Le,dt,vt.slice(6),Ln.setPaintProperty):r.bh(yt[vt],Et[vt])||Le.push({command:Ln.setLayerProperty,args:[dt,vt,Et[vt]]}))}else Le.push({command:Ln.removeLayer,args:[dt]}),bt=qe[qe.lastIndexOf(dt)+1],Le.push({command:Ln.addLayer,args:[Et,bt]})}(ue,$.layers,Y)}catch(ee){console.warn("Unable to compute style diff:",ee),Y=[{command:Ln.setStyle,args:[$]}]}return Y}(this.serialize(),o).filter(A=>!(A.command in rn));if(y.length===0)return!1;const S=y.filter(A=>!(A.command in fd));if(S.length>0)throw new Error(`Unimplemented: ${S.map(A=>A.command).join(", ")}.`);const T=[];return y.forEach(A=>{T.push(this[A.command].apply(this,A.args))}),c&&Promise.all(T).then(c),this.stylesheet=o,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}addImage(o,c){return this.getImage(o)?this.fire(new r.t(new Error("An image with this name already exists."))):(this.imageManager.addImage(o,this.scope,c),this._afterImageUpdated(o),this)}updateImage(o,c){this.imageManager.updateImage(o,this.scope,c)}getImage(o){return this.imageManager.getImage(o,this.scope)}removeImage(o){return this.getImage(o)?(this.imageManager.removeImage(o,this.scope),this._afterImageUpdated(o),this):this.fire(new r.t(new Error("No image with this name exists.")))}_afterImageUpdated(o){this._availableImages=this.imageManager.listImages(this.scope),this._changes.updateImage(o),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.fire(new r.x("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(o,c,y={}){return this._checkLoaded(),this._validate(_t,`models.${o}`,c,null,y)||(this.modelManager.addModel(o,c,this.scope),this._changes.setDirty()),this}hasModel(o){return this.modelManager.hasModel(o,this.scope)}removeModel(o){return this.hasModel(o)?(this.modelManager.removeModel(o,this.scope),this):this.fire(new r.t(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(o,c,y={}){if(this._checkLoaded(),this.getOwnSource(o)!==void 0)throw new Error(`There is already a source with ID "${o}".`);if(!c.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(c).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(c.type)>=0&&this._validate(ji,`sources.${o}`,c,null,y))return;this.map&&this.map._collectResourceTiming&&(c.collectResourceTiming=!0);const S=Rs(o,c,this.dispatcher,this);S.scope=this.scope,S.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(S.id),source:S.serialize(),sourceId:S.id}));const T=A=>{const $=(A?"symbol:":"other:")+S.id,Y=r.av($,this.scope),ee=this._sourceCaches[$]=new jt(Y,S,A);(A?this._symbolSourceCaches:this._otherSourceCaches)[S.id]=ee,ee.onAdd(this.map)};T(!1),c.type!=="vector"&&c.type!=="geojson"||T(!0),S.onAdd&&S.onAdd(this.map),y.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(o){this._checkLoaded();const c=this.getOwnSource(o);if(!c)throw new Error("There is no source with this ID");for(const S in this._layers)if(this._layers[S].source===o)return this.fire(new r.t(new Error(`Source "${o}" cannot be removed while layer "${S}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===o)return this.fire(new r.t(new Error(`Source "${o}" cannot be removed while terrain is using it.`)));const y=this.getOwnSourceCaches(o);for(const S of y){const T=r.cm(S.id);delete this._sourceCaches[T],this._changes.discardSourceCacheUpdate(S.id),S.fire(new r.x("data",{sourceDataType:"metadata",dataType:"source",sourceId:S.getSource().id})),S.setEventedParent(null),S.clearTiles()}return delete this._otherSourceCaches[o],delete this._symbolSourceCaches[o],this.mergeSources(),c.setEventedParent(null),c.onRemove&&c.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(o,c){this._checkLoaded(),this.getOwnSource(o).setData(c),this._changes.setDirty()}getOwnSource(o){const c=this.getOwnSourceCache(o);return c&&c.getSource()}getOwnSources(){const o=[];for(const c in this._otherSourceCaches){const y=this.getOwnSourceCache(c);y&&o.push(y.getSource())}return o}areTilesLoaded(){const o=this._mergedSourceCaches;for(const c in o){const y=o[c]._tiles;for(const S in y){const T=y[S];if(T.state!=="loaded"&&T.state!=="errored")return!1}}return!0}setLights(o){if(this._checkLoaded(),!o)return delete this.ambientLight,void delete this.directionalLight;const c=this._getTransitionParameters();for(const S of o){if(this._validate(qo,"lights",S))return;switch(S.type){case"ambient":if(this.ambientLight){const T=this.ambientLight;T.set(S),T.updateTransitions(c)}else this.ambientLight=new Or(S,Fr||(Fr=new r.a0({color:new r.a1(r._.properties_light_ambient.color),intensity:new r.a1(r._.properties_light_ambient.intensity)})),this.scope,this.options);break;case"directional":if(this.directionalLight){const T=this.directionalLight;T.set(S),T.updateTransitions(c)}else this.directionalLight=new Or(S,bi||(bi=new r.a0({direction:new r.ad(r._.properties_light_directional.direction),color:new r.a1(r._.properties_light_directional.color),intensity:new r.a1(r._.properties_light_directional.intensity),"cast-shadows":new r.a1(r._.properties_light_directional["cast-shadows"]),"shadow-intensity":new r.a1(r._.properties_light_directional["shadow-intensity"])})),this.scope,this.options)}}const y=new r.a3(this.z||0,c);this.ambientLight&&this.ambientLight.recalculate(y),this.directionalLight&&this.directionalLight.recalculate(y),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const o=this.directionalLight,c=this.ambientLight;if(!o||!c)return;const y=ue=>.2126*(ue[0]<=.03928?ue[0]/12.92:Math.pow((ue[0]+.055)/1.055,2.4))+.7152*(ue[1]<=.03928?ue[1]/12.92:Math.pow((ue[1]+.055)/1.055,2.4))+.0722*(ue[2]<=.03928?ue[2]/12.92:Math.pow((ue[2]+.055)/1.055,2.4)),S=o.properties.get("color").toRenderColor(null).toArray01(),T=o.properties.get("intensity"),A=o.properties.get("direction"),$=1-r.c7(A.x,A.y,A.z)[2]/90,Y=y(S)*T*$,ee=c.properties.get("color").toRenderColor(null).toArray01(),te=c.properties.get("intensity");return(Y+y(ee)*te)/2}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const o=[];return this.directionalLight&&o.push(this.directionalLight.get()),this.ambientLight&&o.push(this.ambientLight.get()),o}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(o){if(!o)return this;if(r.cn(o)){const c=r.co(o),y=this.fragments.find(({id:T})=>T===c);if(!y)throw new Error(`Style import not found: ${o}`);const S=r.cm(o);return y.style.getFragmentStyle(S)}{const c=this.fragments.find(({id:y})=>y===o);if(!c)throw new Error(`Style import not found: ${o}`);return c.style}}getConfigProperty(o,c){const y=this.getFragmentStyle(o);if(!y)return null;const S=r.av(c,y.scope),T=y.options.get(S),A=T?T.value||T.default:null;return A?A.serialize():null}setConfigProperty(o,c,y){const S=this.getFragmentStyle(o);if(!S)return;const T=S.stylesheet.schema;if(!T||!T[c])return;const A=r.M(y);if(A.result!=="success")return void Xs(this,A.value);const $=A.value.expression,Y=r.av(c,S.scope),ee=S.options.get(Y);if(!ee)return;let te;const{minValue:ue,maxValue:fe,stepValue:me,type:ke,values:Le}=T[c],De=r.M(T[c].default);De.result==="success"&&(te=De.value.expression),te?(this.options.set(Y,{...ee,value:$,default:te,minValue:ue,maxValue:fe,stepValue:me,type:ke,values:Le}),this.updateConfigDependencies(c)):this.fire(new r.t(new Error(`No schema defined for the config option "${c}" in the "${o}" fragment.`)))}getConfig(o){const c=this.getFragmentStyle(o);if(!c)return null;const y=c.stylesheet.schema;if(!y)return null;const S={};for(const T in y){const A=r.av(T,c.scope),$=c.options.get(A),Y=$?$.value||$.default:null;S[T]=Y?Y.serialize():null}return S}setConfig(o,c){const y=this.getFragmentStyle(o);y&&(y.updateConfig(c,y.stylesheet.schema),this.updateConfigDependencies())}getSchema(o){const c=this.getFragmentStyle(o);return c?c.stylesheet.schema:null}setSchema(o,c){const y=this.getFragmentStyle(o);y&&(y.stylesheet.schema=c,y.updateConfig(y._config,c),this.updateConfigDependencies())}updateConfig(o,c){if(this._config=o,o||c)if(c)for(const y in c){let S,T;const A=r.M(c[y].default);if(A.result==="success"&&(S=A.value.expression),o&&o[y]!==void 0){const fe=r.M(o[y]);fe.result==="success"&&(T=fe.value.expression)}const{minValue:$,maxValue:Y,stepValue:ee,type:te,values:ue}=c[y];if(S){const fe=r.av(y,this.scope);this.options.set(fe,{default:S,value:T,minValue:$,maxValue:Y,stepValue:ee,type:te,values:ue})}else this.fire(new r.t(new Error(`No schema defined for config option "${y}".`)))}else this.fire(new r.t(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(o){for(const c of this._configDependentLayers){const y=this.getLayer(c);if(y){if(o&&!y.configDependencies.has(o))continue;y.possiblyEvaluateVisibility(),this._updateLayer(y)}}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.forEachFragmentStyle(c=>{if(c._styleColorTheme.colorTheme){const y=c._evaluateColorThemeData(c._styleColorTheme.colorTheme);(!c._styleColorTheme.lut&&y!==""||c._styleColorTheme.lut&&y!==c._styleColorTheme.lut.data)&&c.setColorTheme(c._styleColorTheme.colorTheme)}}),this._changes.setDirty()}addLayer(o,c,y={}){this._checkLoaded();const S=o.id;if(this._layers[S])return void this.fire(new r.t(new Error(`Layer with id "${S}" already exists on this map`)));let T;if(o.type==="custom"){if(Xs(this,r.cp(o)))return;T=r.cq(o,this.scope,this._styleColorTheme.lut,this.options)}else{if(typeof o.source=="object"&&(this.addSource(S,o.source),o=r.cl(o),o=r.l(o,{source:S})),this._validate(Vt,`layers.${S}`,o,{arrayIndex:-1},y))return;T=r.cq(o,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(T),T.setEventedParent(this,{layer:{id:S}}),this._serializedLayers[T.id]=T.serialize()}T.configDependencies.size!==0&&this._configDependentLayers.add(T.fqid);let A=this._order.length;if(c){const te=this._order.indexOf(c);if(te===-1)return void this.fire(new r.t(new Error(`Layer with id "${c}" does not exist on this map.`)));T.slot===this._layers[c].slot?A=te:r.w(`Layer with id "${c}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(A,0,S),this._layerOrderChanged=!0,this._layers[S]=T;const $=this.getOwnLayerSourceCache(T),Y=!!this.directionalLight&&this.directionalLight.shadowsEnabled();$&&T.canCastShadows()&&Y&&($.castsShadows=!0);const ee=this._changes.getRemovedLayer(T);if(ee&&T.source&&$&&T.type!=="custom"){this._changes.discardLayerRemoval(T);const te=r.av(T.source,T.scope);ee.type!==T.type?this._changes.updateSourceCache(te,"clear"):(this._changes.updateSourceCache(te,"reload"),$.pause())}this._updateLayer(T),T.onAdd&&T.onAdd(this.map),T.scope=this.scope,this.mergeLayers()}moveLayer(o,c){this._checkLoaded();const y=this._checkLayer(o);if(!y||o===c)return;const S=this._order.indexOf(o);this._order.splice(S,1);let T=this._order.length;if(c){const A=this._order.indexOf(c);if(A===-1)return void this.fire(new r.t(new Error(`Layer with id "${c}" does not exist on this map.`)));y.slot===this._layers[c].slot?T=A:r.w(`Layer with id "${c}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(T,0,o),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(o){this._checkLoaded();const c=this._checkLayer(o);if(!c)return;c.setEventedParent(null);const y=this._order.indexOf(o);this._order.splice(y,1),delete this._layers[o],delete this._serializedLayers[o],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(c.fqid),this._changes.removeLayer(c);const S=this.getOwnLayerSourceCache(c);if(S&&S.castsShadows){let T=!1;for(const A in this._layers)if(this._layers[A].source===c.source&&this._layers[A].canCastShadows()){T=!0;break}S.castsShadows=T}c.onRemove&&c.onRemove(this.map),this.mergeLayers()}getOwnLayer(o){return this._layers[o]}hasLayer(o){return o in this._mergedLayers}hasLayerType(o){for(const c in this._layers)if(this._layers[c].type===o)return!0;return!1}setLayerZoomRange(o,c,y){this._checkLoaded();const S=this._checkLayer(o);S&&(S.minzoom===c&&S.maxzoom===y||(c!=null&&(S.minzoom=c),y!=null&&(S.maxzoom=y),this._updateLayer(S)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(o,c){this._checkLoaded();const y=this._checkLayer(o);y&&y.slot!==c&&(y.slot=c,this._updateLayer(y))}setFilter(o,c,y={}){this._checkLoaded();const S=this._checkLayer(o);if(S&&!r.bh(S.filter,c))return c==null?(S.filter=void 0,void this._updateLayer(S)):void(this._validate(ze,`layers.${S.id}.filter`,c,{layerType:S.type},y)||(S.filter=r.cl(c),this._updateLayer(S)))}getFilter(o){const c=this._checkLayer(o);if(c)return r.cl(c.filter)}setLayoutProperty(o,c,y,S={}){this._checkLoaded();const T=this._checkLayer(o);if(T&&!r.bh(T.getLayoutProperty(c),y)){if(y!=null&&(!S||S.validate!==!1)&&Xs(T,at.call(mi,{key:`layers.${o}.layout.${c}`,layerType:T.type,objectKey:c,value:y,styleSpec:r._,style:{glyphs:!0,sprite:!0}})))return;T.setLayoutProperty(c,y),T.configDependencies.size!==0&&this._configDependentLayers.add(T.fqid),this._updateLayer(T)}}getLayoutProperty(o,c){const y=this._checkLayer(o);if(y)return y.getLayoutProperty(c)}setPaintProperty(o,c,y,S={}){this._checkLoaded();const T=this._checkLayer(o);if(!T||r.bh(T.getPaintProperty(c),y)||y!=null&&(!S||S.validate!==!1)&&Xs(T,Ve.call(mi,{key:`layers.${o}.paint.${c}`,layerType:T.type,objectKey:c,value:y,styleSpec:r._})))return;const A=T.setPaintProperty(c,y);T.configDependencies.size!==0&&this._configDependentLayers.add(T.fqid),A&&this._updateLayer(T),this._changes.updatePaintProperties(T)}getPaintProperty(o,c){const y=this._checkLayer(o);if(y)return y.getPaintProperty(c)}setFeatureState(o,c){this._checkLoaded();const y=o.source,S=o.sourceLayer,T=this._checkSource(y);if(!T)return;const A=T.type;if(A==="geojson"&&S)return void this.fire(new r.t(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(A==="vector"&&!S)return void this.fire(new r.t(new Error("The sourceLayer parameter must be provided for vector source types.")));o.id===void 0&&this.fire(new r.t(new Error("The feature id parameter must be provided.")));const $=this.getOwnSourceCaches(y);for(const Y of $)Y.setFeatureState(S,o.id,c)}removeFeatureState(o,c){this._checkLoaded();const y=o.source,S=this._checkSource(y);if(!S)return;const T=S.type,A=T==="vector"?o.sourceLayer:void 0;if(T==="vector"&&!A)return void this.fire(new r.t(new Error("The sourceLayer parameter must be provided for vector source types.")));if(c&&typeof o.id!="string"&&typeof o.id!="number")return void this.fire(new r.t(new Error("A feature id is required to remove its specific state property.")));const $=this.getOwnSourceCaches(y);for(const Y of $)Y.removeFeatureState(A,o.id,c)}getFeatureState(o){this._checkLoaded();const c=o.source,y=o.sourceLayer,S=this._checkSource(c);if(S){if(S.type!=="vector"||y)return o.id===void 0&&this.fire(new r.t(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(c)[0].getFeatureState(y,o.id);this.fire(new r.t(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(o){return this.stylesheet.transition=r.l({},this.stylesheet.transition,o),this.transition=this.stylesheet.transition,this}getTransition(){return r.l({},this.stylesheet.transition)}serialize(){this._checkLoaded();const o=this.getTerrain(),c=o&&this.terrain&&this.terrain.scope===this.scope?o:this.stylesheet.terrain;return r.cr({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:c,fog:this.stylesheet.fog,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},y=>y!==void 0)}_updateLayer(o){this._changes.updateLayer(o);const c=this.getLayerSourceCache(o),y=r.av(o.source,o.scope),S=this._changes.getUpdatedSourceCaches();o.source&&!S[y]&&c&&c.getSource().type!=="raster"&&(this._changes.updateSourceCache(y,"reload"),c.pause()),o.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(o){const c=$=>this._mergedLayers[$].is3D(),y=this.order,S={},T=[];for(let $=y.length-1;$>=0;$--){const Y=y[$];if(c(Y)){S[Y]=$;for(const ee of o){const te=ee[Y];if(te)for(const ue of te)T.push(ue)}}}T.sort(($,Y)=>Y.intersectionZ-$.intersectionZ);const A=[];for(let $=y.length-1;$>=0;$--){const Y=y[$];if(c(Y))for(let ee=T.length-1;ee>=0;ee--){const te=T[ee].feature;if(te.layer&&S[te.layer.id]<$)break;A.push(te),T.pop()}else for(const ee of o){const te=ee[Y];if(te)for(const ue of te)A.push(ue.feature)}}return A}queryRenderedFeatures(o,c,y){c&&c.filter&&this._validate(ze,"queryRenderedFeatures.filter",c.filter,null,c),c.scope=this.scope,c.availableImages=this._availableImages,c.serializedLayers=this._serializedLayers;const S={};if(c&&c.layers){if(!Array.isArray(c.layers))return this.fire(new r.t(new Error("parameters.layers must be an Array."))),[];for(const ee of c.layers){const te=this._mergedLayers[ee];if(!te)return this.fire(new r.t(new Error(`The layer '${ee}' does not exist in the map's style and cannot be queried for features.`))),[];S[te.source]=!0}}const T=[],A=c.serializedLayers||{},$=c&&c.layers?c.layers.some(ee=>{const te=this.getLayer(ee);return te&&te.is3D()}):this.has3DLayers(),Y=Mi.createFromScreenPoints(o,y);for(const ee in this._mergedSourceCaches){const te=this._mergedSourceCaches[ee].getSource();if(!te||te.scope!==c.scope)continue;const ue=this._mergedSourceCaches[ee].getSource().id;c.layers&&!S[ue]||T.push(Qd(this._mergedSourceCaches[ee],this._mergedLayers,A,Y,c,y,$,!!this.map._showQueryGeometry))}return this.placement&&T.push(function(ee,te,ue,fe,me,ke,Le){const De={},Fe=ke.queryRenderedSymbols(fe),Ye=[];for(const Je of Object.keys(Fe).map(Number))Ye.push(Le[Je]);Ye.sort(lu);for(const Je of Ye){const qe=Je.featureIndex.lookupSymbolFeatures(Fe[Je.bucketInstanceId],te,Je.bucketIndex,Je.sourceLayerIndex,me.filter,me.layers,me.availableImages,ee);for(const it in qe){const rt=De[it]=De[it]||[],mt=qe[it];mt.sort((dt,yt)=>{const Et=Je.featureSortOrder;if(Et){const bt=Et.indexOf(dt.featureIndex);return Et.indexOf(yt.featureIndex)-bt}return yt.featureIndex-dt.featureIndex});for(const dt of mt)rt.push(dt)}}for(const Je in De)De[Je].forEach(qe=>{const it=qe.feature,rt=ue(ee[Je]);if(!rt)return;const mt=rt.getFeatureState(it.layer["source-layer"],it.id);it.source=it.layer.source,it.layer["source-layer"]&&(it.sourceLayer=it.layer["source-layer"]),it.state=mt});return De}(this._mergedLayers,A,this.getLayerSourceCache.bind(this),Y.screenGeometry,c,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(T)}querySourceFeatures(o,c){c&&c.filter&&this._validate(ze,"querySourceFeatures.filter",c.filter,null,c);const y=this.getOwnSourceCaches(o);let S=[];for(const T of y)S=S.concat(Cc(T,c));return S}addSourceType(o,c,y){return Pr.getSourceType(o)?y(new Error(`A source type called "${o}" already exists.`)):(Pr.setSourceType(o,c),c.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:o,url:c.workerSourceURL},y):y(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(o,c,y={}){this._checkLoaded();const S=this.light.getLight();let T=!1;for(const $ in o)if(!r.bh(o[$],S[$])){T=!0;break}if(!T)return;const A=this._getTransitionParameters();this.light.setLight(o,c,y),this.light.updateTransitions(A)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=r.q.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&r.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(o,c=1){if(this._checkLoaded(),!o)return this.terrainSetForDrapingOnly()||(delete this.terrain,this.map.transform.projection.requiresDraping&&this.setTerrainForDraping()),c===0&&delete this.terrain,o===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let y=o;const S=o.source==null;if(c===1){if(this.disableElevatedTerrain)return;if(typeof y.source=="object"){const $="terrain-dem-src";this.addSource($,y.source),y=r.cl(y),y=r.l(y,{source:$})}const T=r.l({},y),A={};if(this.terrain&&S){T.source=this.terrain.get().source;const $=this.terrain?this.getFragmentStyle(this.terrain.scope):null;$&&(A.style=$.serialize())}if(this._validate(Oo,"terrain",T,A))return}if(!this.terrain||this.terrain.scope!==this.scope&&!S||this.terrain&&c!==this.terrain.drapeRenderMode){if(!y)return;this._createTerrain(y,c),this.fire(new r.x("data",{dataType:"style"}))}else{const T=this.terrain,A=T.get();for(const $ of Object.keys(r._.terrain))!y.hasOwnProperty($)&&r._.terrain[$].default&&(y[$]=r._.terrain[$].default);for(const $ in o)if(!r.bh(o[$],A[$])){T.set(o,this.options),this.stylesheet.terrain=o;const Y=this._getTransitionParameters({duration:0});T.updateTransitions(Y),this.fire(new r.x("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(o){const c=this.fog=new Cr(o,this.map.transform,this.scope,this.options);this.stylesheet.fog=c.get();const y=this._getTransitionParameters({duration:0});c.updateTransitions(y)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const o of this.map._markers)o._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(o){if(this._checkLoaded(),!o)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const c=this.fog;if(!r.bh(c.get(),o)){c.set(o,this.options),this.stylesheet.fog=c.get();const y=this._getTransitionParameters({duration:0});c.updateTransitions(y)}}else this._createFog(o);this._markersNeedUpdate=!0}setColorTheme(o){this._checkLoaded();const c=()=>{for(const S in this._layers)this._layers[S].lut=this._styleColorTheme.lut;for(const S in this._sourceCaches)this._sourceCaches[S].clearTiles()};if(this._styleColorTheme.colorTheme=o,!o)return this._styleColorTheme.lut=null,void c();const y=this._evaluateColorThemeData(o);this._loadColorTheme(y).then(()=>{this.fire(new r.x("colorthemeset")),c()}).catch(S=>{r.w(`Couldn't set color theme: ${S}`)})}_getTransitionParameters(o){return{now:r.q.now(),transition:r.l(this.transition,o)}}updateDrapeFirstLayers(){if(!this.terrain)return;const o=[],c=[];for(const y of this._mergedOrder)this.isLayerDraped(this._mergedLayers[y])?o.push(y):c.push(y);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...o),this._drapedFirstOrder.push(...c)}_createTerrain(o,c){const y=this.terrain=new Zt(o,c,this.scope,this.options);c===1&&(this.stylesheet.terrain=o),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const S=this._getTransitionParameters({duration:0});y.updateTransitions(S)}_force3DLayerUpdate(){for(const o in this._layers){const c=this._layers[o];c.type==="fill-extrusion"&&this._updateLayer(c)}}_forceSymbolLayerUpdate(){for(const o in this._layers){const c=this._layers[o];c.type==="symbol"&&this._updateLayer(c)}}_validate(o,c,y,S,T={}){if(T&&T.validate===!1)return!1;const A=r.l({},this.serialize());return Xs(this,o.call(mi,r.l({key:c,style:A,value:y,styleSpec:r._},S)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),r.cs.off("pluginStateChange",this._rtlTextPluginCallback);for(const o in this._mergedLayers)this._mergedLayers[o].setEventedParent(null);for(const o in this._mergedSourceCaches)this._mergedSourceCaches[o].clearTiles(),this._mergedSourceCaches[o].setEventedParent(null);this.setEventedParent(null),delete this.fog,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.dispatcher.remove())}clearSource(o){const c=this.getSourceCaches(o);for(const y of c)y.clearTiles()}clearSources(){for(const o in this._mergedSourceCaches)this._mergedSourceCaches[o].clearTiles()}reloadSource(o){const c=this.getSourceCaches(o);for(const y of c)y.resume(),y.reload()}reloadSources(){for(const o of this.getSources())o.reload&&o.reload()}updateSources(o){let c;this.directionalLight&&(c=Nu(this.directionalLight));for(const y in this._mergedSourceCaches)this._mergedSourceCaches[y].update(o,void 0,void 0,c)}_generateCollisionBoxes(){for(const o in this._sourceCaches){const c=this._sourceCaches[o];c.resume(),c.reload()}}_updatePlacement(o,c,y,S,T,A,$=!1){let Y=!1,ee=!1;const te={},ue={};for(const fe of this._mergedOrder){const me=this._mergedLayers[fe];if(me.type!=="symbol")continue;const ke=r.av(me.source,me.scope);let Le=te[ke];if(!Le){const Fe=this.getLayerSourceCache(me);if(!Fe)continue;const Ye=Fe.getRenderableIds(!0).map(Je=>Fe.getTileByID(Je));ue[ke]=Ye.slice(),Le=te[ke]=Ye.sort((Je,qe)=>qe.tileID.overscaledZ-Je.tileID.overscaledZ||(Je.tileID.isLessThan(qe.tileID)?-1:1))}const De=this.crossTileSymbolIndex.addLayer(me,Le,c.center.lng,c.projection);Y=Y||De}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),$=$||this._layerOrderChanged||S===0,this._layerOrderChanged&&this.fire(new r.x("neworder")),($||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(r.q.now(),c.zoom))&&(this.pauseablePlacement=new qs(c,this._mergedOrder,$,y,S,T,this.placement,this.fog&&c.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,te,ue),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(r.q.now()),ee=!0),Y&&this.pauseablePlacement.placement.setStale()),ee||Y){this._buildingIndex.onNewFrame(c.zoom);for(let fe=0;fe<this._mergedOrder.length;fe++){const me=this._mergedLayers[this._mergedOrder[fe]];if(me.type!=="symbol")continue;const ke=this.isLayerClipped(me);this.placement.updateLayerOpacities(me,te[r.av(me.source,me.scope)],fe,ke?A:null)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(r.q.now())}}_releaseSymbolFadeTiles(){for(const o in this._sourceCaches)this._sourceCaches[o].releaseSymbolFadeTiles()}addImport(o,c){this._checkLoaded();const y=this.stylesheet.imports=this.stylesheet.imports||[];if(y.findIndex(({id:T})=>T===o.id)!==-1)return void this.fire(new r.t(new Error(`Import with id '${o.id}' already exists in the map's style.`)));if(!c)return y.push(o),this._loadImports([o],!0);const S=y.findIndex(({id:T})=>T===c);return S===-1&&this.fire(new r.t(new Error(`Import with id "${c}" does not exist on this map.`))),this.stylesheet.imports=y.slice(0,S).concat(o).concat(y.slice(S)),this._loadImports([o],!0,c)}updateImport(o,c){this._checkLoaded();const y=this.stylesheet.imports||[],S=this.getImportIndex(o);return S===-1?this:typeof c=="string"?(this.setImportUrl(o,c),this):(c.url&&c.url!==y[S].url&&this.setImportUrl(o,c.url),r.bh(c.config,y[S].config)||this.setImportConfig(o,c.config),r.bh(c.data,y[S].data)||this.setImportData(o,c.data),this)}moveImport(o,c){this._checkLoaded();let y=this.stylesheet.imports||[];const S=this.getImportIndex(o);if(S===-1)return this;const T=this.getImportIndex(c);if(T===-1)return this;const A=y[S],$=this.fragments[S];return y=y.filter(({id:Y})=>Y!==o),this.fragments=this.fragments.filter(({id:Y})=>Y!==o),this.stylesheet.imports=y.slice(0,T).concat(A).concat(y.slice(T)),this.fragments=this.fragments.slice(0,T).concat($).concat(this.fragments.slice(T)),this.mergeLayers(),this}setImportUrl(o,c){this._checkLoaded();const y=this.stylesheet.imports||[],S=this.getImportIndex(o);if(S===-1)return this;y[S].url=c;const T=this.fragments[S];return T.style=this._createFragmentStyle(y[S]),T.style.on("style.import.load",()=>this.mergeAll()),T.style.loadURL(c),this}setImportData(o,c){this._checkLoaded();const y=this.getImportIndex(o),S=this.stylesheet.imports||[];return y===-1?this:c?(this.fragments[y].style.setState(c),this._reloadImports(),this):(delete S[y].data,this.setImportUrl(o,S[y].url))}setImportConfig(o,c){this._checkLoaded();const y=this.getImportIndex(o),S=this.stylesheet.imports||[];if(y===-1)return this;c?S[y].config=c:delete S[y].config;const T=this.fragments[y],A=T.style.stylesheet&&T.style.stylesheet.schema;return T.config=c,T.style.updateConfig(c,A),this.updateConfigDependencies(),this}removeImport(o){this._checkLoaded();const c=this.stylesheet.imports||[],y=this.getImportIndex(o);y!==-1&&(c.splice(y,1),this.fragments[y].style._remove(),this.fragments.splice(y,1),this._reloadImports())}getImportIndex(o){const c=(this.stylesheet.imports||[]).findIndex(y=>y.id===o);return c===-1&&this.fire(new r.t(new Error(`Import '${o}' does not exist in the map's style and cannot be updated.`))),c}getLayer(o){return this._mergedLayers[o]}getSources(){const o=[];for(const c in this._mergedOtherSourceCaches){const y=this._mergedOtherSourceCaches[c];y&&o.push(y.getSource())}return o}getSource(o,c){const y=this.getSourceCache(o,c);return y&&y.getSource()}getLayerSource(o){const c=this.getLayerSourceCache(o);return c&&c.getSource()}getSourceCache(o,c){const y=r.av(o,c);return this._mergedOtherSourceCaches[y]}getLayerSourceCache(o){const c=r.av(o.source,o.scope);return o.type==="symbol"?this._mergedSymbolSourceCaches[c]:this._mergedOtherSourceCaches[c]}getSourceCaches(o){if(o==null)return Object.values(this._mergedSourceCaches);const c=[];return this._mergedOtherSourceCaches[o]&&c.push(this._mergedOtherSourceCaches[o]),this._mergedSymbolSourceCaches[o]&&c.push(this._mergedSymbolSourceCaches[o]),c}updateSourceCaches(){const o=this._changes.getUpdatedSourceCaches();for(const c in o){const y=o[c];y==="reload"?this.reloadSource(c):y==="clear"&&this.clearSource(c)}}updateLayers(o){const c=this._changes.getUpdatedPaintProperties();for(const y of c){const S=this.getLayer(y);S&&S.updateTransitions(o)}}getImages(o,c,y){this.imageManager.getImages(c.icons,c.scope,y),this._updateTilesForChangedImages();const S=T=>{T&&T.setDependencies(c.tileID.key,c.type,c.icons)};S(this._otherSourceCaches[c.source]),S(this._symbolSourceCaches[c.source])}getGlyphs(o,c,y){this.glyphManager.getGlyphs(c.stacks,c.scope,y)}getResource(o,c,y){return r.ct(c,y)}getOwnSourceCache(o){return this._otherSourceCaches[o]}getOwnLayerSourceCache(o){return o.type==="symbol"?this._symbolSourceCaches[o.source]:this._otherSourceCaches[o.source]}getOwnSourceCaches(o){const c=[];return this._otherSourceCaches[o]&&c.push(this._otherSourceCaches[o]),this._symbolSourceCaches[o]&&c.push(this._symbolSourceCaches[o]),c}_isSourceCacheLoaded(o){const c=this.getOwnSourceCaches(o);return c.length===0?(this.fire(new r.t(new Error(`There is no source with ID '${o}'`))),!1):c.every(y=>y.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(o,c){if(!this._clipLayerPresent&&o.type!=="fill-extrusion")return!1;const y=o.type==="fill-extrusion"&&o.sourceLayer==="building";if(o.is3D()){if(y||c&&c.type==="batched-model"||o.type==="model")return!0}else if(o.type==="symbol")return!0;return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach(o=>{o.style._remove()}),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Pr.getSourceType=function(g){return Xo[g]},Pr.setSourceType=function(g,o){Xo[g]=o},Pr.registerForPluginStateChange=r.cc;var Ti=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,di=`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec2 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color) {
#ifdef INDICATOR_CUTOUT
float holeMinOpacity=u_indicator_cutout_params.x;float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,highp vec2 pos,highp vec2 lod_coord) {highp vec2 size=vec2(textureSize(image,0));highp vec2 dx=dFdx(lod_coord.xy*size);highp vec2 dy=dFdy(lod_coord.xy*size);highp float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));highp float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}`,U=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const vec2 units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (units_to_pixels*pos+offset)/pattern_size;}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {return get_pattern_pos(pixel_coord_upper,pixel_coord_lower,pattern_size,vec2(tile_units_to_pixels),pos);}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}`,m="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",b=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }
#endif
#ifdef DEPTH_OCCLUSION
uniform highp sampler2D u_depth;uniform highp vec2 u_depth_size_inv;uniform highp vec2 u_depth_range_unpack;uniform highp float u_occluder_half_size;uniform highp float u_occlusion_depth_offset;
#ifdef DEPTH_D24
float unpack_depth(float depth) {return depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}vec4 unpack_depth4(vec4 depth) {return depth*u_depth_range_unpack.x+vec4(u_depth_range_unpack.y);}
#else
highp float unpack_depth_rgba(vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;
#ifdef DEPTH_D24
float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5).r);
#else
float depth=unpack_depth_rgba(texture(u_depth,(coord.xy+1.0)*0.5));
#endif
return coord.z+u_occlusion_depth_offset > depth;}highp vec4 getCornerDepths(vec2 coord) {highp vec3 df=vec3(u_occluder_half_size*u_depth_size_inv,0.0);highp vec2 uv=0.5*coord.xy+0.5;
#ifdef DEPTH_D24
highp vec4 depth=vec4(
texture(u_depth,uv-df.xz).r,texture(u_depth,uv+df.xz).r,texture(u_depth,uv-df.zy).r,texture(u_depth,uv+df.zy).r
);depth=unpack_depth4(depth);
#else
highp vec4 depth=vec4(
unpack_depth_rgba(texture(u_depth,uv-df.xz)),unpack_depth_rgba(texture(u_depth,uv+df.xz)),unpack_depth_rgba(texture(u_depth,uv-df.zy)),unpack_depth_rgba(texture(u_depth,uv+df.zy))
);
#endif
return depth;}highp float occlusionFadeMultiSample(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec2 uv=0.5*coord.xy+0.5;int NX=3;int NY=4;highp vec2 df=u_occluder_half_size*u_depth_size_inv;highp vec2 oneStep=2.0*u_occluder_half_size*u_depth_size_inv/vec2(NX-1,NY-1);highp float res=0.0;for (int y=0; y < NY;++y) {for (int x=0; x < NX;++x) {
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)));
#endif
res+=1.0-clamp(300.0*(coord.z+u_occlusion_depth_offset-depth),0.0,1.0);}}res=clamp(2.0*res/float(NX*NY)-0.5,0.0,1.0);return res;}highp float occlusionFade(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec4 depth=getCornerDepths(coord.xy);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z+u_occlusion_depth_offset)-depth),0.0,1.0));}
#else
bool isOccluded(vec4 frag) { return false; }highp float occlusionFade(vec4 frag) { return 1.0; }highp float occlusionFadeMultiSample(vec4 frag) { return 1.0; }
#endif//DEPTH_OCCLUSION`,w=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,R=`highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}
#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {
#ifdef FOG_DITHERING
vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);
#else
return color;
#endif
}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,J=`#ifdef RASTER_ARRAY
uniform sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,ve=`#ifdef RASTER_ARRAY
uniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec2 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=u_data_offset+vec2(dot(t.rg,u_data_scale),dot(t.ba,u_data_scale));velocity.y=-velocity.y;velocity/=max(u_max_speed,length(velocity));return velocity;}
#endif
uniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}`,Ie=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {vec3 transformed_normal=vec3(-normal.xy,normal.z);float NDotL=dot(normalize(transformed_normal),u_shadow_direction);float dotScale=min(1.0-NDotL,1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,je=`#ifdef RENDER_SHADOWS
#ifdef DEPTH_TEXTURE
uniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;
#else
uniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;
#endif
uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_1,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_1,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_0,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_0,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;
#ifdef NATIVE
highp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));
#else
highp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(
shadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)
);
#endif
vec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return mix(lerpx.x,lerpx.y,f.y);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {
#ifdef SHADOWS_SINGLE_CASCADE
light_view_pos0.xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);
#else
light_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth));
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_opacity(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,float shadow_opacity) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias)*shadow_opacity;return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const lt=[];Nr(Ti,lt),Nr(U,lt),Nr(di,lt);const Ft={"_prelude_fog.vertex.glsl":w,"_prelude_terrain.vertex.glsl":b,"_prelude_shadow.vertex.glsl":Ie,"_prelude_fog.fragment.glsl":R,"_prelude_shadow.fragment.glsl":je,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":J,"_prelude_raster_particle.glsl":ve},Kt={};Bn("",b),Bn(R,w),Bn(je,Ie),Bn(J,""),Bn(ve,"");const En=Bn(di,U),or=Ti;var er={background:Bn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Bn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in highp vec2 v_pos;void main() {highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec2 u_pattern_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_pattern_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Bn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float blur_positive=blur < 0.0 ? 0.0 : 1.0;lowp float antialiasblur=v_data.z;float extrude_length=length(extrude)+antialiasblur*(1.0-blur_positive);float antialiased_blur=-max(abs(blur),antialiasblur);float opacity_t=smoothstep((1.0-blur_positive)*antialiased_blur,blur_positive*antialiased_blur,extrude_length-1.0)-smoothstep(0.0,antialiasblur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Bn("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Bn(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Bn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Bn("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in vec2 a_elevation_from_sea;in float a_size_scale;in vec2 a_padding;in float a_auto_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {float feature_elevation=a_elevation_from_sea.x+a_auto_z_offset;float terrain_elevation=(a_elevation_from_sea.y==1.0 ? 0.0 : elevation(a_anchor_pos));vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(feature_elevation+terrain_elevation),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Bn("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Bn("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Bn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:Bn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Bn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Bn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;in highp vec2 v_pos;uniform float u_emissive_strength;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
out highp vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Bn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
in float v_height;
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float emissive_strength
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor;
#ifdef RENDER_CUTOFF
shadowed_lighting_factor=shadowed_light_factor_normal_opacity(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,v_cutoff_opacity);if (v_cutoff_opacity==0.0) {discard;}
#else
shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);
#endif
color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;uniform float u_width_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp float emissive_strength
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);cutoff=cutoff_opacity(u_cutoff_params,ground.z);if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;v_cutoff_opacity=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff==0.0 && centroid_pos.x !=0.0) || (color.a==0.0));
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);scaled_pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;scaled_pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);v_flat=vec4(linearProduct(color.rgb,vec3(calculate_NdotL(normal))),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:Bn(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_width_scale;uniform float u_vertical_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp vec4 color
out highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp vec4 color
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base);pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:Bn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
in highp vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_width_scale;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
out highp vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
#pragma mapbox: define highp float line_width
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
#pragma mapbox: initialize highp float line_width
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);p.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;p.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:Bn(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0)).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:Bn(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;
#endif
HANDLE_WIREFRAME_DEBUG;
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp float u_dynamic_offset;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(u_dynamic_offset,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:Bn(`precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Bn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Bn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trim_alpha=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=out_color.a;}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=(border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color.rgb=mix(border_color.rgb*border_color.a*trim_alpha,out_color.rgb,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in float a_z_offset;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);
#ifdef ELEVATED_ROADS
gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset+0.01*step(0.01,a_z_offset),1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 halfCellProgress=normal.yx*32.0;float ele0=elevation(pos);float ele_line=max(ele0,max(elevation(pos+halfCellProgress),elevation(pos-halfCellProgress)));float ele1=elevation(pos+offsetTile);float ele2=elevation(pos-offsetTile);float ele_max=max(ele_line,0.5*(ele1+ele2));float ele=ele_max-ele0+ele1+a_z_offset ;gl_Position=u_matrix*vec4(pos+offsetTile,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*0.1*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:Bn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform highp float u_device_pixel_ratio;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec4 v_uv;
#endif
#ifdef LINE_JOIN_NONE
in vec2 v_pattern_data;
#endif
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;highp float x=mod(pattern_x,1.0);highp float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;highp vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));highp vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {color=vec4(0,0,0,0);}}
#endif
#ifdef LINE_JOIN_NONE
float pattern_len=pattern_size/aspect;float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}
#endif
#ifdef LIGHTING_3D_MODE
color=apply_lighting_ground(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in float a_z_offset;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec4 a_packed;
#endif
in highp float a_linesofar;
#ifdef LINE_JOIN_NONE
in highp vec3 a_pattern_data;out vec2 v_pattern_data;
#endif
uniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
out highp vec4 v_uv;
#endif
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
#pragma mapbox: define mediump float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define mediump float floorwidth
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
void main() {
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
#pragma mapbox: initialize mediump float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize mediump float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);
#ifdef ELEVATED_ROADS
gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset+0.01*step(0.01,a_z_offset),1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 halfCellProgress=normal.yx*32.0;float ele0=elevation(pos);float ele_line=max(ele0,max(elevation(pos+halfCellProgress),elevation(pos-halfCellProgress)));float ele1=elevation(pos+offsetTile);float ele2=elevation(pos-offsetTile);float ele_max=max(ele_line,0.5*(ele1+ele2));float ele=ele_max-ele0+ele1+a_z_offset ;gl_Position=u_matrix*vec4(pos+offsetTile,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*0.1*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
float a_uv_x=a_packed[0];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef LINE_JOIN_NONE
v_width=floorwidth+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:Bn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
in float v_split_fade;
#endif
uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;
#ifdef GLOBE_POLES
color.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);
#endif
vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef PROJECTION_GLOBE_VIEW
glFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));
#endif
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
out float v_split_fade;
#endif
void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    
v_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),rasterParticle:Bn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),rasterParticleDraw:Bn("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",`#include "_prelude_raster_particle.glsl"
in float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(
mod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-1.0,0,1);v_particle_speed=length(velocity);}gl_PointSize=1.0;}`),rasterParticleTexture:Bn("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:Bn(`#include "_prelude_raster_particle.glsl"
uniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;vec2 linearstep(vec2 edge0,vec2 edge1,vec2 x) {return  clamp((x-edge0)/(edge1-edge0),vec2(0),vec2(1));}const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp vec2 persist_rate=pow(
linearstep(vec2(-u_particle_pos_offset),vec2(0),pos)*linearstep(vec2(1.0+u_particle_pos_offset),vec2(1),pos),vec2(4)
);highp vec2 per_frame_persist=pow(persist_rate,abs(dp)/u_particle_pos_offset);highp float drop_rate=1.0-per_frame_persist.x*per_frame_persist.y;drop_rate=any(greaterThanEqual(abs(pos-0.5),vec2(0.5+u_particle_pos_offset))) ? 1.0 : drop_rate;highp float drop=step(1.0-drop_rate-u_reset_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}`,"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbol:Bn(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
#ifdef COLOR_ADJUSTMENT
uniform mat4 u_color_adj_mat;
#endif
in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
in float v_draw_halo;in vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
in float is_sdf;in vec2 v_tex_a_icon;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec4 out_color;float fade_opacity=v_gamma_scale_size_fade_opacity[2];
#ifdef RENDER_TEXT_AND_SYMBOL
if (is_sdf==ICON) {vec2 tex_icon=v_tex_a_icon;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}
#endif
#ifdef RENDER_SDF
float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_gamma_scale_size_fade_opacity.x;float size=v_gamma_scale_size_fade_opacity.y;float fontScale=u_is_text ? size/24.0 : size;out_color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {out_color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,v_tex_a).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);out_color*=alpha;
#else
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);
#else
out_color=texture(u_texture,v_tex_a);
#endif
#ifdef COLOR_ADJUSTMENT
out_color=u_color_adj_mat*out_color;
#endif
#endif
out_color*=opacity*fade_opacity;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_auto_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_elevation_from_sea;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_draw_halo;out vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
out float is_sdf;out vec2 v_tex_a_icon;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
#pragma mapbox: define lowp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
#pragma mapbox: initialize lowp float z_offset
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=u_elevation_from_sea ? z_offset : z_offset+elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_auto_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
#ifdef Z_OFFSET
z+=u_pitch_with_map ? a_auto_z_offset+(u_elevation_from_sea ? z_offset : z_offset) : 0.0;
#else
z+=u_pitch_with_map ? (u_elevation_from_sea ? z_offset : z_offset) : 0.0;
#endif
float occlusion_fade=globe_occlusion_fade;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;
#ifdef DEPTH_OCCLUSION
float depth_occlusion=occlusionFadeMultiSample(projected_point);float depth_occlusion_multplier=mix(occlusion_opacity,1.0,depth_occlusion);out_fade_opacity*=depth_occlusion_multplier;
#endif
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_gamma_scale_size_fade_opacity=vec3(gamma_scale,size,out_fade_opacity);v_tex_a=a_tex/u_texsize;
#ifdef RENDER_TEXT_AND_SYMBOL
is_sdf=a_size[0]-2.0*a_size_min;v_tex_a_icon=a_tex/u_texsize_icon;
#endif
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
}`),terrainRaster:Bn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);
#endif
}`),terrainDepth:Bn("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:Bn(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,m),skyboxGradient:Bn(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,m),skyboxCapture:Bn(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Bn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(raster.rgb*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Bn(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;
#ifndef NATIVE
c=dither(c,gl_FragCoord.xy+u_temporal_offset);
#endif
glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:Bn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform highp sampler2D u_depthTexture;uniform highp vec2 u_inv_depth_size;uniform highp vec2 u_depth_range_unpack;
#ifdef DEPTH_D24
highp float unpack_depth(highp float depth) {return  depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}
#else
highp float unpack_depth_rgba(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded() {highp vec2 coord=gl_FragCoord.xy*u_inv_depth_size;
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depthTexture,coord).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depthTexture,coord));
#endif
return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
vec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
return color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
#ifdef APPLY_LUT_ON_GPU
float emissiveFactorLength=max(length(u_emissiveFactor.rgb),0.001);emissive.rgb=sRGBToLinear(applyLUT(u_lutTexture,linearTosRGB(emissive.rgb/emissiveFactorLength).rbg))*emissiveFactorLength;
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;
#ifdef APPLY_LUT_ON_GPU
color_mix=applyLUT(u_lutTexture,color_mix);
#endif
color=mix(color,color_mix,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normal_3f);shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:Bn(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:Bn(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`),occlusion:Bn("uniform vec4 u_color;void main() {glFragColor=u_color;}",`#include "_prelude_terrain.vertex.glsl"
in highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;
#ifdef TERRAIN
float e=elevation(world_pos.xy);world_pos.z+=e;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}`)};function Nr(g,o){const c=g.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let y of c)if(y=y.trim(),y[0]==="#"&&y.includes("if")&&!y.includes("endif")){y=y.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const S=y.split(" ");for(const T of S)o.includes(T)||o.push(T)}}function Bn(g,o){const c=/#include\s+"([^"]+)"/g,y=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let S=o.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);S&&(S=S.map(ee=>{const te=ee.split(" ");return te[te.length-1]}),S=[...new Set(S)]);const T={},A=[],$=[];if(g=g.replace(c,(ee,te)=>($.push(te),"")),(o=o.replace(c,(ee,te)=>(A.push(te),""))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let Y=[...lt];Nr(g,Y),Nr(o,Y);for(const ee of[...A,...$])Ft[ee]||console.error(`Undefined include: ${ee}`),Kt[ee]||(Kt[ee]=[],Nr(Ft[ee],Kt[ee])),Y=[...Y,...Kt[ee]];return{fragmentSource:g=g.replace(y,(ee,te,ue,fe,me)=>(T[me]=!0,te==="define"?`
#ifndef HAS_UNIFORM_u_${me}
in ${ue} ${fe} ${me};
#else
uniform ${ue} ${fe} u_${me};
#endif
`:te==="initialize"?`
#ifdef HAS_UNIFORM_u_${me}
    ${ue} ${fe} ${me} = u_${me};
#endif
`:te==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${me}
    in ${ue} ${fe} ${me};
#endif
`:te==="initialize-attribute"?"":void 0)),vertexSource:o=o.replace(y,(ee,te,ue,fe,me)=>{const ke=fe==="float"?"vec2":fe,Le=me.match(/color/)?"color":ke;return te==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${me}
in ${ue} ${fe} a_${me};
#endif
`:T[me]?te==="define"?`
#ifndef HAS_UNIFORM_u_${me}
uniform lowp float u_${me}_t;
in ${ue} ${ke} a_${me};
out ${ue} ${fe} ${me};
#else
uniform ${ue} ${fe} u_${me};
#endif
`:te==="initialize"?Le==="vec4"?`
#ifndef HAS_UNIFORM_u_${me}
    ${me} = a_${me};
#else
    ${ue} ${fe} ${me} = u_${me};
#endif
`:`
#ifndef HAS_UNIFORM_u_${me}
    ${me} = unpack_mix_${Le}(a_${me}, u_${me}_t);
#else
    ${ue} ${fe} ${me} = u_${me};
#endif
`:te==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${me}
    in ${ue} ${fe} a_${me};
    out ${ue} ${fe} ${me};
#endif
`:te==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${me}
    ${me} = a_${me};
#endif
`:void 0:te==="define"?`
#ifndef HAS_UNIFORM_u_${me}
uniform lowp float u_${me}_t;
in ${ue} ${ke} a_${me};
#else
uniform ${ue} ${fe} u_${me};
#endif
`:te==="define-instanced"?Le==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${me}0;
in vec4 a_${me}1;
in vec4 a_${me}2;
in vec4 a_${me}3;
#else
uniform ${ue} ${fe} u_${me};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${ue} ${ke} a_${me};
#else
uniform ${ue} ${fe} u_${me};
#endif
`:te==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${me}
    ${ue} ${fe} ${me} = a_${me};
#endif
`:Le==="vec4"?`
#ifndef HAS_UNIFORM_u_${me}
    ${ue} ${fe} ${me} = a_${me};
#else
    ${ue} ${fe} ${me} = u_${me};
#endif
`:`
#ifndef HAS_UNIFORM_u_${me}
    ${ue} ${fe} ${me} = unpack_mix_${Le}(a_${me}, u_${me}_t);
#else
    ${ue} ${fe} ${me} = u_${me};
#endif
`}),staticAttributes:S,usedDefines:Y,vertexIncludes:A,fragmentIncludes:$}}class wr{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(o,c,y,S,T,A,$,Y){this.context=o;let ee=this.boundPaintVertexBuffers.length!==S.length;for(let ue=0;!ee&&ue<S.length;ue++)this.boundPaintVertexBuffers[ue]!==S[ue]&&(ee=!0);let te=this.boundDynamicVertexBuffers.length!==$.length;for(let ue=0;!te&&ue<$.length;ue++)this.boundDynamicVertexBuffers[ue]!==$[ue]&&(te=!0);if(!this.vao||this.boundProgram!==c||this.boundLayoutVertexBuffer!==y||ee||te||this.boundIndexBuffer!==T||this.boundVertexOffset!==A)this.freshBind(c,y,S,T,A,$,Y);else{o.bindVertexArrayOES.set(this.vao);for(const ue of $)ue&&(ue.bind(),Y&&ue.instanceCount&&ue.setVertexAttribDivisor(o.gl,c,Y));T&&T.dynamicDraw&&T.bind()}}freshBind(o,c,y,S,T,A,$){const Y=o.numAttributes,ee=this.context,te=ee.gl;this.vao&&this.destroy(),this.vao=ee.gl.createVertexArray(),ee.bindVertexArrayOES.set(this.vao),this.boundProgram=o,this.boundLayoutVertexBuffer=c,this.boundPaintVertexBuffers=y,this.boundIndexBuffer=S,this.boundVertexOffset=T,this.boundDynamicVertexBuffers=A,c.enableAttributes(te,o),c.bind(),c.setVertexAttribPointers(te,o,T);for(const ue of y)ue.enableAttributes(te,o),ue.bind(),ue.setVertexAttribPointers(te,o,T);for(const ue of A)ue&&(ue.enableAttributes(te,o),ue.bind(),ue.setVertexAttribPointers(te,o,T),$&&ue.instanceCount&&ue.setVertexAttribDivisor(te,o,$));S&&S.bind(),ee.currentNumAttributes=Y}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function Pi(g,o){const c=Math.pow(2,o.canonical.z),y=o.canonical.y;return[new r.a5(0,y/c).toLngLat().lat,new r.a5(0,(y+1)/c).toLngLat().lat]}function Vi(g,o,c,y,S,T,A){const $=g.context,Y=$.gl,ee=c.hillshadeFBO;if(!ee)return;g.prepareDrawTile();const te=g.isTileAffectedByFog(o),ue=g.getOrCreateProgram("hillshade",{overrideFog:te});$.activeTexture.set(Y.TEXTURE0),Y.bindTexture(Y.TEXTURE_2D,ee.colorAttachment.get());const fe=((De,Fe,Ye,Je)=>{const qe=Ye.paint.get("hillshade-shadow-color"),it=Ye.paint.get("hillshade-highlight-color"),rt=Ye.paint.get("hillshade-accent-color"),mt=Ye.paint.get("hillshade-emissive-strength");let dt=r.bB(Ye.paint.get("hillshade-illumination-direction"));if(Ye.paint.get("hillshade-illumination-anchor")==="viewport")dt-=De.transform.angle;else if(De.style&&De.style.enable3dLights()&&De.style.directionalLight){const Et=De.style.directionalLight.properties.get("direction"),bt=r.c7(Et.x,Et.y,Et.z);dt=r.bB(bt[1])}const yt=!De.options.moving;return{u_matrix:Je||De.transform.calculateProjMatrix(Fe.tileID.toUnwrapped(),yt),u_image:0,u_latrange:Pi(0,Fe.tileID),u_light:[Ye.paint.get("hillshade-exaggeration"),dt],u_shadow:qe.toRenderColor(Ye.lut),u_highlight:it.toRenderColor(Ye.lut),u_emissive_strength:mt,u_accent:rt.toRenderColor(Ye.lut)}})(g,c,y,g.terrain?o.projMatrix:null);g.uploadCommonUniforms($,ue,o.toUnwrapped());const{tileBoundsBuffer:me,tileBoundsIndexBuffer:ke,tileBoundsSegments:Le}=g.getTileBoundsBuffers(c);ue.draw(g,Y.TRIANGLES,S,T,A,Mr.disabled,fe,y.id,me,ke,Le)}function Ko(g,o,c){if(!o.needsDEMTextureUpload)return;const y=g.context,S=y.gl;y.pixelStoreUnpackPremultiplyAlpha.set(!1),o.demTexture=o.demTexture||g.getTileTexture(c.stride);const T=c.getPixels();o.demTexture?o.demTexture.update(T,{premultiply:!1}):o.demTexture=new r.T(y,T,S.R32F,{premultiply:!1}),o.needsDEMTextureUpload=!1}function so(g,o,c){const y=g.context,S=y.gl;if(!o.dem)return;const T=o.dem;if(y.activeTexture.set(S.TEXTURE1),Ko(g,o,T),!o.demTexture)return;o.demTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE);const A=T.dim;y.activeTexture.set(S.TEXTURE0);let $=o.hillshadeFBO;if(!$){const fe=new r.T(y,{width:A,height:A,data:null},S.RGBA8);fe.bind(S.LINEAR,S.CLAMP_TO_EDGE),$=o.hillshadeFBO=y.createFramebuffer(A,A,!0,"renderbuffer"),$.colorAttachment.set(fe.texture)}y.bindFramebuffer.set($.framebuffer),y.viewport.set([0,0,A,A]);const{tileBoundsBuffer:Y,tileBoundsIndexBuffer:ee,tileBoundsSegments:te}=g.getMercatorTileBoundsBuffers(),ue=[];g.linearFloatFilteringSupported()&&ue.push("TERRAIN_DEM_FLOAT_FORMAT"),g.getOrCreateProgram("hillshadePrepare",{defines:ue}).draw(g,S.TRIANGLES,cr.disabled,Dr.disabled,Hr.unblended,Mr.disabled,((fe,me)=>{const ke=me.stride,Le=r.a6.mat4.create();return r.a6.mat4.ortho(Le,0,r.ab,-r.ab,0,0,1),r.a6.mat4.translate(Le,Le,[0,-r.ab,0]),{u_matrix:Le,u_image:1,u_dimension:[ke,ke],u_zoom:fe.overscaledZ}})(o.tileID,T),c.id,Y,ee,te),o.needsHillshadePrepare=!1}class ti{constructor(o){this.gl=o.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(o){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class gs extends ti{getDefault(){return r.bz.transparent}set(o){const c=this.current;(o.r!==c.r||o.g!==c.g||o.b!==c.b||o.a!==c.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class xa extends ti{getDefault(){return 1}set(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)}}class el extends ti{getDefault(){return 0}set(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)}}class da extends ti{getDefault(){return[!0,!0,!0,!0]}set(o){const c=this.current;(o[0]!==c[0]||o[1]!==c[1]||o[2]!==c[2]||o[3]!==c[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class Fs extends ti{getDefault(){return!0}set(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)}}class pd extends ti{getDefault(){return 255}set(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)}}class ju extends ti{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(o){const c=this.current;(o.func!==c.func||o.ref!==c.ref||o.mask!==c.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)}}class Vu extends ti{getDefault(){const o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]}set(o){const c=this.current;(o[0]!==c[0]||o[1]!==c[1]||o[2]!==c[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)}}class La extends ti{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const c=this.gl;o?c.enable(c.STENCIL_TEST):c.disable(c.STENCIL_TEST),this.current=o,this.dirty=!1}}class rh extends ti{getDefault(){return[0,1]}set(o){const c=this.current;(o[0]!==c[0]||o[1]!==c[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)}}class Um extends ti{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const c=this.gl;o?c.enable(c.DEPTH_TEST):c.disable(c.DEPTH_TEST),this.current=o,this.dirty=!1}}class Yh extends ti{getDefault(){return this.gl.LESS}set(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)}}class Zh extends ti{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const c=this.gl;o?c.enable(c.BLEND):c.disable(c.BLEND),this.current=o,this.dirty=!1}}class L0 extends ti{getDefault(){const o=this.gl;return[o.ONE,o.ZERO,o.ONE,o.ZERO]}set(o){const c=this.current;(o[0]!==c[0]||o[1]!==c[1]||o[2]!==c[2]||o[3]!==c[3]||this.dirty)&&(this.gl.blendFuncSeparate(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class R0 extends ti{getDefault(){return r.bz.transparent}set(o){const c=this.current;(o.r!==c.r||o.g!==c.g||o.b!==c.b||o.a!==c.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class O0 extends ti{getDefault(){return this.gl.FUNC_ADD}set(o){(o!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(o,o),this.current=o,this.dirty=!1)}}class D0 extends ti{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const c=this.gl;o?c.enable(c.CULL_FACE):c.disable(c.CULL_FACE),this.current=o,this.dirty=!1}}class k1 extends ti{getDefault(){return this.gl.BACK}set(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)}}class M1 extends ti{getDefault(){return this.gl.CCW}set(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)}}let eT=class extends ti{getDefault(){return null}set(g){(g!==this.current||this.dirty)&&(this.gl.useProgram(g),this.current=g,this.dirty=!1)}};class Cp extends ti{getDefault(){return this.gl.TEXTURE0}set(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)}}class Ep extends ti{getDefault(){const o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]}set(o){const c=this.current;(o[0]!==c[0]||o[1]!==c[1]||o[2]!==c[2]||o[3]!==c[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class P1 extends ti{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const c=this.gl;c.bindFramebuffer(c.FRAMEBUFFER,o),this.current=o,this.dirty=!1}}class Cl extends ti{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const c=this.gl;c.bindRenderbuffer(c.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class z0 extends ti{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const c=this.gl;c.bindTexture(c.TEXTURE_2D,o),this.current=o,this.dirty=!1}}class Gm extends ti{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const c=this.gl;c.bindBuffer(c.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class Hm extends ti{getDefault(){return null}set(o){const c=this.gl;c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class F0 extends ti{getDefault(){return null}set(o){this.gl&&(o!==this.current||this.dirty)&&(this.gl.bindVertexArray(o),this.current=o,this.dirty=!1)}}class N0 extends ti{getDefault(){return 4}set(o){if(o===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}}class Wm extends ti{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}}class B0 extends ti{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}}class Tp extends ti{constructor(o,c){super(o),this.context=o,this.parent=c}getDefault(){return null}}class qm extends Tp{setDirty(){this.dirty=!0}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}}class j0 extends Tp{attachment(){return this.gl.DEPTH_ATTACHMENT}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferRenderbuffer(c.FRAMEBUFFER,this.attachment(),c.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class A1 extends Tp{attachment(){return this.gl.DEPTH_ATTACHMENT}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferTexture2D(c.FRAMEBUFFER,this.attachment(),c.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}}class Kh extends j0{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}const tT=(g,o,c)=>({u_matrix:g,u_image0:0,u_skirt_height:o,u_ground_shadow_factor:c}),L1=(g,o,c,y,S,T,A,$,Y,ee,te,ue,fe,me,ke,Le)=>({u_proj_matrix:Float32Array.from(g),u_globe_matrix:o,u_normalize_matrix:Float32Array.from(y),u_merc_matrix:c,u_zoom_transition:S,u_merc_center:T,u_image0:0,u_frustum_tl:A,u_frustum_tr:$,u_frustum_br:Y,u_frustum_bl:ee,u_globe_pos:te,u_globe_radius:ue,u_viewport:fe,u_grid_matrix:Le?Float32Array.from(Le):new Float32Array(9),u_skirt_height:me,u_far_z_cutoff:ke});function R1(g,o){return g!=null&&o!=null&&!(!g.hasData()||!o.hasData())&&g.demTexture!=null&&o.demTexture!=null&&g.tileID.key!==o.tileID.key}const Jh=new class{constructor(){this.operations={}}newMorphing(g,o,c,y,S){if(g in this.operations){const T=this.operations[g];T.to.tileID.key!==c.tileID.key&&(T.queued=c)}else this.operations[g]={startTime:y,phase:0,duration:S,from:o,to:c,queued:null}}getMorphValuesForProxy(g){if(!(g in this.operations))return null;const o=this.operations[g];return{from:o.from,to:o.to,phase:o.phase}}update(g){for(const o in this.operations){const c=this.operations[o];for(c.phase=(g-c.startTime)/c.duration;c.phase>=1||!this._validOp(c);)if(!this._nextOp(c,g)){delete this.operations[o];break}}}_nextOp(g,o){return!!g.queued&&(g.from=g.to,g.to=g.queued,g.queued=null,g.phase=0,g.startTime=o,!0)}_validOp(g){return g.from.hasData()&&g.to.hasData()}},O1={0:null,1:"TERRAIN_VERTEX_MORPHING"};function D1(g,o,c){if(o===0)return 0;const y=o<1&&c===514?.25/o:1;return 6*Math.pow(1.5,22-g)*Math.max(o,1)*y}function V0(g,o){const c=1<<g.z;return!o&&(g.x===0||g.x===c-1)||g.y===0||g.y===c-1}const Ip=g=>({u_matrix:g});function Xm(g,o,c,y,S){if(S>0){const T=r.q.now(),A=(T-g.timeAdded)/S,$=o?(T-o.timeAdded)/S:-1,Y=c.getSource(),ee=y.coveringZoomLevel({tileSize:Y.tileSize,roundZoom:Y.roundZoom}),te=!o||Math.abs(o.tileID.overscaledZ-ee)>Math.abs(g.tileID.overscaledZ-ee),ue=te&&g.refreshedUponExpiration?1:r.ap(te?A:1-$,0,1);return g.refreshedUponExpiration&&A>=1&&(g.refreshedUponExpiration=!1),o?{opacity:1,mix:1-ue}:{opacity:ue,mix:0}}return{opacity:1,mix:0}}class Qh extends jt{constructor(o){const c={type:"raster-dem",maxzoom:o.transform.maxZoom},y=new r.cd(r.ce(),null),S=Rs("mock-dem",c,y,o.style);super("mock-dem",S,!1),S.setEventedParent(this),this._sourceLoaded=!0}_loadTile(o,c){o.state="loaded",c(null)}}class z1 extends jt{constructor(o){const c=Rs("proxy",{type:"geojson",maxzoom:o.transform.maxZoom},new r.cd(r.ce(),null),o.style);super("proxy",c,!1),c.setEventedParent(this),this.map=this.getSource().map=o,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(o,c,y){if(o.freezeTileCoverage)return;this.transform=o;const S=o.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((T,A)=>{if(T[A.key]="",!this._tiles[A.key]){const $=new ne(A,this._source.tileSize*A.overscaleFactor(),o.tileZoom);$.state="loaded",this._tiles[A.key]=$}return T},{});for(const T in this._tiles)T in S||(this.freeFBO(T),this._tiles[T].unloadVectorData(),delete this._tiles[T])}freeFBO(o){const c=this.proxyCachedFBO[o];if(c!==void 0){const y=Object.values(c);this.renderCachePool.push(...y),delete this.proxyCachedFBO[o]}}deallocRenderCache(){this.renderCache.forEach(o=>o.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class $0 extends r.aA{constructor(o,c,y){super(o.overscaledZ,o.wrap,o.canonical.z,o.canonical.x,o.canonical.y),this.proxyTileKey=c,this.projMatrix=y}}class U0 extends r.cE{constructor(o,c){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},o.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},()=>{this._style.map.triggerRepaint()}),o.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},()=>{this._style.map.triggerRepaint()}),o.tp.registerButton(["Terrain"],"Invalidate Render Cache",()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()}),this.painter=o,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[y,S,T]=function(Y){const ee=new r.a_,te=new r.aO,ue=131;ee.reserve(17161),te.reserve(33800);const fe=r.ab/128,me=r.ab+fe/2,ke=me+fe;for(let De=-fe;De<ke;De+=fe)for(let Fe=-fe;Fe<ke;Fe+=fe){const Ye=Fe<0||Fe>me||De<0||De>me?24575:0,Je=r.ap(Math.round(Fe),0,r.ab),qe=r.ap(Math.round(De),0,r.ab);ee.emplaceBack(Je+Ye,qe)}const Le=(De,Fe)=>{const Ye=Fe*ue+De;te.emplaceBack(Ye+1,Ye,Ye+ue),te.emplaceBack(Ye+ue,Ye+ue+1,Ye+1)};for(let De=1;De<129;De++)for(let Fe=1;Fe<129;Fe++)Le(Fe,De);return[0,129].forEach(De=>{for(let Fe=0;Fe<130;Fe++)Le(Fe,De),Le(De,Fe)}),[ee,te,32768]}(),A=o.context;this.gridBuffer=A.createVertexBuffer(y,r.b0.members),this.gridIndexBuffer=A.createIndexBuffer(S),this.gridSegments=r.b1.simpleSegment(0,0,y.length,S.length),this.gridNoSkirtSegments=r.b1.simpleSegment(0,0,y.length,T),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new z1(c.map),this.orthoMatrix=r.a6.mat4.create(),r.a6.mat4.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,r.ab,0,r.ab,0,1);const $=A.gl;this._overlapStencilMode=new Dr({func:$.GEQUAL,mask:255},0,255,$.KEEP,$.KEEP,$.REPLACE),this._previousZoom=o.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=c,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Qh(c.map),this._pendingGroundEffectLayers=[]}set style(o){o.on("data",this._onStyleDataEvent.bind(this)),this._style=o,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(o,c,y){if(o&&o.terrain){this._style!==o&&(this.style=o,this._evaluationZoom=void 0);const S=o.terrain.properties,T=o.terrain.drapeRenderMode===0,A=o.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=r.q.now();const $=o.terrain&&o.terrain.scope,Y=S.get("source"),ee=T?this._mockSourceCache:o.getSourceCache(Y,$);if(!ee)return void r.w(`Couldn't find terrain source "${Y}".`);if(this.sourceCache=ee,this._exaggeration=A?this.calculateExaggeration(c):S.get("exaggeration"),!c.projection.requiresDraping&&A&&this._exaggeration===0)return void this._disable();this.enabled=!0;const te=()=>{this.sourceCache.used&&r.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const ue=this.getScaledDemTileSize();this.sourceCache.update(c,ue,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,te(),this._initializing=!0),te(),c.updateElevation(!0,y),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(c),this._emptyDEMTextureDirty=!0,this._previousZoom=c.zoom}else this._disable()}calculateExaggeration(o){const c=this._previousCameraAltitude,y=o.getFreeCameraOptions().position.z/o.pixelsPerMeter*o.worldSize;this._previousCameraAltitude=y;const S=c!=null?y-c:Number.MAX_VALUE;if(Math.abs(S)<2)return this._exaggeration;const T=o.zoom,A=this._style.terrain;if(!this._previousUpdateTimestamp)return A.getExaggeration(T);let $=T-this._previousZoom;const Y=this._previousUpdateTimestamp;let ee=T;this._evaluationZoom!=null&&(ee=this._evaluationZoom,Math.abs(T-ee)>.5&&($=.5*(T-ee+$)),$*S<0&&(ee+=$)),this._evaluationZoom=ee;const te=A.getExaggeration(ee),ue=te===A.getExaggeration(Math.max(0,ee-.1));if(ue&&Math.abs(te-this._exaggeration)<.01)return te;let fe=Math.min(.1,.00375*(this._updateTimestamp-Y));return(ue||te<.1||Math.abs($)<1e-4)&&(fe=Math.min(.2,4*fe)),r.aa(this._exaggeration,te,fe)}resetTileLookupCache(o){this._findCoveringTileCache[o]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(o){o.coord&&o.dataType==="source"?this._clearRenderCacheForTile(o.sourceCacheId,o.coord):o.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const o in this._style._mergedSourceCaches)this._style._mergedSourceCaches[o].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach(o=>o.fb.destroy()),this.pool=[],this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const o=2*this.proxySourceCache.getSource().tileSize;return[o,o]}set useVertexMorphing(o){this._useVertexMorphing=o}updateTileBinding(o){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const c=this.proxySourceCache,y=this.painter.transform;this._initializing&&(this._initializing=y._centerAltitude===0&&this.getAtPointOrZero(r.a5.fromLngLat(y.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const S=this.proxyCoords=c.getIds().map(Y=>{const ee=c.getTileByID(Y).tileID;return ee.projMatrix=y.calculateProjMatrix(ee.toUnwrapped()),ee});(function(Y,ee){const te=ee.transform.pointCoordinate(ee.transform.getCameraPoint()),ue=new r.P(te.x,te.y);Y.sort((fe,me)=>{if(me.overscaledZ-fe.overscaledZ)return me.overscaledZ-fe.overscaledZ;const ke=new r.P(fe.canonical.x+(1<<fe.canonical.z)*fe.wrap,fe.canonical.y),Le=new r.P(me.canonical.x+(1<<me.canonical.z)*me.wrap,me.canonical.y),De=ue.mult(1<<fe.canonical.z);return De.x-=.5,De.y-=.5,De.distSqr(ke)-De.distSqr(Le)})})(S,this.painter);const T=this.proxyToSource||{};this.proxyToSource={},S.forEach(Y=>{this.proxyToSource[Y.key]={}}),this.terrainTileForTile={};const A=this._style._mergedSourceCaches;for(const Y in A){const ee=A[Y];if(!ee.used||(ee!==this.sourceCache&&this.resetTileLookupCache(ee.id),this._setupProxiedCoordsForOrtho(ee,o[Y],T),ee.usedForTerrain))continue;const te=o[Y];ee.getSource().reparseOverscaled&&this._assignTerrainTiles(te)}this.proxiedCoords[c.id]=S.map(Y=>new $0(Y,Y.key,this.orthoMatrix)),this._assignTerrainTiles(S),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(T),this.renderingToTexture=!1;const $={};this._visibleDemTiles=[];for(const Y of this.proxyCoords){const ee=this.terrainTileForTile[Y.key];if(!ee)continue;const te=ee.tileID.key;te in $||(this._visibleDemTiles.push(ee),$[te]=te)}}_assignTerrainTiles(o){this._initializing||o.forEach(c=>{if(this.terrainTileForTile[c.key])return;const y=this._findTileCoveringTileID(c,this.sourceCache);y&&(this.terrainTileForTile[c.key]=y)})}_prepareDEMTextures(){const o=this.painter.context,c=o.gl;for(const y in this.terrainTileForTile){const S=this.terrainTileForTile[y],T=S.dem;!T||S.demTexture&&!S.needsDEMTextureUpload||(o.activeTexture.set(c.TEXTURE1),Ko(this.painter,S,T))}}_prepareDemTileUniforms(o,c,y,S){if(!c||c.demTexture==null)return!1;const T=o.tileID.canonical,A=Math.pow(2,c.tileID.canonical.z-T.z),$=S||"";return y[`u_dem_tl${$}`]=[T.x*A%1,T.y*A%1],y[`u_dem_scale${$}`]=A,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let o=0;const c=this._visibleDemTiles.reduce((y,S)=>{if(!S.dem)return y;const T=S.dem.tree.minimums[0];return T>0&&o++,y+T},0);return o?c/o:0}_updateEmptyDEMTexture(){const o=this.painter.context,c=o.gl;o.activeTexture.set(c.TEXTURE2);const y=this._getLoadedAreaMinimum(),S=new r.cF({width:1,height:1},new Float32Array([y]));this._emptyDEMTextureDirty=!1;let T=this._emptyDEMTexture;return T?T.update(S,{premultiply:!1}):T=this._emptyDEMTexture=new r.T(o,S,c.R32F,{premultiply:!1}),T}setupElevationDraw(o,c,y){const S=this.painter.context,T=S.gl,A={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0};A.u_exaggeration=this.exaggeration();let $=null,Y=null,ee=1;if(y&&y.morphing&&this._useVertexMorphing){const me=y.morphing.srcDemTile,ke=y.morphing.dstDemTile;ee=y.morphing.phase,me&&ke&&(this._prepareDemTileUniforms(o,me,A,"_prev")&&(Y=me),this._prepareDemTileUniforms(o,ke,A)&&($=ke))}const te=me=>me&&me.demTexture&&this.painter.linearFloatFilteringSupported()?T.LINEAR:T.NEAREST;let ue=null;var fe;if(this.enabled?Y&&$?(ue=$.demTexture,S.activeTexture.set(T.TEXTURE4),Y.demTexture.bind(te(Y),T.CLAMP_TO_EDGE),A.u_dem_lerp=ee):($=this.terrainTileForTile[o.tileID.key],ue=this._prepareDemTileUniforms(o,$,A)?$.demTexture:this.emptyDEMTexture):ue=this.emptyDEMTexture,S.activeTexture.set(T.TEXTURE2),ue&&(A.u_dem_size=(fe=ue).size[0]===1?1:fe.size[0]-2,ue.bind(te($),T.CLAMP_TO_EDGE)),this.painter.setupDepthForOcclusion(y&&y.useDepthForOcclusion,c,A),y&&y.useMeterToDem&&$){const me=(1<<$.tileID.canonical.z)*r.bD(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;A.u_meter_to_dem=me}if(y&&y.labelPlaneMatrixInv&&(A.u_label_plane_matrix_inv=y.labelPlaneMatrixInv),c.setTerrainUniformValues(S,A),this.painter.transform.projection.name==="globe"){const me=this.globeUniformValues(this.painter.transform,o.tileID.canonical,y&&y.useDenormalizedUpVectorScale);c.setGlobeUniformValues(S,me)}}globeUniformValues(o,c,y){const S=o.projection;return{u_tile_tl_up:S.upVector(c,0,0),u_tile_tr_up:S.upVector(c,r.ab,0),u_tile_br_up:S.upVector(c,r.ab,r.ab),u_tile_bl_up:S.upVector(c,0,r.ab),u_tile_up_scale:y?r.cG(1):S.upVectorScale(c,o.center.lat,o.worldSize).metersToTile}}renderToBackBuffer(o){const c=this.painter,y=this.painter.context;o.length!==0&&(y.bindFramebuffer.set(null),y.viewport.set([0,0,c.width,c.height]),c.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(S,T,A,$,Y){if(S.transform.projection.name==="globe")(function(ee,te,ue,fe,me){const ke=ee.context,Le=ke.gl;let De,Fe;const Ye=ee.transform,Je=r.cx(ee,ke,Ye),qe=(Ot,sn)=>{if(Fe===sn)return;const mn=[O1[sn],"PROJECTION_GLOBE_VIEW"];Je&&mn.push("CUSTOM_ANTIALIASING");const on=ee.isTileAffectedByFog(Ot);De=ee.getOrCreateProgram("globeRaster",{defines:mn,overrideFog:on}),Fe=sn},it=ee.colorModeForRenderPass(),rt=new cr(Le.LEQUAL,cr.ReadWrite,ee.depthRangeFor3D);Jh.update(me);const mt=r.cy(Ye),dt=[r.am(Ye.center.lng),r.at(Ye.center.lat)],yt=ee.globeSharedBuffers,Et=[Ye.width*r.q.devicePixelRatio,Ye.height*r.q.devicePixelRatio],bt=Float32Array.from(Ye.globeMatrix),vt={useDenormalizedUpVectorScale:!0};{const Ot=ee.transform,sn=D1(Ot.zoom,te.exaggeration(),te.sourceCache._source.tileSize);Fe=-1;const mn=Le.TRIANGLES;for(const on of fe){const Tn=ue.getTile(on),Dt=Dr.disabled,dn=te.prevTerrainTileForTile[on.key],cn=te.terrainTileForTile[on.key];R1(dn,cn)&&Jh.newMorphing(on.key,dn,cn,me,250),ke.activeTexture.set(Le.TEXTURE0),Tn.texture&&Tn.texture.bind(Le.LINEAR,Le.CLAMP_TO_EDGE);const In=Jh.getMorphValuesForProxy(on.key),An=In?1:0;In&&r.C(vt,{morphing:{srcDemTile:In.from,dstDemTile:In.to,phase:r.cw(In.phase)}});const pn=r.cz(on.canonical),_n=r.cA(pn.getCenter().lat),_r=r.cB(on.canonical,pn,_n,Ot.worldSize/Ot._pixelsPerMercatorPixel),Vn=r.b5(r.cC(on.canonical)),tr=L1(Ot.expandedFarZProjMatrix,bt,mt,Vn,r.a9(Ot.zoom),dt,Ot.frustumCorners.TL,Ot.frustumCorners.TR,Ot.frustumCorners.BR,Ot.frustumCorners.BL,Ot.globeCenterInViewSpace,Ot.globeRadius,Et,sn,Ot._farZ,_r);if(qe(on,An),De&&(te.setupElevationDraw(Tn,De,vt),ee.uploadCommonUniforms(ke,De,on.toUnwrapped()),yt)){const[zr,dr,Ir]=yt.getGridBuffers(_n,sn!==0);De.draw(ee,mn,rt,Dt,it,Mr.backCCW,tr,"globe_raster",zr,dr,Ir)}}}if(yt&&(ee.renderDefaultNorthPole||ee.renderDefaultSouthPole)){const Ot=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Je&&Ot.push("CUSTOM_ANTIALIASING"),De=ee.getOrCreateProgram("globeRaster",{defines:Ot});for(const sn of fe){const{x:mn,y:on,z:Tn}=sn.canonical,Dt=on===0,dn=on===(1<<Tn)-1,[cn,In,An,pn]=yt.getPoleBuffers(Tn,!1);if(pn&&(Dt||dn)){const _n=ue.getTile(sn);ke.activeTexture.set(Le.TEXTURE0),_n.texture&&_n.texture.bind(Le.LINEAR,Le.CLAMP_TO_EDGE);let _r=r.cD(Tn,mn,Ye);const Vn=r.b5(r.cC(sn.canonical)),tr=(zr,dr)=>zr.draw(ee,Le.TRIANGLES,rt,Dr.disabled,it,Mr.disabled,L1(Ye.expandedFarZProjMatrix,_r,_r,Vn,0,dt,Ye.frustumCorners.TL,Ye.frustumCorners.TR,Ye.frustumCorners.BR,Ye.frustumCorners.BL,Ye.globeCenterInViewSpace,Ye.globeRadius,Et,0,Ye._farZ),"globe_pole_raster",dr,An,pn);te.setupElevationDraw(_n,De,vt),ee.uploadCommonUniforms(ke,De,sn.toUnwrapped()),Dt&&ee.renderDefaultNorthPole&&tr(De,cn),dn&&ee.renderDefaultSouthPole&&(_r=r.a6.mat4.scale(r.a6.mat4.create(),_r,[1,-1,1]),tr(De,In))}}}})(S,T,A,$,Y);else{const ee=S.context,te=ee.gl;let ue,fe;const me=S.shadowRenderer,ke=zs(S,S.longestCutoffRange),Le=it=>{if(fe===it)return;const rt=[];rt.push(O1[it]),ke.shouldRenderCutoff&&rt.push("RENDER_CUTOFF"),ue=S.getOrCreateProgram("terrainRaster",{defines:rt}),fe=it},De=S.colorModeForRenderPass(),Fe=new cr(te.LEQUAL,cr.ReadWrite,S.depthRangeFor3D);Jh.update(Y);const Ye=S.transform,Je=D1(Ye.zoom,T.exaggeration(),T.sourceCache._source.tileSize);let qe=[0,0,0];if(me){const it=S.style.directionalLight,rt=S.style.ambientLight;it&&rt&&(qe=Bu(S.style,it,rt))}{fe=-1;const it=te.TRIANGLES,[rt,mt]=[T.gridIndexBuffer,T.gridSegments];for(const dt of $){const yt=A.getTile(dt),Et=Dr.disabled,bt=T.prevTerrainTileForTile[dt.key],vt=T.terrainTileForTile[dt.key];R1(bt,vt)&&Jh.newMorphing(dt.key,bt,vt,Y,250),ee.activeTexture.set(te.TEXTURE0),yt.texture&&yt.texture.bind(te.LINEAR,te.CLAMP_TO_EDGE);const Ot=Jh.getMorphValuesForProxy(dt.key),sn=Ot?1:0;let mn;Ot&&(mn={morphing:{srcDemTile:Ot.from,dstDemTile:Ot.to,phase:r.cw(Ot.phase)}});const on=tT(dt.projMatrix,V0(dt.canonical,Ye.renderWorldCopies)?Je/10:Je,qe);if(Le(sn),!ue)continue;T.setupElevationDraw(yt,ue,mn);const Tn=dt.toUnwrapped();me&&me.setupShadows(Tn,ue),S.uploadCommonUniforms(ee,ue,Tn,null,ke),ue.draw(S,it,Fe,Et,De,Mr.backCCW,on,"terrain_raster",T.gridBuffer,rt,mt)}}}}(c,this,this.proxySourceCache,o,this._updateTimestamp),this.renderingToTexture=!0,c.gpuTimingDeferredRenderEnd(),o.splice(0,o.length))}renderBatch(o){if(this._drapedRenderBatches.length===0)return o+1;this.renderingToTexture=!0;const c=this.painter,y=this.painter.context,S=this.proxySourceCache,T=this.proxiedCoords[S.id],A=this._drapedRenderBatches.shift(),$=c.style.order,Y=[];let ee=0;for(const te of T){const ue=S.getTileByID(te.proxyTileKey),fe=S.proxyCachedFBO[te.key]?S.proxyCachedFBO[te.key][o]:void 0,me=fe!==void 0?S.renderCache[fe]:this.pool[ee++],ke=fe!==void 0;if(ue.texture=me.tex,ke&&!me.dirty){Y.push(ue.tileID);continue}let Le;y.bindFramebuffer.set(me.fb.framebuffer),this.renderedToTile=!1,me.dirty&&(y.clear({color:r.bz.transparent,stencil:0}),me.dirty=!1);for(let De=A.start;De<=A.end;++De){const Fe=c.style._mergedLayers[$[De]];if(Fe.isHidden(c.transform.zoom))continue;const Ye=c.style.getLayerSourceCache(Fe),Je=Ye?this.proxyToSource[te.key][Ye.id]:[te];if(!Je)continue;const qe=Je;y.viewport.set([0,0,me.fb.width,me.fb.height]),Le!==(Ye?Ye.id:null)&&(this._setupStencil(me,Je,Fe,Ye),Le=Ye?Ye.id:null),c.renderLayer(c,Ye,Fe,qe)}if(this._drapedRenderBatches.length===0)for(const De of this._pendingGroundEffectLayers){const Fe=c.style._mergedLayers[$[De]];if(Fe.isHidden(c.transform.zoom))continue;const Ye=c.style.getLayerSourceCache(Fe),Je=Ye?this.proxyToSource[te.key][Ye.id]:[te];if(!Je)continue;const qe=Je;y.viewport.set([0,0,me.fb.width,me.fb.height]),Le!==(Ye?Ye.id:null)&&(this._setupStencil(me,Je,Fe,Ye),Le=Ye?Ye.id:null),c.renderLayer(c,Ye,Fe,qe)}this.renderedToTile?(me.dirty=!0,Y.push(ue.tileID)):ke||--ee,ee===5&&(ee=0,this.renderToBackBuffer(Y))}return this.renderToBackBuffer(Y),this.renderingToTexture=!1,y.bindFramebuffer.set(null),y.viewport.set([0,0,c.width,c.height]),A.end+1}postRender(){}isLayerOrderingCorrect(o){const c=o.order.length;let y=-1,S=c;for(let T=0;T<c;++T)this._style.isLayerDraped(o._mergedLayers[o.order[T]])?y=Math.max(y,T):S=Math.min(S,T);return S>y}getMinElevationBelowMSL(){let o=0;return this._visibleDemTiles.filter(c=>c.dem).forEach(c=>{o=Math.min(o,c.dem.tree.minimums[0])}),o===0?o:(o-30)*this._exaggeration}raycast(o,c,y){if(!this._visibleDemTiles)return null;const S=this._visibleDemTiles.filter(T=>T.dem).map(T=>{const A=T.tileID,$=1<<A.overscaledZ,{x:Y,y:ee}=A.canonical,te=Y/$,ue=(Y+1)/$,fe=ee/$,me=(ee+1)/$;return{minx:te,miny:fe,maxx:ue,maxy:me,t:T.dem.tree.raycastRoot(te,fe,ue,me,o,c,y),tile:T}});S.sort((T,A)=>(T.t!==null?T.t:Number.MAX_VALUE)-(A.t!==null?A.t:Number.MAX_VALUE));for(const T of S){if(T.t==null)return null;const A=T.tile.dem.tree.raycast(T.minx,T.miny,T.maxx,T.maxy,o,c,y);if(A!=null)return A}return null}_createFBO(){const o=this.painter.context,c=o.gl,y=this.drapeBufferSize;o.activeTexture.set(c.TEXTURE0);const S=new r.T(o,{width:y[0],height:y[1],data:null},c.RGBA8);S.bind(c.LINEAR,c.CLAMP_TO_EDGE);const T=o.createFramebuffer(y[0],y[1],!0,null);return T.colorAttachment.set(S.texture),T.depthAttachment=new Kh(o,T.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=o.createRenderbuffer(o.gl.DEPTH_STENCIL,y[0],y[1]),this._stencilRef=0,T.depthAttachment.set(this._sharedDepthStencil),o.clear({stencil:0})):T.depthAttachment.set(this._sharedDepthStencil),o.extTextureFilterAnisotropic&&c.texParameterf(c.TEXTURE_2D,o.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,o.extTextureFilterAnisotropicMax),{fb:T,tex:S,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const o in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[o].hasTransition())return!0;return this._style.order.some(o=>{const c=this._style._mergedLayers[o],y=c.isHidden(this.painter.transform.zoom);return c.type==="hillshade"||c.type==="custom"?!y&&c.shouldRedrape():!y&&c.hasTransition()})}_clearLineLayersFromRenderCache(){let o=!1;for(const y of this._style.getSources())if(y instanceof ei){o=!0;break}if(!o)return;const c={};for(let y=0;y<this._style.order.length;++y){const S=this._style._mergedLayers[this._style.order[y]],T=this._style.getLayerSourceCache(S);if(T&&!c[T.id]&&!S.isHidden(this.painter.transform.zoom)&&S.type==="line"&&S.widthExpression()instanceof r.a4){c[T.id]=!0;for(const A of this.proxyCoords){const $=this.proxyToSource[A.key][T.id];if($)for(const Y of $)this._clearRenderCacheForTile(T.id,Y)}}}}_clearRasterLayersFromRenderCache(){let o=!1;for(const y in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[y]._source instanceof Ji){o=!0;break}if(!o)return;const c={};for(let y=0;y<this._style.order.length;++y){const S=this._style._mergedLayers[this._style.order[y]],T=this._style.getLayerSourceCache(S);if(!T||c[T.id]||S.isHidden(this.painter.transform.zoom)||S.type!=="raster")continue;const A=S.paint.get("raster-fade-duration");for(const $ of this.proxyCoords){const Y=this.proxyToSource[$.key][T.id];if(Y)for(const ee of Y){const te=Xm(T.getTile(ee),T.findLoadedParent(ee,0),T,this.painter.transform,A);(te.opacity!==1||te.mix!==0)&&this._clearRenderCacheForTile(T.id,ee)}}}}_setupDrapedRenderBatches(){const o=this._style.order,c=o.length;if(c===0)return;const y=[];this._pendingGroundEffectLayers=[];let S,T=0,A=this._style._mergedLayers[o[T]];for(;!this._style.isLayerDraped(A)&&A.isHidden(this.painter.transform.zoom)&&++T<c;)A=this._style._mergedLayers[o[T]];for(;T<c;++T){const $=this._style._mergedLayers[o[T]];$.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped($)?S===void 0&&(S=T):($.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(T),S!==void 0&&(y.push({start:S,end:T-1}),S=void 0)))}if(S!==void 0&&y.push({start:S,end:T-1}),y.length!==0){const $=y[y.length-1];this._pendingGroundEffectLayers.every(Y=>Y>$.end)||r.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=y}_setupRenderCache(o){const c=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,c.renderCache.length>c.renderCachePool.length){const A=Object.values(c.proxyCachedFBO);c.proxyCachedFBO={};for(let $=0;$<A.length;++$){const Y=Object.values(A[$]);c.renderCachePool.push(...Y)}}return}this._clearRasterLayersFromRenderCache();const y=this.proxyCoords,S=this._tilesDirty;for(let A=y.length-1;A>=0;A--){const $=y[A];if(c.getTileByID($.key),c.proxyCachedFBO[$.key]!==void 0){const Y=o[$.key],ee=this.proxyToSource[$.key];let te=0;for(const ue in ee){const fe=ee[ue],me=Y[ue];if(!me||me.length!==fe.length||fe.some((ke,Le)=>ke!==me[Le]||S[ue]&&S[ue].hasOwnProperty(ke.key))){te=-1;break}++te}for(const ue in c.proxyCachedFBO[$.key])c.renderCache[c.proxyCachedFBO[$.key][ue]].dirty=te<0||te!==Object.values(Y).length}}const T=[...this._drapedRenderBatches];T.sort((A,$)=>$.end-$.start-(A.end-A.start));for(const A of T)for(const $ of y){if(c.proxyCachedFBO[$.key])continue;let Y=c.renderCachePool.pop();Y===void 0&&c.renderCache.length<50&&(Y=c.renderCache.length,c.renderCache.push(this._createFBO())),Y!==void 0&&(c.proxyCachedFBO[$.key]={},c.proxyCachedFBO[$.key][A.start]=Y,c.renderCache[Y].dirty=!0)}this._tilesDirty={}}_setupStencil(o,c,y,S){if(!S||!this._sourceTilesOverlap[S.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const T=this.painter.context,A=T.gl;if(c.length<=1)return void(this._overlapStencilType=!1);let $;if(y.isTileClipped())$=c.length,this._overlapStencilMode.test={func:A.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(c[0].overscaledZ>c[c.length-1].overscaledZ))return void(this._overlapStencilType=!1);$=1,this._overlapStencilMode.test={func:A.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+$>255&&(T.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=$,this._overlapStencilMode.ref=this._stencilRef,y.isTileClipped()&&this._renderTileClippingMasks(c,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(o){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[o.key]),this._overlapStencilMode):Dr.disabled}_renderTileClippingMasks(o,c){const y=this.painter,S=this.painter.context,T=S.gl;y._tileClippingMaskIDs={},S.setColorMode(Hr.disabled),S.setDepthMode(cr.disabled);const A=y.getOrCreateProgram("clippingMask");for(const $ of o){const Y=y._tileClippingMaskIDs[$.key]=--c;A.draw(y,T.TRIANGLES,cr.disabled,new Dr({func:T.ALWAYS,mask:0},Y,255,T.KEEP,T.KEEP,T.REPLACE),Hr.disabled,Mr.disabled,Ip($.projMatrix),"$clipping",y.tileExtentBuffer,y.quadTriangleIndexBuffer,y.tileExtentSegments)}}pointCoordinate(o){const c=this.painter.transform;if(o.x<0||o.x>c.width||o.y<0||o.y>c.height)return null;const y=[o.x,o.y,1,1];r.a6.vec4.transformMat4(y,y,c.pixelMatrixInverse),r.a6.vec4.scale(y,y,1/y[3]),y[0]/=c.worldSize,y[1]/=c.worldSize;const S=c._camera.position,T=r.bD(1,c.center.lat),A=[S[0],S[1],S[2]/T,0],$=r.a6.vec3.subtract([],y.slice(0,3),A);r.a6.vec3.normalize($,$);const Y=this.raycast(A,$,this._exaggeration);return Y!==null&&Y?(r.a6.vec3.scaleAndAdd(A,A,$,Y),A[3]=A[2],A[2]*=T,A):null}_setupProxiedCoordsForOrtho(o,c,y){if(o.getSource()instanceof r.aD)return this._setupProxiedCoordsForImageSource(o,c,y);this._findCoveringTileCache[o.id]=this._findCoveringTileCache[o.id]||{};const S=this.proxiedCoords[o.id]=[],T=this.proxyCoords;for(let Y=0;Y<T.length;Y++){const ee=T[Y],te=this._findTileCoveringTileID(ee,o);if(te){const ue=this._createProxiedId(ee,te,y[ee.key]&&y[ee.key][o.id]);S.push(ue),this.proxyToSource[ee.key][o.id]=[ue]}}let A=!1;const $=new Set;for(let Y=0;Y<c.length;Y++){const ee=o.getTile(c[Y]);if(!ee||!ee.hasData())continue;const te=this._findTileCoveringTileID(ee.tileID,this.proxySourceCache);if(te&&te.tileID.canonical.z!==ee.tileID.canonical.z){const ue=this.proxyToSource[te.tileID.key][o.id],fe=this._createProxiedId(te.tileID,ee,y[te.tileID.key]&&y[te.tileID.key][o.id]);ue?ue.splice(ue.length-1,0,fe):this.proxyToSource[te.tileID.key][o.id]=[fe];const me=this.proxyToSource[te.tileID.key][o.id];$.has(me)||$.add(me),S.push(fe),A=!0}}if(this._sourceTilesOverlap[o.id]=A,A&&this._debugParams.sortTilesHiZFirst)for(const Y of $)Y.sort((ee,te)=>te.overscaledZ-ee.overscaledZ)}_setupProxiedCoordsForImageSource(o,c,y){if(!o.getSource().loaded())return;const S=this.proxiedCoords[o.id]=[],T=this.proxyCoords,A=o.getSource(),$=A.tileID;if(!$)return;const Y=new r.P($.x,$.y)._div(1<<$.z),ee=A.coordinates.map(r.a5.fromLngLat).reduce((ue,fe)=>(ue.min.x=Math.min(ue.min.x,fe.x-Y.x),ue.min.y=Math.min(ue.min.y,fe.y-Y.y),ue.max.x=Math.max(ue.max.x,fe.x-Y.x),ue.max.y=Math.max(ue.max.y,fe.y-Y.y),ue),{min:new r.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new r.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),te=(ue,fe)=>{const me=ue.wrap+ue.canonical.x/(1<<ue.canonical.z),ke=ue.canonical.y/(1<<ue.canonical.z),Le=r.ab/(1<<ue.canonical.z),De=fe.wrap+fe.canonical.x/(1<<fe.canonical.z),Fe=fe.canonical.y/(1<<fe.canonical.z);return me+Le<De+ee.min.x||me>De+ee.max.x||ke+Le<Fe+ee.min.y||ke>Fe+ee.max.y};for(let ue=0;ue<T.length;ue++){const fe=T[ue];for(let me=0;me<c.length;me++){const ke=o.getTile(c[me]);if(!ke||!ke.hasData()||te(fe,ke.tileID))continue;const Le=this._createProxiedId(fe,ke,y[fe.key]&&y[fe.key][o.id]),De=this.proxyToSource[fe.key][o.id];De?De.push(Le):this.proxyToSource[fe.key][o.id]=[Le],S.push(Le)}}}_createProxiedId(o,c,y){let S=this.orthoMatrix;if(y){const T=y.find(A=>A.key===c.tileID.key);if(T)return T}if(c.tileID.key!==o.key){const T=o.canonical.z-c.tileID.canonical.z;let A,$,Y;S=r.a6.mat4.create();const ee=c.tileID.wrap-o.wrap<<o.overscaledZ;T>0?(A=r.ab>>T,$=A*((c.tileID.canonical.x<<T)-o.canonical.x+ee),Y=A*((c.tileID.canonical.y<<T)-o.canonical.y)):(A=r.ab<<-T,$=r.ab*(c.tileID.canonical.x-(o.canonical.x+ee<<-T)),Y=r.ab*(c.tileID.canonical.y-(o.canonical.y<<-T))),r.a6.mat4.ortho(S,0,A,0,A,0,1),r.a6.mat4.translate(S,S,[$,Y,0])}return new $0(c.tileID,o.key,S)}_findTileCoveringTileID(o,c){let y=c.getTile(o);if(y&&y.hasData())return y;const S=this._findCoveringTileCache[c.id],T=S[o.key];if(y=T?c.getTileByID(T):null,y&&y.hasData()||T===null)return y;let A=y?y.tileID:o,$=A.overscaledZ;const Y=c.getSource().minzoom,ee=[];if(!T){const ue=c.getSource().maxzoom;if(o.canonical.z>=ue){const fe=o.canonical.z-ue;c.getSource().reparseOverscaled?($=Math.max(o.canonical.z+2,c.transform.tileZoom),A=new r.aA($,o.wrap,ue,o.canonical.x>>fe,o.canonical.y>>fe)):fe!==0&&($=ue,A=new r.aA($,o.wrap,ue,o.canonical.x>>fe,o.canonical.y>>fe))}A.key!==o.key&&(ee.push(A.key),y=c.getTile(A))}const te=ue=>{ee.forEach(fe=>{S[fe]=ue}),ee.length=0};for($-=1;$>=Y&&(!y||!y.hasData());$--){y&&te(y.tileID.key);const ue=A.calculateScaledKey($);if(y=c.getTileByID(ue),y&&y.hasData())break;const fe=S[ue];if(fe===null)break;fe===void 0?ee.push(ue):y=c.getTileByID(fe)}return te(y?y.tileID.key:null),y&&y.hasData()?y:null}findDEMTileFor(o){return this.enabled?this._findTileCoveringTileID(o,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(o,c){let y=this._tilesDirty[o];y||(y=this._tilesDirty[o]={}),y[c.key]=!0}}function G0(g,o,c){const y=function($,Y,ee){const te=r.a6.vec3.dot(Y,$),ue=r.a6.vec3.dot(ee,[.2126,.7152,.0722]),fe=(ke,Le,De)=>(1-De)*ke+De*Le,me=fe(1-.3*Math.min(ue,1),1,Math.min(te+1,1));return fe(.92,1,Math.asin(r.ap(Y[2],-1,1))/Math.PI+.5)*me}(g,[0,0,1],o),S=[0,0,0];r.a6.vec3.scale(S,c.slice(0,3),y);const T=[0,0,0];r.a6.vec3.scale(T,o.slice(0,3),g[2]);const A=[0,0,0];return r.a6.vec3.add(A,S,T),r.cb(A)}const ih=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],F1=["stars","fillExtrusion","fillExtrusionGroundEffect","model","symbol"];class md{static cacheKey(o,c,y,S){let T=`${c}${S?S.cacheKey:""}`;for(const A of y)o.usedDefines.includes(A)&&(T+=`/${A}`);return T}constructor(o,c,y,S,T,A){const $=o.gl;this.program=$.createProgram(),this.configuration=S,this.name=c,this.fixedDefines=[...A];const Y=S?S.getBinderAttributes():[],ee=(y.staticAttributes||[]).concat(Y);let te=S?S.defines():[];te=te.concat(A.map(De=>`#define ${De}`));const ue=`#version 300 es
`;let fe=ue+te.concat("precision mediump float;",or,En.fragmentSource).join(`
`);for(const De of y.fragmentIncludes)fe+=`
${Ft[De]}`;fe+=`
${y.fragmentSource}`;let me=ue+te.concat("precision highp float;",or,En.vertexSource).join(`
`);for(const De of y.vertexIncludes)me+=`
${Ft[De]}`;me+=`
${y.vertexSource}`;const ke=$.createShader($.FRAGMENT_SHADER);if($.isContextLost())return void(this.failedToCreate=!0);$.shaderSource(ke,fe),$.compileShader(ke),$.attachShader(this.program,ke);const Le=$.createShader($.VERTEX_SHADER);if($.isContextLost())this.failedToCreate=!0;else{$.shaderSource(Le,me),$.compileShader(Le),$.attachShader(this.program,Le),this.attributes={},this.numAttributes=ee.length;for(let De=0;De<this.numAttributes;De++)if(ee[De]){const Fe=ee[De].startsWith("a_")?ee[De]:`a_${ee[De]}`;$.bindAttribLocation(this.program,De,Fe),this.attributes[Fe]=De}$.linkProgram(this.program),$.deleteShader(Le),$.deleteShader(ke),this.fixedUniforms=T(o),this.binderUniforms=S?S.getUniforms(o):[],(A.includes("TERRAIN")||c.indexOf("symbol")!==-1||c.indexOf("circle")!==-1)&&(this.terrainUniforms=(De=>({u_dem:new r.bJ(De),u_dem_prev:new r.bJ(De),u_dem_tl:new r.bG(De),u_dem_scale:new r.bI(De),u_dem_tl_prev:new r.bG(De),u_dem_scale_prev:new r.bI(De),u_dem_size:new r.bI(De),u_dem_lerp:new r.bI(De),u_exaggeration:new r.bI(De),u_depth:new r.bJ(De),u_depth_size_inv:new r.bG(De),u_depth_range_unpack:new r.bG(De),u_occluder_half_size:new r.bI(De),u_occlusion_depth_offset:new r.bI(De),u_meter_to_dem:new r.bI(De),u_label_plane_matrix_inv:new r.bF(De)}))(o)),A.includes("GLOBE")&&(this.globeUniforms=(De=>({u_tile_tl_up:new r.bH(De),u_tile_tr_up:new r.bH(De),u_tile_br_up:new r.bH(De),u_tile_bl_up:new r.bH(De),u_tile_up_scale:new r.bI(De)}))(o)),A.includes("FOG")&&(this.fogUniforms=(De=>({u_fog_matrix:new r.bF(De),u_fog_range:new r.bG(De),u_fog_color:new r.c6(De),u_fog_horizon_blend:new r.bI(De),u_fog_vertical_limit:new r.bG(De),u_fog_temporal_offset:new r.bI(De),u_frustum_tl:new r.bH(De),u_frustum_tr:new r.bH(De),u_frustum_br:new r.bH(De),u_frustum_bl:new r.bH(De),u_globe_pos:new r.bH(De),u_globe_radius:new r.bI(De),u_globe_transition:new r.bI(De),u_is_globe:new r.bJ(De),u_viewport:new r.bG(De)}))(o)),A.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(De=>({u_cutoff_params:new r.c6(De)}))(o)),A.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(De=>({u_lighting_ambient_color:new r.bH(De),u_lighting_directional_dir:new r.bH(De),u_lighting_directional_color:new r.bH(De),u_ground_radiance:new r.bH(De)}))(o)),A.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(De=>({u_light_matrix_0:new r.bF(De),u_light_matrix_1:new r.bF(De),u_fade_range:new r.bG(De),u_shadow_normal_offset:new r.bH(De),u_shadow_intensity:new r.bI(De),u_shadow_texel_size:new r.bI(De),u_shadow_map_resolution:new r.bI(De),u_shadow_direction:new r.bH(De),u_shadow_bias:new r.bH(De),u_shadowmap_0:new r.bJ(De),u_shadowmap_1:new r.bJ(De)}))(o))}}setTerrainUniformValues(o,c){if(!this.terrainUniforms)return;const y=this.terrainUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const S in c)y[S]&&y[S].set(this.program,S,c[S])}}setGlobeUniformValues(o,c){if(!this.globeUniforms)return;const y=this.globeUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const S in c)y[S]&&y[S].set(this.program,S,c[S])}}setFogUniformValues(o,c){if(!this.fogUniforms)return;const y=this.fogUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const S in c)y[S].set(this.program,S,c[S])}}setCutoffUniformValues(o,c){if(!this.cutoffUniforms)return;const y=this.cutoffUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const S in c)y[S].set(this.program,S,c[S])}}setLightsUniformValues(o,c){if(!this.lightsUniforms)return;const y=this.lightsUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const S in c)y[S].set(this.program,S,c[S])}}setShadowUniformValues(o,c){if(this.failedToCreate||!this.shadowUniforms)return;const y=this.shadowUniforms;o.program.set(this.program);for(const S in c)y[S].set(this.program,S,c[S])}_drawDebugWireframe(o,c,y,S,T,A,$,Y,ee,te){const ue=o.options.wireframe;if(ue.terrain===!1&&ue.layers2D===!1&&ue.layers3D===!1)return;const fe=o.context;if(!(!(!ue.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!ue.layers2D||o._terrain&&o._terrain.renderingToTexture||!ih.includes(this.name))||!(!ue.layers3D||!F1.includes(this.name))))return;const me=fe.gl,ke=o.wireframeDebugCache.getLinesFromTrianglesBuffer(o.frameCounter,T,fe);if(!ke)return;const Le=[...this.fixedDefines];Le.push("DEBUG_WIREFRAME");const De=o.getOrCreateProgram(this.name,{config:this.configuration,defines:Le});fe.program.set(De.program);const Fe=(qe,it,rt)=>{if(it[qe]&&rt[qe])for(const mt in it[qe])rt[qe][mt]&&rt[qe][mt].set(rt.program,mt,it[qe][mt].current)};ee&&ee.setUniforms(De.program,fe,De.binderUniforms,$,{zoom:Y}),Fe("fixedUniforms",this,De),Fe("terrainUniforms",this,De),Fe("globeUniforms",this,De),Fe("fogUniforms",this,De),Fe("lightsUniforms",this,De),Fe("shadowUniforms",this,De),ke.bind(),fe.setColorMode(new Hr([me.ONE,me.ONE_MINUS_SRC_ALPHA,me.ZERO,me.ONE],r.bz.transparent,[!0,!0,!0,!1])),fe.setDepthMode(new cr(c.func===me.LESS?me.LEQUAL:c.func,cr.ReadOnly,c.range)),fe.setStencilMode(Dr.disabled);const Ye=3*A.primitiveLength*2,Je=3*A.primitiveOffset*2*2;te&&te>1?me.drawElementsInstanced(me.LINES,Ye,me.UNSIGNED_SHORT,Je,te):me.drawElements(me.LINES,Ye,me.UNSIGNED_SHORT,Je),T.bind(),fe.program.set(this.program),fe.setDepthMode(c),fe.setStencilMode(y),fe.setColorMode(S)}draw(o,c,y,S,T,A,$,Y,ee,te,ue,fe,me,ke,Le,De){const Fe=o.context,Ye=Fe.gl;if(this.failedToCreate)return;Fe.program.set(this.program),Fe.setDepthMode(y),Fe.setStencilMode(S),Fe.setColorMode(T),Fe.setCullFace(A);for(const it of Object.keys(this.fixedUniforms))this.fixedUniforms[it].set(this.program,it,$[it]);ke&&ke.setUniforms(this.program,Fe,this.binderUniforms,fe,{zoom:me});const Je={[Ye.POINTS]:1,[Ye.LINES]:2,[Ye.TRIANGLES]:3,[Ye.LINE_STRIP]:1}[c],qe=De&&De>0?1:void 0;for(const it of ue.get()){const rt=it.vaos||(it.vaos={});(rt[Y]||(rt[Y]=new wr)).bind(Fe,this,ee,ke?ke.getPaintVertexBuffers():[],te,it.vertexOffset,Le||[],qe),De&&De>1?Ye.drawElementsInstanced(c,it.primitiveLength*Je,Ye.UNSIGNED_SHORT,it.primitiveOffset*Je*2,De):te?Ye.drawElements(c,it.primitiveLength*Je,Ye.UNSIGNED_SHORT,it.primitiveOffset*Je*2):Ye.drawArrays(c,it.vertexOffset,it.vertexLength),c===Ye.TRIANGLES&&te&&this._drawDebugWireframe(o,y,S,T,te,it,fe,me,ke,De)}}}function H0(g,o){const c=Math.pow(2,o.tileID.overscaledZ),y=o.tileSize*Math.pow(2,g.transform.tileZoom)/c,S=y*(o.tileID.canonical.x+o.tileID.wrap*c),T=y*o.tileID.canonical.y;return{u_image:0,u_texsize:o.imageAtlasTexture?o.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/r.ak(o,1,g.transform.tileZoom),u_pixel_coord_upper:[S>>16,T>>16],u_pixel_coord_lower:[65535&S,65535&T]}}const Ym=r.a6.mat4.create(),W0=(g,o,c,y,S,T,A,$,Y,ee,te,ue,fe,me,ke,Le)=>{const De=o.style.light,Fe=De.properties.get("position"),Ye=[Fe.x,Fe.y,Fe.z],Je=r.a6.mat3.create();De.properties.get("anchor")==="viewport"&&(r.a6.mat3.fromRotation(Je,-o.transform.angle),r.a6.vec3.transformMat3(Ye,Ye,Je));const qe=De.properties.get("color"),it=o.transform,rt={u_matrix:g,u_lightpos:Ye,u_lightintensity:De.properties.get("intensity"),u_lightcolor:[qe.r,qe.g,qe.b],u_vertical_gradient:+c,u_opacity:y,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Ym,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:S,u_edge_radius:T,u_width_scale:A,u_flood_light_color:fe,u_vertical_scale:me,u_flood_light_intensity:ke,u_ground_shadow_factor:Le};return it.projection.name==="globe"&&(rt.u_tile_id=[$.canonical.x,$.canonical.y,1<<$.canonical.z],rt.u_zoom_transition=ee,rt.u_inv_rot_matrix=ue,rt.u_merc_center=te,rt.u_up_dir=it.projection.upVector(new r.bP(0,0,0),te[0]*r.ab,te[1]*r.ab),rt.u_height_lift=Y),rt},N1=(g,o,c,y)=>({u_matrix:g,u_edge_radius:o,u_width_scale:c,u_vertical_scale:y}),q0=(g,o,c,y,S,T,A,$,Y,ee,te,ue,fe,me,ke)=>{const Le=W0(g,o,c,y,S,T,A,$,ee,te,ue,fe,me,ke,1,[0,0,0]),De={u_height_factor:-Math.pow(2,$.overscaledZ)/Y.tileSize/8};return r.l(Le,H0(o,Y),De)},Zm=(g,o)=>({u_matrix:g,u_emissive_strength:o}),B1=(g,o,c,y)=>r.l(Zm(g,o),H0(c,y)),j1=(g,o,c)=>({u_matrix:g,u_world:c,u_emissive_strength:o}),kp=(g,o,c,y,S)=>r.l(B1(g,o,c,y),{u_world:S}),nT=(g,o,c,y)=>{const S=r.ab/c.tileSize;return{u_matrix:g,u_camera_to_center_distance:o.getCameraToCenterDistance(y),u_extrude_scale:[o.pixelsToGLUnits[0]/S,o.pixelsToGLUnits[1]/S]}},V1=(g,o,c=1)=>({u_matrix:g,u_color:o.toRenderColor(null),u_overlay:0,u_overlay_scale:c}),$1=r.a6.mat4.create(),rT=(g,o,c,y,S,T,A)=>{const $=g.transform,Y=$.projection.name==="globe",ee=Y?r.cI($.zoom,o.canonical)*$._pixelsPerMercatorPixel:r.ak(c,1,T),te={u_matrix:o.projMatrix,u_extrude_scale:ee,u_intensity:A,u_inv_rot_matrix:$1,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(Y){te.u_inv_rot_matrix=y,te.u_merc_center=S,te.u_tile_id=[o.canonical.x,o.canonical.y,1<<o.canonical.z],te.u_zoom_transition=r.a9($.zoom);const ue=S[0]*r.ab,fe=S[1]*r.ab;te.u_up_dir=$.projection.upVector(new r.bP(0,0,0),ue,fe)}return te};function Km(g,[o,c,y,S],[T,A]){if(T===A)return[0,0,0,0];const $=255*(g-1)/(g*(A-T));return[o*$,c*$,y*$,S*$]}function Jm(g,o,[c,y]){return c===y?0:.5/g+(o-c)*(g-1)/(g*(y-c))}const Mp=(g,o,c,y,S,T,A,$,Y,ee,te,ue,fe,me,ke,Le,De,Fe,Ye,Je,qe)=>({u_matrix:g,u_normalize_matrix:o,u_globe_matrix:c,u_merc_matrix:y,u_grid_matrix:S,u_tl_parent:T,u_scale_parent:ee,u_fade_t:te.mix,u_opacity:te.opacity*ue.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:ue.paint.get("raster-brightness-min"),u_brightness_high:ue.paint.get("raster-brightness-max"),u_saturation_factor:r.cJ(ue.paint.get("raster-saturation")),u_contrast_factor:r.cK(ue.paint.get("raster-contrast")),u_spin_weights:X0(ue.paint.get("raster-hue-rotate")),u_perspective_transform:fe,u_raster_elevation:me,u_zoom_transition:A,u_merc_center:$,u_cutoff_params:Y,u_colorization_mix:Km(r.cL,Le,Fe),u_colorization_offset:Jm(r.cL,De,Fe),u_color_ramp:ke,u_texture_offset:[Je/(Ye+2*Je),Ye/(Ye+2*Je)],u_texture_res:[Ye+2*Je,Ye+2*Je],u_emissive_strength:qe});function X0(g){g*=Math.PI/180;const o=Math.sin(g),c=Math.cos(g);return[(2*c+1)/3,(-Math.sqrt(3)*o-c+1)/3,(Math.sqrt(3)*o-c+1)/3]}const $u=.05,U1=(g,o,c,y,S,T,A,$,Y,ee,te,ue)=>({u_matrix:g,u_normalize_matrix:o,u_globe_matrix:c,u_merc_matrix:y,u_grid_matrix:S,u_tl_parent:T,u_scale_parent:ee,u_fade_t:te.mix,u_opacity:te.opacity,u_image0:0,u_image1:1,u_raster_elevation:ue,u_zoom_transition:A,u_merc_center:$,u_cutoff_params:Y}),Qm=(g,o,c,y,S,T,A,$,Y,ee)=>({u_particle_texture:g,u_particle_texture_side_len:o,u_tile_offset:c,u_velocity:y,u_color_ramp:T,u_velocity_res:S,u_max_speed:A,u_uv_offset:$,u_data_scale:[255*Y[0],255*Y[1]],u_data_offset:ee,u_particle_pos_scale:1.1,u_particle_pos_offset:[$u,$u]}),eg=(g,o,c,y,S,T,A,$,Y,ee)=>({u_particle_texture:g,u_particle_texture_side_len:o,u_velocity:c,u_velocity_res:y,u_max_speed:S,u_speed_factor:T,u_reset_rate:A,u_rand_seed:Math.random(),u_uv_offset:$,u_data_scale:[255*Y[0],255*Y[1]],u_data_offset:ee,u_particle_pos_scale:1.1,u_particle_pos_offset:[$u,$u]}),tg=r.a6.mat4.create(),Y0=(g,o,c,y,S,T,A,$,Y,ee,te,ue,fe,me,ke,Le,De,Fe,Ye,Je,qe)=>{const it=S.transform,rt={u_is_size_zoom_constant:+(g==="constant"||g==="source"),u_is_size_feature_constant:+(g==="constant"||g==="camera"),u_size_t:o?o.uSizeT:0,u_size:o?o.uSize:0,u_camera_to_center_distance:it.getCameraToCenterDistance(Ye),u_rotate_symbol:+c,u_aspect_ratio:it.width/it.height,u_fade_change:S.options.fadeDuration?S.symbolFadeChange:1,u_matrix:T,u_label_plane_matrix:A,u_coord_matrix:$,u_is_text:+ee,u_elevation_from_sea:Y?1:0,u_pitch_with_map:+y,u_texsize:te,u_texsize_icon:ue,u_texture:0,u_texture_icon:1,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:tg,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:tg,u_up_vector:[0,-1,0],u_color_adj_mat:Je,u_icon_transition:qe||0,u_gamma_scale:y?S.transform.getCameraToCenterDistance(Ye)*Math.cos(S.terrain?0:S.transform._pitch):1,u_device_pixel_ratio:r.q.devicePixelRatio,u_is_halo:+fe};return Ye.name==="globe"&&(rt.u_tile_id=[me.canonical.x,me.canonical.y,1<<me.canonical.z],rt.u_zoom_transition=ke,rt.u_inv_rot_matrix=De,rt.u_merc_center=Le,rt.u_camera_forward=it._camera.forward(),rt.u_ecef_origin=r.cM(it.globeMatrix,me.toUnwrapped()),rt.u_tile_matrix=Float32Array.from(it.globeMatrix),rt.u_up_vector=Fe),rt},G1=(g,o,c,y)=>({u_matrix:g,u_emissive_strength:o,u_opacity:c,u_color:y}),oh=(g,o,c,y,S,T,A,$,Y)=>r.l(function(ee,te,ue,fe,me,ke){const{width:Le,height:De}=fe.imageManager.getPixelSize(te),Fe=Math.pow(2,ke.tileID.overscaledZ),Ye=ke.tileSize*Math.pow(2,fe.transform.tileZoom)/Fe,Je=Ye*(ke.tileID.canonical.x+ke.tileID.wrap*Fe),qe=Ye*ke.tileID.canonical.y;return{u_image:0,u_pattern_tl:ue.tl,u_pattern_br:ue.br,u_texsize:[Le,De],u_pattern_size:ue.displaySize,u_pattern_units_to_pixels:me?[fe.transform.width,-1*fe.transform.height]:[1/r.ak(ke,1,fe.transform.tileZoom),1/r.ak(ke,1,fe.transform.tileZoom)],u_pixel_coord_upper:[Je>>16,qe>>16],u_pixel_coord_lower:[65535&Je,65535&qe]}}(0,T,A,y,$,Y),{u_matrix:g,u_emissive_strength:o,u_opacity:c}),ef=new Float32Array(r.a6.mat4.identity([])),ir=(g,o,c,y,S,T,A,$,Y,ee,te,ue,fe,me=[0,0,0],ke)=>{const Le=S.style.light,De=Le.properties.get("position"),Fe=[-De.x,-De.y,De.z],Ye=r.a6.mat3.create();Le.properties.get("anchor")==="viewport"&&(r.a6.mat3.fromRotation(Ye,-S.transform.angle),r.a6.vec3.transformMat3(Fe,Fe,Ye));const Je=te.alphaMode==="MASK",qe=Le.properties.get("color").toRenderColor(null),it=fe.paint.get("model-ambient-occlusion-intensity"),rt=fe.paint.get("model-color").constantOr(r.bz.white).toRenderColor(null),mt=fe.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:g,u_lighting_matrix:o,u_normal_matrix:c,u_node_matrix:y||ef,u_lightpos:Fe,u_lightintensity:Le.properties.get("intensity"),u_lightcolor:[qe.r,qe.g,qe.b],u_camera_pos:me,u_opacity:T,u_baseTextureIsAlpha:0,u_alphaMask:+Je,u_alphaCutoff:te.alphaCutoff,u_baseColorFactor:[A.r,A.g,A.b,A.a],u_emissiveFactor:[$[0],$[1],$[2],1],u_metallicFactor:Y,u_roughnessFactor:ee,u_baseColorTexture:cs.BaseColor,u_metallicRoughnessTexture:cs.MetallicRoughness,u_normalTexture:cs.Normal,u_occlusionTexture:cs.Occlusion,u_emissionTexture:cs.Emission,u_lutTexture:cs.LUT,u_color_mix:[rt.r,rt.g,rt.b,mt],u_aoIntensity:it,u_emissive_strength:ue,u_occlusionTextureTransform:ke||[0,0,0,0]}},Z0=(g,o=ef,c=ef)=>({u_matrix:g,u_instance:o,u_node_matrix:c}),H1={fillExtrusion:g=>({u_matrix:new r.bF(g),u_lightpos:new r.bH(g),u_lightintensity:new r.bI(g),u_lightcolor:new r.bH(g),u_vertical_gradient:new r.bI(g),u_opacity:new r.bI(g),u_edge_radius:new r.bI(g),u_width_scale:new r.bI(g),u_ao:new r.bG(g),u_tile_id:new r.bH(g),u_zoom_transition:new r.bI(g),u_inv_rot_matrix:new r.bF(g),u_merc_center:new r.bG(g),u_up_dir:new r.bH(g),u_height_lift:new r.bI(g),u_flood_light_color:new r.bH(g),u_vertical_scale:new r.bI(g),u_flood_light_intensity:new r.bI(g),u_ground_shadow_factor:new r.bH(g)}),fillExtrusionDepth:g=>({u_matrix:new r.bF(g),u_edge_radius:new r.bI(g),u_width_scale:new r.bI(g),u_vertical_scale:new r.bI(g)}),fillExtrusionPattern:g=>({u_matrix:new r.bF(g),u_lightpos:new r.bH(g),u_lightintensity:new r.bI(g),u_lightcolor:new r.bH(g),u_vertical_gradient:new r.bI(g),u_height_factor:new r.bI(g),u_edge_radius:new r.bI(g),u_width_scale:new r.bI(g),u_ao:new r.bG(g),u_tile_id:new r.bH(g),u_zoom_transition:new r.bI(g),u_inv_rot_matrix:new r.bF(g),u_merc_center:new r.bG(g),u_up_dir:new r.bH(g),u_height_lift:new r.bI(g),u_image:new r.bJ(g),u_texsize:new r.bG(g),u_pixel_coord_upper:new r.bG(g),u_pixel_coord_lower:new r.bG(g),u_tile_units_to_pixels:new r.bI(g),u_opacity:new r.bI(g)}),fillExtrusionGroundEffect:g=>({u_matrix:new r.bF(g),u_opacity:new r.bI(g),u_ao_pass:new r.bI(g),u_meter_to_tile:new r.bI(g),u_ao:new r.bG(g),u_flood_light_intensity:new r.bI(g),u_flood_light_color:new r.bH(g),u_attenuation:new r.bI(g),u_edge_radius:new r.bI(g),u_fb:new r.bJ(g),u_fb_size:new r.bI(g),u_dynamic_offset:new r.bI(g)}),fill:g=>({u_matrix:new r.bF(g),u_emissive_strength:new r.bI(g)}),fillPattern:g=>({u_matrix:new r.bF(g),u_emissive_strength:new r.bI(g),u_image:new r.bJ(g),u_texsize:new r.bG(g),u_pixel_coord_upper:new r.bG(g),u_pixel_coord_lower:new r.bG(g),u_tile_units_to_pixels:new r.bI(g)}),fillOutline:g=>({u_matrix:new r.bF(g),u_emissive_strength:new r.bI(g),u_world:new r.bG(g)}),fillOutlinePattern:g=>({u_matrix:new r.bF(g),u_emissive_strength:new r.bI(g),u_world:new r.bG(g),u_image:new r.bJ(g),u_texsize:new r.bG(g),u_pixel_coord_upper:new r.bG(g),u_pixel_coord_lower:new r.bG(g),u_tile_units_to_pixels:new r.bI(g)}),circle:r.cN,collisionBox:g=>({u_matrix:new r.bF(g),u_camera_to_center_distance:new r.bI(g),u_extrude_scale:new r.bG(g)}),collisionCircle:g=>({u_matrix:new r.bF(g),u_inv_matrix:new r.bF(g),u_camera_to_center_distance:new r.bI(g),u_viewport_size:new r.bG(g)}),debug:g=>({u_color:new r.cu(g),u_matrix:new r.bF(g),u_overlay:new r.bJ(g),u_overlay_scale:new r.bI(g)}),clippingMask:g=>({u_matrix:new r.bF(g)}),heatmap:g=>({u_extrude_scale:new r.bI(g),u_intensity:new r.bI(g),u_matrix:new r.bF(g),u_inv_rot_matrix:new r.bF(g),u_merc_center:new r.bG(g),u_tile_id:new r.bH(g),u_zoom_transition:new r.bI(g),u_up_dir:new r.bH(g)}),heatmapTexture:g=>({u_image:new r.bJ(g),u_color_ramp:new r.bJ(g),u_opacity:new r.bI(g)}),hillshade:g=>({u_matrix:new r.bF(g),u_image:new r.bJ(g),u_latrange:new r.bG(g),u_light:new r.bG(g),u_shadow:new r.cu(g),u_highlight:new r.cu(g),u_emissive_strength:new r.bI(g),u_accent:new r.cu(g)}),hillshadePrepare:g=>({u_matrix:new r.bF(g),u_image:new r.bJ(g),u_dimension:new r.bG(g),u_zoom:new r.bI(g)}),line:r.cO,linePattern:r.cP,raster:g=>({u_matrix:new r.bF(g),u_normalize_matrix:new r.bF(g),u_globe_matrix:new r.bF(g),u_merc_matrix:new r.bF(g),u_grid_matrix:new r.cv(g),u_tl_parent:new r.bG(g),u_scale_parent:new r.bI(g),u_fade_t:new r.bI(g),u_opacity:new r.bI(g),u_image0:new r.bJ(g),u_image1:new r.bJ(g),u_brightness_low:new r.bI(g),u_brightness_high:new r.bI(g),u_saturation_factor:new r.bI(g),u_contrast_factor:new r.bI(g),u_spin_weights:new r.bH(g),u_perspective_transform:new r.bG(g),u_raster_elevation:new r.bI(g),u_zoom_transition:new r.bI(g),u_merc_center:new r.bG(g),u_cutoff_params:new r.c6(g),u_colorization_mix:new r.c6(g),u_colorization_offset:new r.bI(g),u_color_ramp:new r.bJ(g),u_texture_offset:new r.bG(g),u_texture_res:new r.bG(g),u_emissive_strength:new r.bI(g)}),rasterParticle:g=>({u_matrix:new r.bF(g),u_normalize_matrix:new r.bF(g),u_globe_matrix:new r.bF(g),u_merc_matrix:new r.bF(g),u_grid_matrix:new r.cv(g),u_tl_parent:new r.bG(g),u_scale_parent:new r.bI(g),u_fade_t:new r.bI(g),u_opacity:new r.bI(g),u_image0:new r.bJ(g),u_image1:new r.bJ(g),u_raster_elevation:new r.bI(g),u_zoom_transition:new r.bI(g),u_merc_center:new r.bG(g),u_cutoff_params:new r.c6(g)}),rasterParticleTexture:g=>({u_texture:new r.bJ(g),u_opacity:new r.bI(g)}),rasterParticleDraw:g=>({u_particle_texture:new r.bJ(g),u_particle_texture_side_len:new r.bI(g),u_tile_offset:new r.bG(g),u_velocity:new r.bJ(g),u_color_ramp:new r.bJ(g),u_velocity_res:new r.bG(g),u_max_speed:new r.bI(g),u_uv_offset:new r.bG(g),u_data_scale:new r.bG(g),u_data_offset:new r.bI(g),u_particle_pos_scale:new r.bI(g),u_particle_pos_offset:new r.bG(g)}),rasterParticleUpdate:g=>({u_particle_texture:new r.bJ(g),u_particle_texture_side_len:new r.bI(g),u_velocity:new r.bJ(g),u_velocity_res:new r.bG(g),u_max_speed:new r.bI(g),u_speed_factor:new r.bI(g),u_reset_rate:new r.bI(g),u_rand_seed:new r.bI(g),u_uv_offset:new r.bG(g),u_data_scale:new r.bG(g),u_data_offset:new r.bI(g),u_particle_pos_scale:new r.bI(g),u_particle_pos_offset:new r.bG(g)}),symbol:g=>({u_is_size_zoom_constant:new r.bJ(g),u_is_size_feature_constant:new r.bJ(g),u_size_t:new r.bI(g),u_size:new r.bI(g),u_camera_to_center_distance:new r.bI(g),u_rotate_symbol:new r.bJ(g),u_aspect_ratio:new r.bI(g),u_fade_change:new r.bI(g),u_matrix:new r.bF(g),u_label_plane_matrix:new r.bF(g),u_coord_matrix:new r.bF(g),u_is_text:new r.bJ(g),u_elevation_from_sea:new r.bJ(g),u_pitch_with_map:new r.bJ(g),u_texsize:new r.bG(g),u_texsize_icon:new r.bG(g),u_texture:new r.bJ(g),u_texture_icon:new r.bJ(g),u_gamma_scale:new r.bI(g),u_device_pixel_ratio:new r.bI(g),u_tile_id:new r.bH(g),u_zoom_transition:new r.bI(g),u_inv_rot_matrix:new r.bF(g),u_merc_center:new r.bG(g),u_camera_forward:new r.bH(g),u_tile_matrix:new r.bF(g),u_up_vector:new r.bH(g),u_ecef_origin:new r.bH(g),u_is_halo:new r.bJ(g),u_icon_transition:new r.bI(g),u_color_adj_mat:new r.bF(g)}),background:g=>({u_matrix:new r.bF(g),u_emissive_strength:new r.bI(g),u_opacity:new r.bI(g),u_color:new r.cu(g)}),backgroundPattern:g=>({u_matrix:new r.bF(g),u_emissive_strength:new r.bI(g),u_opacity:new r.bI(g),u_image:new r.bJ(g),u_pattern_tl:new r.bG(g),u_pattern_br:new r.bG(g),u_texsize:new r.bG(g),u_pattern_size:new r.bG(g),u_pixel_coord_upper:new r.bG(g),u_pixel_coord_lower:new r.bG(g),u_pattern_units_to_pixels:new r.bG(g)}),terrainRaster:g=>({u_matrix:new r.bF(g),u_image0:new r.bJ(g),u_skirt_height:new r.bI(g),u_ground_shadow_factor:new r.bH(g)}),skybox:g=>({u_matrix:new r.bF(g),u_sun_direction:new r.bH(g),u_cubemap:new r.bJ(g),u_opacity:new r.bI(g),u_temporal_offset:new r.bI(g)}),skyboxGradient:g=>({u_matrix:new r.bF(g),u_color_ramp:new r.bJ(g),u_center_direction:new r.bH(g),u_radius:new r.bI(g),u_opacity:new r.bI(g),u_temporal_offset:new r.bI(g)}),skyboxCapture:g=>({u_matrix_3f:new r.cv(g),u_sun_direction:new r.bH(g),u_sun_intensity:new r.bI(g),u_color_tint_r:new r.c6(g),u_color_tint_m:new r.c6(g),u_luminance:new r.bI(g)}),globeRaster:g=>({u_proj_matrix:new r.bF(g),u_globe_matrix:new r.bF(g),u_normalize_matrix:new r.bF(g),u_merc_matrix:new r.bF(g),u_zoom_transition:new r.bI(g),u_merc_center:new r.bG(g),u_image0:new r.bJ(g),u_grid_matrix:new r.cv(g),u_skirt_height:new r.bI(g),u_far_z_cutoff:new r.bI(g),u_frustum_tl:new r.bH(g),u_frustum_tr:new r.bH(g),u_frustum_br:new r.bH(g),u_frustum_bl:new r.bH(g),u_globe_pos:new r.bH(g),u_globe_radius:new r.bI(g),u_viewport:new r.bG(g)}),globeAtmosphere:g=>({u_frustum_tl:new r.bH(g),u_frustum_tr:new r.bH(g),u_frustum_br:new r.bH(g),u_frustum_bl:new r.bH(g),u_horizon:new r.bI(g),u_transition:new r.bI(g),u_fadeout_range:new r.bI(g),u_color:new r.c6(g),u_high_color:new r.c6(g),u_space_color:new r.c6(g),u_temporal_offset:new r.bI(g),u_horizon_angle:new r.bI(g)}),model:g=>({u_matrix:new r.bF(g),u_lighting_matrix:new r.bF(g),u_normal_matrix:new r.bF(g),u_node_matrix:new r.bF(g),u_lightpos:new r.bH(g),u_lightintensity:new r.bI(g),u_lightcolor:new r.bH(g),u_camera_pos:new r.bH(g),u_opacity:new r.bI(g),u_baseColorFactor:new r.c6(g),u_emissiveFactor:new r.c6(g),u_metallicFactor:new r.bI(g),u_roughnessFactor:new r.bI(g),u_baseTextureIsAlpha:new r.bJ(g),u_alphaMask:new r.bJ(g),u_alphaCutoff:new r.bI(g),u_baseColorTexture:new r.bJ(g),u_metallicRoughnessTexture:new r.bJ(g),u_normalTexture:new r.bJ(g),u_occlusionTexture:new r.bJ(g),u_emissionTexture:new r.bJ(g),u_lutTexture:new r.bJ(g),u_color_mix:new r.c6(g),u_aoIntensity:new r.bI(g),u_emissive_strength:new r.bI(g),u_occlusionTextureTransform:new r.c6(g)}),modelDepth:g=>({u_matrix:new r.bF(g),u_instance:new r.bF(g),u_node_matrix:new r.bF(g)}),groundShadow:g=>({u_matrix:new r.bF(g),u_ground_shadow_factor:new r.bH(g)}),stars:g=>({u_matrix:new r.bF(g),u_up:new r.bH(g),u_right:new r.bH(g),u_intensity_multiplier:new r.bI(g)}),occlusion:g=>({u_matrix:new r.bF(g),u_anchorPos:new r.bH(g),u_screenSizePx:new r.bG(g),u_occluderSizePx:new r.bG(g),u_color:new r.c6(g)})};class tl{constructor(o,c,y,S){this.id=tl.uniqueIdxCounter,tl.uniqueIdxCounter++,this.context=o;const T=o.gl;this.buffer=T.createBuffer(),this.dynamicDraw=!!y,this.context.unbindVAO(),o.bindElementBuffer.set(this.buffer),T.bufferData(T.ELEMENT_ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?T.DYNAMIC_DRAW:T.STATIC_DRAW),this.dynamicDraw||S||c.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(o){this.id=tl.uniqueIdxCounter,tl.uniqueIdxCounter++;const c=this.context.gl;this.context.unbindVAO(),this.bind(),c.bufferSubData(c.ELEMENT_ARRAY_BUFFER,0,o.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}tl.uniqueIdxCounter=0;const sh={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class mr{constructor(o,c,y,S,T,A){this.length=c.length,this.attributes=y,this.itemSize=c.bytesPerElement,this.dynamicDraw=S,this.instanceCount=A,this.context=o;const $=o.gl;this.buffer=$.createBuffer(),o.bindVertexBuffer.set(this.buffer),$.bufferData($.ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?$.DYNAMIC_DRAW:$.STATIC_DRAW),this.dynamicDraw||T||c.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(o){const c=this.context.gl;this.bind(),c.bufferSubData(c.ARRAY_BUFFER,0,o.arrayBuffer)}enableAttributes(o,c){for(let y=0;y<this.attributes.length;y++){const S=c.attributes[this.attributes[y].name];S!==void 0&&o.enableVertexAttribArray(S)}}setVertexAttribPointers(o,c,y){for(let S=0;S<this.attributes.length;S++){const T=this.attributes[S],A=c.attributes[T.name];A!==void 0&&o.vertexAttribPointer(A,T.components,o[sh[T.type]],!1,this.itemSize,T.offset+this.itemSize*(y||0))}}setVertexAttribDivisor(o,c,y){for(let S=0;S<this.attributes.length;S++){const T=c.attributes[this.attributes[S].name];T!==void 0&&this.instanceCount&&this.instanceCount>0&&o.vertexAttribDivisor(T,y)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class ng{constructor(o,c,y,S,T){this.context=o,this.width=c,this.height=y;const A=this.framebuffer=o.gl.createFramebuffer();S&&(this.colorAttachment=new qm(o,A)),T&&(this.depthAttachmentType=T,this.depthAttachment=T==="renderbuffer"?new j0(o,A):new A1(o,A))}destroy(){const o=this.context.gl;if(this.colorAttachment){const c=this.colorAttachment.get();c&&o.deleteTexture(c)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const c=this.depthAttachment.get();c&&o.deleteRenderbuffer(c)}else{const c=this.depthAttachment.get();c&&o.deleteTexture(c)}o.deleteFramebuffer(this.framebuffer)}}class iT{constructor(o,c){this.gl=o,this.clearColor=new gs(this),this.clearDepth=new xa(this),this.clearStencil=new el(this),this.colorMask=new da(this),this.depthMask=new Fs(this),this.stencilMask=new pd(this),this.stencilFunc=new ju(this),this.stencilOp=new Vu(this),this.stencilTest=new La(this),this.depthRange=new rh(this),this.depthTest=new Um(this),this.depthFunc=new Yh(this),this.blend=new Zh(this),this.blendFunc=new L0(this),this.blendColor=new R0(this),this.blendEquation=new O0(this),this.cullFace=new D0(this),this.cullFaceSide=new k1(this),this.frontFace=new M1(this),this.program=new eT(this),this.activeTexture=new Cp(this),this.viewport=new Ep(this),this.bindFramebuffer=new P1(this),this.bindRenderbuffer=new Cl(this),this.bindTexture=new z0(this),this.bindVertexBuffer=new Gm(this),this.bindElementBuffer=new Hm(this),this.bindVertexArrayOES=new F0(this),this.pixelStoreUnpack=new N0(this),this.pixelStoreUnpackPremultiplyAlpha=new Wm(this),this.pixelStoreUnpackFlipY=new B0(this),this.options=c?{...c}:{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=o.getExtension("EXT_texture_filter_anisotropic")||o.getExtension("MOZ_EXT_texture_filter_anisotropic")||o.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=o.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=o.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=o.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=o.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=o.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=o.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=o.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=o.getParameter(o.MAX_TEXTURE_SIZE),this.maxPointSize=o.getParameter(o.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(o,c,y){return new tl(this,o,c,y)}createVertexBuffer(o,c,y,S,T){return new mr(this,o,c,y,S,T)}createRenderbuffer(o,c,y){const S=this.gl,T=S.createRenderbuffer();return this.bindRenderbuffer.set(T),S.renderbufferStorage(S.RENDERBUFFER,o,c,y),this.bindRenderbuffer.set(null),T}createFramebuffer(o,c,y,S){return new ng(this,o,c,y,S)}clear({color:o,depth:c,stencil:y,colorMask:S}){const T=this.gl;let A=0;o&&(A|=T.COLOR_BUFFER_BIT,this.clearColor.set(o),this.colorMask.set(S||[!0,!0,!0,!0])),c!==void 0&&(A|=T.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(c),this.depthMask.set(!0)),y!==void 0&&(A|=T.STENCIL_BUFFER_BIT,this.clearStencil.set(y),this.stencilMask.set(255)),T.clear(A)}setCullFace(o){o.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(o.mode),this.frontFace.set(o.frontFace))}setDepthMode(o){o.func!==this.gl.ALWAYS||o.mask?(this.depthTest.set(!0),this.depthFunc.set(o.func),this.depthMask.set(o.mask),this.depthRange.set(o.range)):this.depthTest.set(!1)}setStencilMode(o){o.test.func!==this.gl.ALWAYS||o.mask?(this.stencilTest.set(!0),this.stencilMask.set(o.mask),this.stencilOp.set([o.fail,o.depthFail,o.pass]),this.stencilFunc.set({func:o.test.func,ref:o.ref,mask:o.test.mask})):this.stencilTest.set(!1)}setColorMode(o){r.bh(o.blendFunction,Hr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(o.blendFunction),this.blendColor.set(o.blendColor),o.blendEquation?this.blendEquation.set(o.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(o.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}let rg;function ig(g,o,c,y,S,T,A){const $=g.context,Y=$.gl,ee=g.transform,te=g.getOrCreateProgram("collisionBox"),ue=[];let fe=0,me=0;for(let qe=0;qe<y.length;qe++){const it=y[qe],rt=o.getTile(it),mt=rt.getBucket(c);if(!mt)continue;const dt=Xa(it,mt,ee);let yt=dt;S[0]===0&&S[1]===0||(yt=g.translatePosMatrix(dt,rt,S,T));const Et=A?mt.textCollisionBox:mt.iconCollisionBox,bt=mt.collisionCircleArray;if(bt.length>0){const vt=r.a6.mat4.create(),Ot=yt;r.a6.mat4.mul(vt,mt.placementInvProjMatrix,ee.glCoordMatrix),r.a6.mat4.mul(vt,vt,mt.placementViewportMatrix),ue.push({circleArray:bt,circleOffset:me,transform:Ot,invTransform:vt,projection:mt.getProjection()}),fe+=bt.length/4,me=fe}Et&&(g.terrain&&g.terrain.setupElevationDraw(rt,te),te.draw(g,Y.LINES,cr.disabled,Dr.disabled,g.colorModeForRenderPass(),Mr.disabled,nT(yt,ee,rt,mt.getProjection()),c.id,Et.layoutVertexBuffer,Et.indexBuffer,Et.segments,null,ee.zoom,null,[Et.collisionVertexBuffer,Et.collisionVertexBufferExt]))}if(!A||!ue.length)return;const ke=g.getOrCreateProgram("collisionCircle"),Le=new r.cQ;Le.resize(4*fe),Le._trim();let De=0;for(const qe of ue)for(let it=0;it<qe.circleArray.length/4;it++){const rt=4*it,mt=qe.circleArray[rt+0],dt=qe.circleArray[rt+1],yt=qe.circleArray[rt+2],Et=qe.circleArray[rt+3];Le.emplace(De++,mt,dt,yt,Et,0),Le.emplace(De++,mt,dt,yt,Et,1),Le.emplace(De++,mt,dt,yt,Et,2),Le.emplace(De++,mt,dt,yt,Et,3)}(!rg||rg.length<2*fe)&&(rg=function(qe){const it=2*qe,rt=new r.aO;rt.resize(it),rt._trim();for(let mt=0;mt<it;mt++){const dt=6*mt;rt.uint16[dt+0]=4*mt+0,rt.uint16[dt+1]=4*mt+1,rt.uint16[dt+2]=4*mt+2,rt.uint16[dt+3]=4*mt+2,rt.uint16[dt+4]=4*mt+3,rt.uint16[dt+5]=4*mt+0}return rt}(fe));const Fe=$.createIndexBuffer(rg,!0),Ye=$.createVertexBuffer(Le,r.cR.members,!0);for(const qe of ue){const it={u_matrix:qe.transform,u_inv_matrix:qe.invTransform,u_camera_to_center_distance:(Je=ee).getCameraToCenterDistance(qe.projection),u_viewport_size:[Je.width,Je.height]};ke.draw(g,Y.TRIANGLES,cr.disabled,Dr.disabled,g.colorModeForRenderPass(),Mr.disabled,it,c.id,Ye,Fe,r.b1.simpleSegment(0,2*qe.circleOffset,qe.circleArray.length,qe.circleArray.length/2),null,ee.zoom)}var Je;Ye.destroy(),Fe.destroy()}const Pp=r.a6.mat4.create();function K0(g){const o=g._camera.getWorldToCamera(g.worldSize,1),c=r.a6.mat4.multiply([],o,g.globeMatrix);r.a6.mat4.invert(c,c);const y=[0,0,0],S=[0,1,0,0];return r.a6.vec4.transformMat4(S,S,c),y[0]=S[0],y[1]=S[1],y[2]=S[2],r.a6.vec3.normalize(y,y),y}function oT({width:g,height:o,anchor:c,textOffset:y,textScale:S},T){const{horizontalAlign:A,verticalAlign:$}=r.bx(c),Y=-(A-.5)*g,ee=-($-.5)*o,te=r.bw(c,y);return new r.P((Y/S+te[0])*T,(ee/S+te[1])*T)}function sT(g,o,c,y,S,T,A,$,Y,ee,te){const ue=g.text.placedSymbolArray,fe=g.text.dynamicLayoutVertexArray,me=g.icon.dynamicLayoutVertexArray,ke={},Le=g.getProjection(),De=Pa($,Le,T),Fe=T.elevation,Ye=Le.upVectorScale($.canonical,T.center.lat,T.worldSize).metersToTile;fe.clear();for(let Je=0;Je<ue.length;Je++){const qe=ue.get(Je),{tileAnchorX:it,tileAnchorY:rt,numGlyphs:mt}=qe,dt=qe.hidden||!qe.crossTileID||g.allowVerticalPlacement&&!qe.placedOrientation?null:y[qe.crossTileID];if(dt){let yt=0,Et=0,bt=0;if(Fe){const cn=Fe?Fe.getAtTileOffset($,it,rt):0,[In,An,pn]=Le.upVector($.canonical,it,rt);yt=cn*In*Ye,Et=cn*An*Ye,bt=cn*pn*Ye}let[vt,Ot,sn,mn]=oo(qe.projectedAnchorX+yt,qe.projectedAnchorY+Et,qe.projectedAnchorZ+bt,c?De:A);const on=ci(T.getCameraToCenterDistance(Le),mn);let Tn=S.evaluateSizeForFeature(g.textSizeData,ee,qe)*on/r.bq;c&&(Tn*=g.tilePixelRatio/Y);const Dt=oT(dt,Tn);c?({x:vt,y:Ot,z:sn}=Le.projectTilePoint(it+Dt.x,rt+Dt.y,$.canonical),[vt,Ot,sn]=oo(vt+yt,Ot+Et,sn+bt,A)):(o&&Dt._rotate(-T.angle),vt+=Dt.x,Ot+=Dt.y,sn=0);const dn=g.allowVerticalPlacement&&qe.placedOrientation===r.bk.vertical?Math.PI/2:0;for(let cn=0;cn<mt;cn++)r.bn(fe,vt,Ot,sn,dn);te&&qe.associatedIconIndex>=0&&(ke[qe.associatedIconIndex]={x:vt,y:Ot,z:sn,angle:dn})}else ra(mt,fe)}if(te){me.clear();const Je=g.icon.placedSymbolArray;for(let qe=0;qe<Je.length;qe++){const it=Je.get(qe),{numGlyphs:rt}=it,mt=ke[qe];if(it.hidden||!mt)ra(rt,me);else{const{x:dt,y:yt,z:Et,angle:bt}=mt;for(let vt=0;vt<rt;vt++)r.bn(me,dt,yt,Et,bt)}}g.icon.dynamicLayoutVertexBuffer.updateData(me)}g.text.dynamicLayoutVertexBuffer.updateData(fe)}function Ap(g,o,c,y,S,T,A={}){const $=c.paint.get("icon-translate"),Y=c.paint.get("text-translate"),ee=c.paint.get("icon-translate-anchor"),te=c.paint.get("text-translate-anchor"),ue=c.layout.get("icon-rotation-alignment"),fe=c.layout.get("text-rotation-alignment"),me=c.layout.get("icon-pitch-alignment"),ke=c.layout.get("text-pitch-alignment"),Le=c.layout.get("icon-keep-upright"),De=c.layout.get("text-keep-upright"),Fe=c.paint.get("icon-color-saturation"),Ye=c.paint.get("icon-color-contrast"),Je=c.paint.get("icon-color-brightness-min"),qe=c.paint.get("icon-color-brightness-max"),it=c.paint.get("symbol-elevation-reference")==="sea",rt=c.paint.get("text-occlusion-opacity").constantOr(0),mt=g.context,dt=mt.gl,yt=g.transform,Et=ue==="map",bt=fe==="map",vt=me==="map",Ot=ke==="map",sn=c.layout.get("symbol-sort-key").constantOr(1)!==void 0;let mn=!1;const on=g.depthModeForSublayer(0,cr.ReadOnly),Tn=[r.am(yt.center.lng),r.at(yt.center.lat)],Dt=c.layout.get("text-variable-anchor"),dn=yt.projection.name==="globe",cn=[],In=[0,-1,0];for(const An of y){const pn=o.getTile(An),_n=pn.getBucket(c);if(!_n||_n.projection.name==="mercator"&&dn||_n.fullyClipped)continue;const _r=_n.projection.name==="globe",Vn=_r?r.a9(yt.zoom):0,tr=Pa(An,_n.getProjection(),yt),zr=yt.calculatePixelsToTileUnitsMatrix(pn),dr=Dt&&_n.hasTextData(),Ir=_n.hasIconTextFit()&&dr&&_n.hasIconData(),oi=_n.getProjection().createInversionMatrix(yt,An.canonical),Qr=$i=>{yt.depthOcclusionForSymbolsAndCircles&&(c.hasInitialOcclusionOpacityProperties||g.terrain)&&($i.push("DEPTH_D24"),$i.push("DEPTH_OCCLUSION"))},Fi=()=>{const $i=Et&&c.layout.get("symbol-placement")!=="point",ni=[];Qr(ni);const Si=$i||Ir,Oi=c.paint.get("icon-image-cross-fade").constantOr(0);g.terrainRenderModeElevated()&&vt&&ni.push("PITCH_WITH_MAP_TERRAIN"),_r&&(ni.push("PROJECTION_GLOBE_VIEW"),Si&&ni.push("PROJECTED_POS_ON_VIEWPORT")),Oi>0&&ni.push("ICON_TRANSITION"),_n.icon.zOffsetVertexBuffer&&ni.push("Z_OFFSET"),Fe===0&&Ye===0&&Je===0&&qe===1||ni.push("COLOR_ADJUSTMENT"),_n.sdfIcons&&ni.push("RENDER_SDF");const Bo=_n.icon.programConfigurations.get(c.id),os=g.getOrCreateProgram("symbol",{config:Bo,defines:ni}),_i=pn.imageAtlasTexture?pn.imageAtlasTexture.size:[0,0],Ss=_n.iconSizeData,Ns=r.bj(Ss,yt.zoom),Cs=vt||yt.pitch!==0,no=xr(tr,pn.tileID.canonical,vt,Et,yt,_n.getProjection(),zr),Oa=Gs(tr,pn.tileID.canonical,vt,Et,yt,_n.getProjection(),zr),Da=g.translatePosMatrix(Oa,pn,$,ee,!0),Hl=g.translatePosMatrix(tr,pn,$,ee),Tl=Si?Pp:no,rl=Et&&!vt&&!$i;let Wl=In;!dn&&!yt.mercatorFromTransition||Et||(Wl=K0(yt));const Rc=_r?Wl:In,wd=c.getColorAdjustmentMatrix(Fe,Ye,Je,qe),Wu=Y0(Ss.kind,Ns,rl,vt,g,Hl,Tl,Da,it,!1,_i,[0,0],!0,An,Vn,Tn,oi,Rc,_n.getProjection(),wd,Oi),hf=pn.imageAtlasTexture?pn.imageAtlasTexture:null,ff=c.layout.get("icon-size").constantOr(0)!==1||_n.iconsNeedLinear,bg=_n.sdfIcons||g.options.rotating||g.options.zooming||ff||Cs?dt.LINEAR:dt.NEAREST,pf=_n.sdfIcons&&c.paint.get("icon-halo-width").constantOr(1)!==0,ro=g.terrain&&vt&&$i?r.a6.mat4.invert(r.a6.mat4.create(),no):Pp;if($i&&_n.icon){const hh=yt.elevation,bT=hh?hh.getAtTileOffsetFunc(An,yt.center.lat,yt.worldSize,_n.getProjection()):null,cb=ai(tr,pn.tileID.canonical,vt,Et,yt,_n.getProjection(),zr);Fl(_n,tr,g,!1,cb,Oa,vt,Le,bT,An)}return{program:os,buffers:_n.icon,uniformValues:Wu,atlasTexture:hf,atlasTextureIcon:null,atlasInterpolation:bg,atlasInterpolationIcon:null,isSDF:_n.sdfIcons,hasHalo:pf,tile:pn,labelPlaneMatrixInv:ro}},qi=()=>{const $i=bt&&c.layout.get("symbol-placement")!=="point",ni=[],Si=$i||Dt||Ir;g.terrainRenderModeElevated()&&Ot&&ni.push("PITCH_WITH_MAP_TERRAIN"),_r&&(ni.push("PROJECTION_GLOBE_VIEW"),Si&&ni.push("PROJECTED_POS_ON_VIEWPORT")),_n.text.zOffsetVertexBuffer&&ni.push("Z_OFFSET"),_n.iconsInText&&ni.push("RENDER_TEXT_AND_SYMBOL"),ni.push("RENDER_SDF"),Qr(ni);const Oi=_n.text.programConfigurations.get(c.id),Bo=g.getOrCreateProgram("symbol",{config:Oi,defines:ni});let os,_i=[0,0],Ss=null;const Ns=_n.textSizeData;_n.iconsInText&&(_i=pn.imageAtlasTexture?pn.imageAtlasTexture.size:[0,0],Ss=pn.imageAtlasTexture?pn.imageAtlasTexture:null,os=Ot||yt.pitch!==0||g.options.rotating||g.options.zooming||Ns.kind==="composite"||Ns.kind==="camera"?dt.LINEAR:dt.NEAREST);const Cs=pn.glyphAtlasTexture?pn.glyphAtlasTexture.size:[0,0],no=r.bj(Ns,yt.zoom),Oa=xr(tr,pn.tileID.canonical,Ot,bt,yt,_n.getProjection(),zr),Da=Gs(tr,pn.tileID.canonical,Ot,bt,yt,_n.getProjection(),zr),Hl=g.translatePosMatrix(Da,pn,Y,te,!0),Tl=g.translatePosMatrix(tr,pn,Y,te),rl=Si?Pp:Oa,Wl=bt&&!Ot&&!$i;let Rc=In;!dn&&!yt.mercatorFromTransition||bt||(Rc=K0(yt));const wd=Y0(Ns.kind,no,Wl,Ot,g,Tl,rl,Hl,it,!0,Cs,_i,!0,An,Vn,Tn,oi,_r?Rc:In,_n.getProjection(),rt),Wu=pn.glyphAtlasTexture?pn.glyphAtlasTexture:null,hf=dt.LINEAR,ff=c.paint.get("text-halo-width").constantOr(1)!==0,bg=g.terrain&&Ot&&$i?r.a6.mat4.invert(r.a6.mat4.create(),Oa):Pp;if($i&&_n.text){const pf=yt.elevation,ro=pf?pf.getAtTileOffsetFunc(An,yt.center.lat,yt.worldSize,_n.getProjection()):null,hh=ai(tr,pn.tileID.canonical,Ot,bt,yt,_n.getProjection(),zr);Fl(_n,tr,g,!0,hh,Da,Ot,De,ro,An)}return{program:Bo,buffers:_n.text,uniformValues:wd,atlasTexture:Wu,atlasTextureIcon:Ss,atlasInterpolation:hf,atlasInterpolationIcon:os,isSDF:!0,hasHalo:ff,tile:pn,labelPlaneMatrixInv:bg}},ao=_n.icon.segments.get().length,Gl=_n.text.segments.get().length,is=ao&&!A.onlyText?Fi():null,hi=Gl&&!A.onlyIcons?qi():null,Hi=c.paint.get("icon-opacity").constantOr(1),xo=c.paint.get("text-opacity").constantOr(1);if(sn&&_n.canOverlap){mn=!0;const $i=Hi&&!A.onlyText?_n.icon.segments.get():[],ni=xo&&!A.onlyIcons?_n.text.segments.get():[];for(const Si of $i)cn.push({segments:new r.b1([Si]),sortKey:Si.sortKey,state:is});for(const Si of ni)cn.push({segments:new r.b1([Si]),sortKey:Si.sortKey,state:hi})}else A.onlyText||cn.push({segments:Hi?_n.icon.segments:new r.b1([]),sortKey:0,state:is}),A.onlyIcons||cn.push({segments:xo?_n.text.segments:new r.b1([]),sortKey:0,state:hi})}mn&&cn.sort((An,pn)=>An.sortKey-pn.sortKey);for(const An of cn){const pn=An.state;if(pn)if(g.terrain?g.terrain.setupElevationDraw(pn.tile,pn.program,{useDepthForOcclusion:yt.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:pn.labelPlaneMatrixInv}):g.setupDepthForOcclusion(yt.depthOcclusionForSymbolsAndCircles,pn.program),mt.activeTexture.set(dt.TEXTURE0),pn.atlasTexture&&pn.atlasTexture.bind(pn.atlasInterpolation,dt.CLAMP_TO_EDGE,!0),pn.atlasTextureIcon&&(mt.activeTexture.set(dt.TEXTURE1),pn.atlasTextureIcon&&pn.atlasTextureIcon.bind(pn.atlasInterpolationIcon,dt.CLAMP_TO_EDGE,!0)),g.uploadCommonLightUniforms(g.context,pn.program),pn.hasHalo){const _n=pn.uniformValues;_n.u_is_halo=1,Lp(pn.buffers,An.segments,c,g,pn.program,on,S,T,_n,2),_n.u_is_halo=0}else{if(pn.isSDF){const _n=pn.uniformValues;pn.hasHalo&&(_n.u_is_halo=1,Lp(pn.buffers,An.segments,c,g,pn.program,on,S,T,_n,1)),_n.u_is_halo=0}Lp(pn.buffers,An.segments,c,g,pn.program,on,S,T,pn.uniformValues,1)}}}function Lp(g,o,c,y,S,T,A,$,Y,ee){const te=[g.dynamicLayoutVertexBuffer,g.opacityVertexBuffer,g.iconTransitioningVertexBuffer,g.globeExtVertexBuffer,g.zOffsetVertexBuffer];S.draw(y,y.context.gl.TRIANGLES,T,A,$,Mr.disabled,Y,c.id,g.layoutVertexBuffer,g.indexBuffer,o,c.paint,y.transform.zoom,g.programConfigurations.get(c.id),te,ee)}function og(g,o,c,y,S,T,A){const $=g.context.gl,Y=c.paint.get("fill-pattern"),ee=c.is3D(),te=ee?g.stencilModeFor3D():Dr.disabled,ue=Y&&Y.constantOr(1);let fe,me,ke,Le,De;A?(me=ue&&!c.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",fe=$.LINES):(me=ue?"fillPattern":"fill",fe=$.TRIANGLES);for(const Fe of y){const Ye=o.getTile(Fe);if(ue&&!Ye.patternsLoaded())continue;const Je=Ye.getBucket(c);if(!Je)continue;g.prepareDrawTile();const qe=Je.programConfigurations.get(c.id),it=g.isTileAffectedByFog(Fe),rt=g.getOrCreateProgram(me,{config:qe,overrideFog:it});ue&&(g.context.activeTexture.set($.TEXTURE0),Ye.imageAtlasTexture&&Ye.imageAtlasTexture.bind($.LINEAR,$.CLAMP_TO_EDGE),qe.updatePaintBuffers());const mt=Y.constantOr(null);if(mt&&Ye.imageAtlas){const Et=Ye.imageAtlas.patternPositions[mt.toString()];Et&&qe.setConstantPatternPositions(Et)}const dt=g.translatePosMatrix(Fe.projMatrix,Ye,c.paint.get("fill-translate"),c.paint.get("fill-translate-anchor")),yt=c.paint.get("fill-emissive-strength");if(A){Le=Je.indexBuffer2,De=Je.segments2;const Et=g.terrain&&g.terrain.renderingToTexture?g.terrain.drapeBufferSize:[$.drawingBufferWidth,$.drawingBufferHeight];ke=me==="fillOutlinePattern"&&ue?kp(dt,yt,g,Ye,Et):j1(dt,yt,Et)}else Le=Je.indexBuffer,De=Je.segments,ke=ue?B1(dt,yt,g,Ye):Zm(dt,yt);g.uploadCommonUniforms(g.context,rt,Fe.toUnwrapped()),rt.draw(g,fe,S,ee?te:g.stencilModeForClipping(Fe),T,Mr.disabled,ke,c.id,Je.layoutVertexBuffer,Le,De,c.paint,g.transform.zoom,qe,void 0)}}function tf(g,o,c,y,S,T,A,$){c.resetLayerRenderingStats(g);const Y=g.context,ee=Y.gl,te=g.transform,ue=c.paint.get("fill-extrusion-pattern"),fe=ue.constantOr(1),me=c.paint.get("fill-extrusion-opacity"),ke=g.style.enable3dLights(),Le=c.paint.get(ke&&!fe?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),De=[c.paint.get("fill-extrusion-ambient-occlusion-intensity"),Le],Fe=c.layout.get("fill-extrusion-edge-radius"),Ye=Fe>0&&!c.paint.get("fill-extrusion-rounded-roof"),Je=Ye?0:Fe,qe=te.projection.name==="globe"?r.c_():0,it=te.projection.name==="globe",rt=it?r.a9(te.zoom):0,mt=[r.am(te.center.lng),r.at(te.center.lat)],dt=c.paint.get("fill-extrusion-flood-light-color").toRenderColor(c.lut).toArray01().slice(0,3),yt=c.paint.get("fill-extrusion-flood-light-intensity"),Et=c.paint.get("fill-extrusion-vertical-scale"),bt=c.paint.get("fill-extrusion-line-width").constantOr(1)!==0,vt=zs(g,c.paint.get("fill-extrusion-cutoff-fade-range")),Ot=[];let sn;it&&Ot.push("PROJECTION_GLOBE_VIEW"),De[0]>0&&Ot.push("FAUX_AO"),Ye&&Ot.push("ZERO_ROOF_RADIUS"),$&&Ot.push("HAS_CENTROID"),yt>0&&Ot.push("FLOOD_LIGHT"),vt.shouldRenderCutoff&&Ot.push("RENDER_CUTOFF"),bt&&Ot.push("RENDER_WALL_MODE");const mn=g.renderPass==="shadow",on=g.shadowRenderer,Tn=mn&&!!on;g.shadowRenderer&&(g.shadowRenderer.useNormalOffset=!0);let Dt=[0,0,0];if(on){const In=g.style.directionalLight,An=g.style.ambientLight;In&&An&&(Dt=Bu(g.style,In,An)),sn=Ot.concat(["SHADOWS_SINGLE_CASCADE"])}const dn=Tn?"fillExtrusionDepth":fe?"fillExtrusionPattern":"fillExtrusion",cn=c.getLayerRenderingStats();for(const In of y){const An=o.getTile(In),pn=An.getBucket(c);if(!pn||pn.projection.name!==te.projection.name)continue;let _n=!1;on&&(_n=on.getMaxCascadeForTile(In.toUnwrapped())===0);const _r=g.isTileAffectedByFog(In),Vn=pn.programConfigurations.get(c.id),tr=g.getOrCreateProgram(dn,{config:Vn,defines:_n?sn:Ot,overrideFog:_r});if(g.terrain&&g.terrain.setupElevationDraw(An,tr,{useMeterToDem:!0}),!pn.centroidVertexBuffer){const qi=tr.attributes.a_centroid_pos;qi!==void 0&&ee.vertexAttrib2f(qi,0,0)}!mn&&on&&on.setupShadows(An.tileID.toUnwrapped(),tr,"vector-tile",An.tileID.overscaledZ),fe&&(g.context.activeTexture.set(ee.TEXTURE0),An.imageAtlasTexture&&An.imageAtlasTexture.bind(ee.LINEAR,ee.CLAMP_TO_EDGE),Vn.updatePaintBuffers());const zr=ue.constantOr(null);if(zr&&An.imageAtlas){const qi=An.imageAtlas.patternPositions[zr.toString()];qi&&Vn.setConstantPatternPositions(qi)}const dr=c.paint.get("fill-extrusion-vertical-gradient"),Ir=1/pn.tileToMeter;let oi;if(mn&&on){if(e_(An.tileID,pn,g))continue;const qi=on.calculateShadowPassMatrixFromTile(An.tileID.toUnwrapped());oi=N1(qi,Je,Ir,Et)}else{const qi=g.translatePosMatrix(In.expandedProjMatrix,An,c.paint.get("fill-extrusion-translate"),c.paint.get("fill-extrusion-translate-anchor")),ao=te.projection.createInversionMatrix(te,In.canonical);oi=fe?q0(qi,g,dr,me,De,Je,Ir,In,An,qe,rt,mt,ao,dt,Et):W0(qi,g,dr,me,De,Je,Ir,In,qe,rt,mt,ao,dt,Et,yt,Dt)}g.uploadCommonUniforms(Y,tr,In.toUnwrapped(),null,vt);let Qr=pn.segments;if(te.projection.name==="mercator"&&!mn&&(Qr=pn.getVisibleSegments(An.tileID,g.terrain,g.transform.getFrustum(0)),!Qr.get().length))continue;if(cn)if(mn)for(const qi of Qr.get())cn.numRenderedVerticesInShadowPass+=qi.primitiveLength;else for(const qi of Qr.get())cn.numRenderedVerticesInTransparentPass+=qi.primitiveLength;const Fi=[];(g.terrain||$)&&Fi.push(pn.centroidVertexBuffer),it&&Fi.push(pn.layoutVertexExtBuffer),bt&&Fi.push(pn.wallVertexBuffer),tr.draw(g,Y.gl.TRIANGLES,S,T,A,Mr.backCCW,oi,c.id,pn.layoutVertexBuffer,pn.indexBuffer,Qr,c.paint,g.transform.zoom,Vn,Fi)}g.shadowRenderer&&(g.shadowRenderer.useNormalOffset=!1)}function Ys(g,o,c,y,S,T,A,$,Y,ee,te,ue,fe,me,ke,Le,De,Fe,Ye){const Je=g.context,qe=Je.gl,it=g.transform,rt=g.transform.zoom,mt=[],dt=zs(g,c.paint.get("fill-extrusion-cutoff-fade-range"));ee==="clear"?(mt.push("CLEAR_SUBPASS"),Ye&&(mt.push("CLEAR_FROM_TEXTURE"),Je.activeTexture.set(qe.TEXTURE0),Ye.bind(qe.LINEAR,qe.CLAMP_TO_EDGE))):ee==="sdf"&&mt.push("SDF_SUBPASS"),De&&mt.push("HAS_CENTROID"),dt.shouldRenderCutoff&&mt.push("RENDER_CUTOFF");const yt=c.layout.get("fill-extrusion-edge-radius"),Et=(bt,vt,Ot,sn,mn)=>{const on=vt.programConfigurations.get(c.id),Tn=g.isTileAffectedByFog(bt),Dt=g.getOrCreateProgram("fillExtrusionGroundEffect",{config:on,defines:mt,overrideFog:Tn}),dn=((In,An,pn,_n,_r,Vn,tr,zr,dr,Ir,oi)=>({u_matrix:An,u_opacity:pn,u_ao_pass:_n?1:0,u_meter_to_tile:_r,u_ao:Vn,u_flood_light_intensity:tr,u_flood_light_color:zr,u_attenuation:dr,u_edge_radius:Ir,u_fb:0,u_fb_size:oi,u_dynamic_offset:1}))(0,sn,te,Y,mn,[ue,fe*mn],me,ke,Le,rt>=17?0:yt*mn,Ye?Ye.size[0]:0),cn=[];De&&cn.push(vt.hiddenByLandmarkVertexBuffer),g.uploadCommonUniforms(Je,Dt,bt.toUnwrapped(),null,dt),Dt.draw(g,Je.gl.TRIANGLES,S,T,A,$,dn,c.id,vt.vertexBuffer,vt.indexBuffer,Ot,c.paint,rt,on,cn)};for(const bt of y){const vt=o.getTile(bt),Ot=vt.getBucket(c);if(!Ot||Ot.projection.name!==it.projection.name||!Ot.groundEffect||Ot.groundEffect&&!Ot.groundEffect.hasData())continue;const sn=Ot.groundEffect,mn=1/Ot.tileToMeter;{const on=g.translatePosMatrix(bt.projMatrix,vt,c.paint.get("fill-extrusion-translate"),c.paint.get("fill-extrusion-translate-anchor")),Tn=sn.getDefaultSegment();Et(bt,sn,Tn,on,mn)}if(Fe)for(let on=0;on<4;on++){const Tn=r.c$[on](bt),Dt=o.getTile(Tn);if(!Dt)continue;const dn=Dt.getBucket(c);if(!dn||dn.projection.name!==it.projection.name||!dn.groundEffect||dn.groundEffect&&!dn.groundEffect.hasData())continue;const cn=dn.groundEffect;let In,An;on===0?(In=[-r.ab,0,0],An=1):on===1?(In=[r.ab,0,0],An=0):on===2?(In=[0,-r.ab,0],An=3):(In=[0,r.ab,0],An=2);const pn=cn.regionSegments[An];if(!pn)continue;const _n=new Float32Array(16);r.a6.mat4.translate(_n,bt.projMatrix,In),Et(bt,cn,pn,g.translatePosMatrix(_n,vt,c.paint.get("fill-extrusion-translate"),c.paint.get("fill-extrusion-translate-anchor")),mn)}}}function gd(g,o,c,y,S,T,A){y.centroidVertexArray.length===0&&y.createCentroidsBuffer();const $=T?T.findDEMTileFor(c):null;if(!($&&$.dem||A))return;const Y=Fe=>new r.P(Math.ceil((Fe+r.d2)*r.d3),0),ee=Fe=>{const Ye=o.getSource().minzoom,Je=it=>{const rt=o.getTileByID(it);if(rt&&rt.hasData())return rt.getBucket(S)},qe=[0,-1,1];for(const it of qe){if(Fe.overscaledZ+it<Ye)continue;const rt=Je(Fe.calculateScaledKey(Fe.overscaledZ+it));if(rt)return rt}},te=[0,0,0],ue=(Fe,Ye)=>(te[0]=Math.min(Fe.min.y,Ye.min.y),te[1]=Math.max(Fe.max.y,Ye.max.y),te[2]=r.ab-Ye.min.x>Fe.max.x?Ye.min.x-r.ab:Fe.max.x,te),fe=(Fe,Ye)=>(te[0]=Math.min(Fe.min.x,Ye.min.x),te[1]=Math.max(Fe.max.x,Ye.max.x),te[2]=r.ab-Ye.min.y>Fe.max.y?Ye.min.y-r.ab:Fe.max.y,te),me=[(Fe,Ye)=>ue(Fe,Ye),(Fe,Ye)=>ue(Ye,Fe),(Fe,Ye)=>fe(Fe,Ye),(Fe,Ye)=>fe(Ye,Fe)],ke=(Fe,Ye,Je,qe,it,rt,mt)=>{if(!T)return 0;const dt=[[rt?Je:Fe,rt?Fe:Je,0],[rt?Je:Ye,rt?Ye:Je,0]],yt=mt<0?r.ab+mt:mt,Et=[rt?yt:(Fe+Ye)/2,rt?(Fe+Ye)/2:yt,0];return Je===0&&mt<0||Je!==0&&mt>0?T.getForTilePoints(it,[Et],!0,qe):dt.push(Et),T.getForTilePoints(c,dt,!0,$),Math.max(dt[0][2],dt[1][2],Et[2])/T.exaggeration()};for(let Fe=0;Fe<4;Fe++){const Ye=y.borderFeatureIndices[Fe];if(Ye.length===0)continue;const Je=r.c$[Fe](c),qe=ee(Je);if(!(qe&&qe instanceof r.d0)||y.borderDoneWithNeighborZ[Fe]===qe.canonical.z)continue;qe.centroidVertexArray.length===0&&qe.createCentroidsBuffer();const it=T?T.findDEMTileFor(Je):null;if(!(it&&it.dem||A))continue;const rt=(Fe<2?1:5)-Fe,mt=qe.borderDoneWithNeighborZ[rt]!==y.canonical.z,dt=qe.borderFeatureIndices[rt];let yt=0;if(y.canonical.z!==qe.canonical.z){for(const Et of Ye)y.showCentroid(y.featuresOnBorder[Et]);if(mt)for(const Et of dt)qe.showCentroid(qe.featuresOnBorder[Et]);y.borderDoneWithNeighborZ[Fe]=qe.canonical.z,qe.borderDoneWithNeighborZ[rt]=y.canonical.z}for(const Et of Ye){const bt=y.featuresOnBorder[Et],vt=y.centroidData[bt.centroidDataIndex],Ot=bt.borders[Fe];let sn;for(;yt<dt.length;){sn=qe.featuresOnBorder[dt[yt]];const mn=sn.borders[rt];if(mn[1]>Ot[0]+3||mn[0]>Ot[0]-3)break;qe.showCentroid(sn),yt++}if(sn&&yt<dt.length){const mn=yt;let on=0;for(;!(sn.borders[rt][0]>Ot[1]-3)&&(on++,++yt!==dt.length);)sn=qe.featuresOnBorder[dt[yt]];sn=qe.featuresOnBorder[dt[mn]];let Tn=!1;if(on>=1){const cn=sn.borders[rt];Math.abs(Ot[0]-cn[0])<3&&Math.abs(Ot[1]-cn[1])<3&&(on=1,Tn=!0,yt=mn+1)}else if(on===0){y.showCentroid(bt);continue}const Dt=qe.centroidData[sn.centroidDataIndex];A&&Tn&&(((Le=vt).flags|(De=Dt).flags)&r.d1?(Le.flags|=r.d1,De.flags|=r.d1):(Le.flags&=~r.d1,De.flags&=~r.d1));const dn=bt.intersectsCount()>1||sn.intersectsCount()>1;if(on>1)yt=mn,vt.centroidXY=Dt.centroidXY=new r.P(0,0);else if(it&&it.dem&&!dn){const cn=me[Fe](vt,Dt),In=Fe%2?r.ab-1:0,An=ke(cn[0],Math.min(r.ab-1,cn[1]),In,it,Je,Fe<2,cn[2]);vt.centroidXY=Dt.centroidXY=Y(An)}else dn?vt.centroidXY=Dt.centroidXY=new r.P(0,0):(vt.centroidXY=y.encodeBorderCentroid(bt),Dt.centroidXY=qe.encodeBorderCentroid(sn));y.writeCentroidToBuffer(vt),qe.writeCentroidToBuffer(Dt)}else y.showCentroid(bt)}y.borderDoneWithNeighborZ[Fe]=qe.canonical.z,qe.borderDoneWithNeighborZ[rt]=y.canonical.z}var Le,De;(y.needsCentroidUpdate||!y.centroidVertexBuffer&&y.centroidVertexArray.length!==0)&&y.uploadCentroid(g)}const W1=[1,0,0],J0=[0,1,0],Q0=[0,0,1];function e_(g,o,c){const y=c.transform,S=c.shadowRenderer;if(!S)return!0;const T=g.toUnwrapped(),A=y.tileSize*S._cascades[c.currentShadowCascade].scale;let $=o.maxHeight;if(y.elevation){const Le=y.elevation.getMinMaxForTile(g);Le&&($+=Le.max)}const Y=[...S.shadowDirection];Y[2]=-Y[2];const ee=S.computeSimplifiedTileShadowVolume(T,$,A,Y);if(!ee)return!1;const te=[W1,J0,Q0,Y,[Y[0],0,Y[2]],[0,Y[1],Y[2]]],ue=y.projection.name==="globe",fe=y.scaleZoom(A),me=r.bN.fromInvProjectionMatrix(y.invProjMatrix,y.worldSize,fe,!ue),ke=S.getCurrentCascadeFrustum();return me.intersectsPrecise(ee.vertices,ee.planes,te)===0||ke.intersectsPrecise(ee.vertices,ee.planes,te)===0}function t_(g){return[g[0]*r.d4,g[1]*r.d4,g[2]*r.d4,0]}function nl(g,o,c,y,S,T,A,$,Y){const ee=y.getSource(),te=c.globeSharedBuffers;if(!te)return;let ue,fe,me;if(o&&(ue=y.getTile(o)),ee instanceof r.aD?(fe=ee.texture,me=r.cD(0,0,c.transform)):ue&&o&&(fe=ue.texture,me=r.cD(o.canonical.z,o.canonical.x,c.transform)),!fe||!me)return;g||(me=r.a6.mat4.scale(r.a6.mat4.create(),me,[1,-1,1]));const ke=c.context,Le=ke.gl,De=S.paint.get("raster-resampling")==="nearest"?Le.NEAREST:Le.LINEAR,Fe=c.colorModeForDrapableLayerRenderPass(T),Ye=A.defines;Ye.push("GLOBE_POLES");const Je=new cr(Le.LEQUAL,cr.ReadWrite,c.depthRangeFor3D),qe=Float32Array.from(c.transform.expandedFarZProjMatrix),it=Float32Array.from(r.b5(r.cC(new r.bP(0,0,0))));c.terrain&&c.terrain.prepareDrawTile(),ke.activeTexture.set(Le.TEXTURE0),fe.bind(De,Le.CLAMP_TO_EDGE),ke.activeTexture.set(Le.TEXTURE1),fe.bind(De,Le.CLAMP_TO_EDGE),fe.useMipmap&&ke.extTextureFilterAnisotropic&&c.transform.pitch>20&&Le.texParameterf(Le.TEXTURE_2D,ke.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,ke.extTextureFilterAnisotropicMax);const[rt,mt,dt,yt]=o?te.getPoleBuffers(o.canonical.z,!1):te.getPoleBuffers(0,!0),Et=S.paint.get("raster-elevation");let bt;g?(bt=rt,c.renderDefaultNorthPole=Et!==0):(bt=mt,c.renderDefaultSouthPole=Et!==0);const vt=t_(A.mix),Ot=((mn,on,Tn,Dt,dn,cn,In,An,pn,_n,_r,Vn,tr)=>Mp(mn,on,Tn,new Float32Array(16),new Float32Array(9),[0,0],Dt,[0,0],[0,0,0,0],1,{opacity:1,mix:0},cn,[0,0],An,2,_n,_r,Vn,1,0,tr))(qe,it,me,r.a9(c.transform.zoom),0,S,0,Et,0,vt,A.offset,A.range,T),sn=c.getOrCreateProgram("raster",{defines:Ye});c.uploadCommonUniforms(ke,sn,null),sn.draw(c,Le.TRIANGLES,Je,Y,Fe,$,Ot,S.id,bt,dt,yt)}function Fo(g){const o=g._nearZ,c=g.projection.farthestPixelDistance(g),y=c-o,S=.2*g.height,T=o+S;return[o,c,(T-S-o)/y,(T-o)/y]}function sg(g,o,c,y){if(g)return o instanceof ns&&g instanceof Ce?o.getTextureDescriptor(g,c,!0):{texture:g.texture,mix:t_(y.mix),offset:y.offset,buffer:0,tileSize:1}}var n_=r.d5([{name:"a_index",type:"Int16",components:1}]);class q1{constructor(o,c,y,S){const T={width:y[0],height:y[1],data:null},A=o.gl;this.targetColorTexture=new r.T(o,T,A.RGBA8,{useMipmap:!1}),this.backgroundColorTexture=new r.T(o,T,A.RGBA8,{useMipmap:!1}),this.context=o,this.updateParticleTexture(c,S),this.lastInvalidatedAt=0}updateParticleTexture(o,c){if(this.particleTextureDimension===c.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());const y=this.context.gl,S=c.width*c.height;this.particleTexture0=new r.T(this.context,c,y.RGBA8,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new r.T(this.context,c,y.RGBA8,{premultiply:!1,useMipmap:!1});const T=new r.d6;T.reserve(S);for(let A=0;A<S;A++)T.emplaceBack(A);this.particleIndexBuffer=this.context.createVertexBuffer(T,n_.members,!0),this.particleSegment=r.b1.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=c.width}update(o){return!(this.lastInvalidatedAt<o&&(this.lastInvalidatedAt=r.q.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}function X1(g,o,c){if(!g)return null;const y=o.getTextureDescriptor(g,c,!0);if(!y)return null;let{texture:S,mix:T,offset:A,tileSize:$,buffer:Y,format:ee}=y;if(!S||!ee)return null;let te=!1;return ee==="uint32"&&(te=!0,T[3]=0,T=Km(r.d7,T,[0,c.paint.get("raster-particle-max-speed")]),A=Jm(r.d7,A,[0,c.paint.get("raster-particle-max-speed")])),{texture:S,textureOffset:[Y/($+2*Y),$/($+2*Y)],tileSize:$,scalarData:te,scale:T,offset:A,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[ee]]}}function Y1(g){const o=g._nearZ,c=g.projection.farthestPixelDistance(g),y=c-o,S=.2*g.height,T=o+S;return[o,c,(T-S-o)/y,(T-o)/y]}const aT=new r.bz(1,0,0,1),nf=new r.bz(0,1,0,1),rf=new r.bz(0,0,1,1),zn=new r.bz(1,0,1,1),gr=new r.bz(0,1,1,1);function fu(g,o,c,y,S,T,A){const $=g.context,Y=g.transform,ee=$.gl,te=Y.projection.name==="globe",ue=te?["PROJECTION_GLOBE_VIEW"]:[];let fe=r.a6.mat4.clone(c.projMatrix);if(te&&r.a9(Y.zoom)>0){const vt=r.b4(c.canonical,Y),Ot=r.d8(vt);fe=r.a6.mat4.multiply(new Float32Array(16),Y.globeMatrix,Ot),r.a6.mat4.multiply(fe,Y.projMatrix,fe)}const me=r.a6.mat4.create();me[12]+=2*S/(r.q.devicePixelRatio*Y.width),me[13]+=2*T/(r.q.devicePixelRatio*Y.height),r.a6.mat4.multiply(fe,me,fe);const ke=g.getOrCreateProgram("debug",{defines:ue}),Le=o.getTileByID(c.key);g.terrain&&g.terrain.setupElevationDraw(Le,ke);const De=cr.disabled,Fe=Dr.disabled,Ye=g.colorModeForRenderPass(),Je="$debug";$.activeTexture.set(ee.TEXTURE0),g.emptyTexture.bind(ee.LINEAR,ee.CLAMP_TO_EDGE),te?Le._makeGlobeTileDebugBuffers(g.context,Y):Le._makeDebugTileBoundsBuffers(g.context,Y.projection);const qe=Le._tileDebugBuffer||g.debugBuffer,it=Le._tileDebugIndexBuffer||g.debugIndexBuffer,rt=Le._tileDebugSegments||g.debugSegments;if(ke.draw(g,ee.LINE_STRIP,De,Fe,Ye,Mr.disabled,V1(fe,y),Je,qe,it,rt,null,null,null,[Le._globeTileDebugBorderBuffer]),A){const vt=Le.latestRawTileData,Ot=Math.floor((vt&&vt.byteLength||0)/1024);let sn=c.canonical.toString();c.overscaledZ!==c.canonical.z&&(sn+=` => ${c.overscaledZ}`),sn+=` ${Le.state}`,sn+=` ${Ot}kb`,function(mn,on){mn.initDebugOverlayCanvas();const Tn=mn.debugOverlayCanvas,Dt=mn.context.gl,dn=mn.debugOverlayCanvas.getContext("2d");dn.clearRect(0,0,Tn.width,Tn.height),dn.shadowColor="white",dn.shadowBlur=2,dn.lineWidth=1.5,dn.strokeStyle="white",dn.textBaseline="top",dn.font="bold 36px Open Sans, sans-serif",dn.fillText(on,5,5),dn.strokeText(on,5,5),mn.debugOverlayTexture.update(Tn),mn.debugOverlayTexture.bind(Dt.LINEAR,Dt.CLAMP_TO_EDGE)}(g,sn)}const mt=o.getTile(c).tileSize,dt=512/Math.min(mt,512)*(c.overscaledZ/Y.zoom)*.5,yt=Le._tileDebugTextBuffer||g.debugBuffer,Et=Le._tileDebugTextIndexBuffer||g.quadTriangleIndexBuffer,bt=Le._tileDebugTextSegments||g.debugSegments;ke.draw(g,ee.TRIANGLES,De,Fe,Hr.alphaBlended,Mr.disabled,V1(fe,r.bz.transparent,dt),Je,yt,Et,bt,null,null,null,[Le._globeTileDebugTextBuffer])}function vo(g,o,c,y){Rp(g,0,o+c/2,g.transform.width,c,y)}function $t(g,o,c,y){Rp(g,o-c/2,0,c,g.transform.height,y)}function Rp(g,o,c,y,S,T){const A=g.context,$=A.gl;$.enable($.SCISSOR_TEST),$.scissor(o*r.q.devicePixelRatio,c*r.q.devicePixelRatio,y*r.q.devicePixelRatio,S*r.q.devicePixelRatio),A.clear({color:T}),$.disable($.SCISSOR_TEST)}const ag=r.d5([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:r_}=ag;function pu(g,o,c,y){g.emplaceBack(o,c,y)}class i_{constructor(o){this.vertexArray=new r.d9,this.indices=new r.aO,pu(this.vertexArray,-1,-1,1),pu(this.vertexArray,1,-1,1),pu(this.vertexArray,-1,1,1),pu(this.vertexArray,1,1,1),pu(this.vertexArray,-1,-1,-1),pu(this.vertexArray,1,-1,-1),pu(this.vertexArray,-1,1,-1),pu(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=o.createVertexBuffer(this.vertexArray,r_),this.indexBuffer=o.createIndexBuffer(this.indices),this.segment=r.b1.simpleSegment(0,0,36,12)}}function ah(g,o,c,y,S,T){const A=g.context.gl,$=o.paint.get("sky-atmosphere-color"),Y=o.paint.get("sky-atmosphere-halo-color"),ee=o.paint.get("sky-atmosphere-sun-intensity"),te=((ue,fe,me,ke,Le)=>({u_matrix_3f:ue,u_sun_direction:fe,u_sun_intensity:me,u_color_tint_r:[ke.r,ke.g,ke.b,ke.a],u_color_tint_m:[Le.r,Le.g,Le.b,Le.a],u_luminance:5e-5}))(r.a6.mat3.fromMat4(r.a6.mat3.create(),y),S,ee,$,Y);A.framebufferTexture2D(A.FRAMEBUFFER,A.COLOR_ATTACHMENT0,A.TEXTURE_CUBE_MAP_POSITIVE_X+T,o.skyboxTexture,0),c.draw(g,A.TRIANGLES,cr.disabled,Dr.disabled,Hr.unblended,Mr.frontCW,te,"skyboxCapture",o.skyboxGeometry.vertexBuffer,o.skyboxGeometry.indexBuffer,o.skyboxGeometry.segment)}const of=r.d5([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class lT{constructor(o){const c=new r.da;c.emplaceBack(-1,1,1,0,0),c.emplaceBack(1,1,1,1,0),c.emplaceBack(1,-1,1,1,1),c.emplaceBack(-1,-1,1,0,1);const y=new r.aO;y.emplaceBack(0,1,2),y.emplaceBack(2,3,0),this.vertexBuffer=o.createVertexBuffer(c,of.members),this.indexBuffer=o.createIndexBuffer(y),this.segments=r.b1.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const uT=r.d5([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class Z1{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class lg{constructor(o){this.colorModeAlphaBlendedWriteRGB=new Hr([1,Ds,1,Ds],r.bz.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new Hr([1,0,1,0],r.bz.transparent,[!1,!1,!1,!0]),this.params=new Z1,this.updateNeeded=!0,o.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},()=>{this.updateNeeded=!0}),o.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),o.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0}),o.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0})}update(o){const c=o.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new lT(c);const y=this.params.sizeRange,S=this.params.intensityRange,T=function(te){const ue=r.dd(30),fe=[];for(let me=0;me<te;++me){const ke=2*Math.PI*ue(),Le=Math.acos(1-2*ue())-.5*Math.PI;fe.push(r.a6.vec3.fromValues(Math.cos(Le)*Math.cos(ke),Math.cos(Le)*Math.sin(ke),Math.sin(Le)))}return fe}(this.params.starsCount),A=r.dd(300),$=new r.db,Y=new r.aO;let ee=0;for(let te=0;te<T.length;++te){const ue=r.a6.vec3.scale([],T[te],200),fe=Math.max(0,1+.01*y*(1*A()-.5)),me=Math.max(0,1+.01*S*(1*A()-.5));$.emplaceBack(ue[0],ue[1],ue[2],-1,-1,fe,me),$.emplaceBack(ue[0],ue[1],ue[2],1,-1,fe,me),$.emplaceBack(ue[0],ue[1],ue[2],1,1,fe,me),$.emplaceBack(ue[0],ue[1],ue[2],-1,1,fe,me),Y.emplaceBack(ee+0,ee+1,ee+2),Y.emplaceBack(ee+0,ee+2,ee+3),ee+=4}this.starsVx=c.createVertexBuffer($,uT.members),this.starsIdx=c.createIndexBuffer(Y),this.starsSegments=r.b1.simpleSegment(0,0,$.length,Y.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(o,c){const y=o.context,S=y.gl,T=o.transform,A=new cr(S.LEQUAL,cr.ReadOnly,[0,1]),$=r.a9(T.zoom),Y=o.style.getLut(c.scope),ee=c.properties.get("color").toRenderColor(Y).toArray01(),te=c.properties.get("high-color").toRenderColor(Y).toArray01(),ue=c.properties.get("space-color").toRenderColor(Y).toArray01PremultipliedAlpha(),fe=5e-4,me=r.dc(c.properties.get("horizon-blend"),0,1,fe,.25),ke=r.cx(o,y,T)&&me===fe?T.worldSize/(2*Math.PI*1.025)-1:T.globeRadius,Le=o.frameCounter/1e3%1,De=r.a6.vec3.length(T.globeCenterInViewSpace),Fe=Math.sqrt(Math.pow(De,2)-Math.pow(ke,2)),Ye=Math.acos(Fe/De),Je=qe=>{const it=T.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];qe&&it.push("ALPHA_PASS");const rt=o.getOrCreateProgram("globeAtmosphere",{defines:it}),mt=((yt,Et,bt,vt,Ot,sn,mn,on,Tn,Dt,dn,cn)=>({u_frustum_tl:yt,u_frustum_tr:Et,u_frustum_br:bt,u_frustum_bl:vt,u_horizon:Ot,u_transition:sn,u_fadeout_range:mn,u_color:on,u_high_color:Tn,u_space_color:Dt,u_temporal_offset:dn,u_horizon_angle:cn}))(T.frustumCorners.TL,T.frustumCorners.TR,T.frustumCorners.BR,T.frustumCorners.BL,T.frustumCorners.horizon,$,me,ee,te,ue,Le,Ye);o.uploadCommonUniforms(y,rt);const dt=this.atmosphereBuffer;dt&&rt.draw(o,S.TRIANGLES,A,Dr.disabled,qe?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,Mr.backCW,mt,qe?"atmosphere_glow_alpha":"atmosphere_glow",dt.vertexBuffer,dt.indexBuffer,dt.segments)};Je(!1),Je(!0)}drawStars(o,c){const y=r.ap(c.properties.get("star-intensity"),0,1);if(y===0)return;const S=o.context,T=S.gl,A=o.transform,$=o.getOrCreateProgram("stars"),Y=r.a6.quat.identity([]);r.a6.quat.rotateX(Y,Y,-A._pitch),r.a6.quat.rotateZ(Y,Y,-A.angle),r.a6.quat.rotateX(Y,Y,r.bB(A._center.lat)),r.a6.quat.rotateY(Y,Y,-r.bB(A._center.lng));const ee=r.a6.mat4.fromQuat(new Float32Array(16),Y),te=r.a6.mat4.multiply([],A.starsProjMatrix,ee),ue=r.a6.mat3.fromMat4([],ee),fe=r.a6.mat3.invert([],ue),me=[0,1,0];r.a6.vec3.transformMat3(me,me,fe),r.a6.vec3.scale(me,me,this.params.sizeMultiplier);const ke=[1,0,0];r.a6.vec3.transformMat3(ke,ke,fe),r.a6.vec3.scale(ke,ke,this.params.sizeMultiplier);const Le=(De=me,Fe=ke,Ye=y,{u_matrix:Float32Array.from(te),u_up:De,u_right:Fe,u_intensity_multiplier:Ye});var De,Fe,Ye;o.uploadCommonUniforms(S,$),this.starsVx&&this.starsIdx&&$.draw(o,T.TRIANGLES,cr.disabled,Dr.disabled,this.colorModeAlphaBlendedWriteRGB,Mr.disabled,Le,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function ug(g,o){const c=[...g],y=o.cameraWorldSizeForFog/o.worldSize,S=r.a6.mat4.identity([]);return r.a6.mat4.scale(S,S,[y,y,1]),r.a6.mat4.multiply(c,S,c),r.a6.mat4.multiply(c,o.worldToFogMatrix,c),c}function cg(g,o,c,y,S){const T=c.material,A=y.context,{baseColorTexture:$,metallicRoughnessTexture:Y}=T.pbrMetallicRoughness,{normalTexture:ee,occlusionTexture:te,emissionTexture:ue}=T;function fe(me,ke,Le){if(me&&(g.push(ke),A.activeTexture.set(A.gl.TEXTURE0+Le),me.gfxTexture)){const{minFilter:De,magFilter:Fe,wrapS:Ye,wrapT:Je}=me.sampler;me.gfxTexture.bindExtraParam(De,Fe,Ye,Je)}}fe($,"HAS_TEXTURE_u_baseColorTexture",cs.BaseColor),fe(Y,"HAS_TEXTURE_u_metallicRoughnessTexture",cs.MetallicRoughness),fe(ee,"HAS_TEXTURE_u_normalTexture",cs.Normal),fe(te,"HAS_TEXTURE_u_occlusionTexture",cs.Occlusion),fe(ue,"HAS_TEXTURE_u_emissionTexture",cs.Emission),S&&(S.texture||(S.texture=new r.df(y.context,S.image,[S.image.height,S.image.height,S.image.height],A.gl.RGBA8)),A.activeTexture.set(A.gl.TEXTURE0+cs.LUT),S.texture&&S.texture.bind(A.gl.LINEAR,A.gl.CLAMP_TO_EDGE),g.push("APPLY_LUT_ON_GPU")),c.texcoordBuffer&&(g.push("HAS_ATTRIBUTE_a_uv_2f"),o.push(c.texcoordBuffer)),c.colorBuffer&&(g.push(c.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),o.push(c.colorBuffer)),c.normalBuffer&&(g.push("HAS_ATTRIBUTE_a_normal_3f"),o.push(c.normalBuffer)),c.pbrBuffer&&(g.push("HAS_ATTRIBUTE_a_pbr"),g.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),o.push(c.pbrBuffer)),T.alphaMode!=="OPAQUE"&&T.alphaMode!=="MASK"||g.push("UNPREMULT_TEXTURE_IN_SHADER"),T.defined||g.push("DIFFUSE_SHADED"),g.push("USE_STANDARD_DERIVATIVES")}function Op(g,o,c,y,S,T){const A=c.paint.get("model-opacity"),$=o.context,Y=new cr(o.context.gl.LEQUAL,cr.ReadWrite,o.depthRangeFor3D),ee=o.transform,te=g.mesh,ue=te.material,fe=ue.pbrMetallicRoughness,me=o.style.fog;let ke;ke=o.transform.projection.zAxisUnit==="pixels"?[...g.nodeModelMatrix]:r.a6.mat4.multiply([],y.zScaleMatrix,g.nodeModelMatrix),r.a6.mat4.multiply(ke,y.negCameraPosMatrix,ke);const Le=r.a6.mat4.invert([],ke);r.a6.mat4.transpose(Le,Le);const De=c.paint.get("model-emissive-strength").constantOr(0),Fe=ir(new Float32Array(g.worldViewProjection),new Float32Array(ke),new Float32Array(Le),null,o,A,fe.baseColorFactor.toRenderColor(null),ue.emissiveFactor,fe.metallicFactor,fe.roughnessFactor,ue,De,c),Ye={defines:[]},Je=[];cg(Ye.defines,Je,te,o,c.lut);const qe=o.shadowRenderer;qe&&(qe.useNormalOffset=!1);let it=null;if(me){const dt=ug(g.nodeModelMatrix,o.transform);if(it=new Float32Array(dt),ee.projection.name!=="globe"){const yt=te.aabb.min,Et=te.aabb.max,[bt,vt]=me.getOpacityForBounds(dt,yt[0],yt[1],Et[0],Et[1]);Ye.overrideFog=bt>=Nt||vt>=Nt}}const rt=zs(o,c.paint.get("model-cutoff-fade-range"));rt.shouldRenderCutoff&&Ye.defines.push("RENDER_CUTOFF");const mt=o.getOrCreateProgram("model",Ye);o.uploadCommonUniforms($,mt,null,it,rt),o.renderPass!=="shadow"&&qe&&qe.setupShadowsFromMatrix(g.nodeModelMatrix,mt),mt.draw(o,$.gl.TRIANGLES,Y,S,T,te.material.doubleSided?Mr.disabled:Mr.backCCW,Fe,c.id,te.vertexBuffer,te.indexBuffer,te.segments,c.paint,o.transform.zoom,void 0,Je)}function Dp(g,o,c,y,S,T,A){let $;$=g.projection.name==="globe"?r.dg(c,g):[...c],r.a6.mat4.multiply($,$,o.matrix);const Y=r.a6.mat4.multiply([],y,$);if(o.meshes)for(const ee of o.meshes){if(ee.material.alphaMode!=="BLEND"){A.push({mesh:ee,depth:0,modelIndex:S,worldViewProjection:Y,nodeModelMatrix:$});continue}const te=r.a6.vec3.transformMat4([],ee.centroid,Y);te[2]>0&&T.push({mesh:ee,depth:te[2],modelIndex:S,worldViewProjection:Y,nodeModelMatrix:$})}if(o.children)for(const ee of o.children)Dp(g,ee,c,y,S,T,A)}function sf(g,o,c,y){const S=c.shadowRenderer;if(!S)return;const T=S.getShadowPassDepthMode(),A=S.getShadowPassColorMode(),$=S.calculateShadowPassMatrixFromMatrix(o),Y=Z0($);c.getOrCreateProgram("modelDepth",{defines:c._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(c,c.context.gl.TRIANGLES,T,Dr.disabled,A,Mr.backCCW,Y,y.id,g.vertexBuffer,g.indexBuffer,g.segments,y.paint,c.transform.zoom,void 0,void 0)}function K1(g,o,c){const y=o.updateZoomBasedPaintProperties(),S=function(T,A,$){let Y,ee,te,ue=T.terrain?T.terrain.exaggeration():0;if(T.terrain&&ue>0){const fe=T.terrain,me=fe.findDEMTileFor($);me&&me.dem?Y=r.di.create(fe,$,me):ue=0}if(ue===0&&(A.terrainElevationMin=0,A.terrainElevationMax=0),ue===A.validForExaggeration&&(ue===0||Y&&Y._demTile&&Y._demTile.tileID===A.validForDEMTile.id&&Y._dem._timestamp===A.validForDEMTile.timestamp))return!1;for(const fe in A.instancesPerModel){const me=A.instancesPerModel[fe];for(let ke=0;ke<me.instancedDataArray.length;++ke){const Le=(Y?ue*Y.getElevationAt(0|me.instancedDataArray.float32[16*ke],0|me.instancedDataArray.float32[16*ke+1],!0,!0):0)+me.instancesEvaluatedElevation[ke];me.instancedDataArray.float32[16*ke+6]=Le,ee=ee?Math.min(A.terrainElevationMin,Le):Le,te=te?Math.max(A.terrainElevationMax,Le):Le}}return A.terrainElevationMin=ee||0,A.terrainElevationMax=te||0,A.validForExaggeration=ue,A.validForDEMTile=Y&&Y._demTile?{id:Y._demTile.tileID,timestamp:Y._dem._timestamp}:{id:void 0,timestamp:0},!0}(g,o,c);(y||S)&&(o.uploaded=!1,o.upload(g.context))}const mu={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new r.c9([0,0,0],[r.ab,r.ab,0])};function cT(g,o){const c=1<<g.canonical.z,y=o.getFreeCameraOptions().position,S=o.elevation,T=g.canonical.x/c,A=(g.canonical.x+1)/c,$=g.canonical.y/c,Y=(g.canonical.y+1)/c;let ee=o._centerAltitude;if(S){const me=S.getMinMaxForTile(g);me&&me.max>ee&&(ee=me.max)}const te=r.ap(y.x,T,A)-y.x,ue=r.ap(y.y,$,Y)-y.y,fe=r.bD(ee,o.center.lat)-y.z;return o._zoomFromMercatorZ(Math.sqrt(te*te+ue*ue+fe*fe))}function ba(g,o,c,y,S,T,A){const $=g.context,Y=g.renderPass==="shadow",ee=g.shadowRenderer,te=Y&&ee?ee.getShadowPassDepthMode():new cr($.gl.LEQUAL,cr.ReadWrite,g.depthRangeFor3D),ue=g.isTileAffectedByFog(T);if(c.meshes)for(const fe of c.meshes){const me=["MODEL_POSITION_ON_GPU"],ke=[];let Le,De,Fe;y.instancedDataArray.length>20&&me.push("INSTANCED_ARRAYS");const Ye=zs(g,o.paint.get("model-cutoff-fade-range"));if(Ye.shouldRenderCutoff&&me.push("RENDER_CUTOFF"),Y&&ee)Le=g.getOrCreateProgram("modelDepth",{defines:me}),De=Z0(A.shadowTileMatrix,A.shadowTileMatrix,Float32Array.from(c.matrix)),Fe=ee.getShadowPassColorMode();else{cg(me,ke,fe,g,o.lut),Le=g.getOrCreateProgram("model",{defines:me,overrideFog:ue});const qe=fe.material,it=qe.pbrMetallicRoughness,rt=o.paint.get("model-opacity"),mt=o.paint.get("model-emissive-strength").constantOr(0);De=ir(T.expandedProjMatrix,Float32Array.from(c.matrix),new Float32Array(16),null,g,rt,it.baseColorFactor.toRenderColor(null),qe.emissiveFactor,it.metallicFactor,it.roughnessFactor,qe,mt,o,S),ee&&(A.shadowUniformsInitialized?Le.setShadowUniformValues($,ee.getShadowUniformValues()):(ee.setupShadows(T.toUnwrapped(),Le,"model-tile",T.overscaledZ),A.shadowUniformsInitialized=!0)),Fe=Ye.shouldRenderCutoff||rt<1||qe.alphaMode!=="OPAQUE"?Hr.alphaBlended:Hr.unblended}g.uploadCommonUniforms($,Le,T.toUnwrapped(),null,Ye);const Je=fe.material.doubleSided?Mr.disabled:Mr.backCCW;if(y.instancedDataArray.length>20)ke.push(y.instancedDataBuffer),Le.draw(g,$.gl.TRIANGLES,te,Dr.disabled,Fe,Je,De,o.id,fe.vertexBuffer,fe.indexBuffer,fe.segments,o.paint,g.transform.zoom,void 0,ke,y.instancedDataArray.length);else{const qe=Y?"u_instance":"u_normal_matrix";for(let it=0;it<y.instancedDataArray.length;++it)De[qe]=new Float32Array(y.instancedDataArray.arrayBuffer,64*it,16),Le.draw(g,$.gl.TRIANGLES,te,Dr.disabled,Fe,Je,De,o.id,fe.vertexBuffer,fe.indexBuffer,fe.segments,o.paint,g.transform.zoom,void 0,ke)}}if(c.children)for(const fe of c.children)ba(g,o,fe,y,S,T,A)}const dT=[1,-1,1];function zp(g,o,c,y){if(!c.modelManager)return!0;const S=c.modelManager;if(!c.shadowRenderer)return!0;const T=c.shadowRenderer,A=o.aabb;let $=!0,Y=g.maxHeight;if(Y===0){let te=0;for(const ue in g.instancesPerModel){const fe=S.getModel(ue,y);fe?te=Math.max(te,Math.max(Math.max(fe.aabb.max[0],fe.aabb.max[1]),fe.aabb.max[2])):$=!1}Y=g.maxScale*te*1.41+g.maxVerticalOffset,$&&(g.maxHeight=Y)}A.max[2]=Y,A.min[2]+=g.terrainElevationMin,A.max[2]+=g.terrainElevationMax,r.a6.vec3.transformMat4(A.min,A.min,o.tileMatrix),r.a6.vec3.transformMat4(A.max,A.max,o.tileMatrix);const ee=A.intersects(T.getCurrentCascadeFrustum());return c.currentShadowCascade===0&&(g.isInsideFirstShadowMapFrustum=ee===2),ee===0}function fo(g,o){const c=g.uniformValues.u_cutoff_params[0],y=g.uniformValues.u_cutoff_params[1],S=g.uniformValues.u_cutoff_params[2],T=g.uniformValues.u_cutoff_params[3];return y===c||T===S?1:r.ap(((o-c)/(y-c)-S)/(T-S),0,1)}function wi(g,o,c,y){if(o.pitch<20)return 1;const S=o.getWorldToCameraMatrix();r.a6.mat4.multiply(S,S,g);const T=r.a6.vec4.fromValues(c.min[0],c.min[1],c.min[2],1);let A=r.a6.vec4.transformMat4(r.a6.vec4.create(),T,S),$=A,Y=A;T[1]=c.max[1],A=r.a6.vec4.transformMat4(r.a6.vec4.create(),T,S),$=A[1]<$[1]?A:$,Y=A[1]>Y[1]?A:Y,T[0]=c.max[0],A=r.a6.vec4.transformMat4(r.a6.vec4.create(),T,S),$=A[1]<$[1]?A:$,Y=A[1]>Y[1]?A:Y,T[1]=c.min[1],A=r.a6.vec4.transformMat4(r.a6.vec4.create(),T,S),$=A[1]<$[1]?A:$,Y=A[1]>Y[1]?A:Y;const ee=r.ap(y[0],0,1),te=100*o.pixelsPerMeter*r.ap(y[1],0,1),ue=r.ap(y[2],0,1),fe=r.a6.vec4.lerp(r.a6.vec4.create(),$,Y,ee),me=Math.tan(.5*o.fovX),ke=-fe[2]*me;if(te===0)return fe[1]<-Math.abs(ke)?ue:1;const Le=(-Math.abs(ke)-fe[1])/te,De=(Ye,Je,qe)=>(1-qe)*Ye+qe*Je,Fe=r.ap(De(1,ue,Le),ue,1);return De(1,Fe,r.ap((o.pitch-20)/20,0,1))}class J1{}class yd{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(o,c,y){{const ue=this._storage.get(c.id);if(ue)return ue.lastUsedFrameIdx=o,ue.buf}const S=y.gl,T=S.getBufferParameter(S.ELEMENT_ARRAY_BUFFER,S.BUFFER_SIZE),A=new ArrayBuffer(T),$=new Int16Array(A);S.getBufferSubData(S.ELEMENT_ARRAY_BUFFER,0,new Int16Array(A));const Y=new r.dk;for(let ue=0;ue<T/2;ue+=3){const fe=$[ue],me=$[ue+1],ke=$[ue+2];Y.emplaceBack(fe,me),Y.emplaceBack(me,ke),Y.emplaceBack(ke,fe)}const ee=y.bindVertexArrayOES.current,te=new J1;return te.buf=new tl(y,Y),te.lastUsedFrameIdx=o,this._storage.set(c.id,te),y.bindVertexArrayOES.set(ee),te.buf}update(o){for(const[c,y]of this._storage)o-y.lastUsedFrameIdx>30&&(y.buf.destroy(),this._storage.delete(c))}destroy(){for(const[o,c]of this._storage)c.buf.destroy(),this._storage.delete(o)}}class dg{constructor(o){this.occluderSize=30,this.depthOffset=-1e-4,o.registerParameter(this,["Occlusion"],"occluderSize",{min:1,max:100,step:1}),o.registerParameter(this,["Occlusion"],"depthOffset",{min:-.05,max:0,step:1e-5})}}const _d={symbol:function(g,o,c,y,S){if(g.renderPass!=="translucent")return;const T=Dr.disabled,A=g.colorModeForRenderPass();c.layout.get("text-variable-anchor")&&function(ee,te,ue,fe,me,ke,Le){const De=te.transform,Fe=me==="map",Ye=ke==="map";for(const Je of ee){const qe=fe.getTile(Je),it=qe.getBucket(ue);if(!it||!it.text||!it.text.segments.get().length)continue;const rt=r.bj(it.textSizeData,De.zoom),mt=Pa(Je,it.getProjection(),De),dt=De.calculatePixelsToTileUnitsMatrix(qe),yt=xr(mt,qe.tileID.canonical,Ye,Fe,De,it.getProjection(),dt),Et=it.hasIconTextFit()&&it.hasIconData();if(rt){const bt=Math.pow(2,De.zoom-qe.tileID.overscaledZ);sT(it,Fe,Ye,Le,r.cS,De,yt,Je,bt,rt,Et)}}}(y,g,c,o,c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),S);const $=c.paint.get("icon-opacity").constantOr(1)!==0,Y=c.paint.get("text-opacity").constantOr(1)!==0;c.layout.get("symbol-sort-key").constantOr(1)!==void 0&&($||Y)?Ap(g,o,c,y,T,A):($&&Ap(g,o,c,y,T,A,{onlyIcons:!0}),Y&&Ap(g,o,c,y,T,A,{onlyText:!0})),o.map.showCollisionBoxes&&(ig(g,o,c,y,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),!0),ig(g,o,c,y,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),!1))},circle:function(g,o,c,y){if(g.renderPass!=="translucent")return;const S=c.paint.get("circle-opacity"),T=c.paint.get("circle-stroke-width"),A=c.paint.get("circle-stroke-opacity"),$=c.layout.get("circle-sort-key").constantOr(1)!==void 0,Y=c.paint.get("circle-emissive-strength");if(S.constantOr(1)===0&&(T.constantOr(1)===0||A.constantOr(1)===0))return;const ee=g.context,te=ee.gl,ue=g.transform,fe=g.depthModeForSublayer(0,cr.ReadOnly),me=Dr.disabled,ke=g.colorModeForDrapableLayerRenderPass(Y),Le=ue.projection.name==="globe",De=[r.am(ue.center.lng),r.at(ue.center.lat)],Fe=[];for(let Je=0;Je<y.length;Je++){const qe=y[Je],it=o.getTile(qe),rt=it.getBucket(c);if(!rt||rt.projection.name!==ue.projection.name)continue;const mt=rt.programConfigurations.get(c.id),dt=r.cT(c),yt=g.isTileAffectedByFog(qe);Le&&dt.push("PROJECTION_GLOBE_VIEW"),dt.push("DEPTH_D24"),g.terrain&&ue.depthOcclusionForSymbolsAndCircles&&dt.push("DEPTH_OCCLUSION");const Et=g.getOrCreateProgram("circle",{config:mt,defines:dt,overrideFog:yt}),bt=rt.layoutVertexBuffer,vt=rt.globeExtVertexBuffer,Ot=rt.indexBuffer,sn=ue.projection.createInversionMatrix(ue,qe.canonical),mn={programConfiguration:mt,program:Et,layoutVertexBuffer:bt,globeExtVertexBuffer:vt,indexBuffer:Ot,uniformValues:r.cU(g,qe,it,sn,De,c),tile:it};if($){const on=rt.segments.get();for(const Tn of on)Fe.push({segments:new r.b1([Tn]),sortKey:Tn.sortKey,state:mn})}else Fe.push({segments:rt.segments,sortKey:0,state:mn})}$&&Fe.sort((Je,qe)=>Je.sortKey-qe.sortKey);const Ye={useDepthForOcclusion:ue.depthOcclusionForSymbolsAndCircles};for(const Je of Fe){const{programConfiguration:qe,program:it,layoutVertexBuffer:rt,globeExtVertexBuffer:mt,indexBuffer:dt,uniformValues:yt,tile:Et}=Je.state,bt=Je.segments;g.terrain&&g.terrain.setupElevationDraw(Et,it,Ye),g.uploadCommonUniforms(ee,it,Et.tileID.toUnwrapped()),it.draw(g,te.TRIANGLES,fe,me,ke,Mr.disabled,yt,c.id,rt,dt,bt,c.paint,ue.zoom,qe,[mt])}},heatmap:function(g,o,c,y){if(c.paint.get("heatmap-opacity")!==0)if(g.renderPass==="offscreen"){const S=g.context,T=S.gl,A=Dr.disabled,$=new Hr([T.ONE,T.ONE,T.ONE,T.ONE],r.bz.transparent,[!0,!0,!0,!0]);(function(me,ke,Le,De){const Fe=me.gl,Ye=ke.width*De,Je=ke.height*De;me.activeTexture.set(Fe.TEXTURE1),me.viewport.set([0,0,Ye,Je]);let qe=Le.heatmapFbo;if(!qe||qe&&(qe.width!==Ye||qe.height!==Je)){qe&&qe.destroy();const it=Fe.createTexture();Fe.bindTexture(Fe.TEXTURE_2D,it),Fe.texParameteri(Fe.TEXTURE_2D,Fe.TEXTURE_WRAP_S,Fe.CLAMP_TO_EDGE),Fe.texParameteri(Fe.TEXTURE_2D,Fe.TEXTURE_WRAP_T,Fe.CLAMP_TO_EDGE),Fe.texParameteri(Fe.TEXTURE_2D,Fe.TEXTURE_MIN_FILTER,Fe.LINEAR),Fe.texParameteri(Fe.TEXTURE_2D,Fe.TEXTURE_MAG_FILTER,Fe.LINEAR),qe=Le.heatmapFbo=me.createFramebuffer(Ye,Je,!0,null),function(rt,mt,dt,yt,Et,bt){const vt=rt.gl;vt.texImage2D(vt.TEXTURE_2D,0,rt.extRenderToTextureHalfFloat?vt.RGBA16F:vt.RGBA,Et,bt,0,vt.RGBA,rt.extRenderToTextureHalfFloat?vt.HALF_FLOAT:vt.UNSIGNED_BYTE,null),yt.colorAttachment.set(dt)}(me,0,it,qe,Ye,Je)}else Fe.bindTexture(Fe.TEXTURE_2D,qe.colorAttachment.get()),me.bindFramebuffer.set(qe.framebuffer)})(S,g,c,g.transform.projection.name==="globe"?.5:.25),S.clear({color:r.bz.transparent});const Y=g.transform,ee=Y.projection.name==="globe",te=ee?["PROJECTION_GLOBE_VIEW"]:[],ue=ee?Mr.frontCCW:Mr.disabled,fe=[r.am(Y.center.lng),r.at(Y.center.lat)];for(let me=0;me<y.length;me++){const ke=y[me];if(o.hasRenderableParent(ke))continue;const Le=o.getTile(ke),De=Le.getBucket(c);if(!De||De.projection.name!==Y.projection.name)continue;const Fe=g.isTileAffectedByFog(ke),Ye=De.programConfigurations.get(c.id),Je=g.getOrCreateProgram("heatmap",{config:Ye,defines:te,overrideFog:Fe}),{zoom:qe}=g.transform;g.terrain&&g.terrain.setupElevationDraw(Le,Je),g.uploadCommonUniforms(S,Je,ke.toUnwrapped());const it=Y.projection.createInversionMatrix(Y,ke.canonical);Je.draw(g,T.TRIANGLES,cr.disabled,A,$,ue,rT(g,ke,Le,it,fe,qe,c.paint.get("heatmap-intensity")),c.id,De.layoutVertexBuffer,De.indexBuffer,De.segments,c.paint,g.transform.zoom,Ye,ee?[De.globeExtVertexBuffer]:null)}S.viewport.set([0,0,g.width,g.height])}else g.renderPass==="translucent"&&(g.context.setColorMode(g.colorModeForRenderPass()),function(S,T){const A=S.context,$=A.gl,Y=T.heatmapFbo;if(!Y)return;A.activeTexture.set($.TEXTURE0),$.bindTexture($.TEXTURE_2D,Y.colorAttachment.get()),A.activeTexture.set($.TEXTURE1);let ee=T.colorRampTexture;ee||(ee=T.colorRampTexture=new r.T(A,T.colorRamp,$.RGBA8)),ee.bind($.LINEAR,$.CLAMP_TO_EDGE),S.getOrCreateProgram("heatmapTexture").draw(S,$.TRIANGLES,cr.disabled,Dr.disabled,S.colorModeForRenderPass(),Mr.disabled,((te,ue,fe,me)=>({u_image:0,u_color_ramp:1,u_opacity:ue.paint.get("heatmap-opacity")}))(0,T),T.id,S.viewportBuffer,S.quadTriangleIndexBuffer,S.viewportSegments,T.paint,S.transform.zoom)}(g,c))},line:function(g,o,c,y){if(g.renderPass!=="translucent")return;const S=c.paint.get("line-opacity"),T=c.paint.get("line-width");if(S.constantOr(1)===0||T.constantOr(1)===0)return;const A=c.paint.get("line-emissive-strength"),$=c.paint.get("line-occlusion-opacity"),Y=g.context,ee=Y.gl,te=c.layout.get("line-z-offset"),ue=!te.isConstant()||!!te.constantOr(0),fe=ue?new cr(g.depthOcclusion?ee.GREATER:ee.LEQUAL,cr.ReadOnly,g.depthRangeFor3D):g.depthModeForSublayer(0,cr.ReadOnly),me=g.colorModeForDrapableLayerRenderPass(A),ke=g.terrain&&g.terrain.renderingToTexture,Le=ke?1:r.q.devicePixelRatio,De=c.paint.get("line-dasharray"),Fe=De.constantOr(1),Ye=c.layout.get("line-cap"),Je=De.constantOr(null),qe=Ye.constantOr(null),it=c.paint.get("line-pattern"),rt=it.constantOr(1),mt=it.constantOr(null),dt=c.paint.get("line-opacity").constantOr(1);let yt=!rt&&dt!==1||g.depthOcclusion&&$>0&&$<1;const Et=c.paint.get("line-gradient"),bt=rt?"linePattern":"line",vt=r.cV(c);let Ot;if(ke&&g.terrain&&g.terrain.clipOrMaskOverlapStencilType()&&(yt=!1),$!==0&&g.depthOcclusion){const mn=c.paint._values["line-opacity"];mn&&mn.value&&mn.value.kind==="constant"?Ot=mn.value:r.w(`Occlusion opacity for layer ${c.id} is supported only when line-opacity isn't data-driven.`)}if(ue&&(g.forceTerrainMode=!0),!ue&&$!==0&&g.terrain&&!ke)return void r.w(`Occlusion opacity for layer ${c.id} is supported on terrain only if the layer has non-zero line-z-offset.`);const sn=yt&&ue?g.stencilModeFor3D():Dr.disabled;for(const mn of y){const on=o.getTile(mn);if(rt&&!on.patternsLoaded())continue;const Tn=on.getBucket(c);if(!Tn)continue;g.prepareDrawTile();const Dt=Tn.programConfigurations.get(c.id),dn=g.isTileAffectedByFog(mn),cn=g.getOrCreateProgram(bt,{config:Dt,defines:ue?[...vt,"ELEVATED"]:vt,overrideFog:dn});if(mt&&on.imageAtlas){const Vn=on.imageAtlas.patternPositions[mt.toString()];Vn&&Dt.setConstantPatternPositions(Vn)}if(!rt&&Je&&qe&&on.lineAtlas){const Vn=on.lineAtlas.getDash(Je,qe);Vn&&Dt.setConstantPatternPositions(Vn)}let[In,An]=c.paint.get("line-trim-offset");(qe==="round"||qe==="square")&&In!==An&&(In===0&&(In-=1),An===1&&(An+=1));const pn=ke?mn.projMatrix:null,_n=rt?r.cW(g,on,c,pn,Le,[In,An]):r.cX(g,on,c,pn,Tn.lineClipsArray.length,Le,[In,An]);if(Et){const Vn=Tn.gradients[c.id];let tr=Vn.texture;if(c.gradientVersion!==Vn.version){let zr=256;if(c.stepInterpolant){const dr=o.getSource().maxzoom,Ir=mn.canonical.z===dr?Math.ceil(1<<g.transform.maxZoom-mn.canonical.z):1;zr=r.ap(r.cY(Tn.maxLineLength/r.ab*1024*Ir),256,Y.maxTextureSize)}Vn.gradient=r.cZ({expression:c.gradientExpression(),evaluationKey:"lineProgress",resolution:zr,image:Vn.gradient||void 0,clips:Tn.lineClipsArray}),Vn.texture?Vn.texture.update(Vn.gradient):Vn.texture=new r.T(Y,Vn.gradient,ee.RGBA8),Vn.version=c.gradientVersion,tr=Vn.texture}Y.activeTexture.set(ee.TEXTURE1),tr.bind(c.stepInterpolant?ee.NEAREST:ee.LINEAR,ee.CLAMP_TO_EDGE)}Fe&&(Y.activeTexture.set(ee.TEXTURE0),on.lineAtlasTexture&&on.lineAtlasTexture.bind(ee.LINEAR,ee.REPEAT),Dt.updatePaintBuffers()),rt&&(Y.activeTexture.set(ee.TEXTURE0),on.imageAtlasTexture&&on.imageAtlasTexture.bind(ee.LINEAR,ee.CLAMP_TO_EDGE),Dt.updatePaintBuffers()),ue&&g.terrain.setupElevationDraw(on,cn),g.uploadCommonUniforms(Y,cn,mn.toUnwrapped());const _r=Vn=>{Ot!=null&&(Ot.value=dt*$),cn.draw(g,ee.TRIANGLES,fe,Vn,me,Mr.disabled,_n,c.id,Tn.layoutVertexBuffer,Tn.indexBuffer,Tn.segments,c.paint,g.transform.zoom,Dt,[Tn.layoutVertexBuffer2,Tn.patternVertexBuffer,Tn.zOffsetVertexBuffer]),Ot!=null&&(Ot.value=dt)};if(yt&&!ue){const Vn=g.stencilModeForClipping(mn).ref;Vn===0&&ke&&Y.clear({stencil:0});const tr={func:ee.EQUAL,mask:255};_n.u_alpha_discard_threshold=.8,_r(new Dr(tr,Vn,255,ee.KEEP,ee.KEEP,ee.INVERT)),_n.u_alpha_discard_threshold=0,_r(new Dr(tr,Vn,255,ee.KEEP,ee.KEEP,ee.KEEP))}else yt&&ue&&(_n.u_alpha_discard_threshold=.001),_r(ue?sn:g.stencilModeForClipping(mn))}yt&&(g.resetStencilClippingMasks(),ke&&Y.clear({stencil:0})),$===0||g.depthOcclusion||ke||g.layersWithOcclusionOpacity.push(g.currentLayer),ue&&(g.forceTerrainMode=!1)},fill:function(g,o,c,y){const S=c.paint.get("fill-color"),T=c.paint.get("fill-opacity"),A=c.is3D(),$=new cr(g.context.gl.LEQUAL,cr.ReadWrite,g.depthRangeFor3D);if(T.constantOr(1)===0)return;const Y=c.paint.get("fill-emissive-strength"),ee=g.colorModeForDrapableLayerRenderPass(Y),te=c.paint.get("fill-pattern"),ue=g.opaquePassEnabledForLayer()&&!te.constantOr(1)&&S.constantOr(r.bz.transparent).a===1&&T.constantOr(0)===1?"opaque":"translucent";if(g.renderPass===ue){const fe=A?$:g.depthModeForSublayer(1,g.renderPass==="opaque"?cr.ReadWrite:cr.ReadOnly);og(g,o,c,y,fe,ee,!1)}if(!A&&g.renderPass==="translucent"&&c.paint.get("fill-antialias")){const fe=A?$:g.depthModeForSublayer(c.getPaintProperty("fill-outline-color")?2:0,cr.ReadOnly);og(g,o,c,y,fe,ee,!0)}},"fill-extrusion":function(g,o,c,y){const S=c.paint.get("fill-extrusion-opacity"),T=g.context,A=T.gl,$=g.terrain,Y=$&&$.renderingToTexture;if(S===0)return;const ee=g.conflationActive&&g.style.isLayerClipped(c,o.getSource()),te=g.style.order.indexOf(c.fqid);if(ee&&function(ue,fe,me,ke,Le){for(const De of ke){const Fe=fe.getTile(De).getBucket(me);Fe&&(Fe.updateReplacement(De,ue.replacementSource,Le),Fe.uploadCentroid(ue.context))}}(g,o,c,y,te),$||ee)for(const ue of y){const fe=o.getTile(ue).getBucket(c);fe&&gd(g.context,o,ue,fe,c,$,ee)}if(g.renderPass==="shadow"&&g.shadowRenderer){const ue=g.shadowRenderer;if($&&S<.65&&c._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof r.a4)return;const fe=ue.getShadowPassDepthMode(),me=ue.getShadowPassColorMode();tf(g,o,c,y,fe,Dr.disabled,me,ee)}else if(g.renderPass==="translucent"){const ue=!c.paint.get("fill-extrusion-pattern").constantOr(1),fe=c.paint.get("fill-extrusion-color").constantOr(r.bz.white);if(!Y&&fe.a!==0){const me=new cr(g.context.gl.LEQUAL,cr.ReadWrite,g.depthRangeFor3D);S===1&&ue?tf(g,o,c,y,me,Dr.disabled,Hr.unblended,ee):(tf(g,o,c,y,me,Dr.disabled,Hr.disabled,ee),tf(g,o,c,y,me,g.stencilModeFor3D(),g.colorModeForRenderPass(),ee),g.resetStencilClippingMasks())}if(g.style.enable3dLights()&&ue&&(!$&&g.transform.projection.name!=="globe"||Y)){const me=c.paint.get("fill-extrusion-opacity"),ke=c.paint.get("fill-extrusion-ambient-occlusion-intensity"),Le=c.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),De=c.paint.get("fill-extrusion-flood-light-intensity"),Fe=c.paint.get("fill-extrusion-flood-light-color").toRenderColor(c.lut).toArray01().slice(0,3),Ye=ke>0&&Le>0,Je=De>0,qe=(rt,mt,dt)=>(1-dt)*rt+dt*mt,it=rt=>{const mt=g.depthModeForSublayer(1,cr.ReadOnly,A.LEQUAL,!0),dt=c.paint.get(rt?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),yt=qe(.1,3,dt),Et=g._showOverdrawInspector;if(!Et){const bt=new Dr({func:A.ALWAYS,mask:255},255,255,A.KEEP,A.KEEP,A.REPLACE),vt=new Hr([A.ONE,A.ONE,A.ONE,A.ONE],r.bz.transparent,[!1,!1,!1,!0],A.MIN);Ys(g,o,c,y,mt,bt,vt,Mr.disabled,rt,"sdf",me,ke,Le,De,Fe,yt,ee,!1)}{const bt=Et?Dr.disabled:new Dr({func:A.EQUAL,mask:255},255,255,A.KEEP,A.DECR,A.DECR),vt=Et?g.colorModeForRenderPass():new Hr([A.ONE_MINUS_DST_ALPHA,A.DST_ALPHA,A.ONE,A.ONE],r.bz.transparent,[!0,!0,!0,!0]);Ys(g,o,c,y,mt,bt,vt,Mr.disabled,rt,"color",me,ke,Le,De,Fe,yt,ee,!1)}};if(Y){const rt=(mt,dt,yt)=>{const Et=g.depthModeForSublayer(1,cr.ReadOnly,A.LEQUAL,!1),bt=c.paint.get(mt?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),vt=qe(.1,3,bt);{const Ot=new Hr([A.ONE,A.ONE,A.ONE,A.ONE],r.bz.transparent,[!1,!1,!1,!0]);Ys(g,o,c,y,Et,Dr.disabled,Ot,Mr.disabled,mt,"clear",me,ke,Le,De,Fe,vt,ee,dt)}{const Ot=new Dr({func:A.ALWAYS,mask:255},255,255,A.KEEP,A.KEEP,A.REPLACE),sn=new Hr([A.ONE,A.ONE,A.ONE,A.ONE],r.bz.transparent,[!1,!1,!1,!0],A.MIN);Ys(g,o,c,y,Et,Ot,sn,Mr.disabled,mt,"sdf",me,ke,Le,De,Fe,vt,ee,dt)}{const Ot=mt?A.ZERO:A.ONE_MINUS_DST_ALPHA,sn=new Dr({func:A.EQUAL,mask:255},255,255,A.KEEP,A.DECR,A.DECR),mn=new Hr([Ot,A.DST_ALPHA,A.ONE_MINUS_DST_ALPHA,A.ZERO],r.bz.transparent,[!0,!0,!0,!0]);Ys(g,o,c,y,Et,sn,mn,Mr.disabled,mt,"color",me,ke,Le,De,Fe,vt,ee,dt)}{const Ot=new Hr([A.ONE,A.ONE,A.ONE,mt?A.ZERO:A.ONE],r.bz.transparent,[!1,!1,!1,!0],mt?A.FUNC_ADD:A.MAX);Ys(g,o,c,y,Et,Dr.disabled,Ot,Mr.disabled,mt,"clear",me,ke,Le,De,Fe,vt,ee,dt,yt)}};if(Ye||Je){let mt;if(g.prepareDrawTile(),$){const dt=$.drapeBufferSize[0],yt=$.drapeBufferSize[1];mt=$.framebufferCopyTexture,mt&&(!mt||mt.size[0]===dt&&mt.size[1]===yt)||(mt&&mt.destroy(),mt=$.framebufferCopyTexture=new r.T(T,new r.r({width:dt,height:yt}),A.RGBA8)),mt.bind(A.LINEAR,A.CLAMP_TO_EDGE),A.copyTexImage2D(A.TEXTURE_2D,0,A.RGBA,0,0,dt,yt,0)}Ye&&rt(!0,!1,mt),Je&&rt(!1,!0,mt)}}else Ye&&it(!0),Je&&it(!1),(Ye||Je)&&g.resetStencilClippingMasks()}}},hillshade:function(g,o,c,y){if(g.renderPass!=="offscreen"&&g.renderPass!=="translucent"||g.style.disableElevatedTerrain)return;const S=g.context,T=g.terrain&&g.terrain.renderingToTexture,[A,$]=g.renderPass!=="translucent"||T?[{},y]:g.stencilConfigForOverlap(y);for(const Y of $){const ee=o.getTile(Y);if(ee.needsHillshadePrepare&&g.renderPass==="offscreen")so(g,ee,c);else if(g.renderPass==="translucent"){const te=g.depthModeForSublayer(0,cr.ReadOnly),ue=c.paint.get("hillshade-emissive-strength"),fe=g.colorModeForDrapableLayerRenderPass(ue),me=T&&g.terrain?g.terrain.stencilModeForRTTOverlap(Y):A[Y.overscaledZ];Vi(g,Y,ee,c,te,me,fe)}}S.viewport.set([0,0,g.width,g.height]),g.resetStencilClippingMasks()},raster:function(g,o,c,y,S,T){if(g.renderPass!=="translucent"||c.paint.get("raster-opacity")===0)return;const A=g.transform.projection.name==="globe",$=c.paint.get("raster-elevation")!==0,Y=$&&A;if(g.renderElevatedRasterBackface&&!Y)return;const ee=g.context,te=ee.gl,ue=o.getSource(),fe=function(rt,mt,dt,yt){const Et=mt.paint.get("raster-color"),bt=rt.type==="raster-array",vt=[],Ot=mt.paint.get("raster-resampling"),sn=mt.paint.get("raster-color-mix");let mn=mt.paint.get("raster-color-range");const on=[sn[0],sn[1],sn[2],0],Tn=sn[3];let Dt=Ot==="nearest"?yt.NEAREST:yt.LINEAR;if(bt&&(vt.push("RASTER_ARRAY"),Et||vt.push("RASTER_COLOR"),Ot==="linear"&&vt.push("RASTER_ARRAY_LINEAR"),Dt=yt.NEAREST,!mn&&rt.rasterLayers)){const dn=rt.rasterLayers.find(({id:cn})=>cn===mt.sourceLayer);dn&&dn.fields&&dn.fields.range&&(mn=dn.fields.range)}if(mn=mn||[0,1],Et){vt.push("RASTER_COLOR"),dt.activeTexture.set(yt.TEXTURE2),mt.updateColorRamp(mn);let dn=mt.colorRampTexture;dn||(dn=mt.colorRampTexture=new r.T(dt,mt.colorRamp,yt.RGBA8)),dn.bind(yt.LINEAR,yt.CLAMP_TO_EDGE)}return{mix:on,range:mn,offset:Tn,defines:vt,resampling:Dt}}(ue,c,ee,te);if(ue instanceof r.aD&&!y.length&&!A)return;const me=c.paint.get("raster-emissive-strength"),ke=g.colorModeForDrapableLayerRenderPass(me),Le=g.terrain&&g.terrain.renderingToTexture,De=!g.options.moving,Fe=c.paint.get("raster-resampling")==="nearest"?te.NEAREST:te.LINEAR;if(ue instanceof r.aD&&!y.length&&(ue.onNorthPole||ue.onSouthPole)){const rt=$?g.stencilModeFor3D():Dr.disabled;return void nl(!!ue.onNorthPole,null,g,o,c,me,fe,Mr.disabled,rt)}if(!y.length)return;const[Ye,Je]=ue instanceof r.aD||Le?[{},y]:g.stencilConfigForOverlap(y),qe=Je[Je.length-1].overscaledZ;Y&&fe.defines.push("PROJECTION_GLOBE_VIEW"),$&&fe.defines.push("RENDER_CUTOFF");const it=(rt,mt,dt)=>{for(const yt of rt){const Et=yt.toUnwrapped(),bt=o.getTile(yt);if(Le&&(!bt||!bt.hasData()))continue;ee.activeTexture.set(te.TEXTURE0);const vt=sg(bt,ue,c,fe);if(!vt||!vt.texture)continue;const{texture:Ot,mix:sn,offset:mn,tileSize:on,buffer:Tn}=vt;let Dt,dn;Le?(Dt=cr.disabled,dn=yt.projMatrix):$?(Dt=new cr(te.LEQUAL,cr.ReadWrite,g.depthRangeFor3D),dn=A?Float32Array.from(g.transform.expandedFarZProjMatrix):g.transform.calculateProjMatrix(Et,De)):(Dt=g.depthModeForSublayer(yt.overscaledZ-qe,c.paint.get("raster-opacity")===1?cr.ReadWrite:cr.ReadOnly,te.LESS),dn=g.transform.calculateProjMatrix(Et,De));const cn=g.terrain&&Le?g.terrain.stencilModeForRTTOverlap(yt):Ye[yt.overscaledZ],In=T?0:c.paint.get("raster-fade-duration");bt.registerFadeDuration(In);const An=o.findLoadedParent(yt,0),pn=Xm(bt,An,o,g.transform,In);let _n,_r;g.terrain&&g.terrain.prepareDrawTile(),ee.activeTexture.set(te.TEXTURE0),Ot.bind(Fe,te.CLAMP_TO_EDGE),ee.activeTexture.set(te.TEXTURE1),An?(An.texture&&An.texture.bind(Fe,te.CLAMP_TO_EDGE),_n=Math.pow(2,An.tileID.overscaledZ-bt.tileID.overscaledZ),_r=[bt.tileID.canonical.x*_n%1,bt.tileID.canonical.y*_n%1]):Ot.bind(Fe,te.CLAMP_TO_EDGE),Ot.useMipmap&&ee.extTextureFilterAnisotropic&&g.transform.pitch>20&&te.texParameterf(te.TEXTURE_2D,ee.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,ee.extTextureFilterAnisotropicMax);const Vn=g.transform;let tr;const zr=$?Fo(Vn):[0,0,0,0];let dr,Ir,oi,Qr,Fi,qi=0;if(Y&&ue instanceof r.aD&&ue.coordinates.length>3)dr=Float32Array.from(r.b5(r.cC(new r.bP(0,0,0)))),Ir=Float32Array.from(Vn.globeMatrix),oi=Float32Array.from(r.cy(Vn)),Qr=[r.am(Vn.center.lng),r.at(Vn.center.lat)],tr=ue.elevatedGlobePerspectiveTransform,Fi=ue.elevatedGlobeGridMatrix||new Float32Array(9);else if(Y){const hi=r.cz(yt.canonical);qi=r.cA(hi.getCenter().lat),dr=Float32Array.from(r.b5(r.cC(yt.canonical))),Ir=Float32Array.from(Vn.globeMatrix),oi=Float32Array.from(r.cy(Vn)),Qr=[r.am(Vn.center.lng),r.at(Vn.center.lat)],tr=[0,0],Fi=Float32Array.from(r.cB(yt.canonical,hi,qi,Vn.worldSize/Vn._pixelsPerMercatorPixel))}else tr=ue instanceof r.aD?ue.perspectiveTransform:[0,0],dr=new Float32Array(16),Ir=new Float32Array(9),oi=new Float32Array(16),Qr=[0,0],Fi=new Float32Array(9);const ao=Mp(dn,dr,Ir,oi,Fi,_r||[0,0],r.a9(g.transform.zoom),Qr,zr,_n||1,pn,c,tr,$?c.paint.get("raster-elevation"):0,2,sn,mn,fe.range,on,Tn,me),Gl=g.isTileAffectedByFog(yt),is=g.getOrCreateProgram("raster",{defines:fe.defines,overrideFog:Gl});if(g.uploadCommonUniforms(ee,is,Et),ue instanceof r.aD){const hi=ue.elevatedGlobeVertexBuffer,Hi=ue.elevatedGlobeIndexBuffer;if(Le||!A)ue.boundsBuffer&&ue.boundsSegments&&is.draw(g,te.TRIANGLES,Dt,Dr.disabled,ke,Mr.disabled,ao,c.id,ue.boundsBuffer,g.quadTriangleIndexBuffer,ue.boundsSegments);else if(hi&&Hi){const xo=Vn.zoom<=r.c2?ue.elevatedGlobeSegments:ue.getSegmentsForLongitude(Vn.center.lng);xo&&is.draw(g,te.TRIANGLES,Dt,Dr.disabled,ke,mt,ao,c.id,hi,Hi,xo)}}else if(Y){Dt=new cr(te.LEQUAL,cr.ReadOnly,g.depthRangeFor3D);const hi=g.globeSharedBuffers;if(hi){const[Hi,xo,$i]=hi.getGridBuffers(qi,!1);is.draw(g,te.TRIANGLES,Dt,dt||cn,g.colorModeForRenderPass(),mt,ao,c.id,Hi,xo,$i)}}else{const{tileBoundsBuffer:hi,tileBoundsIndexBuffer:Hi,tileBoundsSegments:xo}=g.getTileBoundsBuffers(bt);is.draw(g,te.TRIANGLES,Dt,cn,ke,Mr.disabled,ao,c.id,hi,Hi,xo)}}if(!(ue instanceof r.aD)&&Y)for(const yt of rt){const Et=yt.canonical.y===(1<<yt.canonical.z)-1;yt.canonical.y===0&&nl(!0,yt,g,o,c,me,fe,mt,dt||Dr.disabled),Et&&nl(!1,yt,g,o,c,me,fe,mt===Mr.frontCW?Mr.backCW:Mr.frontCW,dt||Dr.disabled)}};Y?it(Je,g.renderElevatedRasterBackface?Mr.backCW:Mr.frontCW,g.stencilModeFor3D()):it(Je,Mr.disabled,void 0),g.resetStencilClippingMasks()},"raster-particle":function(g,o,c,y,S,T){g.renderPass==="offscreen"&&function(A,$,Y,ee){if(!ee.length)return;const te=A.context,ue=te.gl,fe=$.getSource();if(!(fe instanceof ns))return;const me=Math.ceil(Math.sqrt(Y.paint.get("raster-particle-count")));let ke=Y.particlePositionRGBAImage;if(!ke||ke.width!==me){const Je=function(qe){const it=qe*qe,rt=new Uint8Array(4*it),mt=function(yt){return yt|=0,yt=Math.imul(2747636419^yt,2654435769),yt=Math.imul(yt^yt>>>16,2654435769),((yt=Math.imul(yt^yt>>>16,2654435769))>>>0)/4294967296},dt=1/1.1;for(let yt=0;yt<it;yt++){const Et=dt*(mt(2*yt+0)+$u),bt=dt*(mt(2*yt+1)+$u),vt=255*Et%1,Ot=255*bt%1,sn=vt,mn=bt-Ot/255,on=Ot;rt[4*yt+0]=255*(Et-vt/255),rt[4*yt+1]=255*sn,rt[4*yt+2]=255*mn,rt[4*yt+3]=255*on}return rt}(me);ke=Y.particlePositionRGBAImage=new r.r({width:me,height:me},Je)}let Le=Y.particleFramebuffer;Le?Le.width!==me&&(Le.destroy(),Le=Y.particleFramebuffer=te.createFramebuffer(me,me,!0,null)):Le=Y.particleFramebuffer=te.createFramebuffer(me,me,!0,null);const De=[];for(const Je of ee){const qe=$.getTile(Je);if(!(qe instanceof Ce))continue;const it=X1(qe,fe,Y);if(!it)continue;const rt=[qe.tileSize,qe.tileSize];let mt=Y.tileFramebuffer;mt||(mt=Y.tileFramebuffer=te.createFramebuffer(rt[0],rt[1],!0,null));let dt=qe.rasterParticleState;dt||(dt=qe.rasterParticleState=new q1(te,Je,rt,ke));const yt=dt.update(Y.lastInvalidatedAt);dt.particleTextureDimension!==me&&dt.updateParticleTexture(Je,ke);const Et=dt.targetColorTexture;dt.targetColorTexture=dt.backgroundColorTexture,dt.backgroundColorTexture=Et;const bt=dt.particleTexture0;dt.particleTexture0=dt.particleTexture1,dt.particleTexture1=bt,De.push([Je,it,dt,yt])}if(De.length===0)return;const Fe=r.q.now(),Ye=Y.previousDrawTimestamp?.001*(Fe-Y.previousDrawTimestamp):.0167;if(Y.previousDrawTimestamp=Fe,Y.hasColorMap()){te.activeTexture.set(ue.TEXTURE0+2);let Je=Y.colorRampTexture;Je||(Je=Y.colorRampTexture=new r.T(te,Y.colorRamp,ue.RGBA8)),Je.bind(ue.LINEAR,ue.CLAMP_TO_EDGE)}te.bindFramebuffer.set(Y.tileFramebuffer.framebuffer),function(Je,qe,it){const rt=Je.context,mt=rt.gl,dt=qe.tileFramebuffer;rt.activeTexture.set(mt.TEXTURE0);const yt={u_texture:0,u_opacity:1.05*(bt=qe.paint.get("raster-particle-fade-opacity-factor"))/(bt+.05)},Et=Je.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var bt;for(const vt of it){const[,,Ot,sn]=vt;dt.colorAttachment.set(Ot.targetColorTexture.texture),rt.viewport.set([0,0,dt.width,dt.height]),rt.clear({color:r.bz.transparent}),sn&&(Ot.backgroundColorTexture.bind(mt.NEAREST,mt.CLAMP_TO_EDGE),Et.draw(Je,mt.TRIANGLES,cr.disabled,Dr.disabled,Hr.alphaBlended,Mr.disabled,yt,qe.id,Je.viewportBuffer,Je.quadTriangleIndexBuffer,Je.viewportSegments))}}(A,Y,De),function(Je,qe,it,rt){const mt=Je.context,dt=mt.gl,yt=it.tileFramebuffer,Et=Je.transform.projection.name==="globe",bt=it.paint.get("raster-particle-max-speed");for(const vt of rt){const[Ot,sn,mn]=vt;mt.activeTexture.set(dt.TEXTURE0+0),sn.texture.bind(dt.LINEAR,dt.CLAMP_TO_EDGE),yt.colorAttachment.set(mn.targetColorTexture.texture);const on=Je.getOrCreateProgram("rasterParticleDraw",{defines:sn.defines,overrideFog:!1});mt.activeTexture.set(dt.TEXTURE0+1);const Tn=sn.scalarData?[]:[0,1,2,3].map(cn=>r.c$[cn](Ot));Tn.push(Ot);const Dt=Ot.canonical.x,dn=Ot.canonical.y;for(const cn of Tn){const In=qe.getTile(Et?cn.wrapped():cn);if(!In)continue;const An=In.rasterParticleState;if(!An)continue;const pn=cn.canonical.x+(1<<cn.canonical.z)*(cn.wrap-Ot.wrap),_n=cn.canonical.y;An.particleTexture0.bind(dt.NEAREST,dt.CLAMP_TO_EDGE);const _r=Qm(1,An.particleTexture0.size[0],[pn-Dt,_n-dn],0,sn.texture.size,2,bt,sn.textureOffset,sn.scale,sn.offset);on.draw(Je,dt.POINTS,cr.disabled,Dr.disabled,Hr.alphaBlended,Mr.disabled,_r,it.id,An.particleIndexBuffer,void 0,An.particleSegment)}}}(A,$,Y,De),te.bindFramebuffer.set(Y.particleFramebuffer.framebuffer),function(Je,qe,it,rt){const mt=Je.context,dt=mt.gl,yt=qe.paint.get("raster-particle-max-speed"),Et=rt*qe.paint.get("raster-particle-speed-factor")*.15,bt=function(Ot){return Math.pow(Ot,6)}(.01+1*qe.paint.get("raster-particle-reset-rate-factor")),vt=qe.particleFramebuffer;mt.viewport.set([0,0,vt.width,vt.height]);for(const Ot of it){const[,sn,mn]=Ot;mt.activeTexture.set(dt.TEXTURE0+0),sn.texture.bind(dt.LINEAR,dt.CLAMP_TO_EDGE),mt.activeTexture.set(dt.TEXTURE0+1);const on=mn.particleTexture0;on.bind(dt.NEAREST,dt.CLAMP_TO_EDGE);const Tn=eg(1,on.size[0],0,sn.texture.size,yt,Et,bt,sn.textureOffset,sn.scale,sn.offset);vt.colorAttachment.set(mn.particleTexture1.texture),mt.clear({color:r.bz.transparent}),Je.getOrCreateProgram("rasterParticleUpdate",{defines:sn.defines}).draw(Je,dt.TRIANGLES,cr.disabled,Dr.disabled,Hr.unblended,Mr.disabled,Tn,qe.id,Je.viewportBuffer,Je.quadTriangleIndexBuffer,Je.viewportSegments)}}(A,Y,De,Ye)}(g,o,c,y),g.renderPass==="translucent"&&(function(A,$,Y,ee,te){const ue=A.context,fe=ue.gl,me=$.getSource().tileSize,ke=5*(1-r.a7(r.bU,r.bU+1,A.transform.zoom))*me+Y.paint.get("raster-particle-elevation"),Le=!A.options.moving,De=A.transform.projection.name==="globe";if(!ee.length)return;const[Fe,Ye]=A.stencilConfigForOverlap(ee),Je=[];De&&Je.push("PROJECTION_GLOBE_VIEW");const qe=A.stencilModeFor3D();for(const it of Ye){const rt=it.toUnwrapped(),mt=$.getTile(it);if(!mt.rasterParticleState)continue;const dt=mt.rasterParticleState,yt=100;mt.registerFadeDuration(yt);const Et=$.findLoadedParent(it,0),bt=Xm(mt,Et,$,A.transform,yt);let vt,Ot;A.terrain&&A.terrain.prepareDrawTile(),ue.activeTexture.set(fe.TEXTURE0),dt.targetColorTexture.bind(fe.LINEAR,fe.CLAMP_TO_EDGE),ue.activeTexture.set(fe.TEXTURE1),Et&&Et.rasterParticleState?(Et.rasterParticleState.targetColorTexture.bind(fe.LINEAR,fe.CLAMP_TO_EDGE),vt=Math.pow(2,Et.tileID.overscaledZ-mt.tileID.overscaledZ),Ot=[mt.tileID.canonical.x*vt%1,mt.tileID.canonical.y*vt%1]):dt.targetColorTexture.bind(fe.LINEAR,fe.CLAMP_TO_EDGE);const sn=De?Float32Array.from(A.transform.expandedFarZProjMatrix):A.transform.calculateProjMatrix(rt,Le),mn=A.transform,on=Y1(mn),Tn=r.cz(it.canonical),Dt=r.cA(Tn.getCenter().lat);let dn,cn,In,An,pn;De?(dn=Float32Array.from(r.b5(r.cC(it.canonical))),cn=Float32Array.from(mn.globeMatrix),In=Float32Array.from(r.cy(mn)),An=[r.am(mn.center.lng),r.at(mn.center.lat)],pn=Float32Array.from(r.cB(it.canonical,Tn,Dt,mn.worldSize/mn._pixelsPerMercatorPixel))):(dn=new Float32Array(16),cn=new Float32Array(9),In=new Float32Array(16),An=[0,0],pn=new Float32Array(9));const _n=U1(sn,dn,cn,In,pn,Ot||[0,0],r.a9(A.transform.zoom),An,on,vt||1,bt,ke),_r=A.isTileAffectedByFog(it),Vn=A.getOrCreateProgram("rasterParticle",{defines:Je,overrideFog:_r});if(A.uploadCommonUniforms(ue,Vn,rt),De){const tr=new cr(fe.LEQUAL,cr.ReadOnly,A.depthRangeFor3D),zr=0,dr=A.globeSharedBuffers;if(dr){const[Ir,oi,Qr]=dr.getGridBuffers(Dt,zr!==0);Vn.draw(A,fe.TRIANGLES,tr,qe,Hr.alphaBlended,A.renderElevatedRasterBackface?Mr.frontCCW:Mr.backCCW,_n,Y.id,Ir,oi,Qr)}}else{const tr=A.depthModeForSublayer(0,cr.ReadOnly),zr=Fe[it.overscaledZ],{tileBoundsBuffer:dr,tileBoundsIndexBuffer:Ir,tileBoundsSegments:oi}=A.getTileBoundsBuffers(mt);Vn.draw(A,fe.TRIANGLES,tr,zr,Hr.alphaBlended,Mr.disabled,_n,Y.id,dr,Ir,oi)}}A.resetStencilClippingMasks()}(g,o,c,y),g.style.map.triggerRepaint())},background:function(g,o,c,y){const S=c.paint.get("background-color"),T=c.paint.get("background-opacity"),A=c.paint.get("background-emissive-strength"),$=c.paint.get("background-pitch-alignment")==="viewport";if(T===0)return;const Y=g.context,ee=Y.gl,te=g.transform,ue=te.tileSize,fe=c.paint.get("background-pattern");let me;if(fe!==void 0&&(fe===null||(me=g.imageManager.getPattern(fe.toString(),c.scope,g.style.getLut(c.scope)),!me)))return;const ke=!fe&&S.a===1&&T===1&&g.opaquePassEnabledForLayer()?"opaque":"translucent";if(g.renderPass!==ke)return;const Le=Dr.disabled,De=g.depthModeForSublayer(0,ke==="opaque"?cr.ReadWrite:cr.ReadOnly),Fe=g.colorModeForDrapableLayerRenderPass(A),Ye=fe?"backgroundPattern":"background";let Je,qe=y;if(qe||(Je=g.getBackgroundTiles(),qe=Object.values(Je).map(it=>it.tileID)),fe&&(Y.activeTexture.set(ee.TEXTURE0),g.imageManager.bind(g.context,c.scope)),$){const it=g.getOrCreateProgram(Ye,{overrideFog:!1,overrideRtt:!0}),rt=new Float32Array(r.a6.mat4.identity([])),mt=new r.aA(0,0,0,0,0),dt=fe?oh(rt,A,T,g,0,c.scope,me,$,{tileID:mt,tileSize:ue}):G1(rt,A,T,S.toRenderColor(c.lut));it.draw(g,ee.TRIANGLES,De,Le,Fe,Mr.disabled,dt,c.id,g.viewportBuffer,g.quadTriangleIndexBuffer,g.viewportSegments)}else for(const it of qe){const rt=g.isTileAffectedByFog(it),mt=g.getOrCreateProgram(Ye,{overrideFog:rt}),dt=it.toUnwrapped(),yt=y?it.projMatrix:g.transform.calculateProjMatrix(dt);g.prepareDrawTile();const Et=o?o.getTile(it):Je?Je[it.key]:new ne(it,ue,te.zoom,g),bt=fe?oh(yt,A,T,g,0,c.scope,me,$,{tileID:it,tileSize:ue}):G1(yt,A,T,S.toRenderColor(c.lut));g.uploadCommonUniforms(Y,mt,dt);const{tileBoundsBuffer:vt,tileBoundsIndexBuffer:Ot,tileBoundsSegments:sn}=g.getTileBoundsBuffers(Et);mt.draw(g,ee.TRIANGLES,De,Le,Fe,Mr.disabled,bt,c.id,vt,Ot,sn)}},sky:function(g,o,c){const y=g._atmosphere?r.a9(g.transform.zoom):1,S=c.paint.get("sky-opacity")*y;if(S===0)return;const T=g.context,A=c.paint.get("sky-type"),$=new cr(T.gl.LEQUAL,cr.ReadOnly,[0,1]),Y=g.frameCounter/1e3%1;A==="atmosphere"?g.renderPass==="offscreen"?c.needsSkyboxCapture(g)&&(function(ee,te,ue,fe){const me=ee.context,ke=me.gl;let Le=te.skyboxFbo;if(!Le){Le=te.skyboxFbo=me.createFramebuffer(32,32,!0,null),te.skyboxGeometry=new i_(me),te.skyboxTexture=me.gl.createTexture(),ke.bindTexture(ke.TEXTURE_CUBE_MAP,te.skyboxTexture),ke.texParameteri(ke.TEXTURE_CUBE_MAP,ke.TEXTURE_WRAP_S,ke.CLAMP_TO_EDGE),ke.texParameteri(ke.TEXTURE_CUBE_MAP,ke.TEXTURE_WRAP_T,ke.CLAMP_TO_EDGE),ke.texParameteri(ke.TEXTURE_CUBE_MAP,ke.TEXTURE_MIN_FILTER,ke.LINEAR),ke.texParameteri(ke.TEXTURE_CUBE_MAP,ke.TEXTURE_MAG_FILTER,ke.LINEAR);for(let Je=0;Je<6;++Je)ke.texImage2D(ke.TEXTURE_CUBE_MAP_POSITIVE_X+Je,0,ke.RGBA,32,32,0,ke.RGBA,ke.UNSIGNED_BYTE,null)}me.bindFramebuffer.set(Le.framebuffer),me.viewport.set([0,0,32,32]);const De=te.getCenter(ee,!0),Fe=ee.getOrCreateProgram("skyboxCapture"),Ye=new Float64Array(16);r.a6.mat4.identity(Ye),r.a6.mat4.rotateY(Ye,Ye,.5*-Math.PI),ah(ee,te,Fe,Ye,De,0),r.a6.mat4.identity(Ye),r.a6.mat4.rotateY(Ye,Ye,.5*Math.PI),ah(ee,te,Fe,Ye,De,1),r.a6.mat4.identity(Ye),r.a6.mat4.rotateX(Ye,Ye,.5*-Math.PI),ah(ee,te,Fe,Ye,De,2),r.a6.mat4.identity(Ye),r.a6.mat4.rotateX(Ye,Ye,.5*Math.PI),ah(ee,te,Fe,Ye,De,3),r.a6.mat4.identity(Ye),ah(ee,te,Fe,Ye,De,4),r.a6.mat4.identity(Ye),r.a6.mat4.rotateY(Ye,Ye,Math.PI),ah(ee,te,Fe,Ye,De,5),me.viewport.set([0,0,ee.width,ee.height])}(g,c),c.markSkyboxValid(g)):g.renderPass==="sky"&&function(ee,te,ue,fe,me){const ke=ee.context,Le=ke.gl,De=ee.transform,Fe=ee.getOrCreateProgram("skybox");ke.activeTexture.set(Le.TEXTURE0),Le.bindTexture(Le.TEXTURE_CUBE_MAP,te.skyboxTexture);const Ye=((Je,qe,it,rt,mt)=>({u_matrix:Je,u_sun_direction:qe,u_cubemap:0,u_opacity:rt,u_temporal_offset:mt}))(De.skyboxMatrix,te.getCenter(ee,!1),0,fe,me);ee.uploadCommonUniforms(ke,Fe),Fe.draw(ee,Le.TRIANGLES,ue,Dr.disabled,ee.colorModeForRenderPass(),Mr.backCW,Ye,"skybox",te.skyboxGeometry.vertexBuffer,te.skyboxGeometry.indexBuffer,te.skyboxGeometry.segment)}(g,c,$,S,Y):A==="gradient"&&g.renderPass==="sky"&&function(ee,te,ue,fe,me){const ke=ee.context,Le=ke.gl,De=ee.transform,Fe=ee.getOrCreateProgram("skyboxGradient");te.skyboxGeometry||(te.skyboxGeometry=new i_(ke)),ke.activeTexture.set(Le.TEXTURE0);let Ye=te.colorRampTexture;Ye||(Ye=te.colorRampTexture=new r.T(ke,te.colorRamp,Le.RGBA8)),Ye.bind(Le.LINEAR,Le.CLAMP_TO_EDGE);const Je=((qe,it,rt,mt,dt)=>({u_matrix:qe,u_color_ramp:0,u_center_direction:it,u_radius:r.bB(rt),u_opacity:mt,u_temporal_offset:dt}))(De.skyboxMatrix,te.getCenter(ee,!1),te.paint.get("sky-gradient-radius"),fe,me);ee.uploadCommonUniforms(ke,Fe),Fe.draw(ee,Le.TRIANGLES,ue,Dr.disabled,ee.colorModeForRenderPass(),Mr.backCW,Je,"skyboxGradient",te.skyboxGeometry.vertexBuffer,te.skyboxGeometry.indexBuffer,te.skyboxGeometry.segment)}(g,c,$,S,Y)},debug:function(g,o,c,y,S,T){for(let A=0;A<c.length;A++)if(S){const ee=new r.bz(y.r*.8,y.g*.8,y.b*.8,1);fu(g,o,c[A],y,-1,-1,T),fu(g,o,c[A],y,-1,1,T),fu(g,o,c[A],y,1,1,T),fu(g,o,c[A],y,1,-1,T),fu(g,o,c[A],ee,0,0,T)}else fu(g,o,c[A],y,0,0,T)},custom:function(g,o,c,y){const S=g.context,T=c.implementation;if(!g.transform.projection.unsupportedLayers||!g.transform.projection.unsupportedLayers.includes("custom")||g.terrain&&(g.terrain.renderingToTexture||g.renderPass==="offscreen")&&c.isDraped(o)){if(g.renderPass==="offscreen"){const A=T.prerender;if(A){if(g.setCustomLayerDefaults(),S.setColorMode(g.colorModeForRenderPass()),g.transform.projection.name==="globe"){const $=g.transform.pointMerc;A.call(T,S.gl,g.transform.customLayerMatrix(),g.transform.getProjection(),g.transform.globeToMercatorMatrix(),r.a9(g.transform.zoom),[$.x,$.y],g.transform.pixelsPerMeterRatio)}else A.call(T,S.gl,g.transform.customLayerMatrix());S.setDirty(),g.setBaseState()}}else if(g.renderPass==="translucent"){if(g.terrain&&g.terrain.renderingToTexture){const $=T.renderToTile;if($){const Y=y[0].canonical,ee=new r.a5(Y.x+y[0].wrap*(1<<Y.z),Y.y,Y.z);S.setDepthMode(cr.disabled),S.setStencilMode(Dr.disabled),S.setColorMode(g.colorModeForRenderPass()),g.setCustomLayerDefaults(),$.call(T,S.gl,ee),S.setDirty(),g.setBaseState()}return}g.setCustomLayerDefaults(),S.setColorMode(g.colorModeForRenderPass()),S.setStencilMode(Dr.disabled);const A=T.renderingMode==="3d"?new cr(g.context.gl.LEQUAL,cr.ReadWrite,g.depthRangeFor3D):g.depthModeForSublayer(0,cr.ReadOnly);if(S.setDepthMode(A),g.transform.projection.name==="globe"){const $=g.transform.pointMerc;T.render(S.gl,g.transform.customLayerMatrix(),g.transform.getProjection(),g.transform.globeToMercatorMatrix(),r.a9(g.transform.zoom),[$.x,$.y],g.transform.pixelsPerMeterRatio)}else T.render(S.gl,g.transform.customLayerMatrix());S.setDirty(),g.setBaseState(),S.bindFramebuffer.set(null)}}else r.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(g,o,c,y){if(g.renderPass==="opaque")return;const S=c.paint.get("model-opacity");if(S===0)return;const T=c.paint.get("model-cast-shadows");if(g.renderPass==="shadow"&&(!T||g.terrain&&S<.65&&c._transitionablePaint._values["model-opacity"].value.expression instanceof r.a4))return;const A=g.shadowRenderer,$=c.paint.get("model-receive-shadows");A&&(A.useNormalOffset=!0,$||(A.enabled=!1));const Y=()=>{A&&(A.useNormalOffset=!0,$||(A.enabled=!0))},ee=o.getSource();if(g.renderPass==="light-beam"&&ee.type!=="batched-model")return;if(ee.type==="vector"||ee.type==="geojson")return function(Fe,Ye,Je,qe,it){const rt=Fe.transform;if(rt.projection.name!=="mercator")return void r.w(`Drawing 3D models for ${rt.projection.name} projection is not yet implemented`);const mt=rt.getFreeCameraOptions().position;if(!Fe.modelManager)return;const dt=Fe.modelManager;Je.modelManager=dt;const yt=Fe.shadowRenderer;if(!Je._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const Et=Je._unevaluatedLayout._values["model-id"],bt={...Je.layout.get("model-id").parameters},vt=Fe.style.order.indexOf(Je.fqid);for(const Ot of qe){const sn=Ye.getTile(Ot).getBucket(Je);if(!sn||sn.projection.name!==rt.projection.name)continue;const mn=sn.getModelUris();mn&&!sn.modelsRequested&&(dt.addModelsFromBucket(mn,it),sn.modelsRequested=!0);const on=cT(Ot,rt);bt.zoom=on;const Tn=Et.possiblyEvaluate(bt);if(K1(Fe,sn,Ot),mu.shadowUniformsInitialized=!1,mu.useSingleShadowCascade=!!yt&&yt.getMaxCascadeForTile(Ot.toUnwrapped())===0,Fe.renderPass==="shadow"&&yt){if(Fe.currentShadowCascade===1&&sn.isInsideFirstShadowMapFrustum)continue;const cn=rt.calculatePosMatrix(Ot.toUnwrapped(),rt.worldSize);if(mu.tileMatrix.set(cn),mu.shadowTileMatrix=Float32Array.from(yt.calculateShadowPassMatrixFromMatrix(cn)),mu.aabb.min.fill(0),mu.aabb.max[0]=mu.aabb.max[1]=r.ab,mu.aabb.max[2]=0,zp(sn,mu,Fe,Je.scope))continue}const Dt=1<<Ot.canonical.z,dn=[((mt.x-Ot.wrap)*Dt-Ot.canonical.x)*r.ab,(mt.y*Dt-Ot.canonical.y)*r.ab,mt.z*Dt*r.ab];Fe.conflationActive&&Object.keys(sn.instancesPerModel).length>0&&Fe.style.isLayerClipped(Je,Ye.getSource())&&sn.updateReplacement(Ot,Fe.replacementSource,vt,it)&&(sn.uploaded=!1,sn.upload(Fe.context));for(let cn in sn.instancesPerModel){const In=sn.instancesPerModel[cn];In.features.length>0&&(cn=Tn.evaluate(In.features[0].feature,{}));const An=dt.getModel(cn,it);if(An&&An.uploaded)for(const pn of An.nodes)ba(Fe,Je,pn,In,dn,Ot,mu)}}}(g,o,c,y,ee.type==="vector"?c.scope:""),void Y();if(!ee.loaded())return;if(ee.type==="batched-model")return function(Fe,Ye,Je,qe){Je.resetLayerRenderingStats(Fe);const it=Fe.context,rt=Fe.transform,mt=Fe.style.fog,dt=Fe.shadowRenderer;if(rt.projection.name!=="mercator")return void r.w(`Drawing 3D landmark models for ${rt.projection.name} projection is not yet implemented`);const yt=Fe.transform.getFreeCameraOptions().position,Et=r.a6.vec3.scale([],[yt.x,yt.y,yt.z],Fe.transform.worldSize),bt=r.a6.vec3.negate([],Et),vt=r.a6.mat4.identity([]),Ot=r.de(rt.center.lat,rt.zoom),sn=r.a6.mat4.fromScaling([],[1,1,1/Ot]);r.a6.mat4.translate(vt,vt,bt);const mn=Je.paint.get("model-opacity"),on=new cr(it.gl.LEQUAL,cr.ReadWrite,Fe.depthRangeFor3D),Tn=new cr(it.gl.LEQUAL,cr.ReadOnly,Fe.depthRangeFor3D),Dt=new r.c9([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),dn=Fe.renderPass==="shadow",cn=dn&&dt?dt.getCurrentCascadeFrustum():rt.getFrustum(rt.scaleZoom(rt.worldSize)),In=Je.paint.get("model-front-cutoff"),An=In[2]<1,pn=zs(Fe,Je.paint.get("model-cutoff-fade-range")),_n=Je.getLayerRenderingStats();(function(_r,Vn,tr,zr){const dr=_r.terrain?_r.terrain.exaggeration():0,Ir=_r.transform.zoom;for(const oi of zr){const Qr=Vn.getTile(oi).getBucket(tr);Qr&&(_r.conflationActive&&Qr.updateReplacement(oi,_r.replacementSource),Qr.evaluateScale(_r,tr),_r.terrain&&dr>0&&Qr.elevationUpdate(_r.terrain,dr,oi,tr.source),Qr.needsReEvaluation(_r,Ir,tr)&&Qr.evaluate(tr))}})(Fe,Ye,Je,qe),function(){let _r,Vn,tr;An?(_r=qe.length-1,Vn=-1,tr=-1):(_r=0,Vn=qe.length,tr=1);const zr=new Float64Array(16),dr=r.a6.vec3.create(),Ir=new r.P(0,0);for(let oi=_r;oi!==Vn;oi+=tr){const Qr=qe[oi],Fi=Ye.getTile(Qr).getBucket(Je);if(!Fi||!Fi.uploaded)continue;let qi=!1;dt&&(qi=dt.getMaxCascadeForTile(Qr.toUnwrapped())===0);const ao=rt.calculatePosMatrix(Qr.toUnwrapped(),rt.worldSize),Gl=Fi.modelTraits;!dn&&An&&(r.a6.mat4.invert(zr,ao),r.a6.vec3.transformMat4(dr,Et,zr),Ir.x=dr[0],Ir.y=dr[1]);const is=[];for(const hi of Fi.getNodesInfo()){if(hi.hiddenByReplacement||!hi.node.meshes)continue;const Hi=hi.node;let xo=0;Fe.terrain&&Hi.elevation&&(xo=Hi.elevation*Fe.terrain.exaggeration());const $i=(()=>{const no=hi.aabb;return Dt.min=[...no.min],Dt.max=[...no.max],Dt.min[2]+=xo,Dt.max[2]+=xo,r.a6.vec3.transformMat4(Dt.min,Dt.min,ao),r.a6.vec3.transformMat4(Dt.max,Dt.max,ao),Dt})(),ni=hi.evaluatedScale;if(ni[0]<=1&&ni[1]<=1&&ni[2]<=1&&$i.intersects(cn)===0)continue;if(!dn&&An){const no=.16666666666666666;hi.cameraCollisionOpacity=Et[0]>$i.min[0]&&Et[0]<$i.max[0]&&Et[1]>$i.min[1]&&Et[1]<$i.max[1]&&Et[2]*Ot<$i.max[2]&&Hi.footprint&&r.bu(Ir,Hi.footprint)?Math.max(hi.cameraCollisionOpacity-no,0):Math.min(1,hi.cameraCollisionOpacity+no)}const Si=[...ao],Oi=Hi.anchor?Hi.anchor[0]:0,Bo=Hi.anchor?Hi.anchor[1]:0;r.a6.mat4.translate(Si,Si,[Oi*(ni[0]-1),Bo*(ni[1]-1),xo]),r.a6.vec3.exactEquals(ni,r.dh)||r.a6.mat4.scale(Si,Si,ni);const os=r.a6.mat4.multiply([],Si,Hi.matrix),_i=r.a6.mat4.multiply([],rt.expandedFarZProjMatrix,os),Ss=r.a6.mat4.multiply([],rt.expandedFarZProjMatrix,Si),Ns=r.a6.vec4.transformMat4([],[Oi,Bo,xo,1],_i)[2];Hi.hidden=!1;let Cs=mn;dn||(An&&(Cs*=hi.cameraCollisionOpacity,Cs*=wi(Si,rt,hi.aabb,In)),Cs*=fo(pn,Ns)),Cs!==0?is.push({nodeInfo:hi,depth:Ns,opacity:Cs,wvpForNode:_i,wvpForTile:Ss,nodeModelMatrix:os,tileModelMatrix:Si}):Hi.hidden=!0}dn||is.sort((hi,Hi)=>!An||hi.opacity===1&&Hi.opacity===1?hi.depth<Hi.depth?-1:1:hi.opacity===1?-1:Hi.opacity===1?1:hi.depth>Hi.depth?-1:1);for(const hi of is){const Hi=hi.nodeInfo,xo=Hi.node;let $i=r.a6.mat4.multiply([],sn,hi.tileModelMatrix);r.a6.mat4.multiply($i,vt,$i);const ni=r.a6.mat4.invert([],$i);r.a6.mat4.transpose(ni,ni),r.a6.mat4.scale(ni,ni,dT),$i=r.a6.mat4.multiply($i,$i,xo.matrix);const Si=Fe.renderPass==="light-beam",Oi=Gl&r.dj.HasMapboxMeshFeatures,Bo=Oi?0:Hi.evaluatedRMEA[0][2];for(let os=0;os<xo.meshes.length;++os){const _i=xo.meshes[os],Ss=os===xo.lightMeshIndex;let Ns=hi.wvpForNode;if(Ss){if(!Si&&!Fe.terrain&&Fe.shadowRenderer){Fe.currentLayer<Fe.firstLightBeamLayer&&(Fe.firstLightBeamLayer=Fe.currentLayer);continue}Ns=hi.wvpForTile}else if(Si)continue;const Cs={defines:[]},no=[];if(cg(Cs.defines,no,_i,Fe,Je.lut),Oi||Cs.defines.push("DIFFUSE_SHADED"),qi&&Cs.defines.push("SHADOWS_SINGLE_CASCADE"),_n&&(dn?_n.numRenderedVerticesInShadowPass+=_i.vertexArray.length:_n.numRenderedVerticesInTransparentPass+=_i.vertexArray.length),dn){sf(_i,hi.nodeModelMatrix,Fe,Je);continue}let Oa=null;if(mt){const Rc=ug(hi.nodeModelMatrix,Fe.transform);if(Oa=new Float32Array(Rc),rt.projection.name!=="globe"){const wd=_i.aabb.min,Wu=_i.aabb.max,[hf,ff]=mt.getOpacityForBounds(Rc,wd[0],wd[1],Wu[0],Wu[1]);Cs.overrideFog=hf>=Nt||ff>=Nt}}const Da=_i.material;let Hl;Da.occlusionTexture&&Da.occlusionTexture.offsetScale&&(Hl=Da.occlusionTexture.offsetScale,Cs.defines.push("OCCLUSION_TEXTURE_TRANSFORM")),!dn&&dt&&(dt.useNormalOffset=!!_i.normalBuffer);const Tl=Fe.getOrCreateProgram("model",Cs);!dn&&dt&&dt.setupShadowsFromMatrix(hi.tileModelMatrix,Tl,dt.useNormalOffset),Fe.uploadCommonUniforms(it,Tl,null,Oa);const rl=Da.pbrMetallicRoughness;rl.metallicFactor=.9,rl.roughnessFactor=.5;const Wl=ir(new Float32Array(Ns),new Float32Array($i),new Float32Array(ni),new Float32Array(xo.matrix),Fe,hi.opacity,rl.baseColorFactor.toRenderColor(null),Da.emissiveFactor,rl.metallicFactor,rl.roughnessFactor,Da,Bo,Je,[0,0,0],Hl);!Ss&&(Hi.hasTranslucentParts||hi.opacity<1)&&Tl.draw(Fe,it.gl.TRIANGLES,on,Dr.disabled,Hr.disabled,Mr.backCCW,Wl,Je.id,_i.vertexBuffer,_i.indexBuffer,_i.segments,Je.paint,Fe.transform.zoom,void 0,no),Tl.draw(Fe,it.gl.TRIANGLES,Ss?Tn:on,Dr.disabled,Ss||hi.opacity<1||Hi.hasTranslucentParts?Hr.alphaBlended:Hr.unblended,Mr.backCCW,Wl,Je.id,_i.vertexBuffer,_i.indexBuffer,_i.segments,Je.paint,Fe.transform.zoom,void 0,no)}}}}()}(g,o,c,y),void Y();if(ee.type!=="model")return;const te=ee.getModels(),ue=[],fe=g.transform.getFreeCameraOptions().position,me=r.a6.vec3.scale([],[fe.x,fe.y,fe.z],g.transform.worldSize);r.a6.vec3.negate(me,me);const ke=[],Le=[];let De=0;for(const Fe of te){const Ye=c.paint.get("model-rotation").constantOr(null),Je=c.paint.get("model-scale").constantOr(null),qe=c.paint.get("model-translation").constantOr(null);Fe.computeModelMatrix(g,Ye,Je,qe,!0,!0,!1);const it=r.a6.mat4.identity([]),rt=r.de(Fe.position.lat,g.transform.zoom),mt=r.a6.mat4.fromScaling([],[1,1,1/rt]);r.a6.mat4.translate(it,it,me),ue.push({zScaleMatrix:mt,negCameraPosMatrix:it});for(const dt of Fe.nodes)Dp(g.transform,dt,Fe.matrix,g.transform.expandedFarZProjMatrix,De,ke,Le);De++}if(ke.sort((Fe,Ye)=>Ye.depth-Fe.depth),g.renderPass!=="shadow"){if(S===1)for(const Fe of Le)Op(Fe,g,c,ue[Fe.modelIndex],Dr.disabled,g.colorModeForRenderPass());else{for(const Fe of Le)Op(Fe,g,c,ue[Fe.modelIndex],Dr.disabled,Hr.disabled);for(const Fe of Le)Op(Fe,g,c,ue[Fe.modelIndex],g.stencilModeFor3D(),g.colorModeForRenderPass());g.resetStencilClippingMasks()}for(const Fe of ke)Op(Fe,g,c,ue[Fe.modelIndex],Dr.disabled,g.colorModeForRenderPass());Y()}else{for(const Fe of Le)sf(Fe.mesh,Fe.nodeModelMatrix,g,c);for(const Fe of ke)sf(Fe.mesh,Fe.nodeModelMatrix,g,c);Y()}}},hg={model:function(g,o,c){const y=o.getSource();if(!y.loaded())return;if(y.type==="vector"||y.type==="geojson")return void(c.modelManager&&c.modelManager.upload(c,y.type==="vector"?g.scope:""));if(y.type==="batched-model"||y.type!=="model")return;const S=y.getModels();for(const T of S)T.upload(c.context)},raster:function(g,o,c){const y=o.getSource();if(!(y instanceof ns&&y.loaded()))return;const S=g.sourceLayer||y.rasterLayerIds&&y.rasterLayerIds[0];if(!S)return;const T=g.paint.get("raster-array-band")||y.getInitialBand(S);if(T==null)return;const A=o.getIds().map($=>o.getTileByID($));for(const $ of A)$.updateNeeded(S,T)&&y.prepareTile($,S,T)},"raster-particle":function(g,o,c){const y=o.getSource();if(!(y instanceof ns&&y.loaded()))return;const S=g.sourceLayer||y.rasterLayerIds&&y.rasterLayerIds[0];if(!S)return;const T=g.paint.get("raster-particle-array-band")||y.getInitialBand(S);if(T==null)return;const A=o.getIds().map($=>o.getTileByID($));for(const $ of A)$.updateNeeded(S,T)&&y.prepareTile($,S,T)}};class o_{constructor(o,c,y,S){this.context=new iT(o,c),this.transform=y,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=S,this._timeStamp=r.q.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};const T=["fill","line","symbol","circle","heatmap","fill-extrusion","raster","raster-particle","hillshade","model","background","sky"];for(const $ of T)this._debugParams.enabledLayers[$]=!0;S.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},()=>{this.style.map.triggerRepaint()}),S.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),S.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),S.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),S.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(const $ of T)S.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],$);this.occlusionParams=new dg(S),this.setup(),this.numSublayers=jt.maxUnderzooming+jt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new r.dl,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new nh(this),this._wireframeDebugCache=new yd,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[];const A=new r.r({width:1,height:1},Uint8Array.of(0,0,0,0));this.emptyDepthTexture=new r.T(this.context,A,o.RGBA8),this._clippingActiveLastFrame=!1}updateTerrain(o,c){const y=!!o&&!!o.terrain&&this.transform.projection.supportsTerrain;if(!(y||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new U0(this,o));const S=this._terrain;this.transform.elevation=y?S:null,S.update(o,this.transform,c),this.transform.elevation&&!S.enabled&&(this.transform.elevation=null)}_updateFog(o){const c=o.fog;if(!c||this.transform.projection.name==="globe"||c.getOpacity(this.transform.pitch)<1||c.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[y,S]=c.getFovAdjustedRange(this.transform._fov);if(y>S)return void(this.transform.fogCullDistSq=null);const T=y+.78*(S-y);this.transform.fogCullDistSq=T*T}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(o){o&&!this._terrain&&(this._terrain=new U0(this,this.style)),this._forceTerrainMode=o}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(o,c){if(this.width=o*r.q.devicePixelRatio,this.height=c*r.q.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const y of this.style.order)this.style._mergedLayers[y].resize()}setup(){const o=this.context,c=new r.a_;c.emplaceBack(0,0),c.emplaceBack(r.ab,0),c.emplaceBack(0,r.ab),c.emplaceBack(r.ab,r.ab),this.tileExtentBuffer=o.createVertexBuffer(c,r.b0.members),this.tileExtentSegments=r.b1.simpleSegment(0,0,4,2);const y=new r.a_;y.emplaceBack(0,0),y.emplaceBack(r.ab,0),y.emplaceBack(0,r.ab),y.emplaceBack(r.ab,r.ab),this.debugBuffer=o.createVertexBuffer(y,r.b0.members),this.debugSegments=r.b1.simpleSegment(0,0,4,5);const S=new r.a_;S.emplaceBack(-1,-1),S.emplaceBack(1,-1),S.emplaceBack(-1,1),S.emplaceBack(1,1),this.viewportBuffer=o.createVertexBuffer(S,r.b0.members),this.viewportSegments=r.b1.simpleSegment(0,0,4,2);const T=new r.aN;T.emplaceBack(0,0,0,0),T.emplaceBack(r.ab,0,r.ab,0),T.emplaceBack(0,r.ab,0,r.ab),T.emplaceBack(r.ab,r.ab,r.ab,r.ab),this.mercatorBoundsBuffer=o.createVertexBuffer(T,r.b3.members),this.mercatorBoundsSegments=r.b1.simpleSegment(0,0,4,2);const A=new r.aO;A.emplaceBack(0,1,2),A.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=o.createIndexBuffer(A);const $=new r.a$;for(const ee of[0,1,3,2,0])$.emplaceBack(ee);this.debugIndexBuffer=o.createIndexBuffer($),this.emptyTexture=new r.T(o,new r.r({width:1,height:1},Uint8Array.of(0,0,0,0)),o.gl.RGBA8),this.identityMat=r.a6.mat4.create();const Y=this.context.gl;this.stencilClearMode=new Dr({func:Y.ALWAYS,mask:0},0,255,Y.ZERO,Y.ZERO,Y.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(o){return o._makeTileBoundsBuffers(this.context,this.transform.projection),o._tileBoundsBuffer?{tileBoundsBuffer:o._tileBoundsBuffer,tileBoundsIndexBuffer:o._tileBoundsIndexBuffer,tileBoundsSegments:o._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const o=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,o.TRIANGLES,cr.disabled,this.stencilClearMode,Hr.disabled,Mr.disabled,Ip(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(o,c,y){if(!c||this.currentStencilSource===c.id||!o.isTileClipped()||!y||y.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let $=!1;for(const Y of y)if(this._tileClippingMaskIDs[Y.key]===void 0){$=!0;break}if(!$)return}this.currentStencilSource=c.id;const S=this.context,T=S.gl;this.nextStencilID+y.length>256&&this.clearStencil(),S.setColorMode(Hr.disabled),S.setDepthMode(cr.disabled);const A=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const $ of y){const Y=c.getTile($),ee=this._tileClippingMaskIDs[$.key]=this.nextStencilID++,{tileBoundsBuffer:te,tileBoundsIndexBuffer:ue,tileBoundsSegments:fe}=this.getTileBoundsBuffers(Y);A.draw(this,T.TRIANGLES,cr.disabled,new Dr({func:T.ALWAYS,mask:0},ee,255,T.KEEP,T.KEEP,T.REPLACE),Hr.disabled,Mr.disabled,Ip($.projMatrix),"$clipping",te,ue,fe)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const o=this.nextStencilID++,c=this.context.gl;return new Dr({func:c.NOTEQUAL,mask:255},o,255,c.KEEP,c.KEEP,c.REPLACE)}stencilModeForClipping(o){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(o);const c=this.context.gl;return new Dr({func:c.EQUAL,mask:255},this._tileClippingMaskIDs[o.key],0,c.KEEP,c.KEEP,c.REPLACE)}stencilConfigForOverlap(o){const c=this.context.gl,y=o.sort((A,$)=>$.overscaledZ-A.overscaledZ),S=y[y.length-1].overscaledZ,T=y[0].overscaledZ-S+1;if(T>1){this.currentStencilSource=void 0,this.nextStencilID+T>256&&this.clearStencil();const A={};for(let $=0;$<T;$++)A[$+S]=new Dr({func:c.GEQUAL,mask:255},$+this.nextStencilID,255,c.KEEP,c.KEEP,c.REPLACE);return this.nextStencilID+=T,[A,y]}return[{[S]:Dr.disabled},y]}colorModeForRenderPass(){const o=this.context.gl;return this._showOverdrawInspector?new Hr([o.CONSTANT_COLOR,o.ONE,o.CONSTANT_COLOR,o.ONE],new r.bz(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Hr.unblended:Hr.alphaBlended}colorModeForDrapableLayerRenderPass(o){const c=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.renderPass==="translucent"?new Hr([c.ONE,c.ONE_MINUS_SRC_ALPHA,c.CONSTANT_ALPHA,c.ONE_MINUS_SRC_ALPHA],new r.bz(0,0,0,o===void 0?0:o),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(o,c,y,S=!1){if(this.depthOcclusion)return new cr(this.context.gl.GREATER,cr.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!S)return cr.disabled;const T=1-((1+this.currentLayer)*this.numSublayers+o)*this.depthEpsilon;return new cr(y||this.context.gl.LEQUAL,c,[T,T])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}blitDepth(){const o=this.context.gl,c=Math.ceil(this.width),y=Math.ceil(this.height),S=this.context.bindFramebuffer.get(),T=o.getParameter(o.TEXTURE_BINDING_2D);this.depthFBO&&this.depthFBO.width===c&&this.depthFBO.height===y||(this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),c!==0&&y!==0&&(this.depthFBO=new ng(this.context,c,y,!1,"texture"),this.depthTexture=new r.T(this.context,{width:c,height:y,data:null},o.DEPTH24_STENCIL8),this.depthFBO.depthAttachment.set(this.depthTexture.texture))),this.context.bindFramebuffer.set(S),o.bindTexture(o.TEXTURE_2D,T),this.depthFBO&&(o.bindFramebuffer(o.READ_FRAMEBUFFER,null),o.bindFramebuffer(o.DRAW_FRAMEBUFFER,this.depthFBO.framebuffer),o.blitFramebuffer(0,0,c,y,0,0,c,y,o.DEPTH_BUFFER_BIT,o.NEAREST),o.bindFramebuffer(o.FRAMEBUFFER,this.context.bindFramebuffer.current))}updateAverageFPS(){this._fpsHistory.push(this._dt===0?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce((o,c)=>o+c/this._fpsHistory.length,0))}render(o,c){const y=r.q.now();this._dt=y-this._timeStamp,this._timeStamp=y,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=o.map.repaint,this.style=o,this.options=c;const S=this.style._mergedLayers,T=this.style.order.filter(bt=>{const vt=S[bt];return!(vt.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[vt.type]});let A=!1,$=!1;for(const bt of T){const vt=S[bt];vt.type==="circle"&&(A=!0),vt.type==="symbol"&&(vt.hasInitialOcclusionOpacityProperties?$=!0:A=!0)}const Y=T.map(bt=>S[bt]),ee=this.style._mergedSourceCaches;this.imageManager=o.imageManager,this.modelManager=o.modelManager,this.symbolFadeChange=o.placement.symbolFadeChange(r.q.now()),this.imageManager.beginFrame();let te=0,ue=!1;for(const bt in ee){const vt=ee[bt];vt.used&&(vt.prepare(this.context),vt.getSource().usedInConflation&&++te)}let fe=!1;for(const bt of Y)bt.isHidden(this.transform.zoom)||(bt.type==="clip"&&(fe=!0),this.prepareLayer(bt));const me={},ke={},Le={},De={},Fe={};for(const bt in ee){const vt=ee[bt];me[bt]=vt.getVisibleCoordinates(),ke[bt]=me[bt].slice().reverse(),Le[bt]=vt.getVisibleCoordinates(!0).reverse(),De[bt]=vt.getShadowCasterCoordinates(),Fe[bt]=vt.sortCoordinatesByDistance(me[bt])}const Ye=bt=>{const vt=this.style.getLayerSourceCache(bt);return vt&&vt.used?vt.getSource():null};if(te||fe||this._clippingActiveLastFrame){const bt=[],vt=[];let Ot=0;for(const sn of Y)this.isSourceForClippingOrConflation(sn,Ye(sn))&&(bt.push(sn),vt.push(Ot)),Ot++;if(bt&&(fe||bt.length>1)||this._clippingActiveLastFrame){fe=!1;const sn=[];for(let mn=0;mn<bt.length;mn++){const on=bt[mn],Tn=vt[mn],Dt=this.style.getLayerSourceCache(on);if(!Dt||!Dt.used||!Dt.getSource().usedInConflation&&on.type!=="clip")continue;let dn=r.dn,cn=r.bs.None;const In=[];let An=!0;if(on.type==="clip"){dn=Tn;for(const pn of on.layout.get("clip-layer-types"))cn|=pn==="model"?r.bs.Model:pn==="symbol"?r.bs.Symbol:r.bs.FillExtrusion;for(const pn of on.layout.get("clip-layer-scope"))In.push(pn);on.isHidden(this.transform.zoom)?An=!1:fe=!0}An&&sn.push({layer:on.fqid,cache:Dt,order:dn,clipMask:cn,clipScope:In})}this.replacementSource.setSources(sn),ue=!0}}this._clippingActiveLastFrame=fe,ue||this.replacementSource.clear(),this.conflationActive=ue,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let bt=0;bt<Y.length;bt++){const vt=Y[bt],Ot=vt.cutoffRange();if(this.longestCutoffRange=Math.max(Ot,this.longestCutoffRange),Ot>0){const sn=Ye(vt);sn&&(this.minCutoffZoom=Math.max(sn.minzoom,this.minCutoffZoom)),vt.minzoom&&(this.minCutoffZoom=Math.max(vt.minzoom,this.minCutoffZoom))}vt.is3D()&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=bt),this._lastOcclusionLayer=bt)}const Je=this.style&&this.style.fog;Je?(this._fogVisible=Je.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=Je.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(Le),this.opaquePassCutoff=0);const qe=this._shadowRenderer;if(qe){qe.updateShadowParameters(this.transform,this.style.directionalLight);for(const bt in ee)for(const vt of me[bt]){let Ot={min:0,max:0};this.terrain&&(Ot=this.terrain.getMinMaxForTile(vt)||Ot),qe.addShadowReceiver(vt.toUnwrapped(),Ot.min,Ot.max)}}if(this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new r.dm(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new lg(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),!We.has(this.context.gl))return;this.renderPass="offscreen";for(const bt of Y){const vt=o.getLayerSourceCache(bt);if(!bt.hasOffscreenPass()||bt.isHidden(this.transform.zoom))continue;const Ot=vt?ke[vt.id]:void 0;(bt.type==="custom"||bt.type==="raster"||bt.type==="raster-particle"||bt.isSky()||Ot&&Ot.length)&&this.renderLayer(this,vt,bt,Ot)}this.depthRangeFor3D=[0,1-(Y.length+2)*this.numSublayers*this.depthEpsilon],this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,De)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const it=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),rt=(()=>{if(c.showOverdrawInspector)return r.bz.black;const bt=this.style.fog;if(bt&&this.transform.projection.supportsFog){const vt=this.style.getLut(bt.scope);if(!it){const Ot=bt.properties.get("color").toRenderColor(vt).toArray01();return new r.bz(...Ot)}if(it){const Ot=bt.properties.get("space-color").toRenderColor(vt).toArray01();return new r.bz(...Ot)}}return r.bz.transparent})();if(this.context.clear({color:rt,depth:1}),this.clearStencil(),this._showOverdrawInspector=c.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&it&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=T.length-1;this.currentLayer>=0;this.currentLayer--){const bt=Y[this.currentLayer],vt=o.getLayerSourceCache(bt);if(bt.isSky())continue;const Ot=vt?(bt.is3D()?Fe:ke)[vt.id]:void 0;this._renderTileClippingMasks(bt,vt,Ot),this.renderLayer(this,vt,bt,Ot)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&it&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||r.a9(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<T.length;this.currentLayer++){const bt=Y[this.currentLayer],vt=o.getLayerSourceCache(bt);bt.isSky()&&this.renderLayer(this,vt,bt,vt?ke[vt.id]:void 0)}function mt(bt,vt){let Ot;return vt&&(Ot=(bt.type==="symbol"?Le:bt.is3D()?Fe:ke)[vt.id]),Ot}if(this.renderPass="translucent",this.transform.projection.name==="globe"){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<T.length;){const bt=Y[this.currentLayer];if(bt.type==="raster"||bt.type==="raster-particle"){const vt=o.getLayerSourceCache(bt);this.renderLayer(this,vt,bt,mt(bt,vt))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let dt=0;qe&&(dt=qe.getShadowCastingLayerCount());let yt=!1,Et=-1;for(let bt=0;bt<T.length;++bt){const vt=Y[bt];vt.isHidden(this.transform.zoom)||vt.is3D()&&(Et=bt)}for($&&Et===-1&&(A=!0);this.currentLayer<T.length;){const bt=Y[this.currentLayer],vt=o.getLayerSourceCache(bt);if(bt.isSky())++this.currentLayer;else if(this.terrain&&this.style.isLayerDraped(bt)){if(bt.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(A&&!yt&&this.terrain&&!this.transform.isOrthographic&&(yt=!0,this.blitDepth()),$&&Et!==-1&&this.currentLayer===Et+1&&!this.transform.isOrthographic&&this.blitDepth(),bt.is3D()||this.terrain||this._renderTileClippingMasks(bt,vt,vt?me[vt.id]:void 0),this.renderLayer(this,vt,bt,mt(bt,vt)),!this.terrain&&qe&&dt>0&&bt.hasShadowPass()&&--dt==0&&(qe.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const Ot=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=Ot;this.currentLayer++){const sn=Y[this.currentLayer];if(!sn.hasLightBeamPass())continue;const mn=o.getLayerSourceCache(sn);this.renderLayer(this,mn,sn,mn?ke[mn.id]:void 0)}this.currentLayer=Ot,this.renderPass="translucent"}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){const Ot=this.currentLayer;this.depthOcclusion=!0;for(const sn of this.layersWithOcclusionOpacity){this.currentLayer=sn;const mn=Y[this.currentLayer],on=o.getLayerSourceCache(mn),Tn=on?ke[on.id]:void 0;mn.is3D()||this.terrain||this._renderTileClippingMasks(mn,on,on?me[on.id]:void 0),this.renderLayer(this,on,mn,Tn)}this.depthOcclusion=!1,this.currentLayer=Ot,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let bt=null;Y.forEach(vt=>{const Ot=o.getLayerSourceCache(vt);Ot&&!vt.isHidden(this.transform.zoom)&&Ot.getVisibleCoordinates().length&&(!bt||bt.getSource().maxzoom<Ot.getSource().maxzoom)&&(bt=Ot)}),bt&&this.options.showTileBoundaries&&_d.debug(this,bt,bt.getVisibleCoordinates(),r.bz.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&_d.debug(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new r.bz(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(bt){const vt=bt.transform.padding;vo(bt,bt.transform.height-(vt.top||0),3,aT),vo(bt,vt.bottom||0,3,nf),$t(bt,vt.left||0,3,rf),$t(bt,bt.transform.width-(vt.right||0),3,zn);const Ot=bt.transform.centerPoint;(function(sn,mn,on,Tn){Rp(sn,mn-1,on-10,2,20,Tn),Rp(sn,mn-10,on-1,20,2,Tn)})(bt,Ot.x,bt.transform.height-Ot.y,gr)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),ue||(this.conflationActive=!1)}prepareLayer(o){this.gpuTimingStart(o);const{unsupportedLayers:c}=this.transform.projection,y=!c||!c.includes(o.type);if(hg[o.type]&&(y||this.terrain&&o.type==="custom")){const S=this.style.getLayerSourceCache(o);hg[o.type](o,S,this)}this.gpuTimingEnd()}renderLayer(o,c,y,S){y.isHidden(this.transform.zoom)||(y.type==="background"||y.type==="sky"||y.type==="custom"||y.type==="model"||y.type==="raster"||y.type==="raster-particle"||S&&S.length)&&(this.id=y.id,this.gpuTimingStart(y),o.transform.projection.unsupportedLayers&&o.transform.projection.unsupportedLayers.includes(y.type)&&(!o.terrain||y.type!=="custom")||y.type==="clip"||_d[y.type](o,c,y,S,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(o){if(!this.options.gpuTiming)return;const c=this.context.extTimerQuery,y=this.context.gl;let S=this.gpuTimers[o.id];S||(S=this.gpuTimers[o.id]={calls:0,cpuTime:0,query:y.createQuery()}),S.calls++,y.beginQuery(c.TIME_ELAPSED_EXT,S.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const o=this.context.extTimerQuery,c=this.context.gl,y=c.createQuery();this.deferredRenderGpuTimeQueries.push(y),c.beginQuery(o.TIME_ELAPSED_EXT,y)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const o=this.gpuTimers;return this.gpuTimers={},o}collectDeferredRenderGpuQueries(){const o=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],o}queryGpuTimers(o){const c={};for(const y in o){const S=o[y],T=this.context.extTimerQuery,A=T.getQueryParameter(S.query,this.context.gl.QUERY_RESULT)/1e6;T.deleteQueryEXT(S.query),c[y]=A}return c}queryGpuTimeDeferredRender(o){if(!this.options.gpuTimingDeferredRender)return 0;const c=this.context.extTimerQuery,y=this.context.gl;let S=0;for(const T of o)S+=c.getQueryParameter(T,y.QUERY_RESULT)/1e6,c.deleteQueryEXT(T);return S}translatePosMatrix(o,c,y,S,T){if(!y[0]&&!y[1])return o;const A=T?S==="map"?this.transform.angle:0:S==="viewport"?-this.transform.angle:0;if(A){const ee=Math.sin(A),te=Math.cos(A);y=[y[0]*te-y[1]*ee,y[0]*ee+y[1]*te]}const $=[T?y[0]:r.ak(c,y[0],this.transform.zoom),T?y[1]:r.ak(c,y[1],this.transform.zoom),0],Y=new Float32Array(16);return r.a6.mat4.translate(Y,o,$),Y}saveTileTexture(o){const c=o.size[0],y=this._tileTextures[c];y?y.push(o):this._tileTextures[c]=[o]}getTileTexture(o){const c=this._tileTextures[o];return c&&c.length>0?c.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(o,c,y){const S=y===void 0?this.terrain&&this.terrain.renderingToTexture:y,T=[];return this.style&&this.style.enable3dLights()&&(o==="globeRaster"||o==="terrainRaster"?(T.push("LIGHTING_3D_MODE"),T.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):S||T.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"?this._shadowMapDebug||T.push("DEPTH_TEXTURE"):this.shadowRenderer&&(this.shadowRenderer.useNormalOffset?T.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"):T.push("RENDER_SHADOWS","DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(T.push("TERRAIN"),this.linearFloatFilteringSupported()&&T.push("TERRAIN_DEM_FLOAT_FORMAT")),this.transform.projection.name==="globe"&&T.push("GLOBE"),!this._fogVisible||S||c!==void 0&&!c||T.push("FOG","FOG_DITHERING"),S&&T.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&T.push("OVERDRAW_INSPECTOR"),T}getOrCreateProgram(o,c){this.cache=this.cache||{};const y=c&&c.defines||[],S=c&&c.config,T=this.currentGlobalDefines(o,c&&c.overrideFog,c&&c.overrideRtt).concat(y),A=md.cacheKey(er[o],o,T,S);return this.cache[A]||(this.cache[A]=new md(this.context,o,er[o],S,H1[o],T)),this.cache[A]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const o=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(o.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new r.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA8))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy(),this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),this.emptyDepthTexture&&this.emptyDepthTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(o,c){if(this.style.enable3dLights()){const y=this.style.directionalLight,S=this.style.ambientLight;if(y&&S){const T=((A,$,Y)=>{const ee=A.properties.get("direction"),te=A.properties.get("color").toRenderColor(Y.getLut(A.scope)).toArray01(),ue=A.properties.get("intensity"),fe=$.properties.get("color").toRenderColor(Y.getLut($.scope)).toArray01(),me=$.properties.get("intensity"),ke=[ee.x,ee.y,ee.z],Le=r.cH(fe,me),De=r.cH(te,ue);return{u_lighting_ambient_color:Le,u_lighting_directional_dir:ke,u_lighting_directional_color:De,u_ground_radiance:G0(ke,De,Le)}})(y,S,this.style);c.setLightsUniformValues(o,T)}}}uploadCommonUniforms(o,c,y,S,T){if(this.uploadCommonLightUniforms(o,c),this.terrain&&this.terrain.renderingToTexture)return;const A=this.style.fog;if(A){const $=A.getOpacity(this.transform.pitch),Y=((ee,te,ue,fe,me,ke,Le,De,Fe,Ye,Je,qe)=>{const it=ee.transform,rt=te.properties.get("color").toRenderColor(ee.style.getLut(te.scope)).toArray01();rt[3]=fe;const mt=ee.frameCounter/1e3%1,[dt,yt]=te.properties.get("vertical-range");return{u_fog_matrix:ue?it.calculateFogTileMatrix(ue):qe||ee.identityMat,u_fog_range:te.getFovAdjustedRange(it._fov),u_fog_color:rt,u_fog_horizon_blend:te.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(dt,yt),yt],u_fog_temporal_offset:mt,u_frustum_tl:me,u_frustum_tr:ke,u_frustum_br:Le,u_frustum_bl:De,u_globe_pos:Fe,u_globe_radius:Ye,u_viewport:Je,u_globe_transition:r.a9(it.zoom),u_is_globe:+(it.projection.name==="globe")}})(this,A,y,$,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*r.q.devicePixelRatio,this.transform.height*r.q.devicePixelRatio],S);c.setFogUniformValues(o,Y)}T&&c.setCutoffUniformValues(o,T.uniformValues)}setTileLoadedFlag(o){this.tileLoaded=o}saveCanvasCopy(){const o=this.canvasCopy();o&&(this.frameCopies.push(o),this.tileLoaded=!1)}canvasCopy(){const o=this.context.gl,c=o.createTexture();return o.bindTexture(o.TEXTURE_2D,c),o.copyTexImage2D(o.TEXTURE_2D,0,o.RGBA,0,0,o.drawingBufferWidth,o.drawingBufferHeight,0),c}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const o=this.style&&this.style.fog;return!!o&&o.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const o=this._backgroundTiles,c=this._backgroundTiles={},y=this.transform.coveringTiles({tileSize:512});for(const S of y)c[S.key]=o[S.key]||new ne(S,512,this.transform.tileZoom,this);return c}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(o,c){return!(!o.is3D()||o.type!=="clip"&&(o.minzoom&&o.minzoom>this.transform.zoom||(this.style._clipLayerPresent||o.sourceLayer!=="building")&&(!c||c.type!=="batched-model")))}isTileAffectedByFog(o){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let c=this._cachedTileFogOpacities[o.key];return c||(this._cachedTileFogOpacities[o.key]=c=this.style.fog.getOpacityForTile(o)),c[0]>=Nt||c[1]>=Nt}setupDepthForOcclusion(o,c,y){const S=this.context,T=S.gl,A=!!y;var $;y||(y={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0}),S.activeTexture.set(T.TEXTURE3),o&&this.depthFBO&&this.depthTexture?(this.depthTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE),y.u_depth_size_inv=[1/this.depthFBO.width,1/this.depthFBO.height],y.u_depth_range_unpack=[2/(($=this.depthRangeFor3D)[1]-$[0]),-1-2*$[0]/($[1]-$[0])],y.u_occluder_half_size=.5*this.occlusionParams.occluderSize,y.u_occlusion_depth_offset=this.occlusionParams.depthOffset):this.emptyDepthTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE),S.activeTexture.set(T.TEXTURE0),A||c.setTerrainUniformValues(S,y)}}function Mc(g,o){let c=!1,y=null;const S=()=>{y=null,c&&(g(),y=setTimeout(S,o),c=!1)};return()=>(c=!0,y||S(),y)}class vd{constructor(o){this._hashName=o&&encodeURIComponent(o),r.aJ(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Mc(this._updateHashUnthrottled.bind(this),300)}addTo(o){return this._map=o,window.addEventListener("hashchange",this._onHashChange,!1),o.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const o=this._map;if(!o)return"";const c=Pc(o);if(this._hashName){const y=this._hashName;let S=!1;const T=location.hash.slice(1).split("&").map(A=>{const $=A.split("=")[0];return $===y?(S=!0,`${$}=${c}`):A}).filter(A=>A);return S||T.push(`${y}=${c}`),`#${T.join("&")}`}return`#${c}`}_getCurrentHash(){const o=location.hash.replace("#","");if(this._hashName){let c;return o.split("&").map(y=>y.split("=")).forEach(y=>{y[0]===this._hashName&&(c=y)}),(c&&c[1]||"").split("/")}return o.split("/")}_onHashChange(){const o=this._map;if(!o)return!1;const c=this._getCurrentHash();if(c.length>=3&&!c.some(y=>isNaN(y))){const y=o.dragRotate.isEnabled()&&o.touchZoomRotate.isEnabled()?+(c[3]||0):o.getBearing();return o.jumpTo({center:[+c[2],+c[1]],zoom:+c[0],bearing:y,pitch:+(c[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function Pc(g,o){const c=g.getCenter(),y=Math.round(100*g.getZoom())/100,S=Math.ceil((y*Math.LN2+Math.log(512/360/.5))/Math.LN10),T=Math.pow(10,S),A=Math.round(c.lng*T)/T,$=Math.round(c.lat*T)/T,Y=g.getBearing(),ee=g.getPitch();let te=o?`/${A}/${$}/${y}`:`${y}/${$}/${A}`;return(Y||ee)&&(te+="/"+Math.round(10*Y)/10),ee&&(te+=`/${Math.round(ee)}`),te}const lh={linearity:.3,easing:r.dp(0,0,.3,1)},fg=r.l({deceleration:2500,maxSpeed:1400},lh),s_=r.l({deceleration:20,maxSpeed:1400},lh),a_=r.l({deceleration:1e3,maxSpeed:360},lh),l_=r.l({deceleration:1e3,maxSpeed:90},lh);class xd{constructor(o){this._map=o,this.clear()}clear(){this._inertiaBuffer=[]}record(o){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:r.q.now(),settings:o})}_drainInertiaBuffer(){const o=this._inertiaBuffer,c=r.q.now();for(;o.length>0&&c-o[0].time>160;)o.shift()}_onMoveEnd(o){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const c={zoom:0,bearing:0,pitch:0,pan:new r.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:T}of this._inertiaBuffer)c.zoom+=T.zoomDelta||0,c.bearing+=T.bearingDelta||0,c.pitch+=T.pitchDelta||0,T.panDelta&&c.pan._add(T.panDelta),T.around&&(c.around=T.around),T.pinchAround&&(c.pinchAround=T.pinchAround);const y=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,S={};if(c.pan.mag()){const T=uh(c.pan.mag(),y,r.l({},fg,o||{}));S.offset=c.pan.mult(T.amount/c.pan.mag()),S.center=this._map.transform.center,af(S,T)}if(c.zoom){const T=uh(c.zoom,y,s_);S.zoom=this._map.transform.zoom+T.amount,af(S,T)}if(c.bearing){const T=uh(c.bearing,y,a_);S.bearing=this._map.transform.bearing+r.ap(T.amount,-179,179),af(S,T)}if(c.pitch){const T=uh(c.pitch,y,l_);S.pitch=this._map.transform.pitch+T.amount,af(S,T)}if(S.zoom||S.bearing){const T=c.pinchAround===void 0?c.around:c.pinchAround;S.around=T?this._map.unproject(T):this._map.getCenter()}return this.clear(),S.noMoveStart=!0,S}}function af(g,o){(!g.duration||g.duration<o.duration)&&(g.duration=o.duration,g.easing=o.easing)}function uh(g,o,c){const{maxSpeed:y,linearity:S,deceleration:T}=c,A=r.ap(g*S/(o/1e3),-y,y),$=Math.abs(A)/(T*S);return{easing:c.easing,duration:1e3*$,amount:A*($/2)}}class Ra extends r.x{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,c,y,S={}){const T=ce(c.getCanvasContainer(),y),A=c.unproject(T);super(o,r.l({point:T,lngLat:A,originalEvent:y},S)),this._defaultPrevented=!1,this.target=c}}class lf extends r.x{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,c,y){const S=o==="touchend"?y.changedTouches:y.touches,T=oe(c.getCanvasContainer(),S),A=T.map(Y=>c.unproject(Y)),$=T.reduce((Y,ee,te,ue)=>Y.add(ee.div(ue.length)),new r.P(0,0));super(o,{points:T,point:$,lngLats:A,lngLat:c.unproject($),originalEvent:y}),this._defaultPrevented=!1}}class sa extends r.x{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,c){super("wheel",{originalEvent:c}),this._defaultPrevented=!1}}class u_{constructor(o,c){this._map=o,this._clickTolerance=c.clickTolerance}reset(){this._mousedownPos=void 0}wheel(o){return this._firePreventable(new sa(this._map,o))}mousedown(o,c){return this._mousedownPos=c,this._firePreventable(new Ra(o.type,this._map,o))}mouseup(o){this._map.fire(new Ra(o.type,this._map,o))}preclick(o){const c=r.l({},o);c.type="preclick",this._map.fire(new Ra(c.type,this._map,c))}click(o,c){this._mousedownPos&&this._mousedownPos.dist(c)>=this._clickTolerance||(this.preclick(o),this._map.fire(new Ra(o.type,this._map,o)))}dblclick(o){return this._firePreventable(new Ra(o.type,this._map,o))}mouseover(o){this._map.fire(new Ra(o.type,this._map,o))}mouseout(o){this._map.fire(new Ra(o.type,this._map,o))}touchstart(o){return this._firePreventable(new lf(o.type,this._map,o))}touchmove(o){this._map.fire(new lf(o.type,this._map,o))}touchend(o){this._map.fire(new lf(o.type,this._map,o))}touchcancel(o){this._map.fire(new lf(o.type,this._map,o))}_firePreventable(o){if(this._map.fire(o),o.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class c_{constructor(o){this._map=o}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(o){this._map.fire(new Ra(o.type,this._map,o))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ra("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(o){this._delayContextMenu?this._contextMenuEvent=o:this._map.fire(new Ra(o.type,this._map,o)),this._map.listens("contextmenu")&&o.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class uf{constructor(o,c){this._map=o,this._el=o.getCanvasContainer(),this._container=o.getContainer(),this._clickTolerance=c.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(o,c){this.isEnabled()&&o.shiftKey&&o.button===0&&(le(),this._startPos=this._lastPos=c,this._active=!0)}mousemoveWindow(o,c){if(!this._active)return;const y=c,S=this._startPos,T=this._lastPos;if(!S||!T||T.equals(y)||!this._box&&y.dist(S)<this._clickTolerance)return;this._lastPos=y,this._box||(this._box=W("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",o));const A=Math.min(S.x,y.x),$=Math.max(S.x,y.x),Y=Math.min(S.y,y.y),ee=Math.max(S.y,y.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${A}px,${Y}px)`,this._box.style.width=$-A+"px",this._box.style.height=ee-Y+"px")})}mouseupWindow(o,c){if(!this._active)return;const y=this._startPos,S=c;if(y&&o.button===0){if(this.reset(),de(),y.x!==S.x||y.y!==S.y)return this._map.fire(new r.x("boxzoomend",{originalEvent:o})),{cameraAnimation:T=>T.fitScreenCoordinates(y,S,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",o)}}keydown(o){this._active&&o.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",o))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),_e(),delete this._startPos,delete this._lastPos}_fireEvent(o,c){return this._map.fire(new r.x(o,{originalEvent:c}))}}function Ac(g,o){const c={};for(let y=0;y<g.length;y++)c[g[y].identifier]=o[y];return c}class d_{constructor(o){this.reset(),this.numTouches=o.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(o,c,y){(this.centroid||y.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=o.timeStamp),y.length===this.numTouches&&(this.centroid=function(S){const T=new r.P(0,0);for(const A of S)T._add(A);return T.div(S.length)}(c),this.touches=Ac(y,c)))}touchmove(o,c,y){if(this.aborted||!this.centroid)return;const S=Ac(y,c);for(const T in this.touches){const A=S[T];(!A||A.dist(this.touches[T])>30)&&(this.aborted=!0)}}touchend(o,c,y){if((!this.centroid||o.timeStamp-this.startTime>500)&&(this.aborted=!0),y.length===0){const S=!this.aborted&&this.centroid;if(this.reset(),S)return S}}}class Fp{constructor(o){this.singleTap=new d_(o),this.numTaps=o.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(o,c,y){this.singleTap.touchstart(o,c,y)}touchmove(o,c,y){this.singleTap.touchmove(o,c,y)}touchend(o,c,y){const S=this.singleTap.touchend(o,c,y);if(S){const T=o.timeStamp-this.lastTime<500,A=!this.lastTap||this.lastTap.dist(S)<30;if(T&&A||this.reset(),this.count++,this.lastTime=o.timeStamp,this.lastTap=S,this.count===this.numTaps)return this.reset(),S}}}class h_{constructor(){this._zoomIn=new Fp({numTouches:1,numTaps:2}),this._zoomOut=new Fp({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(o,c,y){this._zoomIn.touchstart(o,c,y),this._zoomOut.touchstart(o,c,y)}touchmove(o,c,y){this._zoomIn.touchmove(o,c,y),this._zoomOut.touchmove(o,c,y)}touchend(o,c,y){const S=this._zoomIn.touchend(o,c,y),T=this._zoomOut.touchend(o,c,y);return S?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:A=>A.easeTo({duration:300,zoom:A.getZoom()+1,around:A.unproject(S)},{originalEvent:o})}):T?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:A=>A.easeTo({duration:300,zoom:A.getZoom()-1,around:A.unproject(T)},{originalEvent:o})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Np={0:1,2:2};class Bp{constructor(o){this.reset(),this._clickTolerance=o.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(o,c){return!1}_move(o,c){return{}}mousedown(o,c){if(this._lastPoint)return;const y=xe(o);this._correctButton(o,y)&&(this._lastPoint=c,this._eventButton=y)}mousemoveWindow(o,c){const y=this._lastPoint;if(y){if(o.preventDefault(),this._eventButton!=null&&function(S,T){const A=Np[T];return S.buttons===void 0||(S.buttons&A)!==A}(o,this._eventButton))this.reset();else if(this._moved||!(c.dist(y)<this._clickTolerance))return this._moved=!0,this._lastPoint=c,this._move(y,c)}}mouseupWindow(o){this._lastPoint&&xe(o)===this._eventButton&&(this._moved&&de(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class pg extends Bp{mousedown(o,c){super.mousedown(o,c),this._lastPoint&&(this._active=!0)}_correctButton(o,c){return c===0&&!o.ctrlKey}_move(o,c){return{around:c,panDelta:c.sub(o)}}}class mg extends Bp{_correctButton(o,c){return c===0&&o.ctrlKey||c===2}_move(o,c){const y=.8*(c.x-o.x);if(y)return this._active=!0,{bearingDelta:y}}contextmenu(o){o.preventDefault()}}class gg extends Bp{_correctButton(o,c){return c===0&&o.ctrlKey||c===2}_move(o,c){const y=-.5*(c.y-o.y);if(y)return this._active=!0,{pitchDelta:y}}contextmenu(o){o.preventDefault()}}class Q1{constructor(o,c){this._map=o,this._el=o.getCanvasContainer(),this._minTouches=1,this._clickTolerance=c.clickTolerance||1,this.reset(),r.aJ(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new r.P(0,0)}touchstart(o,c,y){return this._calculateTransform(o,c,y)}touchmove(o,c,y){if(this._active&&!(y.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(y.length===1&&!r.dq())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return o.cancelable&&o.preventDefault(),this._calculateTransform(o,c,y)}}touchend(o,c,y){this._calculateTransform(o,c,y),this._active&&y.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(o,c,y){y.length>0&&(this._active=!0);const S=Ac(y,c),T=new r.P(0,0),A=new r.P(0,0);let $=0;for(const ee in S){const te=S[ee],ue=this._touches[ee];ue&&(T._add(te),A._add(te.sub(ue)),$++,S[ee]=te)}if(this._touches=S,$<this._minTouches||!A.mag())return;const Y=A.div($);return this._sum._add(Y),this._sum.mag()<this._clickTolerance?void 0:{around:T.div($),panDelta:Y}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=W("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")},500)}}class yg{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(o){}_move(o,c,y){return{}}touchstart(o,c,y){this._firstTwoTouches||y.length<2||(this._firstTwoTouches=[y[0].identifier,y[1].identifier],this._start([c[0],c[1]]))}touchmove(o,c,y){const S=this._firstTwoTouches;if(!S)return;o.preventDefault();const[T,A]=S,$=jp(y,c,T),Y=jp(y,c,A);if(!$||!Y)return;const ee=this._aroundCenter?null:$.add(Y).div(2);return this._move([$,Y],ee,o)}touchend(o,c,y){if(!this._firstTwoTouches)return;const[S,T]=this._firstTwoTouches,A=jp(y,c,S),$=jp(y,c,T);A&&$||(this._active&&de(),this.reset())}touchcancel(){this.reset()}enable(o){this._enabled=!0,this._aroundCenter=!!o&&o.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function jp(g,o,c){for(let y=0;y<g.length;y++)if(g[y].identifier===c)return o[y]}function f_(g,o){return Math.log(g/o)/Math.LN2}class eb extends yg{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(o){this._startDistance=this._distance=o[0].dist(o[1])}_move(o,c){const y=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(f_(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:f_(this._distance,y),pinchAround:c}}}function p_(g,o){return 180*g.angleWith(o)/Math.PI}class tb extends yg{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])}_move(o,c){const y=this._vector;if(this._vector=o[0].sub(o[1]),y&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:p_(this._vector,y),pinchAround:c}}_isBelowThreshold(o){this._minDiameter=Math.min(this._minDiameter,o.mag());const c=25/(Math.PI*this._minDiameter)*360,y=this._startVector;if(!y)return!1;const S=p_(o,y);return Math.abs(S)<c}}function _g(g){return Math.abs(g.y)>Math.abs(g.x)}class nb extends yg{constructor(o){super(),this._map=o}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(o){this._lastPoints=o,_g(o[0].sub(o[1]))&&(this._valid=!1)}_move(o,c,y){const S=this._lastPoints;if(!S)return;const T=o[0].sub(S[0]),A=o[1].sub(S[1]);return this._map._cooperativeGestures&&!r.dq()&&y.touches.length<3||(this._valid=this.gestureBeginsVertically(T,A,y.timeStamp),!this._valid)?void 0:(this._lastPoints=o,this._active=!0,{pitchDelta:(T.y+A.y)/2*-.5})}gestureBeginsVertically(o,c,y){if(this._valid!==void 0)return this._valid;const S=o.mag()>=2,T=c.mag()>=2;if(!S&&!T)return;if(!S||!T)return this._firstMove==null&&(this._firstMove=y),y-this._firstMove<100&&void 0;const A=o.y>0==c.y>0;return _g(o)&&_g(c)&&A}}const rb={panStep:100,bearingStep:15,pitchStep:10};class ib{constructor(){const o=rb;this._panStep=o.panStep,this._bearingStep=o.bearingStep,this._pitchStep=o.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(o){if(o.altKey||o.ctrlKey||o.metaKey)return;let c=0,y=0,S=0,T=0,A=0;switch(o.keyCode){case 61:case 107:case 171:case 187:c=1;break;case 189:case 109:case 173:c=-1;break;case 37:o.shiftKey?y=-1:(o.preventDefault(),T=-1);break;case 39:o.shiftKey?y=1:(o.preventDefault(),T=1);break;case 38:o.shiftKey?S=1:(o.preventDefault(),A=-1);break;case 40:o.shiftKey?S=-1:(o.preventDefault(),A=1);break;default:return}return this._rotationDisabled&&(y=0,S=0),{cameraAnimation:$=>{const Y=$.getZoom();$.easeTo({duration:300,easeId:"keyboardHandler",easing:ob,zoom:c?Math.round(Y)+c*(o.shiftKey?2:1):Y,bearing:$.getBearing()+y*this._bearingStep,pitch:$.getPitch()+S*this._pitchStep,offset:[-T*this._panStep,-A*this._panStep],center:$.getCenter()},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function ob(g){return g*(2-g)}const m_=4.000244140625,hT=1/450;class fT{constructor(o,c){this._map=o,this._el=o.getCanvasContainer(),this._handler=c,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=hT,r.aJ(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(o){this._defaultZoomRate=o}setWheelZoomRate(o){this._wheelZoomRate=o}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(o){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!o&&o.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(o){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(o.ctrlKey||o.metaKey||this.isZooming()||r.dq()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let c=o.deltaMode===WheelEvent.DOM_DELTA_LINE?40*o.deltaY:o.deltaY;const y=r.q.now(),S=y-(this._lastWheelEventTime||0);this._lastWheelEventTime=y,c!==0&&c%m_==0?this._type="wheel":c!==0&&Math.abs(c)<4?this._type="trackpad":S>400?(this._type=null,this._lastValue=c,this._timeout=window.setTimeout(this._onTimeout,40,o)):this._type||(this._type=Math.abs(S*c)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,c+=this._lastValue)),o.shiftKey&&c&&(c/=4),this._type&&(this._lastWheelEvent=o,this._delta-=c,this._active||this._start(o)),o.preventDefault()}_onTimeout(o){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(o)}_start(o){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const c=ce(this._el,o);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:c,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const o=this._map.transform;this._type==="wheel"&&o.projection.wrap&&(o._center.lng>=180||o._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const c=()=>o._terrainEnabled()&&this._aroundCoord?o.computeZoomRelativeTo(this._aroundCoord):o.zoom;if(this._delta!==0){const ee=this._type==="wheel"&&Math.abs(this._delta)>m_?this._wheelZoomRate:this._defaultZoomRate;let te=2/(1+Math.exp(-Math.abs(this._delta*ee)));this._delta<0&&te!==0&&(te=1/te);const ue=c(),fe=Math.pow(2,ue),me=typeof this._targetZoom=="number"?o.zoomScale(this._targetZoom):fe;this._targetZoom=Math.min(o.maxZoom,Math.max(o.minZoom,o.scaleZoom(me*te))),this._type==="wheel"&&(this._startZoom=ue,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const y=typeof this._targetZoom=="number"?this._targetZoom:c(),S=this._startZoom,T=this._easing;let A,$=!1;if(this._type==="wheel"&&S&&T){const ee=Math.min((r.q.now()-this._lastWheelEventTime)/200,1),te=T(ee);A=r.aa(S,y,te),ee<1?this._frameId||(this._frameId=!0):$=!0}else A=y,$=!0;this._active=!0,$&&(this._active=!1,this._finishTimeout=window.setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let Y=A-c();return Y*this._lastDelta<0&&(Y=0),{noInertia:!0,needsRenderFrame:!$,zoomDelta:Y,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(o){let c=r.dr;if(this._prevEase){const y=this._prevEase,S=(r.q.now()-y.start)/y.duration,T=y.easing(S+.01)-y.easing(S),A=.27/Math.sqrt(T*T+1e-4)*.01,$=Math.sqrt(.0729-A*A);c=r.dp(A,$,.25,1)}return this._prevEase={start:r.q.now(),duration:o,easing:c},c}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=W("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")},200)}}class No{constructor(o,c){this._clickZoom=o,this._tapZoom=c}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class sb{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(o,c){return o.preventDefault(),{cameraAnimation:y=>{y.easeTo({duration:300,zoom:y.getZoom()+(o.shiftKey?-1:1),around:y.unproject(c)},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class pT{constructor(){this._tap=new Fp({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(o,c,y){this._swipePoint||(this._tapTime&&o.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?y.length>0&&(this._swipePoint=c[0],this._swipeTouch=y[0].identifier):this._tap.touchstart(o,c,y))}touchmove(o,c,y){if(this._tapTime){if(this._swipePoint){if(y[0].identifier!==this._swipeTouch)return;const S=c[0],T=S.y-this._swipePoint.y;return this._swipePoint=S,o.preventDefault(),this._active=!0,{zoomDelta:T/128}}}else this._tap.touchmove(o,c,y)}touchend(o,c,y){this._tapTime?this._swipePoint&&y.length===0&&this.reset():this._tap.touchend(o,c,y)&&(this._tapTime=o.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class mT{constructor(o,c,y){this._el=o,this._mousePan=c,this._touchPan=y}enable(o){this._inertiaOptions=o||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Vp{constructor(o,c,y){this._pitchWithRotate=o.pitchWithRotate,this._mouseRotate=c,this._mousePitch=y}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class ab{constructor(o,c,y,S){this._el=o,this._touchZoom=c,this._touchRotate=y,this._tapDragZoom=S,this._rotationDisabled=!1,this._enabled=!0}enable(o){this._touchZoom.enable(o),this._rotationDisabled||this._touchRotate.enable(o),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const cf=g=>g.zoom||g.drag||g.pitch||g.rotate;class vg extends r.x{}class Lc{constructor(){this.constants=[1,1,.01],this.radius=0}setup(o,c){const y=r.a6.vec3.sub([],c,o);this.radius=r.a6.vec3.length(y[2]<0?r.a6.vec3.div([],y,this.constants):[y[0],y[1],0])}projectRay(o){r.a6.vec3.div(o,o,this.constants),r.a6.vec3.normalize(o,o),r.a6.vec3.mul(o,o,this.constants);const c=r.a6.vec3.scale([],o,this.radius);if(c[2]>0){const y=r.a6.vec3.scale([],[0,0,1],r.a6.vec3.dot(c,[0,0,1])),S=r.a6.vec3.scale([],r.a6.vec3.normalize([],[c[0],c[1],0]),this.radius),T=r.a6.vec3.add([],c,r.a6.vec3.scale([],r.a6.vec3.sub([],r.a6.vec3.add([],S,y),c),2));c[0]=T[0],c[1]=T[1]}return c}}function ch(g){return g.panDelta&&g.panDelta.mag()||g.zoomDelta||g.bearingDelta||g.pitchDelta}class wa{constructor(o,c){this._map=o,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new xd(o),this._bearingSnap=c.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Lc,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(c),r.aJ(["handleEvent","handleWindowEvent"],this);const y=this._el;this._listeners=[[y,"touchstart",{passive:!0}],[y,"touchmove",{passive:!1}],[y,"touchend",void 0],[y,"touchcancel",void 0],[y,"mousedown",void 0],[y,"mousemove",void 0],[y,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[y,"mouseover",void 0],[y,"mouseout",void 0],[y,"dblclick",void 0],[y,"click",void 0],[y,"keydown",{capture:!1}],[y,"keyup",void 0],[y,"wheel",{passive:!1}],[y,"contextmenu",void 0],[window,"blur",void 0]];for(const[S,T,A]of this._listeners){const $=S===document?this.handleWindowEvent:this.handleEvent;S.addEventListener(T,$,A)}}destroy(){for(const[o,c,y]of this._listeners){const S=o===document?this.handleWindowEvent:this.handleEvent;o.removeEventListener(c,S,y)}}_addDefaultHandlers(o){const c=this._map,y=c.getCanvasContainer();this._add("mapEvent",new u_(c,o));const S=c.boxZoom=new uf(c,o);this._add("boxZoom",S);const T=new h_,A=new sb;c.doubleClickZoom=new No(A,T),this._add("tapZoom",T),this._add("clickZoom",A);const $=new pT;this._add("tapDragZoom",$);const Y=c.touchPitch=new nb(c);this._add("touchPitch",Y);const ee=new mg(o),te=new gg(o);c.dragRotate=new Vp(o,ee,te),this._add("mouseRotate",ee,["mousePitch"]),this._add("mousePitch",te,["mouseRotate"]);const ue=new pg(o),fe=new Q1(c,o);c.dragPan=new mT(y,ue,fe),this._add("mousePan",ue),this._add("touchPan",fe,["touchZoom","touchRotate"]);const me=new tb,ke=new eb;c.touchZoomRotate=new ab(y,ke,me,$),this._add("touchRotate",me,["touchPan","touchZoom"]),this._add("touchZoom",ke,["touchPan","touchRotate"]),this._add("blockableMapEvent",new c_(c));const Le=c.scrollZoom=new fT(c,this);this._add("scrollZoom",Le,["mousePan"]);const De=c.keyboard=new ib;this._add("keyboard",De);for(const Fe of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])o.interactive&&o[Fe]&&c[Fe].enable(o[Fe])}_add(o,c,y){this._handlers.push({handlerName:o,handler:c,allowed:y}),this._handlersById[o]=c}stop(o){if(!this._updatingCamera){for(const{handler:c}of this._handlers)c.reset();this._inertia.clear(),this._fireEvents({},{},o),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:o}of this._handlers)if(o.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!cf(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(o,c,y){for(const S in o)if(S!==y&&(!c||c.indexOf(S)<0))return!0;return!1}handleWindowEvent(o){this.handleEvent(o,`${o.type}Window`)}_getMapTouches(o){const c=[];for(const y of o)this._el.contains(y.target)&&c.push(y);return c}handleEvent(o,c){this._updatingCamera=!0;const y=o.type==="renderFrame",S=y?void 0:o,T={needsRenderFrame:!1},A={},$={},Y=o.touches?this._getMapTouches(o.touches):void 0,ee=Y?oe(this._el,Y):y?void 0:ce(this._el,o);for(const{handlerName:fe,handler:me,allowed:ke}of this._handlers){if(!me.isEnabled())continue;let Le;this._blockedByActive($,ke,fe)?me.reset():me[c||o.type]&&(Le=me[c||o.type](o,ee,Y),this.mergeHandlerResult(T,A,Le,fe,S),Le&&Le.needsRenderFrame&&this._triggerRenderFrame()),(Le||me.isActive())&&($[fe]=me)}const te={};for(const fe in this._previousActiveHandlers)$[fe]||(te[fe]=S);this._previousActiveHandlers=$,(Object.keys(te).length||ch(T))&&(this._changes.push([T,A,te]),this._triggerRenderFrame()),(Object.keys($).length||ch(T))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:ue}=T;ue&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],ue(this._map))}mergeHandlerResult(o,c,y,S,T){if(!y)return;r.l(o,y);const A={handlerName:S,originalEvent:y.originalEvent||T};y.zoomDelta!==void 0&&(c.zoom=A),y.panDelta!==void 0&&(c.drag=A),y.pitchDelta!==void 0&&(c.pitch=A),y.bearingDelta!==void 0&&(c.rotate=A)}_applyChanges(){const o={},c={},y={};for(const[S,T,A]of this._changes)S.panDelta&&(o.panDelta=(o.panDelta||new r.P(0,0))._add(S.panDelta)),S.zoomDelta&&(o.zoomDelta=(o.zoomDelta||0)+S.zoomDelta),S.bearingDelta&&(o.bearingDelta=(o.bearingDelta||0)+S.bearingDelta),S.pitchDelta&&(o.pitchDelta=(o.pitchDelta||0)+S.pitchDelta),S.around!==void 0&&(o.around=S.around),S.aroundCoord!==void 0&&(o.aroundCoord=S.aroundCoord),S.pinchAround!==void 0&&(o.pinchAround=S.pinchAround),S.noInertia&&(o.noInertia=S.noInertia),r.l(c,T),r.l(y,A);this._updateMapTransform(o,c,y),this._changes=[]}_updateMapTransform(o,c,y){const S=this._map,T=S.transform,A=Ye=>[Ye.x,Ye.y,Ye.z];if((Ye=>{const Je=this._eventsInProgress.drag;return Je&&!this._handlersById[Je.handlerName].isActive()})()&&!ch(o)){const Ye=T.zoom;T.cameraElevationReference="sea",this._originalZoom!=null&&T._orthographicProjectionAtLowPitch&&T.projection.name!=="globe"&&T.pitch===0?(T.cameraElevationReference="ground",T.zoom=this._originalZoom):(T.recenterOnTerrain(),T.cameraElevationReference="ground"),Ye!==T.zoom&&this._map._update(!0)}if(T._isCameraConstrained&&S._stop(!0),!ch(o))return void this._fireEvents(c,y,!0);let{panDelta:$,zoomDelta:Y,bearingDelta:ee,pitchDelta:te,around:ue,aroundCoord:fe,pinchAround:me}=o;T._isCameraConstrained&&(Y>0&&(Y=0),T._isCameraConstrained=!1),me!==void 0&&(ue=me),(Y||(Ye=>c[Ye]&&!this._eventsInProgress[Ye])("drag"))&&ue&&(this._dragOrigin=A(T.pointCoordinate3D(ue)),this._originalZoom=T.zoom,this._trackingEllipsoid.setup(T._camera.position,this._dragOrigin)),T.cameraElevationReference="sea",S._stop(!0),ue=ue||S.transform.centerPoint,ee&&(T.bearing+=ee),te&&(T.pitch+=te),T._updateCameraState();const ke=[0,0,0];if($)if(T.projection.name==="mercator"){const Ye=this._trackingEllipsoid.projectRay(T.screenPointToMercatorRay(ue).dir),Je=this._trackingEllipsoid.projectRay(T.screenPointToMercatorRay(ue.sub($)).dir);ke[0]=Je[0]-Ye[0],ke[1]=Je[1]-Ye[1]}else{const Ye=T.pointCoordinate(ue);if(T.projection.name==="globe"){$=$.rotate(-T.angle);const Je=T._pixelsPerMercatorPixel/T.worldSize;ke[0]=-$.x*r.ds(r.aM(Ye.y))*Je,ke[1]=-$.y*r.ds(T.center.lat)*Je}else{const Je=T.pointCoordinate(ue.sub($));Ye&&Je&&(ke[0]=Je.x-Ye.x,ke[1]=Je.y-Ye.y)}}const Le=T.zoom,De=[0,0,0];if(Y){const Ye=A(fe||T.pointCoordinate3D(ue)),Je={dir:r.a6.vec3.normalize([],r.a6.vec3.sub([],Ye,T._camera.position))};if(Je.dir[2]<0){const qe=T.zoomDeltaToMovement(Ye,Y);r.a6.vec3.scale(De,Je.dir,qe)}}const Fe=r.a6.vec3.add(ke,ke,De);T._translateCameraConstrained(Fe),Y&&Math.abs(T.zoom-Le)>1e-4&&T.recenterOnTerrain(),T.cameraElevationReference="ground",this._map._update(),o.noInertia||this._inertia.record(o),this._fireEvents(c,y,!0)}_fireEvents(o,c,y){const S=cf(this._eventsInProgress),T=cf(o),A={};for(const te in o){const{originalEvent:ue}=o[te];this._eventsInProgress[te]||(A[`${te}start`]=ue),this._eventsInProgress[te]=o[te]}!S&&T&&this._fireEvent("movestart",T.originalEvent);for(const te in A)this._fireEvent(te,A[te]);T&&this._fireEvent("move",T.originalEvent);for(const te in o){const{originalEvent:ue}=o[te];this._fireEvent(te,ue)}const $={};let Y;for(const te in this._eventsInProgress){const{handlerName:ue,originalEvent:fe}=this._eventsInProgress[te];this._handlersById[ue].isActive()||(delete this._eventsInProgress[te],Y=c[ue]||fe,$[`${te}end`]=Y)}for(const te in $)this._fireEvent(te,$[te]);const ee=cf(this._eventsInProgress);if(y&&(S||T)&&!ee){this._updatingCamera=!0;const te=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),ue=fe=>fe!==0&&-this._bearingSnap<fe&&fe<this._bearingSnap;te?(ue(te.bearing||this._map.getBearing())&&(te.bearing=0),this._map.easeTo(te,{originalEvent:Y})):(this._map.fire(new r.x("moveend",{originalEvent:Y})),ue(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(o,c){this._map.fire(new r.x(o,c?{originalEvent:c}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(o=>{this._frameId=void 0,this.handleEvent(new vg("renderFrame",{timeStamp:o})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Uu="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class g_ extends r.E{constructor(o,c){super(),this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=c.bearingSnap,this._respectPrefersReducedMotion=c.respectPrefersReducedMotion!==!1,r.aJ(["_renderFrameCallback"],this)}getCenter(){return new r.bK(this.transform.center.lng,this.transform.center.lat)}setCenter(o,c){return this.jumpTo({center:o},c)}panBy(o,c,y){return o=r.P.convert(o).mult(-1),this.panTo(this.transform.center,r.l({offset:o},c),y)}panTo(o,c,y){return this.easeTo(r.l({center:o},c),y)}getZoom(){return this.transform.zoom}setZoom(o,c){return this.jumpTo({zoom:o},c),this}zoomTo(o,c,y){return this.easeTo(r.l({zoom:o},c),y)}zoomIn(o,c){return this.zoomTo(this.getZoom()+1,o,c),this}zoomOut(o,c){return this.zoomTo(this.getZoom()-1,o,c),this}getBearing(){return this.transform.bearing}setBearing(o,c){return this.jumpTo({bearing:o},c),this}getPadding(){return this.transform.padding}setPadding(o,c){return this.jumpTo({padding:o},c),this}rotateTo(o,c,y){return this.easeTo(r.l({bearing:o},c),y)}resetNorth(o,c){return this.rotateTo(0,r.l({duration:1e3},o),c),this}resetNorthPitch(o,c){return this.easeTo(r.l({bearing:0,pitch:0,duration:1e3},o),c),this}snapToNorth(o,c){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,c):this}getPitch(){return this.transform.pitch}setPitch(o,c){return this.jumpTo({pitch:o},c),this}cameraForBounds(o,c){o=r.as.convert(o);const y=c&&c.bearing||0,S=c&&c.pitch||0,T=o.getNorthWest(),A=o.getSouthEast();return this._cameraForBounds(this.transform,T,A,y,S,c)}_extendPadding(o){const c={top:0,right:0,bottom:0,left:0};return o==null?r.l({},c,this.transform.padding):typeof o=="number"?{top:o,bottom:o,right:o,left:o}:r.l({},c,o)}_extendCameraOptions(o){return(o=r.l({offset:[0,0],maxZoom:this.transform.maxZoom},o)).padding=this._extendPadding(o.padding),o}_minimumAABBFrustumDistance(o,c){const y=c.max[0]-c.min[0],S=c.max[1]-c.min[1];return y/S>o.aspect?y/(2*Math.tan(.5*o.fovX)*o.aspect):S/(2*Math.tan(.5*o.fovY)*o.aspect)}_cameraForBoundsOnGlobe(o,c,y,S,T,A){const $=o.clone(),Y=this._extendCameraOptions(A);$.bearing=S,$.pitch=T;const ee=r.bK.convert(c),te=r.bK.convert(y),ue=.5*(ee.lat+te.lat),fe=.5*(ee.lng+te.lng),me=r.dt(ue,fe),ke=r.a6.vec3.normalize([],me),Le=r.a6.vec3.normalize([],r.a6.vec3.cross([],ke,[0,1,0])),De=r.a6.vec3.cross([],Le,ke),Fe=[Le[0],Le[1],Le[2],0,De[0],De[1],De[2],0,ke[0],ke[1],ke[2],0,0,0,0,1],Ye=[me,r.dt(ee.lat,ee.lng),r.dt(te.lat,ee.lng),r.dt(te.lat,te.lng),r.dt(ee.lat,te.lng),r.dt(ue,ee.lng),r.dt(ue,te.lng),r.dt(ee.lat,fe),r.dt(te.lat,fe)];let Je=r.c9.fromPoints(Ye.map(cn=>[r.a6.vec3.dot(Le,cn),r.a6.vec3.dot(De,cn),r.a6.vec3.dot(ke,cn)]));const qe=r.a6.vec3.transformMat4([],Je.center,Fe);r.a6.vec3.squaredLength(qe)===0&&r.a6.vec3.set(qe,0,0,1),r.a6.vec3.normalize(qe,qe),r.a6.vec3.scale(qe,qe,r.aq),$.center=r.du(qe);const it=$.getWorldToCameraMatrix(),rt=r.a6.mat4.invert(new Float64Array(16),it);Je=r.c9.applyTransform(Je,r.a6.mat4.multiply([],it,Fe));const mt=this._extendAABB(Je,$,Y,S);if(!mt)return void r.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Je=mt,r.a6.vec3.transformMat4(qe,qe,it);const dt=.5*(Je.max[2]-Je.min[2]),yt=this._minimumAABBFrustumDistance($,Je),Et=r.a6.vec3.scale([],[0,0,1],dt),bt=r.a6.vec3.add(Et,qe,Et),vt=yt+($.pitch===0?0:r.a6.vec3.distance(qe,bt)),Ot=$.globeCenterInViewSpace,sn=r.a6.vec3.sub([],qe,[Ot[0],Ot[1],Ot[2]]);r.a6.vec3.normalize(sn,sn),r.a6.vec3.scale(sn,sn,vt);const mn=r.a6.vec3.add([],qe,sn);r.a6.vec3.transformMat4(mn,mn,rt);const on=r.dw/r.aq,Tn=r.a6.vec3.length(mn),Dt=r.bD(Math.max(Tn*on-r.dw,Number.EPSILON),0),dn=Math.min($.zoomFromMercatorZAdjusted(Dt),Y.maxZoom);return dn>.5*(r.c2+r.bU)?($.setProjection({name:"mercator"}),$.zoom=dn,this._cameraForBounds($,c,y,S,T,A)):{center:$.center,zoom:dn,bearing:S,pitch:T}}_extendAABB(o,c,y,S){const T=.5*((y.padding.left||0)+(y.padding.right||0)),A=.5*((y.padding.top||0)+(y.padding.bottom||0)),$=A,Y=T,ee=T,te=A,ue=c.width-(Y+ee),fe=c.height-($+te),me=r.a6.vec3.sub([],o.max,o.min),ke=Math.min(ue/me[0],fe/me[1]),Le=Math.min(c.scaleZoom(c.scale*ke),y.maxZoom);if(isNaN(Le))return null;const De=c.scale/c.zoomScale(Le),Fe=new r.c9([o.min[0]-Y*De,o.min[1]-te*De,o.min[2]],[o.max[0]+ee*De,o.max[1]+$*De,o.max[2]]),Ye=(typeof y.offset.x=="number"&&typeof y.offset.y=="number"?new r.P(y.offset.x,y.offset.y):r.P.convert(y.offset)).rotate(-r.bB(S));return Fe.center[0]-=Ye.x*De,Fe.center[1]+=Ye.y*De,Fe}queryTerrainElevation(o,c){const y=this.transform.elevation;return y?(c=r.l({},{exaggerated:!0},c),y.getAtPoint(r.a5.fromLngLat(o),null,c.exaggerated)):null}_cameraForBounds(o,c,y,S,T,A){if(o.projection.name==="globe")return this._cameraForBoundsOnGlobe(o,c,y,S,T,A);const $=o.clone(),Y=this._extendCameraOptions(A);$.bearing=S,$.pitch=T;const ee=r.bK.convert(c),te=r.bK.convert(y),ue=new r.bK(ee.lng,te.lat),fe=new r.bK(te.lng,ee.lat),me=$.project(ee),ke=$.project(te),Le=this.queryTerrainElevation(ee),De=this.queryTerrainElevation(te),Fe=this.queryTerrainElevation(ue),Ye=this.queryTerrainElevation(fe),Je=[[me.x,me.y,Math.min(Le||0,De||0,Fe||0,Ye||0)],[ke.x,ke.y,Math.max(Le||0,De||0,Fe||0,Ye||0)]];let qe=r.c9.fromPoints(Je);const it=$.getWorldToCameraMatrix(),rt=r.a6.mat4.invert(new Float64Array(16),it);qe=r.c9.applyTransform(qe,it);const mt=this._extendAABB(qe,$,Y,S);if(!mt)return void r.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");qe=mt;const dt=.5*r.a6.vec3.sub([],qe.max,qe.min)[2],yt=this._minimumAABBFrustumDistance($,qe),Et=[0,0,1,0];r.a6.vec4.transformMat4(Et,Et,it),r.a6.vec4.normalize(Et,Et);const bt=r.a6.vec3.scale([],Et,yt+dt),vt=r.a6.vec3.add([],qe.center,bt);r.a6.vec3.transformMat4(qe.center,qe.center,rt),r.a6.vec3.transformMat4(vt,vt,rt);const Ot=$.unproject(new r.P(qe.center[0],qe.center[1])),sn=r.dv($.projection,Ot),mn=Math.pow(2,sn),on=Math.min($._zoomFromMercatorZ(vt[2]*$.pixelsPerMeter*mn/$.worldSize),Y.maxZoom);return $.mercatorFromTransition&&on<.5*(r.c2+r.bU)?($.setProjection({name:"globe"}),$.zoom=on,this._cameraForBounds($,c,y,S,T,A)):{center:Ot,zoom:on,bearing:S,pitch:T}}fitBounds(o,c,y){const S=this.cameraForBounds(o,c);return this._fitInternal(S,c,y)}fitScreenCoordinates(o,c,y,S,T){const A=r.P.convert(o),$=r.P.convert(c),Y=new r.P(Math.min(A.x,$.x),Math.min(A.y,$.y)),ee=new r.P(Math.max(A.x,$.x),Math.max(A.y,$.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(A,$))return this;const te=this.transform.pointLocation3D(Y),ue=this.transform.pointLocation3D(ee),fe=this.transform.pointLocation3D(new r.P(Y.x,ee.y)),me=this.transform.pointLocation3D(new r.P(ee.x,Y.y)),ke=[Math.min(te.lng,ue.lng,fe.lng,me.lng),Math.min(te.lat,ue.lat,fe.lat,me.lat)],Le=[Math.max(te.lng,ue.lng,fe.lng,me.lng),Math.max(te.lat,ue.lat,fe.lat,me.lat)],De=S&&S.pitch?S.pitch:this.getPitch(),Fe=this._cameraForBounds(this.transform,ke,Le,y,De,S);return this._fitInternal(Fe,S,T)}_fitInternal(o,c,y){return o?(c=r.l(o,c)).linear?this.easeTo(c,y):this.flyTo(c,y):this}jumpTo(o,c){this.stop();const y=o.preloadOnly?this.transform.clone():this.transform;let S=!1,T=!1,A=!1;"zoom"in o&&y.zoom!==+o.zoom&&(S=!0,y.zoom=+o.zoom),o.center!==void 0&&(y.center=r.bK.convert(o.center)),"bearing"in o&&y.bearing!==+o.bearing&&(T=!0,y.bearing=+o.bearing),"pitch"in o&&y.pitch!==+o.pitch&&(A=!0,y.pitch=+o.pitch);const $=typeof o.padding=="number"?this._extendPadding(o.padding):o.padding;if(o.padding!=null&&!y.isPaddingEqual($))if(o.retainPadding===!1){const Y=y.clone();Y.padding=$,y.setLocationAtPoint(y.center,Y.centerPoint)}else y.padding=$;return o.preloadOnly?(this._preloadTiles(y),this):(this.fire(new r.x("movestart",c)).fire(new r.x("move",c)),S&&this.fire(new r.x("zoomstart",c)).fire(new r.x("zoom",c)).fire(new r.x("zoomend",c)),T&&this.fire(new r.x("rotatestart",c)).fire(new r.x("rotate",c)).fire(new r.x("rotateend",c)),A&&this.fire(new r.x("pitchstart",c)).fire(new r.x("pitch",c)).fire(new r.x("pitchend",c)),this.fire(new r.x("moveend",c)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||r.w(Uu),this.transform.getFreeCameraOptions()}setFreeCameraOptions(o,c){const y=this.transform;if(!y.projection.supportsFreeCamera)return r.w(Uu),this;this.stop();const S=y.zoom,T=y.pitch,A=y.bearing;y.setFreeCameraOptions(o);const $=S!==y.zoom,Y=T!==y.pitch,ee=A!==y.bearing;return this.fire(new r.x("movestart",c)).fire(new r.x("move",c)),$&&this.fire(new r.x("zoomstart",c)).fire(new r.x("zoom",c)).fire(new r.x("zoomend",c)),ee&&this.fire(new r.x("rotatestart",c)).fire(new r.x("rotate",c)).fire(new r.x("rotateend",c)),Y&&this.fire(new r.x("pitchstart",c)).fire(new r.x("pitch",c)).fire(new r.x("pitchend",c)),this.fire(new r.x("moveend",c)),this}easeTo(o,c){this._stop(!1,o.easeId),((o=r.l({offset:[0,0],duration:500,easing:r.dr},o)).animate===!1||this._prefersReducedMotion(o))&&(o.duration=0);const y=this.transform,S=this.getZoom(),T=this.getBearing(),A=this.getPitch(),$=this.getPadding(),Y="zoom"in o?+o.zoom:S,ee="bearing"in o?this._normalizeBearing(o.bearing,T):T,te="pitch"in o?+o.pitch:A,ue=this._extendPadding(o.padding),fe=r.P.convert(o.offset);let me,ke,Le;if(y.projection.name==="globe"){const Et=r.a5.fromLngLat(y.center),bt=fe.rotate(-y.angle);Et.x+=bt.x/y.worldSize,Et.y+=bt.y/y.worldSize;const vt=Et.toLngLat(),Ot=r.bK.convert(o.center||vt);this._normalizeCenter(Ot),me=y.centerPoint.add(bt),ke=new r.P(Et.x,Et.y).mult(y.worldSize),Le=new r.P(r.am(Ot.lng),r.at(Ot.lat)).mult(y.worldSize).sub(ke)}else{me=y.centerPoint.add(fe);const Et=y.pointLocation(me),bt=r.bK.convert(o.center||Et);this._normalizeCenter(bt),ke=y.project(Et),Le=y.project(bt).sub(ke)}const De=y.zoomScale(Y-S);let Fe,Ye;o.around&&(Fe=r.bK.convert(o.around),Ye=y.locationPoint(Fe));const Je=this._zooming||Y!==S,qe=this._rotating||T!==ee,it=this._pitching||te!==A,rt=!y.isPaddingEqual(ue),mt=o.retainPadding===!1?y.clone():y,dt=Et=>bt=>{if(Je&&(Et.zoom=r.aa(S,Y,bt)),qe&&(Et.bearing=r.aa(T,ee,bt)),it&&(Et.pitch=r.aa(A,te,bt)),rt&&(mt.interpolatePadding($,ue,bt),me=mt.centerPoint.add(fe)),Fe)Et.setLocationAtPoint(Fe,Ye);else{const vt=Et.zoomScale(Et.zoom-S),Ot=Y>S?Math.min(2,De):Math.max(.5,De),sn=Math.pow(Ot,1-bt),mn=Et.unproject(ke.add(Le.mult(bt*sn)).mult(vt));Et.setLocationAtPoint(Et.renderWorldCopies?mn.wrap():mn,me)}return o.preloadOnly||this._fireMoveEvents(c),Et};if(o.preloadOnly){const Et=this._emulate(dt,o.duration,y);return this._preloadTiles(Et),this}const yt={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Je,this._rotating=qe,this._pitching=it,this._padding=rt,this._easeId=o.easeId,this._prepareEase(c,o.noMoveStart,yt),this._ease(dt(y),Et=>{y.cameraElevationReference==="sea"&&y.recenterOnTerrain(),this._afterEase(c,Et)},o),this}_prepareEase(o,c,y={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),c||y.moving||this.fire(new r.x("movestart",o)),this._zooming&&!y.zooming&&this.fire(new r.x("zoomstart",o)),this._rotating&&!y.rotating&&this.fire(new r.x("rotatestart",o)),this._pitching&&!y.pitching&&this.fire(new r.x("pitchstart",o))}_fireMoveEvents(o){this.fire(new r.x("move",o)),this._zooming&&this.fire(new r.x("zoom",o)),this._rotating&&this.fire(new r.x("rotate",o)),this._pitching&&this.fire(new r.x("pitch",o))}_afterEase(o,c){if(this._easeId&&c&&this._easeId===c)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const y=this._zooming,S=this._rotating,T=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,y&&this.fire(new r.x("zoomend",o)),S&&this.fire(new r.x("rotateend",o)),T&&this.fire(new r.x("pitchend",o)),this.fire(new r.x("moveend",o))}flyTo(o,c){if(this._prefersReducedMotion(o)){const cn=r.ar(o,["center","zoom","bearing","pitch","around","padding","retainPadding"]);return this.jumpTo(cn,c)}this.stop(),o=r.l({offset:[0,0],speed:1.2,curve:1.42,easing:r.dr},o);const y=this.transform,S=this.getZoom(),T=this.getBearing(),A=this.getPitch(),$=this.getPadding(),Y="zoom"in o?r.ap(+o.zoom,y.minZoom,y.maxZoom):S,ee="bearing"in o?this._normalizeBearing(o.bearing,T):T,te="pitch"in o?+o.pitch:A,ue=this._extendPadding(o.padding),fe=y.zoomScale(Y-S),me=r.P.convert(o.offset);let ke=y.centerPoint.add(me);const Le=y.pointLocation(ke),De=r.bK.convert(o.center||Le);this._normalizeCenter(De);const Fe=y.project(Le),Ye=y.project(De).sub(Fe);let Je=o.curve;const qe=Math.max(y.width,y.height),it=qe/fe,rt=Ye.mag();if("minZoom"in o){const cn=r.ap(Math.min(o.minZoom,S,Y),y.minZoom,y.maxZoom),In=qe/y.zoomScale(cn-S);Je=Math.sqrt(In/rt*2)}const mt=Je*Je;function dt(cn){const In=(it*it-qe*qe+(cn?-1:1)*mt*mt*rt*rt)/(2*(cn?it:qe)*mt*rt);return Math.log(Math.sqrt(In*In+1)-In)}function yt(cn){return(Math.exp(cn)-Math.exp(-cn))/2}function Et(cn){return(Math.exp(cn)+Math.exp(-cn))/2}const bt=dt(0);let vt=function(cn){return Et(bt)/Et(bt+Je*cn)},Ot=function(cn){return qe*((Et(bt)*(yt(In=bt+Je*cn)/Et(In))-yt(bt))/mt)/rt;var In},sn=(dt(1)-bt)/Je;if(Math.abs(rt)<1e-6||!isFinite(sn)){if(Math.abs(qe-it)<1e-6)return this.easeTo(o,c);const cn=it<qe?-1:1;sn=Math.abs(Math.log(it/qe))/Je,Ot=function(){return 0},vt=function(In){return Math.exp(cn*Je*In)}}o.duration="duration"in o?+o.duration:1e3*sn/("screenSpeed"in o?+o.screenSpeed/Je:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0);const mn=T!==ee,on=te!==A,Tn=!y.isPaddingEqual(ue),Dt=o.retainPadding===!1?y.clone():y,dn=cn=>In=>{const An=In*sn,pn=1/vt(An);cn.zoom=In===1?Y:S+cn.scaleZoom(pn),mn&&(cn.bearing=r.aa(T,ee,In)),on&&(cn.pitch=r.aa(A,te,In)),Tn&&(Dt.interpolatePadding($,ue,In),ke=Dt.centerPoint.add(me));const _n=In===1?De:cn.unproject(Fe.add(Ye.mult(Ot(An))).mult(pn));return cn.setLocationAtPoint(cn.renderWorldCopies?_n.wrap():_n,ke),cn._updateCameraOnTerrain(),o.preloadOnly||this._fireMoveEvents(c),cn};if(o.preloadOnly){const cn=this._emulate(dn,o.duration,y);return this._preloadTiles(cn),this}return this._zooming=!0,this._rotating=mn,this._pitching=on,this._padding=Tn,this._prepareEase(c,!1),this._ease(dn(y),()=>this._afterEase(c),o),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(o){}_cancelRenderFrame(o){}_stop(o,c){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const y=this._onEaseEnd;this._onEaseEnd=void 0,y.call(this,c)}if(!o){const y=this.handlers;y&&y.stop(!1)}return this}_ease(o,c,y){y.animate===!1||y.duration===0?(o(1),c()):(this._easeStart=r.q.now(),this._easeOptions=y,this._onEaseFrame=o,this._onEaseEnd=c,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const o=Math.min((r.q.now()-this._easeStart)/this._easeOptions.duration,1),c=this._onEaseFrame;c&&c(this._easeOptions.easing(o)),o<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(o,c){o=r.bA(o,-180,180);const y=Math.abs(o-c);return Math.abs(o-360-c)<y&&(o-=360),Math.abs(o+360-c)<y&&(o+=360),o}_normalizeCenter(o){const c=this.transform;if(c.maxBounds||c.projection.name!=="globe"&&!c.renderWorldCopies)return;const y=o.lng-c.center.lng;o.lng+=y>180?-360:y<-180?360:0}_prefersReducedMotion(o){return this._respectPrefersReducedMotion&&r.q.prefersReducedMotion&&!(o&&o.essential)}_emulate(o,c,y){const S=Math.ceil(15*c/1e3),T=[],A=o(y.clone());for(let $=0;$<=S;$++){const Y=A($/S);T.push(Y.clone())}return T}_preloadTiles(o,c){}}class xg{constructor(o={}){this.options=o,r.aJ(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(o){const c=this.options&&this.options.compact,y=o._getUIString("AttributionControl.ToggleAttribution");this._map=o,this._container=W("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=W("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.setAttribute("aria-label",y);const S=W("span","mapboxgl-ctrl-icon",this._compactButton);return S.setAttribute("aria-hidden","true"),S.setAttribute("title",y),this._innerContainer=W("div","mapboxgl-ctrl-attrib-inner",this._container),c&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),c===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let o=this._editLink;o||(o=this._editLink=this._container.querySelector(".mapbox-improve-map"));const c=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||r.e.ACCESS_TOKEN}];if(o){const y=c.reduce((S,T,A)=>(T.value&&(S+=`${T.key}=${T.value}${A<c.length-1?"&":""}`),S),"?");o.href=`${r.e.FEEDBACK_URL}/${y}#${Pc(this._map,!0)}`,o.rel="noopener nofollow"}}_updateData(o){!o||o.sourceDataType!=="metadata"&&o.sourceDataType!=="visibility"&&o.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let o=[];if(this._map.style.stylesheet){const S=this._map.style.stylesheet;this.styleOwner=S.owner,this.styleId=S.id}const c=this._map.style._mergedSourceCaches;for(const S in c){const T=c[S];if(T.used){const A=T.getSource();A.attribution&&o.indexOf(A.attribution)<0&&o.push(A.attribution)}}o.sort((S,T)=>S.length-T.length),o=o.filter((S,T)=>{for(let A=T+1;A<o.length;A++)if(o[A].indexOf(S)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?o=[...this.options.customAttribution,...o]:o.unshift(this.options.customAttribution));const y=o.join(" | ");y!==this._attribHTML&&(this._attribHTML=y,o.length?(this._innerContainer.innerHTML=y,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class y_{constructor(){r.aJ(["_updateLogo","_updateCompact"],this)}onAdd(o){this._map=o,this._container=W("div","mapboxgl-ctrl");const c=W("a","mapboxgl-ctrl-logo");return c.target="_blank",c.rel="noopener nofollow",c.href="https://www.mapbox.com/",c.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),c.setAttribute("rel","noopener nofollow"),this._container.appendChild(c),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(o){o&&o.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const o=this._map.style._sourceCaches;if(Object.entries(o).length===0)return!0;for(const c in o){const y=o[c].getSource();if(y.hasOwnProperty("mapbox_logo")&&!y.mapbox_logo)return!1}return!0}_updateCompact(){const o=this._container.children;if(o.length){const c=o[0];this._map.getCanvasContainer().offsetWidth<250?c.classList.add("mapboxgl-compact"):c.classList.remove("mapboxgl-compact")}}}class lb{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(o){const c=++this._id;return this._queue.push({callback:o,id:c,cancelled:!1}),c}remove(o){const c=this._currentlyRunning,y=c?this._queue.concat(c):this._queue;for(const S of y)if(S.id===o)return void(S.cancelled=!0)}run(o=0){const c=this._currentlyRunning=this._queue;this._queue=[];for(const y of c)if(!y.cancelled&&(y.callback(o),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}class $p{constructor(o){this.jumpTo(o)}getValue(o){if(o<=this._startTime)return this._start;if(o>=this._endTime)return this._end;const c=r.cw((o-this._startTime)/(this._endTime-this._startTime));return this._start*(1-c)+this._end*c}isEasing(o){return o>=this._startTime&&o<=this._endTime}jumpTo(o){this._startTime=-1/0,this._endTime=-1/0,this._start=o,this._end=o}easeTo(o,c,y){this._start=this.getValue(c),this._end=o,this._startTime=c,this._endTime=c+y}}const gT={"AttributionControl.ToggleAttribution":"Toggle attribution","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox homepage","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use ⌘ + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"};class yT{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}class __{constructor(o){this.map=o,this.interactionsByType=new Map,this.typeById=new Map,this.filters=new Map,this.handleType=this.handleType.bind(this)}add(o,c){if(this.typeById.has(o))throw new Error(`Interaction id "${o}" already exists.`);const{type:y,filter:S}=c;if(S){const A=r.M(S,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(A.result==="error")throw new Error(A.value.map($=>`${$.key}: ${$.message}`).join(", "));this.filters.set(o,A.value)}const T=this.interactionsByType.get(y)||new Map;T.size===0&&(this.map.on(y,this.handleType),this.interactionsByType.set(y,T)),T.set(o,c),this.typeById.set(o,y)}remove(o){const c=this.typeById.get(o);if(!c)return;this.typeById.delete(o),this.filters.delete(o);const y=this.interactionsByType.get(c);y&&(y.delete(o),y.size===0&&this.map.off(c,this.handleType))}handleType(o){const c=o.features||this.map.queryRenderedFeatures(o.point);if(!c)return;const y=this.interactionsByType.get(o.type),S={zoom:0};for(const[T,A]of y){const $=this.filters.get(T),{handler:Y,layers:ee}=A;for(const te of c)if((!ee||ee.includes(te.layer.id))&&(!$||$.evaluate(S,te))&&Y({id:T,feature:te,interaction:A})!==!1)break}}}const v_={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1,precompilePrograms:!0},Up={showCompass:!0,showZoom:!0,visualizePitch:!1};class df{constructor(o,c,y=!1){this._clickTolerance=10,this.element=c,this.mouseRotate=new mg({clickTolerance:o.dragRotate._mouseRotate._clickTolerance}),this.map=o,y&&(this.mousePitch=new gg({clickTolerance:o.dragRotate._mousePitch._clickTolerance})),r.aJ(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),c.addEventListener("mousedown",this.mousedown),c.addEventListener("touchstart",this.touchstart,{passive:!1}),c.addEventListener("touchmove",this.touchmove),c.addEventListener("touchend",this.touchend),c.addEventListener("touchcancel",this.reset)}down(o,c){this.mouseRotate.mousedown(o,c),this.mousePitch&&this.mousePitch.mousedown(o,c),le()}move(o,c){const y=this.map,S=this.mouseRotate.mousemoveWindow(o,c),T=S&&S.bearingDelta;if(T&&y.setBearing(y.getBearing()+T),this.mousePitch){const A=this.mousePitch.mousemoveWindow(o,c),$=A&&A.pitchDelta;$&&y.setPitch(y.getPitch()+$)}}off(){const o=this.element;o.removeEventListener("mousedown",this.mousedown),o.removeEventListener("touchstart",this.touchstart,{passive:!1}),o.removeEventListener("touchmove",this.touchmove),o.removeEventListener("touchend",this.touchend),o.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){_e(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(o){this.down(r.l({},o,{ctrlKey:!0,preventDefault:()=>o.preventDefault()}),ce(this.element,o)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(o){this.move(o,ce(this.element,o))}mouseup(o){this.mouseRotate.mouseupWindow(o),this.mousePitch&&this.mousePitch.mouseupWindow(o),this.offTemp()}touchstart(o){o.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=oe(this.element,o.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>o.preventDefault()},this._startPos))}touchmove(o){o.targetTouches.length!==1?this.reset():(this._lastPos=oe(this.element,o.targetTouches)[0],this.move({preventDefault:()=>o.preventDefault()},this._lastPos))}touchend(o){o.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function Gu(g,o,c){if(g=new r.bK(g.lng,g.lat),o){const y=new r.bK(g.lng-360,g.lat),S=new r.bK(g.lng+360,g.lat),T=360*Math.ceil(Math.abs(g.lng-c.center.lng)/360),A=c.locationPoint(g).distSqr(o),$=o.x<0||o.y<0||o.x>c.width||o.y>c.height;c.locationPoint(y).distSqr(o)<A&&($||Math.abs(y.lng-c.center.lng)<T)?g=y:c.locationPoint(S).distSqr(o)<A&&($||Math.abs(S.lng-c.center.lng)<T)&&(g=S)}for(;Math.abs(g.lng-c.center.lng)>180;){const y=c.locationPoint(g);if(y.x>=0&&y.y>=0&&y.x<=c.width&&y.y<=c.height)break;g.lng>c.center.lng?g.lng-=360:g.lng+=360}return g}const El={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Hu extends r.E{constructor(o,c){if(super(),(o instanceof HTMLElement||c)&&(o=r.l({element:o},c)),r.aJ(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&o.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=o&&o.occludedOpacity||.2,o&&o.element)this._element=o.element,this._offset=r.P.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=W("div");const T=41,A=27,$=H("svg",{display:"block",height:T*this._scale+"px",width:A*this._scale+"px",viewBox:`0 0 ${A} ${T}`},this._element),Y=H("radialGradient",{id:"shadowGradient"},H("defs",{},$));H("stop",{offset:"10%","stop-opacity":.4},Y),H("stop",{offset:"100%","stop-opacity":.05},Y),H("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},$),H("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},$),H("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},$),H("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},$),this._offset=r.P.convert(o&&o.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",T=>{T.preventDefault()}),this._element.addEventListener("mousedown",T=>{T.preventDefault()});const y=this._element.classList;for(const T in El)y.remove(`mapboxgl-marker-anchor-${T}`);y.add(`mapboxgl-marker-anchor-${this._anchor}`);const S=o&&o.className?o.className.trim().split(/\s+/):[];y.add(...S),this._popup=null}addTo(o){return o===this._map||(this.remove(),this._map=o,o.getCanvasContainer().appendChild(this._element),o.on("move",this._updateMoving),o.on("moveend",this._update),o.on("remove",this._clearFadeTimer),o._addMarker(this),this.setDraggable(this._draggable),this._update(),o.on("click",this._onMapClick)),this}remove(){const o=this._map;return o&&(o.off("click",this._onMapClick),o.off("move",this._updateMoving),o.off("moveend",this._update),o.off("mousedown",this._addDragHandler),o.off("touchstart",this._addDragHandler),o.off("mouseup",this._onUp),o.off("touchend",this._onUp),o.off("mousemove",this._onMove),o.off("touchmove",this._onMove),o.off("remove",this._clearFadeTimer),o._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(o){return this._lngLat=r.bK.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){const S=Math.sqrt(Math.pow(13.5,2)/2);o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[S,-1*(38.1-13.5+S)],"bottom-right":[-S,-1*(38.1-13.5+S)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=o,o._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(o){const c=o.code,y=o.charCode||o.keyCode;c!=="Space"&&c!=="Enter"&&y!==32&&y!==13||this.togglePopup()}_onMapClick(o){const c=o.originalEvent.target,y=this._element;this._popup&&(c===y||y.contains(c))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const o=this._popup;return o?(o.isOpen()?(o.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(o.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const o=this._map,c=this._pos;if(!o||!c)return!1;const y=o.unproject(c),S=o.getFreeCameraOptions();if(!S.position)return!1;const T=S.position.toLngLat();return T.distanceTo(y)<.9*T.distanceTo(this._lngLat)}_evaluateOpacity(){const o=this._map;if(!o)return;const c=this._pos;if(!c||c.x<0||c.x>o.transform.width||c.y<0||c.y>o.transform.height)return void this._clearFadeTimer();const y=o.unproject(c);let S;o._showingGlobe()&&r.dz(o.transform,this._lngLat)?S=0:(S=1-o._queryFogOpacity(y),o.transform._terrainEnabled()&&o.getTerrain()&&this._behindTerrain()&&(S*=this._occludedOpacity)),this._element.style.opacity=`${S}`,this._element.style.pointerEvents=S>0?"auto":"none",this._popup&&this._popup._setOpacity(S),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const o=this._pos;if(!o||!this._map)return;const c=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${o.x}px,${o.y}px)
            ${El[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${c.x}px,${c.y}px)
        `}_calculateXYTransform(){const o=this._pos,c=this._map,y=this.getPitchAlignment();if(!c||!o||y!=="map")return"";if(!c._showingGlobe()){const Y=c.getPitch();return Y?`rotateX(${Y}deg)`:""}const S=r.c0(r.dA(c.transform,this._lngLat)),T=o.sub(r.dB(c.transform)),A=Math.abs(T.x)+Math.abs(T.y);if(A===0)return"";const $=S/A;return`rotateX(${-T.y*$}deg) rotateY(${T.x*$}deg)`}_calculateZTransform(){const o=this._pos,c=this._map;if(!c||!o)return"";let y=0;const S=this.getRotationAlignment();if(S==="map")if(c._showingGlobe()){const T=c.project(new r.bK(this._lngLat.lng,this._lngLat.lat+.001)),A=c.project(new r.bK(this._lngLat.lng,this._lngLat.lat-.001)).sub(T);y=r.c0(Math.atan2(A.y,A.x))-90}else y=-c.getBearing();else if(S==="horizon"){const T=r.a7(4,6,c.getZoom()),A=r.dB(c.transform);A.y+=T*c.transform.height;const $=o.sub(A),Y=r.c0(Math.atan2($.y,$.x));y=(Y>90?Y-270:Y+90)*(1-T)}return y+=this._rotation,y?`rotateZ(${y}deg)`:""}_update(o){cancelAnimationFrame(this._updateFrameId);const c=this._map;c&&(c.transform.renderWorldCopies&&(this._lngLat=Gu(this._lngLat,this._pos,c.transform)),this._pos=c.project(this._lngLat),o===!0?this._updateFrameId=requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),c._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(c._showingGlobe()||c.getTerrain()||c.getFog())&&!this._fadeTimer&&(this._fadeTimer=window.setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(o){return this._offset=r.P.convert(o),this._update(),this}addClassName(o){return this._element.classList.add(o),this}removeClassName(o){return this._element.classList.remove(o),this}toggleClassName(o){return this._element.classList.toggle(o)}_onMove(o){const c=this._map;if(!c)return;const y=this._pointerdownPos,S=this._positionDelta;if(y&&S){if(!this._isDragging){const T=this._clickTolerance||c._clickTolerance;if(o.point.dist(y)<T)return;this._isDragging=!0}this._pos=o.point.sub(S),this._lngLat=c.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new r.x("dragstart"))),this.fire(new r.x("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const o=this._map;o&&(o.off("mousemove",this._onMove),o.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new r.x("dragend")),this._state="inactive"}_addDragHandler(o){const c=this._map,y=this._pos;c&&y&&this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(y),this._pointerdownPos=o.point,this._state="pending",c.on("mousemove",this._onMove),c.on("touchmove",this._onMove),c.once("mouseup",this._onUp),c.once("touchend",this._onUp))}setDraggable(o){this._draggable=!!o;const c=this._map;return c&&(o?(c.on("mousedown",this._addDragHandler),c.on("touchstart",this._addDragHandler)):(c.off("mousedown",this._addDragHandler),c.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(o){return this._rotation=o||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(o){return this._rotationAlignment=o||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(o){return this._pitchAlignment=o||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(o){return this._occludedOpacity=o||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const dh={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},bd={maxWidth:100,unit:"metric"},_T={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},vT={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},xT=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function ub(g=new r.P(0,0),o="bottom"){if(typeof g=="number"){const c=Math.round(Math.sqrt(.5*Math.pow(g,2)));switch(o){case"top":return new r.P(0,g);case"top-left":return new r.P(c,c);case"top-right":return new r.P(-c,c);case"bottom":return new r.P(0,-g);case"bottom-left":return new r.P(c,-c);case"bottom-right":return new r.P(-c,-c);case"left":return new r.P(g,0);case"right":return new r.P(-g,0)}return new r.P(0,0)}return g instanceof r.P||Array.isArray(g)?r.P.convert(g):r.P.convert(g[o]||[0,0])}return{version:C,supported:j.supported,setRTLTextPlugin:r.dC,getRTLTextPluginStatus:r.dD,Map:class extends g_{constructor(g){I.mark(k.create);const o=g;if((g=r.l({},v_,g)).minZoom!=null&&g.maxZoom!=null&&g.minZoom>g.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(g.minPitch!=null&&g.maxPitch!=null&&g.minPitch>g.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(g.minPitch!=null&&g.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(g.maxPitch!=null&&g.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(g.antialias&&r.dx(window)&&(g.antialias=!1,r.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new hd(g.minZoom,g.maxZoom,g.minPitch,g.maxPitch,g.renderWorldCopies),g),this._repaint=!!g.repaint,this._interactive=g.interactive,this._minTileCacheSize=g.minTileCacheSize,this._maxTileCacheSize=g.maxTileCacheSize,this._failIfMajorPerformanceCaveat=g.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=g.preserveDrawingBuffer,this._antialias=g.antialias,this._trackResize=g.trackResize,this._bearingSnap=g.bearingSnap,this._refreshExpiredTiles=g.refreshExpiredTiles,this._fadeDuration=g.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=g.crossSourceCollisions,this._collectResourceTiming=g.collectResourceTiming,this._language=this._parseLanguage(g.language),this._worldview=g.worldview,this._renderTaskQueue=new lb,this._domRenderTaskQueue=new lb,this._controls=[],this._markers=[],this._popups=[],this._mapId=r.aP(),this._locale=r.l({},gT,g.locale),this._clickTolerance=g.clickTolerance,this._cooperativeGestures=g.cooperativeGestures,this._performanceMetricsCollection=g.performanceMetricsCollection,this._tessellationStep=g.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._precompilePrograms=g.precompilePrograms,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new $p(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._requestManager=new we(g.transformRequest,g.accessToken,g.testMode),this._silenceAuthErrors=!!g.testMode,this._contextCreateOptions=g.contextCreateOptions?{...g.contextCreateOptions}:{},typeof g.container=="string"){const c=document.getElementById(g.container);if(!c)throw new Error(`Container '${g.container.toString()}' not found.`);this._container=c}else{if(!(g.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=g.container}if(this._container.childNodes.length>0&&r.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),g.maxBounds&&this.setMaxBounds(g.maxBounds),r.aJ(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new yT),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},()=>{this._update()}),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new wa(this,g),this._localFontFamily=g.localFontFamily,this._localIdeographFontFamily=g.localIdeographFontFamily,(g.style||!g.testMode)&&this.setStyle(g.style||r.e.DEFAULT_STYLE,{config:g.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),g.projection&&this.setProjection(g.projection),g.hash&&(this._hash=new vd(typeof g.hash=="string"&&g.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){o.center==null&&o.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:g.center,zoom:g.zoom,bearing:g.bearing,pitch:g.pitch});const c=g.bounds;c&&(this.resize(),this.fitBounds(c,r.l({},g.fitBoundsOptions,{duration:0})))}this.resize(),g.attributionControl&&this.addControl(new xg({customAttribution:g.customAttribution})),this._logoControl=new y_,this.addControl(this._logoControl,g.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent()}),this.on("data",c=>{this._update(c.dataType==="style"),this.fire(new r.x(`${c.dataType}data`,c))}),this.on("dataloading",c=>{this.fire(new r.x(`${c.dataType}dataloading`,c))}),this._interactions=new __(this)}_getMapId(){return this._mapId}addControl(g,o){if(o===void 0&&(o=g.getDefaultPosition?g.getDefaultPosition():"top-right"),!g||!g.onAdd)return this.fire(new r.t(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const c=g.onAdd(this);this._controls.push(g);const y=this._controlPositions[o];return o.indexOf("bottom")!==-1?y.insertBefore(c,y.firstChild):y.appendChild(c),this}removeControl(g){if(!g||!g.onRemove)return this.fire(new r.t(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const o=this._controls.indexOf(g);return o>-1&&this._controls.splice(o,1),g.onRemove(this),this}hasControl(g){return this._controls.indexOf(g)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(g){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const o=!this._moving;return o&&this.fire(new r.x("movestart",g)).fire(new r.x("move",g)),this.fire(new r.x("resize",g)),o&&this.fire(new r.x("moveend",g)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(g){return this.transform.setMaxBounds(r.as.convert(g)),this._update()}setMinZoom(g){if((g=g??-2)>=-2&&g<=this.transform.maxZoom)return this.transform.minZoom=g,this._update(),this.getZoom()<g?this.setZoom(g):this.fire(new r.x("zoomstart")).fire(new r.x("zoom")).fire(new r.x("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(g){if((g=g??22)>=this.transform.minZoom)return this.transform.maxZoom=g,this._update(),this.getZoom()>g?this.setZoom(g):this.fire(new r.x("zoomstart")).fire(new r.x("zoom")).fire(new r.x("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(g){if((g=g??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(g>=0&&g<=this.transform.maxPitch)return this.transform.minPitch=g,this._update(),this.getPitch()<g?this.setPitch(g):this.fire(new r.x("pitchstart")).fire(new r.x("pitch")).fire(new r.x("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(g){if((g=g??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(g>=this.transform.minPitch)return this.transform.maxPitch=g,this._update(),this.getPitch()>g?this.setPitch(g):this.fire(new r.x("pitchstart")).fire(new r.x("pitch")).fire(new r.x("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(g){return this.transform.renderWorldCopies=g,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(g){return g==="auto"?navigator.language:Array.isArray(g)?g.length===0?void 0:g.map(o=>o==="auto"?navigator.language:o):g}setLanguage(g){const o=this._parseLanguage(g);if(!this.style||o===this._language)return this;this._language=o,this.style.reloadSources();for(const c of this._controls)c._setLanguage&&c._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(g){return this.style&&g!==this._worldview?(this._worldview=g,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(g){return this._lazyInitEmptyStyle(),g?typeof g=="string"&&(g={name:g}):g=null,this._useExplicitProjection=!!g,this._prioritizeAndUpdateProjection(g,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const g=this.transform,o=g.projection.name;let c;o==="globe"&&g.zoom>=r.bU?(g.setMercatorFromTransition(),c=!0):o==="mercator"&&g.zoom<r.bU&&(g.setProjection({name:"globe"}),c=!0),c&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(g,o){return this._updateProjection(g||o||{name:"mercator"})}_updateProjection(g){let o;return o=g.name==="globe"&&this.transform.zoom>=r.bU?this.transform.setMercatorFromTransition():this.transform.setProjection(g),this.style.applyProjectionUpdate(),o&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(g){return this.transform.locationPoint3D(r.bK.convert(g))}unproject(g){return this.transform.pointLocation3D(r.P.convert(g))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(g,o,c){if(g==="mouseenter"||g==="mouseover"){let y=!1;const S=A=>{const $=o.filter(ee=>this.getLayer(ee)),Y=$.length?this.queryRenderedFeatures(A.point,{layers:$}):[];Y.length?y||(y=!0,c.call(this,new Ra(g,this,A.originalEvent,{features:Y}))):y=!1},T=()=>{y=!1};return{layers:new Set(o),listener:c,delegates:{mousemove:S,mouseout:T}}}if(g==="mouseleave"||g==="mouseout"){let y=!1;const S=A=>{const $=o.filter(Y=>this.getLayer(Y));($.length?this.queryRenderedFeatures(A.point,{layers:$}):[]).length?y=!0:y&&(y=!1,c.call(this,new Ra(g,this,A.originalEvent)))},T=A=>{y&&(y=!1,c.call(this,new Ra(g,this,A.originalEvent)))};return{layers:new Set(o),listener:c,delegates:{mousemove:S,mouseout:T}}}{const y=S=>{const T=o.filter($=>this.getLayer($)),A=T.length?this.queryRenderedFeatures(S.point,{layers:T}):[];A.length&&(S.features=A,c.call(this,S),delete S.features)};return{layers:new Set(o),listener:c,delegates:{[g]:y}}}}on(g,o,c){if(typeof o=="function"||c===void 0)return super.on(g,o);if(Array.isArray(o)||(o=[o]),o){for(const S of o)if(!this._isValidId(S))return this}const y=this._createDelegatedListener(g,o,c);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[g]=this._delegatedListeners[g]||[],this._delegatedListeners[g].push(y);for(const S in y.delegates)this.on(S,y.delegates[S]);return this}once(g,o,c){if(typeof o=="function"||c===void 0)return super.once(g,o);if(Array.isArray(o)||(o=[o]),o){for(const S of o)if(!this._isValidId(S))return this}const y=this._createDelegatedListener(g,o,c);for(const S in y.delegates)this.once(S,y.delegates[S]);return this}off(g,o,c){if(typeof o=="function"||c===void 0)return super.off(g,o);const y=new Set(Array.isArray(o)?o:[o]);for(const A of y)if(!this._isValidId(A))return this;const S=(A,$)=>{if(A.size!==$.size)return!1;for(const Y of A)if(!$.has(Y))return!1;return!0},T=this._delegatedListeners?this._delegatedListeners[g]:void 0;return T&&(A=>{for(let $=0;$<A.length;$++){const Y=A[$];if(Y.listener===c&&S(Y.layers,y)){for(const ee in Y.delegates)this.off(ee,Y.delegates[ee]);return A.splice($,1),this}}})(T),this}queryRenderedFeatures(g,o){if(!this.style)return[];if(o!==void 0||g===void 0||g instanceof r.P||Array.isArray(g)||(o=g,g=void 0),g=g||[[0,0],[this.transform.width,this.transform.height]],(o=o||{}).layers&&Array.isArray(o.layers)){for(const c of o.layers)if(!this._isValidId(c))return[]}return this.style.queryRenderedFeatures(g,o,this.transform)}querySourceFeatures(g,o){return this._isValidId(g)?this.style.querySourceFeatures(g,o):[]}isPointOnSurface(g){const{name:o}=this.transform.projection;return o!=="globe"&&o!=="mercator"&&r.w(`${o} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(r.P.convert(g))}addInteraction(g,o){return this._interactions.add(g,o),this}removeInteraction(g){return this._interactions.remove(g),this}setStyle(g,o){return o=r.l({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},o),this.style&&g&&o.diff!==!1&&o.localFontFamily===this._localFontFamily&&o.localIdeographFontFamily===this._localIdeographFontFamily&&!o.config?(this.style._diffStyle(g,(c,y)=>{c?(r.w(`Unable to perform style diff: ${String(c.message||c.error||c)}. Rebuilding the style from scratch.`),this._updateStyle(g,o)):y&&this._update(!0)},()=>{this._postStyleLoadEvent()}),this):(this._localIdeographFontFamily=o.localIdeographFontFamily,this._localFontFamily=o.localFontFamily,this._updateStyle(g,o))}_getUIString(g){const o=this._locale[g];if(o==null)throw new Error(`Missing UI string '${g}'`);return o}_updateStyle(g,o){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),g){const c=r.l({},o);o&&o.config&&(c.initialConfig=o.config,delete c.config),this.style=new Pr(this,c).load(g),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Pr(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(r.w("There is no style added to the map."),!1)}_isValidId(g){return g==null?(this.fire(new r.t(new Error("IDs can't be empty."))),!1):!r.cn(g)||(this.fire(new r.t(new Error(`IDs can't contain special symbols: "${g}".`))),!1)}addSource(g,o){return this._isValidId(g)?(this._lazyInitEmptyStyle(),this.style.addSource(g,o),this._update(!0)):this}isSourceLoaded(g){return!!this._isValidId(g)&&!!this.style&&this.style._isSourceCacheLoaded(g)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(g,o,c){this._lazyInitEmptyStyle(),this.style.addSourceType(g,o,c)}removeSource(g){return this._isValidId(g)?(this.style.removeSource(g),this._updateTerrain(),this._update(!0)):this}getSource(g){return this._isValidId(g)?this.style.getOwnSource(g):null}addImage(g,o,{pixelRatio:c=1,sdf:y=!1,stretchX:S,stretchY:T,content:A}={}){if(this._lazyInitEmptyStyle(),o instanceof HTMLImageElement||ImageBitmap&&o instanceof ImageBitmap){const{width:$,height:Y,data:ee}=r.q.getImageData(o);this.style.addImage(g,{data:new r.r({width:$,height:Y},ee),pixelRatio:c,stretchX:S,stretchY:T,content:A,sdf:y,version:0})}else if(o.width===void 0||o.height===void 0)this.fire(new r.t(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:$,height:Y}=o,ee=o;this.style.addImage(g,{data:new r.r({width:$,height:Y},new Uint8Array(ee.data)),pixelRatio:c,stretchX:S,stretchY:T,content:A,sdf:y,version:0,userImage:ee}),ee.onAdd&&ee.onAdd(this,g)}}updateImage(g,o){this._lazyInitEmptyStyle();const c=this.style.getImage(g);if(!c)return void this.fire(new r.t(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const y=o instanceof HTMLImageElement||ImageBitmap&&o instanceof ImageBitmap?r.q.getImageData(o):o,{width:S,height:T,data:A}=y;if(S===void 0||T===void 0)return void this.fire(new r.t(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(S!==c.data.width||T!==c.data.height)return void this.fire(new r.t(new Error(`The width and height of the updated image (${S}, ${T})
                must be that same as the previous version of the image
                (${c.data.width}, ${c.data.height})`)));const $=!(o instanceof HTMLImageElement||ImageBitmap&&o instanceof ImageBitmap);c.data.replace(A,$),this.style.updateImage(g,c)}hasImage(g){return g?!!this.style&&!!this.style.getImage(g):(this.fire(new r.t(new Error("Missing required image id"))),!1)}removeImage(g){this.style.removeImage(g)}loadImage(g,o){r.o(this._requestManager.transformRequest(g,r.R.Image),(c,y)=>{o(c,y instanceof HTMLImageElement?r.q.getImageData(y):y)})}listImages(){return this.style.listImages()}addModel(g,o){this._lazyInitEmptyStyle(),this.style.addModel(g,o)}hasModel(g){return g?this.style.hasModel(g):(this.fire(new r.t(new Error("Missing required model id"))),!1)}removeModel(g){this.style.removeModel(g)}listModels(){return this.style.listModels()}addLayer(g,o){return this._isValidId(g.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(g,o),this._update(!0)):this}getSlot(g){const o=this.getLayer(g);return o&&o.slot||null}setSlot(g,o){return this.style.setSlot(g,o),this.style.mergeLayers(),this._update(!0)}addImport(g,o){return this.style.addImport(g,o),this}updateImport(g,o){return typeof o!="string"&&o.id!==g?(this.removeImport(g),this.addImport(o)):(this.style.updateImport(g,o),this._update(!0))}removeImport(g){return this.style.removeImport(g),this}moveImport(g,o){return this.style.moveImport(g,o),this._update(!0)}moveLayer(g,o){return this._isValidId(g)?(this.style.moveLayer(g,o),this._update(!0)):this}removeLayer(g){return this._isValidId(g)?(this.style.removeLayer(g),this._update(!0)):this}getLayer(g){if(!this._isValidId(g))return null;const o=this.style.getOwnLayer(g);return o?o.type==="custom"?o.implementation:o.serialize():void 0}getSlots(){return this.style.getSlots()}setLayerZoomRange(g,o,c){return this._isValidId(g)?(this.style.setLayerZoomRange(g,o,c),this._update(!0)):this}setFilter(g,o,c={}){return this._isValidId(g)?(this.style.setFilter(g,o,c),this._update(!0)):this}getFilter(g){return this._isValidId(g)?this.style.getFilter(g):null}setPaintProperty(g,o,c,y={}){return this._isValidId(g)?(this.style.setPaintProperty(g,o,c,y),this._update(!0)):this}getPaintProperty(g,o){return this._isValidId(g)?this.style.getPaintProperty(g,o):null}setLayoutProperty(g,o,c,y={}){return this._isValidId(g)?(this.style.setLayoutProperty(g,o,c,y),this._update(!0)):this}getLayoutProperty(g,o){return this._isValidId(g)?this.style.getLayoutProperty(g,o):null}getSchema(g){return this.style.getSchema(g)}setSchema(g,o){return this.style.setSchema(g,o),this._update(!0)}getConfig(g){return this.style.getConfig(g)}setConfig(g,o){return this.style.setConfig(g,o),this._update(!0)}getConfigProperty(g,o){return this.style.getConfigProperty(g,o)}setConfigProperty(g,o,c){return this.style.setConfigProperty(g,o,c),this._update(!0)}setLights(g){if(this._lazyInitEmptyStyle(),g&&g.length===1&&g[0].type==="flat"){const o=g[0];o.properties?this.style.setFlatLight(o.properties,o.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(g),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const g=this.style.getLights()||[];return g.length===0&&g.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),g}setLight(g,o={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:g}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(g){return this._lazyInitEmptyStyle(),!g&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(g),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(g){return this._lazyInitEmptyStyle(),this.style.setFog(g),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setColorTheme(g){return this._lazyInitEmptyStyle(),this.style.setColorTheme(g),this._update(!0)}setCamera(g){return this.style.setCamera(g),this._triggerCameraUpdate(g)}_triggerCameraUpdate(g){return this._update(this.transform.setOrthographicProjectionAtLowPitch(g["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(g){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(r.bK.convert(g),this.transform):0}setFeatureState(g,o){return this._isValidId(g.source)?(this.style.setFeatureState(g,o),this._update()):this}removeFeatureState(g,o){return this._isValidId(g.source)?(this.style.removeFeatureState(g,o),this._update()):this}getFeatureState(g){return this._isValidId(g.source)?this.style.getFeatureState(g):null}_updateContainerDimensions(){if(!this._container)return;const g=this._container.getBoundingClientRect().width||400,o=this._container.getBoundingClientRect().height||300;let c,y,S,T=this._container;for(;T&&(!y||!S);){const A=window.getComputedStyle(T).transform;A&&A!=="none"&&(c=A.match(/matrix.*\((.+)\)/)[1].split(", "),c[0]&&c[0]!=="0"&&c[0]!=="1"&&(y=c[0]),c[3]&&c[3]!=="0"&&c[3]!=="1"&&(S=c[3])),T=T.parentElement}this._containerWidth=y?Math.abs(g/y):g,this._containerHeight=S?Math.abs(o/S):o}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&r.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const g=this._container;g.classList.add("mapboxgl-map"),(this._missingCSSCanary=W("div","mapboxgl-canary",g)).style.visibility="hidden",this._detectMissingCSS();const o=this._canvasContainer=W("div","mapboxgl-canvas-container",g);this._canvas=W("canvas","mapboxgl-canvas",o),this._interactive&&(o.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const c=this._controlContainer=W("div","mapboxgl-control-container",g),y=this._controlPositions={};["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"].forEach(S=>{y[S]=W("div",`mapboxgl-ctrl-${S}`,c)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(g,o){const c=r.q.devicePixelRatio||1;this._canvas.width=c*Math.ceil(g),this._canvas.height=c*Math.ceil(o),this._canvas.style.width=`${g}px`,this._canvas.style.height=`${o}px`}_addMarker(g){this._markers.push(g)}_removeMarker(g){const o=this._markers.indexOf(g);o!==-1&&this._markers.splice(o,1)}_addPopup(g){this._popups.push(g)}_removePopup(g){const o=this._popups.indexOf(g);o!==-1&&this._popups.splice(o,1)}_setupPainter(){const g=r.l({},j.supported.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),o=this._canvas.getContext("webgl2",g);o?(Sn(o,!0),this.painter=new o_(o,this._contextCreateOptions,this.transform,this._tp),this.on("data",c=>{c.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),r.m.testSupport(o)):this.fire(new r.t(new Error("Failed to initialize WebGL")))}_contextLost(g){g.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new r.x("webglcontextlost",{originalEvent:g}))}_contextRestored(g){this._setupPainter(),this.resize(),this._update(),this.fire(new r.x("webglcontextrestored",{originalEvent:g}))}_onMapScroll(g){if(g.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}idle(){return!this.isMoving()&&this.loaded()}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty}_update(g){return this.style?(this._styleDirty=this._styleDirty||g,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(g){return this._update(),this._renderTaskQueue.add(g)}_cancelRenderFrame(g){this._renderTaskQueue.remove(g)}_requestDomTask(g){!this.loaded()||this.loaded()&&!this.isMoving()?g():this._domRenderTaskQueue.add(g)}_render(g){let o;this.fire(new r.x("renderstart")),++this._frameId;const c=this.painter.context.extTimerQuery,y=r.q.now(),S=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(o=S.createQuery(),S.beginQuery(c.TIME_ELAPSED_EXT,o)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(g),this._domRenderTaskQueue.run(g),this._removed)return;this._updateProjectionTransition();const T=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const ee=this.transform.zoom,te=this.transform.pitch,ue=r.q.now(),fe=new r.a3(ee,{now:ue,fadeDuration:T,pitch:te,transition:this.style.transition});this.style.update(fe)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let A=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),A=this._updateAverageElevation(y),this.style.updateSources(this.transform),this._forceMarkerAndPopupUpdate()):A=this._updateAverageElevation(y);const $=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,T,this._crossSourceCollisions,this.painter.replacementSource);if($&&(this._placementDirty=$.needsRerender),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:T,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new r.x("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,I.mark(k.load),this.fire(new r.x("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),o){const ee=r.q.now()-y;S.endQuery(c.TIME_ELAPSED_EXT),setTimeout(()=>{const te=S.getQueryParameter(o,S.QUERY_RESULT)/1e6;S.deleteQuery(o),this.fire(new r.x("gpu-timing-frame",{cpuTime:ee,gpuTime:te}))},50)}if(this.listens("gpu-timing-layer")){const ee=this.painter.collectGpuTimers();setTimeout(()=>{const te=this.painter.queryGpuTimers(ee);this.fire(new r.x("gpu-timing-layer",{layerTimes:te}))},50)}if(this.listens("gpu-timing-deferred-render")){const ee=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const te=this.painter.queryGpuTimeDeferredRender(ee);this.fire(new r.x("gpu-timing-deferred-render",{gpuTime:te}))},50)}const Y=this._sourcesDirty||this._styleDirty||this._placementDirty||A;if(Y||this._repaint)this.triggerRepaint();else{const ee=this.idle();if(ee&&(A=this._updateAverageElevation(y,!0)),A)this.triggerRepaint();else if(this._triggerFrame(!1),ee&&(this.fire(new r.x("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const te=this._calculateSpeedIndex();this.fire(new r.x("speedindexcompleted",{speedIndex:te})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||Y||(this._fullyLoaded=!0,I.mark(k.fullLoad),this._performanceMetricsCollection&&en(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(g){for(const o of this._markers)g&&!this.getRenderWorldCopies()&&(o._lngLat=o._lngLat.wrap()),o._update();for(const o of this._popups)!g||this.getRenderWorldCopies()||o._trackPointer||(o._lngLat=o._lngLat.wrap()),o._update()}_updateAverageElevation(g,o=!1){const c=S=>(this.transform.averageElevation=S,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&c(0);const y=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(y||(o||g-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(g)){const S=this.transform.averageElevation;let T=this.transform.sampleAverageElevation();this.transform.elevation!=null&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(T)?T=0:this._averageElevationLastSampledAt=g;const A=Math.abs(S-T);if(A>1){if(this._isInitialLoad||y)return this._averageElevation.jumpTo(T),c(T);this._averageElevation.easeTo(T,g,300)}else if(A>1e-4)return this._averageElevation.jumpTo(T),c(T)}return!!this._averageElevation.isEasing(g)&&c(this._averageElevation.getValue(g))}_authenticate(){Ne(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,g=>{if(g&&(g.message===se||g.status===401)){const o=this.painter.context.gl;Sn(o,!1),this._logoControl instanceof y_&&this._logoControl._updateLogo(),o&&o.clear(o.DEPTH_BUFFER_BIT|o.COLOR_BUFFER_BIT|o.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new r.t(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),ft(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_postStyleLoadEvent(){this.style.globalId&&hn(this._requestManager._customAccessToken,{map:this,skuToken:this._requestManager._skuToken,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_updateTerrain(){const g=this._isDragging();this.painter.updateTerrain(this.style,g)}_calculateSpeedIndex(){const g=this.painter.canvasCopy(),o=this.painter.getCanvasCopiesAndTimestamps();o.timeStamps.push(performance.now());const c=this.painter.context.gl,y=c.createFramebuffer();function S(T){c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,T,0);const A=new Uint8Array(c.drawingBufferWidth*c.drawingBufferHeight*4);return c.readPixels(0,0,c.drawingBufferWidth,c.drawingBufferHeight,c.RGBA,c.UNSIGNED_BYTE,A),A}return c.bindFramebuffer(c.FRAMEBUFFER,y),this._canvasPixelComparison(S(g),o.canvasCopies.map(S),o.timeStamps)}_canvasPixelComparison(g,o,c){let y=c[1]-c[0];const S=g.length/4;for(let T=0;T<o.length;T++){const A=o[T];let $=0;for(let Y=0;Y<A.length;Y+=4)A[Y]===g[Y]&&A[Y+1]===g[Y+1]&&A[Y+2]===g[Y+2]&&A[Y+3]===g[Y+3]&&($+=1);y+=(c[T+2]-c[T+1])*(1-$/S)}return y}remove(){this._hash&&this._hash.remove();for(const o of this._controls)o.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const g=this.painter.context.gl.getExtension("WEBGL_lose_context");g&&g.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),We.delete(this.painter.context.gl),wt.remove(),Ue.remove(),this._removed=!0,this.fire(new r.x("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(g){this._renderNextFrame=this._renderNextFrame||g,this.style&&!this._frame&&(this._frame=r.q.frame(o=>{const c=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,c&&this._render(o)}))}_preloadTiles(g){const o=this.style?this.style.getSourceCaches():[];return r.bf(o,(c,y)=>c._preloadTiles(g,y),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(g){this._trackResize&&this.resize({originalEvent:g})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(g){this._showTileBoundaries!==g&&(this._showTileBoundaries=g,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(g){this._showParseStatus!==g&&(this._showParseStatus=g,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(g){this._showTerrainWireframe!==g&&(this._showTerrainWireframe=g,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(g){this._showLayers2DWireframe!==g&&(this._showLayers2DWireframe=g,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(g){this._showLayers3DWireframe!==g&&(this._showLayers3DWireframe=g,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(g){this._speedIndexTiming!==g&&(this._speedIndexTiming=g,this._update())}get showPadding(){return!!this._showPadding}set showPadding(g){this._showPadding!==g&&(this._showPadding=g,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(g){this._showCollisionBoxes!==g&&(this._showCollisionBoxes=g,this._tp.refreshUI(),g?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(g){this._showOverdrawInspector!==g&&(this._showOverdrawInspector=g,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(g){this._repaint!==g&&(this._repaint=g,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(g){this._vertices=g,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(g){this._showTileAABBs!==g&&(this._showTileAABBs=g,this._tp.refreshUI(),g&&this._update())}_setCacheLimits(g,o){r.dy(g,o)}get version(){return C}},NavigationControl:class{constructor(g={}){this.options=r.l({},Up,g),this._container=W("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",o=>o.preventDefault()),this.options.showZoom&&(r.aJ(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",o=>{this._map&&this._map.zoomIn({},{originalEvent:o})}),W("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",o=>{this._map&&this._map.zoomOut({},{originalEvent:o})}),W("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(r.aJ(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",o=>{const c=this._map;c&&(this.options.visualizePitch?c.resetNorthPitch({},{originalEvent:o}):c.resetNorth({},{originalEvent:o}))}),this._compassIcon=W("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const g=this._map;if(!g)return;const o=g.getZoom(),c=o===g.getMaxZoom(),y=o===g.getMinZoom();this._zoomInButton.disabled=c,this._zoomOutButton.disabled=y,this._zoomInButton.setAttribute("aria-disabled",c.toString()),this._zoomOutButton.setAttribute("aria-disabled",y.toString())}_rotateCompassArrow(){const g=this._map;if(!g)return;const o=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(g.transform.pitch*(Math.PI/180)),.5)}) rotateX(${g.transform.pitch}deg) rotateZ(${g.transform.angle*(180/Math.PI)}deg)`:`rotate(${g.transform.angle*(180/Math.PI)}deg)`;g._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=o)})}onAdd(g){return this._map=g,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),g.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&g.on("pitch",this._rotateCompassArrow),g.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new df(g,this._compass,this.options.visualizePitch)),this._container}onRemove(){const g=this._map;g&&(this._container.remove(),this.options.showZoom&&g.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&g.off("pitch",this._rotateCompassArrow),g.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(g,o){const c=W("button",g,this._container);return c.type="button",c.addEventListener("click",o),c}_setButtonTitle(g,o){if(!this._map)return;const c=this._map._getUIString(`NavigationControl.${o}`);g.setAttribute("aria-label",c),g.firstElementChild&&g.firstElementChild.setAttribute("title",c)}},GeolocateControl:class extends r.E{constructor(g={}){super();const o=navigator.geolocation;this.options=r.l({geolocation:o},dh,g),r.aJ(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Mc(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(g){return this._map=g,this._container=W("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(g){const o=(c=!!this.options.geolocation)=>{this._supportsGeolocation=c,g(c)};this._supportsGeolocation!==void 0?g(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then(c=>o(c.state!=="denied")).catch(()=>o()):o()}_isOutOfMapMaxBounds(g){const o=this._map.getMaxBounds(),c=g.coords;return!!o&&(c.longitude<o.getWest()||c.longitude>o.getEast()||c.latitude<o.getSouth()||c.latitude>o.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(g){if(this._map){if(this._isOutOfMapMaxBounds(g))return this._setErrorState(),this.fire(new r.x("outofmaxbounds",g)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=g,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(g),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(g),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new r.x("geolocate",g)),this._finish()}}_updateCamera(g){const o=new r.bK(g.coords.longitude,g.coords.latitude),c=g.coords.accuracy,y=this._map.getBearing(),S=r.l({bearing:y},this.options.fitBoundsOptions);this._map.fitBounds(o.toBounds(c),S,{geolocateSource:!0})}_updateMarker(g){if(g){const o=new r.bK(g.coords.longitude,g.coords.latitude);this._accuracyCircleMarker.setLngLat(o).addTo(this._map),this._userLocationDotMarker.setLngLat(o).addTo(this._map),this._accuracy=g.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const g=this._map.transform,o=r.bD(1,g._center.lat)*g.worldSize,c=Math.ceil(2*this._accuracy*o);this._circleElement.style.width=`${c}px`,this._circleElement.style.height=`${c}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(g){if(this._map){if(this.options.trackUserLocation)if(g.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(g.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new r.x("error",g)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(g){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",o=>o.preventDefault()),this._geolocateButton=W("button","mapboxgl-ctrl-geolocate",this._container),W("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",g===!1){r.w("Geolocation support is not available so the GeolocateControl will be disabled.");const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o)}else{const o=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=W("div","mapboxgl-user-location"),this._dotElement.appendChild(W("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(W("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Hu({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=W("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Hu({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",o=>{o.geolocateSource||this._watchState!=="ACTIVE_LOCK"||o.originalEvent&&o.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new r.x("trackuserlocationend")))})}}_onDeviceOrientation(g){this._userLocationDotMarker&&(g.webkitCompassHeading?this._heading=g.webkitCompassHeading:g.absolute===!0&&(this._heading=-1*g.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return r.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new r.x("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new r.x("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new r.x("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let g;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(g={maximumAge:6e5,timeout:0},this._noTimeout=!0):(g=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,g),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=window.setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const g=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(o=>{o==="granted"&&g()}).catch(console.error):g()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:xg,ScaleControl:class{constructor(g={}){this.options=r.l({},bd,g),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),r.aJ(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const g=this.options.maxWidth||100,o=this._map,c=o._containerHeight/2,y=o._containerWidth/2-g/2,S=o.unproject([y,c]),T=o.unproject([y+g,c]),A=S.distanceTo(T);if(this.options.unit==="imperial"){const $=3.2808*A;$>5280?this._setScale(g,$/5280,"mile"):this._setScale(g,$,"foot")}else this.options.unit==="nautical"?this._setScale(g,A/1852,"nautical-mile"):A>=1e3?this._setScale(g,A/1e3,"kilometer"):this._setScale(g,A,"meter")}_setScale(g,o,c){this._map._requestDomTask(()=>{const y=function(T){const A=Math.pow(10,`${Math.floor(T)}`.length-1);let $=T/A;return $=$>=10?10:$>=5?5:$>=3?3:$>=2?2:$>=1?1:function(Y){const ee=Math.pow(10,Math.ceil(-Math.log(Y)/Math.LN10));return Math.round(Y*ee)/ee}($),A*$}(o),S=y/o;this._container.innerHTML=this._isNumberFormatSupported&&c!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:c}).format(y):`${y}&nbsp;${_T[c]}`,this._container.style.width=g*S+"px"})}onAdd(g){return this._map=g,this._language=g.getLanguage(),this._container=W("div","mapboxgl-ctrl mapboxgl-ctrl-scale",g.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(g){this._language=g,this._update()}setUnit(g){this.options.unit=g,this._update()}},FullscreenControl:class{constructor(g={}){this._fullscreen=!1,g&&g.container&&(g.container instanceof HTMLElement?this._container=g.container:r.w("Full screen control 'container' must be a DOM element.")),r.aJ(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(g){return this._map=g,this._container||(this._container=this._map.getContainer()),this._controlContainer=W("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",r.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const g=this._fullscreenButton=W("button","mapboxgl-ctrl-fullscreen",this._controlContainer);W("span","mapboxgl-ctrl-icon",g).setAttribute("aria-hidden","true"),g.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const g=this._getTitle();this._fullscreenButton.setAttribute("aria-label",g),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",g)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends r.E{constructor(g){super(),this.options=r.l(Object.create(vT),g),r.aJ(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(g&&g.className?g.className.trim().split(/\s+/):[])}addTo(g){return this._map&&this.remove(),this._map=g,this.options.closeOnClick&&g.on("preclick",this._onClose),this.options.closeOnMove&&g.on("move",this._onClose),g.on("remove",this.remove),this._update(),g._addPopup(this),this._focusFirstElement(),this._trackPointer?(g.on("mousemove",this._onMouseEvent),g.on("mouseup",this._onMouseEvent),g._canvasContainer.classList.add("mapboxgl-track-pointer")):g.on("move",this._update),this.fire(new r.x("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const g=this._map;return g&&(g.off("move",this._update),g.off("move",this._onClose),g.off("preclick",this._onClose),g.off("click",this._onClose),g.off("remove",this.remove),g.off("mousemove",this._onMouseEvent),g.off("mouseup",this._onMouseEvent),g.off("drag",this._onMouseEvent),g._canvasContainer&&g._canvasContainer.classList.remove("mapboxgl-track-pointer"),g._removePopup(this),this._map=void 0),this.fire(new r.x("close")),this}getLngLat(){return this._lngLat}setLngLat(g){this._lngLat=r.bK.convert(g),this._pos=null,this._trackPointer=!1,this._update();const o=this._map;return o&&(o.on("move",this._update),o.off("mousemove",this._onMouseEvent),o._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const g=this._map;return g&&(g.off("move",this._update),g.on("mousemove",this._onMouseEvent),g.on("drag",this._onMouseEvent),g._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(g){return this.setDOMContent(document.createTextNode(g))}setHTML(g){const o=document.createDocumentFragment(),c=document.createElement("body");let y;for(c.innerHTML=g;y=c.firstChild,y;)o.appendChild(y);return this.setDOMContent(o)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(g){return this.options.maxWidth=g,this._update(),this}setDOMContent(g){let o=this._content;if(o)for(;o.hasChildNodes();)o.firstChild&&o.removeChild(o.firstChild);else o=this._content=W("div","mapboxgl-popup-content",this._container||void 0);if(o.appendChild(g),this.options.closeButton){const c=this._closeButton=W("button","mapboxgl-popup-close-button",o);c.type="button",c.setAttribute("aria-label","Close popup"),c.setAttribute("aria-hidden","true"),c.innerHTML="&#215;",c.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(g){return this._classList.add(g),this._updateClassList(),this}removeClassName(g){return this._classList.delete(g),this._updateClassList(),this}setOffset(g){return this.options.offset=g,this._update(),this}toggleClassName(g){let o;return this._classList.delete(g)?o=!1:(this._classList.add(g),o=!0),this._updateClassList(),o}_onMouseEvent(g){this._update(g.point)}_getAnchor(g){if(this.options.anchor)return this.options.anchor;const o=this._map,c=this._container,y=this._pos;if(!o||!c||!y)return"bottom";const S=c.offsetWidth,T=c.offsetHeight,A=y.x<S/2,$=y.x>o.transform.width-S/2;if(y.y+g<T)return A?"top-left":$?"top-right":"top";if(y.y>o.transform.height-T){if(A)return"bottom-left";if($)return"bottom-right"}return A?"left":$?"right":"bottom"}_updateClassList(){const g=this._container;if(!g)return;const o=[...this._classList];o.push("mapboxgl-popup"),this._anchor&&o.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&o.push("mapboxgl-popup-track-pointer"),g.className=o.join(" ")}_update(g){const o=this._map,c=this._content;if(!o||!this._lngLat&&!this._trackPointer||!c)return;let y=this._container;if(y||(y=this._container=W("div","mapboxgl-popup",o.getContainer()),this._tip=W("div","mapboxgl-popup-tip",y),y.appendChild(c)),this.options.maxWidth&&y.style.maxWidth!==this.options.maxWidth&&(y.style.maxWidth=this.options.maxWidth),o.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Gu(this._lngLat,this._pos,o.transform)),!this._trackPointer||g){const S=this._pos=this._trackPointer&&g instanceof r.P?g:o.project(this._lngLat),T=ub(this.options.offset),A=this._anchor=this._getAnchor(T.y),$=ub(this.options.offset,A),Y=S.add($).round();o._requestDomTask(()=>{this._container&&A&&(this._container.style.transform=`${El[A]} translate(${Y.x}px,${Y.y}px)`)})}if(!this._marker&&o._showingGlobe()){const S=r.dz(o.transform,this._lngLat)?0:1;this._setOpacity(S)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const g=this._container.querySelector(xT);g&&g.focus()}_onClose(){this.remove()}_setOpacity(g){this._container&&(this._container.style.opacity=`${g}`),this._content&&(this._content.style.pointerEvents=g?"auto":"none")}},Marker:Hu,Style:Pr,LngLat:r.bK,LngLatBounds:r.as,Point:r.P,MercatorCoordinate:r.a5,FreeCameraOptions:bl,Evented:r.E,config:r.e,prewarm:r.dE,clearPrewarmedResources:r.dF,get accessToken(){return r.e.ACCESS_TOKEN},set accessToken(g){r.e.ACCESS_TOKEN=g},get baseApiUrl(){return r.e.API_URL},set baseApiUrl(g){r.e.API_URL=g},get workerCount(){return r.dG.workerCount},set workerCount(g){r.dG.workerCount=g},get maxParallelImageRequests(){return r.e.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(g){r.e.MAX_PARALLEL_IMAGE_REQUESTS=g},clearStorage(g){r.dH(g)},get workerUrl(){return r.dI.workerUrl},set workerUrl(g){r.dI.workerUrl=g},get workerClass(){return r.dI.workerClass},set workerClass(g){r.dI.workerClass=g},get workerParams(){return r.dI.workerParams},set workerParams(g){r.dI.workerParams=g},get dracoUrl(){return r.dJ()},set dracoUrl(g){r.dK(g)},get meshoptUrl(){return r.dL()},set meshoptUrl(g){r.dM(g)},setNow:r.q.setNow,restoreNow:r.q.restoreNow}});var _=u;return _})})(X6);var NH=X6.exports;const Z6=yc(NH);var K6={exports:{}};(function(e,t){(function(n,s){e.exports=s()})(fl,function(){var n=function(ne,Ce){var et={drag:[],click:[],mousemove:[],mousedown:[],mouseup:[],mouseout:[],keydown:[],keyup:[],touchstart:[],touchmove:[],touchend:[],tap:[]},kt={on:function(Ut,nn,Xn){if(et[Ut]===void 0)throw new Error("Invalid event type: "+Ut);et[Ut].push({selector:nn,fn:Xn})},render:function(Ut){Ce.store.featureChanged(Ut)}},jt=function(Ut,nn){for(var Xn=et[Ut],rr=Xn.length;rr--;){var Yn=Xn[rr];if(Yn.selector(nn)){Yn.fn.call(kt,nn)||Ce.store.render(),Ce.ui.updateMapClasses();break}}};return ne.start.call(kt),{render:ne.render,stop:function(){ne.stop&&ne.stop()},trash:function(){ne.trash&&(ne.trash(),Ce.store.render())},combineFeatures:function(){ne.combineFeatures&&ne.combineFeatures()},uncombineFeatures:function(){ne.uncombineFeatures&&ne.uncombineFeatures()},drag:function(Ut){jt("drag",Ut)},click:function(Ut){jt("click",Ut)},mousemove:function(Ut){jt("mousemove",Ut)},mousedown:function(Ut){jt("mousedown",Ut)},mouseup:function(Ut){jt("mouseup",Ut)},mouseout:function(Ut){jt("mouseout",Ut)},keydown:function(Ut){jt("keydown",Ut)},keyup:function(Ut){jt("keyup",Ut)},touchstart:function(Ut){jt("touchstart",Ut)},touchmove:function(Ut){jt("touchmove",Ut)},touchend:function(Ut){jt("touchend",Ut)},tap:function(Ut){jt("tap",Ut)}}};function s(ne){return ne&&ne.__esModule&&Object.prototype.hasOwnProperty.call(ne,"default")?ne.default:ne}function a(ne){if(ne.__esModule)return ne;var Ce=ne.default;if(typeof Ce=="function"){var et=function kt(){if(this instanceof kt){var jt=[null];jt.push.apply(jt,arguments);var Ut=Function.bind.apply(Ce,jt);return new Ut}return Ce.apply(this,arguments)};et.prototype=Ce.prototype}else et={};return Object.defineProperty(et,"__esModule",{value:!0}),Object.keys(ne).forEach(function(kt){var jt=Object.getOwnPropertyDescriptor(ne,kt);Object.defineProperty(et,kt,jt.get?jt:{enumerable:!0,get:function(){return ne[kt]}})}),et}var u={},f={RADIUS:6378137,FLATTENING:1/298.257223563,POLAR_RADIUS:63567523142e-4},_=f;function r(ne){var Ce=0;if(ne&&ne.length>0){Ce+=Math.abs(C(ne[0]));for(var et=1;et<ne.length;et++)Ce-=Math.abs(C(ne[et]))}return Ce}function C(ne){var Ce,et,kt,jt,Ut,nn,Xn=0,rr=ne.length;if(rr>2){for(nn=0;nn<rr;nn++)nn===rr-2?(kt=rr-2,jt=rr-1,Ut=0):nn===rr-1?(kt=rr-1,jt=0,Ut=1):(kt=nn,jt=nn+1,Ut=nn+2),Ce=ne[kt],et=ne[jt],Xn+=(k(ne[Ut][0])-k(Ce[0]))*Math.sin(k(et[1]));Xn=Xn*_.RADIUS*_.RADIUS/2}return Xn}function k(ne){return ne*Math.PI/180}u.geometry=function ne(Ce){var et,kt=0;switch(Ce.type){case"Polygon":return r(Ce.coordinates);case"MultiPolygon":for(et=0;et<Ce.coordinates.length;et++)kt+=r(Ce.coordinates[et]);return kt;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(et=0;et<Ce.geometries.length;et++)kt+=ne(Ce.geometries[et]);return kt}},u.ring=C;var I={CONTROL_BASE:"mapboxgl-ctrl",CONTROL_PREFIX:"mapboxgl-ctrl-",CONTROL_BUTTON:"mapbox-gl-draw_ctrl-draw-btn",CONTROL_BUTTON_LINE:"mapbox-gl-draw_line",CONTROL_BUTTON_POLYGON:"mapbox-gl-draw_polygon",CONTROL_BUTTON_POINT:"mapbox-gl-draw_point",CONTROL_BUTTON_TRASH:"mapbox-gl-draw_trash",CONTROL_BUTTON_COMBINE_FEATURES:"mapbox-gl-draw_combine",CONTROL_BUTTON_UNCOMBINE_FEATURES:"mapbox-gl-draw_uncombine",CONTROL_GROUP:"mapboxgl-ctrl-group",ATTRIBUTION:"mapboxgl-ctrl-attrib",ACTIVE_BUTTON:"active",BOX_SELECT:"mapbox-gl-draw_boxselect"},P={HOT:"mapbox-gl-draw-hot",COLD:"mapbox-gl-draw-cold"},D={ADD:"add",MOVE:"move",DRAG:"drag",POINTER:"pointer",NONE:"none"},N={POLYGON:"polygon",LINE:"line_string",POINT:"point"},j={FEATURE:"Feature",POLYGON:"Polygon",LINE_STRING:"LineString",POINT:"Point",FEATURE_COLLECTION:"FeatureCollection",MULTI_PREFIX:"Multi",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon"},W={DRAW_LINE_STRING:"draw_line_string",DRAW_POLYGON:"draw_polygon",DRAW_POINT:"draw_point",SIMPLE_SELECT:"simple_select",DIRECT_SELECT:"direct_select",STATIC:"static"},H={CREATE:"draw.create",DELETE:"draw.delete",UPDATE:"draw.update",SELECTION_CHANGE:"draw.selectionchange",MODE_CHANGE:"draw.modechange",ACTIONABLE:"draw.actionable",RENDER:"draw.render",COMBINE_FEATURES:"draw.combine",UNCOMBINE_FEATURES:"draw.uncombine"},q={MOVE:"move",CHANGE_COORDINATES:"change_coordinates"},Z={FEATURE:"feature",MIDPOINT:"midpoint",VERTEX:"vertex"},re={ACTIVE:"true",INACTIVE:"false"},le=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate"],_e=-85,ye=Object.freeze({__proto__:null,classes:I,sources:P,cursors:D,types:N,geojsonTypes:j,modes:W,events:H,updateActions:q,meta:Z,activeStates:re,interactions:le,LAT_MIN:-90,LAT_RENDERED_MIN:_e,LAT_MAX:90,LAT_RENDERED_MAX:85,LNG_MIN:-270,LNG_MAX:270}),de={Point:0,LineString:1,MultiLineString:1,Polygon:2};function ce(ne,Ce){var et=de[ne.geometry.type]-de[Ce.geometry.type];return et===0&&ne.geometry.type===j.POLYGON?ne.area-Ce.area:et}function oe(ne){return ne.map(function(Ce){return Ce.geometry.type===j.POLYGON&&(Ce.area=u.geometry({type:j.FEATURE,property:{},geometry:Ce.geometry})),Ce}).sort(ce).map(function(Ce){return delete Ce.area,Ce})}function xe(ne,Ce){return Ce===void 0&&(Ce=0),[[ne.point.x-Ce,ne.point.y-Ce],[ne.point.x+Ce,ne.point.y+Ce]]}function he(ne){if(this._items={},this._nums={},this._length=ne?ne.length:0,ne)for(var Ce=0,et=ne.length;Ce<et;Ce++)this.add(ne[Ce]),ne[Ce]!==void 0&&(typeof ne[Ce]=="string"?this._items[ne[Ce]]=Ce:this._nums[ne[Ce]]=Ce)}he.prototype.add=function(ne){return this.has(ne)||(this._length++,typeof ne=="string"?this._items[ne]=this._length:this._nums[ne]=this._length),this},he.prototype.delete=function(ne){return this.has(ne)===!1||(this._length--,delete this._items[ne],delete this._nums[ne]),this},he.prototype.has=function(ne){return(typeof ne=="string"||typeof ne=="number")&&(this._items[ne]!==void 0||this._nums[ne]!==void 0)},he.prototype.values=function(){var ne=this,Ce=[];return Object.keys(this._items).forEach(function(et){Ce.push({k:et,v:ne._items[et]})}),Object.keys(this._nums).forEach(function(et){Ce.push({k:JSON.parse(et),v:ne._nums[et]})}),Ce.sort(function(et,kt){return et.v-kt.v}).map(function(et){return et.k})},he.prototype.clear=function(){return this._length=0,this._items={},this._nums={},this};var Ee=[Z.FEATURE,Z.MIDPOINT,Z.VERTEX],se={click:function(ne,Ce,et){return we(ne,Ce,et,et.options.clickBuffer)},touch:function(ne,Ce,et){return we(ne,Ce,et,et.options.touchBuffer)}};function we(ne,Ce,et,kt){if(et.map===null)return[];var jt=ne?xe(ne,kt):Ce,Ut={};et.options.styles&&(Ut.layers=et.options.styles.map(function(Yn){return Yn.id}).filter(function(Yn){return et.map.getLayer(Yn)!=null}));var nn=et.map.queryRenderedFeatures(jt,Ut).filter(function(Yn){return Ee.indexOf(Yn.properties.meta)!==-1}),Xn=new he,rr=[];return nn.forEach(function(Yn){var hr=Yn.properties.id;Xn.has(hr)||(Xn.add(hr),rr.push(Yn))}),oe(rr)}function Se(ne,Ce){var et=se.click(ne,null,Ce),kt={mouse:D.NONE};return et[0]&&(kt.mouse=et[0].properties.active===re.ACTIVE?D.MOVE:D.POINTER,kt.feature=et[0].properties.meta),Ce.events.currentModeName().indexOf("draw")!==-1&&(kt.mouse=D.ADD),Ce.ui.queueMapClasses(kt),Ce.ui.updateMapClasses(),et[0]}function Pe(ne,Ce){var et=ne.x-Ce.x,kt=ne.y-Ce.y;return Math.sqrt(et*et+kt*kt)}function Me(ne,Ce,et){et===void 0&&(et={});var kt=et.fineTolerance!=null?et.fineTolerance:4,jt=et.grossTolerance!=null?et.grossTolerance:12,Ut=et.interval!=null?et.interval:500;ne.point=ne.point||Ce.point,ne.time=ne.time||Ce.time;var nn=Pe(ne.point,Ce.point);return nn<kt||nn<jt&&Ce.time-ne.time<Ut}function Re(ne,Ce,et){et===void 0&&(et={});var kt=et.tolerance!=null?et.tolerance:25,jt=et.interval!=null?et.interval:250;return ne.point=ne.point||Ce.point,ne.time=ne.time||Ce.time,Pe(ne.point,Ce.point)<kt&&Ce.time-ne.time<jt}var Oe={exports:{}},$e=Oe.exports=function(ne,Ce){if(Ce||(Ce=16),ne===void 0&&(ne=128),ne<=0)return"0";for(var et=Math.log(Math.pow(2,ne))/Math.log(Ce),kt=2;et===1/0;kt*=2)et=Math.log(Math.pow(2,ne/kt))/Math.log(Ce)*kt;var jt=et-Math.floor(et),Ut="";for(kt=0;kt<Math.floor(et);kt++)Ut=Math.floor(Math.random()*Ce).toString(Ce)+Ut;if(jt){var nn=Math.pow(Ce,jt);Ut=Math.floor(Math.random()*nn).toString(Ce)+Ut}var Xn=parseInt(Ut,Ce);return Xn!==1/0&&Xn>=Math.pow(2,ne)?$e(ne,Ce):Ut};$e.rack=function(ne,Ce,et){var kt=function(Ut){var nn=0;do{if(nn++>10){if(!et)throw new Error("too many ID collisions, use more bits");ne+=et}var Xn=$e(ne,Ce)}while(Object.hasOwnProperty.call(jt,Xn));return jt[Xn]=Ut,Xn},jt=kt.hats={};return kt.get=function(Ut){return kt.hats[Ut]},kt.set=function(Ut,nn){return kt.hats[Ut]=nn,kt},kt.bits=ne||128,kt.base=Ce||16,kt};var Ke=s(Oe.exports),Ct=function(ne,Ce){this.ctx=ne,this.properties=Ce.properties||{},this.coordinates=Ce.geometry.coordinates,this.id=Ce.id||Ke(),this.type=Ce.geometry.type};Ct.prototype.changed=function(){this.ctx.store.featureChanged(this.id)},Ct.prototype.incomingCoords=function(ne){this.setCoordinates(ne)},Ct.prototype.setCoordinates=function(ne){this.coordinates=ne,this.changed()},Ct.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.coordinates))},Ct.prototype.setProperty=function(ne,Ce){this.properties[ne]=Ce},Ct.prototype.toGeoJSON=function(){return JSON.parse(JSON.stringify({id:this.id,type:j.FEATURE,properties:this.properties,geometry:{coordinates:this.getCoordinates(),type:this.type}}))},Ct.prototype.internal=function(ne){var Ce={id:this.id,meta:Z.FEATURE,"meta:type":this.type,active:re.INACTIVE,mode:ne};if(this.ctx.options.userProperties)for(var et in this.properties)Ce["user_"+et]=this.properties[et];return{type:j.FEATURE,properties:Ce,geometry:{coordinates:this.getCoordinates(),type:this.type}}};var Ue=function(ne,Ce){Ct.call(this,ne,Ce)};(Ue.prototype=Object.create(Ct.prototype)).isValid=function(){return typeof this.coordinates[0]=="number"&&typeof this.coordinates[1]=="number"},Ue.prototype.updateCoordinate=function(ne,Ce,et){this.coordinates=arguments.length===3?[Ce,et]:[ne,Ce],this.changed()},Ue.prototype.getCoordinate=function(){return this.getCoordinates()};var ft=function(ne,Ce){Ct.call(this,ne,Ce)};(ft.prototype=Object.create(Ct.prototype)).isValid=function(){return this.coordinates.length>1},ft.prototype.addCoordinate=function(ne,Ce,et){this.changed();var kt=parseInt(ne,10);this.coordinates.splice(kt,0,[Ce,et])},ft.prototype.getCoordinate=function(ne){var Ce=parseInt(ne,10);return JSON.parse(JSON.stringify(this.coordinates[Ce]))},ft.prototype.removeCoordinate=function(ne){this.changed(),this.coordinates.splice(parseInt(ne,10),1)},ft.prototype.updateCoordinate=function(ne,Ce,et){var kt=parseInt(ne,10);this.coordinates[kt]=[Ce,et],this.changed()};var Bt=function(ne,Ce){Ct.call(this,ne,Ce),this.coordinates=this.coordinates.map(function(et){return et.slice(0,-1)})};(Bt.prototype=Object.create(Ct.prototype)).isValid=function(){return this.coordinates.length!==0&&this.coordinates.every(function(ne){return ne.length>2})},Bt.prototype.incomingCoords=function(ne){this.coordinates=ne.map(function(Ce){return Ce.slice(0,-1)}),this.changed()},Bt.prototype.setCoordinates=function(ne){this.coordinates=ne,this.changed()},Bt.prototype.addCoordinate=function(ne,Ce,et){this.changed();var kt=ne.split(".").map(function(jt){return parseInt(jt,10)});this.coordinates[kt[0]].splice(kt[1],0,[Ce,et])},Bt.prototype.removeCoordinate=function(ne){this.changed();var Ce=ne.split(".").map(function(kt){return parseInt(kt,10)}),et=this.coordinates[Ce[0]];et&&(et.splice(Ce[1],1),et.length<3&&this.coordinates.splice(Ce[0],1))},Bt.prototype.getCoordinate=function(ne){var Ce=ne.split(".").map(function(kt){return parseInt(kt,10)}),et=this.coordinates[Ce[0]];return JSON.parse(JSON.stringify(et[Ce[1]]))},Bt.prototype.getCoordinates=function(){return this.coordinates.map(function(ne){return ne.concat([ne[0]])})},Bt.prototype.updateCoordinate=function(ne,Ce,et){this.changed();var kt=ne.split("."),jt=parseInt(kt[0],10),Ut=parseInt(kt[1],10);this.coordinates[jt]===void 0&&(this.coordinates[jt]=[]),this.coordinates[jt][Ut]=[Ce,et]};var hn={MultiPoint:Ue,MultiLineString:ft,MultiPolygon:Bt},ot=function(ne,Ce,et,kt,jt){var Ut=et.split("."),nn=parseInt(Ut[0],10),Xn=Ut[1]?Ut.slice(1).join("."):null;return ne[nn][Ce](Xn,kt,jt)},en=function(ne,Ce){if(Ct.call(this,ne,Ce),delete this.coordinates,this.model=hn[Ce.geometry.type],this.model===void 0)throw new TypeError(Ce.geometry.type+" is not a valid type");this.features=this._coordinatesToFeatures(Ce.geometry.coordinates)};function wt(ne){this.map=ne.map,this.drawConfig=JSON.parse(JSON.stringify(ne.options||{})),this._ctx=ne}(en.prototype=Object.create(Ct.prototype))._coordinatesToFeatures=function(ne){var Ce=this,et=this.model.bind(this);return ne.map(function(kt){return new et(Ce.ctx,{id:Ke(),type:j.FEATURE,properties:{},geometry:{coordinates:kt,type:Ce.type.replace("Multi","")}})})},en.prototype.isValid=function(){return this.features.every(function(ne){return ne.isValid()})},en.prototype.setCoordinates=function(ne){this.features=this._coordinatesToFeatures(ne),this.changed()},en.prototype.getCoordinate=function(ne){return ot(this.features,"getCoordinate",ne)},en.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.features.map(function(ne){return ne.type===j.POLYGON?ne.getCoordinates():ne.coordinates})))},en.prototype.updateCoordinate=function(ne,Ce,et){ot(this.features,"updateCoordinate",ne,Ce,et),this.changed()},en.prototype.addCoordinate=function(ne,Ce,et){ot(this.features,"addCoordinate",ne,Ce,et),this.changed()},en.prototype.removeCoordinate=function(ne){ot(this.features,"removeCoordinate",ne),this.changed()},en.prototype.getFeatures=function(){return this.features},wt.prototype.setSelected=function(ne){return this._ctx.store.setSelected(ne)},wt.prototype.setSelectedCoordinates=function(ne){var Ce=this;this._ctx.store.setSelectedCoordinates(ne),ne.reduce(function(et,kt){return et[kt.feature_id]===void 0&&(et[kt.feature_id]=!0,Ce._ctx.store.get(kt.feature_id).changed()),et},{})},wt.prototype.getSelected=function(){return this._ctx.store.getSelected()},wt.prototype.getSelectedIds=function(){return this._ctx.store.getSelectedIds()},wt.prototype.isSelected=function(ne){return this._ctx.store.isSelected(ne)},wt.prototype.getFeature=function(ne){return this._ctx.store.get(ne)},wt.prototype.select=function(ne){return this._ctx.store.select(ne)},wt.prototype.deselect=function(ne){return this._ctx.store.deselect(ne)},wt.prototype.deleteFeature=function(ne,Ce){return Ce===void 0&&(Ce={}),this._ctx.store.delete(ne,Ce)},wt.prototype.addFeature=function(ne){return this._ctx.store.add(ne)},wt.prototype.clearSelectedFeatures=function(){return this._ctx.store.clearSelected()},wt.prototype.clearSelectedCoordinates=function(){return this._ctx.store.clearSelectedCoordinates()},wt.prototype.setActionableState=function(ne){ne===void 0&&(ne={});var Ce={trash:ne.trash||!1,combineFeatures:ne.combineFeatures||!1,uncombineFeatures:ne.uncombineFeatures||!1};return this._ctx.events.actionable(Ce)},wt.prototype.changeMode=function(ne,Ce,et){return Ce===void 0&&(Ce={}),et===void 0&&(et={}),this._ctx.events.changeMode(ne,Ce,et)},wt.prototype.updateUIClasses=function(ne){return this._ctx.ui.queueMapClasses(ne)},wt.prototype.activateUIButton=function(ne){return this._ctx.ui.setActiveButton(ne)},wt.prototype.featuresAt=function(ne,Ce,et){if(et===void 0&&(et="click"),et!=="click"&&et!=="touch")throw new Error("invalid buffer type");return se[et](ne,Ce,this._ctx)},wt.prototype.newFeature=function(ne){var Ce=ne.geometry.type;return Ce===j.POINT?new Ue(this._ctx,ne):Ce===j.LINE_STRING?new ft(this._ctx,ne):Ce===j.POLYGON?new Bt(this._ctx,ne):new en(this._ctx,ne)},wt.prototype.isInstanceOf=function(ne,Ce){if(ne===j.POINT)return Ce instanceof Ue;if(ne===j.LINE_STRING)return Ce instanceof ft;if(ne===j.POLYGON)return Ce instanceof Bt;if(ne==="MultiFeature")return Ce instanceof en;throw new Error("Unknown feature class: "+ne)},wt.prototype.doRender=function(ne){return this._ctx.store.featureChanged(ne)},wt.prototype.onSetup=function(){},wt.prototype.onDrag=function(){},wt.prototype.onClick=function(){},wt.prototype.onMouseMove=function(){},wt.prototype.onMouseDown=function(){},wt.prototype.onMouseUp=function(){},wt.prototype.onMouseOut=function(){},wt.prototype.onKeyUp=function(){},wt.prototype.onKeyDown=function(){},wt.prototype.onTouchStart=function(){},wt.prototype.onTouchMove=function(){},wt.prototype.onTouchEnd=function(){},wt.prototype.onTap=function(){},wt.prototype.onStop=function(){},wt.prototype.onTrash=function(){},wt.prototype.onCombineFeature=function(){},wt.prototype.onUncombineFeature=function(){},wt.prototype.toDisplayFeatures=function(){throw new Error("You must overwrite toDisplayFeatures")};var Ne={drag:"onDrag",click:"onClick",mousemove:"onMouseMove",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseout:"onMouseOut",keyup:"onKeyUp",keydown:"onKeyDown",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd",tap:"onTap"},We=Object.keys(Ne);function Sn(ne){var Ce=Object.keys(ne);return function(et,kt){kt===void 0&&(kt={});var jt={},Ut=Ce.reduce(function(nn,Xn){return nn[Xn]=ne[Xn],nn},new wt(et));return{start:function(){var nn=this;jt=Ut.onSetup(kt),We.forEach(function(Xn){var rr,Yn=Ne[Xn],hr=function(){return!1};ne[Yn]&&(hr=function(){return!0}),nn.on(Xn,hr,(rr=Yn,function(Ln){return Ut[rr](jt,Ln)}))})},stop:function(){Ut.onStop(jt)},trash:function(){Ut.onTrash(jt)},combineFeatures:function(){Ut.onCombineFeatures(jt)},uncombineFeatures:function(){Ut.onUncombineFeatures(jt)},render:function(nn,Xn){Ut.toDisplayFeatures(jt,nn,Xn)}}}}function Ae(ne){return[].concat(ne).filter(function(Ce){return Ce!==void 0})}function st(){var ne=this;if(!(ne.ctx.map&&ne.ctx.map.getSource(P.HOT)!==void 0))return rr();var Ce=ne.ctx.events.currentModeName();ne.ctx.ui.queueMapClasses({mode:Ce});var et=[],kt=[];ne.isDirty?kt=ne.getAllIds():(et=ne.getChangedIds().filter(function(Yn){return ne.get(Yn)!==void 0}),kt=ne.sources.hot.filter(function(Yn){return Yn.properties.id&&et.indexOf(Yn.properties.id)===-1&&ne.get(Yn.properties.id)!==void 0}).map(function(Yn){return Yn.properties.id})),ne.sources.hot=[];var jt=ne.sources.cold.length;ne.sources.cold=ne.isDirty?[]:ne.sources.cold.filter(function(Yn){var hr=Yn.properties.id||Yn.properties.parent;return et.indexOf(hr)===-1});var Ut=jt!==ne.sources.cold.length||kt.length>0;function nn(Yn,hr){var Ln=ne.get(Yn).internal(Ce);ne.ctx.events.currentModeRender(Ln,function(ii){ne.sources[hr].push(ii)})}if(et.forEach(function(Yn){return nn(Yn,"hot")}),kt.forEach(function(Yn){return nn(Yn,"cold")}),Ut&&ne.ctx.map.getSource(P.COLD).setData({type:j.FEATURE_COLLECTION,features:ne.sources.cold}),ne.ctx.map.getSource(P.HOT).setData({type:j.FEATURE_COLLECTION,features:ne.sources.hot}),ne._emitSelectionChange&&(ne.ctx.map.fire(H.SELECTION_CHANGE,{features:ne.getSelected().map(function(Yn){return Yn.toGeoJSON()}),points:ne.getSelectedCoordinates().map(function(Yn){return{type:j.FEATURE,properties:{},geometry:{type:j.POINT,coordinates:Yn.coordinates}}})}),ne._emitSelectionChange=!1),ne._deletedFeaturesToEmit.length){var Xn=ne._deletedFeaturesToEmit.map(function(Yn){return Yn.toGeoJSON()});ne._deletedFeaturesToEmit=[],ne.ctx.map.fire(H.DELETE,{features:Xn})}function rr(){ne.isDirty=!1,ne.clearChangedIds()}rr(),ne.ctx.map.fire(H.RENDER,{})}function gt(ne){var Ce,et=this;this._features={},this._featureIds=new he,this._selectedFeatureIds=new he,this._selectedCoordinates=[],this._changedFeatureIds=new he,this._deletedFeaturesToEmit=[],this._emitSelectionChange=!1,this._mapInitialConfig={},this.ctx=ne,this.sources={hot:[],cold:[]},this.render=function(){Ce||(Ce=requestAnimationFrame(function(){Ce=null,st.call(et)}))},this.isDirty=!1}function ut(ne,Ce){var et=ne._selectedCoordinates.filter(function(kt){return ne._selectedFeatureIds.has(kt.feature_id)});ne._selectedCoordinates.length===et.length||Ce.silent||(ne._emitSelectionChange=!0),ne._selectedCoordinates=et}gt.prototype.createRenderBatch=function(){var ne=this,Ce=this.render,et=0;return this.render=function(){et++},function(){ne.render=Ce,et>0&&ne.render()}},gt.prototype.setDirty=function(){return this.isDirty=!0,this},gt.prototype.featureChanged=function(ne){return this._changedFeatureIds.add(ne),this},gt.prototype.getChangedIds=function(){return this._changedFeatureIds.values()},gt.prototype.clearChangedIds=function(){return this._changedFeatureIds.clear(),this},gt.prototype.getAllIds=function(){return this._featureIds.values()},gt.prototype.add=function(ne){return this.featureChanged(ne.id),this._features[ne.id]=ne,this._featureIds.add(ne.id),this},gt.prototype.delete=function(ne,Ce){var et=this;return Ce===void 0&&(Ce={}),Ae(ne).forEach(function(kt){et._featureIds.has(kt)&&(et._featureIds.delete(kt),et._selectedFeatureIds.delete(kt),Ce.silent||et._deletedFeaturesToEmit.indexOf(et._features[kt])===-1&&et._deletedFeaturesToEmit.push(et._features[kt]),delete et._features[kt],et.isDirty=!0)}),ut(this,Ce),this},gt.prototype.get=function(ne){return this._features[ne]},gt.prototype.getAll=function(){var ne=this;return Object.keys(this._features).map(function(Ce){return ne._features[Ce]})},gt.prototype.select=function(ne,Ce){var et=this;return Ce===void 0&&(Ce={}),Ae(ne).forEach(function(kt){et._selectedFeatureIds.has(kt)||(et._selectedFeatureIds.add(kt),et._changedFeatureIds.add(kt),Ce.silent||(et._emitSelectionChange=!0))}),this},gt.prototype.deselect=function(ne,Ce){var et=this;return Ce===void 0&&(Ce={}),Ae(ne).forEach(function(kt){et._selectedFeatureIds.has(kt)&&(et._selectedFeatureIds.delete(kt),et._changedFeatureIds.add(kt),Ce.silent||(et._emitSelectionChange=!0))}),ut(this,Ce),this},gt.prototype.clearSelected=function(ne){return ne===void 0&&(ne={}),this.deselect(this._selectedFeatureIds.values(),{silent:ne.silent}),this},gt.prototype.setSelected=function(ne,Ce){var et=this;return Ce===void 0&&(Ce={}),ne=Ae(ne),this.deselect(this._selectedFeatureIds.values().filter(function(kt){return ne.indexOf(kt)===-1}),{silent:Ce.silent}),this.select(ne.filter(function(kt){return!et._selectedFeatureIds.has(kt)}),{silent:Ce.silent}),this},gt.prototype.setSelectedCoordinates=function(ne){return this._selectedCoordinates=ne,this._emitSelectionChange=!0,this},gt.prototype.clearSelectedCoordinates=function(){return this._selectedCoordinates=[],this._emitSelectionChange=!0,this},gt.prototype.getSelectedIds=function(){return this._selectedFeatureIds.values()},gt.prototype.getSelected=function(){var ne=this;return this._selectedFeatureIds.values().map(function(Ce){return ne.get(Ce)})},gt.prototype.getSelectedCoordinates=function(){var ne=this;return this._selectedCoordinates.map(function(Ce){return{coordinates:ne.get(Ce.feature_id).getCoordinate(Ce.coord_path)}})},gt.prototype.isSelected=function(ne){return this._selectedFeatureIds.has(ne)},gt.prototype.setFeatureProperty=function(ne,Ce,et){this.get(ne).setProperty(Ce,et),this.featureChanged(ne)},gt.prototype.storeMapConfig=function(){var ne=this;le.forEach(function(Ce){ne.ctx.map[Ce]&&(ne._mapInitialConfig[Ce]=ne.ctx.map[Ce].isEnabled())})},gt.prototype.restoreMapConfig=function(){var ne=this;Object.keys(this._mapInitialConfig).forEach(function(Ce){ne._mapInitialConfig[Ce]?ne.ctx.map[Ce].enable():ne.ctx.map[Ce].disable()})},gt.prototype.getInitialConfigValue=function(ne){return this._mapInitialConfig[ne]===void 0||this._mapInitialConfig[ne]};var tt=function(){for(var ne=arguments,Ce={},et=0;et<arguments.length;et++){var kt=ne[et];for(var jt in kt)nt.call(kt,jt)&&(Ce[jt]=kt[jt])}return Ce},nt=Object.prototype.hasOwnProperty,tn=s(tt),un=["mode","feature","mouse"];function qt(ne){var Ce=null,et=null,kt={onRemove:function(){return ne.map.off("load",kt.connect),clearInterval(et),kt.removeLayers(),ne.store.restoreMapConfig(),ne.ui.removeButtons(),ne.events.removeEventListeners(),ne.ui.clearMapClasses(),ne.boxZoomInitial&&ne.map.boxZoom.enable(),ne.map=null,ne.container=null,ne.store=null,Ce&&Ce.parentNode&&Ce.parentNode.removeChild(Ce),Ce=null,this},connect:function(){ne.map.off("load",kt.connect),clearInterval(et),kt.addLayers(),ne.store.storeMapConfig(),ne.events.addEventListeners()},onAdd:function(jt){var Ut=jt.fire;return jt.fire=function(nn,Xn){var rr=arguments;return Ut.length===1&&arguments.length!==1&&(rr=[tn({},{type:nn},Xn)]),Ut.apply(jt,rr)},ne.map=jt,ne.events=function(nn){var Xn=Object.keys(nn.options.modes).reduce(function(jn,kr){return jn[kr]=Sn(nn.options.modes[kr]),jn},{}),rr={},Yn={},hr={},Ln=null,ii=null;hr.drag=function(jn,kr){kr({point:jn.point,time:new Date().getTime()})?(nn.ui.queueMapClasses({mouse:D.DRAG}),ii.drag(jn)):jn.originalEvent.stopPropagation()},hr.mousedrag=function(jn){hr.drag(jn,function(kr){return!Me(rr,kr)})},hr.touchdrag=function(jn){hr.drag(jn,function(kr){return!Re(Yn,kr)})},hr.mousemove=function(jn){if((jn.originalEvent.buttons!==void 0?jn.originalEvent.buttons:jn.originalEvent.which)===1)return hr.mousedrag(jn);var kr=Se(jn,nn);jn.featureTarget=kr,ii.mousemove(jn)},hr.mousedown=function(jn){rr={time:new Date().getTime(),point:jn.point};var kr=Se(jn,nn);jn.featureTarget=kr,ii.mousedown(jn)},hr.mouseup=function(jn){var kr=Se(jn,nn);jn.featureTarget=kr,Me(rr,{point:jn.point,time:new Date().getTime()})?ii.click(jn):ii.mouseup(jn)},hr.mouseout=function(jn){ii.mouseout(jn)},hr.touchstart=function(jn){if(nn.options.touchEnabled){Yn={time:new Date().getTime(),point:jn.point};var kr=se.touch(jn,null,nn)[0];jn.featureTarget=kr,ii.touchstart(jn)}},hr.touchmove=function(jn){if(nn.options.touchEnabled)return ii.touchmove(jn),hr.touchdrag(jn)},hr.touchend=function(jn){if(jn.originalEvent.preventDefault(),nn.options.touchEnabled){var kr=se.touch(jn,null,nn)[0];jn.featureTarget=kr,Re(Yn,{time:new Date().getTime(),point:jn.point})?ii.tap(jn):ii.touchend(jn)}};var Tr=function(jn){return!(jn===8||jn===46||jn>=48&&jn<=57)};function Kr(jn,kr,Ri){Ri===void 0&&(Ri={}),ii.stop();var Qi=Xn[jn];if(Qi===void 0)throw new Error(jn+" is not valid");Ln=jn;var Mo=Qi(nn,kr);ii=n(Mo,nn),Ri.silent||nn.map.fire(H.MODE_CHANGE,{mode:jn}),nn.store.setDirty(),nn.store.render()}hr.keydown=function(jn){(jn.srcElement||jn.target).classList.contains("mapboxgl-canvas")&&(jn.keyCode!==8&&jn.keyCode!==46||!nn.options.controls.trash?Tr(jn.keyCode)?ii.keydown(jn):jn.keyCode===49&&nn.options.controls.point?Kr(W.DRAW_POINT):jn.keyCode===50&&nn.options.controls.line_string?Kr(W.DRAW_LINE_STRING):jn.keyCode===51&&nn.options.controls.polygon&&Kr(W.DRAW_POLYGON):(jn.preventDefault(),ii.trash()))},hr.keyup=function(jn){Tr(jn.keyCode)&&ii.keyup(jn)},hr.zoomend=function(){nn.store.changeZoom()},hr.data=function(jn){if(jn.dataType==="style"){var kr=nn.setup,Ri=nn.map,Qi=nn.options,Mo=nn.store;Qi.styles.some(function(ta){return Ri.getLayer(ta.id)})||(kr.addLayers(),Mo.setDirty(),Mo.render())}};var sr={trash:!1,combineFeatures:!1,uncombineFeatures:!1};return{start:function(){Ln=nn.options.defaultMode,ii=n(Xn[Ln](nn),nn)},changeMode:Kr,actionable:function(jn){var kr=!1;Object.keys(jn).forEach(function(Ri){if(sr[Ri]===void 0)throw new Error("Invalid action type");sr[Ri]!==jn[Ri]&&(kr=!0),sr[Ri]=jn[Ri]}),kr&&nn.map.fire(H.ACTIONABLE,{actions:sr})},currentModeName:function(){return Ln},currentModeRender:function(jn,kr){return ii.render(jn,kr)},fire:function(jn,kr){hr[jn]&&hr[jn](kr)},addEventListeners:function(){nn.map.on("mousemove",hr.mousemove),nn.map.on("mousedown",hr.mousedown),nn.map.on("mouseup",hr.mouseup),nn.map.on("data",hr.data),nn.map.on("touchmove",hr.touchmove),nn.map.on("touchstart",hr.touchstart),nn.map.on("touchend",hr.touchend),nn.container.addEventListener("mouseout",hr.mouseout),nn.options.keybindings&&(nn.container.addEventListener("keydown",hr.keydown),nn.container.addEventListener("keyup",hr.keyup))},removeEventListeners:function(){nn.map.off("mousemove",hr.mousemove),nn.map.off("mousedown",hr.mousedown),nn.map.off("mouseup",hr.mouseup),nn.map.off("data",hr.data),nn.map.off("touchmove",hr.touchmove),nn.map.off("touchstart",hr.touchstart),nn.map.off("touchend",hr.touchend),nn.container.removeEventListener("mouseout",hr.mouseout),nn.options.keybindings&&(nn.container.removeEventListener("keydown",hr.keydown),nn.container.removeEventListener("keyup",hr.keyup))},trash:function(jn){ii.trash(jn)},combineFeatures:function(){ii.combineFeatures()},uncombineFeatures:function(){ii.uncombineFeatures()},getMode:function(){return Ln}}}(ne),ne.ui=function(nn){var Xn={},rr=null,Yn={mode:null,feature:null,mouse:null},hr={mode:null,feature:null,mouse:null};function Ln(jn){hr=tn(hr,jn)}function ii(){var jn,kr;if(nn.container){var Ri=[],Qi=[];un.forEach(function(Mo){hr[Mo]!==Yn[Mo]&&(Ri.push(Mo+"-"+Yn[Mo]),hr[Mo]!==null&&Qi.push(Mo+"-"+hr[Mo]))}),Ri.length>0&&(jn=nn.container.classList).remove.apply(jn,Ri),Qi.length>0&&(kr=nn.container.classList).add.apply(kr,Qi),Yn=tn(Yn,hr)}}function Tr(jn,kr){kr===void 0&&(kr={});var Ri=document.createElement("button");return Ri.className=I.CONTROL_BUTTON+" "+kr.className,Ri.setAttribute("title",kr.title),kr.container.appendChild(Ri),Ri.addEventListener("click",function(Qi){if(Qi.preventDefault(),Qi.stopPropagation(),Qi.target===rr)return Kr(),void kr.onDeactivate();sr(jn),kr.onActivate()},!0),Ri}function Kr(){rr&&(rr.classList.remove(I.ACTIVE_BUTTON),rr=null)}function sr(jn){Kr();var kr=Xn[jn];kr&&kr&&jn!=="trash"&&(kr.classList.add(I.ACTIVE_BUTTON),rr=kr)}return{setActiveButton:sr,queueMapClasses:Ln,updateMapClasses:ii,clearMapClasses:function(){Ln({mode:null,feature:null,mouse:null}),ii()},addButtons:function(){var jn=nn.options.controls,kr=document.createElement("div");return kr.className=I.CONTROL_GROUP+" "+I.CONTROL_BASE,jn&&(jn[N.LINE]&&(Xn[N.LINE]=Tr(N.LINE,{container:kr,className:I.CONTROL_BUTTON_LINE,title:"LineString tool "+(nn.options.keybindings?"(l)":""),onActivate:function(){return nn.events.changeMode(W.DRAW_LINE_STRING)},onDeactivate:function(){return nn.events.trash()}})),jn[N.POLYGON]&&(Xn[N.POLYGON]=Tr(N.POLYGON,{container:kr,className:I.CONTROL_BUTTON_POLYGON,title:"Polygon tool "+(nn.options.keybindings?"(p)":""),onActivate:function(){return nn.events.changeMode(W.DRAW_POLYGON)},onDeactivate:function(){return nn.events.trash()}})),jn[N.POINT]&&(Xn[N.POINT]=Tr(N.POINT,{container:kr,className:I.CONTROL_BUTTON_POINT,title:"Marker tool "+(nn.options.keybindings?"(m)":""),onActivate:function(){return nn.events.changeMode(W.DRAW_POINT)},onDeactivate:function(){return nn.events.trash()}})),jn.trash&&(Xn.trash=Tr("trash",{container:kr,className:I.CONTROL_BUTTON_TRASH,title:"Delete",onActivate:function(){nn.events.trash()}})),jn.combine_features&&(Xn.combine_features=Tr("combineFeatures",{container:kr,className:I.CONTROL_BUTTON_COMBINE_FEATURES,title:"Combine",onActivate:function(){nn.events.combineFeatures()}})),jn.uncombine_features&&(Xn.uncombine_features=Tr("uncombineFeatures",{container:kr,className:I.CONTROL_BUTTON_UNCOMBINE_FEATURES,title:"Uncombine",onActivate:function(){nn.events.uncombineFeatures()}}))),kr},removeButtons:function(){Object.keys(Xn).forEach(function(jn){var kr=Xn[jn];kr.parentNode&&kr.parentNode.removeChild(kr),delete Xn[jn]})}}}(ne),ne.container=jt.getContainer(),ne.store=new gt(ne),Ce=ne.ui.addButtons(),ne.options.boxSelect&&(ne.boxZoomInitial=jt.boxZoom.isEnabled(),jt.boxZoom.disable(),jt.dragPan.disable(),jt.dragPan.enable()),jt.loaded()?kt.connect():(jt.on("load",kt.connect),et=setInterval(function(){jt.loaded()&&kt.connect()},16)),ne.events.start(),Ce},addLayers:function(){ne.map.addSource(P.COLD,{data:{type:j.FEATURE_COLLECTION,features:[]},type:"geojson"}),ne.map.addSource(P.HOT,{data:{type:j.FEATURE_COLLECTION,features:[]},type:"geojson"}),ne.options.styles.forEach(function(jt){ne.map.addLayer(jt)}),ne.store.setDirty(!0),ne.store.render()},removeLayers:function(){ne.options.styles.forEach(function(jt){ne.map.getLayer(jt.id)&&ne.map.removeLayer(jt.id)}),ne.map.getSource(P.COLD)&&ne.map.removeSource(P.COLD),ne.map.getSource(P.HOT)&&ne.map.removeSource(P.HOT)}};return ne.setup=kt,kt}var an=[{id:"gl-draw-polygon-fill-inactive",type:"fill",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],paint:{"fill-color":"#3bb2d0","fill-outline-color":"#3bb2d0","fill-opacity":.1}},{id:"gl-draw-polygon-fill-active",type:"fill",filter:["all",["==","active","true"],["==","$type","Polygon"]],paint:{"fill-color":"#fbb03b","fill-outline-color":"#fbb03b","fill-opacity":.1}},{id:"gl-draw-polygon-midpoint",type:"circle",filter:["all",["==","$type","Point"],["==","meta","midpoint"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-stroke-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-polygon-stroke-active",type:"line",filter:["all",["==","active","true"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-line-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","LineString"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-line-active",type:"line",filter:["all",["==","$type","LineString"],["==","active","true"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-polygon-and-line-vertex-stroke-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-color":"#fff"}},{id:"gl-draw-polygon-and-line-vertex-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-point-point-stroke-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-opacity":1,"circle-color":"#fff"}},{id:"gl-draw-point-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#3bb2d0"}},{id:"gl-draw-point-stroke-active",type:"circle",filter:["all",["==","$type","Point"],["==","active","true"],["!=","meta","midpoint"]],paint:{"circle-radius":7,"circle-color":"#fff"}},{id:"gl-draw-point-active",type:"circle",filter:["all",["==","$type","Point"],["!=","meta","midpoint"],["==","active","true"]],paint:{"circle-radius":5,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-fill-static",type:"fill",filter:["all",["==","mode","static"],["==","$type","Polygon"]],paint:{"fill-color":"#404040","fill-outline-color":"#404040","fill-opacity":.1}},{id:"gl-draw-polygon-stroke-static",type:"line",filter:["all",["==","mode","static"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-line-static",type:"line",filter:["all",["==","mode","static"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-point-static",type:"circle",filter:["all",["==","mode","static"],["==","$type","Point"]],paint:{"circle-radius":5,"circle-color":"#404040"}}];function Jt(ne){return function(Ce){var et=Ce.featureTarget;return!!et&&!!et.properties&&et.properties.meta===ne}}function Wt(ne){return!!ne.originalEvent&&!!ne.originalEvent.shiftKey&&ne.originalEvent.button===0}function Fn(ne){return!!ne.featureTarget&&!!ne.featureTarget.properties&&ne.featureTarget.properties.active===re.ACTIVE&&ne.featureTarget.properties.meta===Z.FEATURE}function ar(ne){return!!ne.featureTarget&&!!ne.featureTarget.properties&&ne.featureTarget.properties.active===re.INACTIVE&&ne.featureTarget.properties.meta===Z.FEATURE}function bn(ne){return ne.featureTarget===void 0}function lr(ne){return!!ne.featureTarget&&!!ne.featureTarget.properties&&ne.featureTarget.properties.meta===Z.FEATURE}function Cn(ne){var Ce=ne.featureTarget;return!!Ce&&!!Ce.properties&&Ce.properties.meta===Z.VERTEX}function xn(ne){return!!ne.originalEvent&&ne.originalEvent.shiftKey===!0}function Er(ne){return ne.keyCode===27}function Rr(ne){return ne.keyCode===13}var Wn=Object.freeze({__proto__:null,isOfMetaType:Jt,isShiftMousedown:Wt,isActiveFeature:Fn,isInactiveFeature:ar,noTarget:bn,isFeature:lr,isVertex:Cn,isShiftDown:xn,isEscapeKey:Er,isEnterKey:Rr,isTrue:function(){return!0}}),Mn=Ar;function Ar(ne,Ce){this.x=ne,this.y=Ce}Ar.prototype={clone:function(){return new Ar(this.x,this.y)},add:function(ne){return this.clone()._add(ne)},sub:function(ne){return this.clone()._sub(ne)},multByPoint:function(ne){return this.clone()._multByPoint(ne)},divByPoint:function(ne){return this.clone()._divByPoint(ne)},mult:function(ne){return this.clone()._mult(ne)},div:function(ne){return this.clone()._div(ne)},rotate:function(ne){return this.clone()._rotate(ne)},rotateAround:function(ne,Ce){return this.clone()._rotateAround(ne,Ce)},matMult:function(ne){return this.clone()._matMult(ne)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(ne){return this.x===ne.x&&this.y===ne.y},dist:function(ne){return Math.sqrt(this.distSqr(ne))},distSqr:function(ne){var Ce=ne.x-this.x,et=ne.y-this.y;return Ce*Ce+et*et},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(ne){return Math.atan2(this.y-ne.y,this.x-ne.x)},angleWith:function(ne){return this.angleWithSep(ne.x,ne.y)},angleWithSep:function(ne,Ce){return Math.atan2(this.x*Ce-this.y*ne,this.x*ne+this.y*Ce)},_matMult:function(ne){var Ce=ne[0]*this.x+ne[1]*this.y,et=ne[2]*this.x+ne[3]*this.y;return this.x=Ce,this.y=et,this},_add:function(ne){return this.x+=ne.x,this.y+=ne.y,this},_sub:function(ne){return this.x-=ne.x,this.y-=ne.y,this},_mult:function(ne){return this.x*=ne,this.y*=ne,this},_div:function(ne){return this.x/=ne,this.y/=ne,this},_multByPoint:function(ne){return this.x*=ne.x,this.y*=ne.y,this},_divByPoint:function(ne){return this.x/=ne.x,this.y/=ne.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var ne=this.y;return this.y=this.x,this.x=-ne,this},_rotate:function(ne){var Ce=Math.cos(ne),et=Math.sin(ne),kt=Ce*this.x-et*this.y,jt=et*this.x+Ce*this.y;return this.x=kt,this.y=jt,this},_rotateAround:function(ne,Ce){var et=Math.cos(ne),kt=Math.sin(ne),jt=Ce.x+et*(this.x-Ce.x)-kt*(this.y-Ce.y),Ut=Ce.y+kt*(this.x-Ce.x)+et*(this.y-Ce.y);return this.x=jt,this.y=Ut,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Ar.convert=function(ne){return ne instanceof Ar?ne:Array.isArray(ne)?new Ar(ne[0],ne[1]):ne};var fi=s(Mn);function yo(ne,Ce){var et=Ce.getBoundingClientRect();return new fi(ne.clientX-et.left-(Ce.clientLeft||0),ne.clientY-et.top-(Ce.clientTop||0))}function vr(ne,Ce,et,kt){return{type:j.FEATURE,properties:{meta:Z.VERTEX,parent:ne,coord_path:et,active:kt?re.ACTIVE:re.INACTIVE},geometry:{type:j.POINT,coordinates:Ce}}}function zi(ne,Ce,et){var kt=Ce.geometry.coordinates,jt=et.geometry.coordinates;if(kt[1]>85||kt[1]<_e||jt[1]>85||jt[1]<_e)return null;var Ut={lng:(kt[0]+jt[0])/2,lat:(kt[1]+jt[1])/2};return{type:j.FEATURE,properties:{meta:Z.MIDPOINT,parent:ne,lng:Ut.lng,lat:Ut.lat,coord_path:et.properties.coord_path},geometry:{type:j.POINT,coordinates:[Ut.lng,Ut.lat]}}}function Li(ne,Ce,et){Ce===void 0&&(Ce={}),et===void 0&&(et=null);var kt,jt=ne.geometry,Ut=jt.type,nn=jt.coordinates,Xn=ne.properties&&ne.properties.id,rr=[];function Yn(Ln,ii){var Tr="",Kr=null;Ln.forEach(function(sr,jn){var kr=ii!=null?ii+"."+jn:String(jn),Ri=vr(Xn,sr,kr,hr(kr));if(Ce.midpoints&&Kr){var Qi=zi(Xn,Kr,Ri);Qi&&rr.push(Qi)}Kr=Ri;var Mo=JSON.stringify(sr);Tr!==Mo&&rr.push(Ri),jn===0&&(Tr=Mo)})}function hr(Ln){return!!Ce.selectedPaths&&Ce.selectedPaths.indexOf(Ln)!==-1}return Ut===j.POINT?rr.push(vr(Xn,nn,et,hr(et))):Ut===j.POLYGON?nn.forEach(function(Ln,ii){Yn(Ln,et!==null?et+"."+ii:String(ii))}):Ut===j.LINE_STRING?Yn(nn,et):Ut.indexOf(j.MULTI_PREFIX)===0&&(kt=Ut.replace(j.MULTI_PREFIX,""),nn.forEach(function(Ln,ii){var Tr={type:j.FEATURE,properties:ne.properties,geometry:{type:kt,coordinates:Ln}};rr=rr.concat(Li(Tr,Ce,ii))})),rr}var mi={enable:function(ne){setTimeout(function(){ne.map&&ne.map.doubleClickZoom&&ne._ctx&&ne._ctx.store&&ne._ctx.store.getInitialConfigValue&&ne._ctx.store.getInitialConfigValue("doubleClickZoom")&&ne.map.doubleClickZoom.enable()},0)},disable:function(ne){setTimeout(function(){ne.map&&ne.map.doubleClickZoom&&ne.map.doubleClickZoom.disable()},0)}},ji={exports:{}},ko=function(ne){if(!ne||!ne.type)return null;var Ce=qo[ne.type];if(!Ce)return null;if(Ce==="geometry")return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:ne}]};if(Ce==="feature")return{type:"FeatureCollection",features:[ne]};if(Ce==="featurecollection")return ne},qo={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"},Oo=s(ko),Pn=Object.freeze({__proto__:null,default:function ne(Ce){switch(Ce&&Ce.type||null){case"FeatureCollection":return Ce.features=Ce.features.reduce(function(et,kt){return et.concat(ne(kt))},[]),Ce;case"Feature":return Ce.geometry?ne(Ce.geometry).map(function(et){var kt={type:"Feature",properties:JSON.parse(JSON.stringify(Ce.properties)),geometry:et};return Ce.id!==void 0&&(kt.id=Ce.id),kt}):[Ce];case"MultiPoint":return Ce.coordinates.map(function(et){return{type:"Point",coordinates:et}});case"MultiPolygon":return Ce.coordinates.map(function(et){return{type:"Polygon",coordinates:et}});case"MultiLineString":return Ce.coordinates.map(function(et){return{type:"LineString",coordinates:et}});case"GeometryCollection":return Ce.geometries.map(ne).reduce(function(et,kt){return et.concat(kt)},[]);case"Point":case"Polygon":case"LineString":return[Ce]}}}),Vt=ko,ze=a(Pn),Ve=function(ne){return function Ce(et){return Array.isArray(et)&&et.length&&typeof et[0]=="number"?[et]:et.reduce(function(kt,jt){return Array.isArray(jt)&&Array.isArray(jt[0])?kt.concat(Ce(jt)):(kt.push(jt),kt)},[])}(ne)};ze instanceof Function||(ze=ze.default);var at={exports:{}},_t=at.exports=function(ne){return new ht(ne)};function ht(ne){this.value=ne}function Mt(ne,Ce,et){var kt=[],jt=[],Ut=!0;return function nn(Xn){var rr=et?Xt(Xn):Xn,Yn={},hr=!0,Ln={node:rr,node_:Xn,path:[].concat(kt),parent:jt[jt.length-1],parents:jt,key:kt.slice(-1)[0],isRoot:kt.length===0,level:kt.length,circular:null,update:function(Kr,sr){Ln.isRoot||(Ln.parent.node[Ln.key]=Kr),Ln.node=Kr,sr&&(hr=!1)},delete:function(Kr){delete Ln.parent.node[Ln.key],Kr&&(hr=!1)},remove:function(Kr){Zt(Ln.parent.node)?Ln.parent.node.splice(Ln.key,1):delete Ln.parent.node[Ln.key],Kr&&(hr=!1)},keys:null,before:function(Kr){Yn.before=Kr},after:function(Kr){Yn.after=Kr},pre:function(Kr){Yn.pre=Kr},post:function(Kr){Yn.post=Kr},stop:function(){Ut=!1},block:function(){hr=!1}};if(!Ut)return Ln;function ii(){if(typeof Ln.node=="object"&&Ln.node!==null){Ln.keys&&Ln.node_===Ln.node||(Ln.keys=At(Ln.node)),Ln.isLeaf=Ln.keys.length==0;for(var Kr=0;Kr<jt.length;Kr++)if(jt[Kr].node_===Xn){Ln.circular=jt[Kr];break}}else Ln.isLeaf=!0,Ln.keys=null;Ln.notLeaf=!Ln.isLeaf,Ln.notRoot=!Ln.isRoot}ii();var Tr=Ce.call(Ln,Ln.node);return Tr!==void 0&&Ln.update&&Ln.update(Tr),Yn.before&&Yn.before.call(Ln,Ln.node),hr&&(typeof Ln.node!="object"||Ln.node===null||Ln.circular||(jt.push(Ln),ii(),Ht(Ln.keys,function(Kr,sr){kt.push(Kr),Yn.pre&&Yn.pre.call(Ln,Ln.node[Kr],Kr);var jn=nn(Ln.node[Kr]);et&&fn.call(Ln.node,Kr)&&(Ln.node[Kr]=jn.node),jn.isLast=sr==Ln.keys.length-1,jn.isFirst=sr==0,Yn.post&&Yn.post.call(Ln,jn),kt.pop()}),jt.pop()),Yn.after&&Yn.after.call(Ln,Ln.node)),Ln}(ne).node}function Xt(ne){if(typeof ne=="object"&&ne!==null){var Ce;if(Zt(ne))Ce=[];else if(Gt(ne)==="[object Date]")Ce=new Date(ne.getTime?ne.getTime():ne);else if(function(jt){return Gt(jt)==="[object RegExp]"}(ne))Ce=new RegExp(ne);else if(function(jt){return Gt(jt)==="[object Error]"}(ne))Ce={message:ne.message};else if(function(jt){return Gt(jt)==="[object Boolean]"}(ne))Ce=new Boolean(ne);else if(function(jt){return Gt(jt)==="[object Number]"}(ne))Ce=new Number(ne);else if(function(jt){return Gt(jt)==="[object String]"}(ne))Ce=new String(ne);else if(Object.create&&Object.getPrototypeOf)Ce=Object.create(Object.getPrototypeOf(ne));else if(ne.constructor===Object)Ce={};else{var et=ne.constructor&&ne.constructor.prototype||ne.__proto__||{},kt=function(){};kt.prototype=et,Ce=new kt}return Ht(At(ne),function(jt){Ce[jt]=ne[jt]}),Ce}return ne}ht.prototype.get=function(ne){for(var Ce=this.value,et=0;et<ne.length;et++){var kt=ne[et];if(!Ce||!fn.call(Ce,kt)){Ce=void 0;break}Ce=Ce[kt]}return Ce},ht.prototype.has=function(ne){for(var Ce=this.value,et=0;et<ne.length;et++){var kt=ne[et];if(!Ce||!fn.call(Ce,kt))return!1;Ce=Ce[kt]}return!0},ht.prototype.set=function(ne,Ce){for(var et=this.value,kt=0;kt<ne.length-1;kt++){var jt=ne[kt];fn.call(et,jt)||(et[jt]={}),et=et[jt]}return et[ne[kt]]=Ce,Ce},ht.prototype.map=function(ne){return Mt(this.value,ne,!0)},ht.prototype.forEach=function(ne){return this.value=Mt(this.value,ne,!1),this.value},ht.prototype.reduce=function(ne,Ce){var et=arguments.length===1,kt=et?this.value:Ce;return this.forEach(function(jt){this.isRoot&&et||(kt=ne.call(this,kt,jt))}),kt},ht.prototype.paths=function(){var ne=[];return this.forEach(function(Ce){ne.push(this.path)}),ne},ht.prototype.nodes=function(){var ne=[];return this.forEach(function(Ce){ne.push(this.node)}),ne},ht.prototype.clone=function(){var ne=[],Ce=[];return function et(kt){for(var jt=0;jt<ne.length;jt++)if(ne[jt]===kt)return Ce[jt];if(typeof kt=="object"&&kt!==null){var Ut=Xt(kt);return ne.push(kt),Ce.push(Ut),Ht(At(kt),function(nn){Ut[nn]=et(kt[nn])}),ne.pop(),Ce.pop(),Ut}return kt}(this.value)};var At=Object.keys||function(ne){var Ce=[];for(var et in ne)Ce.push(et);return Ce};function Gt(ne){return Object.prototype.toString.call(ne)}var Zt=Array.isArray||function(ne){return Object.prototype.toString.call(ne)==="[object Array]"},Ht=function(ne,Ce){if(ne.forEach)return ne.forEach(Ce);for(var et=0;et<ne.length;et++)Ce(ne[et],et,ne)};Ht(At(ht.prototype),function(ne){_t[ne]=function(Ce){var et=[].slice.call(arguments,1),kt=new ht(Ce);return kt[ne].apply(kt,et)}});var fn=Object.hasOwnProperty||function(ne,Ce){return Ce in ne},Nt=at.exports,zt=yn;function yn(ne){if(!(this instanceof yn))return new yn(ne);this._bbox=ne||[1/0,1/0,-1/0,-1/0],this._valid=!!ne}yn.prototype.include=function(ne){return this._valid=!0,this._bbox[0]=Math.min(this._bbox[0],ne[0]),this._bbox[1]=Math.min(this._bbox[1],ne[1]),this._bbox[2]=Math.max(this._bbox[2],ne[0]),this._bbox[3]=Math.max(this._bbox[3],ne[1]),this},yn.prototype.equals=function(ne){var Ce;return Ce=ne instanceof yn?ne.bbox():ne,this._bbox[0]==Ce[0]&&this._bbox[1]==Ce[1]&&this._bbox[2]==Ce[2]&&this._bbox[3]==Ce[3]},yn.prototype.center=function(ne){return this._valid?[(this._bbox[0]+this._bbox[2])/2,(this._bbox[1]+this._bbox[3])/2]:null},yn.prototype.union=function(ne){var Ce;return this._valid=!0,Ce=ne instanceof yn?ne.bbox():ne,this._bbox[0]=Math.min(this._bbox[0],Ce[0]),this._bbox[1]=Math.min(this._bbox[1],Ce[1]),this._bbox[2]=Math.max(this._bbox[2],Ce[2]),this._bbox[3]=Math.max(this._bbox[3],Ce[3]),this},yn.prototype.bbox=function(){return this._valid?this._bbox:null},yn.prototype.contains=function(ne){if(!ne)return this._fastContains();if(!this._valid)return null;var Ce=ne[0],et=ne[1];return this._bbox[0]<=Ce&&this._bbox[1]<=et&&this._bbox[2]>=Ce&&this._bbox[3]>=et},yn.prototype.intersect=function(ne){return this._valid?(Ce=ne instanceof yn?ne.bbox():ne,!(this._bbox[0]>Ce[2]||this._bbox[2]<Ce[0]||this._bbox[3]<Ce[1]||this._bbox[1]>Ce[3])):null;var Ce},yn.prototype._fastContains=function(){if(!this._valid)return new Function("return null;");var ne="return "+this._bbox[0]+"<= ll[0] &&"+this._bbox[1]+"<= ll[1] &&"+this._bbox[2]+">= ll[0] &&"+this._bbox[3]+">= ll[1]";return new Function("ll",ne)},yn.prototype.polygon=function(){return this._valid?{type:"Polygon",coordinates:[[[this._bbox[0],this._bbox[1]],[this._bbox[2],this._bbox[1]],[this._bbox[2],this._bbox[3]],[this._bbox[0],this._bbox[3]],[this._bbox[0],this._bbox[1]]]]}:null};var qn=function(ne){if(!ne)return[];var Ce=ze(Vt(ne)),et=[];return Ce.features.forEach(function(kt){kt.geometry&&(et=et.concat(Ve(kt.geometry.coordinates)))}),et},Jn=Nt,ur=zt,Cr={features:["FeatureCollection"],coordinates:["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],geometry:["Feature"],geometries:["GeometryCollection"]},Or=Object.keys(Cr);function Fr(ne){for(var Ce=ur(),et=qn(ne),kt=0;kt<et.length;kt++)Ce.include(et[kt]);return Ce}ji.exports=function(ne){return Fr(ne).bbox()},ji.exports.polygon=function(ne){return Fr(ne).polygon()},ji.exports.bboxify=function(ne){return Jn(ne).map(function(Ce){Ce&&Or.some(function(et){return!!Ce[et]&&Cr[et].indexOf(Ce.type)!==-1})&&(Ce.bbox=Fr(Ce).bbox(),this.update(Ce))})};var bi=s(ji.exports),Mi=-90;function Wi(ne,Ce){var et=Mi,kt=90,jt=Mi,Ut=90,nn=270,Xn=-270;ne.forEach(function(Yn){var hr=bi(Yn),Ln=hr[1],ii=hr[3],Tr=hr[0],Kr=hr[2];Ln>et&&(et=Ln),ii<kt&&(kt=ii),ii>jt&&(jt=ii),Ln<Ut&&(Ut=Ln),Tr<nn&&(nn=Tr),Kr>Xn&&(Xn=Kr)});var rr=Ce;return et+rr.lat>85&&(rr.lat=85-et),jt+rr.lat>90&&(rr.lat=90-jt),kt+rr.lat<-85&&(rr.lat=-85-kt),Ut+rr.lat<Mi&&(rr.lat=Mi-Ut),nn+rr.lng<=-270&&(rr.lng+=360*Math.ceil(Math.abs(rr.lng)/360)),Xn+rr.lng>=270&&(rr.lng-=360*Math.ceil(Math.abs(rr.lng)/360)),rr}function Ki(ne,Ce){var et=Wi(ne.map(function(kt){return kt.toGeoJSON()}),Ce);ne.forEach(function(kt){var jt,Ut=kt.getCoordinates(),nn=function(rr){var Yn={lng:rr[0]+et.lng,lat:rr[1]+et.lat};return[Yn.lng,Yn.lat]},Xn=function(rr){return rr.map(function(Yn){return nn(Yn)})};kt.type===j.POINT?jt=nn(Ut):kt.type===j.LINE_STRING||kt.type===j.MULTI_POINT?jt=Ut.map(nn):kt.type===j.POLYGON||kt.type===j.MULTI_LINE_STRING?jt=Ut.map(Xn):kt.type===j.MULTI_POLYGON&&(jt=Ut.map(function(rr){return rr.map(function(Yn){return Xn(Yn)})})),kt.incomingCoords(jt)})}var yi={onSetup:function(ne){var Ce=this,et={dragMoveLocation:null,boxSelectStartLocation:null,boxSelectElement:void 0,boxSelecting:!1,canBoxSelect:!1,dragMoving:!1,canDragMove:!1,initiallySelectedFeatureIds:ne.featureIds||[]};return this.setSelected(et.initiallySelectedFeatureIds.filter(function(kt){return Ce.getFeature(kt)!==void 0})),this.fireActionable(),this.setActionableState({combineFeatures:!0,uncombineFeatures:!0,trash:!0}),et},fireUpdate:function(){this.map.fire(H.UPDATE,{action:q.MOVE,features:this.getSelected().map(function(ne){return ne.toGeoJSON()})})},fireActionable:function(){var ne=this,Ce=this.getSelected(),et=Ce.filter(function(Xn){return ne.isInstanceOf("MultiFeature",Xn)}),kt=!1;if(Ce.length>1){kt=!0;var jt=Ce[0].type.replace("Multi","");Ce.forEach(function(Xn){Xn.type.replace("Multi","")!==jt&&(kt=!1)})}var Ut=et.length>0,nn=Ce.length>0;this.setActionableState({combineFeatures:kt,uncombineFeatures:Ut,trash:nn})},getUniqueIds:function(ne){return ne.length?ne.map(function(Ce){return Ce.properties.id}).filter(function(Ce){return Ce!==void 0}).reduce(function(Ce,et){return Ce.add(et),Ce},new he).values():[]},stopExtendedInteractions:function(ne){ne.boxSelectElement&&(ne.boxSelectElement.parentNode&&ne.boxSelectElement.parentNode.removeChild(ne.boxSelectElement),ne.boxSelectElement=null),this.map.dragPan.enable(),ne.boxSelecting=!1,ne.canBoxSelect=!1,ne.dragMoving=!1,ne.canDragMove=!1},onStop:function(){mi.enable(this)},onMouseMove:function(ne,Ce){return lr(Ce)&&ne.dragMoving&&this.fireUpdate(),this.stopExtendedInteractions(ne),!0},onMouseOut:function(ne){return!ne.dragMoving||this.fireUpdate()}};yi.onTap=yi.onClick=function(ne,Ce){return bn(Ce)?this.clickAnywhere(ne,Ce):Jt(Z.VERTEX)(Ce)?this.clickOnVertex(ne,Ce):lr(Ce)?this.clickOnFeature(ne,Ce):void 0},yi.clickAnywhere=function(ne){var Ce=this,et=this.getSelectedIds();et.length&&(this.clearSelectedFeatures(),et.forEach(function(kt){return Ce.doRender(kt)})),mi.enable(this),this.stopExtendedInteractions(ne)},yi.clickOnVertex=function(ne,Ce){this.changeMode(W.DIRECT_SELECT,{featureId:Ce.featureTarget.properties.parent,coordPath:Ce.featureTarget.properties.coord_path,startPos:Ce.lngLat}),this.updateUIClasses({mouse:D.MOVE})},yi.startOnActiveFeature=function(ne,Ce){this.stopExtendedInteractions(ne),this.map.dragPan.disable(),this.doRender(Ce.featureTarget.properties.id),ne.canDragMove=!0,ne.dragMoveLocation=Ce.lngLat},yi.clickOnFeature=function(ne,Ce){var et=this;mi.disable(this),this.stopExtendedInteractions(ne);var kt=xn(Ce),jt=this.getSelectedIds(),Ut=Ce.featureTarget.properties.id,nn=this.isSelected(Ut);if(!kt&&nn&&this.getFeature(Ut).type!==j.POINT)return this.changeMode(W.DIRECT_SELECT,{featureId:Ut});nn&&kt?(this.deselect(Ut),this.updateUIClasses({mouse:D.POINTER}),jt.length===1&&mi.enable(this)):!nn&&kt?(this.select(Ut),this.updateUIClasses({mouse:D.MOVE})):nn||kt||(jt.forEach(function(Xn){return et.doRender(Xn)}),this.setSelected(Ut),this.updateUIClasses({mouse:D.MOVE})),this.doRender(Ut)},yi.onMouseDown=function(ne,Ce){return Fn(Ce)?this.startOnActiveFeature(ne,Ce):this.drawConfig.boxSelect&&Wt(Ce)?this.startBoxSelect(ne,Ce):void 0},yi.startBoxSelect=function(ne,Ce){this.stopExtendedInteractions(ne),this.map.dragPan.disable(),ne.boxSelectStartLocation=yo(Ce.originalEvent,this.map.getContainer()),ne.canBoxSelect=!0},yi.onTouchStart=function(ne,Ce){if(Fn(Ce))return this.startOnActiveFeature(ne,Ce)},yi.onDrag=function(ne,Ce){return ne.canDragMove?this.dragMove(ne,Ce):this.drawConfig.boxSelect&&ne.canBoxSelect?this.whileBoxSelect(ne,Ce):void 0},yi.whileBoxSelect=function(ne,Ce){ne.boxSelecting=!0,this.updateUIClasses({mouse:D.ADD}),ne.boxSelectElement||(ne.boxSelectElement=document.createElement("div"),ne.boxSelectElement.classList.add(I.BOX_SELECT),this.map.getContainer().appendChild(ne.boxSelectElement));var et=yo(Ce.originalEvent,this.map.getContainer()),kt=Math.min(ne.boxSelectStartLocation.x,et.x),jt=Math.max(ne.boxSelectStartLocation.x,et.x),Ut=Math.min(ne.boxSelectStartLocation.y,et.y),nn=Math.max(ne.boxSelectStartLocation.y,et.y),Xn="translate("+kt+"px, "+Ut+"px)";ne.boxSelectElement.style.transform=Xn,ne.boxSelectElement.style.WebkitTransform=Xn,ne.boxSelectElement.style.width=jt-kt+"px",ne.boxSelectElement.style.height=nn-Ut+"px"},yi.dragMove=function(ne,Ce){ne.dragMoving=!0,Ce.originalEvent.stopPropagation();var et={lng:Ce.lngLat.lng-ne.dragMoveLocation.lng,lat:Ce.lngLat.lat-ne.dragMoveLocation.lat};Ki(this.getSelected(),et),ne.dragMoveLocation=Ce.lngLat},yi.onTouchEnd=yi.onMouseUp=function(ne,Ce){var et=this;if(ne.dragMoving)this.fireUpdate();else if(ne.boxSelecting){var kt=[ne.boxSelectStartLocation,yo(Ce.originalEvent,this.map.getContainer())],jt=this.featuresAt(null,kt,"click"),Ut=this.getUniqueIds(jt).filter(function(nn){return!et.isSelected(nn)});Ut.length&&(this.select(Ut),Ut.forEach(function(nn){return et.doRender(nn)}),this.updateUIClasses({mouse:D.MOVE}))}this.stopExtendedInteractions(ne)},yi.toDisplayFeatures=function(ne,Ce,et){Ce.properties.active=this.isSelected(Ce.properties.id)?re.ACTIVE:re.INACTIVE,et(Ce),this.fireActionable(),Ce.properties.active===re.ACTIVE&&Ce.geometry.type!==j.POINT&&Li(Ce).forEach(et)},yi.onTrash=function(){this.deleteFeature(this.getSelectedIds()),this.fireActionable()},yi.onCombineFeatures=function(){var ne=this.getSelected();if(!(ne.length===0||ne.length<2)){for(var Ce=[],et=[],kt=ne[0].type.replace("Multi",""),jt=0;jt<ne.length;jt++){var Ut=ne[jt];if(Ut.type.replace("Multi","")!==kt)return;Ut.type.includes("Multi")?Ut.getCoordinates().forEach(function(Xn){Ce.push(Xn)}):Ce.push(Ut.getCoordinates()),et.push(Ut.toGeoJSON())}if(et.length>1){var nn=this.newFeature({type:j.FEATURE,properties:et[0].properties,geometry:{type:"Multi"+kt,coordinates:Ce}});this.addFeature(nn),this.deleteFeature(this.getSelectedIds(),{silent:!0}),this.setSelected([nn.id]),this.map.fire(H.COMBINE_FEATURES,{createdFeatures:[nn.toGeoJSON()],deletedFeatures:et})}this.fireActionable()}},yi.onUncombineFeatures=function(){var ne=this,Ce=this.getSelected();if(Ce.length!==0){for(var et=[],kt=[],jt=function(nn){var Xn=Ce[nn];ne.isInstanceOf("MultiFeature",Xn)&&(Xn.getFeatures().forEach(function(rr){ne.addFeature(rr),rr.properties=Xn.properties,et.push(rr.toGeoJSON()),ne.select([rr.id])}),ne.deleteFeature(Xn.id,{silent:!0}),kt.push(Xn.toGeoJSON()))},Ut=0;Ut<Ce.length;Ut++)jt(Ut);et.length>1&&this.map.fire(H.UNCOMBINE_FEATURES,{createdFeatures:et,deletedFeatures:kt}),this.fireActionable()}};var bs=Jt(Z.VERTEX),Us=Jt(Z.MIDPOINT),ei={fireUpdate:function(){this.map.fire(H.UPDATE,{action:q.CHANGE_COORDINATES,features:this.getSelected().map(function(ne){return ne.toGeoJSON()})})},fireActionable:function(ne){this.setActionableState({combineFeatures:!1,uncombineFeatures:!1,trash:ne.selectedCoordPaths.length>0})},startDragging:function(ne,Ce){this.map.dragPan.disable(),ne.canDragMove=!0,ne.dragMoveLocation=Ce.lngLat},stopDragging:function(ne){this.map.dragPan.enable(),ne.dragMoving=!1,ne.canDragMove=!1,ne.dragMoveLocation=null},onVertex:function(ne,Ce){this.startDragging(ne,Ce);var et=Ce.featureTarget.properties,kt=ne.selectedCoordPaths.indexOf(et.coord_path);xn(Ce)||kt!==-1?xn(Ce)&&kt===-1&&ne.selectedCoordPaths.push(et.coord_path):ne.selectedCoordPaths=[et.coord_path];var jt=this.pathsToCoordinates(ne.featureId,ne.selectedCoordPaths);this.setSelectedCoordinates(jt)},onMidpoint:function(ne,Ce){this.startDragging(ne,Ce);var et=Ce.featureTarget.properties;ne.feature.addCoordinate(et.coord_path,et.lng,et.lat),this.fireUpdate(),ne.selectedCoordPaths=[et.coord_path]},pathsToCoordinates:function(ne,Ce){return Ce.map(function(et){return{feature_id:ne,coord_path:et}})},onFeature:function(ne,Ce){ne.selectedCoordPaths.length===0?this.startDragging(ne,Ce):this.stopDragging(ne)},dragFeature:function(ne,Ce,et){Ki(this.getSelected(),et),ne.dragMoveLocation=Ce.lngLat},dragVertex:function(ne,Ce,et){for(var kt=ne.selectedCoordPaths.map(function(Xn){return ne.feature.getCoordinate(Xn)}),jt=Wi(kt.map(function(Xn){return{type:j.FEATURE,properties:{},geometry:{type:j.POINT,coordinates:Xn}}}),et),Ut=0;Ut<kt.length;Ut++){var nn=kt[Ut];ne.feature.updateCoordinate(ne.selectedCoordPaths[Ut],nn[0]+jt.lng,nn[1]+jt.lat)}},clickNoTarget:function(){this.changeMode(W.SIMPLE_SELECT)},clickInactive:function(){this.changeMode(W.SIMPLE_SELECT)},clickActiveFeature:function(ne){ne.selectedCoordPaths=[],this.clearSelectedCoordinates(),ne.feature.changed()},onSetup:function(ne){var Ce=ne.featureId,et=this.getFeature(Ce);if(!et)throw new Error("You must provide a featureId to enter direct_select mode");if(et.type===j.POINT)throw new TypeError("direct_select mode doesn't handle point features");var kt={featureId:Ce,feature:et,dragMoveLocation:ne.startPos||null,dragMoving:!1,canDragMove:!1,selectedCoordPaths:ne.coordPath?[ne.coordPath]:[]};return this.setSelectedCoordinates(this.pathsToCoordinates(Ce,kt.selectedCoordPaths)),this.setSelected(Ce),mi.disable(this),this.setActionableState({trash:!0}),kt},onStop:function(){mi.enable(this),this.clearSelectedCoordinates()},toDisplayFeatures:function(ne,Ce,et){ne.featureId===Ce.properties.id?(Ce.properties.active=re.ACTIVE,et(Ce),Li(Ce,{map:this.map,midpoints:!0,selectedPaths:ne.selectedCoordPaths}).forEach(et)):(Ce.properties.active=re.INACTIVE,et(Ce)),this.fireActionable(ne)},onTrash:function(ne){ne.selectedCoordPaths.sort(function(Ce,et){return et.localeCompare(Ce,"en",{numeric:!0})}).forEach(function(Ce){return ne.feature.removeCoordinate(Ce)}),this.fireUpdate(),ne.selectedCoordPaths=[],this.clearSelectedCoordinates(),this.fireActionable(ne),ne.feature.isValid()===!1&&(this.deleteFeature([ne.featureId]),this.changeMode(W.SIMPLE_SELECT,{}))},onMouseMove:function(ne,Ce){var et=Fn(Ce),kt=bs(Ce),jt=Us(Ce),Ut=ne.selectedCoordPaths.length===0;return et&&Ut||kt&&!Ut?this.updateUIClasses({mouse:D.MOVE}):this.updateUIClasses({mouse:D.NONE}),(kt||et||jt)&&ne.dragMoving&&this.fireUpdate(),this.stopDragging(ne),!0},onMouseOut:function(ne){return ne.dragMoving&&this.fireUpdate(),!0}};ei.onTouchStart=ei.onMouseDown=function(ne,Ce){return bs(Ce)?this.onVertex(ne,Ce):Fn(Ce)?this.onFeature(ne,Ce):Us(Ce)?this.onMidpoint(ne,Ce):void 0},ei.onDrag=function(ne,Ce){if(ne.canDragMove===!0){ne.dragMoving=!0,Ce.originalEvent.stopPropagation();var et={lng:Ce.lngLat.lng-ne.dragMoveLocation.lng,lat:Ce.lngLat.lat-ne.dragMoveLocation.lat};ne.selectedCoordPaths.length>0?this.dragVertex(ne,Ce,et):this.dragFeature(ne,Ce,et),ne.dragMoveLocation=Ce.lngLat}},ei.onClick=function(ne,Ce){return bn(Ce)?this.clickNoTarget(ne,Ce):Fn(Ce)?this.clickActiveFeature(ne,Ce):ar(Ce)?this.clickInactive(ne,Ce):void this.stopDragging(ne)},ei.onTap=function(ne,Ce){return bn(Ce)?this.clickNoTarget(ne,Ce):Fn(Ce)?this.clickActiveFeature(ne,Ce):ar(Ce)?this.clickInactive(ne,Ce):void 0},ei.onTouchEnd=ei.onMouseUp=function(ne){ne.dragMoving&&this.fireUpdate(),this.stopDragging(ne)};var Ji={};function ns(ne,Ce){return!!ne.lngLat&&ne.lngLat.lng===Ce[0]&&ne.lngLat.lat===Ce[1]}Ji.onSetup=function(){var ne=this.newFeature({type:j.FEATURE,properties:{},geometry:{type:j.POINT,coordinates:[]}});return this.addFeature(ne),this.clearSelectedFeatures(),this.updateUIClasses({mouse:D.ADD}),this.activateUIButton(N.POINT),this.setActionableState({trash:!0}),{point:ne}},Ji.stopDrawingAndRemove=function(ne){this.deleteFeature([ne.point.id],{silent:!0}),this.changeMode(W.SIMPLE_SELECT)},Ji.onTap=Ji.onClick=function(ne,Ce){this.updateUIClasses({mouse:D.MOVE}),ne.point.updateCoordinate("",Ce.lngLat.lng,Ce.lngLat.lat),this.map.fire(H.CREATE,{features:[ne.point.toGeoJSON()]}),this.changeMode(W.SIMPLE_SELECT,{featureIds:[ne.point.id]})},Ji.onStop=function(ne){this.activateUIButton(),ne.point.getCoordinate().length||this.deleteFeature([ne.point.id],{silent:!0})},Ji.toDisplayFeatures=function(ne,Ce,et){var kt=Ce.properties.id===ne.point.id;if(Ce.properties.active=kt?re.ACTIVE:re.INACTIVE,!kt)return et(Ce)},Ji.onTrash=Ji.stopDrawingAndRemove,Ji.onKeyUp=function(ne,Ce){if(Er(Ce)||Rr(Ce))return this.stopDrawingAndRemove(ne,Ce)};var Xo={onSetup:function(){var ne=this.newFeature({type:j.FEATURE,properties:{},geometry:{type:j.POLYGON,coordinates:[[]]}});return this.addFeature(ne),this.clearSelectedFeatures(),mi.disable(this),this.updateUIClasses({mouse:D.ADD}),this.activateUIButton(N.POLYGON),this.setActionableState({trash:!0}),{polygon:ne,currentVertexPosition:0}},clickAnywhere:function(ne,Ce){if(ne.currentVertexPosition>0&&ns(Ce,ne.polygon.coordinates[0][ne.currentVertexPosition-1]))return this.changeMode(W.SIMPLE_SELECT,{featureIds:[ne.polygon.id]});this.updateUIClasses({mouse:D.ADD}),ne.polygon.updateCoordinate("0."+ne.currentVertexPosition,Ce.lngLat.lng,Ce.lngLat.lat),ne.currentVertexPosition++,ne.polygon.updateCoordinate("0."+ne.currentVertexPosition,Ce.lngLat.lng,Ce.lngLat.lat)},clickOnVertex:function(ne){return this.changeMode(W.SIMPLE_SELECT,{featureIds:[ne.polygon.id]})},onMouseMove:function(ne,Ce){ne.polygon.updateCoordinate("0."+ne.currentVertexPosition,Ce.lngLat.lng,Ce.lngLat.lat),Cn(Ce)&&this.updateUIClasses({mouse:D.POINTER})}};Xo.onTap=Xo.onClick=function(ne,Ce){return Cn(Ce)?this.clickOnVertex(ne,Ce):this.clickAnywhere(ne,Ce)},Xo.onKeyUp=function(ne,Ce){Er(Ce)?(this.deleteFeature([ne.polygon.id],{silent:!0}),this.changeMode(W.SIMPLE_SELECT)):Rr(Ce)&&this.changeMode(W.SIMPLE_SELECT,{featureIds:[ne.polygon.id]})},Xo.onStop=function(ne){this.updateUIClasses({mouse:D.NONE}),mi.enable(this),this.activateUIButton(),this.getFeature(ne.polygon.id)!==void 0&&(ne.polygon.removeCoordinate("0."+ne.currentVertexPosition),ne.polygon.isValid()?this.map.fire(H.CREATE,{features:[ne.polygon.toGeoJSON()]}):(this.deleteFeature([ne.polygon.id],{silent:!0}),this.changeMode(W.SIMPLE_SELECT,{},{silent:!0})))},Xo.toDisplayFeatures=function(ne,Ce,et){var kt=Ce.properties.id===ne.polygon.id;if(Ce.properties.active=kt?re.ACTIVE:re.INACTIVE,!kt)return et(Ce);if(Ce.geometry.coordinates.length!==0){var jt=Ce.geometry.coordinates[0].length;if(!(jt<3)){if(Ce.properties.meta=Z.FEATURE,et(vr(ne.polygon.id,Ce.geometry.coordinates[0][0],"0.0",!1)),jt>3){var Ut=Ce.geometry.coordinates[0].length-3;et(vr(ne.polygon.id,Ce.geometry.coordinates[0][Ut],"0."+Ut,!1))}if(jt<=4){var nn=[[Ce.geometry.coordinates[0][0][0],Ce.geometry.coordinates[0][0][1]],[Ce.geometry.coordinates[0][1][0],Ce.geometry.coordinates[0][1][1]]];if(et({type:j.FEATURE,properties:Ce.properties,geometry:{coordinates:nn,type:j.LINE_STRING}}),jt===3)return}return et(Ce)}}},Xo.onTrash=function(ne){this.deleteFeature([ne.polygon.id],{silent:!0}),this.changeMode(W.SIMPLE_SELECT)};var Rs={onSetup:function(ne){var Ce,et,kt=(ne=ne||{}).featureId,jt="forward";if(kt){if(!(Ce=this.getFeature(kt)))throw new Error("Could not find a feature with the provided featureId");var Ut=ne.from;if(Ut&&Ut.type==="Feature"&&Ut.geometry&&Ut.geometry.type==="Point"&&(Ut=Ut.geometry),Ut&&Ut.type==="Point"&&Ut.coordinates&&Ut.coordinates.length===2&&(Ut=Ut.coordinates),!Ut||!Array.isArray(Ut))throw new Error("Please use the `from` property to indicate which point to continue the line from");var nn=Ce.coordinates.length-1;if(Ce.coordinates[nn][0]===Ut[0]&&Ce.coordinates[nn][1]===Ut[1])et=nn+1,Ce.addCoordinate.apply(Ce,[et].concat(Ce.coordinates[nn]));else{if(Ce.coordinates[0][0]!==Ut[0]||Ce.coordinates[0][1]!==Ut[1])throw new Error("`from` should match the point at either the start or the end of the provided LineString");jt="backwards",et=0,Ce.addCoordinate.apply(Ce,[et].concat(Ce.coordinates[0]))}}else Ce=this.newFeature({type:j.FEATURE,properties:{},geometry:{type:j.LINE_STRING,coordinates:[]}}),et=0,this.addFeature(Ce);return this.clearSelectedFeatures(),mi.disable(this),this.updateUIClasses({mouse:D.ADD}),this.activateUIButton(N.LINE),this.setActionableState({trash:!0}),{line:Ce,currentVertexPosition:et,direction:jt}},clickAnywhere:function(ne,Ce){if(ne.currentVertexPosition>0&&ns(Ce,ne.line.coordinates[ne.currentVertexPosition-1])||ne.direction==="backwards"&&ns(Ce,ne.line.coordinates[ne.currentVertexPosition+1]))return this.changeMode(W.SIMPLE_SELECT,{featureIds:[ne.line.id]});this.updateUIClasses({mouse:D.ADD}),ne.line.updateCoordinate(ne.currentVertexPosition,Ce.lngLat.lng,Ce.lngLat.lat),ne.direction==="forward"?(ne.currentVertexPosition++,ne.line.updateCoordinate(ne.currentVertexPosition,Ce.lngLat.lng,Ce.lngLat.lat)):ne.line.addCoordinate(0,Ce.lngLat.lng,Ce.lngLat.lat)},clickOnVertex:function(ne){return this.changeMode(W.SIMPLE_SELECT,{featureIds:[ne.line.id]})},onMouseMove:function(ne,Ce){ne.line.updateCoordinate(ne.currentVertexPosition,Ce.lngLat.lng,Ce.lngLat.lat),Cn(Ce)&&this.updateUIClasses({mouse:D.POINTER})}};Rs.onTap=Rs.onClick=function(ne,Ce){if(Cn(Ce))return this.clickOnVertex(ne,Ce);this.clickAnywhere(ne,Ce)},Rs.onKeyUp=function(ne,Ce){Rr(Ce)?this.changeMode(W.SIMPLE_SELECT,{featureIds:[ne.line.id]}):Er(Ce)&&(this.deleteFeature([ne.line.id],{silent:!0}),this.changeMode(W.SIMPLE_SELECT))},Rs.onStop=function(ne){mi.enable(this),this.activateUIButton(),this.getFeature(ne.line.id)!==void 0&&(ne.line.removeCoordinate(""+ne.currentVertexPosition),ne.line.isValid()?this.map.fire(H.CREATE,{features:[ne.line.toGeoJSON()]}):(this.deleteFeature([ne.line.id],{silent:!0}),this.changeMode(W.SIMPLE_SELECT,{},{silent:!0})))},Rs.onTrash=function(ne){this.deleteFeature([ne.line.id],{silent:!0}),this.changeMode(W.SIMPLE_SELECT)},Rs.toDisplayFeatures=function(ne,Ce,et){var kt=Ce.properties.id===ne.line.id;if(Ce.properties.active=kt?re.ACTIVE:re.INACTIVE,!kt)return et(Ce);Ce.geometry.coordinates.length<2||(Ce.properties.meta=Z.FEATURE,et(vr(ne.line.id,Ce.geometry.coordinates[ne.direction==="forward"?Ce.geometry.coordinates.length-2:1],""+(ne.direction==="forward"?Ce.geometry.coordinates.length-2:1),!1)),et(Ce))};var ld={simple_select:yi,direct_select:ei,draw_point:Ji,draw_polygon:Xo,draw_line_string:Rs},Qd={defaultMode:W.SIMPLE_SELECT,keybindings:!0,touchEnabled:!0,clickBuffer:2,touchBuffer:25,boxSelect:!0,displayControlsDefault:!0,styles:an,modes:ld,controls:{},userProperties:!1},Cc={point:!0,line_string:!0,polygon:!0,trash:!0,combine_features:!0,uncombine_features:!0},lu={point:!1,line_string:!1,polygon:!1,trash:!1,combine_features:!1,uncombine_features:!1};function ea(ne,Ce){return ne.map(function(et){return et.source?et:tn(et,{id:et.id+"."+Ce,source:Ce==="hot"?P.HOT:P.COLD})})}var Os={exports:{}};(function(ne,Ce){var et="__lodash_hash_undefined__",kt=9007199254740991,jt="[object Arguments]",Ut="[object Array]",nn="[object Boolean]",Xn="[object Date]",rr="[object Error]",Yn="[object Function]",hr="[object Map]",Ln="[object Number]",ii="[object Object]",Tr="[object Promise]",Kr="[object RegExp]",sr="[object Set]",jn="[object String]",kr="[object Symbol]",Ri="[object WeakMap]",Qi="[object ArrayBuffer]",Mo="[object DataView]",ta=/^\[object .+?Constructor\]$/,On=/^(?:0|[1-9]\d*)$/,xr={};xr["[object Float32Array]"]=xr["[object Float64Array]"]=xr["[object Int8Array]"]=xr["[object Int16Array]"]=xr["[object Int32Array]"]=xr["[object Uint8Array]"]=xr["[object Uint8ClampedArray]"]=xr["[object Uint16Array]"]=xr["[object Uint32Array]"]=!0,xr[jt]=xr[Ut]=xr[Qi]=xr[nn]=xr[Mo]=xr[Xn]=xr[rr]=xr[Yn]=xr[hr]=xr[Ln]=xr[ii]=xr[Kr]=xr[sr]=xr[jn]=xr[Ri]=!1;var ai=typeof fl=="object"&&fl&&fl.Object===Object&&fl,Gs=typeof self=="object"&&self&&self.Object===Object&&self,oo=ai||Gs||Function("return this")(),ci=Ce&&!Ce.nodeType&&Ce,us=ci&&ne&&!ne.nodeType&&ne,Fl=us&&us.exports===ci,qa=Fl&&ai.process,ws=function(){try{return qa&&qa.binding&&qa.binding("util")}catch{}}(),co=ws&&ws.isTypedArray;function qh(rn,wn){for(var pr=-1,Pr=rn==null?0:rn.length;++pr<Pr;)if(wn(rn[pr],pr,rn))return!0;return!1}function uu(rn){var wn=-1,pr=Array(rn.size);return rn.forEach(function(Pr,Ti){pr[++wn]=[Ti,Pr]}),pr}function na(rn){var wn=-1,pr=Array(rn.size);return rn.forEach(function(Pr){pr[++wn]=Pr}),pr}var ra,Ec,_o,Yo=Array.prototype,Hs=Function.prototype,Xa=Object.prototype,Pa=oo["__core-js_shared__"],to=Hs.toString,So=Xa.hasOwnProperty,Zo=(ra=/[^.]+$/.exec(Pa&&Pa.keys&&Pa.keys.IE_PROTO||""))?"Symbol(src)_1."+ra:"",zo=Xa.toString,th=RegExp("^"+to.call(So).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),va=Fl?oo.Buffer:void 0,_l=oo.Symbol,Nl=oo.Uint8Array,Bl=Xa.propertyIsEnumerable,ud=Yo.splice,Ws=_l?_l.toStringTag:void 0,jl=Object.getOwnPropertySymbols,ia=va?va.isBuffer:void 0,oa=(Ec=Object.keys,_o=Object,function(rn){return Ec(_o(rn))}),cd=Aa(oo,"DataView"),Vl=Aa(oo,"Map"),Du=Aa(oo,"Promise"),vl=Aa(oo,"Set"),Ya=Aa(oo,"WeakMap"),zu=Aa(Object,"create"),qs=Sl(cd),$l=Sl(Vl),ca=Sl(Du),Za=Sl(vl),Xh=Sl(Ya),Fu=_l?_l.prototype:void 0,Ds=Fu?Fu.valueOf:void 0;function Hr(rn){var wn=-1,pr=rn==null?0:rn.length;for(this.clear();++wn<pr;){var Pr=rn[wn];this.set(Pr[0],Pr[1])}}function cr(rn){var wn=-1,pr=rn==null?0:rn.length;for(this.clear();++wn<pr;){var Pr=rn[wn];this.set(Pr[0],Pr[1])}}function xl(rn){var wn=-1,pr=rn==null?0:rn.length;for(this.clear();++wn<pr;){var Pr=rn[wn];this.set(Pr[0],Pr[1])}}function Dr(rn){var wn=-1,pr=rn==null?0:rn.length;for(this.__data__=new xl;++wn<pr;)this.add(rn[wn])}function Ka(rn){var wn=this.__data__=new cr(rn);this.size=wn.size}function Tc(rn,wn){var pr=Ja(rn),Pr=!pr&&nh(rn),Ti=!pr&&!Pr&&Nu(rn),di=!pr&&!Pr&&!Ti&&Xs(rn),U=pr||Pr||Ti||di,m=U?function(R,J){for(var ve=-1,Ie=Array(R);++ve<R;)Ie[ve]=J(ve);return Ie}(rn.length,String):[],b=m.length;for(var w in rn)!So.call(rn,w)||U&&(w=="length"||Ti&&(w=="offset"||w=="parent")||di&&(w=="buffer"||w=="byteLength"||w=="byteOffset")||ho(w,b))||m.push(w);return m}function Mr(rn,wn){for(var pr=rn.length;pr--;)if(Nn(rn[pr][0],wn))return pr;return-1}function cu(rn){return rn==null?rn===void 0?"[object Undefined]":"[object Null]":Ws&&Ws in Object(rn)?function(wn){var pr=So.call(wn,Ws),Pr=wn[Ws];try{wn[Ws]=void 0;var Ti=!0}catch{}var di=zo.call(wn);return Ti&&(pr?wn[Ws]=Pr:delete wn[Ws]),di}(rn):function(wn){return zo.call(wn)}(rn)}function Ic(rn){return Ul(rn)&&cu(rn)==jt}function dd(rn,wn,pr,Pr,Ti){return rn===wn||(rn==null||wn==null||!Ul(rn)&&!Ul(wn)?rn!=rn&&wn!=wn:function(di,U,m,b,w,R){var J=Ja(di),ve=Ja(U),Ie=J?Ut:zs(di),je=ve?Ut:zs(U),lt=(Ie=Ie==jt?ii:Ie)==ii,Ft=(je=je==jt?ii:je)==ii,Kt=Ie==je;if(Kt&&Nu(di)){if(!Nu(U))return!1;J=!0,lt=!1}if(Kt&&!lt)return R||(R=new Ka),J||Xs(di)?cs(di,U,m,b,w,R):function(Bn,wr,Pi,Vi,Ko,so,ti){switch(Pi){case Mo:if(Bn.byteLength!=wr.byteLength||Bn.byteOffset!=wr.byteOffset)return!1;Bn=Bn.buffer,wr=wr.buffer;case Qi:return!(Bn.byteLength!=wr.byteLength||!so(new Nl(Bn),new Nl(wr)));case nn:case Xn:case Ln:return Nn(+Bn,+wr);case rr:return Bn.name==wr.name&&Bn.message==wr.message;case Kr:case jn:return Bn==wr+"";case hr:var gs=uu;case sr:var xa=1&Vi;if(gs||(gs=na),Bn.size!=wr.size&&!xa)return!1;var el=ti.get(Bn);if(el)return el==wr;Vi|=2,ti.set(Bn,wr);var da=cs(gs(Bn),gs(wr),Vi,Ko,so,ti);return ti.delete(Bn),da;case kr:if(Ds)return Ds.call(Bn)==Ds.call(wr)}return!1}(di,U,Ie,m,b,w,R);if(!(1&m)){var En=lt&&So.call(di,"__wrapped__"),or=Ft&&So.call(U,"__wrapped__");if(En||or){var er=En?di.value():di,Nr=or?U.value():U;return R||(R=new Ka),w(er,Nr,m,b,R)}}return Kt?(R||(R=new Ka),function(Bn,wr,Pi,Vi,Ko,so){var ti=1&Pi,gs=kc(Bn),xa=gs.length,el=kc(wr).length;if(xa!=el&&!ti)return!1;for(var da=xa;da--;){var Fs=gs[da];if(!(ti?Fs in wr:So.call(wr,Fs)))return!1}var pd=so.get(Bn);if(pd&&so.get(wr))return pd==wr;var ju=!0;so.set(Bn,wr),so.set(wr,Bn);for(var Vu=ti;++da<xa;){var La=Bn[Fs=gs[da]],rh=wr[Fs];if(Vi)var Um=ti?Vi(rh,La,Fs,wr,Bn,so):Vi(La,rh,Fs,Bn,wr,so);if(!(Um===void 0?La===rh||Ko(La,rh,Pi,Vi,so):Um)){ju=!1;break}Vu||(Vu=Fs=="constructor")}if(ju&&!Vu){var Yh=Bn.constructor,Zh=wr.constructor;Yh==Zh||!("constructor"in Bn)||!("constructor"in wr)||typeof Yh=="function"&&Yh instanceof Yh&&typeof Zh=="function"&&Zh instanceof Zh||(ju=!1)}return so.delete(Bn),so.delete(wr),ju}(di,U,m,b,w,R)):!1}(rn,wn,pr,Pr,dd,Ti))}function bl(rn){return!(!Qa(rn)||function(wn){return!!Zo&&Zo in wn}(rn))&&(Bu(rn)?th:ta).test(Sl(rn))}function du(rn){if(pr=(wn=rn)&&wn.constructor,Pr=typeof pr=="function"&&pr.prototype||Xa,wn!==Pr)return oa(rn);var wn,pr,Pr,Ti=[];for(var di in Object(rn))So.call(rn,di)&&di!="constructor"&&Ti.push(di);return Ti}function cs(rn,wn,pr,Pr,Ti,di){var U=1&pr,m=rn.length,b=wn.length;if(m!=b&&!(U&&b>m))return!1;var w=di.get(rn);if(w&&di.get(wn))return w==wn;var R=-1,J=!0,ve=2&pr?new Dr:void 0;for(di.set(rn,wn),di.set(wn,rn);++R<m;){var Ie=rn[R],je=wn[R];if(Pr)var lt=U?Pr(je,Ie,R,wn,rn,di):Pr(Ie,je,R,rn,wn,di);if(lt!==void 0){if(lt)continue;J=!1;break}if(ve){if(!qh(wn,function(Ft,Kt){if(En=Kt,!ve.has(En)&&(Ie===Ft||Ti(Ie,Ft,pr,Pr,di)))return ve.push(Kt);var En})){J=!1;break}}else if(Ie!==je&&!Ti(Ie,je,pr,Pr,di)){J=!1;break}}return di.delete(rn),di.delete(wn),J}function kc(rn){return function(wn,pr,Pr){var Ti=pr(wn);return Ja(wn)?Ti:function(di,U){for(var m=-1,b=U.length,w=di.length;++m<b;)di[w+m]=U[m];return di}(Ti,Pr(wn))}(rn,fd,hd)}function wl(rn,wn){var pr,Pr,Ti=rn.__data__;return((Pr=typeof(pr=wn))=="string"||Pr=="number"||Pr=="symbol"||Pr=="boolean"?pr!=="__proto__":pr===null)?Ti[typeof wn=="string"?"string":"hash"]:Ti.map}function Aa(rn,wn){var pr=function(Pr,Ti){return Pr==null?void 0:Pr[Ti]}(rn,wn);return bl(pr)?pr:void 0}Hr.prototype.clear=function(){this.__data__=zu?zu(null):{},this.size=0},Hr.prototype.delete=function(rn){var wn=this.has(rn)&&delete this.__data__[rn];return this.size-=wn?1:0,wn},Hr.prototype.get=function(rn){var wn=this.__data__;if(zu){var pr=wn[rn];return pr===et?void 0:pr}return So.call(wn,rn)?wn[rn]:void 0},Hr.prototype.has=function(rn){var wn=this.__data__;return zu?wn[rn]!==void 0:So.call(wn,rn)},Hr.prototype.set=function(rn,wn){var pr=this.__data__;return this.size+=this.has(rn)?0:1,pr[rn]=zu&&wn===void 0?et:wn,this},cr.prototype.clear=function(){this.__data__=[],this.size=0},cr.prototype.delete=function(rn){var wn=this.__data__,pr=Mr(wn,rn);return!(pr<0)&&(pr==wn.length-1?wn.pop():ud.call(wn,pr,1),--this.size,!0)},cr.prototype.get=function(rn){var wn=this.__data__,pr=Mr(wn,rn);return pr<0?void 0:wn[pr][1]},cr.prototype.has=function(rn){return Mr(this.__data__,rn)>-1},cr.prototype.set=function(rn,wn){var pr=this.__data__,Pr=Mr(pr,rn);return Pr<0?(++this.size,pr.push([rn,wn])):pr[Pr][1]=wn,this},xl.prototype.clear=function(){this.size=0,this.__data__={hash:new Hr,map:new(Vl||cr),string:new Hr}},xl.prototype.delete=function(rn){var wn=wl(this,rn).delete(rn);return this.size-=wn?1:0,wn},xl.prototype.get=function(rn){return wl(this,rn).get(rn)},xl.prototype.has=function(rn){return wl(this,rn).has(rn)},xl.prototype.set=function(rn,wn){var pr=wl(this,rn),Pr=pr.size;return pr.set(rn,wn),this.size+=pr.size==Pr?0:1,this},Dr.prototype.add=Dr.prototype.push=function(rn){return this.__data__.set(rn,et),this},Dr.prototype.has=function(rn){return this.__data__.has(rn)},Ka.prototype.clear=function(){this.__data__=new cr,this.size=0},Ka.prototype.delete=function(rn){var wn=this.__data__,pr=wn.delete(rn);return this.size=wn.size,pr},Ka.prototype.get=function(rn){return this.__data__.get(rn)},Ka.prototype.has=function(rn){return this.__data__.has(rn)},Ka.prototype.set=function(rn,wn){var pr=this.__data__;if(pr instanceof cr){var Pr=pr.__data__;if(!Vl||Pr.length<199)return Pr.push([rn,wn]),this.size=++pr.size,this;pr=this.__data__=new xl(Pr)}return pr.set(rn,wn),this.size=pr.size,this};var hd=jl?function(rn){return rn==null?[]:(rn=Object(rn),function(wn,pr){for(var Pr=-1,Ti=wn==null?0:wn.length,di=0,U=[];++Pr<Ti;){var m=wn[Pr];pr(m,Pr,wn)&&(U[di++]=m)}return U}(jl(rn),function(wn){return Bl.call(rn,wn)}))}:function(){return[]},zs=cu;function ho(rn,wn){return!!(wn=wn??kt)&&(typeof rn=="number"||On.test(rn))&&rn>-1&&rn%1==0&&rn<wn}function Sl(rn){if(rn!=null){try{return to.call(rn)}catch{}try{return rn+""}catch{}}return""}function Nn(rn,wn){return rn===wn||rn!=rn&&wn!=wn}(cd&&zs(new cd(new ArrayBuffer(1)))!=Mo||Vl&&zs(new Vl)!=hr||Du&&zs(Du.resolve())!=Tr||vl&&zs(new vl)!=sr||Ya&&zs(new Ya)!=Ri)&&(zs=function(rn){var wn=cu(rn),pr=wn==ii?rn.constructor:void 0,Pr=pr?Sl(pr):"";if(Pr)switch(Pr){case qs:return Mo;case $l:return hr;case ca:return Tr;case Za:return sr;case Xh:return Ri}return wn});var nh=Ic(function(){return arguments}())?Ic:function(rn){return Ul(rn)&&So.call(rn,"callee")&&!Bl.call(rn,"callee")},Ja=Array.isArray,Nu=ia||function(){return!1};function Bu(rn){if(!Qa(rn))return!1;var wn=cu(rn);return wn==Yn||wn=="[object GeneratorFunction]"||wn=="[object AsyncFunction]"||wn=="[object Proxy]"}function hu(rn){return typeof rn=="number"&&rn>-1&&rn%1==0&&rn<=kt}function Qa(rn){var wn=typeof rn;return rn!=null&&(wn=="object"||wn=="function")}function Ul(rn){return rn!=null&&typeof rn=="object"}var Xs=co?function(rn){return function(wn){return rn(wn)}}(co):function(rn){return Ul(rn)&&hu(rn.length)&&!!xr[cu(rn)]};function fd(rn){return(wn=rn)!=null&&hu(wn.length)&&!Bu(wn)?Tc(rn):du(rn);var wn}ne.exports=function(rn,wn){return dd(rn,wn)}})(Os,Os.exports);var rs=s(Os.exports);function Do(ne,Ce){return ne.length===Ce.length&&JSON.stringify(ne.map(function(et){return et}).sort())===JSON.stringify(Ce.map(function(et){return et}).sort())}var Ma={Polygon:Bt,LineString:ft,Point:Ue,MultiPolygon:en,MultiLineString:en,MultiPoint:en},Wa=Object.freeze({__proto__:null,CommonSelectors:Wn,constrainFeatureMovement:Wi,createMidPoint:zi,createSupplementaryPoints:Li,createVertex:vr,doubleClickZoom:mi,euclideanDistance:Pe,featuresAt:se,getFeatureAtAndSetCursors:Se,isClick:Me,isEventAtCoordinates:ns,isTap:Re,mapEventToBoundingBox:xe,ModeHandler:n,moveFeatures:Ki,sortFeatures:oe,stringSetsAreEqual:Do,StringSet:he,theme:an,toDenseArray:Ae}),eh=function(ne,Ce){var et={options:ne=function(jt){jt===void 0&&(jt={});var Ut=tn(jt);return jt.controls||(Ut.controls={}),jt.displayControlsDefault===!1?Ut.controls=tn(lu,jt.controls):Ut.controls=tn(Cc,jt.controls),(Ut=tn(Qd,Ut)).styles=ea(Ut.styles,"cold").concat(ea(Ut.styles,"hot")),Ut}(ne)};Ce=function(jt,Ut){return Ut.modes=W,Ut.getFeatureIdsAt=function(nn){return se.click({point:nn},null,jt).map(function(Xn){return Xn.properties.id})},Ut.getSelectedIds=function(){return jt.store.getSelectedIds()},Ut.getSelected=function(){return{type:j.FEATURE_COLLECTION,features:jt.store.getSelectedIds().map(function(nn){return jt.store.get(nn)}).map(function(nn){return nn.toGeoJSON()})}},Ut.getSelectedPoints=function(){return{type:j.FEATURE_COLLECTION,features:jt.store.getSelectedCoordinates().map(function(nn){return{type:j.FEATURE,properties:{},geometry:{type:j.POINT,coordinates:nn.coordinates}}})}},Ut.set=function(nn){if(nn.type===void 0||nn.type!==j.FEATURE_COLLECTION||!Array.isArray(nn.features))throw new Error("Invalid FeatureCollection");var Xn=jt.store.createRenderBatch(),rr=jt.store.getAllIds().slice(),Yn=Ut.add(nn),hr=new he(Yn);return(rr=rr.filter(function(Ln){return!hr.has(Ln)})).length&&Ut.delete(rr),Xn(),Yn},Ut.add=function(nn){var Xn=JSON.parse(JSON.stringify(Oo(nn))).features.map(function(rr){if(rr.id=rr.id||Ke(),rr.geometry===null)throw new Error("Invalid geometry: null");if(jt.store.get(rr.id)===void 0||jt.store.get(rr.id).type!==rr.geometry.type){var Yn=Ma[rr.geometry.type];if(Yn===void 0)throw new Error("Invalid geometry type: "+rr.geometry.type+".");var hr=new Yn(jt,rr);jt.store.add(hr)}else{var Ln=jt.store.get(rr.id);Ln.properties=rr.properties,rs(Ln.properties,rr.properties)||jt.store.featureChanged(Ln.id),rs(Ln.getCoordinates(),rr.geometry.coordinates)||Ln.incomingCoords(rr.geometry.coordinates)}return rr.id});return jt.store.render(),Xn},Ut.get=function(nn){var Xn=jt.store.get(nn);if(Xn)return Xn.toGeoJSON()},Ut.getAll=function(){return{type:j.FEATURE_COLLECTION,features:jt.store.getAll().map(function(nn){return nn.toGeoJSON()})}},Ut.delete=function(nn){return jt.store.delete(nn,{silent:!0}),Ut.getMode()!==W.DIRECT_SELECT||jt.store.getSelectedIds().length?jt.store.render():jt.events.changeMode(W.SIMPLE_SELECT,void 0,{silent:!0}),Ut},Ut.deleteAll=function(){return jt.store.delete(jt.store.getAllIds(),{silent:!0}),Ut.getMode()===W.DIRECT_SELECT?jt.events.changeMode(W.SIMPLE_SELECT,void 0,{silent:!0}):jt.store.render(),Ut},Ut.changeMode=function(nn,Xn){return Xn===void 0&&(Xn={}),nn===W.SIMPLE_SELECT&&Ut.getMode()===W.SIMPLE_SELECT?(Do(Xn.featureIds||[],jt.store.getSelectedIds())||(jt.store.setSelected(Xn.featureIds,{silent:!0}),jt.store.render()),Ut):(nn===W.DIRECT_SELECT&&Ut.getMode()===W.DIRECT_SELECT&&Xn.featureId===jt.store.getSelectedIds()[0]||jt.events.changeMode(nn,Xn,{silent:!0}),Ut)},Ut.getMode=function(){return jt.events.getMode()},Ut.trash=function(){return jt.events.trash({silent:!0}),Ut},Ut.combineFeatures=function(){return jt.events.combineFeatures({silent:!0}),Ut},Ut.uncombineFeatures=function(){return jt.events.uncombineFeatures({silent:!0}),Ut},Ut.setFeatureProperty=function(nn,Xn,rr){return jt.store.setFeatureProperty(nn,Xn,rr),Ut},Ut}(et,Ce),et.api=Ce;var kt=qt(et);return Ce.onAdd=kt.onAdd,Ce.onRemove=kt.onRemove,Ce.types=N,Ce.options=ne,Ce};function Ou(ne){eh(ne,this)}return Ou.modes=ld,Ou.constants=ye,Ou.lib=Wa,Ou})})(K6);var BH=K6.exports;const jH=yc(BH);var Fa=[];for(var sk=0;sk<256;++sk)Fa.push((sk+256).toString(16).slice(1));function VH(e,t=0){return(Fa[e[t+0]]+Fa[e[t+1]]+Fa[e[t+2]]+Fa[e[t+3]]+"-"+Fa[e[t+4]]+Fa[e[t+5]]+"-"+Fa[e[t+6]]+Fa[e[t+7]]+"-"+Fa[e[t+8]]+Fa[e[t+9]]+"-"+Fa[e[t+10]]+Fa[e[t+11]]+Fa[e[t+12]]+Fa[e[t+13]]+Fa[e[t+14]]+Fa[e[t+15]]).toLowerCase()}var pw,$H=new Uint8Array(16);function UH(){if(!pw&&(pw=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!pw))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return pw($H)}var GH=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const M5={randomUUID:GH};function J6(e,t,n){if(M5.randomUUID&&!t&&!e)return M5.randomUUID();e=e||{};var s=e.random||(e.rng||UH)();return s[6]=s[6]&15|64,s[8]=s[8]&63|128,VH(s)}const nd=()=>{const e=Math.floor(Math.random()*360),t=50+Math.random()*50,n=40+Math.random()*40;return HH(e,t,n)},HH=(e,t,n)=>{n/=100;const s=t*Math.min(n,1-n)/100,a=u=>{const f=(u+e/30)%12,_=n-s*Math.max(Math.min(f-3,9-f,1),-1);return Math.round(255*_).toString(16).padStart(2,"0")};return`#${a(0)}${a(8)}${a(4)}`};var Yl=63710088e-1,Q6={centimeters:Yl*100,centimetres:Yl*100,degrees:360/(2*Math.PI),feet:Yl*3.28084,inches:Yl*39.37,kilometers:Yl/1e3,kilometres:Yl/1e3,meters:Yl,metres:Yl,miles:Yl/1609.344,millimeters:Yl*1e3,millimetres:Yl*1e3,nauticalmiles:Yl/1852,radians:1,yards:Yl*1.0936};function rd(e,t,n={}){const s={type:"Feature"};return(n.id===0||n.id)&&(s.id=n.id),n.bbox&&(s.bbox=n.bbox),s.properties=t||{},s.geometry=e,s}function Ay(e,t,n={}){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!P5(e[0])||!P5(e[1]))throw new Error("coordinates must contain numbers");return rd({type:"Point",coordinates:e},t,n)}function y0(e,t,n={}){for(const a of e){if(a.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(a[a.length-1].length!==a[0].length)throw new Error("First and last Position are not equivalent.");for(let u=0;u<a[a.length-1].length;u++)if(a[a.length-1][u]!==a[0][u])throw new Error("First and last Position are not equivalent.")}return rd({type:"Polygon",coordinates:e},t,n)}function qc(e,t,n={}){if(e.length<2)throw new Error("coordinates must be an array of two or more positions");return rd({type:"LineString",coordinates:e},t,n)}function ya(e,t={}){const n={type:"FeatureCollection"};return t.id&&(n.id=t.id),t.bbox&&(n.bbox=t.bbox),n.features=e,n}function WH(e,t,n={}){return rd({type:"MultiLineString",coordinates:e},t,n)}function qH(e,t,n={}){return rd({type:"MultiPoint",coordinates:e},t,n)}function Mx(e,t,n={}){return rd({type:"MultiPolygon",coordinates:e},t,n)}function e3(e,t="kilometers"){const n=Q6[t];if(!n)throw new Error(t+" units is invalid");return e*n}function t3(e,t="kilometers"){const n=Q6[t];if(!n)throw new Error(t+" units is invalid");return e/n}function jM(e){return e%(2*Math.PI)*180/Math.PI}function Xc(e){return e%360*Math.PI/180}function P5(e){return!isNaN(e)&&e!==null&&!Array.isArray(e)}function B2(e){return e!==null&&typeof e=="object"&&!Array.isArray(e)}function $d(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return[...e.geometry.coordinates];if(e.type==="Point")return[...e.coordinates]}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return[...e];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function gm(e){if(Array.isArray(e))return e;if(e.type==="Feature"){if(e.geometry!==null)return e.geometry.coordinates}else if(e.coordinates)return e.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function n3(e,t,n){if(!e)throw new Error("No featureCollection passed");if(!n)throw new Error(".collectionOf() requires a name");if(!e||e.type!=="FeatureCollection")throw new Error("Invalid input to "+n+", FeatureCollection required");for(const s of e.features){if(!s||s.type!=="Feature"||!s.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!s.geometry||s.geometry.type!==t)throw new Error("Invalid input to "+n+": must be a "+t+", given "+s.geometry.type)}}function Xy(e){return e.type==="Feature"?e.geometry:e}function A5(e,t){return e.type==="FeatureCollection"?"FeatureCollection":e.type==="GeometryCollection"?"GeometryCollection":e.type==="Feature"&&e.geometry!==null?e.geometry.type:e.type}function r3(e,t,n={}){if(n.final===!0)return XH(e,t);const s=$d(e),a=$d(t),u=Xc(s[0]),f=Xc(a[0]),_=Xc(s[1]),r=Xc(a[1]),C=Math.sin(f-u)*Math.cos(r),k=Math.cos(_)*Math.sin(r)-Math.sin(_)*Math.cos(r)*Math.cos(f-u);return jM(Math.atan2(C,k))}function XH(e,t){let n=r3(t,e);return n=(n+180)%360,n}function L5(e,t,n,s={}){const a=$d(e),u=Xc(a[0]),f=Xc(a[1]),_=Xc(n),r=t3(t,s.units),C=Math.asin(Math.sin(f)*Math.cos(r)+Math.cos(f)*Math.sin(r)*Math.cos(_)),k=u+Math.atan2(Math.sin(_)*Math.sin(r)*Math.cos(f),Math.cos(r)-Math.sin(f)*Math.sin(C)),I=jM(k),P=jM(C);return Ay([I,P],s.properties)}function sm(e,t,n={}){var s=$d(e),a=$d(t),u=Xc(a[1]-s[1]),f=Xc(a[0]-s[0]),_=Xc(s[1]),r=Xc(a[1]),C=Math.pow(Math.sin(u/2),2)+Math.pow(Math.sin(f/2),2)*Math.cos(_)*Math.cos(r);return e3(2*Math.atan2(Math.sqrt(C),Math.sqrt(1-C)),n.units)}function GC(e,t,n){if(e!==null)for(var s,a,u,f,_,r,C,k=0,I=0,P,D=e.type,N=D==="FeatureCollection",j=D==="Feature",W=N?e.features.length:1,H=0;H<W;H++){C=N?e.features[H].geometry:j?e.geometry:e,P=C?C.type==="GeometryCollection":!1,_=P?C.geometries.length:1;for(var q=0;q<_;q++){var Z=0,re=0;if(f=P?C.geometries[q]:C,f!==null){r=f.coordinates;var le=f.type;switch(k=0,le){case null:break;case"Point":if(t(r,I,H,Z,re)===!1)return!1;I++,Z++;break;case"LineString":case"MultiPoint":for(s=0;s<r.length;s++){if(t(r[s],I,H,Z,re)===!1)return!1;I++,le==="MultiPoint"&&Z++}le==="LineString"&&Z++;break;case"Polygon":case"MultiLineString":for(s=0;s<r.length;s++){for(a=0;a<r[s].length-k;a++){if(t(r[s][a],I,H,Z,re)===!1)return!1;I++}le==="MultiLineString"&&Z++,le==="Polygon"&&re++}le==="Polygon"&&Z++;break;case"MultiPolygon":for(s=0;s<r.length;s++){for(re=0,a=0;a<r[s].length;a++){for(u=0;u<r[s][a].length-k;u++){if(t(r[s][a][u],I,H,Z,re)===!1)return!1;I++}re++}Z++}break;case"GeometryCollection":for(s=0;s<f.geometries.length;s++)if(GC(f.geometries[s],t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function rp(e,t){if(e.type==="Feature")t(e,0);else if(e.type==="FeatureCollection")for(var n=0;n<e.features.length&&t(e.features[n],n)!==!1;n++);}function YH(e,t,n){var s=n;return rp(e,function(a,u){u===0&&n===void 0?s=a:s=t(s,a,u)}),s}function ip(e,t){var n,s,a,u,f,_,r,C,k,I,P=0,D=e.type==="FeatureCollection",N=e.type==="Feature",j=D?e.features.length:1;for(n=0;n<j;n++){for(_=D?e.features[n].geometry:N?e.geometry:e,C=D?e.features[n].properties:N?e.properties:{},k=D?e.features[n].bbox:N?e.bbox:void 0,I=D?e.features[n].id:N?e.id:void 0,r=_?_.type==="GeometryCollection":!1,f=r?_.geometries.length:1,a=0;a<f;a++){if(u=r?_.geometries[a]:_,u===null){if(t(null,P,C,k,I)===!1)return!1;continue}switch(u.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(t(u,P,C,k,I)===!1)return!1;break}case"GeometryCollection":{for(s=0;s<u.geometries.length;s++)if(t(u.geometries[s],P,C,k,I)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}P++}}function op(e,t){ip(e,function(n,s,a,u,f){var _=n===null?null:n.type;switch(_){case null:case"Point":case"LineString":case"Polygon":return t(rd(n,a,{bbox:u,id:f}),s,0)===!1?!1:void 0}var r;switch(_){case"MultiPoint":r="Point";break;case"MultiLineString":r="LineString";break;case"MultiPolygon":r="Polygon";break}for(var C=0;C<n.coordinates.length;C++){var k=n.coordinates[C],I={type:r,coordinates:k};if(t(rd(I,a),s,C)===!1)return!1}})}function dl(e,t={}){if(e.bbox!=null&&t.recompute!==!0)return e.bbox;const n=[1/0,1/0,-1/0,-1/0];return GC(e,s=>{n[0]>s[0]&&(n[0]=s[0]),n[1]>s[1]&&(n[1]=s[1]),n[2]<s[0]&&(n[2]=s[0]),n[3]<s[1]&&(n[3]=s[1])}),n}function ZH(e,t={}){const n=Number(e[0]),s=Number(e[1]),a=Number(e[2]),u=Number(e[3]);if(e.length===6)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");const f=[n,s];return y0([[f,[a,s],[a,u],[n,u],f]],t.properties,{bbox:e,id:t.id})}function KH(e,t){var n=0,s=0,a=0,u=0,f=0,_=0,r=0,C=0,k=null,I=null,P=e[0],D=e[1],N=t.length;for(n;n<N;n++){s=0;var j=t[n].length-1,W=t[n];if(k=W[0],k[0]!==W[j][0]&&k[1]!==W[j][1])throw new Error("First and last coordinates in a ring must be the same");for(f=k[0]-P,_=k[1]-D,s;s<j;s++){if(I=W[s+1],C=I[1]-D,_<0&&C<0||_>0&&C>0){k=I,_=C,f=k[0]-P;continue}if(r=I[0]-e[0],C>0&&_<=0){if(u=f*C-r*_,u>0)a=a+1;else if(u===0)return 0}else if(_>0&&C<=0){if(u=f*C-r*_,u<0)a=a+1;else if(u===0)return 0}else if(C===0&&_<0){if(u=f*C-r*_,u===0)return 0}else if(_===0&&C<0){if(u=f*C-r*_,u===0)return 0}else if(_===0&&C===0){if(r<=0&&f>=0)return 0;if(f<=0&&r>=0)return 0}k=I,_=C,f=r}}return a%2!==0}function ru(e,t,n={}){if(!e)throw new Error("point is required");if(!t)throw new Error("polygon is required");const s=$d(e),a=Xy(t),u=a.type,f=t.bbox;let _=a.coordinates;if(f&&JH(s,f)===!1)return!1;u==="Polygon"&&(_=[_]);let r=!1;for(var C=0;C<_.length;++C){const k=KH(s,_[C]);if(k===0)return!n.ignoreBoundary;k&&(r=!0)}return r}function JH(e,t){return t[0]<=e[0]&&t[1]<=e[1]&&t[2]>=e[0]&&t[3]>=e[1]}function WS(e,t,n={}){const s=$d(e),a=gm(t);for(let u=0;u<a.length-1;u++){let f=!1;if(n.ignoreEndVertices&&(u===0&&(f="start"),u===a.length-2&&(f="end"),u===0&&u+1===a.length-1&&(f="both")),QH(a[u],a[u+1],s,f,typeof n.epsilon>"u"?null:n.epsilon))return!0}return!1}function QH(e,t,n,s,a){const u=n[0],f=n[1],_=e[0],r=e[1],C=t[0],k=t[1],I=n[0]-_,P=n[1]-r,D=C-_,N=k-r,j=I*N-P*D;if(a!==null){if(Math.abs(j)>a)return!1}else if(j!==0)return!1;if(s){if(s==="start")return Math.abs(D)>=Math.abs(N)?D>0?_<u&&u<=C:C<=u&&u<_:N>0?r<f&&f<=k:k<=f&&f<r;if(s==="end")return Math.abs(D)>=Math.abs(N)?D>0?_<=u&&u<C:C<u&&u<=_:N>0?r<=f&&f<k:k<f&&f<=r;if(s==="both")return Math.abs(D)>=Math.abs(N)?D>0?_<u&&u<C:C<u&&u<_:N>0?r<f&&f<k:k<f&&f<r}else return Math.abs(D)>=Math.abs(N)?D>0?_<=u&&u<=C:C<=u&&u<=_:N>0?r<=f&&f<=k:k<=f&&f<=r;return!1}class i3{constructor(t=[],n=eW){if(this.data=t,this.length=this.data.length,this.compare=n,this.length>0)for(let s=(this.length>>1)-1;s>=0;s--)this._down(s)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const t=this.data[0],n=this.data.pop();return this.length--,this.length>0&&(this.data[0]=n,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:n,compare:s}=this,a=n[t];for(;t>0;){const u=t-1>>1,f=n[u];if(s(a,f)>=0)break;n[t]=f,t=u}n[t]=a}_down(t){const{data:n,compare:s}=this,a=this.length>>1,u=n[t];for(;t<a;){let f=(t<<1)+1,_=n[f];const r=f+1;if(r<this.length&&s(n[r],_)<0&&(f=r,_=n[r]),s(_,u)>=0)break;n[t]=_,t=f}n[t]=u}}function eW(e,t){return e<t?-1:e>t?1:0}function o3(e,t){return e.p.x>t.p.x?1:e.p.x<t.p.x?-1:e.p.y!==t.p.y?e.p.y>t.p.y?1:-1:1}function tW(e,t){return e.rightSweepEvent.p.x>t.rightSweepEvent.p.x?1:e.rightSweepEvent.p.x<t.rightSweepEvent.p.x?-1:e.rightSweepEvent.p.y!==t.rightSweepEvent.p.y?e.rightSweepEvent.p.y<t.rightSweepEvent.p.y?1:-1:1}let R5=class{constructor(t,n,s,a){this.p={x:t[0],y:t[1]},this.featureId=n,this.ringId=s,this.eventId=a,this.otherEvent=null,this.isLeftEndpoint=null}isSamePoint(t){return this.p.x===t.p.x&&this.p.y===t.p.y}};function nW(e,t){if(e.type==="FeatureCollection"){const n=e.features;for(let s=0;s<n.length;s++)O5(n[s],t)}else O5(e,t)}let mw=0,gw=0,yw=0;function O5(e,t){const n=e.type==="Feature"?e.geometry:e;let s=n.coordinates;(n.type==="Polygon"||n.type==="MultiLineString")&&(s=[s]),n.type==="LineString"&&(s=[[s]]);for(let a=0;a<s.length;a++)for(let u=0;u<s[a].length;u++){let f=s[a][u][0],_=null;gw=gw+1;for(let r=0;r<s[a][u].length-1;r++){_=s[a][u][r+1];const C=new R5(f,mw,gw,yw),k=new R5(_,mw,gw,yw+1);C.otherEvent=k,k.otherEvent=C,o3(C,k)>0?(k.isLeftEndpoint=!0,C.isLeftEndpoint=!1):(C.isLeftEndpoint=!0,k.isLeftEndpoint=!1),t.push(C),t.push(k),f=_,yw=yw+1}}mw=mw+1}let rW=class{constructor(t){this.leftSweepEvent=t,this.rightSweepEvent=t.otherEvent}};function iW(e,t){if(e===null||t===null||e.leftSweepEvent.ringId===t.leftSweepEvent.ringId&&(e.rightSweepEvent.isSamePoint(t.leftSweepEvent)||e.rightSweepEvent.isSamePoint(t.leftSweepEvent)||e.rightSweepEvent.isSamePoint(t.rightSweepEvent)||e.leftSweepEvent.isSamePoint(t.leftSweepEvent)||e.leftSweepEvent.isSamePoint(t.rightSweepEvent)))return!1;const n=e.leftSweepEvent.p.x,s=e.leftSweepEvent.p.y,a=e.rightSweepEvent.p.x,u=e.rightSweepEvent.p.y,f=t.leftSweepEvent.p.x,_=t.leftSweepEvent.p.y,r=t.rightSweepEvent.p.x,C=t.rightSweepEvent.p.y,k=(C-_)*(a-n)-(r-f)*(u-s),I=(r-f)*(s-_)-(C-_)*(n-f),P=(a-n)*(s-_)-(u-s)*(n-f);if(k===0)return!1;const D=I/k,N=P/k;if(D>=0&&D<=1&&N>=0&&N<=1){const j=n+D*(a-n),W=s+D*(u-s);return[j,W]}return!1}function oW(e,t){t=t||!1;const n=[],s=new i3([],tW);for(;e.length;){const a=e.pop();if(a.isLeftEndpoint){const u=new rW(a);for(let f=0;f<s.data.length;f++){const _=s.data[f];if(t&&_.leftSweepEvent.featureId===a.featureId)continue;const r=iW(u,_);r!==!1&&n.push(r)}s.push(u)}else a.isLeftEndpoint===!1&&s.pop()}return n}function sW(e,t){const n=new i3([],o3);return nW(e,n),oW(n,t)}var aW=sW;function _0(e,t,n={}){const{removeDuplicates:s=!0,ignoreSelfIntersections:a=!1}=n;let u=[];e.type==="FeatureCollection"?u=u.concat(e.features):e.type==="Feature"?u.push(e):(e.type==="LineString"||e.type==="Polygon"||e.type==="MultiLineString"||e.type==="MultiPolygon")&&u.push(rd(e)),t.type==="FeatureCollection"?u=u.concat(t.features):t.type==="Feature"?u.push(t):(t.type==="LineString"||t.type==="Polygon"||t.type==="MultiLineString"||t.type==="MultiPolygon")&&u.push(rd(t));const f=aW(ya(u),a);let _=[];if(s){const r={};f.forEach(C=>{const k=C.join(",");r[k]||(r[k]=!0,_.push(C))})}else _=f;return ya(_.map(r=>Ay(r)))}function VM(e,t={}){const n=Xy(e);switch(!t.properties&&e.type==="Feature"&&(t.properties=e.properties),n.type){case"Polygon":return lW(n,t);case"MultiPolygon":return uW(n,t);default:throw new Error("invalid poly")}}function lW(e,t={}){const s=Xy(e).coordinates,a=t.properties?t.properties:e.type==="Feature"?e.properties:{};return s3(s,a)}function uW(e,t={}){const s=Xy(e).coordinates,a=t.properties?t.properties:e.type==="Feature"?e.properties:{},u=[];return s.forEach(f=>{u.push(s3(f,a))}),ya(u)}function s3(e,t){return e.length>1?WH(e,t):qc(e[0],t)}function cW(e,t,n={}){var s;const a=(s=n.ignoreSelfIntersections)!=null?s:!1;let u=!0;return op(e,f=>{op(t,_=>{if(u===!1)return!1;u=dW(f.geometry,_.geometry,a)})}),u}function dW(e,t,n){switch(e.type){case"Point":switch(t.type){case"Point":return!mW(e.coordinates,t.coordinates);case"LineString":return!D5(t,e);case"Polygon":return!ru(e,t)}break;case"LineString":switch(t.type){case"Point":return!D5(e,t);case"LineString":return!hW(e,t,n);case"Polygon":return!z5(t,e,n)}break;case"Polygon":switch(t.type){case"Point":return!ru(t,e);case"LineString":return!z5(e,t,n);case"Polygon":return!fW(t,e,n)}}return!1}function D5(e,t){for(let n=0;n<e.coordinates.length-1;n++)if(pW(e.coordinates[n],e.coordinates[n+1],t.coordinates))return!0;return!1}function hW(e,t,n){return _0(e,t,{ignoreSelfIntersections:n}).features.length>0}function z5(e,t,n){for(const a of t.coordinates)if(ru(a,e))return!0;return _0(t,VM(e),{ignoreSelfIntersections:n}).features.length>0}function fW(e,t,n){for(const a of e.coordinates[0])if(ru(a,t))return!0;for(const a of t.coordinates[0])if(ru(a,e))return!0;return _0(VM(e),VM(t),{ignoreSelfIntersections:n}).features.length>0}function pW(e,t,n){const s=n[0]-e[0],a=n[1]-e[1],u=t[0]-e[0],f=t[1]-e[1];return s*f-a*u!==0?!1:Math.abs(u)>=Math.abs(f)?u>0?e[0]<=n[0]&&n[0]<=t[0]:t[0]<=n[0]&&n[0]<=e[0]:f>0?e[1]<=n[1]&&n[1]<=t[1]:t[1]<=n[1]&&n[1]<=e[1]}function mW(e,t){return e[0]===t[0]&&e[1]===t[1]}function ak(e,t,n={}){var s;const a=(s=n.ignoreSelfIntersections)!=null?s:!1;let u=!1;return op(e,f=>{op(t,_=>{if(u===!0)return!0;u=!cW(f.geometry,_.geometry,{ignoreSelfIntersections:a})})}),u}function gW(e,t,n,s,a){a3(e,t,n||0,s||e.length-1,a||yW)}function a3(e,t,n,s,a){for(;s>n;){if(s-n>600){var u=s-n+1,f=t-n+1,_=Math.log(u),r=.5*Math.exp(2*_/3),C=.5*Math.sqrt(_*r*(u-r)/u)*(f-u/2<0?-1:1),k=Math.max(n,Math.floor(t-f*r/u+C)),I=Math.min(s,Math.floor(t+(u-f)*r/u+C));a3(e,t,k,I,a)}var P=e[t],D=n,N=s;for(lv(e,n,t),a(e[s],P)>0&&lv(e,n,s);D<N;){for(lv(e,D,N),D++,N--;a(e[D],P)<0;)D++;for(;a(e[N],P)>0;)N--}a(e[n],P)===0?lv(e,n,N):(N++,lv(e,N,s)),N<=t&&(n=N+1),t<=N&&(s=N-1)}}function lv(e,t,n){var s=e[t];e[t]=e[n],e[n]=s}function yW(e,t){return e<t?-1:e>t?1:0}class Id{constructor(t=9){this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(t){let n=this.data;const s=[];if(!vw(t,n))return s;const a=this.toBBox,u=[];for(;n;){for(let f=0;f<n.children.length;f++){const _=n.children[f],r=n.leaf?a(_):_;vw(t,r)&&(n.leaf?s.push(_):uk(t,r)?this._all(_,s):u.push(_))}n=u.pop()}return s}collides(t){let n=this.data;if(!vw(t,n))return!1;const s=[];for(;n;){for(let a=0;a<n.children.length;a++){const u=n.children[a],f=n.leaf?this.toBBox(u):u;if(vw(t,f)){if(n.leaf||uk(t,f))return!0;s.push(u)}}n=s.pop()}return!1}load(t){if(!(t&&t.length))return this;if(t.length<this._minEntries){for(let s=0;s<t.length;s++)this.insert(t[s]);return this}let n=this._build(t.slice(),0,t.length-1,0);if(!this.data.children.length)this.data=n;else if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){const s=this.data;this.data=n,n=s}this._insert(n,this.data.height-n.height-1,!0)}return this}insert(t){return t&&this._insert(t,this.data.height-1),this}clear(){return this.data=ty([]),this}remove(t,n){if(!t)return this;let s=this.data;const a=this.toBBox(t),u=[],f=[];let _,r,C;for(;s||u.length;){if(s||(s=u.pop(),r=u[u.length-1],_=f.pop(),C=!0),s.leaf){const k=_W(t,s.children,n);if(k!==-1)return s.children.splice(k,1),u.push(s),this._condense(u),this}!C&&!s.leaf&&uk(s,a)?(u.push(s),f.push(_),_=0,r=s,s=s.children[0]):r?(_++,s=r.children[_],C=!1):s=null}return this}toBBox(t){return t}compareMinX(t,n){return t.minX-n.minX}compareMinY(t,n){return t.minY-n.minY}toJSON(){return this.data}fromJSON(t){return this.data=t,this}_all(t,n){const s=[];for(;t;)t.leaf?n.push(...t.children):s.push(...t.children),t=s.pop();return n}_build(t,n,s,a){const u=s-n+1;let f=this._maxEntries,_;if(u<=f)return _=ty(t.slice(n,s+1)),Fg(_,this.toBBox),_;a||(a=Math.ceil(Math.log(u)/Math.log(f)),f=Math.ceil(u/Math.pow(f,a-1))),_=ty([]),_.leaf=!1,_.height=a;const r=Math.ceil(u/f),C=r*Math.ceil(Math.sqrt(f));F5(t,n,s,C,this.compareMinX);for(let k=n;k<=s;k+=C){const I=Math.min(k+C-1,s);F5(t,k,I,r,this.compareMinY);for(let P=k;P<=I;P+=r){const D=Math.min(P+r-1,I);_.children.push(this._build(t,P,D,a-1))}}return Fg(_,this.toBBox),_}_chooseSubtree(t,n,s,a){for(;a.push(n),!(n.leaf||a.length-1===s);){let u=1/0,f=1/0,_;for(let r=0;r<n.children.length;r++){const C=n.children[r],k=lk(C),I=bW(t,C)-k;I<f?(f=I,u=k<u?k:u,_=C):I===f&&k<u&&(u=k,_=C)}n=_||n.children[0]}return n}_insert(t,n,s){const a=s?t:this.toBBox(t),u=[],f=this._chooseSubtree(a,this.data,n,u);for(f.children.push(t),jv(f,a);n>=0&&u[n].children.length>this._maxEntries;)this._split(u,n),n--;this._adjustParentBBoxes(a,u,n)}_split(t,n){const s=t[n],a=s.children.length,u=this._minEntries;this._chooseSplitAxis(s,u,a);const f=this._chooseSplitIndex(s,u,a),_=ty(s.children.splice(f,s.children.length-f));_.height=s.height,_.leaf=s.leaf,Fg(s,this.toBBox),Fg(_,this.toBBox),n?t[n-1].children.push(_):this._splitRoot(s,_)}_splitRoot(t,n){this.data=ty([t,n]),this.data.height=t.height+1,this.data.leaf=!1,Fg(this.data,this.toBBox)}_chooseSplitIndex(t,n,s){let a,u=1/0,f=1/0;for(let _=n;_<=s-n;_++){const r=Bv(t,0,_,this.toBBox),C=Bv(t,_,s,this.toBBox),k=wW(r,C),I=lk(r)+lk(C);k<u?(u=k,a=_,f=I<f?I:f):k===u&&I<f&&(f=I,a=_)}return a||s-n}_chooseSplitAxis(t,n,s){const a=t.leaf?this.compareMinX:vW,u=t.leaf?this.compareMinY:xW,f=this._allDistMargin(t,n,s,a),_=this._allDistMargin(t,n,s,u);f<_&&t.children.sort(a)}_allDistMargin(t,n,s,a){t.children.sort(a);const u=this.toBBox,f=Bv(t,0,n,u),_=Bv(t,s-n,s,u);let r=_w(f)+_w(_);for(let C=n;C<s-n;C++){const k=t.children[C];jv(f,t.leaf?u(k):k),r+=_w(f)}for(let C=s-n-1;C>=n;C--){const k=t.children[C];jv(_,t.leaf?u(k):k),r+=_w(_)}return r}_adjustParentBBoxes(t,n,s){for(let a=s;a>=0;a--)jv(n[a],t)}_condense(t){for(let n=t.length-1,s;n>=0;n--)t[n].children.length===0?n>0?(s=t[n-1].children,s.splice(s.indexOf(t[n]),1)):this.clear():Fg(t[n],this.toBBox)}}function _W(e,t,n){if(!n)return t.indexOf(e);for(let s=0;s<t.length;s++)if(n(e,t[s]))return s;return-1}function Fg(e,t){Bv(e,0,e.children.length,t,e)}function Bv(e,t,n,s,a){a||(a=ty(null)),a.minX=1/0,a.minY=1/0,a.maxX=-1/0,a.maxY=-1/0;for(let u=t;u<n;u++){const f=e.children[u];jv(a,e.leaf?s(f):f)}return a}function jv(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function vW(e,t){return e.minX-t.minX}function xW(e,t){return e.minY-t.minY}function lk(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function _w(e){return e.maxX-e.minX+(e.maxY-e.minY)}function bW(e,t){return(Math.max(t.maxX,e.maxX)-Math.min(t.minX,e.minX))*(Math.max(t.maxY,e.maxY)-Math.min(t.minY,e.minY))}function wW(e,t){const n=Math.max(e.minX,t.minX),s=Math.max(e.minY,t.minY),a=Math.min(e.maxX,t.maxX),u=Math.min(e.maxY,t.maxY);return Math.max(0,a-n)*Math.max(0,u-s)}function uk(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function vw(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function ty(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function F5(e,t,n,s,a){const u=[t,n];for(;u.length;){if(n=u.pop(),t=u.pop(),n-t<=s)continue;const f=t+Math.ceil((n-t)/s/2)*s;gW(e,f,t,n,a),u.push(t,f,f,n)}}function l3(e){var t=new Id(e);return t.insert=function(n){if(n.type!=="Feature")throw new Error("invalid feature");return n.bbox=n.bbox?n.bbox:dl(n),Id.prototype.insert.call(this,n)},t.load=function(n){var s=[];return Array.isArray(n)?n.forEach(function(a){if(a.type!=="Feature")throw new Error("invalid features");a.bbox=a.bbox?a.bbox:dl(a),s.push(a)}):rp(n,function(a){if(a.type!=="Feature")throw new Error("invalid features");a.bbox=a.bbox?a.bbox:dl(a),s.push(a)}),Id.prototype.load.call(this,s)},t.remove=function(n,s){if(n.type!=="Feature")throw new Error("invalid feature");return n.bbox=n.bbox?n.bbox:dl(n),Id.prototype.remove.call(this,n,s)},t.clear=function(){return Id.prototype.clear.call(this)},t.search=function(n){var s=Id.prototype.search.call(this,this.toBBox(n));return ya(s)},t.collides=function(n){return Id.prototype.collides.call(this,this.toBBox(n))},t.all=function(){var n=Id.prototype.all.call(this);return ya(n)},t.toJSON=function(){return Id.prototype.toJSON.call(this)},t.fromJSON=function(n){return Id.prototype.fromJSON.call(this,n)},t.toBBox=function(n){var s;if(n.bbox)s=n.bbox;else if(Array.isArray(n)&&n.length===4)s=n;else if(Array.isArray(n)&&n.length===6)s=[n[0],n[1],n[3],n[4]];else if(n.type==="Feature")s=dl(n);else if(n.type==="FeatureCollection")s=dl(n);else throw new Error("invalid geojson");return{minX:s[0],minY:s[1],maxX:s[2],maxY:s[3]}},t}function SW(e){if(!e)throw new Error("geojson is required");const t=[];return op(e,n=>{CW(n,t)}),ya(t)}function CW(e,t){let n=[];const s=e.geometry;if(s!==null){switch(s.type){case"Polygon":n=gm(s);break;case"LineString":n=[gm(s)]}n.forEach(a=>{EW(a,e.properties).forEach(f=>{f.id=t.length,t.push(f)})})}}function EW(e,t){const n=[];return e.reduce((s,a)=>{const u=qc([s,a],t);return u.bbox=TW(s,a),n.push(u),a}),n}function TW(e,t){const n=e[0],s=e[1],a=t[0],u=t[1],f=n<a?n:a,_=s<u?s:u,r=n>a?n:a,C=s>u?s:u;return[f,_,r,C]}var IW=Object.defineProperty,kW=Object.defineProperties,MW=Object.getOwnPropertyDescriptors,N5=Object.getOwnPropertySymbols,PW=Object.prototype.hasOwnProperty,AW=Object.prototype.propertyIsEnumerable,B5=(e,t,n)=>t in e?IW(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Qp=(e,t)=>{for(var n in t||(t={}))PW.call(t,n)&&B5(e,n,t[n]);if(N5)for(var n of N5(t))AW.call(t,n)&&B5(e,n,t[n]);return e},em=(e,t)=>kW(e,MW(t));function LW(e,t,n={}){if(!e||!t)throw new Error("lines and pt are required arguments");let s=Ay([1/0,1/0],{dist:1/0,index:-1,multiFeatureIndex:-1,location:-1}),a=0;return op(e,function(u,f,_){const r=gm(u);for(let C=0;C<r.length-1;C++){const k=Ay(r[C]);k.properties.dist=sm(t,k,n);const I=Ay(r[C+1]);I.properties.dist=sm(t,I,n);const P=sm(k,I,n),D=Math.max(k.properties.dist,I.properties.dist),N=r3(k,I),j=L5(t,D,N+90,n),W=L5(t,D,N-90,n),H=_0(qc([j.geometry.coordinates,W.geometry.coordinates]),qc([k.geometry.coordinates,I.geometry.coordinates]));let q;H.features.length>0&&H.features[0]&&(q=em(Qp({},H.features[0]),{properties:{dist:sm(t,H.features[0],n),multiFeatureIndex:_,location:a+sm(k,H.features[0],n)}})),k.properties.dist<s.properties.dist&&(s=em(Qp({},k),{properties:em(Qp({},k.properties),{index:C,multiFeatureIndex:_,location:a})})),I.properties.dist<s.properties.dist&&(s=em(Qp({},I),{properties:em(Qp({},I.properties),{index:C+1,multiFeatureIndex:_,location:a+P})})),q&&q.properties.dist<s.properties.dist&&(s=em(Qp({},q),{properties:em(Qp({},q.properties),{index:C})})),a+=P}}),s}function RW(e,t){var n=Xy(e),s=Xy(t),a=n.type,u=s.type;switch(a){case"Point":switch(u){case"MultiPoint":return OW(n,s);case"LineString":return WS(n,s,{ignoreEndVertices:!0});case"Polygon":case"MultiPolygon":return ru(n,s,{ignoreBoundary:!0});default:throw new Error("feature2 "+u+" geometry not supported")}case"MultiPoint":switch(u){case"MultiPoint":return DW(n,s);case"LineString":return zW(n,s);case"Polygon":case"MultiPolygon":return FW(n,s);default:throw new Error("feature2 "+u+" geometry not supported")}case"LineString":switch(u){case"LineString":return NW(n,s);case"Polygon":case"MultiPolygon":return BW(n,s);default:throw new Error("feature2 "+u+" geometry not supported")}case"Polygon":switch(u){case"Polygon":case"MultiPolygon":return jW(n,s);default:throw new Error("feature2 "+u+" geometry not supported")}default:throw new Error("feature1 "+a+" geometry not supported")}}function OW(e,t){var n,s=!1;for(n=0;n<t.coordinates.length;n++)if(c3(t.coordinates[n],e.coordinates)){s=!0;break}return s}function DW(e,t){for(var n=0;n<e.coordinates.length;n++){for(var s=!1,a=0;a<t.coordinates.length;a++)c3(e.coordinates[n],t.coordinates[a])&&(s=!0);if(!s)return!1}return!0}function zW(e,t){for(var n=!1,s=0;s<e.coordinates.length;s++){if(!WS(e.coordinates[s],t))return!1;n||(n=WS(e.coordinates[s],t,{ignoreEndVertices:!0}))}return n}function FW(e,t){for(var n=!0,s=!1,a=0;a<e.coordinates.length;a++){if(s=ru(e.coordinates[a],t),!s){n=!1;break}s=ru(e.coordinates[a],t,{ignoreBoundary:!0})}return n&&s}function NW(e,t){for(var n=0;n<e.coordinates.length;n++)if(!WS(e.coordinates[n],t))return!1;return!0}function BW(e,t){var n=dl(t),s=dl(e);if(!u3(n,s))return!1;for(var a=!1,u=0;u<e.coordinates.length;u++){if(!ru(e.coordinates[u],t))return!1;if(a||(a=ru(e.coordinates[u],t,{ignoreBoundary:!0})),!a&&u<e.coordinates.length-1){var f=VW(e.coordinates[u],e.coordinates[u+1]);a=ru(f,t,{ignoreBoundary:!0})}}return a}function jW(e,t){var n=dl(e),s=dl(t);if(!u3(s,n))return!1;for(var a=0;a<e.coordinates[0].length;a++)if(!ru(e.coordinates[0][a],t))return!1;return!0}function u3(e,t){return!(e[0]>t[0]||e[2]<t[2]||e[1]>t[1]||e[3]<t[3])}function c3(e,t){return e[0]===t[0]&&e[1]===t[1]}function VW(e,t){return[(e[0]+t[0])/2,(e[1]+t[1])/2]}var uv=RW;function $W(e,t={}){const n=dl(e),s=(n[0]+n[2])/2,a=(n[1]+n[3])/2;return Ay([s,a],t.properties,t)}var d3={exports:{}};(function(e,t){(function(n,s){e.exports=s()})(fl,function(){function n(U,m){if(!(U instanceof m))throw new TypeError("Cannot call a class as a function")}function s(U,m){for(var b=0;b<m.length;b++){var w=m[b];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(U,w.key,w)}}function a(U,m,b){return m&&s(U.prototype,m),b&&s(U,b),U}function u(U,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function");U.prototype=Object.create(m&&m.prototype,{constructor:{value:U,writable:!0,configurable:!0}}),m&&_(U,m)}function f(U){return f=Object.setPrototypeOf?Object.getPrototypeOf:function(m){return m.__proto__||Object.getPrototypeOf(m)},f(U)}function _(U,m){return _=Object.setPrototypeOf||function(b,w){return b.__proto__=w,b},_(U,m)}function r(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function C(U,m,b){return C=r()?Reflect.construct:function(w,R,J){var ve=[null];ve.push.apply(ve,R);var Ie=new(Function.bind.apply(w,ve));return J&&_(Ie,J.prototype),Ie},C.apply(null,arguments)}function k(U){var m=typeof Map=="function"?new Map:void 0;return k=function(b){if(b===null||(w=b,Function.toString.call(w).indexOf("[native code]")===-1))return b;var w;if(typeof b!="function")throw new TypeError("Super expression must either be null or a function");if(m!==void 0){if(m.has(b))return m.get(b);m.set(b,R)}function R(){return C(b,arguments,f(this).constructor)}return R.prototype=Object.create(b.prototype,{constructor:{value:R,enumerable:!1,writable:!0,configurable:!0}}),_(R,b)},k(U)}function I(U){if(U===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return U}function P(U,m){if(m&&(typeof m=="object"||typeof m=="function"))return m;if(m!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return I(U)}function D(U){var m=r();return function(){var b,w=f(U);if(m){var R=f(this).constructor;b=Reflect.construct(w,arguments,R)}else b=w.apply(this,arguments);return P(this,b)}}function N(U,m,b){return N=typeof Reflect<"u"&&Reflect.get?Reflect.get:function(w,R,J){var ve=function(je,lt){for(;!Object.prototype.hasOwnProperty.call(je,lt)&&(je=f(je))!==null;);return je}(w,R);if(ve){var Ie=Object.getOwnPropertyDescriptor(ve,R);return Ie.get?Ie.get.call(J):Ie.value}},N(U,m,b||U)}function j(U){return function(m){if(Array.isArray(m))return H(m)}(U)||function(m){if(typeof Symbol<"u"&&m[Symbol.iterator]!=null||m["@@iterator"]!=null)return Array.from(m)}(U)||W(U)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function W(U,m){if(U){if(typeof U=="string")return H(U,m);var b=Object.prototype.toString.call(U).slice(8,-1);return b==="Object"&&U.constructor&&(b=U.constructor.name),b==="Map"||b==="Set"?Array.from(U):b==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(b)?H(U,m):void 0}}function H(U,m){(m==null||m>U.length)&&(m=U.length);for(var b=0,w=new Array(m);b<m;b++)w[b]=U[b];return w}function q(U,m){var b=typeof Symbol<"u"&&U[Symbol.iterator]||U["@@iterator"];if(!b){if(Array.isArray(U)||(b=W(U))||m){b&&(U=b);var w=0,R=function(){};return{s:R,n:function(){return w>=U.length?{done:!0}:{done:!1,value:U[w++]}},e:function(je){throw je},f:R}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var J,ve=!0,Ie=!1;return{s:function(){b=b.call(U)},n:function(){var je=b.next();return ve=je.done,je},e:function(je){Ie=!0,J=je},f:function(){try{ve||b.return==null||b.return()}finally{if(Ie)throw J}}}}var Z=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"getEndCapStyle",value:function(){return this._endCapStyle}},{key:"isSingleSided",value:function(){return this._isSingleSided}},{key:"setQuadrantSegments",value:function(m){this._quadrantSegments=m,this._quadrantSegments===0&&(this._joinStyle=U.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=U.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),m<=0&&(this._quadrantSegments=1),this._joinStyle!==U.JOIN_ROUND&&(this._quadrantSegments=U.DEFAULT_QUADRANT_SEGMENTS)}},{key:"getJoinStyle",value:function(){return this._joinStyle}},{key:"setJoinStyle",value:function(m){this._joinStyle=m}},{key:"setSimplifyFactor",value:function(m){this._simplifyFactor=m<0?0:m}},{key:"getSimplifyFactor",value:function(){return this._simplifyFactor}},{key:"getQuadrantSegments",value:function(){return this._quadrantSegments}},{key:"setEndCapStyle",value:function(m){this._endCapStyle=m}},{key:"getMitreLimit",value:function(){return this._mitreLimit}},{key:"setMitreLimit",value:function(m){this._mitreLimit=m}},{key:"setSingleSided",value:function(m){this._isSingleSided=m}}],[{key:"constructor_",value:function(){if(this._quadrantSegments=U.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=U.CAP_ROUND,this._joinStyle=U.JOIN_ROUND,this._mitreLimit=U.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=U.DEFAULT_SIMPLIFY_FACTOR,arguments.length!==0){if(arguments.length===1){var m=arguments[0];this.setQuadrantSegments(m)}else if(arguments.length===2){var b=arguments[0],w=arguments[1];this.setQuadrantSegments(b),this.setEndCapStyle(w)}else if(arguments.length===4){var R=arguments[0],J=arguments[1],ve=arguments[2],Ie=arguments[3];this.setQuadrantSegments(R),this.setEndCapStyle(J),this.setJoinStyle(ve),this.setMitreLimit(Ie)}}}},{key:"bufferDistanceError",value:function(m){var b=Math.PI/2/m;return 1-Math.cos(b/2)}}]),U}();Z.CAP_ROUND=1,Z.CAP_FLAT=2,Z.CAP_SQUARE=3,Z.JOIN_ROUND=1,Z.JOIN_MITRE=2,Z.JOIN_BEVEL=3,Z.DEFAULT_QUADRANT_SEGMENTS=8,Z.DEFAULT_MITRE_LIMIT=5,Z.DEFAULT_SIMPLIFY_FACTOR=.01;var re=function(U){u(b,U);var m=D(b);function b(w){var R;return n(this,b),(R=m.call(this,w)).name=Object.keys({Exception:b})[0],R}return a(b,[{key:"toString",value:function(){return this.message}}]),b}(k(Error)),le=function(U){u(b,U);var m=D(b);function b(w){var R;return n(this,b),(R=m.call(this,w)).name=Object.keys({IllegalArgumentException:b})[0],R}return b}(re),_e=function(){function U(){n(this,U)}return a(U,[{key:"filter",value:function(m){}}]),U}();function ye(){}function de(){}function ce(){}var oe,xe,he,Ee,se,we,Se,Pe,Me=function(){function U(){n(this,U)}return a(U,null,[{key:"equalsWithTolerance",value:function(m,b,w){return Math.abs(m-b)<=w}}]),U}(),Re=function(){function U(m,b){n(this,U),this.low=b||0,this.high=m||0}return a(U,null,[{key:"toBinaryString",value:function(m){var b,w="";for(b=2147483648;b>0;b>>>=1)w+=(m.high&b)===b?"1":"0";for(b=2147483648;b>0;b>>>=1)w+=(m.low&b)===b?"1":"0";return w}}]),U}();function Oe(){}function $e(){}Oe.NaN=NaN,Oe.isNaN=function(U){return Number.isNaN(U)},Oe.isInfinite=function(U){return!Number.isFinite(U)},Oe.MAX_VALUE=Number.MAX_VALUE,Oe.POSITIVE_INFINITY=Number.POSITIVE_INFINITY,Oe.NEGATIVE_INFINITY=Number.NEGATIVE_INFINITY,typeof Float64Array=="function"&&typeof Int32Array=="function"?(we=2146435072,Se=new Float64Array(1),Pe=new Int32Array(Se.buffer),Oe.doubleToLongBits=function(U){Se[0]=U;var m=0|Pe[0],b=0|Pe[1];return(b&we)===we&&1048575&b&&m!==0&&(m=0,b=2146959360),new Re(b,m)},Oe.longBitsToDouble=function(U){return Pe[0]=U.low,Pe[1]=U.high,Se[0]}):(oe=1023,xe=Math.log2,he=Math.floor,Ee=Math.pow,se=function(){for(var U=53;U>0;U--){var m=Ee(2,U)-1;if(he(xe(m))+1===U)return m}return 0}(),Oe.doubleToLongBits=function(U){var m,b,w,R,J,ve,Ie,je,lt;if(U<0||1/U===Number.NEGATIVE_INFINITY?(ve=1<<31,U=-U):ve=0,U===0)return new Re(je=ve,lt=0);if(U===1/0)return new Re(je=2146435072|ve,lt=0);if(U!=U)return new Re(je=2146959360,lt=0);if(R=0,lt=0,(m=he(U))>1)if(m<=se)(R=he(xe(m)))<=20?(lt=0,je=m<<20-R&1048575):(lt=m%(b=Ee(2,w=R-20))<<32-w,je=m/b&1048575);else for(w=m,lt=0;(w=he(b=w/2))!==0;)R++,lt>>>=1,lt|=(1&je)<<31,je>>>=1,b!==w&&(je|=524288);if(Ie=R+oe,J=m===0,m=U-m,R<52&&m!==0)for(w=0;;){if((b=2*m)>=1?(m=b-1,J?(Ie--,J=!1):(w<<=1,w|=1,R++)):(m=b,J?--Ie==0&&(R++,J=!1):(w<<=1,R++)),R===20)je|=w,w=0;else if(R===52){lt|=w;break}if(b===1){R<20?je|=w<<20-R:R<52&&(lt|=w<<52-R);break}}return je|=Ie<<20,new Re(je|=ve,lt)},Oe.longBitsToDouble=function(U){var m,b,w,R,J=U.high,ve=U.low,Ie=J&1<<31?-1:1;for(w=((2146435072&J)>>20)-oe,R=0,b=1<<19,m=1;m<=20;m++)J&b&&(R+=Ee(2,-m)),b>>>=1;for(b=1<<31,m=21;m<=52;m++)ve&b&&(R+=Ee(2,-m)),b>>>=1;if(w===-1023){if(R===0)return 0*Ie;w=-1022}else{if(w===1024)return R===0?Ie/0:NaN;R+=1}return Ie*R*Ee(2,w)});var Ke=function(U){u(b,U);var m=D(b);function b(w){var R;return n(this,b),(R=m.call(this,w)).name=Object.keys({RuntimeException:b})[0],R}return b}(re),Ct=function(U){u(b,U);var m=D(b);function b(){var w;return n(this,b),w=m.call(this),b.constructor_.apply(I(w),arguments),w}return a(b,null,[{key:"constructor_",value:function(){if(arguments.length===0)Ke.constructor_.call(this);else if(arguments.length===1){var w=arguments[0];Ke.constructor_.call(this,w)}}}]),b}(Ke),Ue=function(){function U(){n(this,U)}return a(U,null,[{key:"shouldNeverReachHere",value:function(){if(arguments.length===0)U.shouldNeverReachHere(null);else if(arguments.length===1){var m=arguments[0];throw new Ct("Should never reach here"+(m!==null?": "+m:""))}}},{key:"isTrue",value:function(){if(arguments.length===1){var m=arguments[0];U.isTrue(m,null)}else if(arguments.length===2){var b=arguments[0],w=arguments[1];if(!b)throw w===null?new Ct:new Ct(w)}}},{key:"equals",value:function(){if(arguments.length===2){var m=arguments[0],b=arguments[1];U.equals(m,b,null)}else if(arguments.length===3){var w=arguments[0],R=arguments[1],J=arguments[2];if(!R.equals(w))throw new Ct("Expected "+w+" but encountered "+R+(J!==null?": "+J:""))}}}]),U}(),ft=new ArrayBuffer(8),Bt=new Float64Array(ft),hn=new Int32Array(ft),ot=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"getM",value:function(){return Oe.NaN}},{key:"setOrdinate",value:function(m,b){switch(m){case U.X:this.x=b;break;case U.Y:this.y=b;break;case U.Z:this.setZ(b);break;default:throw new le("Invalid ordinate index: "+m)}}},{key:"equals2D",value:function(){if(arguments.length===1){var m=arguments[0];return this.x===m.x&&this.y===m.y}if(arguments.length===2){var b=arguments[0],w=arguments[1];return!!Me.equalsWithTolerance(this.x,b.x,w)&&!!Me.equalsWithTolerance(this.y,b.y,w)}}},{key:"setM",value:function(m){throw new le("Invalid ordinate index: "+U.M)}},{key:"getZ",value:function(){return this.z}},{key:"getOrdinate",value:function(m){switch(m){case U.X:return this.x;case U.Y:return this.y;case U.Z:return this.getZ()}throw new le("Invalid ordinate index: "+m)}},{key:"equals3D",value:function(m){return this.x===m.x&&this.y===m.y&&(this.getZ()===m.getZ()||Oe.isNaN(this.getZ())&&Oe.isNaN(m.getZ()))}},{key:"equals",value:function(m){return m instanceof U&&this.equals2D(m)}},{key:"equalInZ",value:function(m,b){return Me.equalsWithTolerance(this.getZ(),m.getZ(),b)}},{key:"setX",value:function(m){this.x=m}},{key:"compareTo",value:function(m){var b=m;return this.x<b.x?-1:this.x>b.x?1:this.y<b.y?-1:this.y>b.y?1:0}},{key:"getX",value:function(){return this.x}},{key:"setZ",value:function(m){this.z=m}},{key:"clone",value:function(){try{return null}catch(m){if(m instanceof CloneNotSupportedException)return Ue.shouldNeverReachHere("this shouldn't happen because this class is Cloneable"),null;throw m}}},{key:"copy",value:function(){return new U(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+", "+this.getZ()+")"}},{key:"distance3D",value:function(m){var b=this.x-m.x,w=this.y-m.y,R=this.getZ()-m.getZ();return Math.sqrt(b*b+w*w+R*R)}},{key:"getY",value:function(){return this.y}},{key:"setY",value:function(m){this.y=m}},{key:"distance",value:function(m){var b=this.x-m.x,w=this.y-m.y;return Math.sqrt(b*b+w*w)}},{key:"hashCode",value:function(){var m=17;return m=37*(m=37*m+U.hashCode(this.x))+U.hashCode(this.y)}},{key:"setCoordinate",value:function(m){this.x=m.x,this.y=m.y,this.z=m.getZ()}},{key:"interfaces_",get:function(){return[ye,de,ce]}}],[{key:"constructor_",value:function(){if(this.x=null,this.y=null,this.z=null,arguments.length===0)U.constructor_.call(this,0,0);else if(arguments.length===1){var m=arguments[0];U.constructor_.call(this,m.x,m.y,m.getZ())}else if(arguments.length===2){var b=arguments[0],w=arguments[1];U.constructor_.call(this,b,w,U.NULL_ORDINATE)}else if(arguments.length===3){var R=arguments[0],J=arguments[1],ve=arguments[2];this.x=R,this.y=J,this.z=ve}}},{key:"hashCode",value:function(m){return Bt[0]=m,hn[0]^hn[1]}}]),U}(),en=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"compare",value:function(m,b){var w=U.compare(m.x,b.x);if(w!==0)return w;var R=U.compare(m.y,b.y);return R!==0?R:this._dimensionsToTest<=2?0:U.compare(m.getZ(),b.getZ())}},{key:"interfaces_",get:function(){return[$e]}}],[{key:"constructor_",value:function(){if(this._dimensionsToTest=2,arguments.length===0)U.constructor_.call(this,2);else if(arguments.length===1){var m=arguments[0];if(m!==2&&m!==3)throw new le("only 2 or 3 dimensions may be specified");this._dimensionsToTest=m}}},{key:"compare",value:function(m,b){return m<b?-1:m>b?1:Oe.isNaN(m)?Oe.isNaN(b)?0:-1:Oe.isNaN(b)?1:0}}]),U}();ot.DimensionalComparator=en,ot.NULL_ORDINATE=Oe.NaN,ot.X=0,ot.Y=1,ot.Z=2,ot.M=3;var wt=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"getArea",value:function(){return this.getWidth()*this.getHeight()}},{key:"equals",value:function(m){if(!(m instanceof U))return!1;var b=m;return this.isNull()?b.isNull():this._maxx===b.getMaxX()&&this._maxy===b.getMaxY()&&this._minx===b.getMinX()&&this._miny===b.getMinY()}},{key:"intersection",value:function(m){if(this.isNull()||m.isNull()||!this.intersects(m))return new U;var b=this._minx>m._minx?this._minx:m._minx,w=this._miny>m._miny?this._miny:m._miny;return new U(b,this._maxx<m._maxx?this._maxx:m._maxx,w,this._maxy<m._maxy?this._maxy:m._maxy)}},{key:"isNull",value:function(){return this._maxx<this._minx}},{key:"getMaxX",value:function(){return this._maxx}},{key:"covers",value:function(){if(arguments.length===1){if(arguments[0]instanceof ot){var m=arguments[0];return this.covers(m.x,m.y)}if(arguments[0]instanceof U){var b=arguments[0];return!this.isNull()&&!b.isNull()&&b.getMinX()>=this._minx&&b.getMaxX()<=this._maxx&&b.getMinY()>=this._miny&&b.getMaxY()<=this._maxy}}else if(arguments.length===2){var w=arguments[0],R=arguments[1];return!this.isNull()&&w>=this._minx&&w<=this._maxx&&R>=this._miny&&R<=this._maxy}}},{key:"intersects",value:function(){if(arguments.length===1){if(arguments[0]instanceof U){var m=arguments[0];return!this.isNull()&&!m.isNull()&&!(m._minx>this._maxx||m._maxx<this._minx||m._miny>this._maxy||m._maxy<this._miny)}if(arguments[0]instanceof ot){var b=arguments[0];return this.intersects(b.x,b.y)}}else if(arguments.length===2){if(arguments[0]instanceof ot&&arguments[1]instanceof ot){var w=arguments[0],R=arguments[1];if(this.isNull())return!1;var J=w.x<R.x?w.x:R.x;if(J>this._maxx)return!1;var ve=w.x>R.x?w.x:R.x;if(ve<this._minx)return!1;var Ie=w.y<R.y?w.y:R.y;if(Ie>this._maxy)return!1;var je=w.y>R.y?w.y:R.y;return!(je<this._miny)}if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var lt=arguments[0],Ft=arguments[1];return!this.isNull()&&!(lt>this._maxx||lt<this._minx||Ft>this._maxy||Ft<this._miny)}}}},{key:"getMinY",value:function(){return this._miny}},{key:"getDiameter",value:function(){if(this.isNull())return 0;var m=this.getWidth(),b=this.getHeight();return Math.sqrt(m*m+b*b)}},{key:"getMinX",value:function(){return this._minx}},{key:"expandToInclude",value:function(){if(arguments.length===1){if(arguments[0]instanceof ot){var m=arguments[0];this.expandToInclude(m.x,m.y)}else if(arguments[0]instanceof U){var b=arguments[0];if(b.isNull())return null;this.isNull()?(this._minx=b.getMinX(),this._maxx=b.getMaxX(),this._miny=b.getMinY(),this._maxy=b.getMaxY()):(b._minx<this._minx&&(this._minx=b._minx),b._maxx>this._maxx&&(this._maxx=b._maxx),b._miny<this._miny&&(this._miny=b._miny),b._maxy>this._maxy&&(this._maxy=b._maxy))}}else if(arguments.length===2){var w=arguments[0],R=arguments[1];this.isNull()?(this._minx=w,this._maxx=w,this._miny=R,this._maxy=R):(w<this._minx&&(this._minx=w),w>this._maxx&&(this._maxx=w),R<this._miny&&(this._miny=R),R>this._maxy&&(this._maxy=R))}}},{key:"minExtent",value:function(){if(this.isNull())return 0;var m=this.getWidth(),b=this.getHeight();return m<b?m:b}},{key:"getWidth",value:function(){return this.isNull()?0:this._maxx-this._minx}},{key:"compareTo",value:function(m){var b=m;return this.isNull()?b.isNull()?0:-1:b.isNull()?1:this._minx<b._minx?-1:this._minx>b._minx?1:this._miny<b._miny?-1:this._miny>b._miny?1:this._maxx<b._maxx?-1:this._maxx>b._maxx?1:this._maxy<b._maxy?-1:this._maxy>b._maxy?1:0}},{key:"translate",value:function(m,b){if(this.isNull())return null;this.init(this.getMinX()+m,this.getMaxX()+m,this.getMinY()+b,this.getMaxY()+b)}},{key:"copy",value:function(){return new U(this)}},{key:"toString",value:function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"}},{key:"setToNull",value:function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1}},{key:"disjoint",value:function(m){return!(!this.isNull()&&!m.isNull())||m._minx>this._maxx||m._maxx<this._minx||m._miny>this._maxy||m._maxy<this._miny}},{key:"getHeight",value:function(){return this.isNull()?0:this._maxy-this._miny}},{key:"maxExtent",value:function(){if(this.isNull())return 0;var m=this.getWidth(),b=this.getHeight();return m>b?m:b}},{key:"expandBy",value:function(){if(arguments.length===1){var m=arguments[0];this.expandBy(m,m)}else if(arguments.length===2){var b=arguments[0],w=arguments[1];if(this.isNull())return null;this._minx-=b,this._maxx+=b,this._miny-=w,this._maxy+=w,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}}},{key:"contains",value:function(){if(arguments.length===1){if(arguments[0]instanceof U){var m=arguments[0];return this.covers(m)}if(arguments[0]instanceof ot){var b=arguments[0];return this.covers(b)}}else if(arguments.length===2){var w=arguments[0],R=arguments[1];return this.covers(w,R)}}},{key:"centre",value:function(){return this.isNull()?null:new ot((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)}},{key:"init",value:function(){if(arguments.length===0)this.setToNull();else if(arguments.length===1){if(arguments[0]instanceof ot){var m=arguments[0];this.init(m.x,m.x,m.y,m.y)}else if(arguments[0]instanceof U){var b=arguments[0];this._minx=b._minx,this._maxx=b._maxx,this._miny=b._miny,this._maxy=b._maxy}}else if(arguments.length===2){var w=arguments[0],R=arguments[1];this.init(w.x,R.x,w.y,R.y)}else if(arguments.length===4){var J=arguments[0],ve=arguments[1],Ie=arguments[2],je=arguments[3];J<ve?(this._minx=J,this._maxx=ve):(this._minx=ve,this._maxx=J),Ie<je?(this._miny=Ie,this._maxy=je):(this._miny=je,this._maxy=Ie)}}},{key:"getMaxY",value:function(){return this._maxy}},{key:"distance",value:function(m){if(this.intersects(m))return 0;var b=0;this._maxx<m._minx?b=m._minx-this._maxx:this._minx>m._maxx&&(b=this._minx-m._maxx);var w=0;return this._maxy<m._miny?w=m._miny-this._maxy:this._miny>m._maxy&&(w=this._miny-m._maxy),b===0?w:w===0?b:Math.sqrt(b*b+w*w)}},{key:"hashCode",value:function(){var m=17;return m=37*(m=37*(m=37*(m=37*m+ot.hashCode(this._minx))+ot.hashCode(this._maxx))+ot.hashCode(this._miny))+ot.hashCode(this._maxy)}},{key:"interfaces_",get:function(){return[ye,ce]}}],[{key:"constructor_",value:function(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,arguments.length===0)this.init();else if(arguments.length===1){if(arguments[0]instanceof ot){var m=arguments[0];this.init(m.x,m.x,m.y,m.y)}else if(arguments[0]instanceof U){var b=arguments[0];this.init(b)}}else if(arguments.length===2){var w=arguments[0],R=arguments[1];this.init(w.x,R.x,w.y,R.y)}else if(arguments.length===4){var J=arguments[0],ve=arguments[1],Ie=arguments[2],je=arguments[3];this.init(J,ve,Ie,je)}}},{key:"intersects",value:function(){if(arguments.length===3){var m=arguments[0],b=arguments[1],w=arguments[2];return w.x>=(m.x<b.x?m.x:b.x)&&w.x<=(m.x>b.x?m.x:b.x)&&w.y>=(m.y<b.y?m.y:b.y)&&w.y<=(m.y>b.y?m.y:b.y)}if(arguments.length===4){var R=arguments[0],J=arguments[1],ve=arguments[2],Ie=arguments[3],je=Math.min(ve.x,Ie.x),lt=Math.max(ve.x,Ie.x),Ft=Math.min(R.x,J.x),Kt=Math.max(R.x,J.x);return!(Ft>lt)&&!(Kt<je)&&(je=Math.min(ve.y,Ie.y),lt=Math.max(ve.y,Ie.y),Ft=Math.min(R.y,J.y),Kt=Math.max(R.y,J.y),!(Ft>lt)&&!(Kt<je))}}}]),U}(),Ne=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"isGeometryCollection",value:function(){return this.getTypeCode()===U.TYPECODE_GEOMETRYCOLLECTION}},{key:"getFactory",value:function(){return this._factory}},{key:"getGeometryN",value:function(m){return this}},{key:"getArea",value:function(){return 0}},{key:"isRectangle",value:function(){return!1}},{key:"equalsExact",value:function(m){return this===m||this.equalsExact(m,0)}},{key:"geometryChanged",value:function(){this.apply(U.geometryChangedFilter)}},{key:"geometryChangedAction",value:function(){this._envelope=null}},{key:"equalsNorm",value:function(m){return m!==null&&this.norm().equalsExact(m.norm())}},{key:"getLength",value:function(){return 0}},{key:"getNumGeometries",value:function(){return 1}},{key:"compareTo",value:function(){var m;if(arguments.length===1){var b=arguments[0];return m=b,this.getTypeCode()!==m.getTypeCode()?this.getTypeCode()-m.getTypeCode():this.isEmpty()&&m.isEmpty()?0:this.isEmpty()?-1:m.isEmpty()?1:this.compareToSameClass(b)}if(arguments.length===2){var w=arguments[0],R=arguments[1];return m=w,this.getTypeCode()!==m.getTypeCode()?this.getTypeCode()-m.getTypeCode():this.isEmpty()&&m.isEmpty()?0:this.isEmpty()?-1:m.isEmpty()?1:this.compareToSameClass(w,R)}}},{key:"getUserData",value:function(){return this._userData}},{key:"getSRID",value:function(){return this._SRID}},{key:"getEnvelope",value:function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())}},{key:"checkNotGeometryCollection",value:function(m){if(m.getTypeCode()===U.TYPECODE_GEOMETRYCOLLECTION)throw new le("This method does not support GeometryCollection arguments")}},{key:"equal",value:function(m,b,w){return w===0?m.equals(b):m.distance(b)<=w}},{key:"norm",value:function(){var m=this.copy();return m.normalize(),m}},{key:"reverse",value:function(){var m=this.reverseInternal();return this.envelope!=null&&(m.envelope=this.envelope.copy()),m.setSRID(this.getSRID()),m}},{key:"copy",value:function(){var m=this.copyInternal();return m.envelope=this._envelope==null?null:this._envelope.copy(),m._SRID=this._SRID,m._userData=this._userData,m}},{key:"getPrecisionModel",value:function(){return this._factory.getPrecisionModel()}},{key:"getEnvelopeInternal",value:function(){return this._envelope===null&&(this._envelope=this.computeEnvelopeInternal()),new wt(this._envelope)}},{key:"setSRID",value:function(m){this._SRID=m}},{key:"setUserData",value:function(m){this._userData=m}},{key:"compare",value:function(m,b){for(var w=m.iterator(),R=b.iterator();w.hasNext()&&R.hasNext();){var J=w.next(),ve=R.next(),Ie=J.compareTo(ve);if(Ie!==0)return Ie}return w.hasNext()?1:R.hasNext()?-1:0}},{key:"hashCode",value:function(){return this.getEnvelopeInternal().hashCode()}},{key:"isEquivalentClass",value:function(m){return this.getClass()===m.getClass()}},{key:"isGeometryCollectionOrDerived",value:function(){return this.getTypeCode()===U.TYPECODE_GEOMETRYCOLLECTION||this.getTypeCode()===U.TYPECODE_MULTIPOINT||this.getTypeCode()===U.TYPECODE_MULTILINESTRING||this.getTypeCode()===U.TYPECODE_MULTIPOLYGON}},{key:"interfaces_",get:function(){return[de,ye,ce]}},{key:"getClass",value:function(){return U}}],[{key:"hasNonEmptyElements",value:function(m){for(var b=0;b<m.length;b++)if(!m[b].isEmpty())return!0;return!1}},{key:"hasNullElements",value:function(m){for(var b=0;b<m.length;b++)if(m[b]===null)return!0;return!1}}]),U}();Ne.constructor_=function(U){U&&(this._envelope=null,this._userData=null,this._factory=U,this._SRID=U.getSRID())},Ne.TYPECODE_POINT=0,Ne.TYPECODE_MULTIPOINT=1,Ne.TYPECODE_LINESTRING=2,Ne.TYPECODE_LINEARRING=3,Ne.TYPECODE_MULTILINESTRING=4,Ne.TYPECODE_POLYGON=5,Ne.TYPECODE_MULTIPOLYGON=6,Ne.TYPECODE_GEOMETRYCOLLECTION=7,Ne.TYPENAME_POINT="Point",Ne.TYPENAME_MULTIPOINT="MultiPoint",Ne.TYPENAME_LINESTRING="LineString",Ne.TYPENAME_LINEARRING="LinearRing",Ne.TYPENAME_MULTILINESTRING="MultiLineString",Ne.TYPENAME_POLYGON="Polygon",Ne.TYPENAME_MULTIPOLYGON="MultiPolygon",Ne.TYPENAME_GEOMETRYCOLLECTION="GeometryCollection",Ne.geometryChangedFilter={get interfaces_(){return[_e]},filter:function(U){U.geometryChangedAction()}};var We=function(){function U(){n(this,U)}return a(U,null,[{key:"toLocationSymbol",value:function(m){switch(m){case U.EXTERIOR:return"e";case U.BOUNDARY:return"b";case U.INTERIOR:return"i";case U.NONE:return"-"}throw new le("Unknown location value: "+m)}}]),U}();We.INTERIOR=0,We.BOUNDARY=1,We.EXTERIOR=2,We.NONE=-1;var Sn=function(){function U(){n(this,U)}return a(U,[{key:"add",value:function(){}},{key:"addAll",value:function(){}},{key:"isEmpty",value:function(){}},{key:"iterator",value:function(){}},{key:"size",value:function(){}},{key:"toArray",value:function(){}},{key:"remove",value:function(){}}]),U}(),Ae=function(U){u(b,U);var m=D(b);function b(w){var R;return n(this,b),(R=m.call(this,w)).name=Object.keys({NoSuchElementException:b})[0],R}return b}(re),st=function(U){u(b,U);var m=D(b);function b(w){var R;return n(this,b),(R=m.call(this,w)).name=Object.keys({UnsupportedOperationException:b})[0],R}return b}(re),gt=function(U){u(b,U);var m=D(b);function b(){return n(this,b),m.apply(this,arguments)}return a(b,[{key:"contains",value:function(){}}]),b}(Sn),ut=function(U,m){u(w,U);var b=D(w);function w(R){var J;return n(this,w),(J=b.call(this)).map=new Map,R instanceof Sn&&J.addAll(R),J}return a(w,[{key:"contains",value:function(R){var J=R.hashCode?R.hashCode():R;return!!this.map.has(J)}},{key:"add",value:function(R){var J=R.hashCode?R.hashCode():R;return!this.map.has(J)&&!!this.map.set(J,R)}},{key:"addAll",value:function(R){var J,ve=q(R);try{for(ve.s();!(J=ve.n()).done;){var Ie=J.value;this.add(Ie)}}catch(je){ve.e(je)}finally{ve.f()}return!0}},{key:"remove",value:function(){throw new st}},{key:"size",value:function(){return this.map.size}},{key:"isEmpty",value:function(){return this.map.size===0}},{key:"toArray",value:function(){return Array.from(this.map.values())}},{key:"iterator",value:function(){return new tt(this.map)}},{key:m,value:function(){return this.map}}]),w}(gt,Symbol.iterator),tt=function(){function U(m){n(this,U),this.iterator=m.values();var b=this.iterator.next(),w=b.done,R=b.value;this.done=w,this.value=R}return a(U,[{key:"next",value:function(){if(this.done)throw new Ae;var m=this.value,b=this.iterator.next(),w=b.done,R=b.value;return this.done=w,this.value=R,m}},{key:"hasNext",value:function(){return!this.done}},{key:"remove",value:function(){throw new st}}]),U}(),nt=function(){function U(){n(this,U)}return a(U,null,[{key:"opposite",value:function(m){return m===U.LEFT?U.RIGHT:m===U.RIGHT?U.LEFT:m}}]),U}();nt.ON=0,nt.LEFT=1,nt.RIGHT=2;var tn=function(U){u(b,U);var m=D(b);function b(w){var R;return n(this,b),(R=m.call(this,w)).name=Object.keys({EmptyStackException:b})[0],R}return b}(re),un=function(U){u(b,U);var m=D(b);function b(w){var R;return n(this,b),(R=m.call(this,w)).name=Object.keys({IndexOutOfBoundsException:b})[0],R}return b}(re),qt=function(U){u(b,U);var m=D(b);function b(){return n(this,b),m.apply(this,arguments)}return a(b,[{key:"get",value:function(){}},{key:"set",value:function(){}},{key:"isEmpty",value:function(){}}]),b}(Sn),an=function(U){u(b,U);var m=D(b);function b(){var w;return n(this,b),(w=m.call(this)).array=[],w}return a(b,[{key:"add",value:function(w){return this.array.push(w),!0}},{key:"get",value:function(w){if(w<0||w>=this.size())throw new un;return this.array[w]}},{key:"push",value:function(w){return this.array.push(w),w}},{key:"pop",value:function(){if(this.array.length===0)throw new tn;return this.array.pop()}},{key:"peek",value:function(){if(this.array.length===0)throw new tn;return this.array[this.array.length-1]}},{key:"empty",value:function(){return this.array.length===0}},{key:"isEmpty",value:function(){return this.empty()}},{key:"search",value:function(w){return this.array.indexOf(w)}},{key:"size",value:function(){return this.array.length}},{key:"toArray",value:function(){return this.array.slice()}}]),b}(qt);function Jt(U,m){return U.interfaces_&&U.interfaces_.indexOf(m)>-1}var Wt=function(){function U(m){n(this,U),this.str=m}return a(U,[{key:"append",value:function(m){this.str+=m}},{key:"setCharAt",value:function(m,b){this.str=this.str.substr(0,m)+b+this.str.substr(m+1)}},{key:"toString",value:function(){return this.str}}]),U}(),Fn=function(){function U(m){n(this,U),this.value=m}return a(U,[{key:"intValue",value:function(){return this.value}},{key:"compareTo",value:function(m){return this.value<m?-1:this.value>m?1:0}}],[{key:"compare",value:function(m,b){return m<b?-1:m>b?1:0}},{key:"isNan",value:function(m){return Number.isNaN(m)}},{key:"valueOf",value:function(m){return new U(m)}}]),U}(),ar=function(){function U(){n(this,U)}return a(U,null,[{key:"isWhitespace",value:function(m){return m<=32&&m>=0||m===127}},{key:"toUpperCase",value:function(m){return m.toUpperCase()}}]),U}(),bn=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"le",value:function(m){return this._hi<m._hi||this._hi===m._hi&&this._lo<=m._lo}},{key:"extractSignificantDigits",value:function(m,b){var w=this.abs(),R=U.magnitude(w._hi),J=U.TEN.pow(R);(w=w.divide(J)).gt(U.TEN)?(w=w.divide(U.TEN),R+=1):w.lt(U.ONE)&&(w=w.multiply(U.TEN),R-=1);for(var ve=R+1,Ie=new Wt,je=U.MAX_PRINT_DIGITS-1,lt=0;lt<=je;lt++){m&&lt===ve&&Ie.append(".");var Ft=Math.trunc(w._hi);if(Ft<0)break;var Kt=!1,En=0;Ft>9?(Kt=!0,En="9"):En="0"+Ft,Ie.append(En),w=w.subtract(U.valueOf(Ft)).multiply(U.TEN),Kt&&w.selfAdd(U.TEN);var or=!0,er=U.magnitude(w._hi);if(er<0&&Math.abs(er)>=je-lt&&(or=!1),!or)break}return b[0]=R,Ie.toString()}},{key:"sqr",value:function(){return this.multiply(this)}},{key:"doubleValue",value:function(){return this._hi+this._lo}},{key:"subtract",value:function(){if(arguments[0]instanceof U){var m=arguments[0];return this.add(m.negate())}if(typeof arguments[0]=="number"){var b=arguments[0];return this.add(-b)}}},{key:"equals",value:function(){if(arguments.length===1&&arguments[0]instanceof U){var m=arguments[0];return this._hi===m._hi&&this._lo===m._lo}}},{key:"isZero",value:function(){return this._hi===0&&this._lo===0}},{key:"selfSubtract",value:function(){if(arguments[0]instanceof U){var m=arguments[0];return this.isNaN()?this:this.selfAdd(-m._hi,-m._lo)}if(typeof arguments[0]=="number"){var b=arguments[0];return this.isNaN()?this:this.selfAdd(-b,0)}}},{key:"getSpecialNumberString",value:function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null}},{key:"min",value:function(m){return this.le(m)?this:m}},{key:"selfDivide",value:function(){if(arguments.length===1){if(arguments[0]instanceof U){var m=arguments[0];return this.selfDivide(m._hi,m._lo)}if(typeof arguments[0]=="number"){var b=arguments[0];return this.selfDivide(b,0)}}else if(arguments.length===2){var w=arguments[0],R=arguments[1],J=null,ve=null,Ie=null,je=null,lt=null,Ft=null,Kt=null,En=null;return lt=this._hi/w,En=(J=(Ft=U.SPLIT*lt)-(J=Ft-lt))*(Ie=(En=U.SPLIT*w)-(Ie=En-w))-(Kt=lt*w)+J*(je=w-Ie)+(ve=lt-J)*Ie+ve*je,En=lt+(Ft=(this._hi-Kt-En+this._lo-lt*R)/w),this._hi=En,this._lo=lt-En+Ft,this}}},{key:"dump",value:function(){return"DD<"+this._hi+", "+this._lo+">"}},{key:"divide",value:function(){if(arguments[0]instanceof U){var m=arguments[0],b=null,w=null,R=null,J=null,ve=null,Ie=null,je=null,lt=null;w=(ve=this._hi/m._hi)-(b=(Ie=U.SPLIT*ve)-(b=Ie-ve)),lt=b*(R=(lt=U.SPLIT*m._hi)-(R=lt-m._hi))-(je=ve*m._hi)+b*(J=m._hi-R)+w*R+w*J;var Ft=lt=ve+(Ie=(this._hi-je-lt+this._lo-ve*m._lo)/m._hi),Kt=ve-lt+Ie;return new U(Ft,Kt)}if(typeof arguments[0]=="number"){var En=arguments[0];return Oe.isNaN(En)?U.createNaN():U.copy(this).selfDivide(En,0)}}},{key:"ge",value:function(m){return this._hi>m._hi||this._hi===m._hi&&this._lo>=m._lo}},{key:"pow",value:function(m){if(m===0)return U.valueOf(1);var b=new U(this),w=U.valueOf(1),R=Math.abs(m);if(R>1)for(;R>0;)R%2==1&&w.selfMultiply(b),(R/=2)>0&&(b=b.sqr());else w=b;return m<0?w.reciprocal():w}},{key:"ceil",value:function(){if(this.isNaN())return U.NaN;var m=Math.ceil(this._hi),b=0;return m===this._hi&&(b=Math.ceil(this._lo)),new U(m,b)}},{key:"compareTo",value:function(m){var b=m;return this._hi<b._hi?-1:this._hi>b._hi?1:this._lo<b._lo?-1:this._lo>b._lo?1:0}},{key:"rint",value:function(){return this.isNaN()?this:this.add(.5).floor()}},{key:"setValue",value:function(){if(arguments[0]instanceof U){var m=arguments[0];return this.init(m),this}if(typeof arguments[0]=="number"){var b=arguments[0];return this.init(b),this}}},{key:"max",value:function(m){return this.ge(m)?this:m}},{key:"sqrt",value:function(){if(this.isZero())return U.valueOf(0);if(this.isNegative())return U.NaN;var m=1/Math.sqrt(this._hi),b=this._hi*m,w=U.valueOf(b),R=this.subtract(w.sqr())._hi*(.5*m);return w.add(R)}},{key:"selfAdd",value:function(){if(arguments.length===1){if(arguments[0]instanceof U){var m=arguments[0];return this.selfAdd(m._hi,m._lo)}if(typeof arguments[0]=="number"){var b=arguments[0],w=null,R=null,J=null,ve=null,Ie=null,je=null;return ve=(J=this._hi+b)-(Ie=J-this._hi),R=(je=(ve=b-Ie+(this._hi-ve))+this._lo)+(J-(w=J+je)),this._hi=w+R,this._lo=R+(w-this._hi),this}}else if(arguments.length===2){var lt=arguments[0],Ft=arguments[1],Kt=null,En=null,or=null,er=null,Nr=null,Bn=null,wr=null;er=this._hi+lt,En=this._lo+Ft,Nr=er-(Bn=er-this._hi),or=En-(wr=En-this._lo);var Pi=(Kt=er+(Bn=(Nr=lt-Bn+(this._hi-Nr))+En))+(Bn=(or=Ft-wr+(this._lo-or))+(Bn+(er-Kt))),Vi=Bn+(Kt-Pi);return this._hi=Pi,this._lo=Vi,this}}},{key:"selfMultiply",value:function(){if(arguments.length===1){if(arguments[0]instanceof U){var m=arguments[0];return this.selfMultiply(m._hi,m._lo)}if(typeof arguments[0]=="number"){var b=arguments[0];return this.selfMultiply(b,0)}}else if(arguments.length===2){var w=arguments[0],R=arguments[1],J=null,ve=null,Ie=null,je=null,lt=null,Ft=null;J=(lt=U.SPLIT*this._hi)-this._hi,Ft=U.SPLIT*w,J=lt-J,ve=this._hi-J,Ie=Ft-w;var Kt=(lt=this._hi*w)+(Ft=J*(Ie=Ft-Ie)-lt+J*(je=w-Ie)+ve*Ie+ve*je+(this._hi*R+this._lo*w)),En=Ft+(J=lt-Kt);return this._hi=Kt,this._lo=En,this}}},{key:"selfSqr",value:function(){return this.selfMultiply(this)}},{key:"floor",value:function(){if(this.isNaN())return U.NaN;var m=Math.floor(this._hi),b=0;return m===this._hi&&(b=Math.floor(this._lo)),new U(m,b)}},{key:"negate",value:function(){return this.isNaN()?this:new U(-this._hi,-this._lo)}},{key:"clone",value:function(){try{return null}catch(m){if(m instanceof CloneNotSupportedException)return null;throw m}}},{key:"multiply",value:function(){if(arguments[0]instanceof U){var m=arguments[0];return m.isNaN()?U.createNaN():U.copy(this).selfMultiply(m)}if(typeof arguments[0]=="number"){var b=arguments[0];return Oe.isNaN(b)?U.createNaN():U.copy(this).selfMultiply(b,0)}}},{key:"isNaN",value:function(){return Oe.isNaN(this._hi)}},{key:"intValue",value:function(){return Math.trunc(this._hi)}},{key:"toString",value:function(){var m=U.magnitude(this._hi);return m>=-3&&m<=20?this.toStandardNotation():this.toSciNotation()}},{key:"toStandardNotation",value:function(){var m=this.getSpecialNumberString();if(m!==null)return m;var b=new Array(1).fill(null),w=this.extractSignificantDigits(!0,b),R=b[0]+1,J=w;if(w.charAt(0)===".")J="0"+w;else if(R<0)J="0."+U.stringOfChar("0",-R)+w;else if(w.indexOf(".")===-1){var ve=R-w.length;J=w+U.stringOfChar("0",ve)+".0"}return this.isNegative()?"-"+J:J}},{key:"reciprocal",value:function(){var m,b,w,R,J=null,ve=null,Ie=null,je=null;m=(w=1/this._hi)-(J=(Ie=U.SPLIT*w)-(J=Ie-w)),ve=(je=U.SPLIT*this._hi)-this._hi;var lt=w+(Ie=(1-(R=w*this._hi)-(je=J*(ve=je-ve)-R+J*(b=this._hi-ve)+m*ve+m*b)-w*this._lo)/this._hi);return new U(lt,w-lt+Ie)}},{key:"toSciNotation",value:function(){if(this.isZero())return U.SCI_NOT_ZERO;var m=this.getSpecialNumberString();if(m!==null)return m;var b=new Array(1).fill(null),w=this.extractSignificantDigits(!1,b),R=U.SCI_NOT_EXPONENT_CHAR+b[0];if(w.charAt(0)==="0")throw new IllegalStateException("Found leading zero: "+w);var J="";w.length>1&&(J=w.substring(1));var ve=w.charAt(0)+"."+J;return this.isNegative()?"-"+ve+R:ve+R}},{key:"abs",value:function(){return this.isNaN()?U.NaN:this.isNegative()?this.negate():new U(this)}},{key:"isPositive",value:function(){return this._hi>0||this._hi===0&&this._lo>0}},{key:"lt",value:function(m){return this._hi<m._hi||this._hi===m._hi&&this._lo<m._lo}},{key:"add",value:function(){if(arguments[0]instanceof U){var m=arguments[0];return U.copy(this).selfAdd(m)}if(typeof arguments[0]=="number"){var b=arguments[0];return U.copy(this).selfAdd(b)}}},{key:"init",value:function(){if(arguments.length===1){if(typeof arguments[0]=="number"){var m=arguments[0];this._hi=m,this._lo=0}else if(arguments[0]instanceof U){var b=arguments[0];this._hi=b._hi,this._lo=b._lo}}else if(arguments.length===2){var w=arguments[0],R=arguments[1];this._hi=w,this._lo=R}}},{key:"gt",value:function(m){return this._hi>m._hi||this._hi===m._hi&&this._lo>m._lo}},{key:"isNegative",value:function(){return this._hi<0||this._hi===0&&this._lo<0}},{key:"trunc",value:function(){return this.isNaN()?U.NaN:this.isPositive()?this.floor():this.ceil()}},{key:"signum",value:function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0}},{key:"interfaces_",get:function(){return[ce,ye,de]}}],[{key:"constructor_",value:function(){if(this._hi=0,this._lo=0,arguments.length===0)this.init(0);else if(arguments.length===1){if(typeof arguments[0]=="number"){var m=arguments[0];this.init(m)}else if(arguments[0]instanceof U){var b=arguments[0];this.init(b)}else if(typeof arguments[0]=="string"){var w=arguments[0];U.constructor_.call(this,U.parse(w))}}else if(arguments.length===2){var R=arguments[0],J=arguments[1];this.init(R,J)}}},{key:"determinant",value:function(){if(typeof arguments[3]=="number"&&typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var m=arguments[0],b=arguments[1],w=arguments[2],R=arguments[3];return U.determinant(U.valueOf(m),U.valueOf(b),U.valueOf(w),U.valueOf(R))}if(arguments[3]instanceof U&&arguments[2]instanceof U&&arguments[0]instanceof U&&arguments[1]instanceof U){var J=arguments[0],ve=arguments[1],Ie=arguments[2],je=arguments[3],lt=J.multiply(je).selfSubtract(ve.multiply(Ie));return lt}}},{key:"sqr",value:function(m){return U.valueOf(m).selfMultiply(m)}},{key:"valueOf",value:function(){if(typeof arguments[0]=="string"){var m=arguments[0];return U.parse(m)}if(typeof arguments[0]=="number"){var b=arguments[0];return new U(b)}}},{key:"sqrt",value:function(m){return U.valueOf(m).sqrt()}},{key:"parse",value:function(m){for(var b=0,w=m.length;ar.isWhitespace(m.charAt(b));)b++;var R=!1;if(b<w){var J=m.charAt(b);J!=="-"&&J!=="+"||(b++,J==="-"&&(R=!0))}for(var ve=new U,Ie=0,je=0,lt=0,Ft=!1;!(b>=w);){var Kt=m.charAt(b);if(b++,ar.isDigit(Kt)){var En=Kt-"0";ve.selfMultiply(U.TEN),ve.selfAdd(En),Ie++}else{if(Kt!=="."){if(Kt==="e"||Kt==="E"){var or=m.substring(b);try{lt=Fn.parseInt(or)}catch(Pi){throw Pi instanceof NumberFormatException?new NumberFormatException("Invalid exponent "+or+" in string "+m):Pi}break}throw new NumberFormatException("Unexpected character '"+Kt+"' at position "+b+" in string "+m)}je=Ie,Ft=!0}}var er=ve;Ft||(je=Ie);var Nr=Ie-je-lt;if(Nr===0)er=ve;else if(Nr>0){var Bn=U.TEN.pow(Nr);er=ve.divide(Bn)}else if(Nr<0){var wr=U.TEN.pow(-Nr);er=ve.multiply(wr)}return R?er.negate():er}},{key:"createNaN",value:function(){return new U(Oe.NaN,Oe.NaN)}},{key:"copy",value:function(m){return new U(m)}},{key:"magnitude",value:function(m){var b=Math.abs(m),w=Math.log(b)/Math.log(10),R=Math.trunc(Math.floor(w));return 10*Math.pow(10,R)<=b&&(R+=1),R}},{key:"stringOfChar",value:function(m,b){for(var w=new Wt,R=0;R<b;R++)w.append(m);return w.toString()}}]),U}();bn.PI=new bn(3.141592653589793,12246467991473532e-32),bn.TWO_PI=new bn(6.283185307179586,24492935982947064e-32),bn.PI_2=new bn(1.5707963267948966,6123233995736766e-32),bn.E=new bn(2.718281828459045,14456468917292502e-32),bn.NaN=new bn(Oe.NaN,Oe.NaN),bn.EPS=123259516440783e-46,bn.SPLIT=134217729,bn.MAX_PRINT_DIGITS=32,bn.TEN=bn.valueOf(10),bn.ONE=bn.valueOf(1),bn.SCI_NOT_EXPONENT_CHAR="E",bn.SCI_NOT_ZERO="0.0E0";var lr=function(){function U(){n(this,U)}return a(U,null,[{key:"orientationIndex",value:function(m,b,w){var R=U.orientationIndexFilter(m,b,w);if(R<=1)return R;var J=bn.valueOf(b.x).selfAdd(-m.x),ve=bn.valueOf(b.y).selfAdd(-m.y),Ie=bn.valueOf(w.x).selfAdd(-b.x),je=bn.valueOf(w.y).selfAdd(-b.y);return J.selfMultiply(je).selfSubtract(ve.selfMultiply(Ie)).signum()}},{key:"signOfDet2x2",value:function(){if(arguments[3]instanceof bn&&arguments[2]instanceof bn&&arguments[0]instanceof bn&&arguments[1]instanceof bn){var m=arguments[0],b=arguments[1],w=arguments[2],R=arguments[3],J=m.multiply(R).selfSubtract(b.multiply(w));return J.signum()}if(typeof arguments[3]=="number"&&typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var ve=arguments[0],Ie=arguments[1],je=arguments[2],lt=arguments[3],Ft=bn.valueOf(ve),Kt=bn.valueOf(Ie),En=bn.valueOf(je),or=bn.valueOf(lt),er=Ft.multiply(or).selfSubtract(Kt.multiply(En));return er.signum()}}},{key:"intersection",value:function(m,b,w,R){var J=new bn(m.y).selfSubtract(b.y),ve=new bn(b.x).selfSubtract(m.x),Ie=new bn(m.x).selfMultiply(b.y).selfSubtract(new bn(b.x).selfMultiply(m.y)),je=new bn(w.y).selfSubtract(R.y),lt=new bn(R.x).selfSubtract(w.x),Ft=new bn(w.x).selfMultiply(R.y).selfSubtract(new bn(R.x).selfMultiply(w.y)),Kt=ve.multiply(Ft).selfSubtract(lt.multiply(Ie)),En=je.multiply(Ie).selfSubtract(J.multiply(Ft)),or=J.multiply(lt).selfSubtract(je.multiply(ve)),er=Kt.selfDivide(or).doubleValue(),Nr=En.selfDivide(or).doubleValue();return Oe.isNaN(er)||Oe.isInfinite(er)||Oe.isNaN(Nr)||Oe.isInfinite(Nr)?null:new ot(er,Nr)}},{key:"orientationIndexFilter",value:function(m,b,w){var R=null,J=(m.x-w.x)*(b.y-w.y),ve=(m.y-w.y)*(b.x-w.x),Ie=J-ve;if(J>0){if(ve<=0)return U.signum(Ie);R=J+ve}else{if(!(J<0)||ve>=0)return U.signum(Ie);R=-J-ve}var je=U.DP_SAFE_EPSILON*R;return Ie>=je||-Ie>=je?U.signum(Ie):2}},{key:"signum",value:function(m){return m>0?1:m<0?-1:0}}]),U}();lr.DP_SAFE_EPSILON=1e-15;var Cn=function(){function U(){n(this,U)}return a(U,[{key:"getM",value:function(m){if(this.hasM()){var b=this.getDimension()-this.getMeasures();return this.getOrdinate(m,b)}return Oe.NaN}},{key:"setOrdinate",value:function(m,b,w){}},{key:"getZ",value:function(m){return this.hasZ()?this.getOrdinate(m,2):Oe.NaN}},{key:"size",value:function(){}},{key:"getOrdinate",value:function(m,b){}},{key:"getCoordinate",value:function(){}},{key:"getCoordinateCopy",value:function(m){}},{key:"createCoordinate",value:function(){}},{key:"getDimension",value:function(){}},{key:"hasM",value:function(){return this.getMeasures()>0}},{key:"getX",value:function(m){}},{key:"hasZ",value:function(){return this.getDimension()-this.getMeasures()>2}},{key:"getMeasures",value:function(){return 0}},{key:"expandEnvelope",value:function(m){}},{key:"copy",value:function(){}},{key:"getY",value:function(m){}},{key:"toCoordinateArray",value:function(){}},{key:"interfaces_",get:function(){return[de]}}]),U}();Cn.X=0,Cn.Y=1,Cn.Z=2,Cn.M=3;var xn=function(){function U(){n(this,U)}return a(U,null,[{key:"index",value:function(m,b,w){return lr.orientationIndex(m,b,w)}},{key:"isCCW",value:function(){if(arguments[0]instanceof Array){var m=arguments[0],b=m.length-1;if(b<3)throw new le("Ring has fewer than 4 points, so orientation cannot be determined");for(var w=m[0],R=0,J=1;J<=b;J++){var ve=m[J];ve.y>w.y&&(w=ve,R=J)}var Ie=R;do(Ie-=1)<0&&(Ie=b);while(m[Ie].equals2D(w)&&Ie!==R);var je=R;do je=(je+1)%b;while(m[je].equals2D(w)&&je!==R);var lt=m[Ie],Ft=m[je];if(lt.equals2D(w)||Ft.equals2D(w)||lt.equals2D(Ft))return!1;var Kt=U.index(lt,w,Ft),En=null;return En=Kt===0?lt.x>Ft.x:Kt>0,En}if(Jt(arguments[0],Cn)){var or=arguments[0],er=or.size()-1;if(er<3)throw new le("Ring has fewer than 4 points, so orientation cannot be determined");for(var Nr=or.getCoordinate(0),Bn=0,wr=1;wr<=er;wr++){var Pi=or.getCoordinate(wr);Pi.y>Nr.y&&(Nr=Pi,Bn=wr)}var Vi=null,Ko=Bn;do(Ko-=1)<0&&(Ko=er),Vi=or.getCoordinate(Ko);while(Vi.equals2D(Nr)&&Ko!==Bn);var so=null,ti=Bn;do ti=(ti+1)%er,so=or.getCoordinate(ti);while(so.equals2D(Nr)&&ti!==Bn);if(Vi.equals2D(Nr)||so.equals2D(Nr)||Vi.equals2D(so))return!1;var gs=U.index(Vi,Nr,so);return gs===0?Vi.x>so.x:gs>0}}}]),U}();xn.CLOCKWISE=-1,xn.RIGHT=xn.CLOCKWISE,xn.COUNTERCLOCKWISE=1,xn.LEFT=xn.COUNTERCLOCKWISE,xn.COLLINEAR=0,xn.STRAIGHT=xn.COLLINEAR;var Er=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"getCoordinate",value:function(){return this._minCoord}},{key:"getRightmostSide",value:function(m,b){var w=this.getRightmostSideOfSegment(m,b);return w<0&&(w=this.getRightmostSideOfSegment(m,b-1)),w<0&&(this._minCoord=null,this.checkForRightmostCoordinate(m)),w}},{key:"findRightmostEdgeAtVertex",value:function(){var m=this._minDe.getEdge().getCoordinates();Ue.isTrue(this._minIndex>0&&this._minIndex<m.length,"rightmost point expected to be interior vertex of edge");var b=m[this._minIndex-1],w=m[this._minIndex+1],R=xn.index(this._minCoord,w,b),J=!1;(b.y<this._minCoord.y&&w.y<this._minCoord.y&&R===xn.COUNTERCLOCKWISE||b.y>this._minCoord.y&&w.y>this._minCoord.y&&R===xn.CLOCKWISE)&&(J=!0),J&&(this._minIndex=this._minIndex-1)}},{key:"getRightmostSideOfSegment",value:function(m,b){var w=m.getEdge().getCoordinates();if(b<0||b+1>=w.length||w[b].y===w[b+1].y)return-1;var R=nt.LEFT;return w[b].y<w[b+1].y&&(R=nt.RIGHT),R}},{key:"getEdge",value:function(){return this._orientedDe}},{key:"checkForRightmostCoordinate",value:function(m){for(var b=m.getEdge().getCoordinates(),w=0;w<b.length-1;w++)(this._minCoord===null||b[w].x>this._minCoord.x)&&(this._minDe=m,this._minIndex=w,this._minCoord=b[w])}},{key:"findRightmostEdgeAtNode",value:function(){var m=this._minDe.getNode().getEdges();this._minDe=m.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)}},{key:"findEdge",value:function(m){for(var b=m.iterator();b.hasNext();){var w=b.next();w.isForward()&&this.checkForRightmostCoordinate(w)}Ue.isTrue(this._minIndex!==0||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),this._minIndex===0?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===nt.LEFT&&(this._orientedDe=this._minDe.getSym())}}],[{key:"constructor_",value:function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null}}]),U}(),Rr=function(U){u(b,U);var m=D(b);function b(w,R){var J;return n(this,b),(J=m.call(this,R?w+" [ "+R+" ]":w)).pt=R?new ot(R):void 0,J.name=Object.keys({TopologyException:b})[0],J}return a(b,[{key:"getCoordinate",value:function(){return this.pt}}]),b}(Ke),Wn=function(){function U(){n(this,U),this.array=[]}return a(U,[{key:"addLast",value:function(m){this.array.push(m)}},{key:"removeFirst",value:function(){return this.array.shift()}},{key:"isEmpty",value:function(){return this.array.length===0}}]),U}(),Mn=function(U,m){u(w,U);var b=D(w);function w(R){var J;return n(this,w),(J=b.call(this)).array=[],R instanceof Sn&&J.addAll(R),J}return a(w,[{key:"interfaces_",get:function(){return[qt,Sn]}},{key:"ensureCapacity",value:function(){}},{key:"add",value:function(R){return arguments.length===1?this.array.push(R):this.array.splice(arguments[0],0,arguments[1]),!0}},{key:"clear",value:function(){this.array=[]}},{key:"addAll",value:function(R){var J,ve=q(R);try{for(ve.s();!(J=ve.n()).done;){var Ie=J.value;this.array.push(Ie)}}catch(je){ve.e(je)}finally{ve.f()}}},{key:"set",value:function(R,J){var ve=this.array[R];return this.array[R]=J,ve}},{key:"iterator",value:function(){return new Ar(this)}},{key:"get",value:function(R){if(R<0||R>=this.size())throw new un;return this.array[R]}},{key:"isEmpty",value:function(){return this.array.length===0}},{key:"sort",value:function(R){R?this.array.sort(function(J,ve){return R.compare(J,ve)}):this.array.sort()}},{key:"size",value:function(){return this.array.length}},{key:"toArray",value:function(){return this.array.slice()}},{key:"remove",value:function(R){for(var J=0,ve=this.array.length;J<ve;J++)if(this.array[J]===R)return!!this.array.splice(J,1);return!1}},{key:m,value:function(){return this.array.values()}}]),w}(qt,Symbol.iterator),Ar=function(){function U(m){n(this,U),this.arrayList=m,this.position=0}return a(U,[{key:"next",value:function(){if(this.position===this.arrayList.size())throw new Ae;return this.arrayList.get(this.position++)}},{key:"hasNext",value:function(){return this.position<this.arrayList.size()}},{key:"set",value:function(m){return this.arrayList.set(this.position-1,m)}},{key:"remove",value:function(){this.arrayList.remove(this.arrayList.get(this.position))}}]),U}(),fi=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"clearVisitedEdges",value:function(){for(var m=this._dirEdgeList.iterator();m.hasNext();)m.next().setVisited(!1)}},{key:"getRightmostCoordinate",value:function(){return this._rightMostCoord}},{key:"computeNodeDepth",value:function(m){for(var b=null,w=m.getEdges().iterator();w.hasNext();){var R=w.next();if(R.isVisited()||R.getSym().isVisited()){b=R;break}}if(b===null)throw new Rr("unable to find edge to compute depths at "+m.getCoordinate());m.getEdges().computeDepths(b);for(var J=m.getEdges().iterator();J.hasNext();){var ve=J.next();ve.setVisited(!0),this.copySymDepths(ve)}}},{key:"computeDepth",value:function(m){this.clearVisitedEdges();var b=this._finder.getEdge();b.getNode(),b.getLabel(),b.setEdgeDepths(nt.RIGHT,m),this.copySymDepths(b),this.computeDepths(b)}},{key:"create",value:function(m){this.addReachable(m),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()}},{key:"findResultEdges",value:function(){for(var m=this._dirEdgeList.iterator();m.hasNext();){var b=m.next();b.getDepth(nt.RIGHT)>=1&&b.getDepth(nt.LEFT)<=0&&!b.isInteriorAreaEdge()&&b.setInResult(!0)}}},{key:"computeDepths",value:function(m){var b=new ut,w=new Wn,R=m.getNode();for(w.addLast(R),b.add(R),m.setVisited(!0);!w.isEmpty();){var J=w.removeFirst();b.add(J),this.computeNodeDepth(J);for(var ve=J.getEdges().iterator();ve.hasNext();){var Ie=ve.next().getSym();if(!Ie.isVisited()){var je=Ie.getNode();b.contains(je)||(w.addLast(je),b.add(je))}}}}},{key:"compareTo",value:function(m){var b=m;return this._rightMostCoord.x<b._rightMostCoord.x?-1:this._rightMostCoord.x>b._rightMostCoord.x?1:0}},{key:"getEnvelope",value:function(){if(this._env===null){for(var m=new wt,b=this._dirEdgeList.iterator();b.hasNext();)for(var w=b.next().getEdge().getCoordinates(),R=0;R<w.length-1;R++)m.expandToInclude(w[R]);this._env=m}return this._env}},{key:"addReachable",value:function(m){var b=new an;for(b.add(m);!b.empty();){var w=b.pop();this.add(w,b)}}},{key:"copySymDepths",value:function(m){var b=m.getSym();b.setDepth(nt.LEFT,m.getDepth(nt.RIGHT)),b.setDepth(nt.RIGHT,m.getDepth(nt.LEFT))}},{key:"add",value:function(m,b){m.setVisited(!0),this._nodes.add(m);for(var w=m.getEdges().iterator();w.hasNext();){var R=w.next();this._dirEdgeList.add(R);var J=R.getSym().getNode();J.isVisited()||b.push(J)}}},{key:"getNodes",value:function(){return this._nodes}},{key:"getDirectedEdges",value:function(){return this._dirEdgeList}},{key:"interfaces_",get:function(){return[ye]}}],[{key:"constructor_",value:function(){this._finder=null,this._dirEdgeList=new Mn,this._nodes=new Mn,this._rightMostCoord=null,this._env=null,this._finder=new Er}}]),U}(),yo=function(){function U(){n(this,U)}return a(U,null,[{key:"intersection",value:function(m,b,w,R){var J=m.x<b.x?m.x:b.x,ve=m.y<b.y?m.y:b.y,Ie=m.x>b.x?m.x:b.x,je=m.y>b.y?m.y:b.y,lt=w.x<R.x?w.x:R.x,Ft=w.y<R.y?w.y:R.y,Kt=w.x>R.x?w.x:R.x,En=w.y>R.y?w.y:R.y,or=((J>lt?J:lt)+(Ie<Kt?Ie:Kt))/2,er=((ve>Ft?ve:Ft)+(je<En?je:En))/2,Nr=m.x-or,Bn=m.y-er,wr=b.x-or,Pi=b.y-er,Vi=w.x-or,Ko=w.y-er,so=R.x-or,ti=R.y-er,gs=Bn-Pi,xa=wr-Nr,el=Nr*Pi-wr*Bn,da=Ko-ti,Fs=so-Vi,pd=Vi*ti-so*Ko,ju=gs*Fs-da*xa,Vu=(xa*pd-Fs*el)/ju,La=(da*el-gs*pd)/ju;return Oe.isNaN(Vu)||Oe.isInfinite(Vu)||Oe.isNaN(La)||Oe.isInfinite(La)?null:new ot(Vu+or,La+er)}}]),U}(),vr=function(){function U(){n(this,U)}return a(U,null,[{key:"arraycopy",value:function(m,b,w,R,J){for(var ve=0,Ie=b;Ie<b+J;Ie++)w[R+ve]=m[Ie],ve++}},{key:"getProperty",value:function(m){return{"line.separator":`
`}[m]}}]),U}(),zi=function(){function U(){n(this,U)}return a(U,null,[{key:"log10",value:function(m){var b=Math.log(m);return Oe.isInfinite(b)||Oe.isNaN(b)?b:b/U.LOG_10}},{key:"min",value:function(m,b,w,R){var J=m;return b<J&&(J=b),w<J&&(J=w),R<J&&(J=R),J}},{key:"clamp",value:function(){if(typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var m=arguments[0],b=arguments[1],w=arguments[2];return m<b?b:m>w?w:m}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var R=arguments[0],J=arguments[1],ve=arguments[2];return R<J?J:R>ve?ve:R}}},{key:"wrap",value:function(m,b){return m<0?b- -m%b:m%b}},{key:"max",value:function(){if(arguments.length===3){var m=arguments[0],b=arguments[1],w=arguments[2],R=m;return b>R&&(R=b),w>R&&(R=w),R}if(arguments.length===4){var J=arguments[0],ve=arguments[1],Ie=arguments[2],je=arguments[3],lt=J;return ve>lt&&(lt=ve),Ie>lt&&(lt=Ie),je>lt&&(lt=je),lt}}},{key:"average",value:function(m,b){return(m+b)/2}}]),U}();zi.LOG_10=Math.log(10);var Li=function(){function U(){n(this,U)}return a(U,null,[{key:"segmentToSegment",value:function(m,b,w,R){if(m.equals(b))return U.pointToSegment(m,w,R);if(w.equals(R))return U.pointToSegment(R,m,b);var J=!1;if(wt.intersects(m,b,w,R)){var ve=(b.x-m.x)*(R.y-w.y)-(b.y-m.y)*(R.x-w.x);if(ve===0)J=!0;else{var Ie=(m.y-w.y)*(R.x-w.x)-(m.x-w.x)*(R.y-w.y),je=((m.y-w.y)*(b.x-m.x)-(m.x-w.x)*(b.y-m.y))/ve,lt=Ie/ve;(lt<0||lt>1||je<0||je>1)&&(J=!0)}}else J=!0;return J?zi.min(U.pointToSegment(m,w,R),U.pointToSegment(b,w,R),U.pointToSegment(w,m,b),U.pointToSegment(R,m,b)):0}},{key:"pointToSegment",value:function(m,b,w){if(b.x===w.x&&b.y===w.y)return m.distance(b);var R=(w.x-b.x)*(w.x-b.x)+(w.y-b.y)*(w.y-b.y),J=((m.x-b.x)*(w.x-b.x)+(m.y-b.y)*(w.y-b.y))/R;if(J<=0)return m.distance(b);if(J>=1)return m.distance(w);var ve=((b.y-m.y)*(w.x-b.x)-(b.x-m.x)*(w.y-b.y))/R;return Math.abs(ve)*Math.sqrt(R)}},{key:"pointToLinePerpendicular",value:function(m,b,w){var R=(w.x-b.x)*(w.x-b.x)+(w.y-b.y)*(w.y-b.y),J=((b.y-m.y)*(w.x-b.x)-(b.x-m.x)*(w.y-b.y))/R;return Math.abs(J)*Math.sqrt(R)}},{key:"pointToSegmentString",value:function(m,b){if(b.length===0)throw new le("Line array must contain at least one vertex");for(var w=m.distance(b[0]),R=0;R<b.length-1;R++){var J=U.pointToSegment(m,b[R],b[R+1]);J<w&&(w=J)}return w}}]),U}(),mi=function(){function U(){n(this,U)}return a(U,[{key:"create",value:function(){if(arguments.length===1)arguments[0]instanceof Array||Jt(arguments[0],Cn);else if(arguments.length!==2){if(arguments.length===3){var m=arguments[0],b=arguments[1];return this.create(m,b)}}}}]),U}(),ji=function(){function U(){n(this,U)}return a(U,[{key:"filter",value:function(m){}}]),U}(),ko=function(){function U(){n(this,U)}return a(U,null,[{key:"ofLine",value:function(m){var b=m.size();if(b<=1)return 0;var w=0,R=new ot;m.getCoordinate(0,R);for(var J=R.x,ve=R.y,Ie=1;Ie<b;Ie++){m.getCoordinate(Ie,R);var je=R.x,lt=R.y,Ft=je-J,Kt=lt-ve;w+=Math.sqrt(Ft*Ft+Kt*Kt),J=je,ve=lt}return w}}]),U}(),qo=function U(){n(this,U)},Oo=function(){function U(){n(this,U)}return a(U,null,[{key:"copyCoord",value:function(m,b,w,R){for(var J=Math.min(m.getDimension(),w.getDimension()),ve=0;ve<J;ve++)w.setOrdinate(R,ve,m.getOrdinate(b,ve))}},{key:"isRing",value:function(m){var b=m.size();return b===0||!(b<=3)&&m.getOrdinate(0,Cn.X)===m.getOrdinate(b-1,Cn.X)&&m.getOrdinate(0,Cn.Y)===m.getOrdinate(b-1,Cn.Y)}},{key:"scroll",value:function(){if(arguments.length===2){if(Jt(arguments[0],Cn)&&Number.isInteger(arguments[1])){var m=arguments[0],b=arguments[1];U.scroll(m,b,U.isRing(m))}else if(Jt(arguments[0],Cn)&&arguments[1]instanceof ot){var w=arguments[0],R=arguments[1],J=U.indexOf(R,w);if(J<=0)return null;U.scroll(w,J)}}else if(arguments.length===3){var ve=arguments[0],Ie=arguments[1],je=arguments[2],lt=Ie;if(lt<=0)return null;for(var Ft=ve.copy(),Kt=je?ve.size()-1:ve.size(),En=0;En<Kt;En++)for(var or=0;or<ve.getDimension();or++)ve.setOrdinate(En,or,Ft.getOrdinate((Ie+En)%Kt,or));if(je)for(var er=0;er<ve.getDimension();er++)ve.setOrdinate(Kt,er,ve.getOrdinate(0,er))}}},{key:"isEqual",value:function(m,b){var w=m.size();if(w!==b.size())return!1;for(var R=Math.min(m.getDimension(),b.getDimension()),J=0;J<w;J++)for(var ve=0;ve<R;ve++){var Ie=m.getOrdinate(J,ve),je=b.getOrdinate(J,ve);if(m.getOrdinate(J,ve)!==b.getOrdinate(J,ve)&&(!Oe.isNaN(Ie)||!Oe.isNaN(je)))return!1}return!0}},{key:"minCoordinateIndex",value:function(){if(arguments.length===1){var m=arguments[0];return U.minCoordinateIndex(m,0,m.size()-1)}if(arguments.length===3){for(var b=arguments[0],w=arguments[1],R=arguments[2],J=-1,ve=null,Ie=w;Ie<=R;Ie++){var je=b.getCoordinate(Ie);(ve===null||ve.compareTo(je)>0)&&(ve=je,J=Ie)}return J}}},{key:"extend",value:function(m,b,w){var R=m.create(w,b.getDimension()),J=b.size();if(U.copy(b,0,R,0,J),J>0)for(var ve=J;ve<w;ve++)U.copy(b,J-1,R,ve,1);return R}},{key:"reverse",value:function(m){for(var b=m.size()-1,w=Math.trunc(b/2),R=0;R<=w;R++)U.swap(m,R,b-R)}},{key:"swap",value:function(m,b,w){if(b===w)return null;for(var R=0;R<m.getDimension();R++){var J=m.getOrdinate(b,R);m.setOrdinate(b,R,m.getOrdinate(w,R)),m.setOrdinate(w,R,J)}}},{key:"copy",value:function(m,b,w,R,J){for(var ve=0;ve<J;ve++)U.copyCoord(m,b+ve,w,R+ve)}},{key:"ensureValidRing",value:function(m,b){var w=b.size();return w===0?b:w<=3?U.createClosedRing(m,b,4):b.getOrdinate(0,Cn.X)===b.getOrdinate(w-1,Cn.X)&&b.getOrdinate(0,Cn.Y)===b.getOrdinate(w-1,Cn.Y)?b:U.createClosedRing(m,b,w+1)}},{key:"indexOf",value:function(m,b){for(var w=0;w<b.size();w++)if(m.x===b.getOrdinate(w,Cn.X)&&m.y===b.getOrdinate(w,Cn.Y))return w;return-1}},{key:"createClosedRing",value:function(m,b,w){var R=m.create(w,b.getDimension()),J=b.size();U.copy(b,0,R,0,J);for(var ve=J;ve<w;ve++)U.copy(b,0,R,ve,1);return R}},{key:"minCoordinate",value:function(m){for(var b=null,w=0;w<m.size();w++){var R=m.getCoordinate(w);(b===null||b.compareTo(R)>0)&&(b=R)}return b}}]),U}(),Pn=function(){function U(){n(this,U)}return a(U,null,[{key:"toDimensionSymbol",value:function(m){switch(m){case U.FALSE:return U.SYM_FALSE;case U.TRUE:return U.SYM_TRUE;case U.DONTCARE:return U.SYM_DONTCARE;case U.P:return U.SYM_P;case U.L:return U.SYM_L;case U.A:return U.SYM_A}throw new le("Unknown dimension value: "+m)}},{key:"toDimensionValue",value:function(m){switch(ar.toUpperCase(m)){case U.SYM_FALSE:return U.FALSE;case U.SYM_TRUE:return U.TRUE;case U.SYM_DONTCARE:return U.DONTCARE;case U.SYM_P:return U.P;case U.SYM_L:return U.L;case U.SYM_A:return U.A}throw new le("Unknown dimension symbol: "+m)}}]),U}();Pn.P=0,Pn.L=1,Pn.A=2,Pn.FALSE=-1,Pn.TRUE=-2,Pn.DONTCARE=-3,Pn.SYM_FALSE="F",Pn.SYM_TRUE="T",Pn.SYM_DONTCARE="*",Pn.SYM_P="0",Pn.SYM_L="1",Pn.SYM_A="2";var Vt=function(){function U(){n(this,U)}return a(U,[{key:"filter",value:function(m){}}]),U}(),ze=function(){function U(){n(this,U)}return a(U,[{key:"filter",value:function(m,b){}},{key:"isDone",value:function(){}},{key:"isGeometryChanged",value:function(){}}]),U}(),Ve=function(U){u(b,U);var m=D(b);function b(){var w;return n(this,b),w=m.call(this),b.constructor_.apply(I(w),arguments),w}return a(b,[{key:"computeEnvelopeInternal",value:function(){return this.isEmpty()?new wt:this._points.expandEnvelope(new wt)}},{key:"isRing",value:function(){return this.isClosed()&&this.isSimple()}},{key:"getCoordinates",value:function(){return this._points.toCoordinateArray()}},{key:"copyInternal",value:function(){return new b(this._points.copy(),this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof Ne){var w=arguments[0],R=arguments[1];if(!this.isEquivalentClass(w))return!1;var J=w;if(this._points.size()!==J._points.size())return!1;for(var ve=0;ve<this._points.size();ve++)if(!this.equal(this._points.getCoordinate(ve),J._points.getCoordinate(ve),R))return!1;return!0}return N(f(b.prototype),"equalsExact",this).apply(this,arguments)}},{key:"normalize",value:function(){for(var w=0;w<Math.trunc(this._points.size()/2);w++){var R=this._points.size()-1-w;if(!this._points.getCoordinate(w).equals(this._points.getCoordinate(R))){if(this._points.getCoordinate(w).compareTo(this._points.getCoordinate(R))>0){var J=this._points.copy();Oo.reverse(J),this._points=J}return null}}}},{key:"getCoordinate",value:function(){return this.isEmpty()?null:this._points.getCoordinate(0)}},{key:"getBoundaryDimension",value:function(){return this.isClosed()?Pn.FALSE:0}},{key:"isClosed",value:function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))}},{key:"reverseInternal",value:function(){var w=this._points.copy();return Oo.reverse(w),this.getFactory().createLineString(w)}},{key:"getEndPoint",value:function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)}},{key:"getTypeCode",value:function(){return Ne.TYPECODE_LINESTRING}},{key:"getDimension",value:function(){return 1}},{key:"getLength",value:function(){return ko.ofLine(this._points)}},{key:"getNumPoints",value:function(){return this._points.size()}},{key:"compareToSameClass",value:function(){if(arguments.length===1){for(var w=arguments[0],R=w,J=0,ve=0;J<this._points.size()&&ve<R._points.size();){var Ie=this._points.getCoordinate(J).compareTo(R._points.getCoordinate(ve));if(Ie!==0)return Ie;J++,ve++}return J<this._points.size()?1:ve<R._points.size()?-1:0}if(arguments.length===2){var je=arguments[0],lt=arguments[1],Ft=je;return lt.compare(this._points,Ft._points)}}},{key:"apply",value:function(){if(Jt(arguments[0],ji))for(var w=arguments[0],R=0;R<this._points.size();R++)w.filter(this._points.getCoordinate(R));else if(Jt(arguments[0],ze)){var J=arguments[0];if(this._points.size()===0)return null;for(var ve=0;ve<this._points.size()&&(J.filter(this._points,ve),!J.isDone());ve++);J.isGeometryChanged()&&this.geometryChanged()}else if(Jt(arguments[0],Vt)){var Ie=arguments[0];Ie.filter(this)}else if(Jt(arguments[0],_e)){var je=arguments[0];je.filter(this)}}},{key:"getBoundary",value:function(){throw new st}},{key:"isEquivalentClass",value:function(w){return w instanceof b}},{key:"getCoordinateN",value:function(w){return this._points.getCoordinate(w)}},{key:"getGeometryType",value:function(){return Ne.TYPENAME_LINESTRING}},{key:"getCoordinateSequence",value:function(){return this._points}},{key:"isEmpty",value:function(){return this._points.size()===0}},{key:"init",value:function(w){if(w===null&&(w=this.getFactory().getCoordinateSequenceFactory().create([])),w.size()===1)throw new le("Invalid number of points in LineString (found "+w.size()+" - must be 0 or >= 2)");this._points=w}},{key:"isCoordinate",value:function(w){for(var R=0;R<this._points.size();R++)if(this._points.getCoordinate(R).equals(w))return!0;return!1}},{key:"getStartPoint",value:function(){return this.isEmpty()?null:this.getPointN(0)}},{key:"getPointN",value:function(w){return this.getFactory().createPoint(this._points.getCoordinate(w))}},{key:"interfaces_",get:function(){return[qo]}}],[{key:"constructor_",value:function(){if(this._points=null,arguments.length!==0){if(arguments.length===2){var w=arguments[0],R=arguments[1];Ne.constructor_.call(this,R),this.init(w)}}}}]),b}(Ne),at=function U(){n(this,U)},_t=function(U){u(b,U);var m=D(b);function b(){var w;return n(this,b),w=m.call(this),b.constructor_.apply(I(w),arguments),w}return a(b,[{key:"computeEnvelopeInternal",value:function(){if(this.isEmpty())return new wt;var w=new wt;return w.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),w}},{key:"getCoordinates",value:function(){return this.isEmpty()?[]:[this.getCoordinate()]}},{key:"copyInternal",value:function(){return new b(this._coordinates.copy(),this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof Ne){var w=arguments[0],R=arguments[1];return!!this.isEquivalentClass(w)&&(!(!this.isEmpty()||!w.isEmpty())||this.isEmpty()===w.isEmpty()&&this.equal(w.getCoordinate(),this.getCoordinate(),R))}return N(f(b.prototype),"equalsExact",this).apply(this,arguments)}},{key:"normalize",value:function(){}},{key:"getCoordinate",value:function(){return this._coordinates.size()!==0?this._coordinates.getCoordinate(0):null}},{key:"getBoundaryDimension",value:function(){return Pn.FALSE}},{key:"reverseInternal",value:function(){return this.getFactory().createPoint(this._coordinates.copy())}},{key:"getTypeCode",value:function(){return Ne.TYPECODE_POINT}},{key:"getDimension",value:function(){return 0}},{key:"getNumPoints",value:function(){return this.isEmpty()?0:1}},{key:"getX",value:function(){if(this.getCoordinate()===null)throw new IllegalStateException("getX called on empty Point");return this.getCoordinate().x}},{key:"compareToSameClass",value:function(){if(arguments.length===1){var w=arguments[0],R=w;return this.getCoordinate().compareTo(R.getCoordinate())}if(arguments.length===2){var J=arguments[0],ve=arguments[1],Ie=J;return ve.compare(this._coordinates,Ie._coordinates)}}},{key:"apply",value:function(){if(Jt(arguments[0],ji)){var w=arguments[0];if(this.isEmpty())return null;w.filter(this.getCoordinate())}else if(Jt(arguments[0],ze)){var R=arguments[0];if(this.isEmpty())return null;R.filter(this._coordinates,0),R.isGeometryChanged()&&this.geometryChanged()}else if(Jt(arguments[0],Vt)){var J=arguments[0];J.filter(this)}else if(Jt(arguments[0],_e)){var ve=arguments[0];ve.filter(this)}}},{key:"getBoundary",value:function(){return this.getFactory().createGeometryCollection()}},{key:"getGeometryType",value:function(){return Ne.TYPENAME_POINT}},{key:"getCoordinateSequence",value:function(){return this._coordinates}},{key:"getY",value:function(){if(this.getCoordinate()===null)throw new IllegalStateException("getY called on empty Point");return this.getCoordinate().y}},{key:"isEmpty",value:function(){return this._coordinates.size()===0}},{key:"init",value:function(w){w===null&&(w=this.getFactory().getCoordinateSequenceFactory().create([])),Ue.isTrue(w.size()<=1),this._coordinates=w}},{key:"isSimple",value:function(){return!0}},{key:"interfaces_",get:function(){return[at]}}],[{key:"constructor_",value:function(){this._coordinates=null;var w=arguments[0],R=arguments[1];Ne.constructor_.call(this,R),this.init(w)}}]),b}(Ne),ht=function(){function U(){n(this,U)}return a(U,null,[{key:"ofRing",value:function(){if(arguments[0]instanceof Array){var m=arguments[0];return Math.abs(U.ofRingSigned(m))}if(Jt(arguments[0],Cn)){var b=arguments[0];return Math.abs(U.ofRingSigned(b))}}},{key:"ofRingSigned",value:function(){if(arguments[0]instanceof Array){var m=arguments[0];if(m.length<3)return 0;for(var b=0,w=m[0].x,R=1;R<m.length-1;R++){var J=m[R].x-w,ve=m[R+1].y,Ie=m[R-1].y;b+=J*(Ie-ve)}return b/2}if(Jt(arguments[0],Cn)){var je=arguments[0],lt=je.size();if(lt<3)return 0;var Ft=new ot,Kt=new ot,En=new ot;je.getCoordinate(0,Kt),je.getCoordinate(1,En);var or=Kt.x;En.x-=or;for(var er=0,Nr=1;Nr<lt-1;Nr++)Ft.y=Kt.y,Kt.x=En.x,Kt.y=En.y,je.getCoordinate(Nr+1,En),En.x-=or,er+=Kt.x*(Ft.y-En.y);return er/2}}}]),U}(),Mt=function(){function U(){n(this,U)}return a(U,null,[{key:"sort",value:function(){var m=arguments,b=arguments[0];if(arguments.length===1)b.sort(function(or,er){return or.compareTo(er)});else if(arguments.length===2)b.sort(function(or,er){return m[1].compare(or,er)});else if(arguments.length===3){var w=b.slice(arguments[1],arguments[2]);w.sort();var R=b.slice(0,arguments[1]).concat(w,b.slice(arguments[2],b.length));b.splice(0,b.length);var J,ve=q(R);try{for(ve.s();!(J=ve.n()).done;){var Ie=J.value;b.push(Ie)}}catch(or){ve.e(or)}finally{ve.f()}}else if(arguments.length===4){var je=b.slice(arguments[1],arguments[2]);je.sort(function(or,er){return m[3].compare(or,er)});var lt=b.slice(0,arguments[1]).concat(je,b.slice(arguments[2],b.length));b.splice(0,b.length);var Ft,Kt=q(lt);try{for(Kt.s();!(Ft=Kt.n()).done;){var En=Ft.value;b.push(En)}}catch(or){Kt.e(or)}finally{Kt.f()}}}},{key:"asList",value:function(m){var b,w=new Mn,R=q(m);try{for(R.s();!(b=R.n()).done;){var J=b.value;w.add(J)}}catch(ve){R.e(ve)}finally{R.f()}return w}},{key:"copyOf",value:function(m,b){return m.slice(0,b)}}]),U}(),Xt=function U(){n(this,U)},At=function(U){u(b,U);var m=D(b);function b(){var w;return n(this,b),w=m.call(this),b.constructor_.apply(I(w),arguments),w}return a(b,[{key:"computeEnvelopeInternal",value:function(){return this._shell.getEnvelopeInternal()}},{key:"getCoordinates",value:function(){if(this.isEmpty())return[];for(var w=new Array(this.getNumPoints()).fill(null),R=-1,J=this._shell.getCoordinates(),ve=0;ve<J.length;ve++)w[++R]=J[ve];for(var Ie=0;Ie<this._holes.length;Ie++)for(var je=this._holes[Ie].getCoordinates(),lt=0;lt<je.length;lt++)w[++R]=je[lt];return w}},{key:"getArea",value:function(){var w=0;w+=ht.ofRing(this._shell.getCoordinateSequence());for(var R=0;R<this._holes.length;R++)w-=ht.ofRing(this._holes[R].getCoordinateSequence());return w}},{key:"copyInternal",value:function(){for(var w=this._shell.copy(),R=new Array(this._holes.length).fill(null),J=0;J<this._holes.length;J++)R[J]=this._holes[J].copy();return new b(w,R,this._factory)}},{key:"isRectangle",value:function(){if(this.getNumInteriorRing()!==0||this._shell===null||this._shell.getNumPoints()!==5)return!1;for(var w=this._shell.getCoordinateSequence(),R=this.getEnvelopeInternal(),J=0;J<5;J++){var ve=w.getX(J);if(ve!==R.getMinX()&&ve!==R.getMaxX())return!1;var Ie=w.getY(J);if(Ie!==R.getMinY()&&Ie!==R.getMaxY())return!1}for(var je=w.getX(0),lt=w.getY(0),Ft=1;Ft<=4;Ft++){var Kt=w.getX(Ft),En=w.getY(Ft);if(Kt!==je==(En!==lt))return!1;je=Kt,lt=En}return!0}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof Ne){var w=arguments[0],R=arguments[1];if(!this.isEquivalentClass(w))return!1;var J=w,ve=this._shell,Ie=J._shell;if(!ve.equalsExact(Ie,R)||this._holes.length!==J._holes.length)return!1;for(var je=0;je<this._holes.length;je++)if(!this._holes[je].equalsExact(J._holes[je],R))return!1;return!0}return N(f(b.prototype),"equalsExact",this).apply(this,arguments)}},{key:"normalize",value:function(){if(arguments.length===0){this._shell=this.normalized(this._shell,!0);for(var w=0;w<this._holes.length;w++)this._holes[w]=this.normalized(this._holes[w],!1);Mt.sort(this._holes)}else if(arguments.length===2){var R=arguments[0],J=arguments[1];if(R.isEmpty())return null;var ve=R.getCoordinateSequence(),Ie=Oo.minCoordinateIndex(ve,0,ve.size()-2);Oo.scroll(ve,Ie,!0),xn.isCCW(ve)===J&&Oo.reverse(ve)}}},{key:"getCoordinate",value:function(){return this._shell.getCoordinate()}},{key:"getNumInteriorRing",value:function(){return this._holes.length}},{key:"getBoundaryDimension",value:function(){return 1}},{key:"reverseInternal",value:function(){for(var w=this.getExteriorRing().reverse(),R=new Array(this.getNumInteriorRing()).fill(null),J=0;J<R.length;J++)R[J]=this.getInteriorRingN(J).reverse();return this.getFactory().createPolygon(w,R)}},{key:"getTypeCode",value:function(){return Ne.TYPECODE_POLYGON}},{key:"getDimension",value:function(){return 2}},{key:"getLength",value:function(){var w=0;w+=this._shell.getLength();for(var R=0;R<this._holes.length;R++)w+=this._holes[R].getLength();return w}},{key:"getNumPoints",value:function(){for(var w=this._shell.getNumPoints(),R=0;R<this._holes.length;R++)w+=this._holes[R].getNumPoints();return w}},{key:"convexHull",value:function(){return this.getExteriorRing().convexHull()}},{key:"normalized",value:function(w,R){var J=w.copy();return this.normalize(J,R),J}},{key:"compareToSameClass",value:function(){if(arguments.length===1){var w=arguments[0],R=this._shell,J=w._shell;return R.compareToSameClass(J)}if(arguments.length===2){var ve=arguments[0],Ie=arguments[1],je=ve,lt=this._shell,Ft=je._shell,Kt=lt.compareToSameClass(Ft,Ie);if(Kt!==0)return Kt;for(var En=this.getNumInteriorRing(),or=je.getNumInteriorRing(),er=0;er<En&&er<or;){var Nr=this.getInteriorRingN(er),Bn=je.getInteriorRingN(er),wr=Nr.compareToSameClass(Bn,Ie);if(wr!==0)return wr;er++}return er<En?1:er<or?-1:0}}},{key:"apply",value:function(){if(Jt(arguments[0],ji)){var w=arguments[0];this._shell.apply(w);for(var R=0;R<this._holes.length;R++)this._holes[R].apply(w)}else if(Jt(arguments[0],ze)){var J=arguments[0];if(this._shell.apply(J),!J.isDone())for(var ve=0;ve<this._holes.length&&(this._holes[ve].apply(J),!J.isDone());ve++);J.isGeometryChanged()&&this.geometryChanged()}else if(Jt(arguments[0],Vt)){var Ie=arguments[0];Ie.filter(this)}else if(Jt(arguments[0],_e)){var je=arguments[0];je.filter(this),this._shell.apply(je);for(var lt=0;lt<this._holes.length;lt++)this._holes[lt].apply(je)}}},{key:"getBoundary",value:function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var w=new Array(this._holes.length+1).fill(null);w[0]=this._shell;for(var R=0;R<this._holes.length;R++)w[R+1]=this._holes[R];return w.length<=1?this.getFactory().createLinearRing(w[0].getCoordinateSequence()):this.getFactory().createMultiLineString(w)}},{key:"getGeometryType",value:function(){return Ne.TYPENAME_POLYGON}},{key:"getExteriorRing",value:function(){return this._shell}},{key:"isEmpty",value:function(){return this._shell.isEmpty()}},{key:"getInteriorRingN",value:function(w){return this._holes[w]}},{key:"interfaces_",get:function(){return[Xt]}}],[{key:"constructor_",value:function(){this._shell=null,this._holes=null;var w=arguments[0],R=arguments[1],J=arguments[2];if(Ne.constructor_.call(this,J),w===null&&(w=this.getFactory().createLinearRing()),R===null&&(R=[]),Ne.hasNullElements(R))throw new le("holes must not contain null elements");if(w.isEmpty()&&Ne.hasNonEmptyElements(R))throw new le("shell is empty but holes are not");this._shell=w,this._holes=R}}]),b}(Ne),Gt=function(U){u(b,U);var m=D(b);function b(){return n(this,b),m.apply(this,arguments)}return b}(gt),Zt=function(U){u(b,U);var m=D(b);function b(w){var R;return n(this,b),(R=m.call(this)).array=[],w instanceof Sn&&R.addAll(w),R}return a(b,[{key:"contains",value:function(w){var R,J=q(this.array);try{for(J.s();!(R=J.n()).done;)if(R.value.compareTo(w)===0)return!0}catch(ve){J.e(ve)}finally{J.f()}return!1}},{key:"add",value:function(w){if(this.contains(w))return!1;for(var R=0,J=this.array.length;R<J;R++)if(this.array[R].compareTo(w)===1)return!!this.array.splice(R,0,w);return this.array.push(w),!0}},{key:"addAll",value:function(w){var R,J=q(w);try{for(J.s();!(R=J.n()).done;){var ve=R.value;this.add(ve)}}catch(Ie){J.e(Ie)}finally{J.f()}return!0}},{key:"remove",value:function(){throw new st}},{key:"size",value:function(){return this.array.length}},{key:"isEmpty",value:function(){return this.array.length===0}},{key:"toArray",value:function(){return this.array.slice()}},{key:"iterator",value:function(){return new Ht(this.array)}}]),b}(Gt),Ht=function(){function U(m){n(this,U),this.array=m,this.position=0}return a(U,[{key:"next",value:function(){if(this.position===this.array.length)throw new Ae;return this.array[this.position++]}},{key:"hasNext",value:function(){return this.position<this.array.length}},{key:"remove",value:function(){throw new st}}]),U}(),fn=function(U){u(b,U);var m=D(b);function b(){var w;return n(this,b),w=m.call(this),b.constructor_.apply(I(w),arguments),w}return a(b,[{key:"computeEnvelopeInternal",value:function(){for(var w=new wt,R=0;R<this._geometries.length;R++)w.expandToInclude(this._geometries[R].getEnvelopeInternal());return w}},{key:"getGeometryN",value:function(w){return this._geometries[w]}},{key:"getCoordinates",value:function(){for(var w=new Array(this.getNumPoints()).fill(null),R=-1,J=0;J<this._geometries.length;J++)for(var ve=this._geometries[J].getCoordinates(),Ie=0;Ie<ve.length;Ie++)w[++R]=ve[Ie];return w}},{key:"getArea",value:function(){for(var w=0,R=0;R<this._geometries.length;R++)w+=this._geometries[R].getArea();return w}},{key:"copyInternal",value:function(){for(var w=new Array(this._geometries.length).fill(null),R=0;R<w.length;R++)w[R]=this._geometries[R].copy();return new b(w,this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof Ne){var w=arguments[0],R=arguments[1];if(!this.isEquivalentClass(w))return!1;var J=w;if(this._geometries.length!==J._geometries.length)return!1;for(var ve=0;ve<this._geometries.length;ve++)if(!this._geometries[ve].equalsExact(J._geometries[ve],R))return!1;return!0}return N(f(b.prototype),"equalsExact",this).apply(this,arguments)}},{key:"normalize",value:function(){for(var w=0;w<this._geometries.length;w++)this._geometries[w].normalize();Mt.sort(this._geometries)}},{key:"getCoordinate",value:function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()}},{key:"getBoundaryDimension",value:function(){for(var w=Pn.FALSE,R=0;R<this._geometries.length;R++)w=Math.max(w,this._geometries[R].getBoundaryDimension());return w}},{key:"reverseInternal",value:function(){for(var w=this._geometries.length,R=new Mn(w),J=0;J<w;J++)R.add(this._geometries[J].reverse());return this.getFactory().buildGeometry(R)}},{key:"getTypeCode",value:function(){return Ne.TYPECODE_GEOMETRYCOLLECTION}},{key:"getDimension",value:function(){for(var w=Pn.FALSE,R=0;R<this._geometries.length;R++)w=Math.max(w,this._geometries[R].getDimension());return w}},{key:"getLength",value:function(){for(var w=0,R=0;R<this._geometries.length;R++)w+=this._geometries[R].getLength();return w}},{key:"getNumPoints",value:function(){for(var w=0,R=0;R<this._geometries.length;R++)w+=this._geometries[R].getNumPoints();return w}},{key:"getNumGeometries",value:function(){return this._geometries.length}},{key:"compareToSameClass",value:function(){if(arguments.length===1){var w=arguments[0],R=new Zt(Mt.asList(this._geometries)),J=new Zt(Mt.asList(w._geometries));return this.compare(R,J)}if(arguments.length===2){for(var ve=arguments[0],Ie=arguments[1],je=ve,lt=this.getNumGeometries(),Ft=je.getNumGeometries(),Kt=0;Kt<lt&&Kt<Ft;){var En=this.getGeometryN(Kt),or=je.getGeometryN(Kt),er=En.compareToSameClass(or,Ie);if(er!==0)return er;Kt++}return Kt<lt?1:Kt<Ft?-1:0}}},{key:"apply",value:function(){if(Jt(arguments[0],ji))for(var w=arguments[0],R=0;R<this._geometries.length;R++)this._geometries[R].apply(w);else if(Jt(arguments[0],ze)){var J=arguments[0];if(this._geometries.length===0)return null;for(var ve=0;ve<this._geometries.length&&(this._geometries[ve].apply(J),!J.isDone());ve++);J.isGeometryChanged()&&this.geometryChanged()}else if(Jt(arguments[0],Vt)){var Ie=arguments[0];Ie.filter(this);for(var je=0;je<this._geometries.length;je++)this._geometries[je].apply(Ie)}else if(Jt(arguments[0],_e)){var lt=arguments[0];lt.filter(this);for(var Ft=0;Ft<this._geometries.length;Ft++)this._geometries[Ft].apply(lt)}}},{key:"getBoundary",value:function(){return Ne.checkNotGeometryCollection(this),Ue.shouldNeverReachHere(),null}},{key:"getGeometryType",value:function(){return Ne.TYPENAME_GEOMETRYCOLLECTION}},{key:"isEmpty",value:function(){for(var w=0;w<this._geometries.length;w++)if(!this._geometries[w].isEmpty())return!1;return!0}}],[{key:"constructor_",value:function(){if(this._geometries=null,arguments.length!==0){if(arguments.length===2){var w=arguments[0],R=arguments[1];if(Ne.constructor_.call(this,R),w===null&&(w=[]),Ne.hasNullElements(w))throw new le("geometries must not contain null elements");this._geometries=w}}}}]),b}(Ne),Nt=function(U){u(b,U);var m=D(b);function b(){var w;return n(this,b),w=m.call(this),b.constructor_.apply(I(w),arguments),w}return a(b,[{key:"copyInternal",value:function(){for(var w=new Array(this._geometries.length).fill(null),R=0;R<w.length;R++)w[R]=this._geometries[R].copy();return new b(w,this._factory)}},{key:"isValid",value:function(){return!0}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof Ne){var w=arguments[0],R=arguments[1];return!!this.isEquivalentClass(w)&&N(f(b.prototype),"equalsExact",this).call(this,w,R)}return N(f(b.prototype),"equalsExact",this).apply(this,arguments)}},{key:"getCoordinate",value:function(){if(arguments.length===1&&Number.isInteger(arguments[0])){var w=arguments[0];return this._geometries[w].getCoordinate()}return N(f(b.prototype),"getCoordinate",this).apply(this,arguments)}},{key:"getBoundaryDimension",value:function(){return Pn.FALSE}},{key:"getTypeCode",value:function(){return Ne.TYPECODE_MULTIPOINT}},{key:"getDimension",value:function(){return 0}},{key:"getBoundary",value:function(){return this.getFactory().createGeometryCollection()}},{key:"getGeometryType",value:function(){return Ne.TYPENAME_MULTIPOINT}},{key:"interfaces_",get:function(){return[at]}}],[{key:"constructor_",value:function(){var w=arguments[0],R=arguments[1];fn.constructor_.call(this,w,R)}}]),b}(fn),zt=function(U){u(b,U);var m=D(b);function b(){var w;return n(this,b),w=m.call(this),b.constructor_.apply(I(w),arguments),w}return a(b,[{key:"copyInternal",value:function(){return new b(this._points.copy(),this._factory)}},{key:"getBoundaryDimension",value:function(){return Pn.FALSE}},{key:"isClosed",value:function(){return!!this.isEmpty()||N(f(b.prototype),"isClosed",this).call(this)}},{key:"reverseInternal",value:function(){var w=this._points.copy();return Oo.reverse(w),this.getFactory().createLinearRing(w)}},{key:"getTypeCode",value:function(){return Ne.TYPECODE_LINEARRING}},{key:"validateConstruction",value:function(){if(!this.isEmpty()&&!N(f(b.prototype),"isClosed",this).call(this))throw new le("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<b.MINIMUM_VALID_SIZE)throw new le("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")}},{key:"getGeometryType",value:function(){return Ne.TYPENAME_LINEARRING}}],[{key:"constructor_",value:function(){var w=arguments[0],R=arguments[1];Ve.constructor_.call(this,w,R),this.validateConstruction()}}]),b}(Ve);zt.MINIMUM_VALID_SIZE=4;var yn=function(U){u(b,U);var m=D(b);function b(){var w;return n(this,b),w=m.call(this),b.constructor_.apply(I(w),arguments),w}return a(b,[{key:"setOrdinate",value:function(w,R){switch(w){case b.X:this.x=R;break;case b.Y:this.y=R;break;default:throw new le("Invalid ordinate index: "+w)}}},{key:"getZ",value:function(){return ot.NULL_ORDINATE}},{key:"getOrdinate",value:function(w){switch(w){case b.X:return this.x;case b.Y:return this.y}throw new le("Invalid ordinate index: "+w)}},{key:"setZ",value:function(w){throw new le("CoordinateXY dimension 2 does not support z-ordinate")}},{key:"copy",value:function(){return new b(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+")"}},{key:"setCoordinate",value:function(w){this.x=w.x,this.y=w.y,this.z=w.getZ()}}],[{key:"constructor_",value:function(){if(arguments.length===0)ot.constructor_.call(this);else if(arguments.length===1){if(arguments[0]instanceof b){var w=arguments[0];ot.constructor_.call(this,w.x,w.y)}else if(arguments[0]instanceof ot){var R=arguments[0];ot.constructor_.call(this,R.x,R.y)}}else if(arguments.length===2){var J=arguments[0],ve=arguments[1];ot.constructor_.call(this,J,ve,ot.NULL_ORDINATE)}}}]),b}(ot);yn.X=0,yn.Y=1,yn.Z=-1,yn.M=-1;var qn=function(U){u(b,U);var m=D(b);function b(){var w;return n(this,b),w=m.call(this),b.constructor_.apply(I(w),arguments),w}return a(b,[{key:"getM",value:function(){return this._m}},{key:"setOrdinate",value:function(w,R){switch(w){case b.X:this.x=R;break;case b.Y:this.y=R;break;case b.M:this._m=R;break;default:throw new le("Invalid ordinate index: "+w)}}},{key:"setM",value:function(w){this._m=w}},{key:"getZ",value:function(){return ot.NULL_ORDINATE}},{key:"getOrdinate",value:function(w){switch(w){case b.X:return this.x;case b.Y:return this.y;case b.M:return this._m}throw new le("Invalid ordinate index: "+w)}},{key:"setZ",value:function(w){throw new le("CoordinateXY dimension 2 does not support z-ordinate")}},{key:"copy",value:function(){return new b(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+" m="+this.getM()+")"}},{key:"setCoordinate",value:function(w){this.x=w.x,this.y=w.y,this.z=w.getZ(),this._m=w.getM()}}],[{key:"constructor_",value:function(){if(this._m=null,arguments.length===0)ot.constructor_.call(this),this._m=0;else if(arguments.length===1){if(arguments[0]instanceof b){var w=arguments[0];ot.constructor_.call(this,w.x,w.y),this._m=w._m}else if(arguments[0]instanceof ot){var R=arguments[0];ot.constructor_.call(this,R.x,R.y),this._m=this.getM()}}else if(arguments.length===3){var J=arguments[0],ve=arguments[1],Ie=arguments[2];ot.constructor_.call(this,J,ve,ot.NULL_ORDINATE),this._m=Ie}}}]),b}(ot);qn.X=0,qn.Y=1,qn.Z=-1,qn.M=2;var Jn=function(U){u(b,U);var m=D(b);function b(){var w;return n(this,b),w=m.call(this),b.constructor_.apply(I(w),arguments),w}return a(b,[{key:"getM",value:function(){return this._m}},{key:"setOrdinate",value:function(w,R){switch(w){case ot.X:this.x=R;break;case ot.Y:this.y=R;break;case ot.Z:this.z=R;break;case ot.M:this._m=R;break;default:throw new le("Invalid ordinate index: "+w)}}},{key:"setM",value:function(w){this._m=w}},{key:"getOrdinate",value:function(w){switch(w){case ot.X:return this.x;case ot.Y:return this.y;case ot.Z:return this.getZ();case ot.M:return this.getM()}throw new le("Invalid ordinate index: "+w)}},{key:"copy",value:function(){return new b(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+", "+this.getZ()+" m="+this.getM()+")"}},{key:"setCoordinate",value:function(w){this.x=w.x,this.y=w.y,this.z=w.getZ(),this._m=w.getM()}}],[{key:"constructor_",value:function(){if(this._m=null,arguments.length===0)ot.constructor_.call(this),this._m=0;else if(arguments.length===1){if(arguments[0]instanceof b){var w=arguments[0];ot.constructor_.call(this,w),this._m=w._m}else if(arguments[0]instanceof ot){var R=arguments[0];ot.constructor_.call(this,R),this._m=this.getM()}}else if(arguments.length===4){var J=arguments[0],ve=arguments[1],Ie=arguments[2],je=arguments[3];ot.constructor_.call(this,J,ve,Ie),this._m=je}}}]),b}(ot),ur=function(){function U(){n(this,U)}return a(U,null,[{key:"measures",value:function(m){return m instanceof yn?0:m instanceof qn||m instanceof Jn?1:0}},{key:"dimension",value:function(m){return m instanceof yn?2:m instanceof qn?3:m instanceof Jn?4:3}},{key:"create",value:function(){if(arguments.length===1){var m=arguments[0];return U.create(m,0)}if(arguments.length===2){var b=arguments[0],w=arguments[1];return b===2?new yn:b===3&&w===0?new ot:b===3&&w===1?new qn:b===4&&w===1?new Jn:new ot}}}]),U}(),Cr=function(U){u(b,U);var m=D(b);function b(){var w;return n(this,b),w=m.call(this),b.constructor_.apply(I(w),arguments),w}return a(b,[{key:"getCoordinate",value:function(w){return this.get(w)}},{key:"addAll",value:function(){if(arguments.length===2&&typeof arguments[1]=="boolean"&&Jt(arguments[0],Sn)){for(var w=arguments[0],R=arguments[1],J=!1,ve=w.iterator();ve.hasNext();)this.add(ve.next(),R),J=!0;return J}return N(f(b.prototype),"addAll",this).apply(this,arguments)}},{key:"clone",value:function(){for(var w=N(f(b.prototype),"clone",this).call(this),R=0;R<this.size();R++)w.add(R,this.get(R).clone());return w}},{key:"toCoordinateArray",value:function(){if(arguments.length===0)return this.toArray(b.coordArrayType);if(arguments.length===1){var w=arguments[0];if(w)return this.toArray(b.coordArrayType);for(var R=this.size(),J=new Array(R).fill(null),ve=0;ve<R;ve++)J[ve]=this.get(R-ve-1);return J}}},{key:"add",value:function(){if(arguments.length===1){var w=arguments[0];return N(f(b.prototype),"add",this).call(this,w)}if(arguments.length===2){if(arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var R=arguments[0],J=arguments[1];return this.add(R,J,!0),!0}if(arguments[0]instanceof ot&&typeof arguments[1]=="boolean"){var ve=arguments[0],Ie=arguments[1];if(!Ie&&this.size()>=1){var je=this.get(this.size()-1);if(je.equals2D(ve))return null}N(f(b.prototype),"add",this).call(this,ve)}else if(arguments[0]instanceof Object&&typeof arguments[1]=="boolean"){var lt=arguments[0],Ft=arguments[1];return this.add(lt,Ft),!0}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var Kt=arguments[0],En=arguments[1],or=arguments[2];if(or)for(var er=0;er<Kt.length;er++)this.add(Kt[er],En);else for(var Nr=Kt.length-1;Nr>=0;Nr--)this.add(Kt[Nr],En);return!0}if(typeof arguments[2]=="boolean"&&Number.isInteger(arguments[0])&&arguments[1]instanceof ot){var Bn=arguments[0],wr=arguments[1],Pi=arguments[2];if(!Pi){var Vi=this.size();if(Vi>0){if(Bn>0){var Ko=this.get(Bn-1);if(Ko.equals2D(wr))return null}if(Bn<Vi){var so=this.get(Bn);if(so.equals2D(wr))return null}}}N(f(b.prototype),"add",this).call(this,Bn,wr)}}else if(arguments.length===4){var ti=arguments[0],gs=arguments[1],xa=arguments[2],el=arguments[3],da=1;xa>el&&(da=-1);for(var Fs=xa;Fs!==el;Fs+=da)this.add(ti[Fs],gs);return!0}}},{key:"closeRing",value:function(){if(this.size()>0){var w=this.get(0).copy();this.add(w,!1)}}}],[{key:"constructor_",value:function(){if(arguments.length!==0){if(arguments.length===1){var w=arguments[0];this.ensureCapacity(w.length),this.add(w,!0)}else if(arguments.length===2){var R=arguments[0],J=arguments[1];this.ensureCapacity(R.length),this.add(R,J)}}}}]),b}(Mn);Cr.coordArrayType=new Array(0).fill(null);var Or=function(){function U(){n(this,U)}return a(U,null,[{key:"isRing",value:function(m){return!(m.length<4)&&!!m[0].equals2D(m[m.length-1])}},{key:"ptNotInList",value:function(m,b){for(var w=0;w<m.length;w++){var R=m[w];if(U.indexOf(R,b)<0)return R}return null}},{key:"scroll",value:function(m,b){var w=U.indexOf(b,m);if(w<0)return null;var R=new Array(m.length).fill(null);vr.arraycopy(m,w,R,0,m.length-w),vr.arraycopy(m,0,R,m.length-w,w),vr.arraycopy(R,0,m,0,m.length)}},{key:"equals",value:function(){if(arguments.length===2){var m=arguments[0],b=arguments[1];if(m===b)return!0;if(m===null||b===null||m.length!==b.length)return!1;for(var w=0;w<m.length;w++)if(!m[w].equals(b[w]))return!1;return!0}if(arguments.length===3){var R=arguments[0],J=arguments[1],ve=arguments[2];if(R===J)return!0;if(R===null||J===null||R.length!==J.length)return!1;for(var Ie=0;Ie<R.length;Ie++)if(ve.compare(R[Ie],J[Ie])!==0)return!1;return!0}}},{key:"intersection",value:function(m,b){for(var w=new Cr,R=0;R<m.length;R++)b.intersects(m[R])&&w.add(m[R],!0);return w.toCoordinateArray()}},{key:"measures",value:function(m){if(m===null||m.length===0)return 0;var b,w=0,R=q(m);try{for(R.s();!(b=R.n()).done;){var J=b.value;w=Math.max(w,ur.measures(J))}}catch(ve){R.e(ve)}finally{R.f()}return w}},{key:"hasRepeatedPoints",value:function(m){for(var b=1;b<m.length;b++)if(m[b-1].equals(m[b]))return!0;return!1}},{key:"removeRepeatedPoints",value:function(m){return U.hasRepeatedPoints(m)?new Cr(m,!1).toCoordinateArray():m}},{key:"reverse",value:function(m){for(var b=m.length-1,w=Math.trunc(b/2),R=0;R<=w;R++){var J=m[R];m[R]=m[b-R],m[b-R]=J}}},{key:"removeNull",value:function(m){for(var b=0,w=0;w<m.length;w++)m[w]!==null&&b++;var R=new Array(b).fill(null);if(b===0)return R;for(var J=0,ve=0;ve<m.length;ve++)m[ve]!==null&&(R[J++]=m[ve]);return R}},{key:"copyDeep",value:function(){if(arguments.length===1){for(var m=arguments[0],b=new Array(m.length).fill(null),w=0;w<m.length;w++)b[w]=m[w].copy();return b}if(arguments.length===5)for(var R=arguments[0],J=arguments[1],ve=arguments[2],Ie=arguments[3],je=arguments[4],lt=0;lt<je;lt++)ve[Ie+lt]=R[J+lt].copy()}},{key:"isEqualReversed",value:function(m,b){for(var w=0;w<m.length;w++){var R=m[w],J=b[m.length-w-1];if(R.compareTo(J)!==0)return!1}return!0}},{key:"envelope",value:function(m){for(var b=new wt,w=0;w<m.length;w++)b.expandToInclude(m[w]);return b}},{key:"toCoordinateArray",value:function(m){return m.toArray(U.coordArrayType)}},{key:"dimension",value:function(m){if(m===null||m.length===0)return 3;var b,w=0,R=q(m);try{for(R.s();!(b=R.n()).done;){var J=b.value;w=Math.max(w,ur.dimension(J))}}catch(ve){R.e(ve)}finally{R.f()}return w}},{key:"atLeastNCoordinatesOrNothing",value:function(m,b){return b.length>=m?b:[]}},{key:"indexOf",value:function(m,b){for(var w=0;w<b.length;w++)if(m.equals(b[w]))return w;return-1}},{key:"increasingDirection",value:function(m){for(var b=0;b<Math.trunc(m.length/2);b++){var w=m.length-1-b,R=m[b].compareTo(m[w]);if(R!==0)return R}return 1}},{key:"compare",value:function(m,b){for(var w=0;w<m.length&&w<b.length;){var R=m[w].compareTo(b[w]);if(R!==0)return R;w++}return w<b.length?-1:w<m.length?1:0}},{key:"minCoordinate",value:function(m){for(var b=null,w=0;w<m.length;w++)(b===null||b.compareTo(m[w])>0)&&(b=m[w]);return b}},{key:"extract",value:function(m,b,w){b=zi.clamp(b,0,m.length);var R=(w=zi.clamp(w,-1,m.length))-b+1;w<0&&(R=0),b>=m.length&&(R=0),w<b&&(R=0);var J=new Array(R).fill(null);if(R===0)return J;for(var ve=0,Ie=b;Ie<=w;Ie++)J[ve++]=m[Ie];return J}}]),U}(),Fr=function(){function U(){n(this,U)}return a(U,[{key:"compare",value:function(m,b){var w=m,R=b;return Or.compare(w,R)}},{key:"interfaces_",get:function(){return[$e]}}]),U}(),bi=function(){function U(){n(this,U)}return a(U,[{key:"compare",value:function(m,b){var w=m,R=b;if(w.length<R.length)return-1;if(w.length>R.length)return 1;if(w.length===0)return 0;var J=Or.compare(w,R);return Or.isEqualReversed(w,R)?0:J}},{key:"OLDcompare",value:function(m,b){var w=m,R=b;if(w.length<R.length)return-1;if(w.length>R.length)return 1;if(w.length===0)return 0;for(var J=Or.increasingDirection(w),ve=Or.increasingDirection(R),Ie=J>0?0:w.length-1,je=ve>0?0:w.length-1,lt=0;lt<w.length;lt++){var Ft=w[Ie].compareTo(R[je]);if(Ft!==0)return Ft;Ie+=J,je+=ve}return 0}},{key:"interfaces_",get:function(){return[$e]}}]),U}();Or.ForwardComparator=Fr,Or.BidirectionalComparator=bi,Or.coordArrayType=new Array(0).fill(null);var Mi=function(){function U(m){n(this,U),this.str=m}return a(U,[{key:"append",value:function(m){this.str+=m}},{key:"setCharAt",value:function(m,b){this.str=this.str.substr(0,m)+b+this.str.substr(m+1)}},{key:"toString",value:function(){return this.str}}]),U}(),Wi=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"getM",value:function(m){return this.hasM()?this._coordinates[m].getM():Oe.NaN}},{key:"setOrdinate",value:function(m,b,w){switch(b){case Cn.X:this._coordinates[m].x=w;break;case Cn.Y:this._coordinates[m].y=w;break;default:this._coordinates[m].setOrdinate(b,w)}}},{key:"getZ",value:function(m){return this.hasZ()?this._coordinates[m].getZ():Oe.NaN}},{key:"size",value:function(){return this._coordinates.length}},{key:"getOrdinate",value:function(m,b){switch(b){case Cn.X:return this._coordinates[m].x;case Cn.Y:return this._coordinates[m].y;default:return this._coordinates[m].getOrdinate(b)}}},{key:"getCoordinate",value:function(){if(arguments.length===1){var m=arguments[0];return this._coordinates[m]}if(arguments.length===2){var b=arguments[0],w=arguments[1];w.setCoordinate(this._coordinates[b])}}},{key:"getCoordinateCopy",value:function(m){var b=this.createCoordinate();return b.setCoordinate(this._coordinates[m]),b}},{key:"createCoordinate",value:function(){return ur.create(this.getDimension(),this.getMeasures())}},{key:"getDimension",value:function(){return this._dimension}},{key:"getX",value:function(m){return this._coordinates[m].x}},{key:"getMeasures",value:function(){return this._measures}},{key:"expandEnvelope",value:function(m){for(var b=0;b<this._coordinates.length;b++)m.expandToInclude(this._coordinates[b]);return m}},{key:"copy",value:function(){for(var m=new Array(this.size()).fill(null),b=0;b<this._coordinates.length;b++){var w=this.createCoordinate();w.setCoordinate(this._coordinates[b]),m[b]=w}return new U(m,this._dimension,this._measures)}},{key:"toString",value:function(){if(this._coordinates.length>0){var m=new Mi(17*this._coordinates.length);m.append("("),m.append(this._coordinates[0]);for(var b=1;b<this._coordinates.length;b++)m.append(", "),m.append(this._coordinates[b]);return m.append(")"),m.toString()}return"()"}},{key:"getY",value:function(m){return this._coordinates[m].y}},{key:"toCoordinateArray",value:function(){return this._coordinates}},{key:"interfaces_",get:function(){return[Cn,ce]}}],[{key:"constructor_",value:function(){if(this._dimension=3,this._measures=0,this._coordinates=null,arguments.length===1){if(arguments[0]instanceof Array){var m=arguments[0];U.constructor_.call(this,m,Or.dimension(m),Or.measures(m))}else if(Number.isInteger(arguments[0])){var b=arguments[0];this._coordinates=new Array(b).fill(null);for(var w=0;w<b;w++)this._coordinates[w]=new ot}else if(Jt(arguments[0],Cn)){var R=arguments[0];if(R===null)return this._coordinates=new Array(0).fill(null),null;this._dimension=R.getDimension(),this._measures=R.getMeasures(),this._coordinates=new Array(R.size()).fill(null);for(var J=0;J<this._coordinates.length;J++)this._coordinates[J]=R.getCoordinateCopy(J)}}else if(arguments.length===2){if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var ve=arguments[0],Ie=arguments[1];U.constructor_.call(this,ve,Ie,Or.measures(ve))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var je=arguments[0],lt=arguments[1];this._coordinates=new Array(je).fill(null),this._dimension=lt;for(var Ft=0;Ft<je;Ft++)this._coordinates[Ft]=ur.create(lt)}}else if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var Kt=arguments[0],En=arguments[1],or=arguments[2];this._dimension=En,this._measures=or,this._coordinates=Kt===null?new Array(0).fill(null):Kt}else if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var er=arguments[0],Nr=arguments[1],Bn=arguments[2];this._coordinates=new Array(er).fill(null),this._dimension=Nr,this._measures=Bn;for(var wr=0;wr<er;wr++)this._coordinates[wr]=this.createCoordinate()}}}}]),U}(),Ki=function(){function U(){n(this,U)}return a(U,[{key:"readResolve",value:function(){return U.instance()}},{key:"create",value:function(){if(arguments.length===1){if(arguments[0]instanceof Array){var m=arguments[0];return new Wi(m)}if(Jt(arguments[0],Cn)){var b=arguments[0];return new Wi(b)}}else{if(arguments.length===2){var w=arguments[0],R=arguments[1];return R>3&&(R=3),R<2&&(R=2),new Wi(w,R)}if(arguments.length===3){var J=arguments[0],ve=arguments[1],Ie=arguments[2],je=ve-Ie;return Ie>1&&(Ie=1),je>3&&(je=3),je<2&&(je=2),new Wi(J,je+Ie,Ie)}}}},{key:"interfaces_",get:function(){return[mi,ce]}}],[{key:"instance",value:function(){return U.instanceObject}}]),U}();Ki.instanceObject=new Ki;var yi=function(U){u(b,U);var m=D(b);function b(){var w;return n(this,b),w=m.call(this),b.constructor_.apply(I(w),arguments),w}return a(b,[{key:"copyInternal",value:function(){for(var w=new Array(this._geometries.length).fill(null),R=0;R<w.length;R++)w[R]=this._geometries[R].copy();return new b(w,this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof Ne){var w=arguments[0],R=arguments[1];return!!this.isEquivalentClass(w)&&N(f(b.prototype),"equalsExact",this).call(this,w,R)}return N(f(b.prototype),"equalsExact",this).apply(this,arguments)}},{key:"getBoundaryDimension",value:function(){return 1}},{key:"getTypeCode",value:function(){return Ne.TYPECODE_MULTIPOLYGON}},{key:"getDimension",value:function(){return 2}},{key:"getBoundary",value:function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var w=new Mn,R=0;R<this._geometries.length;R++)for(var J=this._geometries[R].getBoundary(),ve=0;ve<J.getNumGeometries();ve++)w.add(J.getGeometryN(ve));var Ie=new Array(w.size()).fill(null);return this.getFactory().createMultiLineString(w.toArray(Ie))}},{key:"getGeometryType",value:function(){return Ne.TYPENAME_MULTIPOLYGON}},{key:"interfaces_",get:function(){return[Xt]}}],[{key:"constructor_",value:function(){var w=arguments[0],R=arguments[1];fn.constructor_.call(this,w,R)}}]),b}(fn),bs=function(){function U(){n(this,U)}return a(U,[{key:"get",value:function(){}},{key:"put",value:function(){}},{key:"size",value:function(){}},{key:"values",value:function(){}},{key:"entrySet",value:function(){}}]),U}(),Us=function(U){u(b,U);var m=D(b);function b(){var w;return n(this,b),(w=m.call(this)).map=new Map,w}return a(b,[{key:"get",value:function(w){return this.map.get(w)||null}},{key:"put",value:function(w,R){return this.map.set(w,R),R}},{key:"values",value:function(){for(var w=new Mn,R=this.map.values(),J=R.next();!J.done;)w.add(J.value),J=R.next();return w}},{key:"entrySet",value:function(){var w=new ut;return this.map.entries().forEach(function(R){return w.add(R)}),w}},{key:"size",value:function(){return this.map.size()}}]),b}(bs),ei=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"equals",value:function(m){if(!(m instanceof U))return!1;var b=m;return this._modelType===b._modelType&&this._scale===b._scale}},{key:"compareTo",value:function(m){var b=m,w=this.getMaximumSignificantDigits(),R=b.getMaximumSignificantDigits();return Fn.compare(w,R)}},{key:"getScale",value:function(){return this._scale}},{key:"isFloating",value:function(){return this._modelType===U.FLOATING||this._modelType===U.FLOATING_SINGLE}},{key:"getType",value:function(){return this._modelType}},{key:"toString",value:function(){var m="UNKNOWN";return this._modelType===U.FLOATING?m="Floating":this._modelType===U.FLOATING_SINGLE?m="Floating-Single":this._modelType===U.FIXED&&(m="Fixed (Scale="+this.getScale()+")"),m}},{key:"makePrecise",value:function(){if(typeof arguments[0]=="number"){var m=arguments[0];return Oe.isNaN(m)||this._modelType===U.FLOATING_SINGLE?m:this._modelType===U.FIXED?Math.round(m*this._scale)/this._scale:m}if(arguments[0]instanceof ot){var b=arguments[0];if(this._modelType===U.FLOATING)return null;b.x=this.makePrecise(b.x),b.y=this.makePrecise(b.y)}}},{key:"getMaximumSignificantDigits",value:function(){var m=16;return this._modelType===U.FLOATING?m=16:this._modelType===U.FLOATING_SINGLE?m=6:this._modelType===U.FIXED&&(m=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),m}},{key:"setScale",value:function(m){this._scale=Math.abs(m)}},{key:"interfaces_",get:function(){return[ce,ye]}}],[{key:"constructor_",value:function(){if(this._modelType=null,this._scale=null,arguments.length===0)this._modelType=U.FLOATING;else if(arguments.length===1){if(arguments[0]instanceof Ji){var m=arguments[0];this._modelType=m,m===U.FIXED&&this.setScale(1)}else if(typeof arguments[0]=="number"){var b=arguments[0];this._modelType=U.FIXED,this.setScale(b)}else if(arguments[0]instanceof U){var w=arguments[0];this._modelType=w._modelType,this._scale=w._scale}}}},{key:"mostPrecise",value:function(m,b){return m.compareTo(b)>=0?m:b}}]),U}(),Ji=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"readResolve",value:function(){return U.nameToTypeMap.get(this._name)}},{key:"toString",value:function(){return this._name}},{key:"interfaces_",get:function(){return[ce]}}],[{key:"constructor_",value:function(){this._name=null;var m=arguments[0];this._name=m,U.nameToTypeMap.put(m,this)}}]),U}();Ji.nameToTypeMap=new Us,ei.Type=Ji,ei.FIXED=new Ji("FIXED"),ei.FLOATING=new Ji("FLOATING"),ei.FLOATING_SINGLE=new Ji("FLOATING SINGLE"),ei.maximumPreciseValue=9007199254740992;var ns=function(U){u(b,U);var m=D(b);function b(){var w;return n(this,b),w=m.call(this),b.constructor_.apply(I(w),arguments),w}return a(b,[{key:"copyInternal",value:function(){for(var w=new Array(this._geometries.length).fill(null),R=0;R<w.length;R++)w[R]=this._geometries[R].copy();return new b(w,this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof Ne){var w=arguments[0],R=arguments[1];return!!this.isEquivalentClass(w)&&N(f(b.prototype),"equalsExact",this).call(this,w,R)}return N(f(b.prototype),"equalsExact",this).apply(this,arguments)}},{key:"getBoundaryDimension",value:function(){return this.isClosed()?Pn.FALSE:0}},{key:"isClosed",value:function(){if(this.isEmpty())return!1;for(var w=0;w<this._geometries.length;w++)if(!this._geometries[w].isClosed())return!1;return!0}},{key:"getTypeCode",value:function(){return Ne.TYPECODE_MULTILINESTRING}},{key:"getDimension",value:function(){return 1}},{key:"getBoundary",value:function(){throw new st}},{key:"getGeometryType",value:function(){return Ne.TYPENAME_MULTILINESTRING}},{key:"interfaces_",get:function(){return[qo]}}],[{key:"constructor_",value:function(){var w=arguments[0],R=arguments[1];fn.constructor_.call(this,w,R)}}]),b}(fn),Xo=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"createEmpty",value:function(m){switch(m){case-1:return this.createGeometryCollection();case 0:return this.createPoint();case 1:return this.createLineString();case 2:return this.createPolygon();default:throw new le("Invalid dimension: "+m)}}},{key:"toGeometry",value:function(m){return m.isNull()?this.createPoint():m.getMinX()===m.getMaxX()&&m.getMinY()===m.getMaxY()?this.createPoint(new ot(m.getMinX(),m.getMinY())):m.getMinX()===m.getMaxX()||m.getMinY()===m.getMaxY()?this.createLineString([new ot(m.getMinX(),m.getMinY()),new ot(m.getMaxX(),m.getMaxY())]):this.createPolygon(this.createLinearRing([new ot(m.getMinX(),m.getMinY()),new ot(m.getMinX(),m.getMaxY()),new ot(m.getMaxX(),m.getMaxY()),new ot(m.getMaxX(),m.getMinY()),new ot(m.getMinX(),m.getMinY())]),null)}},{key:"createLineString",value:function(){if(arguments.length===0)return this.createLineString(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){var m=arguments[0];return this.createLineString(m!==null?this.getCoordinateSequenceFactory().create(m):null)}if(Jt(arguments[0],Cn)){var b=arguments[0];return new Ve(b,this)}}}},{key:"createMultiLineString",value:function(){if(arguments.length===0)return new ns(null,this);if(arguments.length===1){var m=arguments[0];return new ns(m,this)}}},{key:"buildGeometry",value:function(m){for(var b=null,w=!1,R=!1,J=m.iterator();J.hasNext();){var ve=J.next(),Ie=ve.getTypeCode();b===null&&(b=Ie),Ie!==b&&(w=!0),ve instanceof fn&&(R=!0)}if(b===null)return this.createGeometryCollection();if(w||R)return this.createGeometryCollection(U.toGeometryArray(m));var je=m.iterator().next();if(m.size()>1){if(je instanceof At)return this.createMultiPolygon(U.toPolygonArray(m));if(je instanceof Ve)return this.createMultiLineString(U.toLineStringArray(m));if(je instanceof _t)return this.createMultiPoint(U.toPointArray(m));Ue.shouldNeverReachHere("Unhandled geometry type: "+je.getGeometryType())}return je}},{key:"createMultiPointFromCoords",value:function(m){return this.createMultiPoint(m!==null?this.getCoordinateSequenceFactory().create(m):null)}},{key:"createPoint",value:function(){if(arguments.length===0)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof ot){var m=arguments[0];return this.createPoint(m!==null?this.getCoordinateSequenceFactory().create([m]):null)}if(Jt(arguments[0],Cn)){var b=arguments[0];return new _t(b,this)}}}},{key:"getCoordinateSequenceFactory",value:function(){return this._coordinateSequenceFactory}},{key:"createPolygon",value:function(){if(arguments.length===0)return this.createPolygon(null,null);if(arguments.length===1){if(Jt(arguments[0],Cn)){var m=arguments[0];return this.createPolygon(this.createLinearRing(m))}if(arguments[0]instanceof Array){var b=arguments[0];return this.createPolygon(this.createLinearRing(b))}if(arguments[0]instanceof zt){var w=arguments[0];return this.createPolygon(w,null)}}else if(arguments.length===2){var R=arguments[0],J=arguments[1];return new At(R,J,this)}}},{key:"getSRID",value:function(){return this._SRID}},{key:"createGeometryCollection",value:function(){if(arguments.length===0)return new fn(null,this);if(arguments.length===1){var m=arguments[0];return new fn(m,this)}}},{key:"getPrecisionModel",value:function(){return this._precisionModel}},{key:"createLinearRing",value:function(){if(arguments.length===0)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){var m=arguments[0];return this.createLinearRing(m!==null?this.getCoordinateSequenceFactory().create(m):null)}if(Jt(arguments[0],Cn)){var b=arguments[0];return new zt(b,this)}}}},{key:"createMultiPolygon",value:function(){if(arguments.length===0)return new yi(null,this);if(arguments.length===1){var m=arguments[0];return new yi(m,this)}}},{key:"createMultiPoint",value:function(){if(arguments.length===0)return new Nt(null,this);if(arguments.length===1){if(arguments[0]instanceof Array){var m=arguments[0];return new Nt(m,this)}if(Jt(arguments[0],Cn)){var b=arguments[0];if(b===null)return this.createMultiPoint(new Array(0).fill(null));for(var w=new Array(b.size()).fill(null),R=0;R<b.size();R++){var J=this.getCoordinateSequenceFactory().create(1,b.getDimension(),b.getMeasures());Oo.copy(b,R,J,0,1),w[R]=this.createPoint(J)}return this.createMultiPoint(w)}}}},{key:"interfaces_",get:function(){return[ce]}}],[{key:"constructor_",value:function(){if(this._precisionModel=null,this._coordinateSequenceFactory=null,this._SRID=null,arguments.length===0)U.constructor_.call(this,new ei,0);else if(arguments.length===1){if(Jt(arguments[0],mi)){var m=arguments[0];U.constructor_.call(this,new ei,0,m)}else if(arguments[0]instanceof ei){var b=arguments[0];U.constructor_.call(this,b,0,U.getDefaultCoordinateSequenceFactory())}}else if(arguments.length===2){var w=arguments[0],R=arguments[1];U.constructor_.call(this,w,R,U.getDefaultCoordinateSequenceFactory())}else if(arguments.length===3){var J=arguments[0],ve=arguments[1],Ie=arguments[2];this._precisionModel=J,this._coordinateSequenceFactory=Ie,this._SRID=ve}}},{key:"toMultiPolygonArray",value:function(m){var b=new Array(m.size()).fill(null);return m.toArray(b)}},{key:"toGeometryArray",value:function(m){if(m===null)return null;var b=new Array(m.size()).fill(null);return m.toArray(b)}},{key:"getDefaultCoordinateSequenceFactory",value:function(){return Ki.instance()}},{key:"toMultiLineStringArray",value:function(m){var b=new Array(m.size()).fill(null);return m.toArray(b)}},{key:"toLineStringArray",value:function(m){var b=new Array(m.size()).fill(null);return m.toArray(b)}},{key:"toMultiPointArray",value:function(m){var b=new Array(m.size()).fill(null);return m.toArray(b)}},{key:"toLinearRingArray",value:function(m){var b=new Array(m.size()).fill(null);return m.toArray(b)}},{key:"toPointArray",value:function(m){var b=new Array(m.size()).fill(null);return m.toArray(b)}},{key:"toPolygonArray",value:function(m){var b=new Array(m.size()).fill(null);return m.toArray(b)}},{key:"createPointFromInternalCoord",value:function(m,b){return b.getPrecisionModel().makePrecise(m),b.getFactory().createPoint(m)}}]),U}(),Rs="XY",ld="XYZ",Qd="XYM",Cc="XYZM",lu={POINT:"Point",LINE_STRING:"LineString",LINEAR_RING:"LinearRing",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection",CIRCLE:"Circle"},ea="EMPTY",Os=1,rs=2,Do=3,Ma=4,Wa=5,eh=6;for(var Ou in lu)lu[Ou].toUpperCase();var ne=function(){function U(m){n(this,U),this.wkt=m,this.index_=-1}return a(U,[{key:"isAlpha_",value:function(m){return m>="a"&&m<="z"||m>="A"&&m<="Z"}},{key:"isNumeric_",value:function(m,b){return m>="0"&&m<="9"||m=="."&&!(b!==void 0&&b)}},{key:"isWhiteSpace_",value:function(m){return m==" "||m=="	"||m=="\r"||m==`
`}},{key:"nextChar_",value:function(){return this.wkt.charAt(++this.index_)}},{key:"nextToken",value:function(){var m,b=this.nextChar_(),w=this.index_,R=b;if(b=="(")m=rs;else if(b==",")m=Wa;else if(b==")")m=Do;else if(this.isNumeric_(b)||b=="-")m=Ma,R=this.readNumber_();else if(this.isAlpha_(b))m=Os,R=this.readText_();else{if(this.isWhiteSpace_(b))return this.nextToken();if(b!=="")throw new Error("Unexpected character: "+b);m=eh}return{position:w,value:R,type:m}}},{key:"readNumber_",value:function(){var m,b=this.index_,w=!1,R=!1;do m=="."?w=!0:m!="e"&&m!="E"||(R=!0),m=this.nextChar_();while(this.isNumeric_(m,w)||!R&&(m=="e"||m=="E")||R&&(m=="-"||m=="+"));return parseFloat(this.wkt.substring(b,this.index_--))}},{key:"readText_",value:function(){var m,b=this.index_;do m=this.nextChar_();while(this.isAlpha_(m));return this.wkt.substring(b,this.index_--).toUpperCase()}}]),U}(),Ce=function(){function U(m,b){n(this,U),this.lexer_=m,this.token_,this.layout_=Rs,this.factory=b}return a(U,[{key:"consume_",value:function(){this.token_=this.lexer_.nextToken()}},{key:"isTokenType",value:function(m){return this.token_.type==m}},{key:"match",value:function(m){var b=this.isTokenType(m);return b&&this.consume_(),b}},{key:"parse",value:function(){return this.consume_(),this.parseGeometry_()}},{key:"parseGeometryLayout_",value:function(){var m=Rs,b=this.token_;if(this.isTokenType(Os)){var w=b.value;w==="Z"?m=ld:w==="M"?m=Qd:w==="ZM"&&(m=Cc),m!==Rs&&this.consume_()}return m}},{key:"parseGeometryCollectionText_",value:function(){if(this.match(rs)){var m=[];do m.push(this.parseGeometry_());while(this.match(Wa));if(this.match(Do))return m}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parsePointText_",value:function(){if(this.match(rs)){var m=this.parsePoint_();if(this.match(Do))return m}else if(this.isEmptyGeometry_())return null;throw new Error(this.formatErrorMessage_())}},{key:"parseLineStringText_",value:function(){if(this.match(rs)){var m=this.parsePointList_();if(this.match(Do))return m}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parsePolygonText_",value:function(){if(this.match(rs)){var m=this.parseLineStringTextList_();if(this.match(Do))return m}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parseMultiPointText_",value:function(){var m;if(this.match(rs)){if(m=this.token_.type==rs?this.parsePointTextList_():this.parsePointList_(),this.match(Do))return m}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parseMultiLineStringText_",value:function(){if(this.match(rs)){var m=this.parseLineStringTextList_();if(this.match(Do))return m}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parseMultiPolygonText_",value:function(){if(this.match(rs)){var m=this.parsePolygonTextList_();if(this.match(Do))return m}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parsePoint_",value:function(){for(var m=[],b=this.layout_.length,w=0;w<b;++w){var R=this.token_;if(!this.match(Ma))break;m.push(R.value)}if(m.length==b)return m;throw new Error(this.formatErrorMessage_())}},{key:"parsePointList_",value:function(){for(var m=[this.parsePoint_()];this.match(Wa);)m.push(this.parsePoint_());return m}},{key:"parsePointTextList_",value:function(){for(var m=[this.parsePointText_()];this.match(Wa);)m.push(this.parsePointText_());return m}},{key:"parseLineStringTextList_",value:function(){for(var m=[this.parseLineStringText_()];this.match(Wa);)m.push(this.parseLineStringText_());return m}},{key:"parsePolygonTextList_",value:function(){for(var m=[this.parsePolygonText_()];this.match(Wa);)m.push(this.parsePolygonText_());return m}},{key:"isEmptyGeometry_",value:function(){var m=this.isTokenType(Os)&&this.token_.value==ea;return m&&this.consume_(),m}},{key:"formatErrorMessage_",value:function(){return"Unexpected `"+this.token_.value+"` at position "+this.token_.position+" in `"+this.lexer_.wkt+"`"}},{key:"parseGeometry_",value:function(){var m=this.factory,b=function(Bn){return C(ot,j(Bn))},w=function(Bn){var wr=Bn.map(function(Pi){return m.createLinearRing(Pi.map(b))});return wr.length>1?m.createPolygon(wr[0],wr.slice(1)):m.createPolygon(wr[0])},R=this.token_;if(this.match(Os)){var J=R.value;if(this.layout_=this.parseGeometryLayout_(),J=="GEOMETRYCOLLECTION"){var ve=this.parseGeometryCollectionText_();return m.createGeometryCollection(ve)}switch(J){case"POINT":var Ie=this.parsePointText_();return Ie?m.createPoint(C(ot,j(Ie))):m.createPoint();case"LINESTRING":var je=this.parseLineStringText_().map(b);return m.createLineString(je);case"LINEARRING":var lt=this.parseLineStringText_().map(b);return m.createLinearRing(lt);case"POLYGON":var Ft=this.parsePolygonText_();return Ft&&Ft.length!==0?w(Ft):m.createPolygon();case"MULTIPOINT":var Kt=this.parseMultiPointText_();if(!Kt||Kt.length===0)return m.createMultiPoint();var En=Kt.map(b).map(function(Bn){return m.createPoint(Bn)});return m.createMultiPoint(En);case"MULTILINESTRING":var or=this.parseMultiLineStringText_().map(function(Bn){return m.createLineString(Bn.map(b))});return m.createMultiLineString(or);case"MULTIPOLYGON":var er=this.parseMultiPolygonText_();if(!er||er.length===0)return m.createMultiPolygon();var Nr=er.map(w);return m.createMultiPolygon(Nr);default:throw new Error("Invalid geometry type: "+J)}}throw new Error(this.formatErrorMessage_())}}]),U}();function et(U){if(U.isEmpty())return"";var m=U.getCoordinate(),b=[m.x,m.y];return m.z===void 0||Number.isNaN(m.z)||b.push(m.z),m.m===void 0||Number.isNaN(m.m)||b.push(m.m),b.join(" ")}function kt(U){for(var m=U.getCoordinates().map(function(J){var ve=[J.x,J.y];return J.z===void 0||Number.isNaN(J.z)||ve.push(J.z),J.m===void 0||Number.isNaN(J.m)||ve.push(J.m),ve}),b=[],w=0,R=m.length;w<R;++w)b.push(m[w].join(" "));return b.join(", ")}function jt(U){var m=[];m.push("("+kt(U.getExteriorRing())+")");for(var b=0,w=U.getNumInteriorRing();b<w;++b)m.push("("+kt(U.getInteriorRingN(b))+")");return m.join(", ")}var Ut={Point:et,LineString:kt,LinearRing:kt,Polygon:jt,MultiPoint:function(U){for(var m=[],b=0,w=U.getNumGeometries();b<w;++b)m.push("("+et(U.getGeometryN(b))+")");return m.join(", ")},MultiLineString:function(U){for(var m=[],b=0,w=U.getNumGeometries();b<w;++b)m.push("("+kt(U.getGeometryN(b))+")");return m.join(", ")},MultiPolygon:function(U){for(var m=[],b=0,w=U.getNumGeometries();b<w;++b)m.push("("+jt(U.getGeometryN(b))+")");return m.join(", ")},GeometryCollection:function(U){for(var m=[],b=0,w=U.getNumGeometries();b<w;++b)m.push(nn(U.getGeometryN(b)));return m.join(", ")}};function nn(U){var m=U.getGeometryType(),b=Ut[m];m=m.toUpperCase();var w=function(R){var J="";if(R.isEmpty())return J;var ve=R.getCoordinate();return ve.z===void 0||Number.isNaN(ve.z)||(J+="Z"),ve.m===void 0||Number.isNaN(ve.m)||(J+="M"),J}(U);return w.length>0&&(m+=" "+w),U.isEmpty()?m+" "+ea:m+" ("+b(U)+")"}var Xn=function(){function U(m){n(this,U),this.geometryFactory=m||new Xo,this.precisionModel=this.geometryFactory.getPrecisionModel()}return a(U,[{key:"read",value:function(m){var b=new ne(m);return new Ce(b,this.geometryFactory).parse()}},{key:"write",value:function(m){return nn(m)}}]),U}(),rr=function(){function U(m){n(this,U),this.parser=new Xn(m)}return a(U,[{key:"write",value:function(m){return this.parser.write(m)}}],[{key:"toLineString",value:function(m,b){if(arguments.length!==2)throw new Error("Not implemented");return"LINESTRING ( "+m.x+" "+m.y+", "+b.x+" "+b.y+" )"}}]),U}(),Yn=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"getIndexAlongSegment",value:function(m,b){return this.computeIntLineIndex(),this._intLineIndex[m][b]}},{key:"getTopologySummary",value:function(){var m=new Mi;return this.isEndPoint()&&m.append(" endpoint"),this._isProper&&m.append(" proper"),this.isCollinear()&&m.append(" collinear"),m.toString()}},{key:"computeIntersection",value:function(m,b,w,R){this._inputLines[0][0]=m,this._inputLines[0][1]=b,this._inputLines[1][0]=w,this._inputLines[1][1]=R,this._result=this.computeIntersect(m,b,w,R)}},{key:"getIntersectionNum",value:function(){return this._result}},{key:"computeIntLineIndex",value:function(){if(arguments.length===0)this._intLineIndex===null&&(this._intLineIndex=Array(2).fill().map(function(){return Array(2)}),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(arguments.length===1){var m=arguments[0],b=this.getEdgeDistance(m,0),w=this.getEdgeDistance(m,1);b>w?(this._intLineIndex[m][0]=0,this._intLineIndex[m][1]=1):(this._intLineIndex[m][0]=1,this._intLineIndex[m][1]=0)}}},{key:"isProper",value:function(){return this.hasIntersection()&&this._isProper}},{key:"setPrecisionModel",value:function(m){this._precisionModel=m}},{key:"isInteriorIntersection",value:function(){if(arguments.length===0)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(arguments.length===1){for(var m=arguments[0],b=0;b<this._result;b++)if(!this._intPt[b].equals2D(this._inputLines[m][0])&&!this._intPt[b].equals2D(this._inputLines[m][1]))return!0;return!1}}},{key:"getIntersection",value:function(m){return this._intPt[m]}},{key:"isEndPoint",value:function(){return this.hasIntersection()&&!this._isProper}},{key:"hasIntersection",value:function(){return this._result!==U.NO_INTERSECTION}},{key:"getEdgeDistance",value:function(m,b){return U.computeEdgeDistance(this._intPt[b],this._inputLines[m][0],this._inputLines[m][1])}},{key:"isCollinear",value:function(){return this._result===U.COLLINEAR_INTERSECTION}},{key:"toString",value:function(){return rr.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+rr.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()}},{key:"getEndpoint",value:function(m,b){return this._inputLines[m][b]}},{key:"isIntersection",value:function(m){for(var b=0;b<this._result;b++)if(this._intPt[b].equals2D(m))return!0;return!1}},{key:"getIntersectionAlongSegment",value:function(m,b){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[m][b]]}}],[{key:"constructor_",value:function(){this._result=null,this._inputLines=Array(2).fill().map(function(){return Array(2)}),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new ot,this._intPt[1]=new ot,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0}},{key:"computeEdgeDistance",value:function(m,b,w){var R=Math.abs(w.x-b.x),J=Math.abs(w.y-b.y),ve=-1;if(m.equals(b))ve=0;else if(m.equals(w))ve=R>J?R:J;else{var Ie=Math.abs(m.x-b.x),je=Math.abs(m.y-b.y);(ve=R>J?Ie:je)!==0||m.equals(b)||(ve=Math.max(Ie,je))}return Ue.isTrue(!(ve===0&&!m.equals(b)),"Bad distance calculation"),ve}},{key:"nonRobustComputeEdgeDistance",value:function(m,b,w){var R=m.x-b.x,J=m.y-b.y,ve=Math.sqrt(R*R+J*J);return Ue.isTrue(!(ve===0&&!m.equals(b)),"Invalid distance calculation"),ve}}]),U}();Yn.DONT_INTERSECT=0,Yn.DO_INTERSECT=1,Yn.COLLINEAR=2,Yn.NO_INTERSECTION=0,Yn.POINT_INTERSECTION=1,Yn.COLLINEAR_INTERSECTION=2;var hr=function(U){u(b,U);var m=D(b);function b(){return n(this,b),m.call(this)}return a(b,[{key:"isInSegmentEnvelopes",value:function(w){var R=new wt(this._inputLines[0][0],this._inputLines[0][1]),J=new wt(this._inputLines[1][0],this._inputLines[1][1]);return R.contains(w)&&J.contains(w)}},{key:"computeIntersection",value:function(){if(arguments.length!==3)return N(f(b.prototype),"computeIntersection",this).apply(this,arguments);var w=arguments[0],R=arguments[1],J=arguments[2];if(this._isProper=!1,wt.intersects(R,J,w)&&xn.index(R,J,w)===0&&xn.index(J,R,w)===0)return this._isProper=!0,(w.equals(R)||w.equals(J))&&(this._isProper=!1),this._result=Yn.POINT_INTERSECTION,null;this._result=Yn.NO_INTERSECTION}},{key:"intersection",value:function(w,R,J,ve){var Ie=this.intersectionSafe(w,R,J,ve);return this.isInSegmentEnvelopes(Ie)||(Ie=new ot(b.nearestEndpoint(w,R,J,ve))),this._precisionModel!==null&&this._precisionModel.makePrecise(Ie),Ie}},{key:"checkDD",value:function(w,R,J,ve,Ie){var je=lr.intersection(w,R,J,ve),lt=this.isInSegmentEnvelopes(je);vr.out.println("DD in env = "+lt+"  --------------------- "+je),Ie.distance(je)>1e-4&&vr.out.println("Distance = "+Ie.distance(je))}},{key:"intersectionSafe",value:function(w,R,J,ve){var Ie=yo.intersection(w,R,J,ve);return Ie===null&&(Ie=b.nearestEndpoint(w,R,J,ve)),Ie}},{key:"computeCollinearIntersection",value:function(w,R,J,ve){var Ie=wt.intersects(w,R,J),je=wt.intersects(w,R,ve),lt=wt.intersects(J,ve,w),Ft=wt.intersects(J,ve,R);return Ie&&je?(this._intPt[0]=J,this._intPt[1]=ve,Yn.COLLINEAR_INTERSECTION):lt&&Ft?(this._intPt[0]=w,this._intPt[1]=R,Yn.COLLINEAR_INTERSECTION):Ie&&lt?(this._intPt[0]=J,this._intPt[1]=w,!J.equals(w)||je||Ft?Yn.COLLINEAR_INTERSECTION:Yn.POINT_INTERSECTION):Ie&&Ft?(this._intPt[0]=J,this._intPt[1]=R,!J.equals(R)||je||lt?Yn.COLLINEAR_INTERSECTION:Yn.POINT_INTERSECTION):je&&lt?(this._intPt[0]=ve,this._intPt[1]=w,!ve.equals(w)||Ie||Ft?Yn.COLLINEAR_INTERSECTION:Yn.POINT_INTERSECTION):je&&Ft?(this._intPt[0]=ve,this._intPt[1]=R,!ve.equals(R)||Ie||lt?Yn.COLLINEAR_INTERSECTION:Yn.POINT_INTERSECTION):Yn.NO_INTERSECTION}},{key:"computeIntersect",value:function(w,R,J,ve){if(this._isProper=!1,!wt.intersects(w,R,J,ve))return Yn.NO_INTERSECTION;var Ie=xn.index(w,R,J),je=xn.index(w,R,ve);if(Ie>0&&je>0||Ie<0&&je<0)return Yn.NO_INTERSECTION;var lt=xn.index(J,ve,w),Ft=xn.index(J,ve,R);return lt>0&&Ft>0||lt<0&&Ft<0?Yn.NO_INTERSECTION:Ie===0&&je===0&&lt===0&&Ft===0?this.computeCollinearIntersection(w,R,J,ve):(Ie===0||je===0||lt===0||Ft===0?(this._isProper=!1,w.equals2D(J)||w.equals2D(ve)?this._intPt[0]=w:R.equals2D(J)||R.equals2D(ve)?this._intPt[0]=R:Ie===0?this._intPt[0]=new ot(J):je===0?this._intPt[0]=new ot(ve):lt===0?this._intPt[0]=new ot(w):Ft===0&&(this._intPt[0]=new ot(R))):(this._isProper=!0,this._intPt[0]=this.intersection(w,R,J,ve)),Yn.POINT_INTERSECTION)}}],[{key:"nearestEndpoint",value:function(w,R,J,ve){var Ie=w,je=Li.pointToSegment(w,J,ve),lt=Li.pointToSegment(R,J,ve);return lt<je&&(je=lt,Ie=R),(lt=Li.pointToSegment(J,w,R))<je&&(je=lt,Ie=J),(lt=Li.pointToSegment(ve,w,R))<je&&(je=lt,Ie=ve),Ie}}]),b}(Yn),Ln=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"countSegment",value:function(m,b){if(m.x<this._p.x&&b.x<this._p.x)return null;if(this._p.x===b.x&&this._p.y===b.y)return this._isPointOnSegment=!0,null;if(m.y===this._p.y&&b.y===this._p.y){var w=m.x,R=b.x;return w>R&&(w=b.x,R=m.x),this._p.x>=w&&this._p.x<=R&&(this._isPointOnSegment=!0),null}if(m.y>this._p.y&&b.y<=this._p.y||b.y>this._p.y&&m.y<=this._p.y){var J=xn.index(m,b,this._p);if(J===xn.COLLINEAR)return this._isPointOnSegment=!0,null;b.y<m.y&&(J=-J),J===xn.LEFT&&this._crossingCount++}}},{key:"isPointInPolygon",value:function(){return this.getLocation()!==We.EXTERIOR}},{key:"getLocation",value:function(){return this._isPointOnSegment?We.BOUNDARY:this._crossingCount%2==1?We.INTERIOR:We.EXTERIOR}},{key:"isOnSegment",value:function(){return this._isPointOnSegment}}],[{key:"constructor_",value:function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var m=arguments[0];this._p=m}},{key:"locatePointInRing",value:function(){if(arguments[0]instanceof ot&&Jt(arguments[1],Cn)){for(var m=arguments[0],b=arguments[1],w=new U(m),R=new ot,J=new ot,ve=1;ve<b.size();ve++)if(b.getCoordinate(ve,R),b.getCoordinate(ve-1,J),w.countSegment(R,J),w.isOnSegment())return w.getLocation();return w.getLocation()}if(arguments[0]instanceof ot&&arguments[1]instanceof Array){for(var Ie=arguments[0],je=arguments[1],lt=new U(Ie),Ft=1;Ft<je.length;Ft++){var Kt=je[Ft],En=je[Ft-1];if(lt.countSegment(Kt,En),lt.isOnSegment())return lt.getLocation()}return lt.getLocation()}}}]),U}(),ii=function(){function U(){n(this,U)}return a(U,null,[{key:"isOnLine",value:function(){if(arguments[0]instanceof ot&&Jt(arguments[1],Cn)){for(var m=arguments[0],b=arguments[1],w=new hr,R=new ot,J=new ot,ve=b.size(),Ie=1;Ie<ve;Ie++)if(b.getCoordinate(Ie-1,R),b.getCoordinate(Ie,J),w.computeIntersection(m,R,J),w.hasIntersection())return!0;return!1}if(arguments[0]instanceof ot&&arguments[1]instanceof Array){for(var je=arguments[0],lt=arguments[1],Ft=new hr,Kt=1;Kt<lt.length;Kt++){var En=lt[Kt-1],or=lt[Kt];if(Ft.computeIntersection(je,En,or),Ft.hasIntersection())return!0}return!1}}},{key:"locateInRing",value:function(m,b){return Ln.locatePointInRing(m,b)}},{key:"isInRing",value:function(m,b){return U.locateInRing(m,b)!==We.EXTERIOR}}]),U}(),Tr=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"setAllLocations",value:function(m){for(var b=0;b<this.location.length;b++)this.location[b]=m}},{key:"isNull",value:function(){for(var m=0;m<this.location.length;m++)if(this.location[m]!==We.NONE)return!1;return!0}},{key:"setAllLocationsIfNull",value:function(m){for(var b=0;b<this.location.length;b++)this.location[b]===We.NONE&&(this.location[b]=m)}},{key:"isLine",value:function(){return this.location.length===1}},{key:"merge",value:function(m){if(m.location.length>this.location.length){var b=new Array(3).fill(null);b[nt.ON]=this.location[nt.ON],b[nt.LEFT]=We.NONE,b[nt.RIGHT]=We.NONE,this.location=b}for(var w=0;w<this.location.length;w++)this.location[w]===We.NONE&&w<m.location.length&&(this.location[w]=m.location[w])}},{key:"getLocations",value:function(){return this.location}},{key:"flip",value:function(){if(this.location.length<=1)return null;var m=this.location[nt.LEFT];this.location[nt.LEFT]=this.location[nt.RIGHT],this.location[nt.RIGHT]=m}},{key:"toString",value:function(){var m=new Wt;return this.location.length>1&&m.append(We.toLocationSymbol(this.location[nt.LEFT])),m.append(We.toLocationSymbol(this.location[nt.ON])),this.location.length>1&&m.append(We.toLocationSymbol(this.location[nt.RIGHT])),m.toString()}},{key:"setLocations",value:function(m,b,w){this.location[nt.ON]=m,this.location[nt.LEFT]=b,this.location[nt.RIGHT]=w}},{key:"get",value:function(m){return m<this.location.length?this.location[m]:We.NONE}},{key:"isArea",value:function(){return this.location.length>1}},{key:"isAnyNull",value:function(){for(var m=0;m<this.location.length;m++)if(this.location[m]===We.NONE)return!0;return!1}},{key:"setLocation",value:function(){if(arguments.length===1){var m=arguments[0];this.setLocation(nt.ON,m)}else if(arguments.length===2){var b=arguments[0],w=arguments[1];this.location[b]=w}}},{key:"init",value:function(m){this.location=new Array(m).fill(null),this.setAllLocations(We.NONE)}},{key:"isEqualOnSide",value:function(m,b){return this.location[b]===m.location[b]}},{key:"allPositionsEqual",value:function(m){for(var b=0;b<this.location.length;b++)if(this.location[b]!==m)return!1;return!0}}],[{key:"constructor_",value:function(){if(this.location=null,arguments.length===1){if(arguments[0]instanceof Array){var m=arguments[0];this.init(m.length)}else if(Number.isInteger(arguments[0])){var b=arguments[0];this.init(1),this.location[nt.ON]=b}else if(arguments[0]instanceof U){var w=arguments[0];if(this.init(w.location.length),w!==null)for(var R=0;R<this.location.length;R++)this.location[R]=w.location[R]}}else if(arguments.length===3){var J=arguments[0],ve=arguments[1],Ie=arguments[2];this.init(3),this.location[nt.ON]=J,this.location[nt.LEFT]=ve,this.location[nt.RIGHT]=Ie}}}]),U}(),Kr=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"getGeometryCount",value:function(){var m=0;return this.elt[0].isNull()||m++,this.elt[1].isNull()||m++,m}},{key:"setAllLocations",value:function(m,b){this.elt[m].setAllLocations(b)}},{key:"isNull",value:function(m){return this.elt[m].isNull()}},{key:"setAllLocationsIfNull",value:function(){if(arguments.length===1){var m=arguments[0];this.setAllLocationsIfNull(0,m),this.setAllLocationsIfNull(1,m)}else if(arguments.length===2){var b=arguments[0],w=arguments[1];this.elt[b].setAllLocationsIfNull(w)}}},{key:"isLine",value:function(m){return this.elt[m].isLine()}},{key:"merge",value:function(m){for(var b=0;b<2;b++)this.elt[b]===null&&m.elt[b]!==null?this.elt[b]=new Tr(m.elt[b]):this.elt[b].merge(m.elt[b])}},{key:"flip",value:function(){this.elt[0].flip(),this.elt[1].flip()}},{key:"getLocation",value:function(){if(arguments.length===1){var m=arguments[0];return this.elt[m].get(nt.ON)}if(arguments.length===2){var b=arguments[0],w=arguments[1];return this.elt[b].get(w)}}},{key:"toString",value:function(){var m=new Wt;return this.elt[0]!==null&&(m.append("A:"),m.append(this.elt[0].toString())),this.elt[1]!==null&&(m.append(" B:"),m.append(this.elt[1].toString())),m.toString()}},{key:"isArea",value:function(){if(arguments.length===0)return this.elt[0].isArea()||this.elt[1].isArea();if(arguments.length===1){var m=arguments[0];return this.elt[m].isArea()}}},{key:"isAnyNull",value:function(m){return this.elt[m].isAnyNull()}},{key:"setLocation",value:function(){if(arguments.length===2){var m=arguments[0],b=arguments[1];this.elt[m].setLocation(nt.ON,b)}else if(arguments.length===3){var w=arguments[0],R=arguments[1],J=arguments[2];this.elt[w].setLocation(R,J)}}},{key:"isEqualOnSide",value:function(m,b){return this.elt[0].isEqualOnSide(m.elt[0],b)&&this.elt[1].isEqualOnSide(m.elt[1],b)}},{key:"allPositionsEqual",value:function(m,b){return this.elt[m].allPositionsEqual(b)}},{key:"toLine",value:function(m){this.elt[m].isArea()&&(this.elt[m]=new Tr(this.elt[m].location[0]))}}],[{key:"constructor_",value:function(){if(this.elt=new Array(2).fill(null),arguments.length===1){if(Number.isInteger(arguments[0])){var m=arguments[0];this.elt[0]=new Tr(m),this.elt[1]=new Tr(m)}else if(arguments[0]instanceof U){var b=arguments[0];this.elt[0]=new Tr(b.elt[0]),this.elt[1]=new Tr(b.elt[1])}}else if(arguments.length===2){var w=arguments[0],R=arguments[1];this.elt[0]=new Tr(We.NONE),this.elt[1]=new Tr(We.NONE),this.elt[w].setLocation(R)}else if(arguments.length===3){var J=arguments[0],ve=arguments[1],Ie=arguments[2];this.elt[0]=new Tr(J,ve,Ie),this.elt[1]=new Tr(J,ve,Ie)}else if(arguments.length===4){var je=arguments[0],lt=arguments[1],Ft=arguments[2],Kt=arguments[3];this.elt[0]=new Tr(We.NONE,We.NONE,We.NONE),this.elt[1]=new Tr(We.NONE,We.NONE,We.NONE),this.elt[je].setLocations(lt,Ft,Kt)}}},{key:"toLineLabel",value:function(m){for(var b=new U(We.NONE),w=0;w<2;w++)b.setLocation(w,m.getLocation(w));return b}}]),U}(),sr=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"computeRing",value:function(){if(this._ring!==null)return null;for(var m=new Array(this._pts.size()).fill(null),b=0;b<this._pts.size();b++)m[b]=this._pts.get(b);this._ring=this._geometryFactory.createLinearRing(m),this._isHole=xn.isCCW(this._ring.getCoordinates())}},{key:"isIsolated",value:function(){return this._label.getGeometryCount()===1}},{key:"computePoints",value:function(m){this._startDe=m;var b=m,w=!0;do{if(b===null)throw new Rr("Found null DirectedEdge");if(b.getEdgeRing()===this)throw new Rr("Directed Edge visited twice during ring-building at "+b.getCoordinate());this._edges.add(b);var R=b.getLabel();Ue.isTrue(R.isArea()),this.mergeLabel(R),this.addPoints(b.getEdge(),b.isForward(),w),w=!1,this.setEdgeRing(b,this),b=this.getNext(b)}while(b!==this._startDe)}},{key:"getLinearRing",value:function(){return this._ring}},{key:"getCoordinate",value:function(m){return this._pts.get(m)}},{key:"computeMaxNodeDegree",value:function(){this._maxNodeDegree=0;var m=this._startDe;do{var b=m.getNode().getEdges().getOutgoingDegree(this);b>this._maxNodeDegree&&(this._maxNodeDegree=b),m=this.getNext(m)}while(m!==this._startDe);this._maxNodeDegree*=2}},{key:"addPoints",value:function(m,b,w){var R=m.getCoordinates();if(b){var J=1;w&&(J=0);for(var ve=J;ve<R.length;ve++)this._pts.add(R[ve])}else{var Ie=R.length-2;w&&(Ie=R.length-1);for(var je=Ie;je>=0;je--)this._pts.add(R[je])}}},{key:"isHole",value:function(){return this._isHole}},{key:"setInResult",value:function(){var m=this._startDe;do m.getEdge().setInResult(!0),m=m.getNext();while(m!==this._startDe)}},{key:"containsPoint",value:function(m){var b=this.getLinearRing();if(!b.getEnvelopeInternal().contains(m)||!ii.isInRing(m,b.getCoordinates()))return!1;for(var w=this._holes.iterator();w.hasNext();)if(w.next().containsPoint(m))return!1;return!0}},{key:"addHole",value:function(m){this._holes.add(m)}},{key:"isShell",value:function(){return this._shell===null}},{key:"getLabel",value:function(){return this._label}},{key:"getEdges",value:function(){return this._edges}},{key:"getMaxNodeDegree",value:function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree}},{key:"getShell",value:function(){return this._shell}},{key:"mergeLabel",value:function(){if(arguments.length===1){var m=arguments[0];this.mergeLabel(m,0),this.mergeLabel(m,1)}else if(arguments.length===2){var b=arguments[0],w=arguments[1],R=b.getLocation(w,nt.RIGHT);if(R===We.NONE)return null;if(this._label.getLocation(w)===We.NONE)return this._label.setLocation(w,R),null}}},{key:"setShell",value:function(m){this._shell=m,m!==null&&m.addHole(this)}},{key:"toPolygon",value:function(m){for(var b=new Array(this._holes.size()).fill(null),w=0;w<this._holes.size();w++)b[w]=this._holes.get(w).getLinearRing();return m.createPolygon(this.getLinearRing(),b)}}],[{key:"constructor_",value:function(){if(this._startDe=null,this._maxNodeDegree=-1,this._edges=new Mn,this._pts=new Mn,this._label=new Kr(We.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new Mn,this._geometryFactory=null,arguments.length!==0){if(arguments.length===2){var m=arguments[0],b=arguments[1];this._geometryFactory=b,this.computePoints(m),this.computeRing()}}}}]),U}(),jn=function(U){u(b,U);var m=D(b);function b(){var w;return n(this,b),w=m.call(this),b.constructor_.apply(I(w),arguments),w}return a(b,[{key:"setEdgeRing",value:function(w,R){w.setMinEdgeRing(R)}},{key:"getNext",value:function(w){return w.getNextMin()}}],[{key:"constructor_",value:function(){var w=arguments[0],R=arguments[1];sr.constructor_.call(this,w,R)}}]),b}(sr),kr=function(U){u(b,U);var m=D(b);function b(){var w;return n(this,b),w=m.call(this),b.constructor_.apply(I(w),arguments),w}return a(b,[{key:"buildMinimalRings",value:function(){var w=new Mn,R=this._startDe;do{if(R.getMinEdgeRing()===null){var J=new jn(R,this._geometryFactory);w.add(J)}R=R.getNext()}while(R!==this._startDe);return w}},{key:"setEdgeRing",value:function(w,R){w.setEdgeRing(R)}},{key:"linkDirectedEdgesForMinimalEdgeRings",value:function(){var w=this._startDe;do w.getNode().getEdges().linkMinimalDirectedEdges(this),w=w.getNext();while(w!==this._startDe)}},{key:"getNext",value:function(w){return w.getNext()}}],[{key:"constructor_",value:function(){var w=arguments[0],R=arguments[1];sr.constructor_.call(this,w,R)}}]),b}(sr),Ri=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"setVisited",value:function(m){this._isVisited=m}},{key:"setInResult",value:function(m){this._isInResult=m}},{key:"isCovered",value:function(){return this._isCovered}},{key:"isCoveredSet",value:function(){return this._isCoveredSet}},{key:"setLabel",value:function(m){this._label=m}},{key:"getLabel",value:function(){return this._label}},{key:"setCovered",value:function(m){this._isCovered=m,this._isCoveredSet=!0}},{key:"updateIM",value:function(m){Ue.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(m)}},{key:"isInResult",value:function(){return this._isInResult}},{key:"isVisited",value:function(){return this._isVisited}}],[{key:"constructor_",value:function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,arguments.length!==0){if(arguments.length===1){var m=arguments[0];this._label=m}}}}]),U}(),Qi=function(U){u(b,U);var m=D(b);function b(){var w;return n(this,b),w=m.call(this),b.constructor_.apply(I(w),arguments),w}return a(b,[{key:"isIncidentEdgeInResult",value:function(){for(var w=this.getEdges().getEdges().iterator();w.hasNext();)if(w.next().getEdge().isInResult())return!0;return!1}},{key:"isIsolated",value:function(){return this._label.getGeometryCount()===1}},{key:"getCoordinate",value:function(){return this._coord}},{key:"print",value:function(w){w.println("node "+this._coord+" lbl: "+this._label)}},{key:"computeIM",value:function(w){}},{key:"computeMergedLocation",value:function(w,R){var J=We.NONE;if(J=this._label.getLocation(R),!w.isNull(R)){var ve=w.getLocation(R);J!==We.BOUNDARY&&(J=ve)}return J}},{key:"setLabel",value:function(){if(arguments.length!==2||!Number.isInteger(arguments[1])||!Number.isInteger(arguments[0]))return N(f(b.prototype),"setLabel",this).apply(this,arguments);var w=arguments[0],R=arguments[1];this._label===null?this._label=new Kr(w,R):this._label.setLocation(w,R)}},{key:"getEdges",value:function(){return this._edges}},{key:"mergeLabel",value:function(){if(arguments[0]instanceof b){var w=arguments[0];this.mergeLabel(w._label)}else if(arguments[0]instanceof Kr)for(var R=arguments[0],J=0;J<2;J++){var ve=this.computeMergedLocation(R,J),Ie=this._label.getLocation(J);Ie===We.NONE&&this._label.setLocation(J,ve)}}},{key:"add",value:function(w){this._edges.insert(w),w.setNode(this)}},{key:"setLabelBoundary",value:function(w){if(this._label===null)return null;var R=We.NONE;this._label!==null&&(R=this._label.getLocation(w));var J=null;switch(R){case We.BOUNDARY:J=We.INTERIOR;break;case We.INTERIOR:default:J=We.BOUNDARY}this._label.setLocation(w,J)}}],[{key:"constructor_",value:function(){this._coord=null,this._edges=null;var w=arguments[0],R=arguments[1];this._coord=w,this._edges=R,this._label=new Kr(0,We.NONE)}}]),b}(Ri),Mo=function(U){u(b,U);var m=D(b);function b(){return n(this,b),m.apply(this,arguments)}return b}(bs);function ta(U){return U==null?0:U.color}function On(U){return U==null?null:U.parent}function xr(U,m){U!==null&&(U.color=m)}function ai(U){return U==null?null:U.left}function Gs(U){return U==null?null:U.right}var oo=function(U){u(b,U);var m=D(b);function b(){var w;return n(this,b),(w=m.call(this)).root_=null,w.size_=0,w}return a(b,[{key:"get",value:function(w){for(var R=this.root_;R!==null;){var J=w.compareTo(R.key);if(J<0)R=R.left;else{if(!(J>0))return R.value;R=R.right}}return null}},{key:"put",value:function(w,R){if(this.root_===null)return this.root_={key:w,value:R,left:null,right:null,parent:null,color:0,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var J,ve,Ie=this.root_;do if(J=Ie,(ve=w.compareTo(Ie.key))<0)Ie=Ie.left;else{if(!(ve>0)){var je=Ie.value;return Ie.value=R,je}Ie=Ie.right}while(Ie!==null);var lt={key:w,left:null,right:null,value:R,parent:J,color:0,getValue:function(){return this.value},getKey:function(){return this.key}};return ve<0?J.left=lt:J.right=lt,this.fixAfterInsertion(lt),this.size_++,null}},{key:"fixAfterInsertion",value:function(w){var R;for(w.color=1;w!=null&&w!==this.root_&&w.parent.color===1;)On(w)===ai(On(On(w)))?ta(R=Gs(On(On(w))))===1?(xr(On(w),0),xr(R,0),xr(On(On(w)),1),w=On(On(w))):(w===Gs(On(w))&&(w=On(w),this.rotateLeft(w)),xr(On(w),0),xr(On(On(w)),1),this.rotateRight(On(On(w)))):ta(R=ai(On(On(w))))===1?(xr(On(w),0),xr(R,0),xr(On(On(w)),1),w=On(On(w))):(w===ai(On(w))&&(w=On(w),this.rotateRight(w)),xr(On(w),0),xr(On(On(w)),1),this.rotateLeft(On(On(w))));this.root_.color=0}},{key:"values",value:function(){var w=new Mn,R=this.getFirstEntry();if(R!==null)for(w.add(R.value);(R=b.successor(R))!==null;)w.add(R.value);return w}},{key:"entrySet",value:function(){var w=new ut,R=this.getFirstEntry();if(R!==null)for(w.add(R);(R=b.successor(R))!==null;)w.add(R);return w}},{key:"rotateLeft",value:function(w){if(w!=null){var R=w.right;w.right=R.left,R.left!=null&&(R.left.parent=w),R.parent=w.parent,w.parent==null?this.root_=R:w.parent.left===w?w.parent.left=R:w.parent.right=R,R.left=w,w.parent=R}}},{key:"rotateRight",value:function(w){if(w!=null){var R=w.left;w.left=R.right,R.right!=null&&(R.right.parent=w),R.parent=w.parent,w.parent==null?this.root_=R:w.parent.right===w?w.parent.right=R:w.parent.left=R,R.right=w,w.parent=R}}},{key:"getFirstEntry",value:function(){var w=this.root_;if(w!=null)for(;w.left!=null;)w=w.left;return w}},{key:"size",value:function(){return this.size_}},{key:"containsKey",value:function(w){for(var R=this.root_;R!==null;){var J=w.compareTo(R.key);if(J<0)R=R.left;else{if(!(J>0))return!0;R=R.right}}return!1}}],[{key:"successor",value:function(w){var R;if(w===null)return null;if(w.right!==null){for(R=w.right;R.left!==null;)R=R.left;return R}R=w.parent;for(var J=w;R!==null&&J===R.right;)J=R,R=R.parent;return R}}]),b}(Mo),ci=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"find",value:function(m){return this.nodeMap.get(m)}},{key:"addNode",value:function(){if(arguments[0]instanceof ot){var m=arguments[0],b=this.nodeMap.get(m);return b===null&&(b=this.nodeFact.createNode(m),this.nodeMap.put(m,b)),b}if(arguments[0]instanceof Qi){var w=arguments[0],R=this.nodeMap.get(w.getCoordinate());return R===null?(this.nodeMap.put(w.getCoordinate(),w),w):(R.mergeLabel(w),R)}}},{key:"print",value:function(m){for(var b=this.iterator();b.hasNext();)b.next().print(m)}},{key:"iterator",value:function(){return this.nodeMap.values().iterator()}},{key:"values",value:function(){return this.nodeMap.values()}},{key:"getBoundaryNodes",value:function(m){for(var b=new Mn,w=this.iterator();w.hasNext();){var R=w.next();R.getLabel().getLocation(m)===We.BOUNDARY&&b.add(R)}return b}},{key:"add",value:function(m){var b=m.getCoordinate();this.addNode(b).add(m)}}],[{key:"constructor_",value:function(){this.nodeMap=new oo,this.nodeFact=null;var m=arguments[0];this.nodeFact=m}}]),U}(),us=function(){function U(){n(this,U)}return a(U,null,[{key:"isNorthern",value:function(m){return m===U.NE||m===U.NW}},{key:"isOpposite",value:function(m,b){return m!==b&&(m-b+4)%4===2}},{key:"commonHalfPlane",value:function(m,b){if(m===b)return m;if((m-b+4)%4===2)return-1;var w=m<b?m:b;return w===0&&(m>b?m:b)===3?3:w}},{key:"isInHalfPlane",value:function(m,b){return b===U.SE?m===U.SE||m===U.SW:m===b||m===b+1}},{key:"quadrant",value:function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var m=arguments[0],b=arguments[1];if(m===0&&b===0)throw new le("Cannot compute the quadrant for point ( "+m+", "+b+" )");return m>=0?b>=0?U.NE:U.SE:b>=0?U.NW:U.SW}if(arguments[0]instanceof ot&&arguments[1]instanceof ot){var w=arguments[0],R=arguments[1];if(R.x===w.x&&R.y===w.y)throw new le("Cannot compute the quadrant for two identical points "+w);return R.x>=w.x?R.y>=w.y?U.NE:U.SE:R.y>=w.y?U.NW:U.SW}}}]),U}();us.NE=0,us.NW=1,us.SW=2,us.SE=3;var Fl=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"compareDirection",value:function(m){return this._dx===m._dx&&this._dy===m._dy?0:this._quadrant>m._quadrant?1:this._quadrant<m._quadrant?-1:xn.index(m._p0,m._p1,this._p1)}},{key:"getDy",value:function(){return this._dy}},{key:"getCoordinate",value:function(){return this._p0}},{key:"setNode",value:function(m){this._node=m}},{key:"print",value:function(m){var b=Math.atan2(this._dy,this._dx),w=this.getClass().getName(),R=w.lastIndexOf("."),J=w.substring(R+1);m.print("  "+J+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+b+"   "+this._label)}},{key:"compareTo",value:function(m){var b=m;return this.compareDirection(b)}},{key:"getDirectedCoordinate",value:function(){return this._p1}},{key:"getDx",value:function(){return this._dx}},{key:"getLabel",value:function(){return this._label}},{key:"getEdge",value:function(){return this._edge}},{key:"getQuadrant",value:function(){return this._quadrant}},{key:"getNode",value:function(){return this._node}},{key:"toString",value:function(){var m=Math.atan2(this._dy,this._dx),b=this.getClass().getName(),w=b.lastIndexOf(".");return"  "+b.substring(w+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+m+"   "+this._label}},{key:"computeLabel",value:function(m){}},{key:"init",value:function(m,b){this._p0=m,this._p1=b,this._dx=b.x-m.x,this._dy=b.y-m.y,this._quadrant=us.quadrant(this._dx,this._dy),Ue.isTrue(!(this._dx===0&&this._dy===0),"EdgeEnd with identical endpoints found")}},{key:"interfaces_",get:function(){return[ye]}}],[{key:"constructor_",value:function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,arguments.length===1){var m=arguments[0];this._edge=m}else if(arguments.length===3){var b=arguments[0],w=arguments[1],R=arguments[2];U.constructor_.call(this,b,w,R,null)}else if(arguments.length===4){var J=arguments[0],ve=arguments[1],Ie=arguments[2],je=arguments[3];U.constructor_.call(this,J),this.init(ve,Ie),this._label=je}}}]),U}(),qa=function(U){u(b,U);var m=D(b);function b(){var w;return n(this,b),w=m.call(this),b.constructor_.apply(I(w),arguments),w}return a(b,[{key:"getNextMin",value:function(){return this._nextMin}},{key:"getDepth",value:function(w){return this._depth[w]}},{key:"setVisited",value:function(w){this._isVisited=w}},{key:"computeDirectedLabel",value:function(){this._label=new Kr(this._edge.getLabel()),this._isForward||this._label.flip()}},{key:"getNext",value:function(){return this._next}},{key:"setDepth",value:function(w,R){if(this._depth[w]!==-999&&this._depth[w]!==R)throw new Rr("assigned depths do not match",this.getCoordinate());this._depth[w]=R}},{key:"isInteriorAreaEdge",value:function(){for(var w=!0,R=0;R<2;R++)this._label.isArea(R)&&this._label.getLocation(R,nt.LEFT)===We.INTERIOR&&this._label.getLocation(R,nt.RIGHT)===We.INTERIOR||(w=!1);return w}},{key:"setNextMin",value:function(w){this._nextMin=w}},{key:"print",value:function(w){N(f(b.prototype),"print",this).call(this,w),w.print(" "+this._depth[nt.LEFT]+"/"+this._depth[nt.RIGHT]),w.print(" ("+this.getDepthDelta()+")"),this._isInResult&&w.print(" inResult")}},{key:"setMinEdgeRing",value:function(w){this._minEdgeRing=w}},{key:"isLineEdge",value:function(){var w=this._label.isLine(0)||this._label.isLine(1),R=!this._label.isArea(0)||this._label.allPositionsEqual(0,We.EXTERIOR),J=!this._label.isArea(1)||this._label.allPositionsEqual(1,We.EXTERIOR);return w&&R&&J}},{key:"setEdgeRing",value:function(w){this._edgeRing=w}},{key:"getMinEdgeRing",value:function(){return this._minEdgeRing}},{key:"getDepthDelta",value:function(){var w=this._edge.getDepthDelta();return this._isForward||(w=-w),w}},{key:"setInResult",value:function(w){this._isInResult=w}},{key:"getSym",value:function(){return this._sym}},{key:"isForward",value:function(){return this._isForward}},{key:"getEdge",value:function(){return this._edge}},{key:"printEdge",value:function(w){this.print(w),w.print(" "),this._isForward?this._edge.print(w):this._edge.printReverse(w)}},{key:"setSym",value:function(w){this._sym=w}},{key:"setVisitedEdge",value:function(w){this.setVisited(w),this._sym.setVisited(w)}},{key:"setEdgeDepths",value:function(w,R){var J=this.getEdge().getDepthDelta();this._isForward||(J=-J);var ve=1;w===nt.LEFT&&(ve=-1);var Ie=nt.opposite(w),je=R+J*ve;this.setDepth(w,R),this.setDepth(Ie,je)}},{key:"getEdgeRing",value:function(){return this._edgeRing}},{key:"isInResult",value:function(){return this._isInResult}},{key:"setNext",value:function(w){this._next=w}},{key:"isVisited",value:function(){return this._isVisited}}],[{key:"constructor_",value:function(){this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999];var w=arguments[0],R=arguments[1];if(Fl.constructor_.call(this,w),this._isForward=R,R)this.init(w.getCoordinate(0),w.getCoordinate(1));else{var J=w.getNumPoints()-1;this.init(w.getCoordinate(J),w.getCoordinate(J-1))}this.computeDirectedLabel()}},{key:"depthFactor",value:function(w,R){return w===We.EXTERIOR&&R===We.INTERIOR?1:w===We.INTERIOR&&R===We.EXTERIOR?-1:0}}]),b}(Fl),ws=function(){function U(){n(this,U)}return a(U,[{key:"createNode",value:function(m){return new Qi(m,null)}}]),U}(),co=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"printEdges",value:function(m){m.println("Edges:");for(var b=0;b<this._edges.size();b++){m.println("edge "+b+":");var w=this._edges.get(b);w.print(m),w.eiList.print(m)}}},{key:"find",value:function(m){return this._nodes.find(m)}},{key:"addNode",value:function(){if(arguments[0]instanceof Qi){var m=arguments[0];return this._nodes.addNode(m)}if(arguments[0]instanceof ot){var b=arguments[0];return this._nodes.addNode(b)}}},{key:"getNodeIterator",value:function(){return this._nodes.iterator()}},{key:"linkResultDirectedEdges",value:function(){for(var m=this._nodes.iterator();m.hasNext();)m.next().getEdges().linkResultDirectedEdges()}},{key:"debugPrintln",value:function(m){vr.out.println(m)}},{key:"isBoundaryNode",value:function(m,b){var w=this._nodes.find(b);if(w===null)return!1;var R=w.getLabel();return R!==null&&R.getLocation(m)===We.BOUNDARY}},{key:"linkAllDirectedEdges",value:function(){for(var m=this._nodes.iterator();m.hasNext();)m.next().getEdges().linkAllDirectedEdges()}},{key:"matchInSameDirection",value:function(m,b,w,R){return!!m.equals(w)&&xn.index(m,b,R)===xn.COLLINEAR&&us.quadrant(m,b)===us.quadrant(w,R)}},{key:"getEdgeEnds",value:function(){return this._edgeEndList}},{key:"debugPrint",value:function(m){vr.out.print(m)}},{key:"getEdgeIterator",value:function(){return this._edges.iterator()}},{key:"findEdgeInSameDirection",value:function(m,b){for(var w=0;w<this._edges.size();w++){var R=this._edges.get(w),J=R.getCoordinates();if(this.matchInSameDirection(m,b,J[0],J[1])||this.matchInSameDirection(m,b,J[J.length-1],J[J.length-2]))return R}return null}},{key:"insertEdge",value:function(m){this._edges.add(m)}},{key:"findEdgeEnd",value:function(m){for(var b=this.getEdgeEnds().iterator();b.hasNext();){var w=b.next();if(w.getEdge()===m)return w}return null}},{key:"addEdges",value:function(m){for(var b=m.iterator();b.hasNext();){var w=b.next();this._edges.add(w);var R=new qa(w,!0),J=new qa(w,!1);R.setSym(J),J.setSym(R),this.add(R),this.add(J)}}},{key:"add",value:function(m){this._nodes.add(m),this._edgeEndList.add(m)}},{key:"getNodes",value:function(){return this._nodes.values()}},{key:"findEdge",value:function(m,b){for(var w=0;w<this._edges.size();w++){var R=this._edges.get(w),J=R.getCoordinates();if(m.equals(J[0])&&b.equals(J[1]))return R}return null}}],[{key:"constructor_",value:function(){if(this._edges=new Mn,this._nodes=null,this._edgeEndList=new Mn,arguments.length===0)this._nodes=new ci(new ws);else if(arguments.length===1){var m=arguments[0];this._nodes=new ci(m)}}},{key:"linkResultDirectedEdges",value:function(m){for(var b=m.iterator();b.hasNext();)b.next().getEdges().linkResultDirectedEdges()}}]),U}(),qh=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"sortShellsAndHoles",value:function(m,b,w){for(var R=m.iterator();R.hasNext();){var J=R.next();J.isHole()?w.add(J):b.add(J)}}},{key:"computePolygons",value:function(m){for(var b=new Mn,w=m.iterator();w.hasNext();){var R=w.next().toPolygon(this._geometryFactory);b.add(R)}return b}},{key:"placeFreeHoles",value:function(m,b){for(var w=b.iterator();w.hasNext();){var R=w.next();if(R.getShell()===null){var J=U.findEdgeRingContaining(R,m);if(J===null)throw new Rr("unable to assign hole to a shell",R.getCoordinate(0));R.setShell(J)}}}},{key:"buildMinimalEdgeRings",value:function(m,b,w){for(var R=new Mn,J=m.iterator();J.hasNext();){var ve=J.next();if(ve.getMaxNodeDegree()>2){ve.linkDirectedEdgesForMinimalEdgeRings();var Ie=ve.buildMinimalRings(),je=this.findShell(Ie);je!==null?(this.placePolygonHoles(je,Ie),b.add(je)):w.addAll(Ie)}else R.add(ve)}return R}},{key:"buildMaximalEdgeRings",value:function(m){for(var b=new Mn,w=m.iterator();w.hasNext();){var R=w.next();if(R.isInResult()&&R.getLabel().isArea()&&R.getEdgeRing()===null){var J=new kr(R,this._geometryFactory);b.add(J),J.setInResult()}}return b}},{key:"placePolygonHoles",value:function(m,b){for(var w=b.iterator();w.hasNext();){var R=w.next();R.isHole()&&R.setShell(m)}}},{key:"getPolygons",value:function(){return this.computePolygons(this._shellList)}},{key:"findShell",value:function(m){for(var b=0,w=null,R=m.iterator();R.hasNext();){var J=R.next();J.isHole()||(w=J,b++)}return Ue.isTrue(b<=1,"found two shells in MinimalEdgeRing list"),w}},{key:"add",value:function(){if(arguments.length===1){var m=arguments[0];this.add(m.getEdgeEnds(),m.getNodes())}else if(arguments.length===2){var b=arguments[0],w=arguments[1];co.linkResultDirectedEdges(w);var R=this.buildMaximalEdgeRings(b),J=new Mn,ve=this.buildMinimalEdgeRings(R,this._shellList,J);this.sortShellsAndHoles(ve,this._shellList,J),this.placeFreeHoles(this._shellList,J)}}}],[{key:"constructor_",value:function(){this._geometryFactory=null,this._shellList=new Mn;var m=arguments[0];this._geometryFactory=m}},{key:"findEdgeRingContaining",value:function(m,b){for(var w=m.getLinearRing(),R=w.getEnvelopeInternal(),J=w.getCoordinateN(0),ve=null,Ie=null,je=b.iterator();je.hasNext();){var lt=je.next(),Ft=lt.getLinearRing(),Kt=Ft.getEnvelopeInternal();if(!Kt.equals(R)&&Kt.contains(R)){J=Or.ptNotInList(w.getCoordinates(),Ft.getCoordinates());var En=!1;ii.isInRing(J,Ft.getCoordinates())&&(En=!0),En&&(ve===null||Ie.contains(Kt))&&(Ie=(ve=lt).getLinearRing().getEnvelopeInternal())}}return ve}}]),U}(),uu=function(){function U(){n(this,U)}return a(U,[{key:"getBounds",value:function(){}}]),U}(),na=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"getItem",value:function(){return this._item}},{key:"getBounds",value:function(){return this._bounds}},{key:"interfaces_",get:function(){return[uu,ce]}}],[{key:"constructor_",value:function(){this._bounds=null,this._item=null;var m=arguments[0],b=arguments[1];this._bounds=m,this._item=b}}]),U}(),ra=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"poll",value:function(){if(this.isEmpty())return null;var m=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),m}},{key:"size",value:function(){return this._size}},{key:"reorder",value:function(m){for(var b=null,w=this._items.get(m);2*m<=this._size&&((b=2*m)!==this._size&&this._items.get(b+1).compareTo(this._items.get(b))<0&&b++,this._items.get(b).compareTo(w)<0);m=b)this._items.set(m,this._items.get(b));this._items.set(m,w)}},{key:"clear",value:function(){this._size=0,this._items.clear()}},{key:"peek",value:function(){return this.isEmpty()?null:this._items.get(1)}},{key:"isEmpty",value:function(){return this._size===0}},{key:"add",value:function(m){this._items.add(null),this._size+=1;var b=this._size;for(this._items.set(0,m);m.compareTo(this._items.get(Math.trunc(b/2)))<0;b/=2)this._items.set(b,this._items.get(Math.trunc(b/2)));this._items.set(b,m)}}],[{key:"constructor_",value:function(){this._size=null,this._items=null,this._size=0,this._items=new Mn,this._items.add(null)}}]),U}(),Ec=function(){function U(){n(this,U)}return a(U,[{key:"insert",value:function(m,b){}},{key:"remove",value:function(m,b){}},{key:"query",value:function(){}}]),U}(),_o=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"getLevel",value:function(){return this._level}},{key:"size",value:function(){return this._childBoundables.size()}},{key:"getChildBoundables",value:function(){return this._childBoundables}},{key:"addChildBoundable",value:function(m){Ue.isTrue(this._bounds===null),this._childBoundables.add(m)}},{key:"isEmpty",value:function(){return this._childBoundables.isEmpty()}},{key:"getBounds",value:function(){return this._bounds===null&&(this._bounds=this.computeBounds()),this._bounds}},{key:"interfaces_",get:function(){return[uu,ce]}}],[{key:"constructor_",value:function(){if(this._childBoundables=new Mn,this._bounds=null,this._level=null,arguments.length!==0){if(arguments.length===1){var m=arguments[0];this._level=m}}}}]),U}(),Yo={reverseOrder:function(){return{compare:function(U,m){return m.compareTo(U)}}},min:function(U){return Yo.sort(U),U.get(0)},sort:function(U,m){var b=U.toArray();m?Mt.sort(b,m):Mt.sort(b);for(var w=U.iterator(),R=0,J=b.length;R<J;R++)w.next(),w.set(b[R])},singletonList:function(U){var m=new Mn;return m.add(U),m}},Hs=function(){function U(){n(this,U)}return a(U,null,[{key:"maxDistance",value:function(m,b,w,R,J,ve,Ie,je){var lt=U.distance(m,b,J,ve);return lt=Math.max(lt,U.distance(m,b,Ie,je)),lt=Math.max(lt,U.distance(w,R,J,ve)),lt=Math.max(lt,U.distance(w,R,Ie,je))}},{key:"distance",value:function(m,b,w,R){var J=w-m,ve=R-b;return Math.sqrt(J*J+ve*ve)}},{key:"maximumDistance",value:function(m,b){var w=Math.min(m.getMinX(),b.getMinX()),R=Math.min(m.getMinY(),b.getMinY()),J=Math.max(m.getMaxX(),b.getMaxX()),ve=Math.max(m.getMaxY(),b.getMaxY());return U.distance(w,R,J,ve)}},{key:"minMaxDistance",value:function(m,b){var w=m.getMinX(),R=m.getMinY(),J=m.getMaxX(),ve=m.getMaxY(),Ie=b.getMinX(),je=b.getMinY(),lt=b.getMaxX(),Ft=b.getMaxY(),Kt=U.maxDistance(w,R,w,ve,Ie,je,Ie,Ft);return Kt=Math.min(Kt,U.maxDistance(w,R,w,ve,Ie,je,lt,je)),Kt=Math.min(Kt,U.maxDistance(w,R,w,ve,lt,Ft,Ie,Ft)),Kt=Math.min(Kt,U.maxDistance(w,R,w,ve,lt,Ft,lt,je)),Kt=Math.min(Kt,U.maxDistance(w,R,J,R,Ie,je,Ie,Ft)),Kt=Math.min(Kt,U.maxDistance(w,R,J,R,Ie,je,lt,je)),Kt=Math.min(Kt,U.maxDistance(w,R,J,R,lt,Ft,Ie,Ft)),Kt=Math.min(Kt,U.maxDistance(w,R,J,R,lt,Ft,lt,je)),Kt=Math.min(Kt,U.maxDistance(J,ve,w,ve,Ie,je,Ie,Ft)),Kt=Math.min(Kt,U.maxDistance(J,ve,w,ve,Ie,je,lt,je)),Kt=Math.min(Kt,U.maxDistance(J,ve,w,ve,lt,Ft,Ie,Ft)),Kt=Math.min(Kt,U.maxDistance(J,ve,w,ve,lt,Ft,lt,je)),Kt=Math.min(Kt,U.maxDistance(J,ve,J,R,Ie,je,Ie,Ft)),Kt=Math.min(Kt,U.maxDistance(J,ve,J,R,Ie,je,lt,je)),Kt=Math.min(Kt,U.maxDistance(J,ve,J,R,lt,Ft,Ie,Ft)),Kt=Math.min(Kt,U.maxDistance(J,ve,J,R,lt,Ft,lt,je))}}]),U}(),Xa=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"maximumDistance",value:function(){return Hs.maximumDistance(this._boundable1.getBounds(),this._boundable2.getBounds())}},{key:"expandToQueue",value:function(m,b){var w=U.isComposite(this._boundable1),R=U.isComposite(this._boundable2);if(w&&R)return U.area(this._boundable1)>U.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,!1,m,b),null):(this.expand(this._boundable2,this._boundable1,!0,m,b),null);if(w)return this.expand(this._boundable1,this._boundable2,!1,m,b),null;if(R)return this.expand(this._boundable2,this._boundable1,!0,m,b),null;throw new le("neither boundable is composite")}},{key:"isLeaves",value:function(){return!(U.isComposite(this._boundable1)||U.isComposite(this._boundable2))}},{key:"compareTo",value:function(m){var b=m;return this._distance<b._distance?-1:this._distance>b._distance?1:0}},{key:"expand",value:function(m,b,w,R,J){for(var ve=m.getChildBoundables().iterator();ve.hasNext();){var Ie=ve.next(),je=null;(je=w?new U(b,Ie,this._itemDistance):new U(Ie,b,this._itemDistance)).getDistance()<J&&R.add(je)}}},{key:"getBoundable",value:function(m){return m===0?this._boundable1:this._boundable2}},{key:"getDistance",value:function(){return this._distance}},{key:"distance",value:function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())}},{key:"interfaces_",get:function(){return[ye]}}],[{key:"constructor_",value:function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var m=arguments[0],b=arguments[1],w=arguments[2];this._boundable1=m,this._boundable2=b,this._itemDistance=w,this._distance=this.distance()}},{key:"area",value:function(m){return m.getBounds().getArea()}},{key:"isComposite",value:function(m){return m instanceof _o}}]),U}(),Pa=function(){function U(){n(this,U)}return a(U,[{key:"visitItem",value:function(m){}}]),U}(),to=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"queryInternal",value:function(){if(Jt(arguments[2],Pa)&&arguments[0]instanceof Object&&arguments[1]instanceof _o)for(var m=arguments[0],b=arguments[1],w=arguments[2],R=b.getChildBoundables(),J=0;J<R.size();J++){var ve=R.get(J);this.getIntersectsOp().intersects(ve.getBounds(),m)&&(ve instanceof _o?this.queryInternal(m,ve,w):ve instanceof na?w.visitItem(ve.getItem()):Ue.shouldNeverReachHere())}else if(Jt(arguments[2],qt)&&arguments[0]instanceof Object&&arguments[1]instanceof _o)for(var Ie=arguments[0],je=arguments[1],lt=arguments[2],Ft=je.getChildBoundables(),Kt=0;Kt<Ft.size();Kt++){var En=Ft.get(Kt);this.getIntersectsOp().intersects(En.getBounds(),Ie)&&(En instanceof _o?this.queryInternal(Ie,En,lt):En instanceof na?lt.add(En.getItem()):Ue.shouldNeverReachHere())}}},{key:"getNodeCapacity",value:function(){return this._nodeCapacity}},{key:"lastNode",value:function(m){return m.get(m.size()-1)}},{key:"size",value:function(){if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.size(this._root));if(arguments.length===1){for(var m=arguments[0],b=0,w=m.getChildBoundables().iterator();w.hasNext();){var R=w.next();R instanceof _o?b+=this.size(R):R instanceof na&&(b+=1)}return b}}},{key:"removeItem",value:function(m,b){for(var w=null,R=m.getChildBoundables().iterator();R.hasNext();){var J=R.next();J instanceof na&&J.getItem()===b&&(w=J)}return w!==null&&(m.getChildBoundables().remove(w),!0)}},{key:"itemsTree",value:function(){if(arguments.length===0){this.build();var m=this.itemsTree(this._root);return m===null?new Mn:m}if(arguments.length===1){for(var b=arguments[0],w=new Mn,R=b.getChildBoundables().iterator();R.hasNext();){var J=R.next();if(J instanceof _o){var ve=this.itemsTree(J);ve!==null&&w.add(ve)}else J instanceof na?w.add(J.getItem()):Ue.shouldNeverReachHere()}return w.size()<=0?null:w}}},{key:"insert",value:function(m,b){Ue.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new na(m,b))}},{key:"boundablesAtLevel",value:function(){if(arguments.length===1){var m=arguments[0],b=new Mn;return this.boundablesAtLevel(m,this._root,b),b}if(arguments.length===3){var w=arguments[0],R=arguments[1],J=arguments[2];if(Ue.isTrue(w>-2),R.getLevel()===w)return J.add(R),null;for(var ve=R.getChildBoundables().iterator();ve.hasNext();){var Ie=ve.next();Ie instanceof _o?this.boundablesAtLevel(w,Ie,J):(Ue.isTrue(Ie instanceof na),w===-1&&J.add(Ie))}return null}}},{key:"query",value:function(){if(arguments.length===1){var m=arguments[0];this.build();var b=new Mn;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),m)&&this.queryInternal(m,this._root,b),b}if(arguments.length===2){var w=arguments[0],R=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),w)&&this.queryInternal(w,this._root,R)}}},{key:"build",value:function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0}},{key:"getRoot",value:function(){return this.build(),this._root}},{key:"remove",value:function(){if(arguments.length===2){var m=arguments[0],b=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),m)&&this.remove(m,this._root,b)}if(arguments.length===3){var w=arguments[0],R=arguments[1],J=arguments[2],ve=this.removeItem(R,J);if(ve)return!0;for(var Ie=null,je=R.getChildBoundables().iterator();je.hasNext();){var lt=je.next();if(this.getIntersectsOp().intersects(lt.getBounds(),w)&&lt instanceof _o&&(ve=this.remove(w,lt,J))){Ie=lt;break}}return Ie!==null&&Ie.getChildBoundables().isEmpty()&&R.getChildBoundables().remove(Ie),ve}}},{key:"createHigherLevels",value:function(m,b){Ue.isTrue(!m.isEmpty());var w=this.createParentBoundables(m,b+1);return w.size()===1?w.get(0):this.createHigherLevels(w,b+1)}},{key:"depth",value:function(){if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(arguments.length===1){for(var m=arguments[0],b=0,w=m.getChildBoundables().iterator();w.hasNext();){var R=w.next();if(R instanceof _o){var J=this.depth(R);J>b&&(b=J)}}return b+1}}},{key:"createParentBoundables",value:function(m,b){Ue.isTrue(!m.isEmpty());var w=new Mn;w.add(this.createNode(b));var R=new Mn(m);Yo.sort(R,this.getComparator());for(var J=R.iterator();J.hasNext();){var ve=J.next();this.lastNode(w).getChildBoundables().size()===this.getNodeCapacity()&&w.add(this.createNode(b)),this.lastNode(w).addChildBoundable(ve)}return w}},{key:"isEmpty",value:function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()}},{key:"interfaces_",get:function(){return[ce]}}],[{key:"constructor_",value:function(){if(this._root=null,this._built=!1,this._itemBoundables=new Mn,this._nodeCapacity=null,arguments.length===0)U.constructor_.call(this,U.DEFAULT_NODE_CAPACITY);else if(arguments.length===1){var m=arguments[0];Ue.isTrue(m>1,"Node capacity must be greater than 1"),this._nodeCapacity=m}}},{key:"compareDoubles",value:function(m,b){return m>b?1:m<b?-1:0}}]),U}();to.IntersectsOp=function(){},to.DEFAULT_NODE_CAPACITY=10;var So=function(){function U(){n(this,U)}return a(U,[{key:"distance",value:function(m,b){}}]),U}(),Zo=function(U){u(b,U);var m=D(b);function b(){var w;return n(this,b),w=m.call(this),b.constructor_.apply(I(w),arguments),w}return a(b,[{key:"createParentBoundablesFromVerticalSlices",value:function(w,R){Ue.isTrue(w.length>0);for(var J=new Mn,ve=0;ve<w.length;ve++)J.addAll(this.createParentBoundablesFromVerticalSlice(w[ve],R));return J}},{key:"nearestNeighbourK",value:function(){if(arguments.length===2){var w=arguments[0],R=arguments[1];return this.nearestNeighbourK(w,Oe.POSITIVE_INFINITY,R)}if(arguments.length===3){var J=arguments[0],ve=arguments[1],Ie=arguments[2],je=ve,lt=new ra;lt.add(J);for(var Ft=new ra;!lt.isEmpty()&&je>=0;){var Kt=lt.poll(),En=Kt.getDistance();if(En>=je)break;if(Kt.isLeaves())if(Ft.size()<Ie)Ft.add(Kt);else{var or=Ft.peek();or.getDistance()>En&&(Ft.poll(),Ft.add(Kt));var er=Ft.peek();je=er.getDistance()}else Kt.expandToQueue(lt,je)}return b.getItems(Ft)}}},{key:"createNode",value:function(w){return new zo(w)}},{key:"size",value:function(){return arguments.length===0?N(f(b.prototype),"size",this).call(this):N(f(b.prototype),"size",this).apply(this,arguments)}},{key:"insert",value:function(){if(!(arguments.length===2&&arguments[1]instanceof Object&&arguments[0]instanceof wt))return N(f(b.prototype),"insert",this).apply(this,arguments);var w=arguments[0],R=arguments[1];if(w.isNull())return null;N(f(b.prototype),"insert",this).call(this,w,R)}},{key:"getIntersectsOp",value:function(){return b.intersectsOp}},{key:"verticalSlices",value:function(w,R){for(var J=Math.trunc(Math.ceil(w.size()/R)),ve=new Array(R).fill(null),Ie=w.iterator(),je=0;je<R;je++){ve[je]=new Mn;for(var lt=0;Ie.hasNext()&&lt<J;){var Ft=Ie.next();ve[je].add(Ft),lt++}}return ve}},{key:"query",value:function(){if(arguments.length===1){var w=arguments[0];return N(f(b.prototype),"query",this).call(this,w)}if(arguments.length===2){var R=arguments[0],J=arguments[1];N(f(b.prototype),"query",this).call(this,R,J)}}},{key:"getComparator",value:function(){return b.yComparator}},{key:"createParentBoundablesFromVerticalSlice",value:function(w,R){return N(f(b.prototype),"createParentBoundables",this).call(this,w,R)}},{key:"remove",value:function(){if(arguments.length===2&&arguments[1]instanceof Object&&arguments[0]instanceof wt){var w=arguments[0],R=arguments[1];return N(f(b.prototype),"remove",this).call(this,w,R)}return N(f(b.prototype),"remove",this).apply(this,arguments)}},{key:"depth",value:function(){return arguments.length===0?N(f(b.prototype),"depth",this).call(this):N(f(b.prototype),"depth",this).apply(this,arguments)}},{key:"createParentBoundables",value:function(w,R){Ue.isTrue(!w.isEmpty());var J=Math.trunc(Math.ceil(w.size()/this.getNodeCapacity())),ve=new Mn(w);Yo.sort(ve,b.xComparator);var Ie=this.verticalSlices(ve,Math.trunc(Math.ceil(Math.sqrt(J))));return this.createParentBoundablesFromVerticalSlices(Ie,R)}},{key:"nearestNeighbour",value:function(){if(arguments.length===1){if(Jt(arguments[0],So)){var w=arguments[0];if(this.isEmpty())return null;var R=new Xa(this.getRoot(),this.getRoot(),w);return this.nearestNeighbour(R)}if(arguments[0]instanceof Xa){var J=arguments[0],ve=Oe.POSITIVE_INFINITY,Ie=null,je=new ra;for(je.add(J);!je.isEmpty()&&ve>0;){var lt=je.poll(),Ft=lt.getDistance();if(Ft>=ve)break;lt.isLeaves()?(ve=Ft,Ie=lt):lt.expandToQueue(je,ve)}return Ie===null?null:[Ie.getBoundable(0).getItem(),Ie.getBoundable(1).getItem()]}}else{if(arguments.length===2){var Kt=arguments[0],En=arguments[1];if(this.isEmpty()||Kt.isEmpty())return null;var or=new Xa(this.getRoot(),Kt.getRoot(),En);return this.nearestNeighbour(or)}if(arguments.length===3){var er=arguments[0],Nr=arguments[1],Bn=arguments[2],wr=new na(er,Nr),Pi=new Xa(this.getRoot(),wr,Bn);return this.nearestNeighbour(Pi)[0]}if(arguments.length===4){var Vi=arguments[0],Ko=arguments[1],so=arguments[2],ti=arguments[3],gs=new na(Vi,Ko),xa=new Xa(this.getRoot(),gs,so);return this.nearestNeighbourK(xa,ti)}}}},{key:"isWithinDistance",value:function(){if(arguments.length===2){var w=arguments[0],R=arguments[1],J=Oe.POSITIVE_INFINITY,ve=new ra;for(ve.add(w);!ve.isEmpty();){var Ie=ve.poll(),je=Ie.getDistance();if(je>R)return!1;if(Ie.maximumDistance()<=R)return!0;if(Ie.isLeaves()){if((J=je)<=R)return!0}else Ie.expandToQueue(ve,J)}return!1}if(arguments.length===3){var lt=arguments[0],Ft=arguments[1],Kt=arguments[2],En=new Xa(this.getRoot(),lt.getRoot(),Ft);return this.isWithinDistance(En,Kt)}}},{key:"interfaces_",get:function(){return[Ec,ce]}}],[{key:"constructor_",value:function(){if(arguments.length===0)b.constructor_.call(this,b.DEFAULT_NODE_CAPACITY);else if(arguments.length===1){var w=arguments[0];to.constructor_.call(this,w)}}},{key:"centreX",value:function(w){return b.avg(w.getMinX(),w.getMaxX())}},{key:"avg",value:function(w,R){return(w+R)/2}},{key:"getItems",value:function(w){for(var R=new Array(w.size()).fill(null),J=0;!w.isEmpty();){var ve=w.poll();R[J]=ve.getBoundable(0).getItem(),J++}return R}},{key:"centreY",value:function(w){return b.avg(w.getMinY(),w.getMaxY())}}]),b}(to),zo=function(U){u(b,U);var m=D(b);function b(){var w;return n(this,b),w=m.call(this),b.constructor_.apply(I(w),arguments),w}return a(b,[{key:"computeBounds",value:function(){for(var w=null,R=this.getChildBoundables().iterator();R.hasNext();){var J=R.next();w===null?w=new wt(J.getBounds()):w.expandToInclude(J.getBounds())}return w}}],[{key:"constructor_",value:function(){var w=arguments[0];_o.constructor_.call(this,w)}}]),b}(_o);Zo.STRtreeNode=zo,Zo.xComparator=new(function(){function U(){n(this,U)}return a(U,[{key:"interfaces_",get:function(){return[$e]}},{key:"compare",value:function(m,b){return to.compareDoubles(Zo.centreX(m.getBounds()),Zo.centreX(b.getBounds()))}}]),U}()),Zo.yComparator=new(function(){function U(){n(this,U)}return a(U,[{key:"interfaces_",get:function(){return[$e]}},{key:"compare",value:function(m,b){return to.compareDoubles(Zo.centreY(m.getBounds()),Zo.centreY(b.getBounds()))}}]),U}()),Zo.intersectsOp=new(function(){function U(){n(this,U)}return a(U,[{key:"interfaces_",get:function(){return[IntersectsOp]}},{key:"intersects",value:function(m,b){return m.intersects(b)}}]),U}()),Zo.DEFAULT_NODE_CAPACITY=10;var th=function(){function U(){n(this,U)}return a(U,null,[{key:"relativeSign",value:function(m,b){return m<b?-1:m>b?1:0}},{key:"compare",value:function(m,b,w){if(b.equals2D(w))return 0;var R=U.relativeSign(b.x,w.x),J=U.relativeSign(b.y,w.y);switch(m){case 0:return U.compareValue(R,J);case 1:return U.compareValue(J,R);case 2:return U.compareValue(J,-R);case 3:return U.compareValue(-R,J);case 4:return U.compareValue(-R,-J);case 5:return U.compareValue(-J,-R);case 6:return U.compareValue(-J,R);case 7:return U.compareValue(R,-J)}return Ue.shouldNeverReachHere("invalid octant value"),0}},{key:"compareValue",value:function(m,b){return m<0?-1:m>0?1:b<0?-1:b>0?1:0}}]),U}(),va=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"getCoordinate",value:function(){return this.coord}},{key:"print",value:function(m){m.print(this.coord),m.print(" seg # = "+this.segmentIndex)}},{key:"compareTo",value:function(m){var b=m;return this.segmentIndex<b.segmentIndex?-1:this.segmentIndex>b.segmentIndex?1:this.coord.equals2D(b.coord)?0:this._isInterior?b._isInterior?th.compare(this._segmentOctant,this.coord,b.coord):1:-1}},{key:"isEndPoint",value:function(m){return this.segmentIndex===0&&!this._isInterior||this.segmentIndex===m}},{key:"toString",value:function(){return this.segmentIndex+":"+this.coord.toString()}},{key:"isInterior",value:function(){return this._isInterior}},{key:"interfaces_",get:function(){return[ye]}}],[{key:"constructor_",value:function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var m=arguments[0],b=arguments[1],w=arguments[2],R=arguments[3];this._segString=m,this.coord=new ot(b),this.segmentIndex=w,this._segmentOctant=R,this._isInterior=!b.equals2D(m.getCoordinate(w))}}]),U}(),_l=function(){function U(){n(this,U)}return a(U,[{key:"hasNext",value:function(){}},{key:"next",value:function(){}},{key:"remove",value:function(){}}]),U}(),Nl=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"getSplitCoordinates",value:function(){var m=new Cr;this.addEndpoints();for(var b=this.iterator(),w=b.next();b.hasNext();){var R=b.next();this.addEdgeCoordinates(w,R,m),w=R}return m.toCoordinateArray()}},{key:"addCollapsedNodes",value:function(){var m=new Mn;this.findCollapsesFromInsertedNodes(m),this.findCollapsesFromExistingVertices(m);for(var b=m.iterator();b.hasNext();){var w=b.next().intValue();this.add(this._edge.getCoordinate(w),w)}}},{key:"createSplitEdgePts",value:function(m,b){var w=b.segmentIndex-m.segmentIndex+2;if(w===2)return[new ot(m.coord),new ot(b.coord)];var R=this._edge.getCoordinate(b.segmentIndex),J=b.isInterior()||!b.coord.equals2D(R);J||w--;var ve=new Array(w).fill(null),Ie=0;ve[Ie++]=new ot(m.coord);for(var je=m.segmentIndex+1;je<=b.segmentIndex;je++)ve[Ie++]=this._edge.getCoordinate(je);return J&&(ve[Ie]=new ot(b.coord)),ve}},{key:"print",value:function(m){m.println("Intersections:");for(var b=this.iterator();b.hasNext();)b.next().print(m)}},{key:"findCollapsesFromExistingVertices",value:function(m){for(var b=0;b<this._edge.size()-2;b++){var w=this._edge.getCoordinate(b);this._edge.getCoordinate(b+1);var R=this._edge.getCoordinate(b+2);w.equals2D(R)&&m.add(Fn.valueOf(b+1))}}},{key:"addEdgeCoordinates",value:function(m,b,w){var R=this.createSplitEdgePts(m,b);w.add(R,!1)}},{key:"iterator",value:function(){return this._nodeMap.values().iterator()}},{key:"addSplitEdges",value:function(m){this.addEndpoints(),this.addCollapsedNodes();for(var b=this.iterator(),w=b.next();b.hasNext();){var R=b.next(),J=this.createSplitEdge(w,R);m.add(J),w=R}}},{key:"findCollapseIndex",value:function(m,b,w){if(!m.coord.equals2D(b.coord))return!1;var R=b.segmentIndex-m.segmentIndex;return b.isInterior()||R--,R===1&&(w[0]=m.segmentIndex+1,!0)}},{key:"findCollapsesFromInsertedNodes",value:function(m){for(var b=new Array(1).fill(null),w=this.iterator(),R=w.next();w.hasNext();){var J=w.next();this.findCollapseIndex(R,J,b)&&m.add(Fn.valueOf(b[0])),R=J}}},{key:"getEdge",value:function(){return this._edge}},{key:"addEndpoints",value:function(){var m=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(m),m)}},{key:"createSplitEdge",value:function(m,b){var w=this.createSplitEdgePts(m,b);return new jl(w,this._edge.getData())}},{key:"add",value:function(m,b){var w=new va(this._edge,m,b,this._edge.getSegmentOctant(b)),R=this._nodeMap.get(w);return R!==null?(Ue.isTrue(R.coord.equals2D(m),"Found equal nodes with different coordinates"),R):(this._nodeMap.put(w,w),w)}},{key:"checkSplitEdgesCorrectness",value:function(m){var b=this._edge.getCoordinates(),w=m.get(0).getCoordinate(0);if(!w.equals2D(b[0]))throw new Ke("bad split edge start point at "+w);var R=m.get(m.size()-1).getCoordinates(),J=R[R.length-1];if(!J.equals2D(b[b.length-1]))throw new Ke("bad split edge end point at "+J)}}],[{key:"constructor_",value:function(){this._nodeMap=new oo,this._edge=null;var m=arguments[0];this._edge=m}}]),U}(),Bl=function(){function U(){n(this,U)}return a(U,null,[{key:"octant",value:function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var m=arguments[0],b=arguments[1];if(m===0&&b===0)throw new le("Cannot compute the octant for point ( "+m+", "+b+" )");var w=Math.abs(m),R=Math.abs(b);return m>=0?b>=0?w>=R?0:1:w>=R?7:6:b>=0?w>=R?3:2:w>=R?4:5}if(arguments[0]instanceof ot&&arguments[1]instanceof ot){var J=arguments[0],ve=arguments[1],Ie=ve.x-J.x,je=ve.y-J.y;if(Ie===0&&je===0)throw new le("Cannot compute the octant for two identical points "+J);return U.octant(Ie,je)}}}]),U}(),ud=function(){function U(){n(this,U)}return a(U,[{key:"getCoordinates",value:function(){}},{key:"size",value:function(){}},{key:"getCoordinate",value:function(m){}},{key:"isClosed",value:function(){}},{key:"setData",value:function(m){}},{key:"getData",value:function(){}}]),U}(),Ws=function(){function U(){n(this,U)}return a(U,[{key:"addIntersection",value:function(m,b){}},{key:"interfaces_",get:function(){return[ud]}}]),U}(),jl=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"getCoordinates",value:function(){return this._pts}},{key:"size",value:function(){return this._pts.length}},{key:"getCoordinate",value:function(m){return this._pts[m]}},{key:"isClosed",value:function(){return this._pts[0].equals(this._pts[this._pts.length-1])}},{key:"getSegmentOctant",value:function(m){return m===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(m),this.getCoordinate(m+1))}},{key:"setData",value:function(m){this._data=m}},{key:"safeOctant",value:function(m,b){return m.equals2D(b)?0:Bl.octant(m,b)}},{key:"getData",value:function(){return this._data}},{key:"addIntersection",value:function(){if(arguments.length===2){var m=arguments[0],b=arguments[1];this.addIntersectionNode(m,b)}else if(arguments.length===4){var w=arguments[0],R=arguments[1],J=arguments[3],ve=new ot(w.getIntersection(J));this.addIntersection(ve,R)}}},{key:"toString",value:function(){return rr.toLineString(new Wi(this._pts))}},{key:"getNodeList",value:function(){return this._nodeList}},{key:"addIntersectionNode",value:function(m,b){var w=b,R=w+1;if(R<this._pts.length){var J=this._pts[R];m.equals2D(J)&&(w=R)}return this._nodeList.add(m,w)}},{key:"addIntersections",value:function(m,b,w){for(var R=0;R<m.getIntersectionNum();R++)this.addIntersection(m,b,w,R)}},{key:"interfaces_",get:function(){return[Ws]}}],[{key:"constructor_",value:function(){this._nodeList=new Nl(this),this._pts=null,this._data=null;var m=arguments[0],b=arguments[1];this._pts=m,this._data=b}},{key:"getNodedSubstrings",value:function(){if(arguments.length===1){var m=arguments[0],b=new Mn;return U.getNodedSubstrings(m,b),b}if(arguments.length===2)for(var w=arguments[0],R=arguments[1],J=w.iterator();J.hasNext();){var ve=J.next();ve.getNodeList().addSplitEdges(R)}}}]),U}(),ia=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"minX",value:function(){return Math.min(this.p0.x,this.p1.x)}},{key:"orientationIndex",value:function(){if(arguments[0]instanceof U){var m=arguments[0],b=xn.index(this.p0,this.p1,m.p0),w=xn.index(this.p0,this.p1,m.p1);return b>=0&&w>=0||b<=0&&w<=0?Math.max(b,w):0}if(arguments[0]instanceof ot){var R=arguments[0];return xn.index(this.p0,this.p1,R)}}},{key:"toGeometry",value:function(m){return m.createLineString([this.p0,this.p1])}},{key:"isVertical",value:function(){return this.p0.x===this.p1.x}},{key:"equals",value:function(m){if(!(m instanceof U))return!1;var b=m;return this.p0.equals(b.p0)&&this.p1.equals(b.p1)}},{key:"intersection",value:function(m){var b=new hr;return b.computeIntersection(this.p0,this.p1,m.p0,m.p1),b.hasIntersection()?b.getIntersection(0):null}},{key:"project",value:function(){if(arguments[0]instanceof ot){var m=arguments[0];if(m.equals(this.p0)||m.equals(this.p1))return new ot(m);var b=this.projectionFactor(m),w=new ot;return w.x=this.p0.x+b*(this.p1.x-this.p0.x),w.y=this.p0.y+b*(this.p1.y-this.p0.y),w}if(arguments[0]instanceof U){var R=arguments[0],J=this.projectionFactor(R.p0),ve=this.projectionFactor(R.p1);if(J>=1&&ve>=1||J<=0&&ve<=0)return null;var Ie=this.project(R.p0);J<0&&(Ie=this.p0),J>1&&(Ie=this.p1);var je=this.project(R.p1);return ve<0&&(je=this.p0),ve>1&&(je=this.p1),new U(Ie,je)}}},{key:"normalize",value:function(){this.p1.compareTo(this.p0)<0&&this.reverse()}},{key:"angle",value:function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)}},{key:"getCoordinate",value:function(m){return m===0?this.p0:this.p1}},{key:"distancePerpendicular",value:function(m){return Li.pointToLinePerpendicular(m,this.p0,this.p1)}},{key:"minY",value:function(){return Math.min(this.p0.y,this.p1.y)}},{key:"midPoint",value:function(){return U.midPoint(this.p0,this.p1)}},{key:"projectionFactor",value:function(m){if(m.equals(this.p0))return 0;if(m.equals(this.p1))return 1;var b=this.p1.x-this.p0.x,w=this.p1.y-this.p0.y,R=b*b+w*w;return R<=0?Oe.NaN:((m.x-this.p0.x)*b+(m.y-this.p0.y)*w)/R}},{key:"closestPoints",value:function(m){var b=this.intersection(m);if(b!==null)return[b,b];var w=new Array(2).fill(null),R=Oe.MAX_VALUE,J=null,ve=this.closestPoint(m.p0);R=ve.distance(m.p0),w[0]=ve,w[1]=m.p0;var Ie=this.closestPoint(m.p1);(J=Ie.distance(m.p1))<R&&(R=J,w[0]=Ie,w[1]=m.p1);var je=m.closestPoint(this.p0);(J=je.distance(this.p0))<R&&(R=J,w[0]=this.p0,w[1]=je);var lt=m.closestPoint(this.p1);return(J=lt.distance(this.p1))<R&&(R=J,w[0]=this.p1,w[1]=lt),w}},{key:"closestPoint",value:function(m){var b=this.projectionFactor(m);return b>0&&b<1?this.project(m):this.p0.distance(m)<this.p1.distance(m)?this.p0:this.p1}},{key:"maxX",value:function(){return Math.max(this.p0.x,this.p1.x)}},{key:"getLength",value:function(){return this.p0.distance(this.p1)}},{key:"compareTo",value:function(m){var b=m,w=this.p0.compareTo(b.p0);return w!==0?w:this.p1.compareTo(b.p1)}},{key:"reverse",value:function(){var m=this.p0;this.p0=this.p1,this.p1=m}},{key:"equalsTopo",value:function(m){return this.p0.equals(m.p0)&&this.p1.equals(m.p1)||this.p0.equals(m.p1)&&this.p1.equals(m.p0)}},{key:"lineIntersection",value:function(m){return yo.intersection(this.p0,this.p1,m.p0,m.p1)}},{key:"maxY",value:function(){return Math.max(this.p0.y,this.p1.y)}},{key:"pointAlongOffset",value:function(m,b){var w=this.p0.x+m*(this.p1.x-this.p0.x),R=this.p0.y+m*(this.p1.y-this.p0.y),J=this.p1.x-this.p0.x,ve=this.p1.y-this.p0.y,Ie=Math.sqrt(J*J+ve*ve),je=0,lt=0;if(b!==0){if(Ie<=0)throw new IllegalStateException("Cannot compute offset from zero-length line segment");je=b*J/Ie,lt=b*ve/Ie}return new ot(w-lt,R+je)}},{key:"setCoordinates",value:function(){if(arguments.length===1){var m=arguments[0];this.setCoordinates(m.p0,m.p1)}else if(arguments.length===2){var b=arguments[0],w=arguments[1];this.p0.x=b.x,this.p0.y=b.y,this.p1.x=w.x,this.p1.y=w.y}}},{key:"segmentFraction",value:function(m){var b=this.projectionFactor(m);return b<0?b=0:(b>1||Oe.isNaN(b))&&(b=1),b}},{key:"toString",value:function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"}},{key:"isHorizontal",value:function(){return this.p0.y===this.p1.y}},{key:"reflect",value:function(m){var b=this.p1.getY()-this.p0.getY(),w=this.p0.getX()-this.p1.getX(),R=this.p0.getY()*(this.p1.getX()-this.p0.getX())-this.p0.getX()*(this.p1.getY()-this.p0.getY()),J=b*b+w*w,ve=b*b-w*w,Ie=m.getX(),je=m.getY();return new ot((-ve*Ie-2*b*w*je-2*b*R)/J,(ve*je-2*b*w*Ie-2*w*R)/J)}},{key:"distance",value:function(){if(arguments[0]instanceof U){var m=arguments[0];return Li.segmentToSegment(this.p0,this.p1,m.p0,m.p1)}if(arguments[0]instanceof ot){var b=arguments[0];return Li.pointToSegment(b,this.p0,this.p1)}}},{key:"pointAlong",value:function(m){var b=new ot;return b.x=this.p0.x+m*(this.p1.x-this.p0.x),b.y=this.p0.y+m*(this.p1.y-this.p0.y),b}},{key:"hashCode",value:function(){var m=Oe.doubleToLongBits(this.p0.x);m^=31*Oe.doubleToLongBits(this.p0.y);var b=Math.trunc(m)^Math.trunc(m>>32),w=Oe.doubleToLongBits(this.p1.x);return w^=31*Oe.doubleToLongBits(this.p1.y),b^(Math.trunc(w)^Math.trunc(w>>32))}},{key:"interfaces_",get:function(){return[ye,ce]}}],[{key:"constructor_",value:function(){if(this.p0=null,this.p1=null,arguments.length===0)U.constructor_.call(this,new ot,new ot);else if(arguments.length===1){var m=arguments[0];U.constructor_.call(this,m.p0,m.p1)}else if(arguments.length===2){var b=arguments[0],w=arguments[1];this.p0=b,this.p1=w}else if(arguments.length===4){var R=arguments[0],J=arguments[1],ve=arguments[2],Ie=arguments[3];U.constructor_.call(this,new ot(R,J),new ot(ve,Ie))}}},{key:"midPoint",value:function(m,b){return new ot((m.x+b.x)/2,(m.y+b.y)/2)}}]),U}(),oa=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"overlap",value:function(){if(arguments.length!==2){if(arguments.length===4){var m=arguments[0],b=arguments[1],w=arguments[2],R=arguments[3];m.getLineSegment(b,this._overlapSeg1),w.getLineSegment(R,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}}}}],[{key:"constructor_",value:function(){this._overlapSeg1=new ia,this._overlapSeg2=new ia}}]),U}(),cd=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"getLineSegment",value:function(m,b){b.p0=this._pts[m],b.p1=this._pts[m+1]}},{key:"computeSelect",value:function(m,b,w,R){var J=this._pts[b],ve=this._pts[w];if(w-b==1)return R.select(this,b),null;if(!m.intersects(J,ve))return null;var Ie=Math.trunc((b+w)/2);b<Ie&&this.computeSelect(m,b,Ie,R),Ie<w&&this.computeSelect(m,Ie,w,R)}},{key:"getCoordinates",value:function(){for(var m=new Array(this._end-this._start+1).fill(null),b=0,w=this._start;w<=this._end;w++)m[b++]=this._pts[w];return m}},{key:"computeOverlaps",value:function(){if(arguments.length===2){var m=arguments[0],b=arguments[1];this.computeOverlaps(this._start,this._end,m,m._start,m._end,b)}else if(arguments.length===6){var w=arguments[0],R=arguments[1],J=arguments[2],ve=arguments[3],Ie=arguments[4],je=arguments[5];if(R-w==1&&Ie-ve==1)return je.overlap(this,w,J,ve),null;if(!this.overlaps(w,R,J,ve,Ie))return null;var lt=Math.trunc((w+R)/2),Ft=Math.trunc((ve+Ie)/2);w<lt&&(ve<Ft&&this.computeOverlaps(w,lt,J,ve,Ft,je),Ft<Ie&&this.computeOverlaps(w,lt,J,Ft,Ie,je)),lt<R&&(ve<Ft&&this.computeOverlaps(lt,R,J,ve,Ft,je),Ft<Ie&&this.computeOverlaps(lt,R,J,Ft,Ie,je))}}},{key:"setId",value:function(m){this._id=m}},{key:"select",value:function(m,b){this.computeSelect(m,this._start,this._end,b)}},{key:"getEnvelope",value:function(){if(this._env===null){var m=this._pts[this._start],b=this._pts[this._end];this._env=new wt(m,b)}return this._env}},{key:"overlaps",value:function(m,b,w,R,J){return wt.intersects(this._pts[m],this._pts[b],w._pts[R],w._pts[J])}},{key:"getEndIndex",value:function(){return this._end}},{key:"getStartIndex",value:function(){return this._start}},{key:"getContext",value:function(){return this._context}},{key:"getId",value:function(){return this._id}}],[{key:"constructor_",value:function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var m=arguments[0],b=arguments[1],w=arguments[2],R=arguments[3];this._pts=m,this._start=b,this._end=w,this._context=R}}]),U}(),Vl=function(){function U(){n(this,U)}return a(U,null,[{key:"findChainEnd",value:function(m,b){for(var w=b;w<m.length-1&&m[w].equals2D(m[w+1]);)w++;if(w>=m.length-1)return m.length-1;for(var R=us.quadrant(m[w],m[w+1]),J=b+1;J<m.length&&!(!m[J-1].equals2D(m[J])&&us.quadrant(m[J-1],m[J])!==R);)J++;return J-1}},{key:"getChains",value:function(){if(arguments.length===1){var m=arguments[0];return U.getChains(m,null)}if(arguments.length===2){var b=arguments[0],w=arguments[1],R=new Mn,J=0;do{var ve=U.findChainEnd(b,J),Ie=new cd(b,J,ve,w);R.add(Ie),J=ve}while(J<b.length-1);return R}}}]),U}(),Du=function(){function U(){n(this,U)}return a(U,[{key:"computeNodes",value:function(m){}},{key:"getNodedSubstrings",value:function(){}}]),U}(),vl=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"setSegmentIntersector",value:function(m){this._segInt=m}},{key:"interfaces_",get:function(){return[Du]}}],[{key:"constructor_",value:function(){if(this._segInt=null,arguments.length!==0){if(arguments.length===1){var m=arguments[0];this.setSegmentIntersector(m)}}}}]),U}(),Ya=function(U){u(b,U);var m=D(b);function b(){var w;return n(this,b),w=m.call(this),b.constructor_.apply(I(w),arguments),w}return a(b,[{key:"getMonotoneChains",value:function(){return this._monoChains}},{key:"getNodedSubstrings",value:function(){return jl.getNodedSubstrings(this._nodedSegStrings)}},{key:"getIndex",value:function(){return this._index}},{key:"add",value:function(w){for(var R=Vl.getChains(w.getCoordinates(),w).iterator();R.hasNext();){var J=R.next();J.setId(this._idCounter++),this._index.insert(J.getEnvelope(),J),this._monoChains.add(J)}}},{key:"computeNodes",value:function(w){this._nodedSegStrings=w;for(var R=w.iterator();R.hasNext();)this.add(R.next());this.intersectChains()}},{key:"intersectChains",value:function(){for(var w=new zu(this._segInt),R=this._monoChains.iterator();R.hasNext();)for(var J=R.next(),ve=this._index.query(J.getEnvelope()).iterator();ve.hasNext();){var Ie=ve.next();if(Ie.getId()>J.getId()&&(J.computeOverlaps(Ie,w),this._nOverlaps++),this._segInt.isDone())return null}}}],[{key:"constructor_",value:function(){if(this._monoChains=new Mn,this._index=new Zo,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0,arguments.length!==0){if(arguments.length===1){var w=arguments[0];vl.constructor_.call(this,w)}}}}]),b}(vl),zu=function(U){u(b,U);var m=D(b);function b(){var w;return n(this,b),w=m.call(this),b.constructor_.apply(I(w),arguments),w}return a(b,[{key:"overlap",value:function(){if(arguments.length!==4)return N(f(b.prototype),"overlap",this).apply(this,arguments);var w=arguments[0],R=arguments[1],J=arguments[2],ve=arguments[3],Ie=w.getContext(),je=J.getContext();this._si.processIntersections(Ie,R,je,ve)}}],[{key:"constructor_",value:function(){this._si=null;var w=arguments[0];this._si=w}}]),b}(oa);Ya.SegmentOverlapAction=zu;var qs=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"isDeletable",value:function(m,b,w,R){var J=this._inputLine[m],ve=this._inputLine[b],Ie=this._inputLine[w];return!!this.isConcave(J,ve,Ie)&&!!this.isShallow(J,ve,Ie,R)&&this.isShallowSampled(J,ve,m,w,R)}},{key:"deleteShallowConcavities",value:function(){for(var m=1,b=this.findNextNonDeletedIndex(m),w=this.findNextNonDeletedIndex(b),R=!1;w<this._inputLine.length;){var J=!1;this.isDeletable(m,b,w,this._distanceTol)&&(this._isDeleted[b]=U.DELETE,J=!0,R=!0),m=J?w:b,b=this.findNextNonDeletedIndex(m),w=this.findNextNonDeletedIndex(b)}return R}},{key:"isShallowConcavity",value:function(m,b,w,R){return xn.index(m,b,w)===this._angleOrientation&&Li.pointToSegment(b,m,w)<R}},{key:"isShallowSampled",value:function(m,b,w,R,J){var ve=Math.trunc((R-w)/U.NUM_PTS_TO_CHECK);ve<=0&&(ve=1);for(var Ie=w;Ie<R;Ie+=ve)if(!this.isShallow(m,b,this._inputLine[Ie],J))return!1;return!0}},{key:"isConcave",value:function(m,b,w){var R=xn.index(m,b,w)===this._angleOrientation;return R}},{key:"simplify",value:function(m){this._distanceTol=Math.abs(m),m<0&&(this._angleOrientation=xn.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var b=!1;do b=this.deleteShallowConcavities();while(b);return this.collapseLine()}},{key:"findNextNonDeletedIndex",value:function(m){for(var b=m+1;b<this._inputLine.length&&this._isDeleted[b]===U.DELETE;)b++;return b}},{key:"isShallow",value:function(m,b,w,R){return Li.pointToSegment(b,m,w)<R}},{key:"collapseLine",value:function(){for(var m=new Cr,b=0;b<this._inputLine.length;b++)this._isDeleted[b]!==U.DELETE&&m.add(this._inputLine[b]);return m.toCoordinateArray()}}],[{key:"constructor_",value:function(){this._inputLine=null,this._distanceTol=null,this._isDeleted=null,this._angleOrientation=xn.COUNTERCLOCKWISE;var m=arguments[0];this._inputLine=m}},{key:"simplify",value:function(m,b){return new U(m).simplify(b)}}]),U}();qs.INIT=0,qs.DELETE=1,qs.KEEP=1,qs.NUM_PTS_TO_CHECK=10;var $l=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"getCoordinates",value:function(){return this._ptList.toArray(U.COORDINATE_ARRAY_TYPE)}},{key:"setPrecisionModel",value:function(m){this._precisionModel=m}},{key:"addPt",value:function(m){var b=new ot(m);if(this._precisionModel.makePrecise(b),this.isRedundant(b))return null;this._ptList.add(b)}},{key:"reverse",value:function(){}},{key:"addPts",value:function(m,b){if(b)for(var w=0;w<m.length;w++)this.addPt(m[w]);else for(var R=m.length-1;R>=0;R--)this.addPt(m[R])}},{key:"isRedundant",value:function(m){if(this._ptList.size()<1)return!1;var b=this._ptList.get(this._ptList.size()-1);return m.distance(b)<this._minimimVertexDistance}},{key:"toString",value:function(){return new Xo().createLineString(this.getCoordinates()).toString()}},{key:"closeRing",value:function(){if(this._ptList.size()<1)return null;var m=new ot(this._ptList.get(0)),b=this._ptList.get(this._ptList.size()-1);if(m.equals(b))return null;this._ptList.add(m)}},{key:"setMinimumVertexDistance",value:function(m){this._minimimVertexDistance=m}}],[{key:"constructor_",value:function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new Mn}}]),U}();$l.COORDINATE_ARRAY_TYPE=new Array(0).fill(null);var ca=function(){function U(){n(this,U)}return a(U,null,[{key:"toDegrees",value:function(m){return 180*m/Math.PI}},{key:"normalize",value:function(m){for(;m>Math.PI;)m-=U.PI_TIMES_2;for(;m<=-Math.PI;)m+=U.PI_TIMES_2;return m}},{key:"angle",value:function(){if(arguments.length===1){var m=arguments[0];return Math.atan2(m.y,m.x)}if(arguments.length===2){var b=arguments[0],w=arguments[1],R=w.x-b.x,J=w.y-b.y;return Math.atan2(J,R)}}},{key:"isAcute",value:function(m,b,w){var R=m.x-b.x,J=m.y-b.y;return R*(w.x-b.x)+J*(w.y-b.y)>0}},{key:"isObtuse",value:function(m,b,w){var R=m.x-b.x,J=m.y-b.y;return R*(w.x-b.x)+J*(w.y-b.y)<0}},{key:"interiorAngle",value:function(m,b,w){var R=U.angle(b,m),J=U.angle(b,w);return Math.abs(J-R)}},{key:"normalizePositive",value:function(m){if(m<0){for(;m<0;)m+=U.PI_TIMES_2;m>=U.PI_TIMES_2&&(m=0)}else{for(;m>=U.PI_TIMES_2;)m-=U.PI_TIMES_2;m<0&&(m=0)}return m}},{key:"angleBetween",value:function(m,b,w){var R=U.angle(b,m),J=U.angle(b,w);return U.diff(R,J)}},{key:"diff",value:function(m,b){var w=null;return(w=m<b?b-m:m-b)>Math.PI&&(w=2*Math.PI-w),w}},{key:"toRadians",value:function(m){return m*Math.PI/180}},{key:"getTurn",value:function(m,b){var w=Math.sin(b-m);return w>0?U.COUNTERCLOCKWISE:w<0?U.CLOCKWISE:U.NONE}},{key:"angleBetweenOriented",value:function(m,b,w){var R=U.angle(b,m),J=U.angle(b,w)-R;return J<=-Math.PI?J+U.PI_TIMES_2:J>Math.PI?J-U.PI_TIMES_2:J}}]),U}();ca.PI_TIMES_2=2*Math.PI,ca.PI_OVER_2=Math.PI/2,ca.PI_OVER_4=Math.PI/4,ca.COUNTERCLOCKWISE=xn.COUNTERCLOCKWISE,ca.CLOCKWISE=xn.CLOCKWISE,ca.NONE=xn.COLLINEAR;var Za=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"addNextSegment",value:function(m,b){if(this._s0=this._s1,this._s1=this._s2,this._s2=m,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var w=xn.index(this._s0,this._s1,this._s2),R=w===xn.CLOCKWISE&&this._side===nt.LEFT||w===xn.COUNTERCLOCKWISE&&this._side===nt.RIGHT;w===0?this.addCollinear(b):R?this.addOutsideTurn(w,b):this.addInsideTurn(w,b)}},{key:"addLineEndCap",value:function(m,b){var w=new ia(m,b),R=new ia;this.computeOffsetSegment(w,nt.LEFT,this._distance,R);var J=new ia;this.computeOffsetSegment(w,nt.RIGHT,this._distance,J);var ve=b.x-m.x,Ie=b.y-m.y,je=Math.atan2(Ie,ve);switch(this._bufParams.getEndCapStyle()){case Z.CAP_ROUND:this._segList.addPt(R.p1),this.addDirectedFillet(b,je+Math.PI/2,je-Math.PI/2,xn.CLOCKWISE,this._distance),this._segList.addPt(J.p1);break;case Z.CAP_FLAT:this._segList.addPt(R.p1),this._segList.addPt(J.p1);break;case Z.CAP_SQUARE:var lt=new ot;lt.x=Math.abs(this._distance)*Math.cos(je),lt.y=Math.abs(this._distance)*Math.sin(je);var Ft=new ot(R.p1.x+lt.x,R.p1.y+lt.y),Kt=new ot(J.p1.x+lt.x,J.p1.y+lt.y);this._segList.addPt(Ft),this._segList.addPt(Kt)}}},{key:"getCoordinates",value:function(){return this._segList.getCoordinates()}},{key:"addMitreJoin",value:function(m,b,w,R){var J=yo.intersection(b.p0,b.p1,w.p0,w.p1);if(J!==null&&(R<=0?1:J.distance(m)/Math.abs(R))<=this._bufParams.getMitreLimit())return this._segList.addPt(J),null;this.addLimitedMitreJoin(b,w,R,this._bufParams.getMitreLimit())}},{key:"addOutsideTurn",value:function(m,b){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*U.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===Z.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===Z.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(b&&this._segList.addPt(this._offset0.p1),this.addCornerFillet(this._s1,this._offset0.p1,this._offset1.p0,m,this._distance),this._segList.addPt(this._offset1.p0))}},{key:"createSquare",value:function(m){this._segList.addPt(new ot(m.x+this._distance,m.y+this._distance)),this._segList.addPt(new ot(m.x+this._distance,m.y-this._distance)),this._segList.addPt(new ot(m.x-this._distance,m.y-this._distance)),this._segList.addPt(new ot(m.x-this._distance,m.y+this._distance)),this._segList.closeRing()}},{key:"addSegments",value:function(m,b){this._segList.addPts(m,b)}},{key:"addFirstSegment",value:function(){this._segList.addPt(this._offset1.p0)}},{key:"addCornerFillet",value:function(m,b,w,R,J){var ve=b.x-m.x,Ie=b.y-m.y,je=Math.atan2(Ie,ve),lt=w.x-m.x,Ft=w.y-m.y,Kt=Math.atan2(Ft,lt);R===xn.CLOCKWISE?je<=Kt&&(je+=2*Math.PI):je>=Kt&&(je-=2*Math.PI),this._segList.addPt(b),this.addDirectedFillet(m,je,Kt,R,J),this._segList.addPt(w)}},{key:"addLastSegment",value:function(){this._segList.addPt(this._offset1.p1)}},{key:"initSideSegments",value:function(m,b,w){this._s1=m,this._s2=b,this._side=w,this._seg1.setCoordinates(m,b),this.computeOffsetSegment(this._seg1,w,this._distance,this._offset1)}},{key:"addLimitedMitreJoin",value:function(m,b,w,R){var J=this._seg0.p1,ve=ca.angle(J,this._seg0.p0),Ie=ca.angleBetweenOriented(this._seg0.p0,J,this._seg1.p1)/2,je=ca.normalize(ve+Ie),lt=ca.normalize(je+Math.PI),Ft=R*w,Kt=w-Ft*Math.abs(Math.sin(Ie)),En=J.x+Ft*Math.cos(lt),or=J.y+Ft*Math.sin(lt),er=new ot(En,or),Nr=new ia(J,er),Bn=Nr.pointAlongOffset(1,Kt),wr=Nr.pointAlongOffset(1,-Kt);this._side===nt.LEFT?(this._segList.addPt(Bn),this._segList.addPt(wr)):(this._segList.addPt(wr),this._segList.addPt(Bn))}},{key:"addDirectedFillet",value:function(m,b,w,R,J){var ve=R===xn.CLOCKWISE?-1:1,Ie=Math.abs(b-w),je=Math.trunc(Ie/this._filletAngleQuantum+.5);if(je<1)return null;for(var lt=Ie/je,Ft=new ot,Kt=0;Kt<je;Kt++){var En=b+ve*Kt*lt;Ft.x=m.x+J*Math.cos(En),Ft.y=m.y+J*Math.sin(En),this._segList.addPt(Ft)}}},{key:"computeOffsetSegment",value:function(m,b,w,R){var J=b===nt.LEFT?1:-1,ve=m.p1.x-m.p0.x,Ie=m.p1.y-m.p0.y,je=Math.sqrt(ve*ve+Ie*Ie),lt=J*w*ve/je,Ft=J*w*Ie/je;R.p0.x=m.p0.x-Ft,R.p0.y=m.p0.y+lt,R.p1.x=m.p1.x-Ft,R.p1.y=m.p1.y+lt}},{key:"addInsideTurn",value:function(m,b){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*U.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var w=new ot((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(w);var R=new ot((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(R)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}}},{key:"createCircle",value:function(m){var b=new ot(m.x+this._distance,m.y);this._segList.addPt(b),this.addDirectedFillet(m,0,2*Math.PI,-1,this._distance),this._segList.closeRing()}},{key:"addBevelJoin",value:function(m,b){this._segList.addPt(m.p1),this._segList.addPt(b.p0)}},{key:"init",value:function(m){this._distance=m,this._maxCurveSegmentError=m*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new $l,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(m*U.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)}},{key:"addCollinear",value:function(m){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),this._li.getIntersectionNum()>=2&&(this._bufParams.getJoinStyle()===Z.JOIN_BEVEL||this._bufParams.getJoinStyle()===Z.JOIN_MITRE?(m&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addCornerFillet(this._s1,this._offset0.p1,this._offset1.p0,xn.CLOCKWISE,this._distance))}},{key:"closeRing",value:function(){this._segList.closeRing()}},{key:"hasNarrowConcaveAngle",value:function(){return this._hasNarrowConcaveAngle}}],[{key:"constructor_",value:function(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new ia,this._seg1=new ia,this._offset0=new ia,this._offset1=new ia,this._side=0,this._hasNarrowConcaveAngle=!1;var m=arguments[0],b=arguments[1],w=arguments[2];this._precisionModel=m,this._bufParams=b,this._li=new hr,this._filletAngleQuantum=Math.PI/2/b.getQuadrantSegments(),b.getQuadrantSegments()>=8&&b.getJoinStyle()===Z.JOIN_ROUND&&(this._closingSegLengthFactor=U.MAX_CLOSING_SEG_LEN_FACTOR),this.init(w)}}]),U}();Za.OFFSET_SEGMENT_SEPARATION_FACTOR=.001,Za.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR=.001,Za.CURVE_VERTEX_SNAP_DISTANCE_FACTOR=1e-6,Za.MAX_CLOSING_SEG_LEN_FACTOR=80;var Xh=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"getOffsetCurve",value:function(m,b){if(this._distance=b,b===0)return null;var w=b<0,R=Math.abs(b),J=this.getSegGen(R);m.length<=1?this.computePointCurve(m[0],J):this.computeOffsetCurve(m,w,J);var ve=J.getCoordinates();return w&&Or.reverse(ve),ve}},{key:"computeSingleSidedBufferCurve",value:function(m,b,w){var R=this.simplifyTolerance(this._distance);if(b){w.addSegments(m,!0);var J=qs.simplify(m,-R),ve=J.length-1;w.initSideSegments(J[ve],J[ve-1],nt.LEFT),w.addFirstSegment();for(var Ie=ve-2;Ie>=0;Ie--)w.addNextSegment(J[Ie],!0)}else{w.addSegments(m,!1);var je=qs.simplify(m,R),lt=je.length-1;w.initSideSegments(je[0],je[1],nt.LEFT),w.addFirstSegment();for(var Ft=2;Ft<=lt;Ft++)w.addNextSegment(je[Ft],!0)}w.addLastSegment(),w.closeRing()}},{key:"computeRingBufferCurve",value:function(m,b,w){var R=this.simplifyTolerance(this._distance);b===nt.RIGHT&&(R=-R);var J=qs.simplify(m,R),ve=J.length-1;w.initSideSegments(J[ve-1],J[0],b);for(var Ie=1;Ie<=ve;Ie++){var je=Ie!==1;w.addNextSegment(J[Ie],je)}w.closeRing()}},{key:"computeLineBufferCurve",value:function(m,b){var w=this.simplifyTolerance(this._distance),R=qs.simplify(m,w),J=R.length-1;b.initSideSegments(R[0],R[1],nt.LEFT);for(var ve=2;ve<=J;ve++)b.addNextSegment(R[ve],!0);b.addLastSegment(),b.addLineEndCap(R[J-1],R[J]);var Ie=qs.simplify(m,-w),je=Ie.length-1;b.initSideSegments(Ie[je],Ie[je-1],nt.LEFT);for(var lt=je-2;lt>=0;lt--)b.addNextSegment(Ie[lt],!0);b.addLastSegment(),b.addLineEndCap(Ie[1],Ie[0]),b.closeRing()}},{key:"computePointCurve",value:function(m,b){switch(this._bufParams.getEndCapStyle()){case Z.CAP_ROUND:b.createCircle(m);break;case Z.CAP_SQUARE:b.createSquare(m)}}},{key:"getLineCurve",value:function(m,b){if(this._distance=b,this.isLineOffsetEmpty(b))return null;var w=Math.abs(b),R=this.getSegGen(w);if(m.length<=1)this.computePointCurve(m[0],R);else if(this._bufParams.isSingleSided()){var J=b<0;this.computeSingleSidedBufferCurve(m,J,R)}else this.computeLineBufferCurve(m,R);return R.getCoordinates()}},{key:"getBufferParameters",value:function(){return this._bufParams}},{key:"simplifyTolerance",value:function(m){return m*this._bufParams.getSimplifyFactor()}},{key:"getRingCurve",value:function(m,b,w){if(this._distance=w,m.length<=2)return this.getLineCurve(m,w);if(w===0)return U.copyCoordinates(m);var R=this.getSegGen(w);return this.computeRingBufferCurve(m,b,R),R.getCoordinates()}},{key:"computeOffsetCurve",value:function(m,b,w){var R=this.simplifyTolerance(this._distance);if(b){var J=qs.simplify(m,-R),ve=J.length-1;w.initSideSegments(J[ve],J[ve-1],nt.LEFT),w.addFirstSegment();for(var Ie=ve-2;Ie>=0;Ie--)w.addNextSegment(J[Ie],!0)}else{var je=qs.simplify(m,R),lt=je.length-1;w.initSideSegments(je[0],je[1],nt.LEFT),w.addFirstSegment();for(var Ft=2;Ft<=lt;Ft++)w.addNextSegment(je[Ft],!0)}w.addLastSegment()}},{key:"isLineOffsetEmpty",value:function(m){return m===0||m<0&&!this._bufParams.isSingleSided()}},{key:"getSegGen",value:function(m){return new Za(this._precisionModel,this._bufParams,m)}}],[{key:"constructor_",value:function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var m=arguments[0],b=arguments[1];this._precisionModel=m,this._bufParams=b}},{key:"copyCoordinates",value:function(m){for(var b=new Array(m.length).fill(null),w=0;w<b.length;w++)b[w]=new ot(m[w]);return b}}]),U}(),Fu=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"findStabbedSegments",value:function(){if(arguments.length===1){for(var m=arguments[0],b=new Mn,w=this._subgraphs.iterator();w.hasNext();){var R=w.next(),J=R.getEnvelope();m.y<J.getMinY()||m.y>J.getMaxY()||this.findStabbedSegments(m,R.getDirectedEdges(),b)}return b}if(arguments.length===3){if(Jt(arguments[2],qt)&&arguments[0]instanceof ot&&arguments[1]instanceof qa)for(var ve=arguments[0],Ie=arguments[1],je=arguments[2],lt=Ie.getEdge().getCoordinates(),Ft=0;Ft<lt.length-1;Ft++){this._seg.p0=lt[Ft],this._seg.p1=lt[Ft+1],this._seg.p0.y>this._seg.p1.y&&this._seg.reverse();var Kt=Math.max(this._seg.p0.x,this._seg.p1.x);if(!(Kt<ve.x)&&!(this._seg.isHorizontal()||ve.y<this._seg.p0.y||ve.y>this._seg.p1.y||xn.index(this._seg.p0,this._seg.p1,ve)===xn.RIGHT)){var En=Ie.getDepth(nt.LEFT);this._seg.p0.equals(lt[Ft])||(En=Ie.getDepth(nt.RIGHT));var or=new Ds(this._seg,En);je.add(or)}}else if(Jt(arguments[2],qt)&&arguments[0]instanceof ot&&Jt(arguments[1],qt))for(var er=arguments[0],Nr=arguments[1],Bn=arguments[2],wr=Nr.iterator();wr.hasNext();){var Pi=wr.next();Pi.isForward()&&this.findStabbedSegments(er,Pi,Bn)}}}},{key:"getDepth",value:function(m){var b=this.findStabbedSegments(m);return b.size()===0?0:Yo.min(b)._leftDepth}}],[{key:"constructor_",value:function(){this._subgraphs=null,this._seg=new ia;var m=arguments[0];this._subgraphs=m}}]),U}(),Ds=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"compareTo",value:function(m){var b=m;if(this._upwardSeg.minX()>=b._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=b._upwardSeg.minX())return-1;var w=this._upwardSeg.orientationIndex(b._upwardSeg);return w!==0||(w=-1*b._upwardSeg.orientationIndex(this._upwardSeg))!==0?w:this._upwardSeg.compareTo(b._upwardSeg)}},{key:"compareX",value:function(m,b){var w=m.p0.compareTo(b.p0);return w!==0?w:m.p1.compareTo(b.p1)}},{key:"toString",value:function(){return this._upwardSeg.toString()}},{key:"interfaces_",get:function(){return[ye]}}],[{key:"constructor_",value:function(){this._upwardSeg=null,this._leftDepth=null;var m=arguments[0],b=arguments[1];this._upwardSeg=new ia(m),this._leftDepth=b}}]),U}();Fu.DepthSegment=Ds;var Hr=function(U){u(b,U);var m=D(b);function b(){var w;return n(this,b),w=m.call(this),b.constructor_.apply(I(w),arguments),w}return a(b,null,[{key:"constructor_",value:function(){re.constructor_.call(this,"Projective point not representable on the Cartesian plane.")}}]),b}(re),cr=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"getY",value:function(){var m=this.y/this.w;if(Oe.isNaN(m)||Oe.isInfinite(m))throw new Hr;return m}},{key:"getX",value:function(){var m=this.x/this.w;if(Oe.isNaN(m)||Oe.isInfinite(m))throw new Hr;return m}},{key:"getCoordinate",value:function(){var m=new ot;return m.x=this.getX(),m.y=this.getY(),m}}],[{key:"constructor_",value:function(){if(this.x=null,this.y=null,this.w=null,arguments.length===0)this.x=0,this.y=0,this.w=1;else if(arguments.length===1){var m=arguments[0];this.x=m.x,this.y=m.y,this.w=1}else if(arguments.length===2){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var b=arguments[0],w=arguments[1];this.x=b,this.y=w,this.w=1}else if(arguments[0]instanceof U&&arguments[1]instanceof U){var R=arguments[0],J=arguments[1];this.x=R.y*J.w-J.y*R.w,this.y=J.x*R.w-R.x*J.w,this.w=R.x*J.y-J.x*R.y}else if(arguments[0]instanceof ot&&arguments[1]instanceof ot){var ve=arguments[0],Ie=arguments[1];this.x=ve.y-Ie.y,this.y=Ie.x-ve.x,this.w=ve.x*Ie.y-Ie.x*ve.y}}else if(arguments.length===3){var je=arguments[0],lt=arguments[1],Ft=arguments[2];this.x=je,this.y=lt,this.w=Ft}else if(arguments.length===4){var Kt=arguments[0],En=arguments[1],or=arguments[2],er=arguments[3],Nr=Kt.y-En.y,Bn=En.x-Kt.x,wr=Kt.x*En.y-En.x*Kt.y,Pi=or.y-er.y,Vi=er.x-or.x,Ko=or.x*er.y-er.x*or.y;this.x=Bn*Ko-Vi*wr,this.y=Pi*wr-Nr*Ko,this.w=Nr*Vi-Pi*Bn}}}]),U}(),xl=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"area",value:function(){return U.area(this.p0,this.p1,this.p2)}},{key:"signedArea",value:function(){return U.signedArea(this.p0,this.p1,this.p2)}},{key:"interpolateZ",value:function(m){if(m===null)throw new le("Supplied point is null.");return U.interpolateZ(m,this.p0,this.p1,this.p2)}},{key:"longestSideLength",value:function(){return U.longestSideLength(this.p0,this.p1,this.p2)}},{key:"isAcute",value:function(){return U.isAcute(this.p0,this.p1,this.p2)}},{key:"circumcentre",value:function(){return U.circumcentre(this.p0,this.p1,this.p2)}},{key:"area3D",value:function(){return U.area3D(this.p0,this.p1,this.p2)}},{key:"centroid",value:function(){return U.centroid(this.p0,this.p1,this.p2)}},{key:"inCentre",value:function(){return U.inCentre(this.p0,this.p1,this.p2)}}],[{key:"constructor_",value:function(){this.p0=null,this.p1=null,this.p2=null;var m=arguments[0],b=arguments[1],w=arguments[2];this.p0=m,this.p1=b,this.p2=w}},{key:"area",value:function(m,b,w){return Math.abs(((w.x-m.x)*(b.y-m.y)-(b.x-m.x)*(w.y-m.y))/2)}},{key:"signedArea",value:function(m,b,w){return((w.x-m.x)*(b.y-m.y)-(b.x-m.x)*(w.y-m.y))/2}},{key:"det",value:function(m,b,w,R){return m*R-b*w}},{key:"interpolateZ",value:function(m,b,w,R){var J=b.x,ve=b.y,Ie=w.x-J,je=R.x-J,lt=w.y-ve,Ft=R.y-ve,Kt=Ie*Ft-je*lt,En=m.x-J,or=m.y-ve,er=(Ft*En-je*or)/Kt,Nr=(-lt*En+Ie*or)/Kt;return b.getZ()+er*(w.getZ()-b.getZ())+Nr*(R.getZ()-b.getZ())}},{key:"longestSideLength",value:function(m,b,w){var R=m.distance(b),J=b.distance(w),ve=w.distance(m),Ie=R;return J>Ie&&(Ie=J),ve>Ie&&(Ie=ve),Ie}},{key:"circumcentreDD",value:function(m,b,w){var R=bn.valueOf(m.x).subtract(w.x),J=bn.valueOf(m.y).subtract(w.y),ve=bn.valueOf(b.x).subtract(w.x),Ie=bn.valueOf(b.y).subtract(w.y),je=bn.determinant(R,J,ve,Ie).multiply(2),lt=R.sqr().add(J.sqr()),Ft=ve.sqr().add(Ie.sqr()),Kt=bn.determinant(J,lt,Ie,Ft),En=bn.determinant(R,lt,ve,Ft),or=bn.valueOf(w.x).subtract(Kt.divide(je)).doubleValue(),er=bn.valueOf(w.y).add(En.divide(je)).doubleValue();return new ot(or,er)}},{key:"isAcute",value:function(m,b,w){return!!ca.isAcute(m,b,w)&&!!ca.isAcute(b,w,m)&&!!ca.isAcute(w,m,b)}},{key:"circumcentre",value:function(m,b,w){var R=w.x,J=w.y,ve=m.x-R,Ie=m.y-J,je=b.x-R,lt=b.y-J,Ft=2*U.det(ve,Ie,je,lt),Kt=U.det(Ie,ve*ve+Ie*Ie,lt,je*je+lt*lt),En=U.det(ve,ve*ve+Ie*Ie,je,je*je+lt*lt);return new ot(R-Kt/Ft,J+En/Ft)}},{key:"perpendicularBisector",value:function(m,b){var w=b.x-m.x,R=b.y-m.y,J=new cr(m.x+w/2,m.y+R/2,1),ve=new cr(m.x-R+w/2,m.y+w+R/2,1);return new cr(J,ve)}},{key:"angleBisector",value:function(m,b,w){var R=b.distance(m),J=R/(R+b.distance(w)),ve=w.x-m.x,Ie=w.y-m.y;return new ot(m.x+J*ve,m.y+J*Ie)}},{key:"area3D",value:function(m,b,w){var R=b.x-m.x,J=b.y-m.y,ve=b.getZ()-m.getZ(),Ie=w.x-m.x,je=w.y-m.y,lt=w.getZ()-m.getZ(),Ft=J*lt-ve*je,Kt=ve*Ie-R*lt,En=R*je-J*Ie,or=Ft*Ft+Kt*Kt+En*En,er=Math.sqrt(or)/2;return er}},{key:"centroid",value:function(m,b,w){var R=(m.x+b.x+w.x)/3,J=(m.y+b.y+w.y)/3;return new ot(R,J)}},{key:"inCentre",value:function(m,b,w){var R=b.distance(w),J=m.distance(w),ve=m.distance(b),Ie=R+J+ve,je=(R*m.x+J*b.x+ve*w.x)/Ie,lt=(R*m.y+J*b.y+ve*w.y)/Ie;return new ot(je,lt)}}]),U}(),Dr=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"addRingSide",value:function(m,b,w,R,J){if(b===0&&m.length<zt.MINIMUM_VALID_SIZE)return null;var ve=R,Ie=J;m.length>=zt.MINIMUM_VALID_SIZE&&xn.isCCW(m)&&(ve=J,Ie=R,w=nt.opposite(w));var je=this._curveBuilder.getRingCurve(m,w,b);this.addCurve(je,ve,Ie)}},{key:"addRingBothSides",value:function(m,b){this.addRingSide(m,b,nt.LEFT,We.EXTERIOR,We.INTERIOR),this.addRingSide(m,b,nt.RIGHT,We.INTERIOR,We.EXTERIOR)}},{key:"addPoint",value:function(m){if(this._distance<=0)return null;var b=m.getCoordinates(),w=this._curveBuilder.getLineCurve(b,this._distance);this.addCurve(w,We.EXTERIOR,We.INTERIOR)}},{key:"addPolygon",value:function(m){var b=this._distance,w=nt.LEFT;this._distance<0&&(b=-this._distance,w=nt.RIGHT);var R=m.getExteriorRing(),J=Or.removeRepeatedPoints(R.getCoordinates());if(this._distance<0&&this.isErodedCompletely(R,this._distance)||this._distance<=0&&J.length<3)return null;this.addRingSide(J,b,w,We.EXTERIOR,We.INTERIOR);for(var ve=0;ve<m.getNumInteriorRing();ve++){var Ie=m.getInteriorRingN(ve),je=Or.removeRepeatedPoints(Ie.getCoordinates());this._distance>0&&this.isErodedCompletely(Ie,-this._distance)||this.addRingSide(je,b,nt.opposite(w),We.INTERIOR,We.EXTERIOR)}}},{key:"isTriangleErodedCompletely",value:function(m,b){var w=new xl(m[0],m[1],m[2]),R=w.inCentre();return Li.pointToSegment(R,w.p0,w.p1)<Math.abs(b)}},{key:"addLineString",value:function(m){if(this._curveBuilder.isLineOffsetEmpty(this._distance))return null;var b=Or.removeRepeatedPoints(m.getCoordinates());if(Or.isRing(b)&&!this._curveBuilder.getBufferParameters().isSingleSided())this.addRingBothSides(b,this._distance);else{var w=this._curveBuilder.getLineCurve(b,this._distance);this.addCurve(w,We.EXTERIOR,We.INTERIOR)}}},{key:"addCurve",value:function(m,b,w){if(m===null||m.length<2)return null;var R=new jl(m,new Kr(0,We.BOUNDARY,b,w));this._curveList.add(R)}},{key:"getCurves",value:function(){return this.add(this._inputGeom),this._curveList}},{key:"add",value:function(m){if(m.isEmpty())return null;if(m instanceof At)this.addPolygon(m);else if(m instanceof Ve)this.addLineString(m);else if(m instanceof _t)this.addPoint(m);else if(m instanceof Nt)this.addCollection(m);else if(m instanceof ns)this.addCollection(m);else if(m instanceof yi)this.addCollection(m);else{if(!(m instanceof fn))throw new st(m.getGeometryType());this.addCollection(m)}}},{key:"isErodedCompletely",value:function(m,b){var w=m.getCoordinates();if(w.length<4)return b<0;if(w.length===4)return this.isTriangleErodedCompletely(w,b);var R=m.getEnvelopeInternal(),J=Math.min(R.getHeight(),R.getWidth());return b<0&&2*Math.abs(b)>J}},{key:"addCollection",value:function(m){for(var b=0;b<m.getNumGeometries();b++){var w=m.getGeometryN(b);this.add(w)}}}],[{key:"constructor_",value:function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new Mn;var m=arguments[0],b=arguments[1],w=arguments[2];this._inputGeom=m,this._distance=b,this._curveBuilder=w}}]),U}(),Ka=function(){function U(){n(this,U)}return a(U,[{key:"locate",value:function(m){}}]),U}(),Tc=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"next",value:function(){if(this._atStart)return this._atStart=!1,U.isAtomic(this._parent)&&this._index++,this._parent;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new Ae;var m=this._parent.getGeometryN(this._index++);return m instanceof fn?(this._subcollectionIterator=new U(m),this._subcollectionIterator.next()):m}},{key:"remove",value:function(){throw new st(this.getClass().getName())}},{key:"hasNext",value:function(){if(this._atStart)return!0;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)}},{key:"interfaces_",get:function(){return[_l]}}],[{key:"constructor_",value:function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var m=arguments[0];this._parent=m,this._atStart=!0,this._index=0,this._max=m.getNumGeometries()}},{key:"isAtomic",value:function(m){return!(m instanceof fn)}}]),U}(),Mr=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"locate",value:function(m){return U.locate(m,this._geom)}},{key:"interfaces_",get:function(){return[Ka]}}],[{key:"constructor_",value:function(){this._geom=null;var m=arguments[0];this._geom=m}},{key:"locatePointInPolygon",value:function(m,b){if(b.isEmpty())return We.EXTERIOR;var w=b.getExteriorRing(),R=U.locatePointInRing(m,w);if(R!==We.INTERIOR)return R;for(var J=0;J<b.getNumInteriorRing();J++){var ve=b.getInteriorRingN(J),Ie=U.locatePointInRing(m,ve);if(Ie===We.BOUNDARY)return We.BOUNDARY;if(Ie===We.INTERIOR)return We.EXTERIOR}return We.INTERIOR}},{key:"locatePointInRing",value:function(m,b){return b.getEnvelopeInternal().intersects(m)?ii.locateInRing(m,b.getCoordinates()):We.EXTERIOR}},{key:"containsPointInPolygon",value:function(m,b){return We.EXTERIOR!==U.locatePointInPolygon(m,b)}},{key:"locateInGeometry",value:function(m,b){if(b instanceof At)return U.locatePointInPolygon(m,b);if(b instanceof fn)for(var w=new Tc(b);w.hasNext();){var R=w.next();if(R!==b){var J=U.locateInGeometry(m,R);if(J!==We.EXTERIOR)return J}}return We.EXTERIOR}},{key:"isContained",value:function(m,b){return We.EXTERIOR!==U.locate(m,b)}},{key:"locate",value:function(m,b){return b.isEmpty()?We.EXTERIOR:b.getEnvelopeInternal().intersects(m)?U.locateInGeometry(m,b):We.EXTERIOR}}]),U}(),cu=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"getNextCW",value:function(m){this.getEdges();var b=this._edgeList.indexOf(m),w=b-1;return b===0&&(w=this._edgeList.size()-1),this._edgeList.get(w)}},{key:"propagateSideLabels",value:function(m){for(var b=We.NONE,w=this.iterator();w.hasNext();){var R=w.next().getLabel();R.isArea(m)&&R.getLocation(m,nt.LEFT)!==We.NONE&&(b=R.getLocation(m,nt.LEFT))}if(b===We.NONE)return null;for(var J=b,ve=this.iterator();ve.hasNext();){var Ie=ve.next(),je=Ie.getLabel();if(je.getLocation(m,nt.ON)===We.NONE&&je.setLocation(m,nt.ON,J),je.isArea(m)){var lt=je.getLocation(m,nt.LEFT),Ft=je.getLocation(m,nt.RIGHT);if(Ft!==We.NONE){if(Ft!==J)throw new Rr("side location conflict",Ie.getCoordinate());lt===We.NONE&&Ue.shouldNeverReachHere("found single null side (at "+Ie.getCoordinate()+")"),J=lt}else Ue.isTrue(je.getLocation(m,nt.LEFT)===We.NONE,"found single null side"),je.setLocation(m,nt.RIGHT,J),je.setLocation(m,nt.LEFT,J)}}}},{key:"getCoordinate",value:function(){var m=this.iterator();return m.hasNext()?m.next().getCoordinate():null}},{key:"print",value:function(m){vr.out.println("EdgeEndStar:   "+this.getCoordinate());for(var b=this.iterator();b.hasNext();)b.next().print(m)}},{key:"isAreaLabelsConsistent",value:function(m){return this.computeEdgeEndLabels(m.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)}},{key:"checkAreaLabelsConsistent",value:function(m){var b=this.getEdges();if(b.size()<=0)return!0;var w=b.size()-1,R=b.get(w).getLabel().getLocation(m,nt.LEFT);Ue.isTrue(R!==We.NONE,"Found unlabelled area edge");for(var J=R,ve=this.iterator();ve.hasNext();){var Ie=ve.next().getLabel();Ue.isTrue(Ie.isArea(m),"Found non-area edge");var je=Ie.getLocation(m,nt.LEFT),lt=Ie.getLocation(m,nt.RIGHT);if(je===lt||lt!==J)return!1;J=je}return!0}},{key:"findIndex",value:function(m){this.iterator();for(var b=0;b<this._edgeList.size();b++)if(this._edgeList.get(b)===m)return b;return-1}},{key:"iterator",value:function(){return this.getEdges().iterator()}},{key:"getEdges",value:function(){return this._edgeList===null&&(this._edgeList=new Mn(this._edgeMap.values())),this._edgeList}},{key:"getLocation",value:function(m,b,w){return this._ptInAreaLocation[m]===We.NONE&&(this._ptInAreaLocation[m]=Mr.locate(b,w[m].getGeometry())),this._ptInAreaLocation[m]}},{key:"toString",value:function(){var m=new Wt;m.append("EdgeEndStar:   "+this.getCoordinate()),m.append(`
`);for(var b=this.iterator();b.hasNext();){var w=b.next();m.append(w),m.append(`
`)}return m.toString()}},{key:"computeEdgeEndLabels",value:function(m){for(var b=this.iterator();b.hasNext();)b.next().computeLabel(m)}},{key:"computeLabelling",value:function(m){this.computeEdgeEndLabels(m[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var b=[!1,!1],w=this.iterator();w.hasNext();)for(var R=w.next().getLabel(),J=0;J<2;J++)R.isLine(J)&&R.getLocation(J)===We.BOUNDARY&&(b[J]=!0);for(var ve=this.iterator();ve.hasNext();)for(var Ie=ve.next(),je=Ie.getLabel(),lt=0;lt<2;lt++)if(je.isAnyNull(lt)){var Ft=We.NONE;if(b[lt])Ft=We.EXTERIOR;else{var Kt=Ie.getCoordinate();Ft=this.getLocation(lt,Kt,m)}je.setAllLocationsIfNull(lt,Ft)}}},{key:"getDegree",value:function(){return this._edgeMap.size()}},{key:"insertEdgeEnd",value:function(m,b){this._edgeMap.put(m,b),this._edgeList=null}}],[{key:"constructor_",value:function(){this._edgeMap=new oo,this._edgeList=null,this._ptInAreaLocation=[We.NONE,We.NONE]}}]),U}(),Ic=function(U){u(b,U);var m=D(b);function b(){var w;return n(this,b),w=m.call(this),b.constructor_.apply(I(w),arguments),w}return a(b,[{key:"linkResultDirectedEdges",value:function(){this.getResultAreaEdges();for(var w=null,R=null,J=this._SCANNING_FOR_INCOMING,ve=0;ve<this._resultAreaEdgeList.size();ve++){var Ie=this._resultAreaEdgeList.get(ve),je=Ie.getSym();if(Ie.getLabel().isArea())switch(w===null&&Ie.isInResult()&&(w=Ie),J){case this._SCANNING_FOR_INCOMING:if(!je.isInResult())continue;R=je,J=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!Ie.isInResult())continue;R.setNext(Ie),J=this._SCANNING_FOR_INCOMING}}if(J===this._LINKING_TO_OUTGOING){if(w===null)throw new Rr("no outgoing dirEdge found",this.getCoordinate());Ue.isTrue(w.isInResult(),"unable to link last incoming dirEdge"),R.setNext(w)}}},{key:"insert",value:function(w){var R=w;this.insertEdgeEnd(R,R)}},{key:"getRightmostEdge",value:function(){var w=this.getEdges(),R=w.size();if(R<1)return null;var J=w.get(0);if(R===1)return J;var ve=w.get(R-1),Ie=J.getQuadrant(),je=ve.getQuadrant();return us.isNorthern(Ie)&&us.isNorthern(je)?J:us.isNorthern(Ie)||us.isNorthern(je)?J.getDy()!==0?J:ve.getDy()!==0?ve:(Ue.shouldNeverReachHere("found two horizontal edges incident on node"),null):ve}},{key:"print",value:function(w){vr.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var R=this.iterator();R.hasNext();){var J=R.next();w.print("out "),J.print(w),w.println(),w.print("in "),J.getSym().print(w),w.println()}}},{key:"getResultAreaEdges",value:function(){if(this._resultAreaEdgeList!==null)return this._resultAreaEdgeList;this._resultAreaEdgeList=new Mn;for(var w=this.iterator();w.hasNext();){var R=w.next();(R.isInResult()||R.getSym().isInResult())&&this._resultAreaEdgeList.add(R)}return this._resultAreaEdgeList}},{key:"updateLabelling",value:function(w){for(var R=this.iterator();R.hasNext();){var J=R.next().getLabel();J.setAllLocationsIfNull(0,w.getLocation(0)),J.setAllLocationsIfNull(1,w.getLocation(1))}}},{key:"linkAllDirectedEdges",value:function(){this.getEdges();for(var w=null,R=null,J=this._edgeList.size()-1;J>=0;J--){var ve=this._edgeList.get(J),Ie=ve.getSym();R===null&&(R=Ie),w!==null&&Ie.setNext(w),w=ve}R.setNext(w)}},{key:"computeDepths",value:function(){if(arguments.length===1){var w=arguments[0],R=this.findIndex(w),J=w.getDepth(nt.LEFT),ve=w.getDepth(nt.RIGHT),Ie=this.computeDepths(R+1,this._edgeList.size(),J),je=this.computeDepths(0,R,Ie);if(je!==ve)throw new Rr("depth mismatch at "+w.getCoordinate())}else if(arguments.length===3){for(var lt=arguments[0],Ft=arguments[1],Kt=arguments[2],En=Kt,or=lt;or<Ft;or++){var er=this._edgeList.get(or);er.setEdgeDepths(nt.RIGHT,En),En=er.getDepth(nt.LEFT)}return En}}},{key:"mergeSymLabels",value:function(){for(var w=this.iterator();w.hasNext();){var R=w.next();R.getLabel().merge(R.getSym().getLabel())}}},{key:"linkMinimalDirectedEdges",value:function(w){for(var R=null,J=null,ve=this._SCANNING_FOR_INCOMING,Ie=this._resultAreaEdgeList.size()-1;Ie>=0;Ie--){var je=this._resultAreaEdgeList.get(Ie),lt=je.getSym();switch(R===null&&je.getEdgeRing()===w&&(R=je),ve){case this._SCANNING_FOR_INCOMING:if(lt.getEdgeRing()!==w)continue;J=lt,ve=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(je.getEdgeRing()!==w)continue;J.setNextMin(je),ve=this._SCANNING_FOR_INCOMING}}ve===this._LINKING_TO_OUTGOING&&(Ue.isTrue(R!==null,"found null for first outgoing dirEdge"),Ue.isTrue(R.getEdgeRing()===w,"unable to link last incoming dirEdge"),J.setNextMin(R))}},{key:"getOutgoingDegree",value:function(){if(arguments.length===0){for(var w=0,R=this.iterator();R.hasNext();){var J=R.next();J.isInResult()&&w++}return w}if(arguments.length===1){for(var ve=arguments[0],Ie=0,je=this.iterator();je.hasNext();){var lt=je.next();lt.getEdgeRing()===ve&&Ie++}return Ie}}},{key:"getLabel",value:function(){return this._label}},{key:"findCoveredLineEdges",value:function(){for(var w=We.NONE,R=this.iterator();R.hasNext();){var J=R.next(),ve=J.getSym();if(!J.isLineEdge()){if(J.isInResult()){w=We.INTERIOR;break}if(ve.isInResult()){w=We.EXTERIOR;break}}}if(w===We.NONE)return null;for(var Ie=w,je=this.iterator();je.hasNext();){var lt=je.next(),Ft=lt.getSym();lt.isLineEdge()?lt.getEdge().setCovered(Ie===We.INTERIOR):(lt.isInResult()&&(Ie=We.EXTERIOR),Ft.isInResult()&&(Ie=We.INTERIOR))}}},{key:"computeLabelling",value:function(w){N(f(b.prototype),"computeLabelling",this).call(this,w),this._label=new Kr(We.NONE);for(var R=this.iterator();R.hasNext();)for(var J=R.next().getEdge().getLabel(),ve=0;ve<2;ve++){var Ie=J.getLocation(ve);Ie!==We.INTERIOR&&Ie!==We.BOUNDARY||this._label.setLocation(ve,We.INTERIOR)}}}],[{key:"constructor_",value:function(){this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}}]),b}(cu),dd=function(U){u(b,U);var m=D(b);function b(){return n(this,b),m.call(this)}return a(b,[{key:"createNode",value:function(w){return new Qi(w,new Ic)}}]),b}(ws),bl=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"compareTo",value:function(m){var b=m;return U.compareOriented(this._pts,this._orientation,b._pts,b._orientation)}},{key:"interfaces_",get:function(){return[ye]}}],[{key:"constructor_",value:function(){this._pts=null,this._orientation=null;var m=arguments[0];this._pts=m,this._orientation=U.orientation(m)}},{key:"orientation",value:function(m){return Or.increasingDirection(m)===1}},{key:"compareOriented",value:function(m,b,w,R){for(var J=b?1:-1,ve=R?1:-1,Ie=b?m.length:-1,je=R?w.length:-1,lt=b?0:m.length-1,Ft=R?0:w.length-1;;){var Kt=m[lt].compareTo(w[Ft]);if(Kt!==0)return Kt;var En=(lt+=J)===Ie,or=(Ft+=ve)===je;if(En&&!or)return-1;if(!En&&or)return 1;if(En&&or)return 0}}}]),U}(),du=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"print",value:function(m){m.print("MULTILINESTRING ( ");for(var b=0;b<this._edges.size();b++){var w=this._edges.get(b);b>0&&m.print(","),m.print("(");for(var R=w.getCoordinates(),J=0;J<R.length;J++)J>0&&m.print(","),m.print(R[J].x+" "+R[J].y);m.println(")")}m.print(")  ")}},{key:"addAll",value:function(m){for(var b=m.iterator();b.hasNext();)this.add(b.next())}},{key:"findEdgeIndex",value:function(m){for(var b=0;b<this._edges.size();b++)if(this._edges.get(b).equals(m))return b;return-1}},{key:"iterator",value:function(){return this._edges.iterator()}},{key:"getEdges",value:function(){return this._edges}},{key:"get",value:function(m){return this._edges.get(m)}},{key:"findEqualEdge",value:function(m){var b=new bl(m.getCoordinates());return this._ocaMap.get(b)}},{key:"add",value:function(m){this._edges.add(m);var b=new bl(m.getCoordinates());this._ocaMap.put(b,m)}}],[{key:"constructor_",value:function(){this._edges=new Mn,this._ocaMap=new oo}}]),U}(),cs=function(){function U(){n(this,U)}return a(U,[{key:"processIntersections",value:function(m,b,w,R){}},{key:"isDone",value:function(){}}]),U}(),kc=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"isTrivialIntersection",value:function(m,b,w,R){if(m===w&&this._li.getIntersectionNum()===1){if(U.isAdjacentSegments(b,R))return!0;if(m.isClosed()){var J=m.size()-1;if(b===0&&R===J||R===0&&b===J)return!0}}return!1}},{key:"getProperIntersectionPoint",value:function(){return this._properIntersectionPoint}},{key:"hasProperInteriorIntersection",value:function(){return this._hasProperInterior}},{key:"getLineIntersector",value:function(){return this._li}},{key:"hasProperIntersection",value:function(){return this._hasProper}},{key:"processIntersections",value:function(m,b,w,R){if(m===w&&b===R)return null;this.numTests++;var J=m.getCoordinates()[b],ve=m.getCoordinates()[b+1],Ie=w.getCoordinates()[R],je=w.getCoordinates()[R+1];this._li.computeIntersection(J,ve,Ie,je),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(m,b,w,R)||(this._hasIntersection=!0,m.addIntersections(this._li,b,0),w.addIntersections(this._li,R,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))}},{key:"hasIntersection",value:function(){return this._hasIntersection}},{key:"isDone",value:function(){return!1}},{key:"hasInteriorIntersection",value:function(){return this._hasInterior}},{key:"interfaces_",get:function(){return[cs]}}],[{key:"constructor_",value:function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var m=arguments[0];this._li=m}},{key:"isAdjacentSegments",value:function(m,b){return Math.abs(m-b)===1}}]),U}(),wl=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"getSegmentIndex",value:function(){return this.segmentIndex}},{key:"getCoordinate",value:function(){return this.coord}},{key:"print",value:function(m){m.print(this.coord),m.print(" seg # = "+this.segmentIndex),m.println(" dist = "+this.dist)}},{key:"compareTo",value:function(m){var b=m;return this.compare(b.segmentIndex,b.dist)}},{key:"isEndPoint",value:function(m){return this.segmentIndex===0&&this.dist===0||this.segmentIndex===m}},{key:"toString",value:function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist}},{key:"getDistance",value:function(){return this.dist}},{key:"compare",value:function(m,b){return this.segmentIndex<m?-1:this.segmentIndex>m?1:this.dist<b?-1:this.dist>b?1:0}},{key:"interfaces_",get:function(){return[ye]}}],[{key:"constructor_",value:function(){this.coord=null,this.segmentIndex=null,this.dist=null;var m=arguments[0],b=arguments[1],w=arguments[2];this.coord=new ot(m),this.segmentIndex=b,this.dist=w}}]),U}(),Aa=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"print",value:function(m){m.println("Intersections:");for(var b=this.iterator();b.hasNext();)b.next().print(m)}},{key:"iterator",value:function(){return this._nodeMap.values().iterator()}},{key:"addSplitEdges",value:function(m){this.addEndpoints();for(var b=this.iterator(),w=b.next();b.hasNext();){var R=b.next(),J=this.createSplitEdge(w,R);m.add(J),w=R}}},{key:"addEndpoints",value:function(){var m=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[m],m,0)}},{key:"createSplitEdge",value:function(m,b){var w=b.segmentIndex-m.segmentIndex+2,R=this.edge.pts[b.segmentIndex],J=b.dist>0||!b.coord.equals2D(R);J||w--;var ve=new Array(w).fill(null),Ie=0;ve[Ie++]=new ot(m.coord);for(var je=m.segmentIndex+1;je<=b.segmentIndex;je++)ve[Ie++]=this.edge.pts[je];return J&&(ve[Ie]=b.coord),new nh(ve,new Kr(this.edge._label))}},{key:"add",value:function(m,b,w){var R=new wl(m,b,w),J=this._nodeMap.get(R);return J!==null?J:(this._nodeMap.put(R,R),R)}},{key:"isIntersection",value:function(m){for(var b=this.iterator();b.hasNext();)if(b.next().coord.equals(m))return!0;return!1}}],[{key:"constructor_",value:function(){this._nodeMap=new oo,this.edge=null;var m=arguments[0];this.edge=m}}]),U}(),hd=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"isIntersects",value:function(){return!this.isDisjoint()}},{key:"isCovers",value:function(){return(U.isTrue(this._matrix[We.INTERIOR][We.INTERIOR])||U.isTrue(this._matrix[We.INTERIOR][We.BOUNDARY])||U.isTrue(this._matrix[We.BOUNDARY][We.INTERIOR])||U.isTrue(this._matrix[We.BOUNDARY][We.BOUNDARY]))&&this._matrix[We.EXTERIOR][We.INTERIOR]===Pn.FALSE&&this._matrix[We.EXTERIOR][We.BOUNDARY]===Pn.FALSE}},{key:"isCoveredBy",value:function(){return(U.isTrue(this._matrix[We.INTERIOR][We.INTERIOR])||U.isTrue(this._matrix[We.INTERIOR][We.BOUNDARY])||U.isTrue(this._matrix[We.BOUNDARY][We.INTERIOR])||U.isTrue(this._matrix[We.BOUNDARY][We.BOUNDARY]))&&this._matrix[We.INTERIOR][We.EXTERIOR]===Pn.FALSE&&this._matrix[We.BOUNDARY][We.EXTERIOR]===Pn.FALSE}},{key:"set",value:function(){if(arguments.length===1)for(var m=arguments[0],b=0;b<m.length;b++){var w=Math.trunc(b/3),R=b%3;this._matrix[w][R]=Pn.toDimensionValue(m.charAt(b))}else if(arguments.length===3){var J=arguments[0],ve=arguments[1],Ie=arguments[2];this._matrix[J][ve]=Ie}}},{key:"isContains",value:function(){return U.isTrue(this._matrix[We.INTERIOR][We.INTERIOR])&&this._matrix[We.EXTERIOR][We.INTERIOR]===Pn.FALSE&&this._matrix[We.EXTERIOR][We.BOUNDARY]===Pn.FALSE}},{key:"setAtLeast",value:function(){if(arguments.length===1)for(var m=arguments[0],b=0;b<m.length;b++){var w=Math.trunc(b/3),R=b%3;this.setAtLeast(w,R,Pn.toDimensionValue(m.charAt(b)))}else if(arguments.length===3){var J=arguments[0],ve=arguments[1],Ie=arguments[2];this._matrix[J][ve]<Ie&&(this._matrix[J][ve]=Ie)}}},{key:"setAtLeastIfValid",value:function(m,b,w){m>=0&&b>=0&&this.setAtLeast(m,b,w)}},{key:"isWithin",value:function(){return U.isTrue(this._matrix[We.INTERIOR][We.INTERIOR])&&this._matrix[We.INTERIOR][We.EXTERIOR]===Pn.FALSE&&this._matrix[We.BOUNDARY][We.EXTERIOR]===Pn.FALSE}},{key:"isTouches",value:function(m,b){return m>b?this.isTouches(b,m):(m===Pn.A&&b===Pn.A||m===Pn.L&&b===Pn.L||m===Pn.L&&b===Pn.A||m===Pn.P&&b===Pn.A||m===Pn.P&&b===Pn.L)&&this._matrix[We.INTERIOR][We.INTERIOR]===Pn.FALSE&&(U.isTrue(this._matrix[We.INTERIOR][We.BOUNDARY])||U.isTrue(this._matrix[We.BOUNDARY][We.INTERIOR])||U.isTrue(this._matrix[We.BOUNDARY][We.BOUNDARY]))}},{key:"isOverlaps",value:function(m,b){return m===Pn.P&&b===Pn.P||m===Pn.A&&b===Pn.A?U.isTrue(this._matrix[We.INTERIOR][We.INTERIOR])&&U.isTrue(this._matrix[We.INTERIOR][We.EXTERIOR])&&U.isTrue(this._matrix[We.EXTERIOR][We.INTERIOR]):m===Pn.L&&b===Pn.L&&this._matrix[We.INTERIOR][We.INTERIOR]===1&&U.isTrue(this._matrix[We.INTERIOR][We.EXTERIOR])&&U.isTrue(this._matrix[We.EXTERIOR][We.INTERIOR])}},{key:"isEquals",value:function(m,b){return m===b&&U.isTrue(this._matrix[We.INTERIOR][We.INTERIOR])&&this._matrix[We.INTERIOR][We.EXTERIOR]===Pn.FALSE&&this._matrix[We.BOUNDARY][We.EXTERIOR]===Pn.FALSE&&this._matrix[We.EXTERIOR][We.INTERIOR]===Pn.FALSE&&this._matrix[We.EXTERIOR][We.BOUNDARY]===Pn.FALSE}},{key:"toString",value:function(){for(var m=new Mi("123456789"),b=0;b<3;b++)for(var w=0;w<3;w++)m.setCharAt(3*b+w,Pn.toDimensionSymbol(this._matrix[b][w]));return m.toString()}},{key:"setAll",value:function(m){for(var b=0;b<3;b++)for(var w=0;w<3;w++)this._matrix[b][w]=m}},{key:"get",value:function(m,b){return this._matrix[m][b]}},{key:"transpose",value:function(){var m=this._matrix[1][0];return this._matrix[1][0]=this._matrix[0][1],this._matrix[0][1]=m,m=this._matrix[2][0],this._matrix[2][0]=this._matrix[0][2],this._matrix[0][2]=m,m=this._matrix[2][1],this._matrix[2][1]=this._matrix[1][2],this._matrix[1][2]=m,this}},{key:"matches",value:function(m){if(m.length!==9)throw new le("Should be length 9: "+m);for(var b=0;b<3;b++)for(var w=0;w<3;w++)if(!U.matches(this._matrix[b][w],m.charAt(3*b+w)))return!1;return!0}},{key:"add",value:function(m){for(var b=0;b<3;b++)for(var w=0;w<3;w++)this.setAtLeast(b,w,m.get(b,w))}},{key:"isDisjoint",value:function(){return this._matrix[We.INTERIOR][We.INTERIOR]===Pn.FALSE&&this._matrix[We.INTERIOR][We.BOUNDARY]===Pn.FALSE&&this._matrix[We.BOUNDARY][We.INTERIOR]===Pn.FALSE&&this._matrix[We.BOUNDARY][We.BOUNDARY]===Pn.FALSE}},{key:"isCrosses",value:function(m,b){return m===Pn.P&&b===Pn.L||m===Pn.P&&b===Pn.A||m===Pn.L&&b===Pn.A?U.isTrue(this._matrix[We.INTERIOR][We.INTERIOR])&&U.isTrue(this._matrix[We.INTERIOR][We.EXTERIOR]):m===Pn.L&&b===Pn.P||m===Pn.A&&b===Pn.P||m===Pn.A&&b===Pn.L?U.isTrue(this._matrix[We.INTERIOR][We.INTERIOR])&&U.isTrue(this._matrix[We.EXTERIOR][We.INTERIOR]):m===Pn.L&&b===Pn.L&&this._matrix[We.INTERIOR][We.INTERIOR]===0}},{key:"interfaces_",get:function(){return[de]}}],[{key:"constructor_",value:function(){if(this._matrix=null,arguments.length===0)this._matrix=Array(3).fill().map(function(){return Array(3)}),this.setAll(Pn.FALSE);else if(arguments.length===1){if(typeof arguments[0]=="string"){var m=arguments[0];U.constructor_.call(this),this.set(m)}else if(arguments[0]instanceof U){var b=arguments[0];U.constructor_.call(this),this._matrix[We.INTERIOR][We.INTERIOR]=b._matrix[We.INTERIOR][We.INTERIOR],this._matrix[We.INTERIOR][We.BOUNDARY]=b._matrix[We.INTERIOR][We.BOUNDARY],this._matrix[We.INTERIOR][We.EXTERIOR]=b._matrix[We.INTERIOR][We.EXTERIOR],this._matrix[We.BOUNDARY][We.INTERIOR]=b._matrix[We.BOUNDARY][We.INTERIOR],this._matrix[We.BOUNDARY][We.BOUNDARY]=b._matrix[We.BOUNDARY][We.BOUNDARY],this._matrix[We.BOUNDARY][We.EXTERIOR]=b._matrix[We.BOUNDARY][We.EXTERIOR],this._matrix[We.EXTERIOR][We.INTERIOR]=b._matrix[We.EXTERIOR][We.INTERIOR],this._matrix[We.EXTERIOR][We.BOUNDARY]=b._matrix[We.EXTERIOR][We.BOUNDARY],this._matrix[We.EXTERIOR][We.EXTERIOR]=b._matrix[We.EXTERIOR][We.EXTERIOR]}}}},{key:"matches",value:function(){if(Number.isInteger(arguments[0])&&typeof arguments[1]=="string"){var m=arguments[0],b=arguments[1];return b===Pn.SYM_DONTCARE||b===Pn.SYM_TRUE&&(m>=0||m===Pn.TRUE)||b===Pn.SYM_FALSE&&m===Pn.FALSE||b===Pn.SYM_P&&m===Pn.P||b===Pn.SYM_L&&m===Pn.L||b===Pn.SYM_A&&m===Pn.A}if(typeof arguments[0]=="string"&&typeof arguments[1]=="string"){var w=arguments[0],R=arguments[1],J=new U(w);return J.matches(R)}}},{key:"isTrue",value:function(m){return m>=0||m===Pn.TRUE}}]),U}(),zs=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"size",value:function(){return this._size}},{key:"addAll",value:function(m){return m===null||m.length===0?null:(this.ensureCapacity(this._size+m.length),vr.arraycopy(m,0,this._data,this._size,m.length),void(this._size+=m.length))}},{key:"ensureCapacity",value:function(m){if(m<=this._data.length)return null;var b=Math.max(m,2*this._data.length);this._data=Mt.copyOf(this._data,b)}},{key:"toArray",value:function(){var m=new Array(this._size).fill(null);return vr.arraycopy(this._data,0,m,0,this._size),m}},{key:"add",value:function(m){this.ensureCapacity(this._size+1),this._data[this._size]=m,++this._size}}],[{key:"constructor_",value:function(){if(this._data=null,this._size=0,arguments.length===0)U.constructor_.call(this,10);else if(arguments.length===1){var m=arguments[0];this._data=new Array(m).fill(null)}}}]),U}(),ho=function(){function U(){n(this,U)}return a(U,[{key:"getChainStartIndices",value:function(m){var b=0,w=new zs(Math.trunc(m.length/2));w.add(b);do{var R=this.findChainEnd(m,b);w.add(R),b=R}while(b<m.length-1);return w.toArray()}},{key:"findChainEnd",value:function(m,b){for(var w=us.quadrant(m[b],m[b+1]),R=b+1;R<m.length&&us.quadrant(m[R-1],m[R])===w;)R++;return R-1}},{key:"OLDgetChainStartIndices",value:function(m){var b=0,w=new Mn;w.add(b);do{var R=this.findChainEnd(m,b);w.add(R),b=R}while(b<m.length-1);return U.toIntArray(w)}}],[{key:"toIntArray",value:function(m){for(var b=new Array(m.size()).fill(null),w=0;w<b.length;w++)b[w]=m.get(w).intValue();return b}}]),U}(),Sl=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"getCoordinates",value:function(){return this.pts}},{key:"getMaxX",value:function(m){var b=this.pts[this.startIndex[m]].x,w=this.pts[this.startIndex[m+1]].x;return b>w?b:w}},{key:"getMinX",value:function(m){var b=this.pts[this.startIndex[m]].x,w=this.pts[this.startIndex[m+1]].x;return b<w?b:w}},{key:"computeIntersectsForChain",value:function(){if(arguments.length===4){var m=arguments[0],b=arguments[1],w=arguments[2],R=arguments[3];this.computeIntersectsForChain(this.startIndex[m],this.startIndex[m+1],b,b.startIndex[w],b.startIndex[w+1],R)}else if(arguments.length===6){var J=arguments[0],ve=arguments[1],Ie=arguments[2],je=arguments[3],lt=arguments[4],Ft=arguments[5];if(ve-J==1&&lt-je==1)return Ft.addIntersections(this.e,J,Ie.e,je),null;if(!this.overlaps(J,ve,Ie,je,lt))return null;var Kt=Math.trunc((J+ve)/2),En=Math.trunc((je+lt)/2);J<Kt&&(je<En&&this.computeIntersectsForChain(J,Kt,Ie,je,En,Ft),En<lt&&this.computeIntersectsForChain(J,Kt,Ie,En,lt,Ft)),Kt<ve&&(je<En&&this.computeIntersectsForChain(Kt,ve,Ie,je,En,Ft),En<lt&&this.computeIntersectsForChain(Kt,ve,Ie,En,lt,Ft))}}},{key:"overlaps",value:function(m,b,w,R,J){return wt.intersects(this.pts[m],this.pts[b],w.pts[R],w.pts[J])}},{key:"getStartIndexes",value:function(){return this.startIndex}},{key:"computeIntersects",value:function(m,b){for(var w=0;w<this.startIndex.length-1;w++)for(var R=0;R<m.startIndex.length-1;R++)this.computeIntersectsForChain(w,m,R,b)}}],[{key:"constructor_",value:function(){this.e=null,this.pts=null,this.startIndex=null;var m=arguments[0];this.e=m,this.pts=m.getCoordinates();var b=new ho;this.startIndex=b.getChainStartIndices(this.pts)}}]),U}(),Nn=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"getDepth",value:function(m,b){return this._depth[m][b]}},{key:"setDepth",value:function(m,b,w){this._depth[m][b]=w}},{key:"isNull",value:function(){if(arguments.length===0){for(var m=0;m<2;m++)for(var b=0;b<3;b++)if(this._depth[m][b]!==U.NULL_VALUE)return!1;return!0}if(arguments.length===1){var w=arguments[0];return this._depth[w][1]===U.NULL_VALUE}if(arguments.length===2){var R=arguments[0],J=arguments[1];return this._depth[R][J]===U.NULL_VALUE}}},{key:"normalize",value:function(){for(var m=0;m<2;m++)if(!this.isNull(m)){var b=this._depth[m][1];this._depth[m][2]<b&&(b=this._depth[m][2]),b<0&&(b=0);for(var w=1;w<3;w++){var R=0;this._depth[m][w]>b&&(R=1),this._depth[m][w]=R}}}},{key:"getDelta",value:function(m){return this._depth[m][nt.RIGHT]-this._depth[m][nt.LEFT]}},{key:"getLocation",value:function(m,b){return this._depth[m][b]<=0?We.EXTERIOR:We.INTERIOR}},{key:"toString",value:function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]}},{key:"add",value:function(){if(arguments.length===1)for(var m=arguments[0],b=0;b<2;b++)for(var w=1;w<3;w++){var R=m.getLocation(b,w);R!==We.EXTERIOR&&R!==We.INTERIOR||(this.isNull(b,w)?this._depth[b][w]=U.depthAtLocation(R):this._depth[b][w]+=U.depthAtLocation(R))}else if(arguments.length===3){var J=arguments[0],ve=arguments[1],Ie=arguments[2];Ie===We.INTERIOR&&this._depth[J][ve]++}}}],[{key:"constructor_",value:function(){this._depth=Array(2).fill().map(function(){return Array(3)});for(var m=0;m<2;m++)for(var b=0;b<3;b++)this._depth[m][b]=U.NULL_VALUE}},{key:"depthAtLocation",value:function(m){return m===We.EXTERIOR?0:m===We.INTERIOR?1:U.NULL_VALUE}}]),U}();Nn.NULL_VALUE=-1;var nh=function(U){u(b,U);var m=D(b);function b(){var w;return n(this,b),w=m.call(this),b.constructor_.apply(I(w),arguments),w}return a(b,[{key:"getDepth",value:function(){return this._depth}},{key:"getCollapsedEdge",value:function(){var w=new Array(2).fill(null);return w[0]=this.pts[0],w[1]=this.pts[1],new b(w,Kr.toLineLabel(this._label))}},{key:"isIsolated",value:function(){return this._isIsolated}},{key:"getCoordinates",value:function(){return this.pts}},{key:"setIsolated",value:function(w){this._isIsolated=w}},{key:"setName",value:function(w){this._name=w}},{key:"equals",value:function(w){if(!(w instanceof b))return!1;var R=w;if(this.pts.length!==R.pts.length)return!1;for(var J=!0,ve=!0,Ie=this.pts.length,je=0;je<this.pts.length;je++)if(this.pts[je].equals2D(R.pts[je])||(J=!1),this.pts[je].equals2D(R.pts[--Ie])||(ve=!1),!J&&!ve)return!1;return!0}},{key:"getCoordinate",value:function(){if(arguments.length===0)return this.pts.length>0?this.pts[0]:null;if(arguments.length===1){var w=arguments[0];return this.pts[w]}}},{key:"print",value:function(w){w.print("edge "+this._name+": "),w.print("LINESTRING (");for(var R=0;R<this.pts.length;R++)R>0&&w.print(","),w.print(this.pts[R].x+" "+this.pts[R].y);w.print(")  "+this._label+" "+this._depthDelta)}},{key:"computeIM",value:function(w){b.updateIM(this._label,w)}},{key:"isCollapsed",value:function(){return!!this._label.isArea()&&this.pts.length===3&&!!this.pts[0].equals(this.pts[2])}},{key:"isClosed",value:function(){return this.pts[0].equals(this.pts[this.pts.length-1])}},{key:"getMaximumSegmentIndex",value:function(){return this.pts.length-1}},{key:"getDepthDelta",value:function(){return this._depthDelta}},{key:"getNumPoints",value:function(){return this.pts.length}},{key:"printReverse",value:function(w){w.print("edge "+this._name+": ");for(var R=this.pts.length-1;R>=0;R--)w.print(this.pts[R]+" ");w.println("")}},{key:"getMonotoneChainEdge",value:function(){return this._mce===null&&(this._mce=new Sl(this)),this._mce}},{key:"getEnvelope",value:function(){if(this._env===null){this._env=new wt;for(var w=0;w<this.pts.length;w++)this._env.expandToInclude(this.pts[w])}return this._env}},{key:"addIntersection",value:function(w,R,J,ve){var Ie=new ot(w.getIntersection(ve)),je=R,lt=w.getEdgeDistance(J,ve),Ft=je+1;if(Ft<this.pts.length){var Kt=this.pts[Ft];Ie.equals2D(Kt)&&(je=Ft,lt=0)}this.eiList.add(Ie,je,lt)}},{key:"toString",value:function(){var w=new Mi;w.append("edge "+this._name+": "),w.append("LINESTRING (");for(var R=0;R<this.pts.length;R++)R>0&&w.append(","),w.append(this.pts[R].x+" "+this.pts[R].y);return w.append(")  "+this._label+" "+this._depthDelta),w.toString()}},{key:"isPointwiseEqual",value:function(w){if(this.pts.length!==w.pts.length)return!1;for(var R=0;R<this.pts.length;R++)if(!this.pts[R].equals2D(w.pts[R]))return!1;return!0}},{key:"setDepthDelta",value:function(w){this._depthDelta=w}},{key:"getEdgeIntersectionList",value:function(){return this.eiList}},{key:"addIntersections",value:function(w,R,J){for(var ve=0;ve<w.getIntersectionNum();ve++)this.addIntersection(w,R,J,ve)}}],[{key:"constructor_",value:function(){if(this.pts=null,this._env=null,this.eiList=new Aa(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new Nn,this._depthDelta=0,arguments.length===1){var w=arguments[0];b.constructor_.call(this,w,null)}else if(arguments.length===2){var R=arguments[0],J=arguments[1];this.pts=R,this._label=J}}},{key:"updateIM",value:function(){if(!(arguments.length===2&&arguments[1]instanceof hd&&arguments[0]instanceof Kr))return N(f(b),"updateIM",this).apply(this,arguments);var w=arguments[0],R=arguments[1];R.setAtLeastIfValid(w.getLocation(0,nt.ON),w.getLocation(1,nt.ON),1),w.isArea()&&(R.setAtLeastIfValid(w.getLocation(0,nt.LEFT),w.getLocation(1,nt.LEFT),2),R.setAtLeastIfValid(w.getLocation(0,nt.RIGHT),w.getLocation(1,nt.RIGHT),2))}}]),b}(Ri),Ja=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"setWorkingPrecisionModel",value:function(m){this._workingPrecisionModel=m}},{key:"insertUniqueEdge",value:function(m){var b=this._edgeList.findEqualEdge(m);if(b!==null){var w=b.getLabel(),R=m.getLabel();b.isPointwiseEqual(m)||(R=new Kr(m.getLabel())).flip(),w.merge(R);var J=U.depthDelta(R),ve=b.getDepthDelta()+J;b.setDepthDelta(ve)}else this._edgeList.add(m),m.setDepthDelta(U.depthDelta(m.getLabel()))}},{key:"buildSubgraphs",value:function(m,b){for(var w=new Mn,R=m.iterator();R.hasNext();){var J=R.next(),ve=J.getRightmostCoordinate(),Ie=new Fu(w).getDepth(ve);J.computeDepth(Ie),J.findResultEdges(),w.add(J),b.add(J.getDirectedEdges(),J.getNodes())}}},{key:"createSubgraphs",value:function(m){for(var b=new Mn,w=m.getNodes().iterator();w.hasNext();){var R=w.next();if(!R.isVisited()){var J=new fi;J.create(R),b.add(J)}}return Yo.sort(b,Yo.reverseOrder()),b}},{key:"createEmptyResultGeometry",value:function(){return this._geomFact.createPolygon()}},{key:"getNoder",value:function(m){if(this._workingNoder!==null)return this._workingNoder;var b=new Ya,w=new hr;return w.setPrecisionModel(m),b.setSegmentIntersector(new kc(w)),b}},{key:"buffer",value:function(m,b){var w=this._workingPrecisionModel;w===null&&(w=m.getPrecisionModel()),this._geomFact=m.getFactory();var R=new Xh(w,this._bufParams),J=new Dr(m,b,R).getCurves();if(J.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(J,w),this._graph=new co(new dd),this._graph.addEdges(this._edgeList.getEdges());var ve=this.createSubgraphs(this._graph),Ie=new qh(this._geomFact);this.buildSubgraphs(ve,Ie);var je=Ie.getPolygons();return je.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(je)}},{key:"computeNodedEdges",value:function(m,b){var w=this.getNoder(b);w.computeNodes(m);for(var R=w.getNodedSubstrings().iterator();R.hasNext();){var J=R.next(),ve=J.getCoordinates();if(ve.length!==2||!ve[0].equals2D(ve[1])){var Ie=J.getData(),je=new nh(J.getCoordinates(),new Kr(Ie));this.insertUniqueEdge(je)}}}},{key:"setNoder",value:function(m){this._workingNoder=m}}],[{key:"constructor_",value:function(){this._bufParams=null,this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new du;var m=arguments[0];this._bufParams=m}},{key:"depthDelta",value:function(m){var b=m.getLocation(0,nt.LEFT),w=m.getLocation(0,nt.RIGHT);return b===We.INTERIOR&&w===We.EXTERIOR?1:b===We.EXTERIOR&&w===We.INTERIOR?-1:0}},{key:"convertSegStrings",value:function(m){for(var b=new Xo,w=new Mn;m.hasNext();){var R=m.next(),J=b.createLineString(R.getCoordinates());w.add(J)}return b.buildGeometry(w)}}]),U}(),Nu=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"rescale",value:function(){if(Jt(arguments[0],Sn))for(var m=arguments[0],b=m.iterator();b.hasNext();){var w=b.next();this.rescale(w.getCoordinates())}else if(arguments[0]instanceof Array){for(var R=arguments[0],J=0;J<R.length;J++)R[J].x=R[J].x/this._scaleFactor+this._offsetX,R[J].y=R[J].y/this._scaleFactor+this._offsetY;R.length===2&&R[0].equals2D(R[1])&&vr.out.println(R)}}},{key:"scale",value:function(){if(Jt(arguments[0],Sn)){for(var m=arguments[0],b=new Mn(m.size()),w=m.iterator();w.hasNext();){var R=w.next();b.add(new jl(this.scale(R.getCoordinates()),R.getData()))}return b}if(arguments[0]instanceof Array){for(var J=arguments[0],ve=new Array(J.length).fill(null),Ie=0;Ie<J.length;Ie++)ve[Ie]=new ot(Math.round((J[Ie].x-this._offsetX)*this._scaleFactor),Math.round((J[Ie].y-this._offsetY)*this._scaleFactor),J[Ie].getZ());var je=Or.removeRepeatedPoints(ve);return je}}},{key:"isIntegerPrecision",value:function(){return this._scaleFactor===1}},{key:"getNodedSubstrings",value:function(){var m=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(m),m}},{key:"computeNodes",value:function(m){var b=m;this._isScaled&&(b=this.scale(m)),this._noder.computeNodes(b)}},{key:"interfaces_",get:function(){return[Du]}}],[{key:"constructor_",value:function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,arguments.length===2){var m=arguments[0],b=arguments[1];U.constructor_.call(this,m,b,0,0)}else if(arguments.length===4){var w=arguments[0],R=arguments[1];this._noder=w,this._scaleFactor=R,this._isScaled=!this.isIntegerPrecision()}}}]),U}(),Bu=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"checkEndPtVertexIntersections",value:function(){if(arguments.length===0)for(var m=this._segStrings.iterator();m.hasNext();){var b=m.next(),w=b.getCoordinates();this.checkEndPtVertexIntersections(w[0],this._segStrings),this.checkEndPtVertexIntersections(w[w.length-1],this._segStrings)}else if(arguments.length===2){for(var R=arguments[0],J=arguments[1],ve=J.iterator();ve.hasNext();)for(var Ie=ve.next(),je=Ie.getCoordinates(),lt=1;lt<je.length-1;lt++)if(je[lt].equals(R))throw new Ke("found endpt/interior pt intersection at index "+lt+" :pt "+R)}}},{key:"checkInteriorIntersections",value:function(){if(arguments.length===0)for(var m=this._segStrings.iterator();m.hasNext();)for(var b=m.next(),w=this._segStrings.iterator();w.hasNext();){var R=w.next();this.checkInteriorIntersections(b,R)}else if(arguments.length===2)for(var J=arguments[0],ve=arguments[1],Ie=J.getCoordinates(),je=ve.getCoordinates(),lt=0;lt<Ie.length-1;lt++)for(var Ft=0;Ft<je.length-1;Ft++)this.checkInteriorIntersections(J,lt,ve,Ft);else if(arguments.length===4){var Kt=arguments[0],En=arguments[1],or=arguments[2],er=arguments[3];if(Kt===or&&En===er)return null;var Nr=Kt.getCoordinates()[En],Bn=Kt.getCoordinates()[En+1],wr=or.getCoordinates()[er],Pi=or.getCoordinates()[er+1];if(this._li.computeIntersection(Nr,Bn,wr,Pi),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,Nr,Bn)||this.hasInteriorIntersection(this._li,wr,Pi)))throw new Ke("found non-noded intersection at "+Nr+"-"+Bn+" and "+wr+"-"+Pi)}}},{key:"checkValid",value:function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()}},{key:"checkCollapses",value:function(){if(arguments.length===0)for(var m=this._segStrings.iterator();m.hasNext();){var b=m.next();this.checkCollapses(b)}else if(arguments.length===1)for(var w=arguments[0],R=w.getCoordinates(),J=0;J<R.length-2;J++)this.checkCollapse(R[J],R[J+1],R[J+2])}},{key:"hasInteriorIntersection",value:function(m,b,w){for(var R=0;R<m.getIntersectionNum();R++){var J=m.getIntersection(R);if(!J.equals(b)&&!J.equals(w))return!0}return!1}},{key:"checkCollapse",value:function(m,b,w){if(m.equals(w))throw new Ke("found non-noded collapse at "+U.fact.createLineString([m,b,w]))}}],[{key:"constructor_",value:function(){this._li=new hr,this._segStrings=null;var m=arguments[0];this._segStrings=m}}]),U}();Bu.fact=new Xo;var hu=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"intersectsScaled",value:function(m,b){var w=Math.min(m.x,b.x),R=Math.max(m.x,b.x),J=Math.min(m.y,b.y),ve=Math.max(m.y,b.y),Ie=this._maxx<w||this._minx>R||this._maxy<J||this._miny>ve;if(Ie)return!1;var je=this.intersectsToleranceSquare(m,b);return Ue.isTrue(!(Ie&&je),"Found bad envelope test"),je}},{key:"initCorners",value:function(m){var b=.5;this._minx=m.x-b,this._maxx=m.x+b,this._miny=m.y-b,this._maxy=m.y+b,this._corner[0]=new ot(this._maxx,this._maxy),this._corner[1]=new ot(this._minx,this._maxy),this._corner[2]=new ot(this._minx,this._miny),this._corner[3]=new ot(this._maxx,this._miny)}},{key:"intersects",value:function(m,b){return this._scaleFactor===1?this.intersectsScaled(m,b):(this.copyScaled(m,this._p0Scaled),this.copyScaled(b,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))}},{key:"scale",value:function(m){return Math.round(m*this._scaleFactor)}},{key:"getCoordinate",value:function(){return this._originalPt}},{key:"copyScaled",value:function(m,b){b.x=this.scale(m.x),b.y=this.scale(m.y)}},{key:"getSafeEnvelope",value:function(){if(this._safeEnv===null){var m=U.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new wt(this._originalPt.x-m,this._originalPt.x+m,this._originalPt.y-m,this._originalPt.y+m)}return this._safeEnv}},{key:"intersectsPixelClosure",value:function(m,b){return this._li.computeIntersection(m,b,this._corner[0],this._corner[1]),!!this._li.hasIntersection()||(this._li.computeIntersection(m,b,this._corner[1],this._corner[2]),!!this._li.hasIntersection()||(this._li.computeIntersection(m,b,this._corner[2],this._corner[3]),!!this._li.hasIntersection()||(this._li.computeIntersection(m,b,this._corner[3],this._corner[0]),!!this._li.hasIntersection())))}},{key:"intersectsToleranceSquare",value:function(m,b){var w=!1,R=!1;return this._li.computeIntersection(m,b,this._corner[0],this._corner[1]),!!this._li.isProper()||(this._li.computeIntersection(m,b,this._corner[1],this._corner[2]),!!this._li.isProper()||(this._li.hasIntersection()&&(w=!0),this._li.computeIntersection(m,b,this._corner[2],this._corner[3]),!!this._li.isProper()||(this._li.hasIntersection()&&(R=!0),this._li.computeIntersection(m,b,this._corner[3],this._corner[0]),!!this._li.isProper()||!(!w||!R)||!!m.equals(this._pt)||!!b.equals(this._pt))))}},{key:"addSnappedNode",value:function(m,b){var w=m.getCoordinate(b),R=m.getCoordinate(b+1);return!!this.intersects(w,R)&&(m.addIntersection(this.getCoordinate(),b),!0)}}],[{key:"constructor_",value:function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var m=arguments[0],b=arguments[1],w=arguments[2];if(this._originalPt=m,this._pt=m,this._scaleFactor=b,this._li=w,b<=0)throw new le("Scale factor must be non-zero");b!==1&&(this._pt=new ot(this.scale(m.x),this.scale(m.y)),this._p0Scaled=new ot,this._p1Scaled=new ot),this.initCorners(this._pt)}}]),U}();hu.SAFE_ENV_EXPANSION_FACTOR=.75;var Qa=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"select",value:function(){if(arguments.length!==1){if(arguments.length===2){var m=arguments[0],b=arguments[1];m.getLineSegment(b,this.selectedSegment),this.select(this.selectedSegment)}}}}],[{key:"constructor_",value:function(){this.selectedSegment=new ia}}]),U}(),Ul=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"snap",value:function(){if(arguments.length===1){var m=arguments[0];return this.snap(m,null,-1)}if(arguments.length===3){var b=arguments[0],w=arguments[1],R=arguments[2],J=b.getSafeEnvelope(),ve=new Xs(b,w,R);return this._index.query(J,new(function(){function Ie(){n(this,Ie)}return a(Ie,[{key:"interfaces_",get:function(){return[Pa]}},{key:"visitItem",value:function(je){je.select(J,ve)}}]),Ie}())),ve.isNodeAdded()}}}],[{key:"constructor_",value:function(){this._index=null;var m=arguments[0];this._index=m}}]),U}(),Xs=function(U){u(b,U);var m=D(b);function b(){var w;return n(this,b),w=m.call(this),b.constructor_.apply(I(w),arguments),w}return a(b,[{key:"isNodeAdded",value:function(){return this._isNodeAdded}},{key:"select",value:function(){if(!(arguments.length===2&&Number.isInteger(arguments[1])&&arguments[0]instanceof cd))return N(f(b.prototype),"select",this).apply(this,arguments);var w=arguments[0],R=arguments[1],J=w.getContext();if(this._parentEdge===J&&(R===this._hotPixelVertexIndex||R+1===this._hotPixelVertexIndex))return null;this._isNodeAdded|=this._hotPixel.addSnappedNode(J,R)}}],[{key:"constructor_",value:function(){this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var w=arguments[0],R=arguments[1],J=arguments[2];this._hotPixel=w,this._parentEdge=R,this._hotPixelVertexIndex=J}}]),b}(Qa);Ul.HotPixelSnapAction=Xs;var fd=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"processIntersections",value:function(m,b,w,R){if(m===w&&b===R)return null;var J=m.getCoordinates()[b],ve=m.getCoordinates()[b+1],Ie=w.getCoordinates()[R],je=w.getCoordinates()[R+1];if(this._li.computeIntersection(J,ve,Ie,je),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var lt=0;lt<this._li.getIntersectionNum();lt++)this._interiorIntersections.add(this._li.getIntersection(lt));m.addIntersections(this._li,b,0),w.addIntersections(this._li,R,1)}}},{key:"isDone",value:function(){return!1}},{key:"getInteriorIntersections",value:function(){return this._interiorIntersections}},{key:"interfaces_",get:function(){return[cs]}}],[{key:"constructor_",value:function(){this._li=null,this._interiorIntersections=null;var m=arguments[0];this._li=m,this._interiorIntersections=new Mn}}]),U}(),rn=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"checkCorrectness",value:function(m){var b=jl.getNodedSubstrings(m),w=new Bu(b);try{w.checkValid()}catch(R){if(!(R instanceof re))throw R;R.printStackTrace()}}},{key:"getNodedSubstrings",value:function(){return jl.getNodedSubstrings(this._nodedSegStrings)}},{key:"snapRound",value:function(m,b){var w=this.findInteriorIntersections(m,b);this.computeIntersectionSnaps(w),this.computeVertexSnaps(m)}},{key:"findInteriorIntersections",value:function(m,b){var w=new fd(b);return this._noder.setSegmentIntersector(w),this._noder.computeNodes(m),w.getInteriorIntersections()}},{key:"computeVertexSnaps",value:function(){if(Jt(arguments[0],Sn))for(var m=arguments[0],b=m.iterator();b.hasNext();){var w=b.next();this.computeVertexSnaps(w)}else if(arguments[0]instanceof jl)for(var R=arguments[0],J=R.getCoordinates(),ve=0;ve<J.length;ve++){var Ie=new hu(J[ve],this._scaleFactor,this._li),je=this._pointSnapper.snap(Ie,R,ve);je&&R.addIntersection(J[ve],ve)}}},{key:"computeNodes",value:function(m){this._nodedSegStrings=m,this._noder=new Ya,this._pointSnapper=new Ul(this._noder.getIndex()),this.snapRound(m,this._li)}},{key:"computeIntersectionSnaps",value:function(m){for(var b=m.iterator();b.hasNext();){var w=b.next(),R=new hu(w,this._scaleFactor,this._li);this._pointSnapper.snap(R)}}},{key:"interfaces_",get:function(){return[Du]}}],[{key:"constructor_",value:function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var m=arguments[0];this._pm=m,this._li=new hr,this._li.setPrecisionModel(m),this._scaleFactor=m.getScale()}}]),U}(),wn=function(){function U(){n(this,U),U.constructor_.apply(this,arguments)}return a(U,[{key:"bufferFixedPrecision",value:function(m){var b=new Nu(new rn(new ei(1)),m.getScale()),w=new Ja(this._bufParams);w.setWorkingPrecisionModel(m),w.setNoder(b),this._resultGeometry=w.buffer(this._argGeom,this._distance)}},{key:"bufferReducedPrecision",value:function(){if(arguments.length===0){for(var m=U.MAX_PRECISION_DIGITS;m>=0;m--){try{this.bufferReducedPrecision(m)}catch(J){if(!(J instanceof Rr))throw J;this._saveException=J}if(this._resultGeometry!==null)return null}throw this._saveException}if(arguments.length===1){var b=arguments[0],w=U.precisionScaleFactor(this._argGeom,this._distance,b),R=new ei(w);this.bufferFixedPrecision(R)}}},{key:"computeGeometry",value:function(){if(this.bufferOriginalPrecision(),this._resultGeometry!==null)return null;var m=this._argGeom.getFactory().getPrecisionModel();m.getType()===ei.FIXED?this.bufferFixedPrecision(m):this.bufferReducedPrecision()}},{key:"setQuadrantSegments",value:function(m){this._bufParams.setQuadrantSegments(m)}},{key:"bufferOriginalPrecision",value:function(){try{var m=new Ja(this._bufParams);this._resultGeometry=m.buffer(this._argGeom,this._distance)}catch(b){if(!(b instanceof Ke))throw b;this._saveException=b}}},{key:"getResultGeometry",value:function(m){return this._distance=m,this.computeGeometry(),this._resultGeometry}},{key:"setEndCapStyle",value:function(m){this._bufParams.setEndCapStyle(m)}}],[{key:"constructor_",value:function(){if(this._argGeom=null,this._distance=null,this._bufParams=new Z,this._resultGeometry=null,this._saveException=null,arguments.length===1){var m=arguments[0];this._argGeom=m}else if(arguments.length===2){var b=arguments[0],w=arguments[1];this._argGeom=b,this._bufParams=w}}},{key:"bufferOp",value:function(){if(arguments.length===2){var m=arguments[0],b=arguments[1],w=new U(m),R=w.getResultGeometry(b);return R}if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof Ne&&typeof arguments[1]=="number"){var J=arguments[0],ve=arguments[1],Ie=arguments[2],je=new U(J);je.setQuadrantSegments(Ie);var lt=je.getResultGeometry(ve);return lt}if(arguments[2]instanceof Z&&arguments[0]instanceof Ne&&typeof arguments[1]=="number"){var Ft=arguments[0],Kt=arguments[1],En=arguments[2],or=new U(Ft,En),er=or.getResultGeometry(Kt);return er}}else if(arguments.length===4){var Nr=arguments[0],Bn=arguments[1],wr=arguments[2],Pi=arguments[3],Vi=new U(Nr);Vi.setQuadrantSegments(wr),Vi.setEndCapStyle(Pi);var Ko=Vi.getResultGeometry(Bn);return Ko}}},{key:"precisionScaleFactor",value:function(m,b,w){var R=m.getEnvelopeInternal(),J=zi.max(Math.abs(R.getMaxX()),Math.abs(R.getMaxY()),Math.abs(R.getMinX()),Math.abs(R.getMinY()))+2*(b>0?b:0),ve=w-Math.trunc(Math.log(J)/Math.log(10)+1);return Math.pow(10,ve)}}]),U}();wn.CAP_ROUND=Z.CAP_ROUND,wn.CAP_BUTT=Z.CAP_FLAT,wn.CAP_FLAT=Z.CAP_FLAT,wn.CAP_SQUARE=Z.CAP_SQUARE,wn.MAX_PRECISION_DIGITS=12;var pr=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],Pr=function(){function U(m){n(this,U),this.geometryFactory=m||new Xo}return a(U,[{key:"read",value:function(m){var b,w=(b=typeof m=="string"?JSON.parse(m):m).type;if(!Ti[w])throw new Error("Unknown GeoJSON type: "+b.type);return pr.indexOf(w)!==-1?Ti[w].call(this,b.coordinates):w==="GeometryCollection"?Ti[w].call(this,b.geometries):Ti[w].call(this,b)}},{key:"write",value:function(m){var b=m.getGeometryType();if(!di[b])throw new Error("Geometry is not supported");return di[b].call(this,m)}}]),U}(),Ti={Feature:function(U){var m={};for(var b in U)m[b]=U[b];if(U.geometry){var w=U.geometry.type;if(!Ti[w])throw new Error("Unknown GeoJSON type: "+U.type);m.geometry=this.read(U.geometry)}return U.bbox&&(m.bbox=Ti.bbox.call(this,U.bbox)),m},FeatureCollection:function(U){var m={};if(U.features){m.features=[];for(var b=0;b<U.features.length;++b)m.features.push(this.read(U.features[b]))}return U.bbox&&(m.bbox=this.parse.bbox.call(this,U.bbox)),m},coordinates:function(U){for(var m=[],b=0;b<U.length;++b){var w=U[b];m.push(C(ot,j(w)))}return m},bbox:function(U){return this.geometryFactory.createLinearRing([new ot(U[0],U[1]),new ot(U[2],U[1]),new ot(U[2],U[3]),new ot(U[0],U[3]),new ot(U[0],U[1])])},Point:function(U){var m=C(ot,j(U));return this.geometryFactory.createPoint(m)},MultiPoint:function(U){for(var m=[],b=0;b<U.length;++b)m.push(Ti.Point.call(this,U[b]));return this.geometryFactory.createMultiPoint(m)},LineString:function(U){var m=Ti.coordinates.call(this,U);return this.geometryFactory.createLineString(m)},MultiLineString:function(U){for(var m=[],b=0;b<U.length;++b)m.push(Ti.LineString.call(this,U[b]));return this.geometryFactory.createMultiLineString(m)},Polygon:function(U){for(var m=Ti.coordinates.call(this,U[0]),b=this.geometryFactory.createLinearRing(m),w=[],R=1;R<U.length;++R){var J=U[R],ve=Ti.coordinates.call(this,J),Ie=this.geometryFactory.createLinearRing(ve);w.push(Ie)}return this.geometryFactory.createPolygon(b,w)},MultiPolygon:function(U){for(var m=[],b=0;b<U.length;++b){var w=U[b];m.push(Ti.Polygon.call(this,w))}return this.geometryFactory.createMultiPolygon(m)},GeometryCollection:function(U){for(var m=[],b=0;b<U.length;++b){var w=U[b];m.push(this.read(w))}return this.geometryFactory.createGeometryCollection(m)}},di={coordinate:function(U){var m=[U.x,U.y];return U.z&&m.push(U.z),U.m&&m.push(U.m),m},Point:function(U){return{type:"Point",coordinates:di.coordinate.call(this,U.getCoordinate())}},MultiPoint:function(U){for(var m=[],b=0;b<U._geometries.length;++b){var w=U._geometries[b],R=di.Point.call(this,w);m.push(R.coordinates)}return{type:"MultiPoint",coordinates:m}},LineString:function(U){for(var m=[],b=U.getCoordinates(),w=0;w<b.length;++w){var R=b[w];m.push(di.coordinate.call(this,R))}return{type:"LineString",coordinates:m}},MultiLineString:function(U){for(var m=[],b=0;b<U._geometries.length;++b){var w=U._geometries[b],R=di.LineString.call(this,w);m.push(R.coordinates)}return{type:"MultiLineString",coordinates:m}},Polygon:function(U){var m=[],b=di.LineString.call(this,U._shell);m.push(b.coordinates);for(var w=0;w<U._holes.length;++w){var R=U._holes[w],J=di.LineString.call(this,R);m.push(J.coordinates)}return{type:"Polygon",coordinates:m}},MultiPolygon:function(U){for(var m=[],b=0;b<U._geometries.length;++b){var w=U._geometries[b],R=di.Polygon.call(this,w);m.push(R.coordinates)}return{type:"MultiPolygon",coordinates:m}},GeometryCollection:function(U){for(var m=[],b=0;b<U._geometries.length;++b){var w=U._geometries[b],R=w.getGeometryType();m.push(di[R].call(this,w))}return{type:"GeometryCollection",geometries:m}}};return{BufferOp:wn,GeoJSONReader:function(){function U(m){n(this,U),this.parser=new Pr(m||new Xo)}return a(U,[{key:"read",value:function(m){return this.parser.read(m)}}]),U}(),GeoJSONWriter:function(){function U(){n(this,U),this.parser=new Pr(this.geometryFactory)}return a(U,[{key:"write",value:function(m){return this.parser.write(m)}}]),U}()}})})(d3);var UW=d3.exports;const GW=yc(UW);function gp(){return new qS}function qS(){this.reset()}qS.prototype={constructor:qS,reset:function(){this.s=this.t=0},add:function(e){j5(xw,e,this.t),j5(this,xw.s,this.s),this.s?this.t+=xw.t:this.s=xw.t},valueOf:function(){return this.s}};var xw=new qS;function j5(e,t,n){var s=e.s=t+n,a=s-t,u=s-a;e.t=t-u+(n-a)}var ss=1e-6,go=Math.PI,Fd=go/2,V5=go/4,qd=go*2,Tf=180/go,Ku=go/180,Ta=Math.abs,HW=Math.atan,Yy=Math.atan2,Is=Math.cos,ks=Math.sin,v0=Math.sqrt;function h3(e){return e>1?0:e<-1?go:Math.acos(e)}function Em(e){return e>1?Fd:e<-1?-Fd:Math.asin(e)}function Vv(){}function XS(e,t){e&&U5.hasOwnProperty(e.type)&&U5[e.type](e,t)}var $5={Feature:function(e,t){XS(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,s=-1,a=n.length;++s<a;)XS(n[s].geometry,t)}},U5={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,s=-1,a=n.length;++s<a;)e=n[s],t.point(e[0],e[1],e[2])},LineString:function(e,t){$M(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,s=-1,a=n.length;++s<a;)$M(n[s],t,0)},Polygon:function(e,t){G5(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,s=-1,a=n.length;++s<a;)G5(n[s],t)},GeometryCollection:function(e,t){for(var n=e.geometries,s=-1,a=n.length;++s<a;)XS(n[s],t)}};function $M(e,t,n){var s=-1,a=e.length-n,u;for(t.lineStart();++s<a;)u=e[s],t.point(u[0],u[1],u[2]);t.lineEnd()}function G5(e,t){var n=-1,s=e.length;for(t.polygonStart();++n<s;)$M(e[n],t,1);t.polygonEnd()}function WW(e,t){e&&$5.hasOwnProperty(e.type)?$5[e.type](e,t):XS(e,t)}gp();gp();function UM(e){return[Yy(e[1],e[0]),Em(e[2])]}function Zy(e){var t=e[0],n=e[1],s=Is(n);return[s*Is(t),s*ks(t),ks(n)]}function bw(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function YS(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function ck(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function ww(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function GM(e){var t=v0(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}gp();function f3(e,t){function n(s,a){return s=e(s,a),t(s[0],s[1])}return e.invert&&t.invert&&(n.invert=function(s,a){return s=t.invert(s,a),s&&e.invert(s[0],s[1])}),n}function HM(e,t){return[e>go?e-qd:e<-go?e+qd:e,t]}HM.invert=HM;function qW(e,t,n){return(e%=qd)?t||n?f3(W5(e),q5(t,n)):W5(e):t||n?q5(t,n):HM}function H5(e){return function(t,n){return t+=e,[t>go?t-qd:t<-go?t+qd:t,n]}}function W5(e){var t=H5(e);return t.invert=H5(-e),t}function q5(e,t){var n=Is(e),s=ks(e),a=Is(t),u=ks(t);function f(_,r){var C=Is(r),k=Is(_)*C,I=ks(_)*C,P=ks(r),D=P*n+k*s;return[Yy(I*a-D*u,k*n-P*s),Em(D*a+I*u)]}return f.invert=function(_,r){var C=Is(r),k=Is(_)*C,I=ks(_)*C,P=ks(r),D=P*a-I*u;return[Yy(I*a+P*u,k*n+D*s),Em(D*n-k*s)]},f}function XW(e,t,n,s,a,u){if(n){var f=Is(t),_=ks(t),r=s*n;a==null?(a=t+s*qd,u=t-r/2):(a=X5(f,a),u=X5(f,u),(s>0?a<u:a>u)&&(a+=s*qd));for(var C,k=a;s>0?k>u:k<u;k-=r)C=UM([f,-_*Is(k),-_*ks(k)]),e.point(C[0],C[1])}}function X5(e,t){t=Zy(t),t[0]-=e,GM(t);var n=h3(-t[1]);return((-t[2]<0?-n:n)+qd-ss)%qd}function p3(){var e=[],t;return{point:function(n,s){t.push([n,s])},lineStart:function(){e.push(t=[])},lineEnd:Vv,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function YW(e,t,n,s,a,u){var f=e[0],_=e[1],r=t[0],C=t[1],k=0,I=1,P=r-f,D=C-_,N;if(N=n-f,!(!P&&N>0)){if(N/=P,P<0){if(N<k)return;N<I&&(I=N)}else if(P>0){if(N>I)return;N>k&&(k=N)}if(N=a-f,!(!P&&N<0)){if(N/=P,P<0){if(N>I)return;N>k&&(k=N)}else if(P>0){if(N<k)return;N<I&&(I=N)}if(N=s-_,!(!D&&N>0)){if(N/=D,D<0){if(N<k)return;N<I&&(I=N)}else if(D>0){if(N>I)return;N>k&&(k=N)}if(N=u-_,!(!D&&N<0)){if(N/=D,D<0){if(N>I)return;N>k&&(k=N)}else if(D>0){if(N<k)return;N<I&&(I=N)}return k>0&&(e[0]=f+k*P,e[1]=_+k*D),I<1&&(t[0]=f+I*P,t[1]=_+I*D),!0}}}}}function aS(e,t){return Ta(e[0]-t[0])<ss&&Ta(e[1]-t[1])<ss}function Sw(e,t,n,s){this.x=e,this.z=t,this.o=n,this.e=s,this.v=!1,this.n=this.p=null}function m3(e,t,n,s,a){var u=[],f=[],_,r;if(e.forEach(function(N){if(!((j=N.length-1)<=0)){var j,W=N[0],H=N[j],q;if(aS(W,H)){for(a.lineStart(),_=0;_<j;++_)a.point((W=N[_])[0],W[1]);a.lineEnd();return}u.push(q=new Sw(W,N,null,!0)),f.push(q.o=new Sw(W,null,q,!1)),u.push(q=new Sw(H,N,null,!1)),f.push(q.o=new Sw(H,null,q,!0))}}),!!u.length){for(f.sort(t),Y5(u),Y5(f),_=0,r=f.length;_<r;++_)f[_].e=n=!n;for(var C=u[0],k,I;;){for(var P=C,D=!0;P.v;)if((P=P.n)===C)return;k=P.z,a.lineStart();do{if(P.v=P.o.v=!0,P.e){if(D)for(_=0,r=k.length;_<r;++_)a.point((I=k[_])[0],I[1]);else s(P.x,P.n.x,1,a);P=P.n}else{if(D)for(k=P.p.z,_=k.length-1;_>=0;--_)a.point((I=k[_])[0],I[1]);else s(P.x,P.p.x,-1,a);P=P.p}P=P.o,k=P.z,D=!D}while(!P.v);a.lineEnd()}}}function Y5(e){if(t=e.length){for(var t,n=0,s=e[0],a;++n<t;)s.n=a=e[n],a.p=s,s=a;s.n=a=e[0],a.p=s}}function g3(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function ZW(e){return e.length===1&&(e=KW(e)),{left:function(t,n,s,a){for(s==null&&(s=0),a==null&&(a=t.length);s<a;){var u=s+a>>>1;e(t[u],n)<0?s=u+1:a=u}return s},right:function(t,n,s,a){for(s==null&&(s=0),a==null&&(a=t.length);s<a;){var u=s+a>>>1;e(t[u],n)>0?a=u:s=u+1}return s}}}function KW(e){return function(t,n){return g3(e(t),n)}}ZW(g3);function y3(e){for(var t=e.length,n,s=-1,a=0,u,f;++s<t;)a+=e[s].length;for(u=new Array(a);--t>=0;)for(f=e[t],n=f.length;--n>=0;)u[--a]=f[n];return u}var $v=1e9,Cw=-$v;function JW(e,t,n,s){function a(C,k){return e<=C&&C<=n&&t<=k&&k<=s}function u(C,k,I,P){var D=0,N=0;if(C==null||(D=f(C,I))!==(N=f(k,I))||r(C,k)<0^I>0)do P.point(D===0||D===3?e:n,D>1?s:t);while((D=(D+I+4)%4)!==N);else P.point(k[0],k[1])}function f(C,k){return Ta(C[0]-e)<ss?k>0?0:3:Ta(C[0]-n)<ss?k>0?2:1:Ta(C[1]-t)<ss?k>0?1:0:k>0?3:2}function _(C,k){return r(C.x,k.x)}function r(C,k){var I=f(C,1),P=f(k,1);return I!==P?I-P:I===0?k[1]-C[1]:I===1?C[0]-k[0]:I===2?C[1]-k[1]:k[0]-C[0]}return function(C){var k=C,I=p3(),P,D,N,j,W,H,q,Z,re,le,_e,ye={point:de,lineStart:he,lineEnd:Ee,polygonStart:oe,polygonEnd:xe};function de(we,Se){a(we,Se)&&k.point(we,Se)}function ce(){for(var we=0,Se=0,Pe=D.length;Se<Pe;++Se)for(var Me=D[Se],Re=1,Oe=Me.length,$e=Me[0],Ke,Ct,Ue=$e[0],ft=$e[1];Re<Oe;++Re)Ke=Ue,Ct=ft,$e=Me[Re],Ue=$e[0],ft=$e[1],Ct<=s?ft>s&&(Ue-Ke)*(s-Ct)>(ft-Ct)*(e-Ke)&&++we:ft<=s&&(Ue-Ke)*(s-Ct)<(ft-Ct)*(e-Ke)&&--we;return we}function oe(){k=I,P=[],D=[],_e=!0}function xe(){var we=ce(),Se=_e&&we,Pe=(P=y3(P)).length;(Se||Pe)&&(C.polygonStart(),Se&&(C.lineStart(),u(null,null,1,C),C.lineEnd()),Pe&&m3(P,_,we,u,C),C.polygonEnd()),k=C,P=D=N=null}function he(){ye.point=se,D&&D.push(N=[]),le=!0,re=!1,q=Z=NaN}function Ee(){P&&(se(j,W),H&&re&&I.rejoin(),P.push(I.result())),ye.point=de,re&&k.lineEnd()}function se(we,Se){var Pe=a(we,Se);if(D&&N.push([we,Se]),le)j=we,W=Se,H=Pe,le=!1,Pe&&(k.lineStart(),k.point(we,Se));else if(Pe&&re)k.point(we,Se);else{var Me=[q=Math.max(Cw,Math.min($v,q)),Z=Math.max(Cw,Math.min($v,Z))],Re=[we=Math.max(Cw,Math.min($v,we)),Se=Math.max(Cw,Math.min($v,Se))];YW(Me,Re,e,t,n,s)?(re||(k.lineStart(),k.point(Me[0],Me[1])),k.point(Re[0],Re[1]),Pe||k.lineEnd(),_e=!1):Pe&&(k.lineStart(),k.point(we,Se),_e=!1)}q=we,Z=Se,re=Pe}return ye}}var dk=gp();function QW(e,t){var n=t[0],s=t[1],a=[ks(n),-Is(n),0],u=0,f=0;dk.reset();for(var _=0,r=e.length;_<r;++_)if(k=(C=e[_]).length)for(var C,k,I=C[k-1],P=I[0],D=I[1]/2+V5,N=ks(D),j=Is(D),W=0;W<k;++W,P=q,N=re,j=le,I=H){var H=C[W],q=H[0],Z=H[1]/2+V5,re=ks(Z),le=Is(Z),_e=q-P,ye=_e>=0?1:-1,de=ye*_e,ce=de>go,oe=N*re;if(dk.add(Yy(oe*ye*ks(de),j*le+oe*Is(de))),u+=ce?_e+ye*qd:_e,ce^P>=n^q>=n){var xe=YS(Zy(I),Zy(H));GM(xe);var he=YS(a,xe);GM(he);var Ee=(ce^_e>=0?-1:1)*Em(he[2]);(s>Ee||s===Ee&&(xe[0]||xe[1]))&&(f+=ce^_e>=0?1:-1)}}return(u<-ss||u<ss&&dk<-ss)^f&1}gp();function Z5(e){return e}gp();gp();var Ky=1/0,ZS=Ky,Px=-Ky,KS=Px,K5={point:eq,lineStart:Vv,lineEnd:Vv,polygonStart:Vv,polygonEnd:Vv,result:function(){var e=[[Ky,ZS],[Px,KS]];return Px=KS=-(ZS=Ky=1/0),e}};function eq(e,t){e<Ky&&(Ky=e),e>Px&&(Px=e),t<ZS&&(ZS=t),t>KS&&(KS=t)}gp();function _3(e,t,n,s){return function(a,u){var f=t(u),_=a.invert(s[0],s[1]),r=p3(),C=t(r),k=!1,I,P,D,N={point:j,lineStart:H,lineEnd:q,polygonStart:function(){N.point=Z,N.lineStart=re,N.lineEnd=le,P=[],I=[]},polygonEnd:function(){N.point=j,N.lineStart=H,N.lineEnd=q,P=y3(P);var _e=QW(I,_);P.length?(k||(u.polygonStart(),k=!0),m3(P,nq,_e,n,u)):_e&&(k||(u.polygonStart(),k=!0),u.lineStart(),n(null,null,1,u),u.lineEnd()),k&&(u.polygonEnd(),k=!1),P=I=null},sphere:function(){u.polygonStart(),u.lineStart(),n(null,null,1,u),u.lineEnd(),u.polygonEnd()}};function j(_e,ye){var de=a(_e,ye);e(_e=de[0],ye=de[1])&&u.point(_e,ye)}function W(_e,ye){var de=a(_e,ye);f.point(de[0],de[1])}function H(){N.point=W,f.lineStart()}function q(){N.point=j,f.lineEnd()}function Z(_e,ye){D.push([_e,ye]);var de=a(_e,ye);C.point(de[0],de[1])}function re(){C.lineStart(),D=[]}function le(){Z(D[0][0],D[0][1]),C.lineEnd();var _e=C.clean(),ye=r.result(),de,ce=ye.length,oe,xe,he;if(D.pop(),I.push(D),D=null,!!ce){if(_e&1){if(xe=ye[0],(oe=xe.length-1)>0){for(k||(u.polygonStart(),k=!0),u.lineStart(),de=0;de<oe;++de)u.point((he=xe[de])[0],he[1]);u.lineEnd()}return}ce>1&&_e&2&&ye.push(ye.pop().concat(ye.shift())),P.push(ye.filter(tq))}}return N}}function tq(e){return e.length>1}function nq(e,t){return((e=e.x)[0]<0?e[1]-Fd-ss:Fd-e[1])-((t=t.x)[0]<0?t[1]-Fd-ss:Fd-t[1])}const J5=_3(function(){return!0},rq,oq,[-go,-Fd]);function rq(e){var t=NaN,n=NaN,s=NaN,a;return{lineStart:function(){e.lineStart(),a=1},point:function(u,f){var _=u>0?go:-go,r=Ta(u-t);Ta(r-go)<ss?(e.point(t,n=(n+f)/2>0?Fd:-Fd),e.point(s,n),e.lineEnd(),e.lineStart(),e.point(_,n),e.point(u,n),a=0):s!==_&&r>=go&&(Ta(t-s)<ss&&(t-=s*ss),Ta(u-_)<ss&&(u-=_*ss),n=iq(t,n,u,f),e.point(s,n),e.lineEnd(),e.lineStart(),e.point(_,n),a=0),e.point(t=u,n=f),s=_},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-a}}}function iq(e,t,n,s){var a,u,f=ks(e-n);return Ta(f)>ss?HW((ks(t)*(u=Is(s))*ks(n)-ks(s)*(a=Is(t))*ks(e))/(a*u*f)):(t+s)/2}function oq(e,t,n,s){var a;if(e==null)a=n*Fd,s.point(-go,a),s.point(0,a),s.point(go,a),s.point(go,0),s.point(go,-a),s.point(0,-a),s.point(-go,-a),s.point(-go,0),s.point(-go,a);else if(Ta(e[0]-t[0])>ss){var u=e[0]<t[0]?go:-go;a=n*u/2,s.point(-u,a),s.point(0,a),s.point(u,a)}else s.point(t[0],t[1])}function sq(e,t){var n=Is(e),s=n>0,a=Ta(n)>ss;function u(k,I,P,D){XW(D,e,t,P,k,I)}function f(k,I){return Is(k)*Is(I)>n}function _(k){var I,P,D,N,j;return{lineStart:function(){N=D=!1,j=1},point:function(W,H){var q=[W,H],Z,re=f(W,H),le=s?re?0:C(W,H):re?C(W+(W<0?go:-go),H):0;if(!I&&(N=D=re)&&k.lineStart(),re!==D&&(Z=r(I,q),(!Z||aS(I,Z)||aS(q,Z))&&(q[0]+=ss,q[1]+=ss,re=f(q[0],q[1]))),re!==D)j=0,re?(k.lineStart(),Z=r(q,I),k.point(Z[0],Z[1])):(Z=r(I,q),k.point(Z[0],Z[1]),k.lineEnd()),I=Z;else if(a&&I&&s^re){var _e;!(le&P)&&(_e=r(q,I,!0))&&(j=0,s?(k.lineStart(),k.point(_e[0][0],_e[0][1]),k.point(_e[1][0],_e[1][1]),k.lineEnd()):(k.point(_e[1][0],_e[1][1]),k.lineEnd(),k.lineStart(),k.point(_e[0][0],_e[0][1])))}re&&(!I||!aS(I,q))&&k.point(q[0],q[1]),I=q,D=re,P=le},lineEnd:function(){D&&k.lineEnd(),I=null},clean:function(){return j|(N&&D)<<1}}}function r(k,I,P){var D=Zy(k),N=Zy(I),j=[1,0,0],W=YS(D,N),H=bw(W,W),q=W[0],Z=H-q*q;if(!Z)return!P&&k;var re=n*H/Z,le=-n*q/Z,_e=YS(j,W),ye=ww(j,re),de=ww(W,le);ck(ye,de);var ce=_e,oe=bw(ye,ce),xe=bw(ce,ce),he=oe*oe-xe*(bw(ye,ye)-1);if(!(he<0)){var Ee=v0(he),se=ww(ce,(-oe-Ee)/xe);if(ck(se,ye),se=UM(se),!P)return se;var we=k[0],Se=I[0],Pe=k[1],Me=I[1],Re;Se<we&&(Re=we,we=Se,Se=Re);var Oe=Se-we,$e=Ta(Oe-go)<ss,Ke=$e||Oe<ss;if(!$e&&Me<Pe&&(Re=Pe,Pe=Me,Me=Re),Ke?$e?Pe+Me>0^se[1]<(Ta(se[0]-we)<ss?Pe:Me):Pe<=se[1]&&se[1]<=Me:Oe>go^(we<=se[0]&&se[0]<=Se)){var Ct=ww(ce,(-oe+Ee)/xe);return ck(Ct,ye),[se,UM(Ct)]}}}function C(k,I){var P=s?e:go-e,D=0;return k<-P?D|=1:k>P&&(D|=2),I<-P?D|=4:I>P&&(D|=8),D}return _3(f,_,u,s?[0,-e]:[-go,e-go])}function v3(e){return function(t){var n=new WM;for(var s in e)n[s]=e[s];return n.stream=t,n}}function WM(){}WM.prototype={constructor:WM,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function x3(e,t,n){var s=t[1][0]-t[0][0],a=t[1][1]-t[0][1],u=e.clipExtent&&e.clipExtent();e.scale(150).translate([0,0]),u!=null&&e.clipExtent(null),WW(n,e.stream(K5));var f=K5.result(),_=Math.min(s/(f[1][0]-f[0][0]),a/(f[1][1]-f[0][1])),r=+t[0][0]+(s-_*(f[1][0]+f[0][0]))/2,C=+t[0][1]+(a-_*(f[1][1]+f[0][1]))/2;return u!=null&&e.clipExtent(u),e.scale(_*150).translate([r,C])}function aq(e,t,n){return x3(e,[[0,0],t],n)}var Q5=16,lq=Is(30*Ku);function ez(e,t){return+t?cq(e,t):uq(e)}function uq(e){return v3({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function cq(e,t){function n(s,a,u,f,_,r,C,k,I,P,D,N,j,W){var H=C-s,q=k-a,Z=H*H+q*q;if(Z>4*t&&j--){var re=f+P,le=_+D,_e=r+N,ye=v0(re*re+le*le+_e*_e),de=Em(_e/=ye),ce=Ta(Ta(_e)-1)<ss||Ta(u-I)<ss?(u+I)/2:Yy(le,re),oe=e(ce,de),xe=oe[0],he=oe[1],Ee=xe-s,se=he-a,we=q*Ee-H*se;(we*we/Z>t||Ta((H*Ee+q*se)/Z-.5)>.3||f*P+_*D+r*N<lq)&&(n(s,a,u,f,_,r,xe,he,ce,re/=ye,le/=ye,_e,j,W),W.point(xe,he),n(xe,he,ce,re,le,_e,C,k,I,P,D,N,j,W))}}return function(s){var a,u,f,_,r,C,k,I,P,D,N,j,W={point:H,lineStart:q,lineEnd:re,polygonStart:function(){s.polygonStart(),W.lineStart=le},polygonEnd:function(){s.polygonEnd(),W.lineStart=q}};function H(de,ce){de=e(de,ce),s.point(de[0],de[1])}function q(){I=NaN,W.point=Z,s.lineStart()}function Z(de,ce){var oe=Zy([de,ce]),xe=e(de,ce);n(I,P,k,D,N,j,I=xe[0],P=xe[1],k=de,D=oe[0],N=oe[1],j=oe[2],Q5,s),s.point(I,P)}function re(){W.point=H,s.lineEnd()}function le(){q(),W.point=_e,W.lineEnd=ye}function _e(de,ce){Z(a=de,ce),u=I,f=P,_=D,r=N,C=j,W.point=Z}function ye(){n(I,P,k,D,N,j,u,f,a,_,r,C,Q5,s),W.lineEnd=re,re()}return W}}var dq=v3({point:function(e,t){this.stream.point(e*Ku,t*Ku)}});function hq(e){return fq(function(){return e})()}function fq(e){var t,n=150,s=480,a=250,u,f,_=0,r=0,C=0,k=0,I=0,P,D,N=null,j=J5,W=null,H,q,Z,re=Z5,le=.5,_e=ez(xe,le),ye,de;function ce(se){return se=D(se[0]*Ku,se[1]*Ku),[se[0]*n+u,f-se[1]*n]}function oe(se){return se=D.invert((se[0]-u)/n,(f-se[1])/n),se&&[se[0]*Tf,se[1]*Tf]}function xe(se,we){return se=t(se,we),[se[0]*n+u,f-se[1]*n]}ce.stream=function(se){return ye&&de===se?ye:ye=dq(j(P,_e(re(de=se))))},ce.clipAngle=function(se){return arguments.length?(j=+se?sq(N=se*Ku,6*Ku):(N=null,J5),Ee()):N*Tf},ce.clipExtent=function(se){return arguments.length?(re=se==null?(W=H=q=Z=null,Z5):JW(W=+se[0][0],H=+se[0][1],q=+se[1][0],Z=+se[1][1]),Ee()):W==null?null:[[W,H],[q,Z]]},ce.scale=function(se){return arguments.length?(n=+se,he()):n},ce.translate=function(se){return arguments.length?(s=+se[0],a=+se[1],he()):[s,a]},ce.center=function(se){return arguments.length?(_=se[0]%360*Ku,r=se[1]%360*Ku,he()):[_*Tf,r*Tf]},ce.rotate=function(se){return arguments.length?(C=se[0]%360*Ku,k=se[1]%360*Ku,I=se.length>2?se[2]%360*Ku:0,he()):[C*Tf,k*Tf,I*Tf]},ce.precision=function(se){return arguments.length?(_e=ez(xe,le=se*se),Ee()):v0(le)},ce.fitExtent=function(se,we){return x3(ce,se,we)},ce.fitSize=function(se,we){return aq(ce,se,we)};function he(){D=f3(P=qW(C,k,I),t);var se=t(_,r);return u=s-se[0]*n,f=a+se[1]*n,Ee()}function Ee(){return ye=de=null,ce}return function(){return t=e.apply(this,arguments),ce.invert=t.invert&&oe,he()}}function b3(e){return function(t,n){var s=Is(t),a=Is(n),u=e(s*a);return[u*a*ks(t),u*ks(n)]}}function w3(e){return function(t,n){var s=v0(t*t+n*n),a=e(s),u=ks(a),f=Is(a);return[Yy(t*u,s*f),Em(s&&n*u/s)]}}var pq=b3(function(e){return v0(2/(1+e))});pq.invert=w3(function(e){return 2*Em(e/2)});var S3=b3(function(e){return(e=h3(e))&&e/ks(e)});S3.invert=w3(function(e){return e});function mq(){return hq(S3).scale(79.4188).clipAngle(180-.001)}function tz(e,t){return[e,t]}tz.invert=tz;var{BufferOp:gq,GeoJSONReader:yq,GeoJSONWriter:_q}=GW;function vq(e,t,n){n=n||{};var s=n.units||"kilometers",a=n.steps||8;if(!e)throw new Error("geojson is required");if(typeof n!="object")throw new Error("options must be an object");if(typeof a!="number")throw new Error("steps must be an number");if(t===void 0)throw new Error("radius is required");if(a<=0)throw new Error("steps must be greater than 0");var u=[];switch(e.type){case"GeometryCollection":return ip(e,function(f){var _=lS(f,t,s,a);_&&u.push(_)}),ya(u);case"FeatureCollection":return rp(e,function(f){var _=lS(f,t,s,a);_&&rp(_,function(r){r&&u.push(r)})}),ya(u)}return lS(e,t,s,a)}function lS(e,t,n,s){var a=e.properties||{},u=e.type==="Feature"?e.geometry:e;if(u.type==="GeometryCollection"){var f=[];return ip(e,function(j){var W=lS(j,t,n,s);W&&f.push(W)}),ya(f)}var _=xq(u),r={type:u.type,coordinates:E3(u.coordinates,_)},C=new yq,k=C.read(r),I=e3(t3(t,n),"meters"),P=gq.bufferOp(k,I,s),D=new _q;if(P=D.write(P),!C3(P.coordinates)){var N={type:P.type,coordinates:T3(P.coordinates,_)};return rd(N,a)}}function C3(e){return Array.isArray(e[0])?C3(e[0]):isNaN(e[0])}function E3(e,t){return typeof e[0]!="object"?t(e):e.map(function(n){return E3(n,t)})}function T3(e,t){return typeof e[0]!="object"?t.invert(e):e.map(function(n){return T3(n,t)})}function xq(e){var t=$W(e).geometry.coordinates,n=[-t[0],-t[1]];return mq().rotate(n).scale(Yl)}function I3(e){const t={};return e&&Object.keys(e).forEach(n=>{const s=e[n];typeof s=="object"?s===null?t[n]=null:Array.isArray(s)?t[n]=s.map(a=>a):t[n]=I3(s):t[n]=s}),t}function bq(e,t){let n=!1;return ya(Cq(e.features.map(s=>{const a={x:s.geometry.coordinates[0],y:s.geometry.coordinates[1]};return t?a.z=s.properties[t]:s.geometry.coordinates.length===3&&(n=!0,a.z=s.geometry.coordinates[2]),a})).map(s=>{const a=[s.a.x,s.a.y],u=[s.b.x,s.b.y],f=[s.c.x,s.c.y];let _={};return n?(a.push(s.a.z),u.push(s.b.z),f.push(s.c.z)):_={a:s.a.z,b:s.b.z,c:s.c.z},y0([[a,u,f,a]],_)}))}var nz=class{constructor(e,t,n){this.a=e,this.b=t,this.c=n;const s=t.x-e.x,a=t.y-e.y,u=n.x-e.x,f=n.y-e.y,_=s*(e.x+t.x)+a*(e.y+t.y),r=u*(e.x+n.x)+f*(e.y+n.y),C=2*(s*(n.y-t.y)-a*(n.x-t.x));let k,I;this.x=(f*_-a*r)/C,this.y=(s*r-u*_)/C,k=this.x-e.x,I=this.y-e.y,this.r=k*k+I*I}};function wq(e,t){return t.x-e.x}function Sq(e){let t=e.length,n,s,a,u,f;e:for(;t;)for(s=e[--t],n=e[--t],a=t;a;)if(f=e[--a],u=e[--a],n===u&&s===f||n===f&&s===u){e.splice(t,2),e.splice(a,2),t-=2;continue e}}function Cq(e){if(e.length<3)return[];e.sort(wq);let t=e.length-1;const n=e[t].x,s=e[0].x;let a=e[t].y,u=a;const f=1e-12;let _,r,C,k,I,P;for(;t--;)e[t].y<a&&(a=e[t].y),e[t].y>u&&(u=e[t].y);let D=s-n,N=u-a;const j=D>N?D:N,W=(s+n)*.5,H=(u+a)*.5,q=[new nz({__sentinel:!0,x:W-20*j,y:H-j},{__sentinel:!0,x:W,y:H+20*j},{__sentinel:!0,x:W+20*j,y:H-j})],Z=[],re=[];let le;for(t=e.length;t--;){for(re.length=0,le=q.length;le--;){if(D=e[t].x-q[le].x,D>0&&D*D>q[le].r){Z.push(q[le]),q.splice(le,1);continue}N=e[t].y-q[le].y,!(D*D+N*N>q[le].r)&&(re.push(q[le].a,q[le].b,q[le].b,q[le].c,q[le].c,q[le].a),q.splice(le,1))}for(Sq(re),le=re.length;le;)r=re[--le],_=re[--le],C=e[t],k=r.x-_.x,I=r.y-_.y,P=2*(k*(C.y-r.y)-I*(C.x-r.x)),Math.abs(P)>f&&q.push(new nz(_,r,C))}for(Array.prototype.push.apply(Z,q),t=Z.length;t--;)(Z[t].a.__sentinel||Z[t].b.__sentinel||Z[t].c.__sentinel)&&Z.splice(t,1);return Z}/**
 * splaytree v3.1.2
 * Fast Splay tree for Node and browser
 *
 * @author Alexander Milevski <info@w8r.name>
 * @license MIT
 * @preserve
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function Eq(e,t){var n={label:0,sent:function(){if(u[0]&1)throw u[1];return u[1]},trys:[],ops:[]},s,a,u,f;return f={next:_(0),throw:_(1),return:_(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function _(C){return function(k){return r([C,k])}}function r(C){if(s)throw new TypeError("Generator is already executing.");for(;n;)try{if(s=1,a&&(u=C[0]&2?a.return:C[0]?a.throw||((u=a.return)&&u.call(a),0):a.next)&&!(u=u.call(a,C[1])).done)return u;switch(a=0,u&&(C=[C[0]&2,u.value]),C[0]){case 0:case 1:u=C;break;case 4:return n.label++,{value:C[1],done:!1};case 5:n.label++,a=C[1],C=[0];continue;case 7:C=n.ops.pop(),n.trys.pop();continue;default:if(u=n.trys,!(u=u.length>0&&u[u.length-1])&&(C[0]===6||C[0]===2)){n=0;continue}if(C[0]===3&&(!u||C[1]>u[0]&&C[1]<u[3])){n.label=C[1];break}if(C[0]===6&&n.label<u[1]){n.label=u[1],u=C;break}if(u&&n.label<u[2]){n.label=u[2],n.ops.push(C);break}u[2]&&n.ops.pop(),n.trys.pop();continue}C=t.call(e,n)}catch(k){C=[6,k],a=0}finally{s=u=0}if(C[0]&5)throw C[1];return{value:C[0]?C[1]:void 0,done:!0}}}var sp=function(){function e(t,n){this.next=null,this.key=t,this.data=n,this.left=null,this.right=null}return e}();function Tq(e,t){return e>t?1:e<t?-1:0}function zf(e,t,n){for(var s=new sp(null,null),a=s,u=s;;){var f=n(e,t.key);if(f<0){if(t.left===null)break;if(n(e,t.left.key)<0){var _=t.left;if(t.left=_.right,_.right=t,t=_,t.left===null)break}u.left=t,u=t,t=t.left}else if(f>0){if(t.right===null)break;if(n(e,t.right.key)>0){var _=t.right;if(t.right=_.left,_.left=t,t=_,t.right===null)break}a.right=t,a=t,t=t.right}else break}return a.right=t.left,u.left=t.right,t.left=s.right,t.right=s.left,t}function hk(e,t,n,s){var a=new sp(e,t);if(n===null)return a.left=a.right=null,a;n=zf(e,n,s);var u=s(e,n.key);return u<0?(a.left=n.left,a.right=n,n.left=null):u>=0&&(a.right=n.right,a.left=n,n.right=null),a}function rz(e,t,n){var s=null,a=null;if(t){t=zf(e,t,n);var u=n(t.key,e);u===0?(s=t.left,a=t.right):u<0?(a=t.right,t.right=null,s=t):(s=t.left,t.left=null,a=t)}return{left:s,right:a}}function Iq(e,t,n){return t===null?e:(e===null||(t=zf(e.key,t,n),t.left=e),t)}function qM(e,t,n,s,a){if(e){s(""+t+(n?"└── ":"├── ")+a(e)+`
`);var u=t+(n?"    ":"│   ");e.left&&qM(e.left,u,!1,s,a),e.right&&qM(e.right,u,!0,s,a)}}var j2=function(){function e(t){t===void 0&&(t=Tq),this._root=null,this._size=0,this._comparator=t}return e.prototype.insert=function(t,n){return this._size++,this._root=hk(t,n,this._root,this._comparator)},e.prototype.add=function(t,n){var s=new sp(t,n);this._root===null&&(s.left=s.right=null,this._size++,this._root=s);var a=this._comparator,u=zf(t,this._root,a),f=a(t,u.key);return f===0?this._root=u:(f<0?(s.left=u.left,s.right=u,u.left=null):f>0&&(s.right=u.right,s.left=u,u.right=null),this._size++,this._root=s),this._root},e.prototype.remove=function(t){this._root=this._remove(t,this._root,this._comparator)},e.prototype._remove=function(t,n,s){var a;if(n===null)return null;n=zf(t,n,s);var u=s(t,n.key);return u===0?(n.left===null?a=n.right:(a=zf(t,n.left,s),a.right=n.right),this._size--,a):n},e.prototype.pop=function(){var t=this._root;if(t){for(;t.left;)t=t.left;return this._root=zf(t.key,this._root,this._comparator),this._root=this._remove(t.key,this._root,this._comparator),{key:t.key,data:t.data}}return null},e.prototype.findStatic=function(t){for(var n=this._root,s=this._comparator;n;){var a=s(t,n.key);if(a===0)return n;a<0?n=n.left:n=n.right}return null},e.prototype.find=function(t){return this._root&&(this._root=zf(t,this._root,this._comparator),this._comparator(t,this._root.key)!==0)?null:this._root},e.prototype.contains=function(t){for(var n=this._root,s=this._comparator;n;){var a=s(t,n.key);if(a===0)return!0;a<0?n=n.left:n=n.right}return!1},e.prototype.forEach=function(t,n){for(var s=this._root,a=[],u=!1;!u;)s!==null?(a.push(s),s=s.left):a.length!==0?(s=a.pop(),t.call(n,s),s=s.right):u=!0;return this},e.prototype.range=function(t,n,s,a){for(var u=[],f=this._comparator,_=this._root,r;u.length!==0||_;)if(_)u.push(_),_=_.left;else{if(_=u.pop(),r=f(_.key,n),r>0)break;if(f(_.key,t)>=0&&s.call(a,_))return this;_=_.right}return this},e.prototype.keys=function(){var t=[];return this.forEach(function(n){var s=n.key;return t.push(s)}),t},e.prototype.values=function(){var t=[];return this.forEach(function(n){var s=n.data;return t.push(s)}),t},e.prototype.min=function(){return this._root?this.minNode(this._root).key:null},e.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},e.prototype.minNode=function(t){if(t===void 0&&(t=this._root),t)for(;t.left;)t=t.left;return t},e.prototype.maxNode=function(t){if(t===void 0&&(t=this._root),t)for(;t.right;)t=t.right;return t},e.prototype.at=function(t){for(var n=this._root,s=!1,a=0,u=[];!s;)if(n)u.push(n),n=n.left;else if(u.length>0){if(n=u.pop(),a===t)return n;a++,n=n.right}else s=!0;return null},e.prototype.next=function(t){var n=this._root,s=null;if(t.right){for(s=t.right;s.left;)s=s.left;return s}for(var a=this._comparator;n;){var u=a(t.key,n.key);if(u===0)break;u<0?(s=n,n=n.left):n=n.right}return s},e.prototype.prev=function(t){var n=this._root,s=null;if(t.left!==null){for(s=t.left;s.right;)s=s.right;return s}for(var a=this._comparator;n;){var u=a(t.key,n.key);if(u===0)break;u<0?n=n.left:(s=n,n=n.right)}return s},e.prototype.clear=function(){return this._root=null,this._size=0,this},e.prototype.toList=function(){return Mq(this._root)},e.prototype.load=function(t,n,s){n===void 0&&(n=[]),s===void 0&&(s=!1);var a=t.length,u=this._comparator;if(s&&ZM(t,n,0,a-1,u),this._root===null)this._root=XM(t,n,0,a),this._size=a;else{var f=Pq(this.toList(),kq(t,n),u);a=this._size+a,this._root=YM({head:f},0,a)}return this},e.prototype.isEmpty=function(){return this._root===null},Object.defineProperty(e.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),e.prototype.toString=function(t){t===void 0&&(t=function(s){return String(s.key)});var n=[];return qM(this._root,"",!0,function(s){return n.push(s)},t),n.join("")},e.prototype.update=function(t,n,s){var a=this._comparator,u=rz(t,this._root,a),f=u.left,_=u.right;a(t,n)<0?_=hk(n,s,_,a):f=hk(n,s,f,a),this._root=Iq(f,_,a)},e.prototype.split=function(t){return rz(t,this._root,this._comparator)},e.prototype[Symbol.iterator]=function(){var t,n,s;return Eq(this,function(a){switch(a.label){case 0:t=this._root,n=[],s=!1,a.label=1;case 1:return s?[3,6]:t===null?[3,2]:(n.push(t),t=t.left,[3,5]);case 2:return n.length===0?[3,4]:(t=n.pop(),[4,t]);case 3:return a.sent(),t=t.right,[3,5];case 4:s=!0,a.label=5;case 5:return[3,1];case 6:return[2]}})},e}();function XM(e,t,n,s){var a=s-n;if(a>0){var u=n+Math.floor(a/2),f=e[u],_=t[u],r=new sp(f,_);return r.left=XM(e,t,n,u),r.right=XM(e,t,u+1,s),r}return null}function kq(e,t){for(var n=new sp(null,null),s=n,a=0;a<e.length;a++)s=s.next=new sp(e[a],t[a]);return s.next=null,n.next}function Mq(e){for(var t=e,n=[],s=!1,a=new sp(null,null),u=a;!s;)t?(n.push(t),t=t.left):n.length>0?(t=u=u.next=n.pop(),t=t.right):s=!0;return u.next=null,a.next}function YM(e,t,n){var s=n-t;if(s>0){var a=t+Math.floor(s/2),u=YM(e,t,a),f=e.head;return f.left=u,e.head=e.head.next,f.right=YM(e,a+1,n),f}return null}function Pq(e,t,n){for(var s=new sp(null,null),a=s,u=e,f=t;u!==null&&f!==null;)n(u.key,f.key)<0?(a.next=u,u=u.next):(a.next=f,f=f.next),a=a.next;return u!==null?a.next=u:f!==null&&(a.next=f),s.next}function ZM(e,t,n,s,a){if(!(n>=s)){for(var u=e[n+s>>1],f=n-1,_=s+1;;){do f++;while(a(e[f],u)<0);do _--;while(a(e[_],u)>0);if(f>=_)break;var r=e[f];e[f]=e[_],e[_]=r,r=t[f],t[f]=t[_],t[_]=r}ZM(e,t,n,_,a),ZM(e,t,_+1,s,a)}}const Mh=11102230246251565e-32,sl=134217729,Aq=(3+8*Mh)*Mh;function fk(e,t,n,s,a){let u,f,_,r,C=t[0],k=s[0],I=0,P=0;k>C==k>-C?(u=C,C=t[++I]):(u=k,k=s[++P]);let D=0;if(I<e&&P<n)for(k>C==k>-C?(f=C+u,_=u-(f-C),C=t[++I]):(f=k+u,_=u-(f-k),k=s[++P]),u=f,_!==0&&(a[D++]=_);I<e&&P<n;)k>C==k>-C?(f=u+C,r=f-u,_=u-(f-r)+(C-r),C=t[++I]):(f=u+k,r=f-u,_=u-(f-r)+(k-r),k=s[++P]),u=f,_!==0&&(a[D++]=_);for(;I<e;)f=u+C,r=f-u,_=u-(f-r)+(C-r),C=t[++I],u=f,_!==0&&(a[D++]=_);for(;P<n;)f=u+k,r=f-u,_=u-(f-r)+(k-r),k=s[++P],u=f,_!==0&&(a[D++]=_);return(u!==0||D===0)&&(a[D++]=u),D}function Lq(e,t){let n=t[0];for(let s=1;s<e;s++)n+=t[s];return n}function n1(e){return new Float64Array(e)}const Rq=(3+16*Mh)*Mh,Oq=(2+12*Mh)*Mh,Dq=(9+64*Mh)*Mh*Mh,Ng=n1(4),iz=n1(8),oz=n1(12),sz=n1(16),kl=n1(4);function zq(e,t,n,s,a,u,f){let _,r,C,k,I,P,D,N,j,W,H,q,Z,re,le,_e,ye,de;const ce=e-a,oe=n-a,xe=t-u,he=s-u;re=ce*he,P=sl*ce,D=P-(P-ce),N=ce-D,P=sl*he,j=P-(P-he),W=he-j,le=N*W-(re-D*j-N*j-D*W),_e=xe*oe,P=sl*xe,D=P-(P-xe),N=xe-D,P=sl*oe,j=P-(P-oe),W=oe-j,ye=N*W-(_e-D*j-N*j-D*W),H=le-ye,I=le-H,Ng[0]=le-(H+I)+(I-ye),q=re+H,I=q-re,Z=re-(q-I)+(H-I),H=Z-_e,I=Z-H,Ng[1]=Z-(H+I)+(I-_e),de=q+H,I=de-q,Ng[2]=q-(de-I)+(H-I),Ng[3]=de;let Ee=Lq(4,Ng),se=Oq*f;if(Ee>=se||-Ee>=se||(I=e-ce,_=e-(ce+I)+(I-a),I=n-oe,C=n-(oe+I)+(I-a),I=t-xe,r=t-(xe+I)+(I-u),I=s-he,k=s-(he+I)+(I-u),_===0&&r===0&&C===0&&k===0)||(se=Dq*f+Aq*Math.abs(Ee),Ee+=ce*k+he*_-(xe*C+oe*r),Ee>=se||-Ee>=se))return Ee;re=_*he,P=sl*_,D=P-(P-_),N=_-D,P=sl*he,j=P-(P-he),W=he-j,le=N*W-(re-D*j-N*j-D*W),_e=r*oe,P=sl*r,D=P-(P-r),N=r-D,P=sl*oe,j=P-(P-oe),W=oe-j,ye=N*W-(_e-D*j-N*j-D*W),H=le-ye,I=le-H,kl[0]=le-(H+I)+(I-ye),q=re+H,I=q-re,Z=re-(q-I)+(H-I),H=Z-_e,I=Z-H,kl[1]=Z-(H+I)+(I-_e),de=q+H,I=de-q,kl[2]=q-(de-I)+(H-I),kl[3]=de;const we=fk(4,Ng,4,kl,iz);re=ce*k,P=sl*ce,D=P-(P-ce),N=ce-D,P=sl*k,j=P-(P-k),W=k-j,le=N*W-(re-D*j-N*j-D*W),_e=xe*C,P=sl*xe,D=P-(P-xe),N=xe-D,P=sl*C,j=P-(P-C),W=C-j,ye=N*W-(_e-D*j-N*j-D*W),H=le-ye,I=le-H,kl[0]=le-(H+I)+(I-ye),q=re+H,I=q-re,Z=re-(q-I)+(H-I),H=Z-_e,I=Z-H,kl[1]=Z-(H+I)+(I-_e),de=q+H,I=de-q,kl[2]=q-(de-I)+(H-I),kl[3]=de;const Se=fk(we,iz,4,kl,oz);re=_*k,P=sl*_,D=P-(P-_),N=_-D,P=sl*k,j=P-(P-k),W=k-j,le=N*W-(re-D*j-N*j-D*W),_e=r*C,P=sl*r,D=P-(P-r),N=r-D,P=sl*C,j=P-(P-C),W=C-j,ye=N*W-(_e-D*j-N*j-D*W),H=le-ye,I=le-H,kl[0]=le-(H+I)+(I-ye),q=re+H,I=q-re,Z=re-(q-I)+(H-I),H=Z-_e,I=Z-H,kl[1]=Z-(H+I)+(I-_e),de=q+H,I=de-q,kl[2]=q-(de-I)+(H-I),kl[3]=de;const Pe=fk(Se,oz,4,kl,sz);return sz[Pe-1]}function Fq(e,t,n,s,a,u){const f=(t-u)*(n-a),_=(e-a)*(s-u),r=f-_,C=Math.abs(f+_);return Math.abs(r)>=Rq*C?r:-zq(e,t,n,s,a,u,C)}var k3={};const cv=(e,t)=>e.ll.x<=t.x&&t.x<=e.ur.x&&e.ll.y<=t.y&&t.y<=e.ur.y,KM=(e,t)=>{if(t.ur.x<e.ll.x||e.ur.x<t.ll.x||t.ur.y<e.ll.y||e.ur.y<t.ll.y)return null;const n=e.ll.x<t.ll.x?t.ll.x:e.ll.x,s=e.ur.x<t.ur.x?e.ur.x:t.ur.x,a=e.ll.y<t.ll.y?t.ll.y:e.ll.y,u=e.ur.y<t.ur.y?e.ur.y:t.ur.y;return{ll:{x:n,y:a},ur:{x:s,y:u}}};let $f=Number.EPSILON;$f===void 0&&($f=Math.pow(2,-52));const Nq=$f*$f,az=(e,t)=>{if(-$f<e&&e<$f&&-$f<t&&t<$f)return 0;const n=e-t;return n*n<Nq*e*t?0:e<t?-1:1};class Bq{constructor(){this.reset()}reset(){this.xRounder=new lz,this.yRounder=new lz}round(t,n){return{x:this.xRounder.round(t),y:this.yRounder.round(n)}}}class lz{constructor(){this.tree=new j2,this.round(0)}round(t){const n=this.tree.add(t),s=this.tree.prev(n);if(s!==null&&az(n.key,s.key)===0)return this.tree.remove(t),s.key;const a=this.tree.next(n);return a!==null&&az(n.key,a.key)===0?(this.tree.remove(t),a.key):t}}const Ax=new Bq,uS=(e,t)=>e.x*t.y-e.y*t.x,M3=(e,t)=>e.x*t.x+e.y*t.y,uz=(e,t,n)=>{const s=Fq(e.x,e.y,t.x,t.y,n.x,n.y);return s>0?-1:s<0?1:0},JS=e=>Math.sqrt(M3(e,e)),jq=(e,t,n)=>{const s={x:t.x-e.x,y:t.y-e.y},a={x:n.x-e.x,y:n.y-e.y};return uS(a,s)/JS(a)/JS(s)},Vq=(e,t,n)=>{const s={x:t.x-e.x,y:t.y-e.y},a={x:n.x-e.x,y:n.y-e.y};return M3(a,s)/JS(a)/JS(s)},cz=(e,t,n)=>t.y===0?null:{x:e.x+t.x/t.y*(n-e.y),y:n},dz=(e,t,n)=>t.x===0?null:{x:n,y:e.y+t.y/t.x*(n-e.x)},$q=(e,t,n,s)=>{if(t.x===0)return dz(n,s,e.x);if(s.x===0)return dz(e,t,n.x);if(t.y===0)return cz(n,s,e.y);if(s.y===0)return cz(e,t,n.y);const a=uS(t,s);if(a==0)return null;const u={x:n.x-e.x,y:n.y-e.y},f=uS(u,t)/a,_=uS(u,s)/a,r=e.x+_*t.x,C=n.x+f*s.x,k=e.y+_*t.y,I=n.y+f*s.y,P=(r+C)/2,D=(k+I)/2;return{x:P,y:D}};class ec{static compare(t,n){const s=ec.comparePoints(t.point,n.point);return s!==0?s:(t.point!==n.point&&t.link(n),t.isLeft!==n.isLeft?t.isLeft?1:-1:Jf.compare(t.segment,n.segment))}static comparePoints(t,n){return t.x<n.x?-1:t.x>n.x?1:t.y<n.y?-1:t.y>n.y?1:0}constructor(t,n){t.events===void 0?t.events=[this]:t.events.push(this),this.point=t,this.isLeft=n}link(t){if(t.point===this.point)throw new Error("Tried to link already linked events");const n=t.point.events;for(let s=0,a=n.length;s<a;s++){const u=n[s];this.point.events.push(u),u.point=this.point}this.checkForConsuming()}checkForConsuming(){const t=this.point.events.length;for(let n=0;n<t;n++){const s=this.point.events[n];if(s.segment.consumedBy===void 0)for(let a=n+1;a<t;a++){const u=this.point.events[a];u.consumedBy===void 0&&s.otherSE.point.events===u.otherSE.point.events&&s.segment.consume(u.segment)}}}getAvailableLinkedEvents(){const t=[];for(let n=0,s=this.point.events.length;n<s;n++){const a=this.point.events[n];a!==this&&!a.segment.ringOut&&a.segment.isInResult()&&t.push(a)}return t}getLeftmostComparator(t){const n=new Map,s=a=>{const u=a.otherSE;n.set(a,{sine:jq(this.point,t.point,u.point),cosine:Vq(this.point,t.point,u.point)})};return(a,u)=>{n.has(a)||s(a),n.has(u)||s(u);const{sine:f,cosine:_}=n.get(a),{sine:r,cosine:C}=n.get(u);return f>=0&&r>=0?_<C?1:_>C?-1:0:f<0&&r<0?_<C?-1:_>C?1:0:r<f?-1:r>f?1:0}}}let Uq=0;class Jf{static compare(t,n){const s=t.leftSE.point.x,a=n.leftSE.point.x,u=t.rightSE.point.x,f=n.rightSE.point.x;if(f<s)return 1;if(u<a)return-1;const _=t.leftSE.point.y,r=n.leftSE.point.y,C=t.rightSE.point.y,k=n.rightSE.point.y;if(s<a){if(r<_&&r<C)return 1;if(r>_&&r>C)return-1;const I=t.comparePoint(n.leftSE.point);if(I<0)return 1;if(I>0)return-1;const P=n.comparePoint(t.rightSE.point);return P!==0?P:-1}if(s>a){if(_<r&&_<k)return-1;if(_>r&&_>k)return 1;const I=n.comparePoint(t.leftSE.point);if(I!==0)return I;const P=t.comparePoint(n.rightSE.point);return P<0?1:P>0?-1:1}if(_<r)return-1;if(_>r)return 1;if(u<f){const I=n.comparePoint(t.rightSE.point);if(I!==0)return I}if(u>f){const I=t.comparePoint(n.rightSE.point);if(I<0)return 1;if(I>0)return-1}if(u!==f){const I=C-_,P=u-s,D=k-r,N=f-a;if(I>P&&D<N)return 1;if(I<P&&D>N)return-1}return u>f?1:u<f||C<k?-1:C>k?1:t.id<n.id?-1:t.id>n.id?1:0}constructor(t,n,s,a){this.id=++Uq,this.leftSE=t,t.segment=this,t.otherSE=n,this.rightSE=n,n.segment=this,n.otherSE=t,this.rings=s,this.windings=a}static fromRing(t,n,s){let a,u,f;const _=ec.comparePoints(t,n);if(_<0)a=t,u=n,f=1;else if(_>0)a=n,u=t,f=-1;else throw new Error(`Tried to create degenerate segment at [${t.x}, ${t.y}]`);const r=new ec(a,!0),C=new ec(u,!1);return new Jf(r,C,[s],[f])}replaceRightSE(t){this.rightSE=t,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){const t=this.leftSE.point.y,n=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:t<n?t:n},ur:{x:this.rightSE.point.x,y:t>n?t:n}}}vector(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}isAnEndpoint(t){return t.x===this.leftSE.point.x&&t.y===this.leftSE.point.y||t.x===this.rightSE.point.x&&t.y===this.rightSE.point.y}comparePoint(t){if(this.isAnEndpoint(t))return 0;const n=this.leftSE.point,s=this.rightSE.point,a=this.vector();if(n.x===s.x)return t.x===n.x?0:t.x<n.x?1:-1;const u=(t.y-n.y)/a.y,f=n.x+u*a.x;if(t.x===f)return 0;const _=(t.x-n.x)/a.x,r=n.y+_*a.y;return t.y===r?0:t.y<r?-1:1}getIntersection(t){const n=this.bbox(),s=t.bbox(),a=KM(n,s);if(a===null)return null;const u=this.leftSE.point,f=this.rightSE.point,_=t.leftSE.point,r=t.rightSE.point,C=cv(n,_)&&this.comparePoint(_)===0,k=cv(s,u)&&t.comparePoint(u)===0,I=cv(n,r)&&this.comparePoint(r)===0,P=cv(s,f)&&t.comparePoint(f)===0;if(k&&C)return P&&!I?f:!P&&I?r:null;if(k)return I&&u.x===r.x&&u.y===r.y?null:u;if(C)return P&&f.x===_.x&&f.y===_.y?null:_;if(P&&I)return null;if(P)return f;if(I)return r;const D=$q(u,this.vector(),_,t.vector());return D===null||!cv(a,D)?null:Ax.round(D.x,D.y)}split(t){const n=[],s=t.events!==void 0,a=new ec(t,!0),u=new ec(t,!1),f=this.rightSE;this.replaceRightSE(u),n.push(u),n.push(a);const _=new Jf(a,f,this.rings.slice(),this.windings.slice());return ec.comparePoints(_.leftSE.point,_.rightSE.point)>0&&_.swapEvents(),ec.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),s&&(a.checkForConsuming(),u.checkForConsuming()),n}swapEvents(){const t=this.rightSE;this.rightSE=this.leftSE,this.leftSE=t,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let n=0,s=this.windings.length;n<s;n++)this.windings[n]*=-1}consume(t){let n=this,s=t;for(;n.consumedBy;)n=n.consumedBy;for(;s.consumedBy;)s=s.consumedBy;const a=Jf.compare(n,s);if(a!==0){if(a>0){const u=n;n=s,s=u}if(n.prev===s){const u=n;n=s,s=u}for(let u=0,f=s.rings.length;u<f;u++){const _=s.rings[u],r=s.windings[u],C=n.rings.indexOf(_);C===-1?(n.rings.push(_),n.windings.push(r)):n.windings[C]+=r}s.rings=null,s.windings=null,s.consumedBy=n,s.leftSE.consumedBy=n.leftSE,s.rightSE.consumedBy=n.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{const t=this.prev.consumedBy||this.prev;this._beforeState=t.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;const t=this.beforeState();this._afterState={rings:t.rings.slice(0),windings:t.windings.slice(0),multiPolys:[]};const n=this._afterState.rings,s=this._afterState.windings,a=this._afterState.multiPolys;for(let _=0,r=this.rings.length;_<r;_++){const C=this.rings[_],k=this.windings[_],I=n.indexOf(C);I===-1?(n.push(C),s.push(k)):s[I]+=k}const u=[],f=[];for(let _=0,r=n.length;_<r;_++){if(s[_]===0)continue;const C=n[_],k=C.poly;if(f.indexOf(k)===-1)if(C.isExterior)u.push(k);else{f.indexOf(k)===-1&&f.push(k);const I=u.indexOf(C.poly);I!==-1&&u.splice(I,1)}}for(let _=0,r=u.length;_<r;_++){const C=u[_].multiPoly;a.indexOf(C)===-1&&a.push(C)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;const t=this.beforeState().multiPolys,n=this.afterState().multiPolys;switch(Yc.type){case"union":{const s=t.length===0,a=n.length===0;this._isInResult=s!==a;break}case"intersection":{let s,a;t.length<n.length?(s=t.length,a=n.length):(s=n.length,a=t.length),this._isInResult=a===Yc.numMultiPolys&&s<a;break}case"xor":{const s=Math.abs(t.length-n.length);this._isInResult=s%2===1;break}case"difference":{const s=a=>a.length===1&&a[0].isSubject;this._isInResult=s(t)!==s(n);break}default:throw new Error(`Unrecognized operation type found ${Yc.type}`)}return this._isInResult}}class hz{constructor(t,n,s){if(!Array.isArray(t)||t.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=n,this.isExterior=s,this.segments=[],typeof t[0][0]!="number"||typeof t[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const a=Ax.round(t[0][0],t[0][1]);this.bbox={ll:{x:a.x,y:a.y},ur:{x:a.x,y:a.y}};let u=a;for(let f=1,_=t.length;f<_;f++){if(typeof t[f][0]!="number"||typeof t[f][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");let r=Ax.round(t[f][0],t[f][1]);r.x===u.x&&r.y===u.y||(this.segments.push(Jf.fromRing(u,r,this)),r.x<this.bbox.ll.x&&(this.bbox.ll.x=r.x),r.y<this.bbox.ll.y&&(this.bbox.ll.y=r.y),r.x>this.bbox.ur.x&&(this.bbox.ur.x=r.x),r.y>this.bbox.ur.y&&(this.bbox.ur.y=r.y),u=r)}(a.x!==u.x||a.y!==u.y)&&this.segments.push(Jf.fromRing(u,a,this))}getSweepEvents(){const t=[];for(let n=0,s=this.segments.length;n<s;n++){const a=this.segments[n];t.push(a.leftSE),t.push(a.rightSE)}return t}}class Gq{constructor(t,n){if(!Array.isArray(t))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new hz(t[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let s=1,a=t.length;s<a;s++){const u=new hz(t[s],this,!1);u.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=u.bbox.ll.x),u.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=u.bbox.ll.y),u.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=u.bbox.ur.x),u.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=u.bbox.ur.y),this.interiorRings.push(u)}this.multiPoly=n}getSweepEvents(){const t=this.exteriorRing.getSweepEvents();for(let n=0,s=this.interiorRings.length;n<s;n++){const a=this.interiorRings[n].getSweepEvents();for(let u=0,f=a.length;u<f;u++)t.push(a[u])}return t}}class fz{constructor(t,n){if(!Array.isArray(t))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof t[0][0][0]=="number"&&(t=[t])}catch{}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(let s=0,a=t.length;s<a;s++){const u=new Gq(t[s],this);u.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=u.bbox.ll.x),u.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=u.bbox.ll.y),u.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=u.bbox.ur.x),u.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=u.bbox.ur.y),this.polys.push(u)}this.isSubject=n}getSweepEvents(){const t=[];for(let n=0,s=this.polys.length;n<s;n++){const a=this.polys[n].getSweepEvents();for(let u=0,f=a.length;u<f;u++)t.push(a[u])}return t}}class QS{static factory(t){const n=[];for(let s=0,a=t.length;s<a;s++){const u=t[s];if(!u.isInResult()||u.ringOut)continue;let f=null,_=u.leftSE,r=u.rightSE;const C=[_],k=_.point,I=[];for(;f=_,_=r,C.push(_),_.point!==k;)for(;;){const P=_.getAvailableLinkedEvents();if(P.length===0){const j=C[0].point,W=C[C.length-1].point;throw new Error(`Unable to complete output ring starting at [${j.x}, ${j.y}]. Last matching segment found ends at [${W.x}, ${W.y}].`)}if(P.length===1){r=P[0].otherSE;break}let D=null;for(let j=0,W=I.length;j<W;j++)if(I[j].point===_.point){D=j;break}if(D!==null){const j=I.splice(D)[0],W=C.splice(j.index);W.unshift(W[0].otherSE),n.push(new QS(W.reverse()));continue}I.push({index:C.length,point:_.point});const N=_.getLeftmostComparator(f);r=P.sort(N)[0].otherSE;break}n.push(new QS(C))}return n}constructor(t){this.events=t;for(let n=0,s=t.length;n<s;n++)t[n].segment.ringOut=this;this.poly=null}getGeom(){let t=this.events[0].point;const n=[t];for(let C=1,k=this.events.length-1;C<k;C++){const I=this.events[C].point,P=this.events[C+1].point;uz(I,t,P)!==0&&(n.push(I),t=I)}if(n.length===1)return null;const s=n[0],a=n[1];uz(s,t,a)===0&&n.shift(),n.push(n[0]);const u=this.isExteriorRing()?1:-1,f=this.isExteriorRing()?0:n.length-1,_=this.isExteriorRing()?n.length:-1,r=[];for(let C=f;C!=_;C+=u)r.push([n[C].x,n[C].y]);return r}isExteriorRing(){if(this._isExteriorRing===void 0){const t=this.enclosingRing();this._isExteriorRing=t?!t.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){let t=this.events[0];for(let a=1,u=this.events.length;a<u;a++){const f=this.events[a];ec.compare(t,f)>0&&(t=f)}let n=t.segment.prevInResult(),s=n?n.prevInResult():null;for(;;){if(!n)return null;if(!s)return n.ringOut;if(s.ringOut!==n.ringOut)return s.ringOut.enclosingRing()!==n.ringOut?n.ringOut:n.ringOut.enclosingRing();n=s.prevInResult(),s=n?n.prevInResult():null}}}class pz{constructor(t){this.exteriorRing=t,t.poly=this,this.interiorRings=[]}addInterior(t){this.interiorRings.push(t),t.poly=this}getGeom(){const t=[this.exteriorRing.getGeom()];if(t[0]===null)return null;for(let n=0,s=this.interiorRings.length;n<s;n++){const a=this.interiorRings[n].getGeom();a!==null&&t.push(a)}return t}}class Hq{constructor(t){this.rings=t,this.polys=this._composePolys(t)}getGeom(){const t=[];for(let n=0,s=this.polys.length;n<s;n++){const a=this.polys[n].getGeom();a!==null&&t.push(a)}return t}_composePolys(t){const n=[];for(let s=0,a=t.length;s<a;s++){const u=t[s];if(!u.poly)if(u.isExteriorRing())n.push(new pz(u));else{const f=u.enclosingRing();f.poly||n.push(new pz(f)),f.poly.addInterior(u)}}return n}}class Wq{constructor(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Jf.compare;this.queue=t,this.tree=new j2(n),this.segments=[]}process(t){const n=t.segment,s=[];if(t.consumedBy)return t.isLeft?this.queue.remove(t.otherSE):this.tree.remove(n),s;const a=t.isLeft?this.tree.add(n):this.tree.find(n);if(!a)throw new Error(`Unable to find segment #${n.id} [${n.leftSE.point.x}, ${n.leftSE.point.y}] -> [${n.rightSE.point.x}, ${n.rightSE.point.y}] in SweepLine tree.`);let u=a,f=a,_,r;for(;_===void 0;)u=this.tree.prev(u),u===null?_=null:u.key.consumedBy===void 0&&(_=u.key);for(;r===void 0;)f=this.tree.next(f),f===null?r=null:f.key.consumedBy===void 0&&(r=f.key);if(t.isLeft){let C=null;if(_){const I=_.getIntersection(n);if(I!==null&&(n.isAnEndpoint(I)||(C=I),!_.isAnEndpoint(I))){const P=this._splitSafely(_,I);for(let D=0,N=P.length;D<N;D++)s.push(P[D])}}let k=null;if(r){const I=r.getIntersection(n);if(I!==null&&(n.isAnEndpoint(I)||(k=I),!r.isAnEndpoint(I))){const P=this._splitSafely(r,I);for(let D=0,N=P.length;D<N;D++)s.push(P[D])}}if(C!==null||k!==null){let I=null;C===null?I=k:k===null?I=C:I=ec.comparePoints(C,k)<=0?C:k,this.queue.remove(n.rightSE),s.push(n.rightSE);const P=n.split(I);for(let D=0,N=P.length;D<N;D++)s.push(P[D])}s.length>0?(this.tree.remove(n),s.push(t)):(this.segments.push(n),n.prev=_)}else{if(_&&r){const C=_.getIntersection(r);if(C!==null){if(!_.isAnEndpoint(C)){const k=this._splitSafely(_,C);for(let I=0,P=k.length;I<P;I++)s.push(k[I])}if(!r.isAnEndpoint(C)){const k=this._splitSafely(r,C);for(let I=0,P=k.length;I<P;I++)s.push(k[I])}}}this.tree.remove(n)}return s}_splitSafely(t,n){this.tree.remove(t);const s=t.rightSE;this.queue.remove(s);const a=t.split(n);return a.push(s),t.consumedBy===void 0&&this.tree.add(t),a}}const mz=typeof process<"u"&&k3.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,qq=typeof process<"u"&&k3.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6;class Xq{run(t,n,s){Yc.type=t,Ax.reset();const a=[new fz(n,!0)];for(let I=0,P=s.length;I<P;I++)a.push(new fz(s[I],!1));if(Yc.numMultiPolys=a.length,Yc.type==="difference"){const I=a[0];let P=1;for(;P<a.length;)KM(a[P].bbox,I.bbox)!==null?P++:a.splice(P,1)}if(Yc.type==="intersection")for(let I=0,P=a.length;I<P;I++){const D=a[I];for(let N=I+1,j=a.length;N<j;N++)if(KM(D.bbox,a[N].bbox)===null)return[]}const u=new j2(ec.compare);for(let I=0,P=a.length;I<P;I++){const D=a[I].getSweepEvents();for(let N=0,j=D.length;N<j;N++)if(u.insert(D[N]),u.size>mz)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big).")}const f=new Wq(u);let _=u.size,r=u.pop();for(;r;){const I=r.key;if(u.size===_){const D=I.segment;throw new Error(`Unable to pop() ${I.isLeft?"left":"right"} SweepEvent [${I.point.x}, ${I.point.y}] from segment #${D.id} [${D.leftSE.point.x}, ${D.leftSE.point.y}] -> [${D.rightSE.point.x}, ${D.rightSE.point.y}] from queue.`)}if(u.size>mz)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big).");if(f.segments.length>qq)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments).");const P=f.process(I);for(let D=0,N=P.length;D<N;D++){const j=P[D];j.consumedBy===void 0&&u.insert(j)}_=u.size,r=u.pop()}Ax.reset();const C=QS.factory(f.segments);return new Hq(C).getGeom()}}const Yc=new Xq,Yq=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];return Yc.run("union",e,n)},Zq=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];return Yc.run("intersection",e,n)},Kq=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];return Yc.run("xor",e,n)},Jq=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];return Yc.run("difference",e,n)};var Lx={union:Yq,intersection:Zq,xor:Kq,difference:Jq};function P3(e){const t=[];if(ip(e,a=>{t.push(a.coordinates)}),t.length<2)throw new Error("Must have at least two features");const n=e.features[0].properties||{},s=Lx.difference(t[0],...t.slice(1));return s.length===0?null:s.length===1?y0(s[0],n):Mx(s,n)}var Qq=P3;function gz(e){if(!e)throw new Error("geojson is required");var t=[];return op(e,function(n){t.push(n)}),ya(t)}function eX(e,t={}){if(t=t||{},!B2(t))throw new Error("options is invalid");const{propertyName:n}=t;n3(e,"Polygon","dissolve");const s=[];if(n){const a={};rp(e,function(f){f.properties&&(Object.prototype.hasOwnProperty.call(a,f.properties[n])||(a[f.properties[n]]=[]),a[f.properties[n]].push(f))});const u=Object.keys(a);for(let f=0;f<u.length;f++){const _=Mx(Lx.union.apply(null,a[u[f]].map(function(r){return r.geometry.coordinates})));_&&_.properties&&(_.properties[n]=u[f],s.push(_))}}else return gz(Mx(Lx.union.apply(null,e.features.map(function(a){return a.geometry.coordinates}))));return gz(ya(s))}function A3(e,t={}){const n=[];if(ip(e,a=>{n.push(a.coordinates)}),n.length<2)throw new Error("Must specify at least 2 geometries");const s=Lx.intersection(n[0],...n.slice(1));return s.length===0?null:s.length===1?y0(s[0],t.properties):Mx(s,t.properties)}var L3=A3;function tX(e){var t=e[0],n=e[1],s=e[2],a=e[3],u=sm(e.slice(0,2),[s,n]),f=sm(e.slice(0,2),[t,a]);if(u>=f){var _=(n+a)/2;return[t,_-(s-t)/2,s,_+(s-t)/2]}else{var r=(t+s)/2;return[r-(a-n)/2,n,r+(a-n)/2,a]}}function nX(e,t){if(t=t??{},!B2(t))throw new Error("options is invalid");var n=t.precision,s=t.coordinates,a=t.mutate;if(n=n==null||isNaN(n)?6:n,s=s==null||isNaN(s)?3:s,!e)throw new Error("<geojson> is required");if(typeof n!="number")throw new Error("<precision> must be a number");if(typeof s!="number")throw new Error("<coordinates> must be a number");(a===!1||a===void 0)&&(e=JSON.parse(JSON.stringify(e)));var u=Math.pow(10,n);return GC(e,function(f){rX(f,u,s)}),e}function rX(e,t,n){e.length>n&&e.splice(n,e.length);for(var s=0;s<e.length;s++)e[s]=Math.round(e[s]*t)/t;return e}function iX(e,t){if(!e)throw new Error("line is required");if(!t)throw new Error("splitter is required");var n=A5(e),s=A5(t);if(n!=="LineString")throw new Error("line must be LineString");if(s==="FeatureCollection")throw new Error("splitter cannot be a FeatureCollection");if(s==="GeometryCollection")throw new Error("splitter cannot be a GeometryCollection");var a=nX(t,{precision:7});switch(s){case"Point":return JM(e,a);case"MultiPoint":return yz(e,a);case"LineString":case"MultiLineString":case"Polygon":case"MultiPolygon":return yz(e,_0(e,a,{ignoreSelfIntersections:!0}))}}function yz(e,t){var n=[],s=l3();return op(t,function(a){if(n.forEach(function(_,r){_.id=r}),!n.length)n=JM(e,a).features,n.forEach(function(_){_.bbox||(_.bbox=tX(dl(_)))}),s.load(ya(n));else{var u=s.search(a);if(u.features.length){var f=R3(a,u);n=n.filter(function(_){return _.id!==f.id}),s.remove(f),rp(JM(f,a),function(_){n.push(_),s.insert(_)})}}}),ya(n)}function JM(e,t){var n=[],s=gm(e)[0],a=gm(e)[e.geometry.coordinates.length-1];if(pk(s,$d(t))||pk(a,$d(t)))return ya([e]);var u=l3(),f=SW(e);u.load(f);var _=u.search(t);if(!_.features.length)return ya([e]);var r=R3(t,_),C=[s],k=YH(f,function(I,P,D){var N=gm(P)[1],j=$d(t);return D===r.id?(I.push(j),n.push(qc(I)),pk(j,N)?[j]:[j,N]):(I.push(N),I)},C);return k.length>1&&n.push(qc(k)),ya(n)}function R3(e,t){if(!t.features.length)throw new Error("lines must contain features");if(t.features.length===1)return t.features[0];var n,s=1/0;return rp(t,function(a){var u=LW(a,e),f=u.properties.dist;f<s&&(n=a,s=f)}),n}function pk(e,t){return e[0]===t[0]&&e[1]===t[1]}var oX=iX;function sX(e,t){const n=[];return rp(e,function(s){let a=!1;if(s.geometry.type==="Point")ip(t,function(f){ru(s,f)&&(a=!0)}),a&&n.push(s);else if(s.geometry.type==="MultiPoint"){var u=[];ip(t,function(f){GC(s,function(_){ru(_,f)&&(a=!0,u.push(_))})}),a&&n.push(qH(u,s.properties))}else throw new Error("Input geometry must be a Point or MultiPoint")}),ya(n)}var aX=sX;function O3(e,t={}){const n=[];if(ip(e,a=>{n.push(a.coordinates)}),n.length<2)throw new Error("Must have at least 2 geometries");const s=Lx.union(n[0],...n.slice(1));return s.length===0?null:s.length===1?y0(s[0],t.properties):Mx(s,t.properties)}var lX=O3;function _z(e){return function(){return e}}function uX(e){return e[0]}function cX(e){return e[1]}function eC(){this._=null}function HC(e){e.U=e.C=e.L=e.R=e.P=e.N=null}eC.prototype={constructor:eC,insert:function(e,t){var n,s,a;if(e){if(t.P=e,t.N=e.N,e.N&&(e.N.P=t),e.N=t,e.R){for(e=e.R;e.L;)e=e.L;e.L=t}else e.R=t;n=e}else this._?(e=vz(this._),t.P=null,t.N=e,e.P=e.L=t,n=e):(t.P=t.N=null,this._=t,n=null);for(t.L=t.R=null,t.U=n,t.C=!0,e=t;n&&n.C;)s=n.U,n===s.L?(a=s.R,a&&a.C?(n.C=a.C=!1,s.C=!0,e=s):(e===n.R&&(dv(this,n),e=n,n=e.U),n.C=!1,s.C=!0,hv(this,s))):(a=s.L,a&&a.C?(n.C=a.C=!1,s.C=!0,e=s):(e===n.L&&(hv(this,n),e=n,n=e.U),n.C=!1,s.C=!0,dv(this,s))),n=e.U;this._.C=!1},remove:function(e){e.N&&(e.N.P=e.P),e.P&&(e.P.N=e.N),e.N=e.P=null;var t=e.U,n,s=e.L,a=e.R,u,f;if(s?a?u=vz(a):u=s:u=a,t?t.L===e?t.L=u:t.R=u:this._=u,s&&a?(f=u.C,u.C=e.C,u.L=s,s.U=u,u!==a?(t=u.U,u.U=e.U,e=u.R,t.L=e,u.R=a,a.U=u):(u.U=t,t=u,e=u.R)):(f=e.C,e=u),e&&(e.U=t),!f){if(e&&e.C){e.C=!1;return}do{if(e===this._)break;if(e===t.L){if(n=t.R,n.C&&(n.C=!1,t.C=!0,dv(this,t),n=t.R),n.L&&n.L.C||n.R&&n.R.C){(!n.R||!n.R.C)&&(n.L.C=!1,n.C=!0,hv(this,n),n=t.R),n.C=t.C,t.C=n.R.C=!1,dv(this,t),e=this._;break}}else if(n=t.L,n.C&&(n.C=!1,t.C=!0,hv(this,t),n=t.L),n.L&&n.L.C||n.R&&n.R.C){(!n.L||!n.L.C)&&(n.R.C=!1,n.C=!0,dv(this,n),n=t.L),n.C=t.C,t.C=n.L.C=!1,hv(this,t),e=this._;break}n.C=!0,e=t,t=t.U}while(!e.C);e&&(e.C=!1)}}};function dv(e,t){var n=t,s=t.R,a=n.U;a?a.L===n?a.L=s:a.R=s:e._=s,s.U=a,n.U=s,n.R=s.L,n.R&&(n.R.U=n),s.L=n}function hv(e,t){var n=t,s=t.L,a=n.U;a?a.L===n?a.L=s:a.R=s:e._=s,s.U=a,n.U=s,n.L=s.R,n.L&&(n.L.U=n),s.R=n}function vz(e){for(;e.L;)e=e.L;return e}function Uv(e,t,n,s){var a=[null,null],u=ll.push(a)-1;return a.left=e,a.right=t,n&&tC(a,e,t,n),s&&tC(a,t,e,s),wu[e.index].halfedges.push(u),wu[t.index].halfedges.push(u),a}function fv(e,t,n){var s=[t,n];return s.left=e,s}function tC(e,t,n,s){!e[0]&&!e[1]?(e[0]=s,e.left=t,e.right=n):e.left===n?e[1]=s:e[0]=s}function dX(e,t,n,s,a){var u=e[0],f=e[1],_=u[0],r=u[1],C=f[0],k=f[1],I=0,P=1,D=C-_,N=k-r,j;if(j=t-_,!(!D&&j>0)){if(j/=D,D<0){if(j<I)return;j<P&&(P=j)}else if(D>0){if(j>P)return;j>I&&(I=j)}if(j=s-_,!(!D&&j<0)){if(j/=D,D<0){if(j>P)return;j>I&&(I=j)}else if(D>0){if(j<I)return;j<P&&(P=j)}if(j=n-r,!(!N&&j>0)){if(j/=N,N<0){if(j<I)return;j<P&&(P=j)}else if(N>0){if(j>P)return;j>I&&(I=j)}if(j=a-r,!(!N&&j<0)){if(j/=N,N<0){if(j>P)return;j>I&&(I=j)}else if(N>0){if(j<I)return;j<P&&(P=j)}return!(I>0)&&!(P<1)||(I>0&&(e[0]=[_+I*D,r+I*N]),P<1&&(e[1]=[_+P*D,r+P*N])),!0}}}}}function hX(e,t,n,s,a){var u=e[1];if(u)return!0;var f=e[0],_=e.left,r=e.right,C=_[0],k=_[1],I=r[0],P=r[1],D=(C+I)/2,N=(k+P)/2,j,W;if(P===k){if(D<t||D>=s)return;if(C>I){if(!f)f=[D,n];else if(f[1]>=a)return;u=[D,a]}else{if(!f)f=[D,a];else if(f[1]<n)return;u=[D,n]}}else if(j=(C-I)/(P-k),W=N-j*D,j<-1||j>1)if(C>I){if(!f)f=[(n-W)/j,n];else if(f[1]>=a)return;u=[(a-W)/j,a]}else{if(!f)f=[(a-W)/j,a];else if(f[1]<n)return;u=[(n-W)/j,n]}else if(k<P){if(!f)f=[t,j*t+W];else if(f[0]>=s)return;u=[s,j*s+W]}else{if(!f)f=[s,j*s+W];else if(f[0]<t)return;u=[t,j*t+W]}return e[0]=f,e[1]=u,!0}function fX(e,t,n,s){for(var a=ll.length,u;a--;)(!hX(u=ll[a],e,t,n,s)||!dX(u,e,t,n,s)||!(Math.abs(u[0][0]-u[1][0])>$o||Math.abs(u[0][1]-u[1][1])>$o))&&delete ll[a]}function pX(e){return wu[e.index]={site:e,halfedges:[]}}function mX(e,t){var n=e.site,s=t.left,a=t.right;return n===a&&(a=s,s=n),a?Math.atan2(a[1]-s[1],a[0]-s[0]):(n===s?(s=t[1],a=t[0]):(s=t[0],a=t[1]),Math.atan2(s[0]-a[0],a[1]-s[1]))}function D3(e,t){return t[+(t.left!==e.site)]}function gX(e,t){return t[+(t.left===e.site)]}function yX(){for(var e=0,t=wu.length,n,s,a,u;e<t;++e)if((n=wu[e])&&(u=(s=n.halfedges).length)){var f=new Array(u),_=new Array(u);for(a=0;a<u;++a)f[a]=a,_[a]=mX(n,ll[s[a]]);for(f.sort(function(r,C){return _[C]-_[r]}),a=0;a<u;++a)_[a]=s[f[a]];for(a=0;a<u;++a)s[a]=_[a]}}function _X(e,t,n,s){var a=wu.length,u,f,_,r,C,k,I,P,D,N,j,W,H=!0;for(u=0;u<a;++u)if(f=wu[u]){for(_=f.site,C=f.halfedges,r=C.length;r--;)ll[C[r]]||C.splice(r,1);for(r=0,k=C.length;r<k;)N=gX(f,ll[C[r]]),j=N[0],W=N[1],I=D3(f,ll[C[++r%k]]),P=I[0],D=I[1],(Math.abs(j-P)>$o||Math.abs(W-D)>$o)&&(C.splice(r,0,ll.push(fv(_,N,Math.abs(j-e)<$o&&s-W>$o?[e,Math.abs(P-e)<$o?D:s]:Math.abs(W-s)<$o&&n-j>$o?[Math.abs(D-s)<$o?P:n,s]:Math.abs(j-n)<$o&&W-t>$o?[n,Math.abs(P-n)<$o?D:t]:Math.abs(W-t)<$o&&j-e>$o?[Math.abs(D-t)<$o?P:e,t]:null))-1),++k);k&&(H=!1)}if(H){var q,Z,re,le=1/0;for(u=0,H=null;u<a;++u)(f=wu[u])&&(_=f.site,q=_[0]-e,Z=_[1]-t,re=q*q+Z*Z,re<le&&(le=re,H=f));if(H){var _e=[e,t],ye=[e,s],de=[n,s],ce=[n,t];H.halfedges.push(ll.push(fv(_=H.site,_e,ye))-1,ll.push(fv(_,ye,de))-1,ll.push(fv(_,de,ce))-1,ll.push(fv(_,ce,_e))-1)}}for(u=0;u<a;++u)(f=wu[u])&&(f.halfedges.length||delete wu[u])}var z3=[],V2;function vX(){HC(this),this.x=this.y=this.arc=this.site=this.cy=null}function vy(e){var t=e.P,n=e.N;if(!(!t||!n)){var s=t.site,a=e.site,u=n.site;if(s!==u){var f=a[0],_=a[1],r=s[0]-f,C=s[1]-_,k=u[0]-f,I=u[1]-_,P=2*(r*I-C*k);if(!(P>=-CX)){var D=r*r+C*C,N=k*k+I*I,j=(I*D-C*N)/P,W=(r*N-k*D)/P,H=z3.pop()||new vX;H.arc=e,H.site=a,H.x=j+f,H.y=(H.cy=W+_)+Math.sqrt(j*j+W*W),e.circle=H;for(var q=null,Z=Rx._;Z;)if(H.y<Z.y||H.y===Z.y&&H.x<=Z.x)if(Z.L)Z=Z.L;else{q=Z.P;break}else if(Z.R)Z=Z.R;else{q=Z;break}Rx.insert(q,H),q||(V2=H)}}}}function Ly(e){var t=e.circle;t&&(t.P||(V2=t.N),Rx.remove(t),z3.push(t),HC(t),e.circle=null)}var F3=[];function xX(){HC(this),this.edge=this.site=this.circle=null}function xz(e){var t=F3.pop()||new xX;return t.site=e,t}function mk(e){Ly(e),Ry.remove(e),F3.push(e),HC(e)}function bX(e){var t=e.circle,n=t.x,s=t.cy,a=[n,s],u=e.P,f=e.N,_=[e];mk(e);for(var r=u;r.circle&&Math.abs(n-r.circle.x)<$o&&Math.abs(s-r.circle.cy)<$o;)u=r.P,_.unshift(r),mk(r),r=u;_.unshift(r),Ly(r);for(var C=f;C.circle&&Math.abs(n-C.circle.x)<$o&&Math.abs(s-C.circle.cy)<$o;)f=C.N,_.push(C),mk(C),C=f;_.push(C),Ly(C);var k=_.length,I;for(I=1;I<k;++I)C=_[I],r=_[I-1],tC(C.edge,r.site,C.site,a);r=_[0],C=_[k-1],C.edge=Uv(r.site,C.site,null,a),vy(r),vy(C)}function wX(e){for(var t=e[0],n=e[1],s,a,u,f,_=Ry._;_;)if(u=N3(_,n)-t,u>$o)_=_.L;else if(f=t-SX(_,n),f>$o){if(!_.R){s=_;break}_=_.R}else{u>-$o?(s=_.P,a=_):f>-$o?(s=_,a=_.N):s=a=_;break}pX(e);var r=xz(e);if(Ry.insert(s,r),!(!s&&!a)){if(s===a){Ly(s),a=xz(s.site),Ry.insert(r,a),r.edge=a.edge=Uv(s.site,r.site),vy(s),vy(a);return}if(!a){r.edge=Uv(s.site,r.site);return}Ly(s),Ly(a);var C=s.site,k=C[0],I=C[1],P=e[0]-k,D=e[1]-I,N=a.site,j=N[0]-k,W=N[1]-I,H=2*(P*W-D*j),q=P*P+D*D,Z=j*j+W*W,re=[(W*q-D*Z)/H+k,(P*Z-j*q)/H+I];tC(a.edge,C,N,re),r.edge=Uv(C,e,null,re),a.edge=Uv(e,N,null,re),vy(s),vy(a)}}function N3(e,t){var n=e.site,s=n[0],a=n[1],u=a-t;if(!u)return s;var f=e.P;if(!f)return-1/0;n=f.site;var _=n[0],r=n[1],C=r-t;if(!C)return _;var k=_-s,I=1/u-1/C,P=k/C;return I?(-P+Math.sqrt(P*P-2*I*(k*k/(-2*C)-r+C/2+a-u/2)))/I+s:(s+_)/2}function SX(e,t){var n=e.N;if(n)return N3(n,t);var s=e.site;return s[1]===t?s[0]:1/0}var $o=1e-6,CX=1e-12,Ry,wu,Rx,ll;function EX(e,t,n){return(e[0]-n[0])*(t[1]-e[1])-(e[0]-t[0])*(n[1]-e[1])}function TX(e,t){return t[1]-e[1]||t[0]-e[0]}function QM(e,t){var n=e.sort(TX).pop(),s,a,u;for(ll=[],wu=new Array(e.length),Ry=new eC,Rx=new eC;;)if(u=V2,n&&(!u||n[1]<u.y||n[1]===u.y&&n[0]<u.x))(n[0]!==s||n[1]!==a)&&(wX(n),s=n[0],a=n[1]),n=e.pop();else if(u)bX(u.arc);else break;if(yX(),t){var f=+t[0][0],_=+t[0][1],r=+t[1][0],C=+t[1][1];fX(f,_,r,C),_X(f,_,r,C)}this.edges=ll,this.cells=wu,Ry=Rx=ll=wu=null}QM.prototype={constructor:QM,polygons:function(){var e=this.edges;return this.cells.map(function(t){var n=t.halfedges.map(function(s){return D3(t,e[s])});return n.data=t.site.data,n})},triangles:function(){var e=[],t=this.edges;return this.cells.forEach(function(n,s){if(_=(u=n.halfedges).length)for(var a=n.site,u,f=-1,_,r,C=t[u[_-1]],k=C.left===a?C.right:C.left;++f<_;)r=k,C=t[u[f]],k=C.left===a?C.right:C.left,r&&k&&s<r.index&&s<k.index&&EX(a,r,k)<0&&e.push([a.data,r.data,k.data])}),e},links:function(){return this.edges.filter(function(e){return e.right}).map(function(e){return{source:e.left.data,target:e.right.data}})},find:function(e,t,n){for(var s=this,a,u=s._found||0,f=s.cells.length,_;!(_=s.cells[u]);)if(++u>=f)return null;var r=e-_.site[0],C=t-_.site[1],k=r*r+C*C;do _=s.cells[a=u],u=null,_.halfedges.forEach(function(I){var P=s.edges[I],D=P.left;if(!((D===_.site||!D)&&!(D=P.right))){var N=e-D[0],j=t-D[1],W=N*N+j*j;W<k&&(k=W,u=D.index)}});while(u!==null);return s._found=a,n==null||k<=n*n?_.site:null}};function IX(){var e=uX,t=cX,n=null;function s(a){return new QM(a.map(function(u,f){var _=[Math.round(e(u,f,a)/$o)*$o,Math.round(t(u,f,a)/$o)*$o];return _.index=f,_.data=u,_}),n)}return s.polygons=function(a){return s(a).polygons()},s.links=function(a){return s(a).links()},s.triangles=function(a){return s(a).triangles()},s.x=function(a){return arguments.length?(e=typeof a=="function"?a:_z(+a),s):e},s.y=function(a){return arguments.length?(t=typeof a=="function"?a:_z(+a),s):t},s.extent=function(a){return arguments.length?(n=a==null?null:[[+a[0][0],+a[0][1]],[+a[1][0],+a[1][1]]],s):n&&[[n[0][0],n[0][1]],[n[1][0],n[1][1]]]},s.size=function(a){return arguments.length?(n=a==null?null:[[0,0],[+a[0],+a[1]]],s):n&&[n[1][0]-n[0][0],n[1][1]-n[0][1]]},s}function kX(e){return e=e.slice(),e.push(e[0]),y0([e])}function MX(e,t){if(t=t||{},!B2(t))throw new Error("options is invalid");const n=t.bbox||[-180,-85,180,85];if(!e)throw new Error("points is required");if(!Array.isArray(n))throw new Error("bbox is invalid");return n3(e,"Point","points"),ya(IX().x(s=>s.geometry.coordinates[0]).y(s=>s.geometry.coordinates[1]).extent([[n[0],n[1]],[n[2],n[3]]]).polygons(e.features).map(function(s,a){return Object.assign(kX(s),{properties:I3(e.features[a].properties)})}))}const B3=X.createContext(void 0),j3=X.createContext(void 0),V3=X.createContext(void 0),PX=({children:e})=>{const[t,n]=X.useState([]),[s,a]=X.useState("mapbox://styles/mapbox/light-v11"),u=X.useRef(null),f=X.useCallback(ce=>{u.current=ce},[]),_=X.useRef([]),r=X.useCallback(()=>{_.current=t.map(ce=>({id:ce.id,visible:ce.visible}))},[t]),C=X.useCallback(()=>{n(ce=>ce.map(oe=>{const xe=_.current.find(he=>he.id===oe.id);return xe?{...oe,visible:xe.visible}:oe}))},[]),k=X.useMemo(()=>({layers:t,baseMap:s}),[t,s]);X.useEffect(()=>{window.layers=t},[t]);const I=X.useCallback((ce,oe,xe,he,Ee,se)=>{const we=ce.features.length>0?ce.features[0].geometry.type:"Unknown",Se={id:J6(),data:ce,color:oe||nd(),name:xe,visible:!0,opacity:Ee!==void 0?Ee:we==="Polygon"||we==="MultiPolygon"?.9:1,type:we==="Point"?"Point":we==="LineString"||we==="MultiLineString"?"LineString":we==="Polygon"||we==="MultiPolygon"?"Polygon":"Unknown",isVoronoi:se||!1};n(he?Pe=>[Se,...Pe]:Pe=>[...Pe,Se])},[]),P=X.useCallback(ce=>{n(oe=>oe.filter(xe=>xe.id!==ce))},[]),D=X.useCallback(()=>{n([])},[]),N=X.useCallback(ce=>{a(ce)},[]),j=X.useCallback(ce=>{const oe=u.current;if(!oe){console.error("Map instance not found");return}const xe=t.find(he=>he.id===ce);if(!xe||!xe.data.features||xe.data.features.length===0){console.warn(`Layer ${ce} does not have valid features.`);return}try{const[he,Ee,se,we]=dl(xe.data);oe.fitBounds([[he,Ee],[se,we]],{padding:20})}catch(he){console.error("Error calculating bbox:",he)}},[t]),W=X.useCallback(ce=>{n(oe=>oe.map(xe=>xe.id===ce?{...xe,visible:!xe.visible}:xe))},[]),H=X.useCallback(()=>{n(ce=>{const oe=ce.every(xe=>xe.visible);return ce.map(xe=>({...xe,visible:!oe}))})},[]),q=X.useCallback((ce,oe,xe,he)=>{n(Ee=>Ee.map(se=>se.id===ce?{...se,color:oe,opacity:xe,name:he??se.name}:se))},[]),[Z,re]=X.useState([]),le=X.useCallback((ce,oe,xe)=>{re(he=>{const Ee=t.findIndex(Se=>Se.id===ce),se=he.length>0?t.findIndex(Se=>Se.id===he[he.length-1]):-1;let we=[];if(xe&&he.length>0){const Se=t.slice(Math.min(Ee,se),Math.max(Ee,se)+1).map(Pe=>Pe.id);we=Array.from(new Set([...he,...Se]))}else oe?he.includes(ce)?we=he.filter(Se=>Se!==ce):we=[...he,ce]:we=[ce];return we})},[t]),_e=ce=>{re(oe=>oe.filter(xe=>xe!==ce))},ye=X.useMemo(()=>({addLayer:I,setLayers:n,removeLayer:P,setBaseMap:N,toggleVisibility:W,toggleAllLayersVisibility:H,updateLayerStyle:q,clearLayers:D,refreshLayerVisibilityWithState:C,saveLayerVisibilityState:r,zoomToLayer:j,setMapInstance:f}),[I,n,P,N,W,H,q,D,C,r,j,f]),de=X.useMemo(()=>({selectedLayerIds:Z,selectLayer:le,deselectLayer:_e}),[Z,le,_e]);return K.jsx(B3.Provider,{value:k,children:K.jsx(j3.Provider,{value:ye,children:K.jsx(V3.Provider,{value:de,children:e})})})},Lu=()=>{const e=X.useContext(B3);if(!e)throw new Error("useLayerDataContext must be used within a LayerProvider");return e},_c=()=>{const e=X.useContext(j3);if(!e)throw new Error("useLayerActionContext must be used within a LayerProvider");return e},$3=()=>{const e=X.useContext(V3);if(!e)throw new Error("useSelectedLayerContext must be used within a LayerProvider");return e};Z6.accessToken="pk.eyJ1IjoicGVkZXJ1IiwiYSI6ImNtMW91NDQzNTE1aTQya3NlbW53NHJyemoifQ.BrN-n1v6MowblO_OayDQFw";const AX=({style:e,drawingMode:t,onDrawingFinish:n})=>{const{layers:s,baseMap:a}=Lu(),{removeLayer:u,refreshLayerVisibilityWithState:f,saveLayerVisibilityState:_,setMapInstance:r}=_c(),C=X.useRef(null),k=X.useRef(null),I=X.useRef(null),P=X.useRef([]),[D,N]=X.useState(!1);X.useEffect(()=>{if(C.current){const de=new Z6.Map({container:C.current,style:a,center:[10.28,63.4],zoom:10});k.current=de,r(de);const ce=new jH({displayControlsDefault:!1,controls:{point:!1,line_string:!1,polygon:!1,trash:!1}});return I.current=ce,de.addControl(ce,"top-right"),de.on("load",()=>{N(!0),f(),W(s)}),de.on("draw.create",ye),de.on("draw.update",ye),de.on("draw.delete",ye),()=>{var oe;(oe=k.current)==null||oe.remove(),k.current=null}}},[a]),X.useEffect(()=>{if(k.current){const de=k.current,ce=()=>{W(s)};return de.on("styledata",ce),()=>{de.off("styledata",ce)}}},[a]);const j=()=>k.current!==null&&k.current.isStyleLoaded();X.useEffect(()=>{_()},[a]),X.useEffect(()=>{D&&W(s)},[s,D]);const W=de=>{if(!j()||!k.current)return;const ce=k.current;_e(de),de.forEach(oe=>{const{type:xe,paint:he}=re(oe);ce.getSource(oe.id)?(ce.getSource(oe.id).setData(oe.data),Z(oe,xe)):(ce.addSource(oe.id,{type:"geojson",data:oe.data}),ce.addLayer({id:oe.id,type:xe,source:oe.id,paint:he}),P.current.push(oe.id)),ce.setLayoutProperty(oe.id,"visibility",le(oe))}),H(de)},H=(de,ce=0)=>{if(!k.current)return;const oe=k.current;de.every(he=>oe.getLayer(he.id))?q(de):ce<10&&setTimeout(()=>H(de,ce+1),100)},q=de=>{if(!k.current)return;const ce=k.current,oe=[...de].reverse();oe.forEach((xe,he)=>{var we;const Ee=xe.id,se=(we=oe[he+1])==null?void 0:we.id;ce.getLayer(Ee)&&ce.moveLayer(Ee,se||void 0)})},Z=(de,ce)=>{if(!k.current)return;const oe=k.current;switch(ce){case"fill":oe.setPaintProperty(de.id,"fill-color",de.color),oe.setPaintProperty(de.id,"fill-opacity",de.opacity),oe.setPaintProperty(de.id,"fill-outline-color",de.isVoronoi?"black":de.color);break;case"line":oe.setPaintProperty(de.id,"line-color",de.color),oe.setPaintProperty(de.id,"line-opacity",de.opacity);break;case"circle":oe.setPaintProperty(de.id,"circle-color",de.color),oe.setPaintProperty(de.id,"circle-opacity",de.opacity);break}},re=de=>{var oe;const ce=(oe=de.data.features[0])==null?void 0:oe.geometry.type;switch(ce){case"Point":case"MultiPoint":return{type:"circle",paint:{"circle-radius":5,"circle-color":de.color,"circle-opacity":1}};case"LineString":case"MultiLineString":return{type:"line",paint:{"line-color":de.color,"line-width":2,"line-opacity":1}};case"Polygon":case"MultiPolygon":return{type:"fill",paint:{"fill-color":de.color,"fill-opacity":.9,"fill-outline-color":de.isVoronoi?"black":de.color}};default:throw new Error(`Unsupported geometry type: ${ce}`)}},le=de=>de.visible?"visible":"none",_e=de=>{if(!k.current)return;const ce=k.current,oe=de.map(xe=>xe.id);P.current.forEach(xe=>{oe.includes(xe)||(ce.getLayer(xe)&&ce.removeLayer(xe),ce.getSource(xe)&&ce.removeSource(xe),u(xe),P.current=P.current.filter(he=>he!==xe))})};X.useEffect(()=>{D&&W(s)},[s,D]),X.useEffect(()=>{if(!k.current||!I.current)return;const de=I.current;switch(t){case"Point":de.changeMode("draw_point");break;case"LineString":de.changeMode("draw_line_string");break;case"Polygon":de.changeMode("draw_polygon");break;default:de.changeMode("simple_select");break}},[t]);const ye=()=>{if(!I.current)return;const ce=I.current.getAll();ce.features.length>0&&n(ce)};return K.jsx("div",{ref:C,className:"h-full w-full",style:e})},Ox={black:"#000",white:"#fff"},Bg={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},jg={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},Vg={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},$g={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},Ug={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},pv={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},LX={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"};function zh(e,...t){const n=new URL(`https://mui.com/production-error/?code=${e}`);return t.forEach(s=>n.searchParams.append("args[]",s)),`Minified MUI error #${e}; visit ${n} for the full message.`}const r1="$$material";function Ge(){return Ge=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)({}).hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Ge.apply(null,arguments)}function U3(e){var t=Object.create(null);return function(n){return t[n]===void 0&&(t[n]=e(n)),t[n]}}var RX=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,OX=U3(function(e){return RX.test(e)||e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)<91}),DX=!1;function zX(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}function FX(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),e.nonce!==void 0&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}var NX=function(){function e(n){var s=this;this._insertTag=function(a){var u;s.tags.length===0?s.insertionPoint?u=s.insertionPoint.nextSibling:s.prepend?u=s.container.firstChild:u=s.before:u=s.tags[s.tags.length-1].nextSibling,s.container.insertBefore(a,u),s.tags.push(a)},this.isSpeedy=n.speedy===void 0?!DX:n.speedy,this.tags=[],this.ctr=0,this.nonce=n.nonce,this.key=n.key,this.container=n.container,this.prepend=n.prepend,this.insertionPoint=n.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(s){s.forEach(this._insertTag)},t.insert=function(s){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(FX(this));var a=this.tags[this.tags.length-1];if(this.isSpeedy){var u=zX(a);try{u.insertRule(s,u.cssRules.length)}catch{}}else a.appendChild(document.createTextNode(s));this.ctr++},t.flush=function(){this.tags.forEach(function(s){var a;return(a=s.parentNode)==null?void 0:a.removeChild(s)}),this.tags=[],this.ctr=0},e}(),al="-ms-",nC="-moz-",bo="-webkit-",G3="comm",$2="rule",U2="decl",BX="@import",H3="@keyframes",jX="@layer",VX=Math.abs,WC=String.fromCharCode,$X=Object.assign;function UX(e,t){return ja(e,0)^45?(((t<<2^ja(e,0))<<2^ja(e,1))<<2^ja(e,2))<<2^ja(e,3):0}function W3(e){return e.trim()}function GX(e,t){return(e=t.exec(e))?e[0]:e}function wo(e,t,n){return e.replace(t,n)}function eP(e,t){return e.indexOf(t)}function ja(e,t){return e.charCodeAt(t)|0}function Dx(e,t,n){return e.slice(t,n)}function Ad(e){return e.length}function G2(e){return e.length}function Ew(e,t){return t.push(e),e}function HX(e,t){return e.map(t).join("")}var qC=1,Jy=1,q3=0,su=0,aa=0,x0="";function XC(e,t,n,s,a,u,f){return{value:e,root:t,parent:n,type:s,props:a,children:u,line:qC,column:Jy,length:f,return:""}}function mv(e,t){return $X(XC("",null,null,"",null,null,0),e,{length:-e.length},t)}function WX(){return aa}function qX(){return aa=su>0?ja(x0,--su):0,Jy--,aa===10&&(Jy=1,qC--),aa}function Iu(){return aa=su<q3?ja(x0,su++):0,Jy++,aa===10&&(Jy=1,qC++),aa}function Ud(){return ja(x0,su)}function cS(){return su}function i1(e,t){return Dx(x0,e,t)}function zx(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function X3(e){return qC=Jy=1,q3=Ad(x0=e),su=0,[]}function Y3(e){return x0="",e}function dS(e){return W3(i1(su-1,tP(e===91?e+2:e===40?e+1:e)))}function XX(e){for(;(aa=Ud())&&aa<33;)Iu();return zx(e)>2||zx(aa)>3?"":" "}function YX(e,t){for(;--t&&Iu()&&!(aa<48||aa>102||aa>57&&aa<65||aa>70&&aa<97););return i1(e,cS()+(t<6&&Ud()==32&&Iu()==32))}function tP(e){for(;Iu();)switch(aa){case e:return su;case 34:case 39:e!==34&&e!==39&&tP(aa);break;case 40:e===41&&tP(e);break;case 92:Iu();break}return su}function ZX(e,t){for(;Iu()&&e+aa!==57;)if(e+aa===84&&Ud()===47)break;return"/*"+i1(t,su-1)+"*"+WC(e===47?e:Iu())}function KX(e){for(;!zx(Ud());)Iu();return i1(e,su)}function JX(e){return Y3(hS("",null,null,null,[""],e=X3(e),0,[0],e))}function hS(e,t,n,s,a,u,f,_,r){for(var C=0,k=0,I=f,P=0,D=0,N=0,j=1,W=1,H=1,q=0,Z="",re=a,le=u,_e=s,ye=Z;W;)switch(N=q,q=Iu()){case 40:if(N!=108&&ja(ye,I-1)==58){eP(ye+=wo(dS(q),"&","&\f"),"&\f")!=-1&&(H=-1);break}case 34:case 39:case 91:ye+=dS(q);break;case 9:case 10:case 13:case 32:ye+=XX(N);break;case 92:ye+=YX(cS()-1,7);continue;case 47:switch(Ud()){case 42:case 47:Ew(QX(ZX(Iu(),cS()),t,n),r);break;default:ye+="/"}break;case 123*j:_[C++]=Ad(ye)*H;case 125*j:case 59:case 0:switch(q){case 0:case 125:W=0;case 59+k:H==-1&&(ye=wo(ye,/\f/g,"")),D>0&&Ad(ye)-I&&Ew(D>32?wz(ye+";",s,n,I-1):wz(wo(ye," ","")+";",s,n,I-2),r);break;case 59:ye+=";";default:if(Ew(_e=bz(ye,t,n,C,k,a,_,Z,re=[],le=[],I),u),q===123)if(k===0)hS(ye,t,_e,_e,re,u,I,_,le);else switch(P===99&&ja(ye,3)===110?100:P){case 100:case 108:case 109:case 115:hS(e,_e,_e,s&&Ew(bz(e,_e,_e,0,0,a,_,Z,a,re=[],I),le),a,le,I,_,s?re:le);break;default:hS(ye,_e,_e,_e,[""],le,0,_,le)}}C=k=D=0,j=H=1,Z=ye="",I=f;break;case 58:I=1+Ad(ye),D=N;default:if(j<1){if(q==123)--j;else if(q==125&&j++==0&&qX()==125)continue}switch(ye+=WC(q),q*j){case 38:H=k>0?1:(ye+="\f",-1);break;case 44:_[C++]=(Ad(ye)-1)*H,H=1;break;case 64:Ud()===45&&(ye+=dS(Iu())),P=Ud(),k=I=Ad(Z=ye+=KX(cS())),q++;break;case 45:N===45&&Ad(ye)==2&&(j=0)}}return u}function bz(e,t,n,s,a,u,f,_,r,C,k){for(var I=a-1,P=a===0?u:[""],D=G2(P),N=0,j=0,W=0;N<s;++N)for(var H=0,q=Dx(e,I+1,I=VX(j=f[N])),Z=e;H<D;++H)(Z=W3(j>0?P[H]+" "+q:wo(q,/&\f/g,P[H])))&&(r[W++]=Z);return XC(e,t,n,a===0?$2:_,r,C,k)}function QX(e,t,n){return XC(e,t,n,G3,WC(WX()),Dx(e,2,-2),0)}function wz(e,t,n,s){return XC(e,t,n,U2,Dx(e,0,s),Dx(e,s+1,-1),s)}function Oy(e,t){for(var n="",s=G2(e),a=0;a<s;a++)n+=t(e[a],a,e,t)||"";return n}function eY(e,t,n,s){switch(e.type){case jX:if(e.children.length)break;case BX:case U2:return e.return=e.return||e.value;case G3:return"";case H3:return e.return=e.value+"{"+Oy(e.children,s)+"}";case $2:e.value=e.props.join(",")}return Ad(n=Oy(e.children,s))?e.return=e.value+"{"+n+"}":""}function tY(e){var t=G2(e);return function(n,s,a,u){for(var f="",_=0;_<t;_++)f+=e[_](n,s,a,u)||"";return f}}function nY(e){return function(t){t.root||(t=t.return)&&e(t)}}var rY=function(t,n,s){for(var a=0,u=0;a=u,u=Ud(),a===38&&u===12&&(n[s]=1),!zx(u);)Iu();return i1(t,su)},iY=function(t,n){var s=-1,a=44;do switch(zx(a)){case 0:a===38&&Ud()===12&&(n[s]=1),t[s]+=rY(su-1,n,s);break;case 2:t[s]+=dS(a);break;case 4:if(a===44){t[++s]=Ud()===58?"&\f":"",n[s]=t[s].length;break}default:t[s]+=WC(a)}while(a=Iu());return t},oY=function(t,n){return Y3(iY(X3(t),n))},Sz=new WeakMap,sY=function(t){if(!(t.type!=="rule"||!t.parent||t.length<1)){for(var n=t.value,s=t.parent,a=t.column===s.column&&t.line===s.line;s.type!=="rule";)if(s=s.parent,!s)return;if(!(t.props.length===1&&n.charCodeAt(0)!==58&&!Sz.get(s))&&!a){Sz.set(t,!0);for(var u=[],f=oY(n,u),_=s.props,r=0,C=0;r<f.length;r++)for(var k=0;k<_.length;k++,C++)t.props[C]=u[r]?f[r].replace(/&\f/g,_[k]):_[k]+" "+f[r]}}},aY=function(t){if(t.type==="decl"){var n=t.value;n.charCodeAt(0)===108&&n.charCodeAt(2)===98&&(t.return="",t.value="")}};function Z3(e,t){switch(UX(e,t)){case 5103:return bo+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return bo+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return bo+e+nC+e+al+e+e;case 6828:case 4268:return bo+e+al+e+e;case 6165:return bo+e+al+"flex-"+e+e;case 5187:return bo+e+wo(e,/(\w+).+(:[^]+)/,bo+"box-$1$2"+al+"flex-$1$2")+e;case 5443:return bo+e+al+"flex-item-"+wo(e,/flex-|-self/,"")+e;case 4675:return bo+e+al+"flex-line-pack"+wo(e,/align-content|flex-|-self/,"")+e;case 5548:return bo+e+al+wo(e,"shrink","negative")+e;case 5292:return bo+e+al+wo(e,"basis","preferred-size")+e;case 6060:return bo+"box-"+wo(e,"-grow","")+bo+e+al+wo(e,"grow","positive")+e;case 4554:return bo+wo(e,/([^-])(transform)/g,"$1"+bo+"$2")+e;case 6187:return wo(wo(wo(e,/(zoom-|grab)/,bo+"$1"),/(image-set)/,bo+"$1"),e,"")+e;case 5495:case 3959:return wo(e,/(image-set\([^]*)/,bo+"$1$`$1");case 4968:return wo(wo(e,/(.+:)(flex-)?(.*)/,bo+"box-pack:$3"+al+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+bo+e+e;case 4095:case 3583:case 4068:case 2532:return wo(e,/(.+)-inline(.+)/,bo+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Ad(e)-1-t>6)switch(ja(e,t+1)){case 109:if(ja(e,t+4)!==45)break;case 102:return wo(e,/(.+:)(.+)-([^]+)/,"$1"+bo+"$2-$3$1"+nC+(ja(e,t+3)==108?"$3":"$2-$3"))+e;case 115:return~eP(e,"stretch")?Z3(wo(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(ja(e,t+1)!==115)break;case 6444:switch(ja(e,Ad(e)-3-(~eP(e,"!important")&&10))){case 107:return wo(e,":",":"+bo)+e;case 101:return wo(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+bo+(ja(e,14)===45?"inline-":"")+"box$3$1"+bo+"$2$3$1"+al+"$2box$3")+e}break;case 5936:switch(ja(e,t+11)){case 114:return bo+e+al+wo(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return bo+e+al+wo(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return bo+e+al+wo(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return bo+e+al+e+e}return e}var lY=function(t,n,s,a){if(t.length>-1&&!t.return)switch(t.type){case U2:t.return=Z3(t.value,t.length);break;case H3:return Oy([mv(t,{value:wo(t.value,"@","@"+bo)})],a);case $2:if(t.length)return HX(t.props,function(u){switch(GX(u,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Oy([mv(t,{props:[wo(u,/:(read-\w+)/,":"+nC+"$1")]})],a);case"::placeholder":return Oy([mv(t,{props:[wo(u,/:(plac\w+)/,":"+bo+"input-$1")]}),mv(t,{props:[wo(u,/:(plac\w+)/,":"+nC+"$1")]}),mv(t,{props:[wo(u,/:(plac\w+)/,al+"input-$1")]})],a)}return""})}},uY=[lY],cY=function(t){var n=t.key;if(n==="css"){var s=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(s,function(j){var W=j.getAttribute("data-emotion");W.indexOf(" ")!==-1&&(document.head.appendChild(j),j.setAttribute("data-s",""))})}var a=t.stylisPlugins||uY,u={},f,_=[];f=t.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+n+' "]'),function(j){for(var W=j.getAttribute("data-emotion").split(" "),H=1;H<W.length;H++)u[W[H]]=!0;_.push(j)});var r,C=[sY,aY];{var k,I=[eY,nY(function(j){k.insert(j)})],P=tY(C.concat(a,I)),D=function(W){return Oy(JX(W),P)};r=function(W,H,q,Z){k=q,D(W?W+"{"+H.styles+"}":H.styles),Z&&(N.inserted[H.name]=!0)}}var N={key:n,sheet:new NX({key:n,container:f,nonce:t.nonce,speedy:t.speedy,prepend:t.prepend,insertionPoint:t.insertionPoint}),nonce:t.nonce,inserted:u,registered:{},insert:r};return N.sheet.hydrate(_),N},K3={exports:{}},Lo={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ka=typeof Symbol=="function"&&Symbol.for,H2=ka?Symbol.for("react.element"):60103,W2=ka?Symbol.for("react.portal"):60106,YC=ka?Symbol.for("react.fragment"):60107,ZC=ka?Symbol.for("react.strict_mode"):60108,KC=ka?Symbol.for("react.profiler"):60114,JC=ka?Symbol.for("react.provider"):60109,QC=ka?Symbol.for("react.context"):60110,q2=ka?Symbol.for("react.async_mode"):60111,eE=ka?Symbol.for("react.concurrent_mode"):60111,tE=ka?Symbol.for("react.forward_ref"):60112,nE=ka?Symbol.for("react.suspense"):60113,dY=ka?Symbol.for("react.suspense_list"):60120,rE=ka?Symbol.for("react.memo"):60115,iE=ka?Symbol.for("react.lazy"):60116,hY=ka?Symbol.for("react.block"):60121,fY=ka?Symbol.for("react.fundamental"):60117,pY=ka?Symbol.for("react.responder"):60118,mY=ka?Symbol.for("react.scope"):60119;function Ru(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case H2:switch(e=e.type,e){case q2:case eE:case YC:case KC:case ZC:case nE:return e;default:switch(e=e&&e.$$typeof,e){case QC:case tE:case iE:case rE:case JC:return e;default:return t}}case W2:return t}}}function J3(e){return Ru(e)===eE}Lo.AsyncMode=q2;Lo.ConcurrentMode=eE;Lo.ContextConsumer=QC;Lo.ContextProvider=JC;Lo.Element=H2;Lo.ForwardRef=tE;Lo.Fragment=YC;Lo.Lazy=iE;Lo.Memo=rE;Lo.Portal=W2;Lo.Profiler=KC;Lo.StrictMode=ZC;Lo.Suspense=nE;Lo.isAsyncMode=function(e){return J3(e)||Ru(e)===q2};Lo.isConcurrentMode=J3;Lo.isContextConsumer=function(e){return Ru(e)===QC};Lo.isContextProvider=function(e){return Ru(e)===JC};Lo.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===H2};Lo.isForwardRef=function(e){return Ru(e)===tE};Lo.isFragment=function(e){return Ru(e)===YC};Lo.isLazy=function(e){return Ru(e)===iE};Lo.isMemo=function(e){return Ru(e)===rE};Lo.isPortal=function(e){return Ru(e)===W2};Lo.isProfiler=function(e){return Ru(e)===KC};Lo.isStrictMode=function(e){return Ru(e)===ZC};Lo.isSuspense=function(e){return Ru(e)===nE};Lo.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===YC||e===eE||e===KC||e===ZC||e===nE||e===dY||typeof e=="object"&&e!==null&&(e.$$typeof===iE||e.$$typeof===rE||e.$$typeof===JC||e.$$typeof===QC||e.$$typeof===tE||e.$$typeof===fY||e.$$typeof===pY||e.$$typeof===mY||e.$$typeof===hY)};Lo.typeOf=Ru;K3.exports=Lo;var gY=K3.exports,Q3=gY,yY={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},_Y={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},ej={};ej[Q3.ForwardRef]=yY;ej[Q3.Memo]=_Y;var vY=!0;function xY(e,t,n){var s="";return n.split(" ").forEach(function(a){e[a]!==void 0?t.push(e[a]+";"):a&&(s+=a+" ")}),s}var tj=function(t,n,s){var a=t.key+"-"+n.name;(s===!1||vY===!1)&&t.registered[a]===void 0&&(t.registered[a]=n.styles)},nj=function(t,n,s){tj(t,n,s);var a=t.key+"-"+n.name;if(t.inserted[n.name]===void 0){var u=n;do t.insert(n===u?"."+a:"",u,t.sheet,!0),u=u.next;while(u!==void 0)}};function bY(e){for(var t=0,n,s=0,a=e.length;a>=4;++s,a-=4)n=e.charCodeAt(s)&255|(e.charCodeAt(++s)&255)<<8|(e.charCodeAt(++s)&255)<<16|(e.charCodeAt(++s)&255)<<24,n=(n&65535)*1540483477+((n>>>16)*59797<<16),n^=n>>>24,t=(n&65535)*1540483477+((n>>>16)*59797<<16)^(t&65535)*1540483477+((t>>>16)*59797<<16);switch(a){case 3:t^=(e.charCodeAt(s+2)&255)<<16;case 2:t^=(e.charCodeAt(s+1)&255)<<8;case 1:t^=e.charCodeAt(s)&255,t=(t&65535)*1540483477+((t>>>16)*59797<<16)}return t^=t>>>13,t=(t&65535)*1540483477+((t>>>16)*59797<<16),((t^t>>>15)>>>0).toString(36)}var wY={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},SY=!1,CY=/[A-Z]|^ms/g,EY=/_EMO_([^_]+?)_([^]*?)_EMO_/g,rj=function(t){return t.charCodeAt(1)===45},Cz=function(t){return t!=null&&typeof t!="boolean"},gk=U3(function(e){return rj(e)?e:e.replace(CY,"-$&").toLowerCase()}),Ez=function(t,n){switch(t){case"animation":case"animationName":if(typeof n=="string")return n.replace(EY,function(s,a,u){return Ld={name:a,styles:u,next:Ld},a})}return wY[t]!==1&&!rj(t)&&typeof n=="number"&&n!==0?n+"px":n},TY="Component selectors can only be used in conjunction with @emotion/babel-plugin, the swc Emotion plugin, or another Emotion-aware compiler transform.";function Fx(e,t,n){if(n==null)return"";var s=n;if(s.__emotion_styles!==void 0)return s;switch(typeof n){case"boolean":return"";case"object":{var a=n;if(a.anim===1)return Ld={name:a.name,styles:a.styles,next:Ld},a.name;var u=n;if(u.styles!==void 0){var f=u.next;if(f!==void 0)for(;f!==void 0;)Ld={name:f.name,styles:f.styles,next:Ld},f=f.next;var _=u.styles+";";return _}return IY(e,t,n)}case"function":{if(e!==void 0){var r=Ld,C=n(e);return Ld=r,Fx(e,t,C)}break}}var k=n;if(t==null)return k;var I=t[k];return I!==void 0?I:k}function IY(e,t,n){var s="";if(Array.isArray(n))for(var a=0;a<n.length;a++)s+=Fx(e,t,n[a])+";";else for(var u in n){var f=n[u];if(typeof f!="object"){var _=f;t!=null&&t[_]!==void 0?s+=u+"{"+t[_]+"}":Cz(_)&&(s+=gk(u)+":"+Ez(u,_)+";")}else{if(u==="NO_COMPONENT_SELECTOR"&&SY)throw new Error(TY);if(Array.isArray(f)&&typeof f[0]=="string"&&(t==null||t[f[0]]===void 0))for(var r=0;r<f.length;r++)Cz(f[r])&&(s+=gk(u)+":"+Ez(u,f[r])+";");else{var C=Fx(e,t,f);switch(u){case"animation":case"animationName":{s+=gk(u)+":"+C+";";break}default:s+=u+"{"+C+"}"}}}}return s}var Tz=/label:\s*([^\s;{]+)\s*(;|$)/g,Ld;function oE(e,t,n){if(e.length===1&&typeof e[0]=="object"&&e[0]!==null&&e[0].styles!==void 0)return e[0];var s=!0,a="";Ld=void 0;var u=e[0];if(u==null||u.raw===void 0)s=!1,a+=Fx(n,t,u);else{var f=u;a+=f[0]}for(var _=1;_<e.length;_++)if(a+=Fx(n,t,e[_]),s){var r=u;a+=r[_]}Tz.lastIndex=0;for(var C="",k;(k=Tz.exec(a))!==null;)C+="-"+k[1];var I=bY(a)+C;return{name:I,styles:a,next:Ld}}var kY=function(t){return t()},ij=qk.useInsertionEffect?qk.useInsertionEffect:!1,MY=ij||kY,Iz=ij||X.useLayoutEffect,oj=X.createContext(typeof HTMLElement<"u"?cY({key:"css"}):null);oj.Provider;var sj=function(t){return X.forwardRef(function(n,s){var a=X.useContext(oj);return t(n,a,s)})},X2=X.createContext({}),PY=sj(function(e,t){var n=e.styles,s=oE([n],void 0,X.useContext(X2)),a=X.useRef();return Iz(function(){var u=t.key+"-global",f=new t.sheet.constructor({key:u,nonce:t.sheet.nonce,container:t.sheet.container,speedy:t.sheet.isSpeedy}),_=!1,r=document.querySelector('style[data-emotion="'+u+" "+s.name+'"]');return t.sheet.tags.length&&(f.before=t.sheet.tags[0]),r!==null&&(_=!0,r.setAttribute("data-emotion",u),f.hydrate([r])),a.current=[f,_],function(){f.flush()}},[t]),Iz(function(){var u=a.current,f=u[0],_=u[1];if(_){u[1]=!1;return}if(s.next!==void 0&&nj(t,s.next,!0),f.tags.length){var r=f.tags[f.tags.length-1].nextElementSibling;f.before=r,f.flush()}t.insert("",s,f,!1)},[t,s.name]),null});function yp(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return oE(t)}var Jd=function(){var t=yp.apply(void 0,arguments),n="animation-"+t.name;return{name:n,styles:"@keyframes "+n+"{"+t.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}},AY=OX,LY=function(t){return t!=="theme"},kz=function(t){return typeof t=="string"&&t.charCodeAt(0)>96?AY:LY},Mz=function(t,n,s){var a;if(n){var u=n.shouldForwardProp;a=t.__emotion_forwardProp&&u?function(f){return t.__emotion_forwardProp(f)&&u(f)}:u}return typeof a!="function"&&s&&(a=t.__emotion_forwardProp),a},RY=!1,OY=function(t){var n=t.cache,s=t.serialized,a=t.isStringTag;return tj(n,s,a),MY(function(){return nj(n,s,a)}),null},DY=function e(t,n){var s=t.__emotion_real===t,a=s&&t.__emotion_base||t,u,f;n!==void 0&&(u=n.label,f=n.target);var _=Mz(t,n,s),r=_||kz(a),C=!r("as");return function(){var k=arguments,I=s&&t.__emotion_styles!==void 0?t.__emotion_styles.slice(0):[];if(u!==void 0&&I.push("label:"+u+";"),k[0]==null||k[0].raw===void 0)I.push.apply(I,k);else{I.push(k[0][0]);for(var P=k.length,D=1;D<P;D++)I.push(k[D],k[0][D])}var N=sj(function(j,W,H){var q=C&&j.as||a,Z="",re=[],le=j;if(j.theme==null){le={};for(var _e in j)le[_e]=j[_e];le.theme=X.useContext(X2)}typeof j.className=="string"?Z=xY(W.registered,re,j.className):j.className!=null&&(Z=j.className+" ");var ye=oE(I.concat(re),W.registered,le);Z+=W.key+"-"+ye.name,f!==void 0&&(Z+=" "+f);var de=C&&_===void 0?kz(q):r,ce={};for(var oe in j)C&&oe==="as"||de(oe)&&(ce[oe]=j[oe]);return ce.className=Z,H&&(ce.ref=H),X.createElement(X.Fragment,null,X.createElement(OY,{cache:W,serialized:ye,isStringTag:typeof q=="string"}),X.createElement(q,ce))});return N.displayName=u!==void 0?u:"Styled("+(typeof a=="string"?a:a.displayName||a.name||"Component")+")",N.defaultProps=t.defaultProps,N.__emotion_real=N,N.__emotion_base=a,N.__emotion_styles=I,N.__emotion_forwardProp=_,Object.defineProperty(N,"toString",{value:function(){return f===void 0&&RY?"NO_COMPONENT_SELECTOR":"."+f}}),N.withComponent=function(j,W){return e(j,Ge({},n,W,{shouldForwardProp:Mz(N,W,!0)})).apply(void 0,I)},N}},zY=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],nP=DY.bind();zY.forEach(function(e){nP[e]=nP(e)});var aj={exports:{}},FY="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",NY=FY,BY=NY;function lj(){}function uj(){}uj.resetWarningCache=lj;var jY=function(){function e(s,a,u,f,_,r){if(r!==BY){var C=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw C.name="Invariant Violation",C}}e.isRequired=e;function t(){return e}var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:uj,resetWarningCache:lj};return n.PropTypes=n,n};aj.exports=jY();var VY=aj.exports;const Pt=yc(VY);function $Y(e){return e==null||Object.keys(e).length===0}function UY(e){const{styles:t,defaultTheme:n={}}=e,s=typeof t=="function"?a=>t($Y(a)?n:a):t;return K.jsx(PY,{styles:s})}/**
 * @mui/styled-engine v6.1.4
 *
 * @license MIT
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function cj(e,t){return nP(e,t)}function GY(e,t){Array.isArray(e.__emotion_styles)&&(e.__emotion_styles=t(e.__emotion_styles))}const Pz=[];function Az(e){return Pz[0]=e,oE(Pz)}function zd(e){if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function dj(e){if(!zd(e))return e;const t={};return Object.keys(e).forEach(n=>{t[n]=dj(e[n])}),t}function ml(e,t,n={clone:!0}){const s=n.clone?{...e}:e;return zd(e)&&zd(t)&&Object.keys(t).forEach(a=>{zd(t[a])&&Object.prototype.hasOwnProperty.call(e,a)&&zd(e[a])?s[a]=ml(e[a],t[a],n):n.clone?s[a]=zd(t[a])?dj(t[a]):t[a]:s[a]=t[a]}),s}const HY=e=>{const t=Object.keys(e).map(n=>({key:n,val:e[n]}))||[];return t.sort((n,s)=>n.val-s.val),t.reduce((n,s)=>({...n,[s.key]:s.val}),{})};function WY(e){const{values:t={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:n="px",step:s=5,...a}=e,u=HY(t),f=Object.keys(u);function _(P){return`@media (min-width:${typeof t[P]=="number"?t[P]:P}${n})`}function r(P){return`@media (max-width:${(typeof t[P]=="number"?t[P]:P)-s/100}${n})`}function C(P,D){const N=f.indexOf(D);return`@media (min-width:${typeof t[P]=="number"?t[P]:P}${n}) and (max-width:${(N!==-1&&typeof t[f[N]]=="number"?t[f[N]]:D)-s/100}${n})`}function k(P){return f.indexOf(P)+1<f.length?C(P,f[f.indexOf(P)+1]):_(P)}function I(P){const D=f.indexOf(P);return D===0?_(f[1]):D===f.length-1?r(f[D]):C(P,f[f.indexOf(P)+1]).replace("@media","@media not all and")}return{keys:f,values:u,up:_,down:r,between:C,only:k,not:I,unit:n,...a}}function qY(e,t){if(!e.containerQueries)return t;const n=Object.keys(t).filter(s=>s.startsWith("@container")).sort((s,a)=>{var f,_;const u=/min-width:\s*([0-9.]+)/;return+(((f=s.match(u))==null?void 0:f[1])||0)-+(((_=a.match(u))==null?void 0:_[1])||0)});return n.length?n.reduce((s,a)=>{const u=t[a];return delete s[a],s[a]=u,s},{...t}):t}function XY(e,t){return t==="@"||t.startsWith("@")&&(e.some(n=>t.startsWith(`@${n}`))||!!t.match(/^@\d/))}function YY(e,t){const n=t.match(/^@([^/]+)?\/?(.+)?$/);if(!n)return null;const[,s,a]=n,u=Number.isNaN(+s)?s||0:+s;return e.containerQueries(a).up(u)}function ZY(e){const t=(u,f)=>u.replace("@media",f?`@container ${f}`:"@container");function n(u,f){u.up=(..._)=>t(e.breakpoints.up(..._),f),u.down=(..._)=>t(e.breakpoints.down(..._),f),u.between=(..._)=>t(e.breakpoints.between(..._),f),u.only=(..._)=>t(e.breakpoints.only(..._),f),u.not=(..._)=>{const r=t(e.breakpoints.not(..._),f);return r.includes("not all and")?r.replace("not all and ","").replace("min-width:","width<").replace("max-width:","width>").replace("and","or"):r}}const s={},a=u=>(n(s,u),s);return n(a),{...e,containerQueries:a}}const KY={borderRadius:4};function ox(e,t){return t?ml(e,t,{clone:!1}):e}const sE={xs:0,sm:600,md:900,lg:1200,xl:1536},Lz={keys:["xs","sm","md","lg","xl"],up:e=>`@media (min-width:${sE[e]}px)`},JY={containerQueries:e=>({up:t=>{let n=typeof t=="number"?t:sE[t]||t;return typeof n=="number"&&(n=`${n}px`),e?`@container ${e} (min-width:${n})`:`@container (min-width:${n})`}})};function Fh(e,t,n){const s=e.theme||{};if(Array.isArray(t)){const u=s.breakpoints||Lz;return t.reduce((f,_,r)=>(f[u.up(u.keys[r])]=n(t[r]),f),{})}if(typeof t=="object"){const u=s.breakpoints||Lz;return Object.keys(t).reduce((f,_)=>{if(XY(u.keys,_)){const r=YY(s.containerQueries?s:JY,_);r&&(f[r]=n(t[_],_))}else if(Object.keys(u.values||sE).includes(_)){const r=u.up(_);f[r]=n(t[_],_)}else{const r=_;f[r]=t[r]}return f},{})}return n(t)}function QY(e={}){var n;return((n=e.keys)==null?void 0:n.reduce((s,a)=>{const u=e.up(a);return s[u]={},s},{}))||{}}function eZ(e,t){return e.reduce((n,s)=>{const a=n[s];return(!a||Object.keys(a).length===0)&&delete n[s],n},t)}function Rn(e){if(typeof e!="string")throw new Error(zh(7));return e.charAt(0).toUpperCase()+e.slice(1)}function aE(e,t,n=!0){if(!t||typeof t!="string")return null;if(e&&e.vars&&n){const s=`vars.${t}`.split(".").reduce((a,u)=>a&&a[u]?a[u]:null,e);if(s!=null)return s}return t.split(".").reduce((s,a)=>s&&s[a]!=null?s[a]:null,e)}function rC(e,t,n,s=n){let a;return typeof e=="function"?a=e(n):Array.isArray(e)?a=e[n]||s:a=aE(e,n)||s,t&&(a=t(a,s,e)),a}function Qs(e){const{prop:t,cssProperty:n=e.prop,themeKey:s,transform:a}=e,u=f=>{if(f[t]==null)return null;const _=f[t],r=f.theme,C=aE(r,s)||{};return Fh(f,_,I=>{let P=rC(C,a,I);return I===P&&typeof I=="string"&&(P=rC(C,a,`${t}${I==="default"?"":Rn(I)}`,I)),n===!1?P:{[n]:P}})};return u.propTypes={},u.filterProps=[t],u}function tZ(e){const t={};return n=>(t[n]===void 0&&(t[n]=e(n)),t[n])}const nZ={m:"margin",p:"padding"},rZ={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},Rz={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},iZ=tZ(e=>{if(e.length>2)if(Rz[e])e=Rz[e];else return[e];const[t,n]=e.split(""),s=nZ[t],a=rZ[n]||"";return Array.isArray(a)?a.map(u=>s+u):[s+a]}),Y2=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],Z2=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...Y2,...Z2];function o1(e,t,n,s){const a=aE(e,t,!0)??n;return typeof a=="number"||typeof a=="string"?u=>typeof u=="string"?u:typeof a=="string"?`calc(${u} * ${a})`:a*u:Array.isArray(a)?u=>{if(typeof u=="string")return u;const f=Math.abs(u),_=a[f];return u>=0?_:typeof _=="number"?-_:`-${_}`}:typeof a=="function"?a:()=>{}}function K2(e){return o1(e,"spacing",8)}function s1(e,t){return typeof t=="string"||t==null?t:e(t)}function oZ(e,t){return n=>e.reduce((s,a)=>(s[a]=s1(t,n),s),{})}function sZ(e,t,n,s){if(!t.includes(n))return null;const a=iZ(n),u=oZ(a,s),f=e[n];return Fh(e,f,u)}function hj(e,t){const n=K2(e.theme);return Object.keys(e).map(s=>sZ(e,t,s,n)).reduce(ox,{})}function Bs(e){return hj(e,Y2)}Bs.propTypes={};Bs.filterProps=Y2;function js(e){return hj(e,Z2)}js.propTypes={};js.filterProps=Z2;function fj(e=8,t=K2({spacing:e})){if(e.mui)return e;const n=(...s)=>(s.length===0?[1]:s).map(u=>{const f=t(u);return typeof f=="number"?`${f}px`:f}).join(" ");return n.mui=!0,n}function lE(...e){const t=e.reduce((s,a)=>(a.filterProps.forEach(u=>{s[u]=a}),s),{}),n=s=>Object.keys(s).reduce((a,u)=>t[u]?ox(a,t[u](s)):a,{});return n.propTypes={},n.filterProps=e.reduce((s,a)=>s.concat(a.filterProps),[]),n}function ic(e){return typeof e!="number"?e:`${e}px solid`}function vc(e,t){return Qs({prop:e,themeKey:"borders",transform:t})}const aZ=vc("border",ic),lZ=vc("borderTop",ic),uZ=vc("borderRight",ic),cZ=vc("borderBottom",ic),dZ=vc("borderLeft",ic),hZ=vc("borderColor"),fZ=vc("borderTopColor"),pZ=vc("borderRightColor"),mZ=vc("borderBottomColor"),gZ=vc("borderLeftColor"),yZ=vc("outline",ic),_Z=vc("outlineColor"),uE=e=>{if(e.borderRadius!==void 0&&e.borderRadius!==null){const t=o1(e.theme,"shape.borderRadius",4),n=s=>({borderRadius:s1(t,s)});return Fh(e,e.borderRadius,n)}return null};uE.propTypes={};uE.filterProps=["borderRadius"];lE(aZ,lZ,uZ,cZ,dZ,hZ,fZ,pZ,mZ,gZ,uE,yZ,_Z);const cE=e=>{if(e.gap!==void 0&&e.gap!==null){const t=o1(e.theme,"spacing",8),n=s=>({gap:s1(t,s)});return Fh(e,e.gap,n)}return null};cE.propTypes={};cE.filterProps=["gap"];const dE=e=>{if(e.columnGap!==void 0&&e.columnGap!==null){const t=o1(e.theme,"spacing",8),n=s=>({columnGap:s1(t,s)});return Fh(e,e.columnGap,n)}return null};dE.propTypes={};dE.filterProps=["columnGap"];const hE=e=>{if(e.rowGap!==void 0&&e.rowGap!==null){const t=o1(e.theme,"spacing",8),n=s=>({rowGap:s1(t,s)});return Fh(e,e.rowGap,n)}return null};hE.propTypes={};hE.filterProps=["rowGap"];const vZ=Qs({prop:"gridColumn"}),xZ=Qs({prop:"gridRow"}),bZ=Qs({prop:"gridAutoFlow"}),wZ=Qs({prop:"gridAutoColumns"}),SZ=Qs({prop:"gridAutoRows"}),CZ=Qs({prop:"gridTemplateColumns"}),EZ=Qs({prop:"gridTemplateRows"}),TZ=Qs({prop:"gridTemplateAreas"}),IZ=Qs({prop:"gridArea"});lE(cE,dE,hE,vZ,xZ,bZ,wZ,SZ,CZ,EZ,TZ,IZ);function Dy(e,t){return t==="grey"?t:e}const kZ=Qs({prop:"color",themeKey:"palette",transform:Dy}),MZ=Qs({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:Dy}),PZ=Qs({prop:"backgroundColor",themeKey:"palette",transform:Dy});lE(kZ,MZ,PZ);function Su(e){return e<=1&&e!==0?`${e*100}%`:e}const AZ=Qs({prop:"width",transform:Su}),J2=e=>{if(e.maxWidth!==void 0&&e.maxWidth!==null){const t=n=>{var a,u,f,_,r;const s=((f=(u=(a=e.theme)==null?void 0:a.breakpoints)==null?void 0:u.values)==null?void 0:f[n])||sE[n];return s?((r=(_=e.theme)==null?void 0:_.breakpoints)==null?void 0:r.unit)!=="px"?{maxWidth:`${s}${e.theme.breakpoints.unit}`}:{maxWidth:s}:{maxWidth:Su(n)}};return Fh(e,e.maxWidth,t)}return null};J2.filterProps=["maxWidth"];const LZ=Qs({prop:"minWidth",transform:Su}),RZ=Qs({prop:"height",transform:Su}),OZ=Qs({prop:"maxHeight",transform:Su}),DZ=Qs({prop:"minHeight",transform:Su});Qs({prop:"size",cssProperty:"width",transform:Su});Qs({prop:"size",cssProperty:"height",transform:Su});const zZ=Qs({prop:"boxSizing"});lE(AZ,J2,LZ,RZ,OZ,DZ,zZ);const a1={border:{themeKey:"borders",transform:ic},borderTop:{themeKey:"borders",transform:ic},borderRight:{themeKey:"borders",transform:ic},borderBottom:{themeKey:"borders",transform:ic},borderLeft:{themeKey:"borders",transform:ic},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:ic},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:uE},color:{themeKey:"palette",transform:Dy},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:Dy},backgroundColor:{themeKey:"palette",transform:Dy},p:{style:js},pt:{style:js},pr:{style:js},pb:{style:js},pl:{style:js},px:{style:js},py:{style:js},padding:{style:js},paddingTop:{style:js},paddingRight:{style:js},paddingBottom:{style:js},paddingLeft:{style:js},paddingX:{style:js},paddingY:{style:js},paddingInline:{style:js},paddingInlineStart:{style:js},paddingInlineEnd:{style:js},paddingBlock:{style:js},paddingBlockStart:{style:js},paddingBlockEnd:{style:js},m:{style:Bs},mt:{style:Bs},mr:{style:Bs},mb:{style:Bs},ml:{style:Bs},mx:{style:Bs},my:{style:Bs},margin:{style:Bs},marginTop:{style:Bs},marginRight:{style:Bs},marginBottom:{style:Bs},marginLeft:{style:Bs},marginX:{style:Bs},marginY:{style:Bs},marginInline:{style:Bs},marginInlineStart:{style:Bs},marginInlineEnd:{style:Bs},marginBlock:{style:Bs},marginBlockStart:{style:Bs},marginBlockEnd:{style:Bs},displayPrint:{cssProperty:!1,transform:e=>({"@media print":{display:e}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:cE},rowGap:{style:hE},columnGap:{style:dE},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:Su},maxWidth:{style:J2},minWidth:{transform:Su},height:{transform:Su},maxHeight:{transform:Su},minHeight:{transform:Su},boxSizing:{},font:{themeKey:"font"},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};function FZ(...e){const t=e.reduce((s,a)=>s.concat(Object.keys(a)),[]),n=new Set(t);return e.every(s=>n.size===Object.keys(s).length)}function NZ(e,t){return typeof e=="function"?e(t):e}function BZ(){function e(n,s,a,u){const f={[n]:s,theme:a},_=u[n];if(!_)return{[n]:s};const{cssProperty:r=n,themeKey:C,transform:k,style:I}=_;if(s==null)return null;if(C==="typography"&&s==="inherit")return{[n]:s};const P=aE(a,C)||{};return I?I(f):Fh(f,s,N=>{let j=rC(P,k,N);return N===j&&typeof N=="string"&&(j=rC(P,k,`${n}${N==="default"?"":Rn(N)}`,N)),r===!1?j:{[r]:j}})}function t(n){const{sx:s,theme:a={}}=n||{};if(!s)return null;const u=a.unstable_sxConfig??a1;function f(_){let r=_;if(typeof _=="function")r=_(a);else if(typeof _!="object")return _;if(!r)return null;const C=QY(a.breakpoints),k=Object.keys(C);let I=C;return Object.keys(r).forEach(P=>{const D=NZ(r[P],a);if(D!=null)if(typeof D=="object")if(u[P])I=ox(I,e(P,D,a,u));else{const N=Fh({theme:a},D,j=>({[P]:j}));FZ(N,D)?I[P]=t({sx:D,theme:a}):I=ox(I,N)}else I=ox(I,e(P,D,a,u))}),qY(a,eZ(k,I))}return Array.isArray(s)?s.map(f):f(s)}return t}const Tm=BZ();Tm.filterProps=["sx"];function jZ(e,t){var s;const n=this;if(n.vars){if(!((s=n.colorSchemes)!=null&&s[e])||typeof n.getColorSchemeSelector!="function")return{};let a=n.getColorSchemeSelector(e);return a==="&"?t:((a.includes("data-")||a.includes("."))&&(a=`*:where(${a.replace(/\s*&$/,"")}) &`),{[a]:t})}return n.palette.mode===e?t:{}}function Q2(e={},...t){const{breakpoints:n={},palette:s={},spacing:a,shape:u={},...f}=e,_=WY(n),r=fj(a);let C=ml({breakpoints:_,direction:"ltr",components:{},palette:{mode:"light",...s},spacing:r,shape:{...KY,...u}},f);return C=ZY(C),C.applyStyles=jZ,C=t.reduce((k,I)=>ml(k,I),C),C.unstable_sxConfig={...a1,...f==null?void 0:f.unstable_sxConfig},C.unstable_sx=function(I){return Tm({sx:I,theme:this})},C}function VZ(e){return Object.keys(e).length===0}function $Z(e=null){const t=X.useContext(X2);return!t||VZ(t)?e:t}const UZ=Q2();function fE(e=UZ){return $Z(e)}function GZ({styles:e,themeId:t,defaultTheme:n={}}){const s=fE(n),a=typeof e=="function"?e(t&&s[t]||s):e;return K.jsx(UY,{styles:a})}const HZ=e=>{var s;const t={systemProps:{},otherProps:{}},n=((s=e==null?void 0:e.theme)==null?void 0:s.unstable_sxConfig)??a1;return Object.keys(e).forEach(a=>{n[a]?t.systemProps[a]=e[a]:t.otherProps[a]=e[a]}),t};function pj(e){const{sx:t,...n}=e,{systemProps:s,otherProps:a}=HZ(n);let u;return Array.isArray(t)?u=[s,...t]:typeof t=="function"?u=(...f)=>{const _=t(...f);return zd(_)?{...s,..._}:s}:u={...s,...t},{...a,sx:u}}const Oz=e=>e,WZ=()=>{let e=Oz;return{configure(t){e=t},generate(t){return e(t)},reset(){e=Oz}}},mj=WZ();function gj(e){var t,n,s="";if(typeof e=="string"||typeof e=="number")s+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(n=gj(e[t]))&&(s&&(s+=" "),s+=n)}else for(n in e)e[n]&&(s&&(s+=" "),s+=n);return s}function Hn(){for(var e,t,n=0,s="",a=arguments.length;n<a;n++)(e=arguments[n])&&(t=gj(e))&&(s&&(s+=" "),s+=t);return s}function qZ(e={}){const{themeId:t,defaultTheme:n,defaultClassName:s="MuiBox-root",generateClassName:a}=e,u=cj("div",{shouldForwardProp:_=>_!=="theme"&&_!=="sx"&&_!=="as"})(Tm);return X.forwardRef(function(r,C){const k=fE(n),{className:I,component:P="div",...D}=pj(r);return K.jsx(u,{as:P,ref:C,className:Hn(I,a?a(s):s),theme:t&&k[t]||k,...D})})}const XZ={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function gi(e,t,n="Mui"){const s=XZ[t];return s?`${n}-${s}`:`${mj.generate(e)}-${t}`}function pi(e,t,n="Mui"){const s={};return t.forEach(a=>{s[a]=gi(e,a,n)}),s}var Ho={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var eA=Symbol.for("react.element"),tA=Symbol.for("react.portal"),pE=Symbol.for("react.fragment"),mE=Symbol.for("react.strict_mode"),gE=Symbol.for("react.profiler"),yE=Symbol.for("react.provider"),_E=Symbol.for("react.context"),YZ=Symbol.for("react.server_context"),vE=Symbol.for("react.forward_ref"),xE=Symbol.for("react.suspense"),bE=Symbol.for("react.suspense_list"),wE=Symbol.for("react.memo"),SE=Symbol.for("react.lazy"),ZZ=Symbol.for("react.offscreen"),yj;yj=Symbol.for("react.module.reference");function xc(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case eA:switch(e=e.type,e){case pE:case gE:case mE:case xE:case bE:return e;default:switch(e=e&&e.$$typeof,e){case YZ:case _E:case vE:case SE:case wE:case yE:return e;default:return t}}case tA:return t}}}Ho.ContextConsumer=_E;Ho.ContextProvider=yE;Ho.Element=eA;Ho.ForwardRef=vE;Ho.Fragment=pE;Ho.Lazy=SE;Ho.Memo=wE;Ho.Portal=tA;Ho.Profiler=gE;Ho.StrictMode=mE;Ho.Suspense=xE;Ho.SuspenseList=bE;Ho.isAsyncMode=function(){return!1};Ho.isConcurrentMode=function(){return!1};Ho.isContextConsumer=function(e){return xc(e)===_E};Ho.isContextProvider=function(e){return xc(e)===yE};Ho.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===eA};Ho.isForwardRef=function(e){return xc(e)===vE};Ho.isFragment=function(e){return xc(e)===pE};Ho.isLazy=function(e){return xc(e)===SE};Ho.isMemo=function(e){return xc(e)===wE};Ho.isPortal=function(e){return xc(e)===tA};Ho.isProfiler=function(e){return xc(e)===gE};Ho.isStrictMode=function(e){return xc(e)===mE};Ho.isSuspense=function(e){return xc(e)===xE};Ho.isSuspenseList=function(e){return xc(e)===bE};Ho.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===pE||e===gE||e===mE||e===xE||e===bE||e===ZZ||typeof e=="object"&&e!==null&&(e.$$typeof===SE||e.$$typeof===wE||e.$$typeof===yE||e.$$typeof===_E||e.$$typeof===vE||e.$$typeof===yj||e.getModuleId!==void 0)};Ho.typeOf=xc;function _j(e){const{variants:t,...n}=e,s={variants:t,style:Az(n),isProcessed:!0};return s.style===n||t&&t.forEach(a=>{typeof a.style!="function"&&(a.style=Az(a.style))}),s}const KZ=Q2();function yk(e){return e!=="ownerState"&&e!=="theme"&&e!=="sx"&&e!=="as"}function JZ(e){return e?(t,n)=>n[e]:null}function QZ(e,t,n){e.theme=tK(e.theme)?n:e.theme[t]||e.theme}function fS(e,t){const n=typeof t=="function"?t(e):t;if(Array.isArray(n))return n.flatMap(s=>fS(e,s));if(Array.isArray(n==null?void 0:n.variants)){let s;if(n.isProcessed)s=n.style;else{const{variants:a,...u}=n;s=u}return vj(e,n.variants,[s])}return n!=null&&n.isProcessed?n.style:n}function vj(e,t,n=[]){var a;let s;e:for(let u=0;u<t.length;u+=1){const f=t[u];if(typeof f.props=="function"){if(s??(s={...e,...e.ownerState,ownerState:e.ownerState}),!f.props(s))continue}else for(const _ in f.props)if(e[_]!==f.props[_]&&((a=e.ownerState)==null?void 0:a[_])!==f.props[_])continue e;typeof f.style=="function"?(s??(s={...e,...e.ownerState,ownerState:e.ownerState}),n.push(f.style(s))):n.push(f.style)}return n}function xj(e={}){const{themeId:t,defaultTheme:n=KZ,rootShouldForwardProp:s=yk,slotShouldForwardProp:a=yk}=e;function u(_){QZ(_,t,n)}return(_,r={})=>{GY(_,le=>le.filter(_e=>_e!==Tm));const{name:C,slot:k,skipVariantsResolver:I,skipSx:P,overridesResolver:D=JZ(rK(k)),...N}=r,j=I!==void 0?I:k&&k!=="Root"&&k!=="root"||!1,W=P||!1;let H=yk;k==="Root"||k==="root"?H=s:k?H=a:nK(_)&&(H=void 0);const q=cj(_,{shouldForwardProp:H,label:eK(),...N}),Z=le=>{if(typeof le=="function"&&le.__emotion_real!==le)return function(ye){return fS(ye,le)};if(zd(le)){const _e=_j(le);return _e.variants?function(de){return fS(de,_e)}:_e.style}return le},re=(...le)=>{const _e=[],ye=le.map(Z),de=[];if(_e.push(u),C&&D&&de.push(function(he){var Se,Pe;const se=(Pe=(Se=he.theme.components)==null?void 0:Se[C])==null?void 0:Pe.styleOverrides;if(!se)return null;const we={};for(const Me in se)we[Me]=fS(he,se[Me]);return D(he,we)}),C&&!j&&de.push(function(he){var we,Se;const Ee=he.theme,se=(Se=(we=Ee==null?void 0:Ee.components)==null?void 0:we[C])==null?void 0:Se.variants;return se?vj(he,se):null}),W||de.push(Tm),Array.isArray(ye[0])){const xe=ye.shift(),he=new Array(_e.length).fill(""),Ee=new Array(de.length).fill("");let se;se=[...he,...xe,...Ee],se.raw=[...he,...xe.raw,...Ee],_e.unshift(se)}const ce=[..._e,...ye,...de],oe=q(...ce);return _.muiName&&(oe.muiName=_.muiName),oe};return q.withConfig&&(re.withConfig=q.withConfig),re}}function eK(e,t){return void 0}function tK(e){for(const t in e)return!1;return!0}function nK(e){return typeof e=="string"&&e.charCodeAt(0)>96}function rK(e){return e&&e.charAt(0).toLowerCase()+e.slice(1)}const Wo=xj();function Qy(e,t){const n={...t};for(const s in e)if(Object.prototype.hasOwnProperty.call(e,s)){const a=s;if(a==="components"||a==="slots")n[a]={...e[a],...n[a]};else if(a==="componentsProps"||a==="slotProps"){const u=e[a],f=t[a];if(!f)n[a]=u||{};else if(!u)n[a]=f;else{n[a]={...f};for(const _ in u)if(Object.prototype.hasOwnProperty.call(u,_)){const r=_;n[a][r]=Qy(u[r],f[r])}}}else n[a]===void 0&&(n[a]=e[a])}return n}function iK(e){const{theme:t,name:n,props:s}=e;return!t||!t.components||!t.components[n]||!t.components[n].defaultProps?s:Qy(t.components[n].defaultProps,s)}function oK({props:e,name:t,defaultTheme:n,themeId:s}){let a=fE(n);return s&&(a=a[s]||a),iK({theme:a,name:t,props:e})}const Io=typeof window<"u"?X.useLayoutEffect:X.useEffect;function bj(e,t=Number.MIN_SAFE_INTEGER,n=Number.MAX_SAFE_INTEGER){return Math.max(t,Math.min(e,n))}function nA(e,t=0,n=1){return bj(e,t,n)}function sK(e){e=e.slice(1);const t=new RegExp(`.{1,${e.length>=6?2:1}}`,"g");let n=e.match(t);return n&&n[0].length===1&&(n=n.map(s=>s+s)),n?`rgb${n.length===4?"a":""}(${n.map((s,a)=>a<3?parseInt(s,16):Math.round(parseInt(s,16)/255*1e3)/1e3).join(", ")})`:""}function Xd(e){if(e.type)return e;if(e.charAt(0)==="#")return Xd(sK(e));const t=e.indexOf("("),n=e.substring(0,t);if(!["rgb","rgba","hsl","hsla","color"].includes(n))throw new Error(zh(9,e));let s=e.substring(t+1,e.length-1),a;if(n==="color"){if(s=s.split(" "),a=s.shift(),s.length===4&&s[3].charAt(0)==="/"&&(s[3]=s[3].slice(1)),!["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].includes(a))throw new Error(zh(10,a))}else s=s.split(",");return s=s.map(u=>parseFloat(u)),{type:n,values:s,colorSpace:a}}const aK=e=>{const t=Xd(e);return t.values.slice(0,3).map((n,s)=>t.type.includes("hsl")&&s!==0?`${n}%`:n).join(" ")},Gv=(e,t)=>{try{return aK(e)}catch{return e}};function l1(e){const{type:t,colorSpace:n}=e;let{values:s}=e;return t.includes("rgb")?s=s.map((a,u)=>u<3?parseInt(a,10):a):t.includes("hsl")&&(s[1]=`${s[1]}%`,s[2]=`${s[2]}%`),t.includes("color")?s=`${n} ${s.join(" ")}`:s=`${s.join(", ")}`,`${t}(${s})`}function wj(e){e=Xd(e);const{values:t}=e,n=t[0],s=t[1]/100,a=t[2]/100,u=s*Math.min(a,1-a),f=(C,k=(C+n/30)%12)=>a-u*Math.max(Math.min(k-3,9-k,1),-1);let _="rgb";const r=[Math.round(f(0)*255),Math.round(f(8)*255),Math.round(f(4)*255)];return e.type==="hsla"&&(_+="a",r.push(t[3])),l1({type:_,values:r})}function rP(e){e=Xd(e);let t=e.type==="hsl"||e.type==="hsla"?Xd(wj(e)).values:e.values;return t=t.map(n=>(e.type!=="color"&&(n/=255),n<=.03928?n/12.92:((n+.055)/1.055)**2.4)),Number((.2126*t[0]+.7152*t[1]+.0722*t[2]).toFixed(3))}function lK(e,t){const n=rP(e),s=rP(t);return(Math.max(n,s)+.05)/(Math.min(n,s)+.05)}function vi(e,t){return e=Xd(e),t=nA(t),(e.type==="rgb"||e.type==="hsl")&&(e.type+="a"),e.type==="color"?e.values[3]=`/${t}`:e.values[3]=t,l1(e)}function Tw(e,t,n){try{return vi(e,t)}catch{return e}}function zm(e,t){if(e=Xd(e),t=nA(t),e.type.includes("hsl"))e.values[2]*=1-t;else if(e.type.includes("rgb")||e.type.includes("color"))for(let n=0;n<3;n+=1)e.values[n]*=1-t;return l1(e)}function es(e,t,n){try{return zm(e,t)}catch{return e}}function Fm(e,t){if(e=Xd(e),t=nA(t),e.type.includes("hsl"))e.values[2]+=(100-e.values[2])*t;else if(e.type.includes("rgb"))for(let n=0;n<3;n+=1)e.values[n]+=(255-e.values[n])*t;else if(e.type.includes("color"))for(let n=0;n<3;n+=1)e.values[n]+=(1-e.values[n])*t;return l1(e)}function ts(e,t,n){try{return Fm(e,t)}catch{return e}}function Sj(e,t=.15){return rP(e)>.5?zm(e,t):Fm(e,t)}function Iw(e,t,n){try{return Sj(e,t)}catch{return e}}function Dz(...e){return e.reduce((t,n)=>n==null?t:function(...a){t.apply(this,a),n.apply(this,a)},()=>{})}function rA(e,t=166){let n;function s(...a){const u=()=>{e.apply(this,a)};clearTimeout(n),n=setTimeout(u,t)}return s.clear=()=>{clearTimeout(n)},s}function pS(e,t){var n,s,a;return X.isValidElement(e)&&t.indexOf(e.type.muiName??((a=(s=(n=e.type)==null?void 0:n._payload)==null?void 0:s.value)==null?void 0:a.muiName))!==-1}function As(e){return e&&e.ownerDocument||document}function pc(e){return As(e).defaultView||window}function iC(e,t){typeof e=="function"?e(t):e&&(e.current=t)}let zz=0;function uK(e){const[t,n]=X.useState(e),s=e||t;return X.useEffect(()=>{t==null&&(zz+=1,n(`mui-${zz}`))},[t]),s}const cK={...qk},Fz=cK.useId;function ls(e){if(Fz!==void 0){const t=Fz();return e??t}return uK(e)}function Qf({controlled:e,default:t,name:n,state:s="value"}){const{current:a}=X.useRef(e!==void 0),[u,f]=X.useState(t),_=a?e:u,r=X.useCallback(C=>{a||f(C)},[]);return[_,r]}function Ui(e){const t=X.useRef(e);return Io(()=>{t.current=e}),X.useRef((...n)=>(0,t.current)(...n)).current}function mo(...e){return X.useMemo(()=>e.every(t=>t==null)?null:t=>{e.forEach(n=>{iC(n,t)})},e)}const Nz={};function id(e,t){const n=X.useRef(Nz);return n.current===Nz&&(n.current=e(t)),n}const dK=[];function CE(e){X.useEffect(e,dK)}class EE{constructor(){Q_(this,"currentId",null);Q_(this,"clear",()=>{this.currentId!==null&&(clearTimeout(this.currentId),this.currentId=null)});Q_(this,"disposeEffect",()=>this.clear)}static create(){return new EE}start(t,n){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,n()},t)}}function Eu(){const e=id(EE.create).current;return CE(e.disposeEffect),e}function oC(e){try{return e.matches(":focus-visible")}catch{}return!1}function Cj(e=window){const t=e.document.documentElement.clientWidth;return e.innerWidth-t}const iA=e=>{const t=X.useRef({});return X.useEffect(()=>{t.current=e}),t.current};function yr(e,t,n=void 0){const s={};for(const a in e){const u=e[a];let f="",_=!0;for(let r=0;r<u.length;r+=1){const C=u[r];C&&(f+=(_===!0?"":" ")+t(C),_=!1,n&&n[C]&&(f+=" "+n[C]))}s[a]=f}return s}function hK(e){return typeof e=="string"}function xy(e,t,n){return e===void 0||hK(e)?t:{...t,ownerState:{...t.ownerState,...n}}}function Ej(e,t=[]){if(e===void 0)return{};const n={};return Object.keys(e).filter(s=>s.match(/^on[A-Z]/)&&typeof e[s]=="function"&&!t.includes(s)).forEach(s=>{n[s]=e[s]}),n}function Bz(e){if(e===void 0)return{};const t={};return Object.keys(e).filter(n=>!(n.match(/^on[A-Z]/)&&typeof e[n]=="function")).forEach(n=>{t[n]=e[n]}),t}function Tj(e){const{getSlotProps:t,additionalProps:n,externalSlotProps:s,externalForwardedProps:a,className:u}=e;if(!t){const D=Hn(n==null?void 0:n.className,u,a==null?void 0:a.className,s==null?void 0:s.className),N={...n==null?void 0:n.style,...a==null?void 0:a.style,...s==null?void 0:s.style},j={...n,...a,...s};return D.length>0&&(j.className=D),Object.keys(N).length>0&&(j.style=N),{props:j,internalRef:void 0}}const f=Ej({...a,...s}),_=Bz(s),r=Bz(a),C=t(f),k=Hn(C==null?void 0:C.className,n==null?void 0:n.className,u,a==null?void 0:a.className,s==null?void 0:s.className),I={...C==null?void 0:C.style,...n==null?void 0:n.style,...a==null?void 0:a.style,...s==null?void 0:s.style},P={...C,...n,...r,..._};return k.length>0&&(P.className=k),Object.keys(I).length>0&&(P.style=I),{props:P,internalRef:C.ref}}function Ij(e,t,n){return typeof e=="function"?e(t,n):e}function Nx(e){var I;const{elementType:t,externalSlotProps:n,ownerState:s,skipResolvingSlotProps:a=!1,...u}=e,f=a?{}:Ij(n,s),{props:_,internalRef:r}=Tj({...u,externalSlotProps:f}),C=mo(r,f==null?void 0:f.ref,(I=e.additionalProps)==null?void 0:I.ref);return xy(t,{..._,ref:C},s)}function $h(e){var t;return parseInt(X.version,10)>=19?((t=e==null?void 0:e.props)==null?void 0:t.ref)||null:(e==null?void 0:e.ref)||null}const fK=X.createContext(),au=()=>X.useContext(fK)??!1,pK=X.createContext(void 0);function mK(e){const{theme:t,name:n,props:s}=e;if(!t||!t.components||!t.components[n])return s;const a=t.components[n];return a.defaultProps?Qy(a.defaultProps,s):!a.styleOverrides&&!a.variants?Qy(a,s):s}function gK({props:e,name:t}){const n=X.useContext(pK);return mK({props:e,name:t,theme:{components:n}})}const jz={theme:void 0};function yK(e){let t,n;return function(a){let u=t;return(u===void 0||a.theme!==n)&&(jz.theme=a.theme,u=_j(e(jz)),t=u,n=a.theme),u}}function _K(e=""){function t(...s){if(!s.length)return"";const a=s[0];return typeof a=="string"&&!a.match(/(#|\(|\)|(-?(\d*\.)?\d+)(px|em|%|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc))|^(-?(\d*\.)?\d+)$|(\d+ \d+ \d+)/)?`, var(--${e?`${e}-`:""}${a}${t(...s.slice(1))})`:`, ${a}`}return(s,...a)=>`var(--${e?`${e}-`:""}${s}${t(...a)})`}const Vz=(e,t,n,s=[])=>{let a=e;t.forEach((u,f)=>{f===t.length-1?Array.isArray(a)?a[Number(u)]=n:a&&typeof a=="object"&&(a[u]=n):a&&typeof a=="object"&&(a[u]||(a[u]=s.includes(u)?[]:{}),a=a[u])})},vK=(e,t,n)=>{function s(a,u=[],f=[]){Object.entries(a).forEach(([_,r])=>{(!n||n&&!n([...u,_]))&&r!=null&&(typeof r=="object"&&Object.keys(r).length>0?s(r,[...u,_],Array.isArray(r)?[...f,_]:f):t([...u,_],r,f))})}s(e)},xK=(e,t)=>typeof t=="number"?["lineHeight","fontWeight","opacity","zIndex"].some(s=>e.includes(s))||e[e.length-1].toLowerCase().includes("opacity")?t:`${t}px`:t;function _k(e,t){const{prefix:n,shouldSkipGeneratingVar:s}=t||{},a={},u={},f={};return vK(e,(_,r,C)=>{if((typeof r=="string"||typeof r=="number")&&(!s||!s(_,r))){const k=`--${n?`${n}-`:""}${_.join("-")}`,I=xK(_,r);Object.assign(a,{[k]:I}),Vz(u,_,`var(${k})`,C),Vz(f,_,`var(${k}, ${I})`,C)}},_=>_[0]==="vars"),{css:a,vars:u,varsWithDefaults:f}}function bK(e,t={}){const{getSelector:n=W,disableCssColorScheme:s,colorSchemeSelector:a}=t,{colorSchemes:u={},components:f,defaultColorScheme:_="light",...r}=e,{vars:C,css:k,varsWithDefaults:I}=_k(r,t);let P=I;const D={},{[_]:N,...j}=u;if(Object.entries(j||{}).forEach(([Z,re])=>{const{vars:le,css:_e,varsWithDefaults:ye}=_k(re,t);P=ml(P,ye),D[Z]={css:_e,vars:le}}),N){const{css:Z,vars:re,varsWithDefaults:le}=_k(N,t);P=ml(P,le),D[_]={css:Z,vars:re}}function W(Z,re){var _e,ye;let le=a;if(a==="class"&&(le=".%s"),a==="data"&&(le="[data-%s]"),a!=null&&a.startsWith("data-")&&!a.includes("%s")&&(le=`[${a}="%s"]`),Z){if(le==="media")return e.defaultColorScheme===Z?":root":{[`@media (prefers-color-scheme: ${((ye=(_e=u[Z])==null?void 0:_e.palette)==null?void 0:ye.mode)||Z})`]:{":root":re}};if(le)return e.defaultColorScheme===Z?`:root, ${le.replace("%s",String(Z))}`:le.replace("%s",String(Z))}return":root"}return{vars:P,generateThemeVars:()=>{let Z={...C};return Object.entries(D).forEach(([,{vars:re}])=>{Z=ml(Z,re)}),Z},generateStyleSheets:()=>{var de,ce;const Z=[],re=e.defaultColorScheme||"light";function le(oe,xe){Object.keys(xe).length&&Z.push(typeof oe=="string"?{[oe]:{...xe}}:oe)}le(n(void 0,{...k}),k);const{[re]:_e,...ye}=D;if(_e){const{css:oe}=_e,xe=(ce=(de=u[re])==null?void 0:de.palette)==null?void 0:ce.mode,he=!s&&xe?{colorScheme:xe,...oe}:{...oe};le(n(re,{...he}),he)}return Object.entries(ye).forEach(([oe,{css:xe}])=>{var se,we;const he=(we=(se=u[oe])==null?void 0:se.palette)==null?void 0:we.mode,Ee=!s&&he?{colorScheme:he,...xe}:{...xe};le(n(oe,{...Ee}),Ee)}),Z}}}function wK(e){return function(n){return e==="media"?`@media (prefers-color-scheme: ${n})`:e?e.startsWith("data-")&&!e.includes("%s")?`[${e}="${n}"] &`:e==="class"?`.${n} &`:e==="data"?`[data-${n}] &`:`${e.replace("%s",n)} &`:"&"}}function kj(){return{text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:Ox.white,default:Ox.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}}}const SK=kj();function Mj(){return{text:{primary:Ox.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:Ox.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}}}const $z=Mj();function Uz(e,t,n,s){const a=s.light||s,u=s.dark||s*1.5;e[t]||(e.hasOwnProperty(n)?e[t]=e[n]:t==="light"?e.light=Fm(e.main,a):t==="dark"&&(e.dark=zm(e.main,u)))}function CK(e="light"){return e==="dark"?{main:Vg[200],light:Vg[50],dark:Vg[400]}:{main:Vg[700],light:Vg[400],dark:Vg[800]}}function EK(e="light"){return e==="dark"?{main:jg[200],light:jg[50],dark:jg[400]}:{main:jg[500],light:jg[300],dark:jg[700]}}function TK(e="light"){return e==="dark"?{main:Bg[500],light:Bg[300],dark:Bg[700]}:{main:Bg[700],light:Bg[400],dark:Bg[800]}}function IK(e="light"){return e==="dark"?{main:$g[400],light:$g[300],dark:$g[700]}:{main:$g[700],light:$g[500],dark:$g[900]}}function kK(e="light"){return e==="dark"?{main:Ug[400],light:Ug[300],dark:Ug[700]}:{main:Ug[800],light:Ug[500],dark:Ug[900]}}function MK(e="light"){return e==="dark"?{main:pv[400],light:pv[300],dark:pv[700]}:{main:"#ed6c02",light:pv[500],dark:pv[900]}}function oA(e){const{mode:t="light",contrastThreshold:n=3,tonalOffset:s=.2,...a}=e,u=e.primary||CK(t),f=e.secondary||EK(t),_=e.error||TK(t),r=e.info||IK(t),C=e.success||kK(t),k=e.warning||MK(t);function I(j){return lK(j,$z.text.primary)>=n?$z.text.primary:SK.text.primary}const P=({color:j,name:W,mainShade:H=500,lightShade:q=300,darkShade:Z=700})=>{if(j={...j},!j.main&&j[H]&&(j.main=j[H]),!j.hasOwnProperty("main"))throw new Error(zh(11,W?` (${W})`:"",H));if(typeof j.main!="string")throw new Error(zh(12,W?` (${W})`:"",JSON.stringify(j.main)));return Uz(j,"light",q,s),Uz(j,"dark",Z,s),j.contrastText||(j.contrastText=I(j.main)),j};let D;return t==="light"?D=kj():t==="dark"&&(D=Mj()),ml({common:{...Ox},mode:t,primary:P({color:u,name:"primary"}),secondary:P({color:f,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:P({color:_,name:"error"}),warning:P({color:k,name:"warning"}),info:P({color:r,name:"info"}),success:P({color:C,name:"success"}),grey:LX,contrastThreshold:n,getContrastText:I,augmentColor:P,tonalOffset:s,...D},a)}function PK(e){const t={};return Object.entries(e).forEach(s=>{const[a,u]=s;typeof u=="object"&&(t[a]=`${u.fontStyle?`${u.fontStyle} `:""}${u.fontVariant?`${u.fontVariant} `:""}${u.fontWeight?`${u.fontWeight} `:""}${u.fontStretch?`${u.fontStretch} `:""}${u.fontSize||""}${u.lineHeight?`/${u.lineHeight} `:""}${u.fontFamily||""}`)}),t}function AK(e,t){return{toolbar:{minHeight:56,[e.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[e.up("sm")]:{minHeight:64}},...t}}function LK(e){return Math.round(e*1e5)/1e5}const Gz={textTransform:"uppercase"},Hz='"Roboto", "Helvetica", "Arial", sans-serif';function RK(e,t){const{fontFamily:n=Hz,fontSize:s=14,fontWeightLight:a=300,fontWeightRegular:u=400,fontWeightMedium:f=500,fontWeightBold:_=700,htmlFontSize:r=16,allVariants:C,pxToRem:k,...I}=typeof t=="function"?t(e):t,P=s/14,D=k||(W=>`${W/r*P}rem`),N=(W,H,q,Z,re)=>({fontFamily:n,fontWeight:W,fontSize:D(H),lineHeight:q,...n===Hz?{letterSpacing:`${LK(Z/H)}em`}:{},...re,...C}),j={h1:N(a,96,1.167,-1.5),h2:N(a,60,1.2,-.5),h3:N(u,48,1.167,0),h4:N(u,34,1.235,.25),h5:N(u,24,1.334,0),h6:N(f,20,1.6,.15),subtitle1:N(u,16,1.75,.15),subtitle2:N(f,14,1.57,.1),body1:N(u,16,1.5,.15),body2:N(u,14,1.43,.15),button:N(f,14,1.75,.4,Gz),caption:N(u,12,1.66,.4),overline:N(u,12,2.66,1,Gz),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return ml({htmlFontSize:r,pxToRem:D,fontFamily:n,fontSize:s,fontWeightLight:a,fontWeightRegular:u,fontWeightMedium:f,fontWeightBold:_,...j},I,{clone:!1})}const OK=.2,DK=.14,zK=.12;function _s(...e){return[`${e[0]}px ${e[1]}px ${e[2]}px ${e[3]}px rgba(0,0,0,${OK})`,`${e[4]}px ${e[5]}px ${e[6]}px ${e[7]}px rgba(0,0,0,${DK})`,`${e[8]}px ${e[9]}px ${e[10]}px ${e[11]}px rgba(0,0,0,${zK})`].join(",")}const FK=["none",_s(0,2,1,-1,0,1,1,0,0,1,3,0),_s(0,3,1,-2,0,2,2,0,0,1,5,0),_s(0,3,3,-2,0,3,4,0,0,1,8,0),_s(0,2,4,-1,0,4,5,0,0,1,10,0),_s(0,3,5,-1,0,5,8,0,0,1,14,0),_s(0,3,5,-1,0,6,10,0,0,1,18,0),_s(0,4,5,-2,0,7,10,1,0,2,16,1),_s(0,5,5,-3,0,8,10,1,0,3,14,2),_s(0,5,6,-3,0,9,12,1,0,3,16,2),_s(0,6,6,-3,0,10,14,1,0,4,18,3),_s(0,6,7,-4,0,11,15,1,0,4,20,3),_s(0,7,8,-4,0,12,17,2,0,5,22,4),_s(0,7,8,-4,0,13,19,2,0,5,24,4),_s(0,7,9,-4,0,14,21,2,0,5,26,4),_s(0,8,9,-5,0,15,22,2,0,6,28,5),_s(0,8,10,-5,0,16,24,2,0,6,30,5),_s(0,8,11,-5,0,17,26,2,0,6,32,5),_s(0,9,11,-5,0,18,28,2,0,7,34,6),_s(0,9,12,-6,0,19,29,2,0,7,36,6),_s(0,10,13,-6,0,20,31,3,0,8,38,7),_s(0,10,13,-6,0,21,33,3,0,8,40,7),_s(0,10,14,-6,0,22,35,3,0,8,42,7),_s(0,11,14,-7,0,23,36,3,0,9,44,8),_s(0,11,15,-7,0,24,38,3,0,9,46,8)],NK={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},BK={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function Wz(e){return`${Math.round(e)}ms`}function jK(e){if(!e)return 0;const t=e/36;return Math.min(Math.round((4+15*t**.25+t/5)*10),3e3)}function VK(e){const t={...NK,...e.easing},n={...BK,...e.duration};return{getAutoHeightDuration:jK,create:(a=["all"],u={})=>{const{duration:f=n.standard,easing:_=t.easeInOut,delay:r=0,...C}=u;return(Array.isArray(a)?a:[a]).map(k=>`${k} ${typeof f=="string"?f:Wz(f)} ${_} ${typeof r=="string"?r:Wz(r)}`).join(",")},...e,easing:t,duration:n}}const $K={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500};function iP(e={},...t){const{breakpoints:n,mixins:s={},spacing:a,palette:u={},transitions:f={},typography:_={},shape:r,...C}=e;if(e.vars)throw new Error(zh(20));const k=oA(u),I=Q2(e);let P=ml(I,{mixins:AK(I.breakpoints,s),palette:k,shadows:FK.slice(),typography:RK(k,_),transitions:VK(f),zIndex:{...$K}});return P=ml(P,C),P=t.reduce((D,N)=>ml(D,N),P),P.unstable_sxConfig={...a1,...C==null?void 0:C.unstable_sxConfig},P.unstable_sx=function(N){return Tm({sx:N,theme:this})},P}function oP(e){let t;return e<1?t=5.11916*e**2:t=4.5*Math.log(e+1)+2,Math.round(t*10)/1e3}const UK=[...Array(25)].map((e,t)=>{if(t===0)return"none";const n=oP(t);return`linear-gradient(rgba(255 255 255 / ${n}), rgba(255 255 255 / ${n}))`});function Pj(e){return{inputPlaceholder:e==="dark"?.5:.42,inputUnderline:e==="dark"?.7:.42,switchTrackDisabled:e==="dark"?.2:.12,switchTrack:e==="dark"?.3:.38}}function Aj(e){return e==="dark"?UK:[]}function GK(e){const{palette:t={mode:"light"},opacity:n,overlays:s,...a}=e,u=oA(t);return{palette:u,opacity:{...Pj(u.mode),...n},overlays:s||Aj(u.mode),...a}}function HK(e){var t;return!!e[0].match(/(cssVarPrefix|colorSchemeSelector|rootSelector|typography|mixins|breakpoints|direction|transitions)/)||!!e[0].match(/sxConfig$/)||e[0]==="palette"&&!!((t=e[1])!=null&&t.match(/(mode|contrastThreshold|tonalOffset)/))}const WK=e=>[...[...Array(25)].map((t,n)=>`--${e?`${e}-`:""}overlays-${n}`),`--${e?`${e}-`:""}palette-AppBar-darkBg`,`--${e?`${e}-`:""}palette-AppBar-darkColor`],qK=e=>(t,n)=>{const s=e.rootSelector||":root",a=e.colorSchemeSelector;let u=a;if(a==="class"&&(u=".%s"),a==="data"&&(u="[data-%s]"),a!=null&&a.startsWith("data-")&&!a.includes("%s")&&(u=`[${a}="%s"]`),e.defaultColorScheme===t){if(t==="dark"){const f={};return WK(e.cssVarPrefix).forEach(_=>{f[_]=n[_],delete n[_]}),u==="media"?{[s]:n,"@media (prefers-color-scheme: dark)":{[s]:f}}:u?{[u.replace("%s",t)]:f,[`${s}, ${u.replace("%s",t)}`]:n}:{[s]:{...n,...f}}}if(u&&u!=="media")return`${s}, ${u.replace("%s",String(t))}`}else if(t){if(u==="media")return{[`@media (prefers-color-scheme: ${String(t)})`]:{[s]:n}};if(u)return u.replace("%s",String(t))}return s};function XK(e){return zd(e)||typeof e>"u"||typeof e=="string"||typeof e=="boolean"||typeof e=="number"||Array.isArray(e)}function YK(e={}){const t={...e};function n(s){const a=Object.entries(s);for(let u=0;u<a.length;u++){const[f,_]=a[u];!XK(_)||f.startsWith("unstable_")?delete s[f]:zd(_)&&(s[f]={..._},n(s[f]))}}return n(t),`import { unstable_createBreakpoints as createBreakpoints, createTransitions } from '@mui/material/styles';

const theme = ${JSON.stringify(t,null,2)};

theme.breakpoints = createBreakpoints(theme.breakpoints || {});
theme.transitions = createTransitions(theme.transitions || {});

export default theme;`}function ZK(e,t){t.forEach(n=>{e[n]||(e[n]={})})}function Un(e,t,n){!e[t]&&n&&(e[t]=n)}function Hv(e){return!e||!e.startsWith("hsl")?e:wj(e)}function mh(e,t){`${t}Channel`in e||(e[`${t}Channel`]=Gv(Hv(e[t]),`MUI: Can't create \`palette.${t}Channel\` because \`palette.${t}\` is not one of these formats: #nnn, #nnnnnn, rgb(), rgba(), hsl(), hsla(), color().
To suppress this warning, you need to explicitly provide the \`palette.${t}Channel\` as a string (in rgb format, for example "12 12 12") or undefined if you want to remove the channel token.`))}function KK(e){return typeof e=="number"?`${e}px`:typeof e=="string"||typeof e=="function"||Array.isArray(e)?e:"8px"}const kd=e=>{try{return e()}catch{}},JK=(e="mui")=>_K(e);function vk(e,t,n,s){if(!t)return;t=t===!0?{}:t;const a=s==="dark"?"dark":"light";if(!n){e[s]=GK({...t,palette:{mode:a,...t==null?void 0:t.palette}});return}const{palette:u,...f}=iP({...n,palette:{mode:a,...t==null?void 0:t.palette}});return e[s]={...t,palette:u,opacity:{...Pj(a),...t==null?void 0:t.opacity},overlays:(t==null?void 0:t.overlays)||Aj(a)},f}function QK(e={},...t){const{colorSchemes:n={light:!0},defaultColorScheme:s,disableCssColorScheme:a=!1,cssVarPrefix:u="mui",shouldSkipGeneratingVar:f=HK,colorSchemeSelector:_=n.light&&n.dark?"media":void 0,rootSelector:r=":root",...C}=e,k=Object.keys(n)[0],I=s||(n.light&&k!=="light"?"light":k),P=JK(u),{[I]:D,light:N,dark:j,...W}=n,H={...W};let q=D;if((I==="dark"&&!("dark"in n)||I==="light"&&!("light"in n))&&(q=!0),!q)throw new Error(zh(21,I));const Z=vk(H,q,C,I);N&&!H.light&&vk(H,N,void 0,"light"),j&&!H.dark&&vk(H,j,void 0,"dark");let re={defaultColorScheme:I,...Z,cssVarPrefix:u,colorSchemeSelector:_,rootSelector:r,getCssVar:P,colorSchemes:H,font:{...PK(Z.typography),...Z.font},spacing:KK(C.spacing)};Object.keys(re.colorSchemes).forEach(ce=>{const oe=re.colorSchemes[ce].palette,xe=he=>{const Ee=he.split("-"),se=Ee[1],we=Ee[2];return P(he,oe[se][we])};if(oe.mode==="light"&&(Un(oe.common,"background","#fff"),Un(oe.common,"onBackground","#000")),oe.mode==="dark"&&(Un(oe.common,"background","#000"),Un(oe.common,"onBackground","#fff")),ZK(oe,["Alert","AppBar","Avatar","Button","Chip","FilledInput","LinearProgress","Skeleton","Slider","SnackbarContent","SpeedDialAction","StepConnector","StepContent","Switch","TableCell","Tooltip"]),oe.mode==="light"){Un(oe.Alert,"errorColor",es(oe.error.light,.6)),Un(oe.Alert,"infoColor",es(oe.info.light,.6)),Un(oe.Alert,"successColor",es(oe.success.light,.6)),Un(oe.Alert,"warningColor",es(oe.warning.light,.6)),Un(oe.Alert,"errorFilledBg",xe("palette-error-main")),Un(oe.Alert,"infoFilledBg",xe("palette-info-main")),Un(oe.Alert,"successFilledBg",xe("palette-success-main")),Un(oe.Alert,"warningFilledBg",xe("palette-warning-main")),Un(oe.Alert,"errorFilledColor",kd(()=>oe.getContrastText(oe.error.main))),Un(oe.Alert,"infoFilledColor",kd(()=>oe.getContrastText(oe.info.main))),Un(oe.Alert,"successFilledColor",kd(()=>oe.getContrastText(oe.success.main))),Un(oe.Alert,"warningFilledColor",kd(()=>oe.getContrastText(oe.warning.main))),Un(oe.Alert,"errorStandardBg",ts(oe.error.light,.9)),Un(oe.Alert,"infoStandardBg",ts(oe.info.light,.9)),Un(oe.Alert,"successStandardBg",ts(oe.success.light,.9)),Un(oe.Alert,"warningStandardBg",ts(oe.warning.light,.9)),Un(oe.Alert,"errorIconColor",xe("palette-error-main")),Un(oe.Alert,"infoIconColor",xe("palette-info-main")),Un(oe.Alert,"successIconColor",xe("palette-success-main")),Un(oe.Alert,"warningIconColor",xe("palette-warning-main")),Un(oe.AppBar,"defaultBg",xe("palette-grey-100")),Un(oe.Avatar,"defaultBg",xe("palette-grey-400")),Un(oe.Button,"inheritContainedBg",xe("palette-grey-300")),Un(oe.Button,"inheritContainedHoverBg",xe("palette-grey-A100")),Un(oe.Chip,"defaultBorder",xe("palette-grey-400")),Un(oe.Chip,"defaultAvatarColor",xe("palette-grey-700")),Un(oe.Chip,"defaultIconColor",xe("palette-grey-700")),Un(oe.FilledInput,"bg","rgba(0, 0, 0, 0.06)"),Un(oe.FilledInput,"hoverBg","rgba(0, 0, 0, 0.09)"),Un(oe.FilledInput,"disabledBg","rgba(0, 0, 0, 0.12)"),Un(oe.LinearProgress,"primaryBg",ts(oe.primary.main,.62)),Un(oe.LinearProgress,"secondaryBg",ts(oe.secondary.main,.62)),Un(oe.LinearProgress,"errorBg",ts(oe.error.main,.62)),Un(oe.LinearProgress,"infoBg",ts(oe.info.main,.62)),Un(oe.LinearProgress,"successBg",ts(oe.success.main,.62)),Un(oe.LinearProgress,"warningBg",ts(oe.warning.main,.62)),Un(oe.Skeleton,"bg",`rgba(${xe("palette-text-primaryChannel")} / 0.11)`),Un(oe.Slider,"primaryTrack",ts(oe.primary.main,.62)),Un(oe.Slider,"secondaryTrack",ts(oe.secondary.main,.62)),Un(oe.Slider,"errorTrack",ts(oe.error.main,.62)),Un(oe.Slider,"infoTrack",ts(oe.info.main,.62)),Un(oe.Slider,"successTrack",ts(oe.success.main,.62)),Un(oe.Slider,"warningTrack",ts(oe.warning.main,.62));const he=Iw(oe.background.default,.8);Un(oe.SnackbarContent,"bg",he),Un(oe.SnackbarContent,"color",kd(()=>oe.getContrastText(he))),Un(oe.SpeedDialAction,"fabHoverBg",Iw(oe.background.paper,.15)),Un(oe.StepConnector,"border",xe("palette-grey-400")),Un(oe.StepContent,"border",xe("palette-grey-400")),Un(oe.Switch,"defaultColor",xe("palette-common-white")),Un(oe.Switch,"defaultDisabledColor",xe("palette-grey-100")),Un(oe.Switch,"primaryDisabledColor",ts(oe.primary.main,.62)),Un(oe.Switch,"secondaryDisabledColor",ts(oe.secondary.main,.62)),Un(oe.Switch,"errorDisabledColor",ts(oe.error.main,.62)),Un(oe.Switch,"infoDisabledColor",ts(oe.info.main,.62)),Un(oe.Switch,"successDisabledColor",ts(oe.success.main,.62)),Un(oe.Switch,"warningDisabledColor",ts(oe.warning.main,.62)),Un(oe.TableCell,"border",ts(Tw(oe.divider,1),.88)),Un(oe.Tooltip,"bg",Tw(oe.grey[700],.92))}if(oe.mode==="dark"){Un(oe.Alert,"errorColor",ts(oe.error.light,.6)),Un(oe.Alert,"infoColor",ts(oe.info.light,.6)),Un(oe.Alert,"successColor",ts(oe.success.light,.6)),Un(oe.Alert,"warningColor",ts(oe.warning.light,.6)),Un(oe.Alert,"errorFilledBg",xe("palette-error-dark")),Un(oe.Alert,"infoFilledBg",xe("palette-info-dark")),Un(oe.Alert,"successFilledBg",xe("palette-success-dark")),Un(oe.Alert,"warningFilledBg",xe("palette-warning-dark")),Un(oe.Alert,"errorFilledColor",kd(()=>oe.getContrastText(oe.error.dark))),Un(oe.Alert,"infoFilledColor",kd(()=>oe.getContrastText(oe.info.dark))),Un(oe.Alert,"successFilledColor",kd(()=>oe.getContrastText(oe.success.dark))),Un(oe.Alert,"warningFilledColor",kd(()=>oe.getContrastText(oe.warning.dark))),Un(oe.Alert,"errorStandardBg",es(oe.error.light,.9)),Un(oe.Alert,"infoStandardBg",es(oe.info.light,.9)),Un(oe.Alert,"successStandardBg",es(oe.success.light,.9)),Un(oe.Alert,"warningStandardBg",es(oe.warning.light,.9)),Un(oe.Alert,"errorIconColor",xe("palette-error-main")),Un(oe.Alert,"infoIconColor",xe("palette-info-main")),Un(oe.Alert,"successIconColor",xe("palette-success-main")),Un(oe.Alert,"warningIconColor",xe("palette-warning-main")),Un(oe.AppBar,"defaultBg",xe("palette-grey-900")),Un(oe.AppBar,"darkBg",xe("palette-background-paper")),Un(oe.AppBar,"darkColor",xe("palette-text-primary")),Un(oe.Avatar,"defaultBg",xe("palette-grey-600")),Un(oe.Button,"inheritContainedBg",xe("palette-grey-800")),Un(oe.Button,"inheritContainedHoverBg",xe("palette-grey-700")),Un(oe.Chip,"defaultBorder",xe("palette-grey-700")),Un(oe.Chip,"defaultAvatarColor",xe("palette-grey-300")),Un(oe.Chip,"defaultIconColor",xe("palette-grey-300")),Un(oe.FilledInput,"bg","rgba(255, 255, 255, 0.09)"),Un(oe.FilledInput,"hoverBg","rgba(255, 255, 255, 0.13)"),Un(oe.FilledInput,"disabledBg","rgba(255, 255, 255, 0.12)"),Un(oe.LinearProgress,"primaryBg",es(oe.primary.main,.5)),Un(oe.LinearProgress,"secondaryBg",es(oe.secondary.main,.5)),Un(oe.LinearProgress,"errorBg",es(oe.error.main,.5)),Un(oe.LinearProgress,"infoBg",es(oe.info.main,.5)),Un(oe.LinearProgress,"successBg",es(oe.success.main,.5)),Un(oe.LinearProgress,"warningBg",es(oe.warning.main,.5)),Un(oe.Skeleton,"bg",`rgba(${xe("palette-text-primaryChannel")} / 0.13)`),Un(oe.Slider,"primaryTrack",es(oe.primary.main,.5)),Un(oe.Slider,"secondaryTrack",es(oe.secondary.main,.5)),Un(oe.Slider,"errorTrack",es(oe.error.main,.5)),Un(oe.Slider,"infoTrack",es(oe.info.main,.5)),Un(oe.Slider,"successTrack",es(oe.success.main,.5)),Un(oe.Slider,"warningTrack",es(oe.warning.main,.5));const he=Iw(oe.background.default,.98);Un(oe.SnackbarContent,"bg",he),Un(oe.SnackbarContent,"color",kd(()=>oe.getContrastText(he))),Un(oe.SpeedDialAction,"fabHoverBg",Iw(oe.background.paper,.15)),Un(oe.StepConnector,"border",xe("palette-grey-600")),Un(oe.StepContent,"border",xe("palette-grey-600")),Un(oe.Switch,"defaultColor",xe("palette-grey-300")),Un(oe.Switch,"defaultDisabledColor",xe("palette-grey-600")),Un(oe.Switch,"primaryDisabledColor",es(oe.primary.main,.55)),Un(oe.Switch,"secondaryDisabledColor",es(oe.secondary.main,.55)),Un(oe.Switch,"errorDisabledColor",es(oe.error.main,.55)),Un(oe.Switch,"infoDisabledColor",es(oe.info.main,.55)),Un(oe.Switch,"successDisabledColor",es(oe.success.main,.55)),Un(oe.Switch,"warningDisabledColor",es(oe.warning.main,.55)),Un(oe.TableCell,"border",es(Tw(oe.divider,1),.68)),Un(oe.Tooltip,"bg",Tw(oe.grey[700],.92))}mh(oe.background,"default"),mh(oe.background,"paper"),mh(oe.common,"background"),mh(oe.common,"onBackground"),mh(oe,"divider"),Object.keys(oe).forEach(he=>{const Ee=oe[he];Ee&&typeof Ee=="object"&&(Ee.main&&Un(oe[he],"mainChannel",Gv(Hv(Ee.main))),Ee.light&&Un(oe[he],"lightChannel",Gv(Hv(Ee.light))),Ee.dark&&Un(oe[he],"darkChannel",Gv(Hv(Ee.dark))),Ee.contrastText&&Un(oe[he],"contrastTextChannel",Gv(Hv(Ee.contrastText))),he==="text"&&(mh(oe[he],"primary"),mh(oe[he],"secondary")),he==="action"&&(Ee.active&&mh(oe[he],"active"),Ee.selected&&mh(oe[he],"selected")))})}),re=t.reduce((ce,oe)=>ml(ce,oe),re);const le={prefix:u,disableCssColorScheme:a,shouldSkipGeneratingVar:f,getSelector:qK(re)},{vars:_e,generateThemeVars:ye,generateStyleSheets:de}=bK(re,le);return re.vars=_e,Object.entries(re.colorSchemes[re.defaultColorScheme]).forEach(([ce,oe])=>{re[ce]=oe}),re.generateThemeVars=ye,re.generateStyleSheets=de,re.generateSpacing=function(){return fj(C.spacing,K2(this))},re.getColorSchemeSelector=wK(_),re.spacing=re.generateSpacing(),re.shouldSkipGeneratingVar=f,re.unstable_sxConfig={...a1,...C==null?void 0:C.unstable_sxConfig},re.unstable_sx=function(oe){return Tm({sx:oe,theme:this})},re.toRuntimeSource=YK,re}function qz(e,t,n){e.colorSchemes&&n&&(e.colorSchemes[t]={...n!==!0&&n,palette:oA({...n===!0?{}:n.palette,mode:t})})}function Lj(e={},...t){const{palette:n,cssVariables:s=!1,colorSchemes:a=n?void 0:{light:!0},defaultColorScheme:u=n==null?void 0:n.mode,...f}=e,_=u||"light",r=a==null?void 0:a[_],C={...a,...n?{[_]:{...typeof r!="boolean"&&r,palette:n}}:void 0};if(s===!1){if(!("colorSchemes"in e))return iP(e,...t);let k=n;"palette"in e||C[_]&&(C[_]!==!0?k=C[_].palette:_==="dark"&&(k={mode:"dark"}));const I=iP({...e,palette:k},...t);return I.defaultColorScheme=_,I.colorSchemes=C,I.palette.mode==="light"&&(I.colorSchemes.light={...C.light!==!0&&C.light,palette:I.palette},qz(I,"dark",C.dark)),I.palette.mode==="dark"&&(I.colorSchemes.dark={...C.dark!==!0&&C.dark,palette:I.palette},qz(I,"light",C.light)),I}return!n&&!("light"in C)&&_==="light"&&(C.light=!0),QK({...f,colorSchemes:C,defaultColorScheme:_,...typeof s!="boolean"&&s},...t)}function eJ(e){return String(e).match(/[\d.\-+]*\s*(.*)/)[1]||""}function tJ(e){return parseFloat(e)}const TE=Lj();function Uh(){const e=fE(TE);return e[r1]||e}function Rj({props:e,name:t}){return oK({props:e,name:t,defaultTheme:TE,themeId:r1})}function Oj(e){return e!=="ownerState"&&e!=="theme"&&e!=="sx"&&e!=="as"}const Ha=e=>Oj(e)&&e!=="classes",Dn=xj({themeId:r1,defaultTheme:TE,rootShouldForwardProp:Ha});function nJ(e){return K.jsx(GZ,{...e,defaultTheme:TE,themeId:r1})}function rJ(e){return function(n){return K.jsx(nJ,{styles:typeof e=="function"?s=>e({theme:s,...n}):e})}}function iJ(){return pj}const $r=yK;function xi(e){return gK(e)}function oJ(e){return gi("MuiSvgIcon",e)}pi("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const sJ=e=>{const{color:t,fontSize:n,classes:s}=e,a={root:["root",t!=="inherit"&&`color${Rn(t)}`,`fontSize${Rn(n)}`]};return yr(a,oJ,s)},aJ=Dn("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.color!=="inherit"&&t[`color${Rn(n.color)}`],t[`fontSize${Rn(n.fontSize)}`]]}})($r(({theme:e})=>{var t,n,s,a,u,f,_,r,C,k,I,P,D,N;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",flexShrink:0,transition:(a=(t=e.transitions)==null?void 0:t.create)==null?void 0:a.call(t,"fill",{duration:(s=(n=(e.vars??e).transitions)==null?void 0:n.duration)==null?void 0:s.shorter}),variants:[{props:j=>!j.hasSvgAsChild,style:{fill:"currentColor"}},{props:{fontSize:"inherit"},style:{fontSize:"inherit"}},{props:{fontSize:"small"},style:{fontSize:((f=(u=e.typography)==null?void 0:u.pxToRem)==null?void 0:f.call(u,20))||"1.25rem"}},{props:{fontSize:"medium"},style:{fontSize:((r=(_=e.typography)==null?void 0:_.pxToRem)==null?void 0:r.call(_,24))||"1.5rem"}},{props:{fontSize:"large"},style:{fontSize:((k=(C=e.typography)==null?void 0:C.pxToRem)==null?void 0:k.call(C,35))||"2.1875rem"}},...Object.entries((e.vars??e).palette).filter(([,j])=>j&&j.main).map(([j])=>{var W,H;return{props:{color:j},style:{color:(H=(W=(e.vars??e).palette)==null?void 0:W[j])==null?void 0:H.main}}}),{props:{color:"action"},style:{color:(P=(I=(e.vars??e).palette)==null?void 0:I.action)==null?void 0:P.active}},{props:{color:"disabled"},style:{color:(N=(D=(e.vars??e).palette)==null?void 0:D.action)==null?void 0:N.disabled}},{props:{color:"inherit"},style:{color:void 0}}]}})),Bx=X.forwardRef(function(t,n){const s=xi({props:t,name:"MuiSvgIcon"}),{children:a,className:u,color:f="inherit",component:_="svg",fontSize:r="medium",htmlColor:C,inheritViewBox:k=!1,titleAccess:I,viewBox:P="0 0 24 24",...D}=s,N=X.isValidElement(a)&&a.type==="svg",j={...s,color:f,component:_,fontSize:r,instanceFontSize:t.fontSize,inheritViewBox:k,viewBox:P,hasSvgAsChild:N},W={};k||(W.viewBox=P);const H=sJ(j);return K.jsxs(aJ,{as:_,className:Hn(H.root,u),focusable:"false",color:C,"aria-hidden":I?void 0:!0,role:I?"img":void 0,ref:n,...W,...D,...N&&a.props,ownerState:j,children:[N?a.props.children:a,I?K.jsx("title",{children:I}):null]})});Bx&&(Bx.muiName="SvgIcon");function Jr(e,t){function n(s,a){return K.jsx(Bx,{"data-testid":`${t}Icon`,ref:a,...s,children:e})}return n.muiName=Bx.muiName,X.memo(X.forwardRef(n))}function Zr(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.includes(s))continue;n[s]=e[s]}return n}function sP(e,t){return sP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},sP(e,t)}function Dj(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,sP(e,t)}const Xz={disabled:!1},sC=Sr.createContext(null);var lJ=function(t){return t.scrollTop},Wv="unmounted",rm="exited",im="entering",ny="entered",aP="exiting",bc=function(e){Dj(t,e);function t(s,a){var u;u=e.call(this,s,a)||this;var f=a,_=f&&!f.isMounting?s.enter:s.appear,r;return u.appearStatus=null,s.in?_?(r=rm,u.appearStatus=im):r=ny:s.unmountOnExit||s.mountOnEnter?r=Wv:r=rm,u.state={status:r},u.nextCallback=null,u}t.getDerivedStateFromProps=function(a,u){var f=a.in;return f&&u.status===Wv?{status:rm}:null};var n=t.prototype;return n.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},n.componentDidUpdate=function(a){var u=null;if(a!==this.props){var f=this.state.status;this.props.in?f!==im&&f!==ny&&(u=im):(f===im||f===ny)&&(u=aP)}this.updateStatus(!1,u)},n.componentWillUnmount=function(){this.cancelNextCallback()},n.getTimeouts=function(){var a=this.props.timeout,u,f,_;return u=f=_=a,a!=null&&typeof a!="number"&&(u=a.exit,f=a.enter,_=a.appear!==void 0?a.appear:f),{exit:u,enter:f,appear:_}},n.updateStatus=function(a,u){if(a===void 0&&(a=!1),u!==null)if(this.cancelNextCallback(),u===im){if(this.props.unmountOnExit||this.props.mountOnEnter){var f=this.props.nodeRef?this.props.nodeRef.current:Vf.findDOMNode(this);f&&lJ(f)}this.performEnter(a)}else this.performExit();else this.props.unmountOnExit&&this.state.status===rm&&this.setState({status:Wv})},n.performEnter=function(a){var u=this,f=this.props.enter,_=this.context?this.context.isMounting:a,r=this.props.nodeRef?[_]:[Vf.findDOMNode(this),_],C=r[0],k=r[1],I=this.getTimeouts(),P=_?I.appear:I.enter;if(!a&&!f||Xz.disabled){this.safeSetState({status:ny},function(){u.props.onEntered(C)});return}this.props.onEnter(C,k),this.safeSetState({status:im},function(){u.props.onEntering(C,k),u.onTransitionEnd(P,function(){u.safeSetState({status:ny},function(){u.props.onEntered(C,k)})})})},n.performExit=function(){var a=this,u=this.props.exit,f=this.getTimeouts(),_=this.props.nodeRef?void 0:Vf.findDOMNode(this);if(!u||Xz.disabled){this.safeSetState({status:rm},function(){a.props.onExited(_)});return}this.props.onExit(_),this.safeSetState({status:aP},function(){a.props.onExiting(_),a.onTransitionEnd(f.exit,function(){a.safeSetState({status:rm},function(){a.props.onExited(_)})})})},n.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},n.safeSetState=function(a,u){u=this.setNextCallback(u),this.setState(a,u)},n.setNextCallback=function(a){var u=this,f=!0;return this.nextCallback=function(_){f&&(f=!1,u.nextCallback=null,a(_))},this.nextCallback.cancel=function(){f=!1},this.nextCallback},n.onTransitionEnd=function(a,u){this.setNextCallback(u);var f=this.props.nodeRef?this.props.nodeRef.current:Vf.findDOMNode(this),_=a==null&&!this.props.addEndListener;if(!f||_){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var r=this.props.nodeRef?[this.nextCallback]:[f,this.nextCallback],C=r[0],k=r[1];this.props.addEndListener(C,k)}a!=null&&setTimeout(this.nextCallback,a)},n.render=function(){var a=this.state.status;if(a===Wv)return null;var u=this.props,f=u.children;u.in,u.mountOnEnter,u.unmountOnExit,u.appear,u.enter,u.exit,u.timeout,u.addEndListener,u.onEnter,u.onEntering,u.onEntered,u.onExit,u.onExiting,u.onExited,u.nodeRef;var _=Zr(u,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return Sr.createElement(sC.Provider,{value:null},typeof f=="function"?f(a,_):Sr.cloneElement(Sr.Children.only(f),_))},t}(Sr.Component);bc.contextType=sC;bc.propTypes={};function Gg(){}bc.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:Gg,onEntering:Gg,onEntered:Gg,onExit:Gg,onExiting:Gg,onExited:Gg};bc.UNMOUNTED=Wv;bc.EXITED=rm;bc.ENTERING=im;bc.ENTERED=ny;bc.EXITING=aP;function uJ(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function sA(e,t){var n=function(u){return t&&X.isValidElement(u)?t(u):u},s=Object.create(null);return e&&X.Children.map(e,function(a){return a}).forEach(function(a){s[a.key]=n(a)}),s}function cJ(e,t){e=e||{},t=t||{};function n(k){return k in t?t[k]:e[k]}var s=Object.create(null),a=[];for(var u in e)u in t?a.length&&(s[u]=a,a=[]):a.push(u);var f,_={};for(var r in t){if(s[r])for(f=0;f<s[r].length;f++){var C=s[r][f];_[s[r][f]]=n(C)}_[r]=n(r)}for(f=0;f<a.length;f++)_[a[f]]=n(a[f]);return _}function dm(e,t,n){return n[t]!=null?n[t]:e.props[t]}function dJ(e,t){return sA(e.children,function(n){return X.cloneElement(n,{onExited:t.bind(null,n),in:!0,appear:dm(n,"appear",e),enter:dm(n,"enter",e),exit:dm(n,"exit",e)})})}function hJ(e,t,n){var s=sA(e.children),a=cJ(t,s);return Object.keys(a).forEach(function(u){var f=a[u];if(X.isValidElement(f)){var _=u in t,r=u in s,C=t[u],k=X.isValidElement(C)&&!C.props.in;r&&(!_||k)?a[u]=X.cloneElement(f,{onExited:n.bind(null,f),in:!0,exit:dm(f,"exit",e),enter:dm(f,"enter",e)}):!r&&_&&!k?a[u]=X.cloneElement(f,{in:!1}):r&&_&&X.isValidElement(C)&&(a[u]=X.cloneElement(f,{onExited:n.bind(null,f),in:C.props.in,exit:dm(f,"exit",e),enter:dm(f,"enter",e)}))}}),a}var fJ=Object.values||function(e){return Object.keys(e).map(function(t){return e[t]})},pJ={component:"div",childFactory:function(t){return t}},aA=function(e){Dj(t,e);function t(s,a){var u;u=e.call(this,s,a)||this;var f=u.handleExited.bind(uJ(u));return u.state={contextValue:{isMounting:!0},handleExited:f,firstRender:!0},u}var n=t.prototype;return n.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},n.componentWillUnmount=function(){this.mounted=!1},t.getDerivedStateFromProps=function(a,u){var f=u.children,_=u.handleExited,r=u.firstRender;return{children:r?dJ(a,_):hJ(a,f,_),firstRender:!1}},n.handleExited=function(a,u){var f=sA(this.props.children);a.key in f||(a.props.onExited&&a.props.onExited(u),this.mounted&&this.setState(function(_){var r=Ge({},_.children);return delete r[a.key],{children:r}}))},n.render=function(){var a=this.props,u=a.component,f=a.childFactory,_=Zr(a,["component","childFactory"]),r=this.state.contextValue,C=fJ(this.state.children).map(f);return delete _.appear,delete _.enter,delete _.exit,u===null?Sr.createElement(sC.Provider,{value:r},C):Sr.createElement(sC.Provider,{value:r},Sr.createElement(u,_,C))},t}(Sr.Component);aA.propTypes={};aA.defaultProps=pJ;const IE=e=>e.scrollTop;function ap(e,t){const{timeout:n,easing:s,style:a={}}=e;return{duration:a.transitionDuration??(typeof n=="number"?n:n[t.mode]||0),easing:a.transitionTimingFunction??(typeof s=="object"?s[t.mode]:s),delay:a.transitionDelay}}function mJ(e){return gi("MuiPaper",e)}pi("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const gJ=e=>{const{square:t,elevation:n,variant:s,classes:a}=e,u={root:["root",s,!t&&"rounded",s==="elevation"&&`elevation${n}`]};return yr(u,mJ,a)},yJ=Dn("div",{name:"MuiPaper",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.variant],!n.square&&t.rounded,n.variant==="elevation"&&t[`elevation${n.elevation}`]]}})($r(({theme:e})=>({backgroundColor:(e.vars||e).palette.background.paper,color:(e.vars||e).palette.text.primary,transition:e.transitions.create("box-shadow"),variants:[{props:({ownerState:t})=>!t.square,style:{borderRadius:e.shape.borderRadius}},{props:{variant:"outlined"},style:{border:`1px solid ${(e.vars||e).palette.divider}`}},{props:{variant:"elevation"},style:{boxShadow:"var(--Paper-shadow)",backgroundImage:"var(--Paper-overlay)"}}]}))),b0=X.forwardRef(function(t,n){var D;const s=xi({props:t,name:"MuiPaper"}),a=Uh(),{className:u,component:f="div",elevation:_=1,square:r=!1,variant:C="elevation",...k}=s,I={...s,component:f,elevation:_,square:r,variant:C},P=gJ(I);return K.jsx(yJ,{as:f,ownerState:I,className:Hn(P.root,u),ref:n,...k,style:{...C==="elevation"&&{"--Paper-shadow":(a.vars||a).shadows[_],...a.vars&&{"--Paper-overlay":(D=a.vars.overlays)==null?void 0:D[_]},...!a.vars&&a.palette.mode==="dark"&&{"--Paper-overlay":`linear-gradient(${vi("#fff",oP(_))}, ${vi("#fff",oP(_))})`}},...k.style}})});function pl(e,t){const{className:n,elementType:s,ownerState:a,externalForwardedProps:u,getSlotOwnerState:f,internalForwardedProps:_,...r}=t,{component:C,slots:k={[e]:void 0},slotProps:I={[e]:void 0},...P}=u,D=k[e]||s,N=Ij(I[e],a),{props:{component:j,...W},internalRef:H}=Tj({className:n,...r,externalForwardedProps:e==="root"?P:void 0,externalSlotProps:N}),q=mo(H,N==null?void 0:N.ref,t.ref),Z=f?f(W):{},re={...a,...Z},le=e==="root"?j||C:j,_e=xy(D,{...e==="root"&&!C&&!k[e]&&_,...e!=="root"&&!k[e]&&_,...W,...le&&{as:le},ref:q},re);return Object.keys(Z).forEach(ye=>{delete _e[ye]}),[D,_e]}class aC{constructor(){Q_(this,"mountEffect",()=>{this.shouldMount&&!this.didMount&&this.ref.current!==null&&(this.didMount=!0,this.mounted.resolve())});this.ref={current:null},this.mounted=null,this.didMount=!1,this.shouldMount=!1,this.setShouldMount=null}static create(){return new aC}static use(){const t=id(aC.create).current,[n,s]=X.useState(!1);return t.shouldMount=n,t.setShouldMount=s,X.useEffect(t.mountEffect,[n]),t}mount(){return this.mounted||(this.mounted=vJ(),this.shouldMount=!0,this.setShouldMount(this.shouldMount)),this.mounted}start(...t){this.mount().then(()=>{var n;return(n=this.ref.current)==null?void 0:n.start(...t)})}stop(...t){this.mount().then(()=>{var n;return(n=this.ref.current)==null?void 0:n.stop(...t)})}pulsate(...t){this.mount().then(()=>{var n;return(n=this.ref.current)==null?void 0:n.pulsate(...t)})}}function _J(){return aC.use()}function vJ(){let e,t;const n=new Promise((s,a)=>{e=s,t=a});return n.resolve=e,n.reject=t,n}function xJ(e){const{className:t,classes:n,pulsate:s=!1,rippleX:a,rippleY:u,rippleSize:f,in:_,onExited:r,timeout:C}=e,[k,I]=X.useState(!1),P=Hn(t,n.ripple,n.rippleVisible,s&&n.ripplePulsate),D={width:f,height:f,top:-(f/2)+u,left:-(f/2)+a},N=Hn(n.child,k&&n.childLeaving,s&&n.childPulsate);return!_&&!k&&I(!0),X.useEffect(()=>{if(!_&&r!=null){const j=setTimeout(r,C);return()=>{clearTimeout(j)}}},[r,_,C]),K.jsx("span",{className:P,style:D,children:K.jsx("span",{className:N})})}const tc=pi("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),lP=550,bJ=80,wJ=Jd`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`,SJ=Jd`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`,CJ=Jd`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`,EJ=Dn("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),TJ=Dn(xJ,{name:"MuiTouchRipple",slot:"Ripple"})`
  opacity: 0;
  position: absolute;

  &.${tc.rippleVisible} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${wJ};
    animation-duration: ${lP}ms;
    animation-timing-function: ${({theme:e})=>e.transitions.easing.easeInOut};
  }

  &.${tc.ripplePulsate} {
    animation-duration: ${({theme:e})=>e.transitions.duration.shorter}ms;
  }

  & .${tc.child} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${tc.childLeaving} {
    opacity: 0;
    animation-name: ${SJ};
    animation-duration: ${lP}ms;
    animation-timing-function: ${({theme:e})=>e.transitions.easing.easeInOut};
  }

  & .${tc.childPulsate} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${CJ};
    animation-duration: 2500ms;
    animation-timing-function: ${({theme:e})=>e.transitions.easing.easeInOut};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`,IJ=X.forwardRef(function(t,n){const s=xi({props:t,name:"MuiTouchRipple"}),{center:a=!1,classes:u={},className:f,..._}=s,[r,C]=X.useState([]),k=X.useRef(0),I=X.useRef(null);X.useEffect(()=>{I.current&&(I.current(),I.current=null)},[r]);const P=X.useRef(!1),D=Eu(),N=X.useRef(null),j=X.useRef(null),W=X.useCallback(re=>{const{pulsate:le,rippleX:_e,rippleY:ye,rippleSize:de,cb:ce}=re;C(oe=>[...oe,K.jsx(TJ,{classes:{ripple:Hn(u.ripple,tc.ripple),rippleVisible:Hn(u.rippleVisible,tc.rippleVisible),ripplePulsate:Hn(u.ripplePulsate,tc.ripplePulsate),child:Hn(u.child,tc.child),childLeaving:Hn(u.childLeaving,tc.childLeaving),childPulsate:Hn(u.childPulsate,tc.childPulsate)},timeout:lP,pulsate:le,rippleX:_e,rippleY:ye,rippleSize:de},k.current)]),k.current+=1,I.current=ce},[u]),H=X.useCallback((re={},le={},_e=()=>{})=>{const{pulsate:ye=!1,center:de=a||le.pulsate,fakeElement:ce=!1}=le;if((re==null?void 0:re.type)==="mousedown"&&P.current){P.current=!1;return}(re==null?void 0:re.type)==="touchstart"&&(P.current=!0);const oe=ce?null:j.current,xe=oe?oe.getBoundingClientRect():{width:0,height:0,left:0,top:0};let he,Ee,se;if(de||re===void 0||re.clientX===0&&re.clientY===0||!re.clientX&&!re.touches)he=Math.round(xe.width/2),Ee=Math.round(xe.height/2);else{const{clientX:we,clientY:Se}=re.touches&&re.touches.length>0?re.touches[0]:re;he=Math.round(we-xe.left),Ee=Math.round(Se-xe.top)}if(de)se=Math.sqrt((2*xe.width**2+xe.height**2)/3),se%2===0&&(se+=1);else{const we=Math.max(Math.abs((oe?oe.clientWidth:0)-he),he)*2+2,Se=Math.max(Math.abs((oe?oe.clientHeight:0)-Ee),Ee)*2+2;se=Math.sqrt(we**2+Se**2)}re!=null&&re.touches?N.current===null&&(N.current=()=>{W({pulsate:ye,rippleX:he,rippleY:Ee,rippleSize:se,cb:_e})},D.start(bJ,()=>{N.current&&(N.current(),N.current=null)})):W({pulsate:ye,rippleX:he,rippleY:Ee,rippleSize:se,cb:_e})},[a,W,D]),q=X.useCallback(()=>{H({},{pulsate:!0})},[H]),Z=X.useCallback((re,le)=>{if(D.clear(),(re==null?void 0:re.type)==="touchend"&&N.current){N.current(),N.current=null,D.start(0,()=>{Z(re,le)});return}N.current=null,C(_e=>_e.length>0?_e.slice(1):_e),I.current=le},[D]);return X.useImperativeHandle(n,()=>({pulsate:q,start:H,stop:Z}),[q,H,Z]),K.jsx(EJ,{className:Hn(tc.root,u.root,f),ref:j,..._,children:K.jsx(aA,{component:null,exit:!0,children:r})})});function kJ(e){return gi("MuiButtonBase",e)}const MJ=pi("MuiButtonBase",["root","disabled","focusVisible"]),PJ=e=>{const{disabled:t,focusVisible:n,focusVisibleClassName:s,classes:a}=e,f=yr({root:["root",t&&"disabled",n&&"focusVisible"]},kJ,a);return n&&s&&(f.root+=` ${s}`),f},AJ=Dn("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:(e,t)=>t.root})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${MJ.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),lp=X.forwardRef(function(t,n){const s=xi({props:t,name:"MuiButtonBase"}),{action:a,centerRipple:u=!1,children:f,className:_,component:r="button",disabled:C=!1,disableRipple:k=!1,disableTouchRipple:I=!1,focusRipple:P=!1,focusVisibleClassName:D,LinkComponent:N="a",onBlur:j,onClick:W,onContextMenu:H,onDragLeave:q,onFocus:Z,onFocusVisible:re,onKeyDown:le,onKeyUp:_e,onMouseDown:ye,onMouseLeave:de,onMouseUp:ce,onTouchEnd:oe,onTouchMove:xe,onTouchStart:he,tabIndex:Ee=0,TouchRippleProps:se,touchRippleRef:we,type:Se,...Pe}=s,Me=X.useRef(null),Re=_J(),Oe=mo(Re.ref,we),[$e,Ke]=X.useState(!1);C&&$e&&Ke(!1),X.useImperativeHandle(a,()=>({focusVisible:()=>{Ke(!0),Me.current.focus()}}),[]);const Ct=Re.shouldMount&&!k&&!C;X.useEffect(()=>{$e&&P&&!k&&Re.pulsate()},[k,P,$e,Re]);function Ue(an,Jt,Wt=I){return Ui(Fn=>(Jt&&Jt(Fn),Wt||Re[an](Fn),!0))}const ft=Ue("start",ye),Bt=Ue("stop",H),hn=Ue("stop",q),ot=Ue("stop",ce),en=Ue("stop",an=>{$e&&an.preventDefault(),de&&de(an)}),wt=Ue("start",he),Ne=Ue("stop",oe),We=Ue("stop",xe),Sn=Ue("stop",an=>{oC(an.target)||Ke(!1),j&&j(an)},!1),Ae=Ui(an=>{Me.current||(Me.current=an.currentTarget),oC(an.target)&&(Ke(!0),re&&re(an)),Z&&Z(an)}),st=()=>{const an=Me.current;return r&&r!=="button"&&!(an.tagName==="A"&&an.href)},gt=Ui(an=>{P&&!an.repeat&&$e&&an.key===" "&&Re.stop(an,()=>{Re.start(an)}),an.target===an.currentTarget&&st()&&an.key===" "&&an.preventDefault(),le&&le(an),an.target===an.currentTarget&&st()&&an.key==="Enter"&&!C&&(an.preventDefault(),W&&W(an))}),ut=Ui(an=>{P&&an.key===" "&&$e&&!an.defaultPrevented&&Re.stop(an,()=>{Re.pulsate(an)}),_e&&_e(an),W&&an.target===an.currentTarget&&st()&&an.key===" "&&!an.defaultPrevented&&W(an)});let tt=r;tt==="button"&&(Pe.href||Pe.to)&&(tt=N);const nt={};tt==="button"?(nt.type=Se===void 0?"button":Se,nt.disabled=C):(!Pe.href&&!Pe.to&&(nt.role="button"),C&&(nt["aria-disabled"]=C));const tn=mo(n,Me),un={...s,centerRipple:u,component:r,disabled:C,disableRipple:k,disableTouchRipple:I,focusRipple:P,tabIndex:Ee,focusVisible:$e},qt=PJ(un);return K.jsxs(AJ,{as:tt,className:Hn(qt.root,_),ownerState:un,onBlur:Sn,onClick:W,onContextMenu:Bt,onFocus:Ae,onKeyDown:gt,onKeyUp:ut,onMouseDown:ft,onMouseLeave:en,onMouseUp:ot,onDragLeave:hn,onTouchEnd:Ne,onTouchMove:We,onTouchStart:wt,ref:tn,tabIndex:C?-1:Ee,type:Se,...nt,...Pe,children:[f,Ct?K.jsx(IJ,{ref:Oe,center:u,...se}):null]})});function LJ(e){return typeof e.main=="string"}function RJ(e,t=[]){if(!LJ(e))return!1;for(const n of t)if(!e.hasOwnProperty(n)||typeof e[n]!="string")return!1;return!0}function Ms(e=[]){return([,t])=>t&&RJ(t,e)}function OJ(e){return gi("MuiIconButton",e)}const DJ=pi("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge"]),zJ=e=>{const{classes:t,disabled:n,color:s,edge:a,size:u}=e,f={root:["root",n&&"disabled",s!=="default"&&`color${Rn(s)}`,a&&`edge${Rn(a)}`,`size${Rn(u)}`]};return yr(f,OJ,t)},FJ=Dn(lp,{name:"MuiIconButton",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.color!=="default"&&t[`color${Rn(n.color)}`],n.edge&&t[`edge${Rn(n.edge)}`],t[`size${Rn(n.size)}`]]}})($r(({theme:e})=>({textAlign:"center",flex:"0 0 auto",fontSize:e.typography.pxToRem(24),padding:8,borderRadius:"50%",color:(e.vars||e).palette.action.active,transition:e.transitions.create("background-color",{duration:e.transitions.duration.shortest}),variants:[{props:t=>!t.disableRipple,style:{"--IconButton-hoverBg":e.vars?`rgba(${e.vars.palette.action.activeChannel} / ${e.vars.palette.action.hoverOpacity})`:vi(e.palette.action.active,e.palette.action.hoverOpacity),"&:hover":{backgroundColor:"var(--IconButton-hoverBg)","@media (hover: none)":{backgroundColor:"transparent"}}}},{props:{edge:"start"},style:{marginLeft:-12}},{props:{edge:"start",size:"small"},style:{marginLeft:-3}},{props:{edge:"end"},style:{marginRight:-12}},{props:{edge:"end",size:"small"},style:{marginRight:-3}}]})),$r(({theme:e})=>({variants:[{props:{color:"inherit"},style:{color:"inherit"}},...Object.entries(e.palette).filter(Ms()).map(([t])=>({props:{color:t},style:{color:(e.vars||e).palette[t].main}})),...Object.entries(e.palette).filter(Ms()).map(([t])=>({props:{color:t},style:{"--IconButton-hoverBg":e.vars?`rgba(${(e.vars||e).palette[t].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:vi((e.vars||e).palette[t].main,e.palette.action.hoverOpacity)}})),{props:{size:"small"},style:{padding:5,fontSize:e.typography.pxToRem(18)}},{props:{size:"large"},style:{padding:12,fontSize:e.typography.pxToRem(28)}}],[`&.${DJ.disabled}`]:{backgroundColor:"transparent",color:(e.vars||e).palette.action.disabled}}))),ga=X.forwardRef(function(t,n){const s=xi({props:t,name:"MuiIconButton"}),{edge:a=!1,children:u,className:f,color:_="default",disabled:r=!1,disableFocusRipple:C=!1,size:k="medium",...I}=s,P={...s,edge:a,color:_,disabled:r,disableFocusRipple:C,size:k},D=zJ(P);return K.jsx(FJ,{className:Hn(D.root,f),centerRipple:!0,focusRipple:!C,disabled:r,ref:n,...I,ownerState:P,children:u})}),NJ=Jr(K.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close");function BJ(e){return gi("MuiTypography",e)}const Yz=pi("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]),jJ={primary:!0,secondary:!0,error:!0,info:!0,success:!0,warning:!0,textPrimary:!0,textSecondary:!0,textDisabled:!0},VJ=iJ(),$J=e=>{const{align:t,gutterBottom:n,noWrap:s,paragraph:a,variant:u,classes:f}=e,_={root:["root",u,e.align!=="inherit"&&`align${Rn(t)}`,n&&"gutterBottom",s&&"noWrap",a&&"paragraph"]};return yr(_,BJ,f)},UJ=Dn("span",{name:"MuiTypography",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.variant&&t[n.variant],n.align!=="inherit"&&t[`align${Rn(n.align)}`],n.noWrap&&t.noWrap,n.gutterBottom&&t.gutterBottom,n.paragraph&&t.paragraph]}})($r(({theme:e})=>{var t;return{margin:0,variants:[{props:{variant:"inherit"},style:{font:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}},...Object.entries(e.typography).filter(([n,s])=>n!=="inherit"&&s&&typeof s=="object").map(([n,s])=>({props:{variant:n},style:s})),...Object.entries(e.palette).filter(Ms()).map(([n])=>({props:{color:n},style:{color:(e.vars||e).palette[n].main}})),...Object.entries(((t=e.palette)==null?void 0:t.text)||{}).filter(([,n])=>typeof n=="string").map(([n])=>({props:{color:`text${Rn(n)}`},style:{color:(e.vars||e).palette.text[n]}})),{props:({ownerState:n})=>n.align!=="inherit",style:{textAlign:"var(--Typography-textAlign)"}},{props:({ownerState:n})=>n.noWrap,style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},{props:({ownerState:n})=>n.gutterBottom,style:{marginBottom:"0.35em"}},{props:({ownerState:n})=>n.paragraph,style:{marginBottom:16}}]}})),Zz={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},To=X.forwardRef(function(t,n){const{color:s,...a}=xi({props:t,name:"MuiTypography"}),u=!jJ[s],f=VJ({...a,...u&&{color:s}}),{align:_="inherit",className:r,component:C,gutterBottom:k=!1,noWrap:I=!1,paragraph:P=!1,variant:D="body1",variantMapping:N=Zz,...j}=f,W={...f,align:_,color:s,className:r,component:C,gutterBottom:k,noWrap:I,paragraph:P,variant:D,variantMapping:N},H=C||(P?"p":N[D]||Zz[D])||"span",q=$J(W);return K.jsx(UJ,{as:H,ref:n,className:Hn(q.root,r),...j,ownerState:W,style:{..._!=="inherit"&&{"--Typography-textAlign":_},...j.style}})});function Kz(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"")}function zj(e={}){const{ignoreAccents:t=!0,ignoreCase:n=!0,limit:s,matchFrom:a="any",stringify:u,trim:f=!1}=e;return(_,{inputValue:r,getOptionLabel:C})=>{let k=f?r.trim():r;n&&(k=k.toLowerCase()),t&&(k=Kz(k));const I=k?_.filter(P=>{let D=(u||C)(P);return n&&(D=D.toLowerCase()),t&&(D=Kz(D)),a==="start"?D.startsWith(k):D.includes(k)}):_;return typeof s=="number"?I.slice(0,s):I}}const GJ=zj(),Jz=5,HJ=e=>{var t;return e.current!==null&&((t=e.current.parentElement)==null?void 0:t.contains(document.activeElement))},WJ=[];function qJ(e){const{unstable_isActiveElementInListbox:t=HJ,unstable_classNamePrefix:n="Mui",autoComplete:s=!1,autoHighlight:a=!1,autoSelect:u=!1,blurOnSelect:f=!1,clearOnBlur:_=!e.freeSolo,clearOnEscape:r=!1,componentName:C="useAutocomplete",defaultValue:k=e.multiple?WJ:null,disableClearable:I=!1,disableCloseOnSelect:P=!1,disabled:D,disabledItemsFocusable:N=!1,disableListWrap:j=!1,filterOptions:W=GJ,filterSelectedOptions:H=!1,freeSolo:q=!1,getOptionDisabled:Z,getOptionKey:re,getOptionLabel:le=Nt=>Nt.label??Nt,groupBy:_e,handleHomeEndKeys:ye=!e.freeSolo,id:de,includeInputInList:ce=!1,inputValue:oe,isOptionEqualToValue:xe=(Nt,zt)=>Nt===zt,multiple:he=!1,onChange:Ee,onClose:se,onHighlightChange:we,onInputChange:Se,onOpen:Pe,open:Me,openOnFocus:Re=!1,options:Oe,readOnly:$e=!1,selectOnFocus:Ke=!e.freeSolo,value:Ct}=e,Ue=ls(de);let ft=le;ft=Nt=>{const zt=le(Nt);return typeof zt!="string"?String(zt):zt};const Bt=X.useRef(!1),hn=X.useRef(!0),ot=X.useRef(null),en=X.useRef(null),[wt,Ne]=X.useState(null),[We,Sn]=X.useState(-1),Ae=a?0:-1,st=X.useRef(Ae),[gt,ut]=Qf({controlled:Ct,default:k,name:C}),[tt,nt]=Qf({controlled:oe,default:"",name:C,state:"inputValue"}),[tn,un]=X.useState(!1),qt=X.useCallback((Nt,zt,yn)=>{if(!(he?gt.length<zt.length:zt!==null)&&!_)return;let Jn;if(he)Jn="";else if(zt==null)Jn="";else{const ur=ft(zt);Jn=typeof ur=="string"?ur:""}tt!==Jn&&(nt(Jn),Se&&Se(Nt,Jn,yn))},[ft,tt,he,Se,nt,_,gt]),[an,Jt]=Qf({controlled:Me,default:!1,name:C,state:"open"}),[Wt,Fn]=X.useState(!0),ar=!he&&gt!=null&&tt===ft(gt),bn=an&&!$e,lr=bn?W(Oe.filter(Nt=>!(H&&(he?gt:[gt]).some(zt=>zt!==null&&xe(Nt,zt)))),{inputValue:ar&&Wt?"":tt,getOptionLabel:ft}):[],Cn=iA({filteredOptions:lr,value:gt,inputValue:tt});X.useEffect(()=>{const Nt=gt!==Cn.value;tn&&!Nt||q&&!Nt||qt(null,gt,"reset")},[gt,qt,tn,Cn.value,q]);const xn=an&&lr.length>0&&!$e,Er=Ui(Nt=>{Nt===-1?ot.current.focus():wt.querySelector(`[data-tag-index="${Nt}"]`).focus()});X.useEffect(()=>{he&&We>gt.length-1&&(Sn(-1),Er(-1))},[gt,he,We,Er]);function Rr(Nt,zt){if(!en.current||Nt<0||Nt>=lr.length)return-1;let yn=Nt;for(;;){const qn=en.current.querySelector(`[data-option-index="${yn}"]`),Jn=N?!1:!qn||qn.disabled||qn.getAttribute("aria-disabled")==="true";if(qn&&qn.hasAttribute("tabindex")&&!Jn)return yn;if(zt==="next"?yn=(yn+1)%lr.length:yn=(yn-1+lr.length)%lr.length,yn===Nt)return-1}}const Wn=Ui(({event:Nt,index:zt,reason:yn="auto"})=>{if(st.current=zt,zt===-1?ot.current.removeAttribute("aria-activedescendant"):ot.current.setAttribute("aria-activedescendant",`${Ue}-option-${zt}`),we&&we(Nt,zt===-1?null:lr[zt],yn),!en.current)return;const qn=en.current.querySelector(`[role="option"].${n}-focused`);qn&&(qn.classList.remove(`${n}-focused`),qn.classList.remove(`${n}-focusVisible`));let Jn=en.current;if(en.current.getAttribute("role")!=="listbox"&&(Jn=en.current.parentElement.querySelector('[role="listbox"]')),!Jn)return;if(zt===-1){Jn.scrollTop=0;return}const ur=en.current.querySelector(`[data-option-index="${zt}"]`);if(ur&&(ur.classList.add(`${n}-focused`),yn==="keyboard"&&ur.classList.add(`${n}-focusVisible`),Jn.scrollHeight>Jn.clientHeight&&yn!=="mouse"&&yn!=="touch")){const Cr=ur,Or=Jn.clientHeight+Jn.scrollTop,Fr=Cr.offsetTop+Cr.offsetHeight;Fr>Or?Jn.scrollTop=Fr-Jn.clientHeight:Cr.offsetTop-Cr.offsetHeight*(_e?1.3:0)<Jn.scrollTop&&(Jn.scrollTop=Cr.offsetTop-Cr.offsetHeight*(_e?1.3:0))}}),Mn=Ui(({event:Nt,diff:zt,direction:yn="next",reason:qn="auto"})=>{if(!bn)return;const ur=Rr((()=>{const Cr=lr.length-1;if(zt==="reset")return Ae;if(zt==="start")return 0;if(zt==="end")return Cr;const Or=st.current+zt;return Or<0?Or===-1&&ce?-1:j&&st.current!==-1||Math.abs(zt)>1?0:Cr:Or>Cr?Or===Cr+1&&ce?-1:j||Math.abs(zt)>1?Cr:0:Or})(),yn);if(Wn({index:ur,reason:qn,event:Nt}),s&&zt!=="reset")if(ur===-1)ot.current.value=tt;else{const Cr=ft(lr[ur]);ot.current.value=Cr,Cr.toLowerCase().indexOf(tt.toLowerCase())===0&&tt.length>0&&ot.current.setSelectionRange(tt.length,Cr.length)}}),Ar=()=>{const Nt=(zt,yn)=>{const qn=zt?ft(zt):"",Jn=yn?ft(yn):"";return qn===Jn};if(st.current!==-1&&Cn.filteredOptions&&Cn.filteredOptions.length!==lr.length&&Cn.inputValue===tt&&(he?gt.length===Cn.value.length&&Cn.value.every((zt,yn)=>ft(gt[yn])===ft(zt)):Nt(Cn.value,gt))){const zt=Cn.filteredOptions[st.current];if(zt)return lr.findIndex(yn=>ft(yn)===ft(zt))}return-1},fi=X.useCallback(()=>{if(!bn)return;const Nt=Ar();if(Nt!==-1){st.current=Nt;return}const zt=he?gt[0]:gt;if(lr.length===0||zt==null){Mn({diff:"reset"});return}if(en.current){if(zt!=null){const yn=lr[st.current];if(he&&yn&&gt.findIndex(Jn=>xe(yn,Jn))!==-1)return;const qn=lr.findIndex(Jn=>xe(Jn,zt));qn===-1?Mn({diff:"reset"}):Wn({index:qn});return}if(st.current>=lr.length-1){Wn({index:lr.length-1});return}Wn({index:st.current})}},[lr.length,he?!1:gt,H,Mn,Wn,bn,tt,he]),yo=Ui(Nt=>{iC(en,Nt),Nt&&fi()});X.useEffect(()=>{fi()},[fi]);const vr=Nt=>{an||(Jt(!0),Fn(!0),Pe&&Pe(Nt))},zi=(Nt,zt)=>{an&&(Jt(!1),se&&se(Nt,zt))},Li=(Nt,zt,yn,qn)=>{if(he){if(gt.length===zt.length&&gt.every((Jn,ur)=>Jn===zt[ur]))return}else if(gt===zt)return;Ee&&Ee(Nt,zt,yn,qn),ut(zt)},mi=X.useRef(!1),ji=(Nt,zt,yn="selectOption",qn="options")=>{let Jn=yn,ur=zt;if(he){ur=Array.isArray(gt)?gt.slice():[];const Cr=ur.findIndex(Or=>xe(zt,Or));Cr===-1?ur.push(zt):qn!=="freeSolo"&&(ur.splice(Cr,1),Jn="removeOption")}qt(Nt,ur,Jn),Li(Nt,ur,Jn,{option:zt}),!P&&(!Nt||!Nt.ctrlKey&&!Nt.metaKey)&&zi(Nt,Jn),(f===!0||f==="touch"&&mi.current||f==="mouse"&&!mi.current)&&ot.current.blur()};function ko(Nt,zt){if(Nt===-1)return-1;let yn=Nt;for(;;){if(zt==="next"&&yn===gt.length||zt==="previous"&&yn===-1)return-1;const qn=wt.querySelector(`[data-tag-index="${yn}"]`);if(!qn||!qn.hasAttribute("tabindex")||qn.disabled||qn.getAttribute("aria-disabled")==="true")yn+=zt==="next"?1:-1;else return yn}}const qo=(Nt,zt)=>{if(!he)return;tt===""&&zi(Nt,"toggleInput");let yn=We;We===-1?tt===""&&zt==="previous"&&(yn=gt.length-1):(yn+=zt==="next"?1:-1,yn<0&&(yn=0),yn===gt.length&&(yn=-1)),yn=ko(yn,zt),Sn(yn),Er(yn)},Oo=Nt=>{Bt.current=!0,nt(""),Se&&Se(Nt,"","clear"),Li(Nt,he?[]:null,"clear")},Pn=Nt=>zt=>{if(Nt.onKeyDown&&Nt.onKeyDown(zt),!zt.defaultMuiPrevented&&(We!==-1&&!["ArrowLeft","ArrowRight"].includes(zt.key)&&(Sn(-1),Er(-1)),zt.which!==229))switch(zt.key){case"Home":bn&&ye&&(zt.preventDefault(),Mn({diff:"start",direction:"next",reason:"keyboard",event:zt}));break;case"End":bn&&ye&&(zt.preventDefault(),Mn({diff:"end",direction:"previous",reason:"keyboard",event:zt}));break;case"PageUp":zt.preventDefault(),Mn({diff:-Jz,direction:"previous",reason:"keyboard",event:zt}),vr(zt);break;case"PageDown":zt.preventDefault(),Mn({diff:Jz,direction:"next",reason:"keyboard",event:zt}),vr(zt);break;case"ArrowDown":zt.preventDefault(),Mn({diff:1,direction:"next",reason:"keyboard",event:zt}),vr(zt);break;case"ArrowUp":zt.preventDefault(),Mn({diff:-1,direction:"previous",reason:"keyboard",event:zt}),vr(zt);break;case"ArrowLeft":qo(zt,"previous");break;case"ArrowRight":qo(zt,"next");break;case"Enter":if(st.current!==-1&&bn){const yn=lr[st.current],qn=Z?Z(yn):!1;if(zt.preventDefault(),qn)return;ji(zt,yn,"selectOption"),s&&ot.current.setSelectionRange(ot.current.value.length,ot.current.value.length)}else q&&tt!==""&&ar===!1&&(he&&zt.preventDefault(),ji(zt,tt,"createOption","freeSolo"));break;case"Escape":bn?(zt.preventDefault(),zt.stopPropagation(),zi(zt,"escape")):r&&(tt!==""||he&&gt.length>0)&&(zt.preventDefault(),zt.stopPropagation(),Oo(zt));break;case"Backspace":if(he&&!$e&&tt===""&&gt.length>0){const yn=We===-1?gt.length-1:We,qn=gt.slice();qn.splice(yn,1),Li(zt,qn,"removeOption",{option:gt[yn]})}break;case"Delete":if(he&&!$e&&tt===""&&gt.length>0&&We!==-1){const yn=We,qn=gt.slice();qn.splice(yn,1),Li(zt,qn,"removeOption",{option:gt[yn]})}break}},Vt=Nt=>{un(!0),Re&&!Bt.current&&vr(Nt)},ze=Nt=>{if(t(en)){ot.current.focus();return}un(!1),hn.current=!0,Bt.current=!1,u&&st.current!==-1&&bn?ji(Nt,lr[st.current],"blur"):u&&q&&tt!==""?ji(Nt,tt,"blur","freeSolo"):_&&qt(Nt,gt,"blur"),zi(Nt,"blur")},Ve=Nt=>{const zt=Nt.target.value;tt!==zt&&(nt(zt),Fn(!1),Se&&Se(Nt,zt,"input")),zt===""?!I&&!he&&Li(Nt,null,"clear"):vr(Nt)},at=Nt=>{const zt=Number(Nt.currentTarget.getAttribute("data-option-index"));st.current!==zt&&Wn({event:Nt,index:zt,reason:"mouse"})},_t=Nt=>{Wn({event:Nt,index:Number(Nt.currentTarget.getAttribute("data-option-index")),reason:"touch"}),mi.current=!0},ht=Nt=>{const zt=Number(Nt.currentTarget.getAttribute("data-option-index"));ji(Nt,lr[zt],"selectOption"),mi.current=!1},Mt=Nt=>zt=>{const yn=gt.slice();yn.splice(Nt,1),Li(zt,yn,"removeOption",{option:gt[Nt]})},Xt=Nt=>{an?zi(Nt,"toggleInput"):vr(Nt)},At=Nt=>{Nt.currentTarget.contains(Nt.target)&&Nt.target.getAttribute("id")!==Ue&&Nt.preventDefault()},Gt=Nt=>{Nt.currentTarget.contains(Nt.target)&&(ot.current.focus(),Ke&&hn.current&&ot.current.selectionEnd-ot.current.selectionStart===0&&ot.current.select(),hn.current=!1)},Zt=Nt=>{!D&&(tt===""||!an)&&(Xt(Nt),Nt.stopPropagation())};let Ht=q&&tt.length>0;Ht=Ht||(he?gt.length>0:gt!==null);let fn=lr;return _e&&(fn=lr.reduce((Nt,zt,yn)=>{const qn=_e(zt);return Nt.length>0&&Nt[Nt.length-1].group===qn?Nt[Nt.length-1].options.push(zt):Nt.push({key:yn,index:yn,group:qn,options:[zt]}),Nt},[])),D&&tn&&ze(),{getRootProps:(Nt={})=>({"aria-owns":xn?`${Ue}-listbox`:null,...Nt,onKeyDown:Pn(Nt),onMouseDown:At,onClick:Gt}),getInputLabelProps:()=>({id:`${Ue}-label`,htmlFor:Ue}),getInputProps:()=>({id:Ue,value:tt,onBlur:ze,onFocus:Vt,onChange:Ve,onMouseDown:Zt,"aria-activedescendant":bn?"":null,"aria-autocomplete":s?"both":"list","aria-controls":xn?`${Ue}-listbox`:void 0,"aria-expanded":xn,autoComplete:"off",ref:ot,autoCapitalize:"none",spellCheck:"false",role:"combobox",disabled:D}),getClearProps:()=>({tabIndex:-1,type:"button",onClick:Oo}),getPopupIndicatorProps:()=>({tabIndex:-1,type:"button",onClick:Xt,onMouseDown:Nt=>Nt.stopPropagation()}),getTagProps:({index:Nt})=>({key:Nt,"data-tag-index":Nt,tabIndex:-1,...!$e&&{onDelete:Mt(Nt)}}),getListboxProps:()=>({role:"listbox",id:`${Ue}-listbox`,"aria-labelledby":`${Ue}-label`,ref:yo,onMouseDown:Nt=>{Nt.preventDefault()}}),getOptionProps:({index:Nt,option:zt})=>{const yn=(he?gt:[gt]).some(Jn=>Jn!=null&&xe(zt,Jn)),qn=Z?Z(zt):!1;return{key:(re==null?void 0:re(zt))??ft(zt),tabIndex:-1,role:"option",id:`${Ue}-option-${Nt}`,onMouseMove:at,onClick:ht,onTouchStart:_t,"data-option-index":Nt,"aria-disabled":qn,"aria-selected":yn}},id:Ue,inputValue:tt,value:gt,dirty:Ht,expanded:bn&&wt,popupOpen:bn,focused:tn||We!==-1,anchorEl:wt,setAnchorEl:Ne,focusedTag:We,groupedOptions:fn}}var iu="top",mc="bottom",gc="right",ou="left",lA="auto",u1=[iu,mc,gc,ou],e0="start",jx="end",XJ="clippingParents",Fj="viewport",gv="popper",YJ="reference",Qz=u1.reduce(function(e,t){return e.concat([t+"-"+e0,t+"-"+jx])},[]),Nj=[].concat(u1,[lA]).reduce(function(e,t){return e.concat([t,t+"-"+e0,t+"-"+jx])},[]),ZJ="beforeRead",KJ="read",JJ="afterRead",QJ="beforeMain",eQ="main",tQ="afterMain",nQ="beforeWrite",rQ="write",iQ="afterWrite",oQ=[ZJ,KJ,JJ,QJ,eQ,tQ,nQ,rQ,iQ];function Yd(e){return e?(e.nodeName||"").toLowerCase():null}function Mu(e){if(e==null)return window;if(e.toString()!=="[object Window]"){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function Im(e){var t=Mu(e).Element;return e instanceof t||e instanceof Element}function cc(e){var t=Mu(e).HTMLElement;return e instanceof t||e instanceof HTMLElement}function uA(e){if(typeof ShadowRoot>"u")return!1;var t=Mu(e).ShadowRoot;return e instanceof t||e instanceof ShadowRoot}function sQ(e){var t=e.state;Object.keys(t.elements).forEach(function(n){var s=t.styles[n]||{},a=t.attributes[n]||{},u=t.elements[n];!cc(u)||!Yd(u)||(Object.assign(u.style,s),Object.keys(a).forEach(function(f){var _=a[f];_===!1?u.removeAttribute(f):u.setAttribute(f,_===!0?"":_)}))})}function aQ(e){var t=e.state,n={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,n.popper),t.styles=n,t.elements.arrow&&Object.assign(t.elements.arrow.style,n.arrow),function(){Object.keys(t.elements).forEach(function(s){var a=t.elements[s],u=t.attributes[s]||{},f=Object.keys(t.styles.hasOwnProperty(s)?t.styles[s]:n[s]),_=f.reduce(function(r,C){return r[C]="",r},{});!cc(a)||!Yd(a)||(Object.assign(a.style,_),Object.keys(u).forEach(function(r){a.removeAttribute(r)}))})}}const lQ={name:"applyStyles",enabled:!0,phase:"write",fn:sQ,effect:aQ,requires:["computeStyles"]};function Gd(e){return e.split("-")[0]}var ym=Math.max,lC=Math.min,t0=Math.round;function uP(){var e=navigator.userAgentData;return e!=null&&e.brands&&Array.isArray(e.brands)?e.brands.map(function(t){return t.brand+"/"+t.version}).join(" "):navigator.userAgent}function Bj(){return!/^((?!chrome|android).)*safari/i.test(uP())}function n0(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!1);var s=e.getBoundingClientRect(),a=1,u=1;t&&cc(e)&&(a=e.offsetWidth>0&&t0(s.width)/e.offsetWidth||1,u=e.offsetHeight>0&&t0(s.height)/e.offsetHeight||1);var f=Im(e)?Mu(e):window,_=f.visualViewport,r=!Bj()&&n,C=(s.left+(r&&_?_.offsetLeft:0))/a,k=(s.top+(r&&_?_.offsetTop:0))/u,I=s.width/a,P=s.height/u;return{width:I,height:P,top:k,right:C+I,bottom:k+P,left:C,x:C,y:k}}function cA(e){var t=n0(e),n=e.offsetWidth,s=e.offsetHeight;return Math.abs(t.width-n)<=1&&(n=t.width),Math.abs(t.height-s)<=1&&(s=t.height),{x:e.offsetLeft,y:e.offsetTop,width:n,height:s}}function jj(e,t){var n=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(n&&uA(n)){var s=t;do{if(s&&e.isSameNode(s))return!0;s=s.parentNode||s.host}while(s)}return!1}function Nh(e){return Mu(e).getComputedStyle(e)}function uQ(e){return["table","td","th"].indexOf(Yd(e))>=0}function _p(e){return((Im(e)?e.ownerDocument:e.document)||window.document).documentElement}function kE(e){return Yd(e)==="html"?e:e.assignedSlot||e.parentNode||(uA(e)?e.host:null)||_p(e)}function eF(e){return!cc(e)||Nh(e).position==="fixed"?null:e.offsetParent}function cQ(e){var t=/firefox/i.test(uP()),n=/Trident/i.test(uP());if(n&&cc(e)){var s=Nh(e);if(s.position==="fixed")return null}var a=kE(e);for(uA(a)&&(a=a.host);cc(a)&&["html","body"].indexOf(Yd(a))<0;){var u=Nh(a);if(u.transform!=="none"||u.perspective!=="none"||u.contain==="paint"||["transform","perspective"].indexOf(u.willChange)!==-1||t&&u.willChange==="filter"||t&&u.filter&&u.filter!=="none")return a;a=a.parentNode}return null}function c1(e){for(var t=Mu(e),n=eF(e);n&&uQ(n)&&Nh(n).position==="static";)n=eF(n);return n&&(Yd(n)==="html"||Yd(n)==="body"&&Nh(n).position==="static")?t:n||cQ(e)||t}function dA(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function sx(e,t,n){return ym(e,lC(t,n))}function dQ(e,t,n){var s=sx(e,t,n);return s>n?n:s}function Vj(){return{top:0,right:0,bottom:0,left:0}}function $j(e){return Object.assign({},Vj(),e)}function Uj(e,t){return t.reduce(function(n,s){return n[s]=e,n},{})}var hQ=function(t,n){return t=typeof t=="function"?t(Object.assign({},n.rects,{placement:n.placement})):t,$j(typeof t!="number"?t:Uj(t,u1))};function fQ(e){var t,n=e.state,s=e.name,a=e.options,u=n.elements.arrow,f=n.modifiersData.popperOffsets,_=Gd(n.placement),r=dA(_),C=[ou,gc].indexOf(_)>=0,k=C?"height":"width";if(!(!u||!f)){var I=hQ(a.padding,n),P=cA(u),D=r==="y"?iu:ou,N=r==="y"?mc:gc,j=n.rects.reference[k]+n.rects.reference[r]-f[r]-n.rects.popper[k],W=f[r]-n.rects.reference[r],H=c1(u),q=H?r==="y"?H.clientHeight||0:H.clientWidth||0:0,Z=j/2-W/2,re=I[D],le=q-P[k]-I[N],_e=q/2-P[k]/2+Z,ye=sx(re,_e,le),de=r;n.modifiersData[s]=(t={},t[de]=ye,t.centerOffset=ye-_e,t)}}function pQ(e){var t=e.state,n=e.options,s=n.element,a=s===void 0?"[data-popper-arrow]":s;a!=null&&(typeof a=="string"&&(a=t.elements.popper.querySelector(a),!a)||jj(t.elements.popper,a)&&(t.elements.arrow=a))}const mQ={name:"arrow",enabled:!0,phase:"main",fn:fQ,effect:pQ,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function r0(e){return e.split("-")[1]}var gQ={top:"auto",right:"auto",bottom:"auto",left:"auto"};function yQ(e,t){var n=e.x,s=e.y,a=t.devicePixelRatio||1;return{x:t0(n*a)/a||0,y:t0(s*a)/a||0}}function tF(e){var t,n=e.popper,s=e.popperRect,a=e.placement,u=e.variation,f=e.offsets,_=e.position,r=e.gpuAcceleration,C=e.adaptive,k=e.roundOffsets,I=e.isFixed,P=f.x,D=P===void 0?0:P,N=f.y,j=N===void 0?0:N,W=typeof k=="function"?k({x:D,y:j}):{x:D,y:j};D=W.x,j=W.y;var H=f.hasOwnProperty("x"),q=f.hasOwnProperty("y"),Z=ou,re=iu,le=window;if(C){var _e=c1(n),ye="clientHeight",de="clientWidth";if(_e===Mu(n)&&(_e=_p(n),Nh(_e).position!=="static"&&_==="absolute"&&(ye="scrollHeight",de="scrollWidth")),_e=_e,a===iu||(a===ou||a===gc)&&u===jx){re=mc;var ce=I&&_e===le&&le.visualViewport?le.visualViewport.height:_e[ye];j-=ce-s.height,j*=r?1:-1}if(a===ou||(a===iu||a===mc)&&u===jx){Z=gc;var oe=I&&_e===le&&le.visualViewport?le.visualViewport.width:_e[de];D-=oe-s.width,D*=r?1:-1}}var xe=Object.assign({position:_},C&&gQ),he=k===!0?yQ({x:D,y:j},Mu(n)):{x:D,y:j};if(D=he.x,j=he.y,r){var Ee;return Object.assign({},xe,(Ee={},Ee[re]=q?"0":"",Ee[Z]=H?"0":"",Ee.transform=(le.devicePixelRatio||1)<=1?"translate("+D+"px, "+j+"px)":"translate3d("+D+"px, "+j+"px, 0)",Ee))}return Object.assign({},xe,(t={},t[re]=q?j+"px":"",t[Z]=H?D+"px":"",t.transform="",t))}function _Q(e){var t=e.state,n=e.options,s=n.gpuAcceleration,a=s===void 0?!0:s,u=n.adaptive,f=u===void 0?!0:u,_=n.roundOffsets,r=_===void 0?!0:_,C={placement:Gd(t.placement),variation:r0(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:a,isFixed:t.options.strategy==="fixed"};t.modifiersData.popperOffsets!=null&&(t.styles.popper=Object.assign({},t.styles.popper,tF(Object.assign({},C,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:f,roundOffsets:r})))),t.modifiersData.arrow!=null&&(t.styles.arrow=Object.assign({},t.styles.arrow,tF(Object.assign({},C,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:r})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})}const vQ={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:_Q,data:{}};var kw={passive:!0};function xQ(e){var t=e.state,n=e.instance,s=e.options,a=s.scroll,u=a===void 0?!0:a,f=s.resize,_=f===void 0?!0:f,r=Mu(t.elements.popper),C=[].concat(t.scrollParents.reference,t.scrollParents.popper);return u&&C.forEach(function(k){k.addEventListener("scroll",n.update,kw)}),_&&r.addEventListener("resize",n.update,kw),function(){u&&C.forEach(function(k){k.removeEventListener("scroll",n.update,kw)}),_&&r.removeEventListener("resize",n.update,kw)}}const bQ={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:xQ,data:{}};var wQ={left:"right",right:"left",bottom:"top",top:"bottom"};function mS(e){return e.replace(/left|right|bottom|top/g,function(t){return wQ[t]})}var SQ={start:"end",end:"start"};function nF(e){return e.replace(/start|end/g,function(t){return SQ[t]})}function hA(e){var t=Mu(e),n=t.pageXOffset,s=t.pageYOffset;return{scrollLeft:n,scrollTop:s}}function fA(e){return n0(_p(e)).left+hA(e).scrollLeft}function CQ(e,t){var n=Mu(e),s=_p(e),a=n.visualViewport,u=s.clientWidth,f=s.clientHeight,_=0,r=0;if(a){u=a.width,f=a.height;var C=Bj();(C||!C&&t==="fixed")&&(_=a.offsetLeft,r=a.offsetTop)}return{width:u,height:f,x:_+fA(e),y:r}}function EQ(e){var t,n=_p(e),s=hA(e),a=(t=e.ownerDocument)==null?void 0:t.body,u=ym(n.scrollWidth,n.clientWidth,a?a.scrollWidth:0,a?a.clientWidth:0),f=ym(n.scrollHeight,n.clientHeight,a?a.scrollHeight:0,a?a.clientHeight:0),_=-s.scrollLeft+fA(e),r=-s.scrollTop;return Nh(a||n).direction==="rtl"&&(_+=ym(n.clientWidth,a?a.clientWidth:0)-u),{width:u,height:f,x:_,y:r}}function pA(e){var t=Nh(e),n=t.overflow,s=t.overflowX,a=t.overflowY;return/auto|scroll|overlay|hidden/.test(n+a+s)}function Gj(e){return["html","body","#document"].indexOf(Yd(e))>=0?e.ownerDocument.body:cc(e)&&pA(e)?e:Gj(kE(e))}function ax(e,t){var n;t===void 0&&(t=[]);var s=Gj(e),a=s===((n=e.ownerDocument)==null?void 0:n.body),u=Mu(s),f=a?[u].concat(u.visualViewport||[],pA(s)?s:[]):s,_=t.concat(f);return a?_:_.concat(ax(kE(f)))}function cP(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function TQ(e,t){var n=n0(e,!1,t==="fixed");return n.top=n.top+e.clientTop,n.left=n.left+e.clientLeft,n.bottom=n.top+e.clientHeight,n.right=n.left+e.clientWidth,n.width=e.clientWidth,n.height=e.clientHeight,n.x=n.left,n.y=n.top,n}function rF(e,t,n){return t===Fj?cP(CQ(e,n)):Im(t)?TQ(t,n):cP(EQ(_p(e)))}function IQ(e){var t=ax(kE(e)),n=["absolute","fixed"].indexOf(Nh(e).position)>=0,s=n&&cc(e)?c1(e):e;return Im(s)?t.filter(function(a){return Im(a)&&jj(a,s)&&Yd(a)!=="body"}):[]}function kQ(e,t,n,s){var a=t==="clippingParents"?IQ(e):[].concat(t),u=[].concat(a,[n]),f=u[0],_=u.reduce(function(r,C){var k=rF(e,C,s);return r.top=ym(k.top,r.top),r.right=lC(k.right,r.right),r.bottom=lC(k.bottom,r.bottom),r.left=ym(k.left,r.left),r},rF(e,f,s));return _.width=_.right-_.left,_.height=_.bottom-_.top,_.x=_.left,_.y=_.top,_}function Hj(e){var t=e.reference,n=e.element,s=e.placement,a=s?Gd(s):null,u=s?r0(s):null,f=t.x+t.width/2-n.width/2,_=t.y+t.height/2-n.height/2,r;switch(a){case iu:r={x:f,y:t.y-n.height};break;case mc:r={x:f,y:t.y+t.height};break;case gc:r={x:t.x+t.width,y:_};break;case ou:r={x:t.x-n.width,y:_};break;default:r={x:t.x,y:t.y}}var C=a?dA(a):null;if(C!=null){var k=C==="y"?"height":"width";switch(u){case e0:r[C]=r[C]-(t[k]/2-n[k]/2);break;case jx:r[C]=r[C]+(t[k]/2-n[k]/2);break}}return r}function Vx(e,t){t===void 0&&(t={});var n=t,s=n.placement,a=s===void 0?e.placement:s,u=n.strategy,f=u===void 0?e.strategy:u,_=n.boundary,r=_===void 0?XJ:_,C=n.rootBoundary,k=C===void 0?Fj:C,I=n.elementContext,P=I===void 0?gv:I,D=n.altBoundary,N=D===void 0?!1:D,j=n.padding,W=j===void 0?0:j,H=$j(typeof W!="number"?W:Uj(W,u1)),q=P===gv?YJ:gv,Z=e.rects.popper,re=e.elements[N?q:P],le=kQ(Im(re)?re:re.contextElement||_p(e.elements.popper),r,k,f),_e=n0(e.elements.reference),ye=Hj({reference:_e,element:Z,strategy:"absolute",placement:a}),de=cP(Object.assign({},Z,ye)),ce=P===gv?de:_e,oe={top:le.top-ce.top+H.top,bottom:ce.bottom-le.bottom+H.bottom,left:le.left-ce.left+H.left,right:ce.right-le.right+H.right},xe=e.modifiersData.offset;if(P===gv&&xe){var he=xe[a];Object.keys(oe).forEach(function(Ee){var se=[gc,mc].indexOf(Ee)>=0?1:-1,we=[iu,mc].indexOf(Ee)>=0?"y":"x";oe[Ee]+=he[we]*se})}return oe}function MQ(e,t){t===void 0&&(t={});var n=t,s=n.placement,a=n.boundary,u=n.rootBoundary,f=n.padding,_=n.flipVariations,r=n.allowedAutoPlacements,C=r===void 0?Nj:r,k=r0(s),I=k?_?Qz:Qz.filter(function(N){return r0(N)===k}):u1,P=I.filter(function(N){return C.indexOf(N)>=0});P.length===0&&(P=I);var D=P.reduce(function(N,j){return N[j]=Vx(e,{placement:j,boundary:a,rootBoundary:u,padding:f})[Gd(j)],N},{});return Object.keys(D).sort(function(N,j){return D[N]-D[j]})}function PQ(e){if(Gd(e)===lA)return[];var t=mS(e);return[nF(e),t,nF(t)]}function AQ(e){var t=e.state,n=e.options,s=e.name;if(!t.modifiersData[s]._skip){for(var a=n.mainAxis,u=a===void 0?!0:a,f=n.altAxis,_=f===void 0?!0:f,r=n.fallbackPlacements,C=n.padding,k=n.boundary,I=n.rootBoundary,P=n.altBoundary,D=n.flipVariations,N=D===void 0?!0:D,j=n.allowedAutoPlacements,W=t.options.placement,H=Gd(W),q=H===W,Z=r||(q||!N?[mS(W)]:PQ(W)),re=[W].concat(Z).reduce(function(Ue,ft){return Ue.concat(Gd(ft)===lA?MQ(t,{placement:ft,boundary:k,rootBoundary:I,padding:C,flipVariations:N,allowedAutoPlacements:j}):ft)},[]),le=t.rects.reference,_e=t.rects.popper,ye=new Map,de=!0,ce=re[0],oe=0;oe<re.length;oe++){var xe=re[oe],he=Gd(xe),Ee=r0(xe)===e0,se=[iu,mc].indexOf(he)>=0,we=se?"width":"height",Se=Vx(t,{placement:xe,boundary:k,rootBoundary:I,altBoundary:P,padding:C}),Pe=se?Ee?gc:ou:Ee?mc:iu;le[we]>_e[we]&&(Pe=mS(Pe));var Me=mS(Pe),Re=[];if(u&&Re.push(Se[he]<=0),_&&Re.push(Se[Pe]<=0,Se[Me]<=0),Re.every(function(Ue){return Ue})){ce=xe,de=!1;break}ye.set(xe,Re)}if(de)for(var Oe=N?3:1,$e=function(ft){var Bt=re.find(function(hn){var ot=ye.get(hn);if(ot)return ot.slice(0,ft).every(function(en){return en})});if(Bt)return ce=Bt,"break"},Ke=Oe;Ke>0;Ke--){var Ct=$e(Ke);if(Ct==="break")break}t.placement!==ce&&(t.modifiersData[s]._skip=!0,t.placement=ce,t.reset=!0)}}const LQ={name:"flip",enabled:!0,phase:"main",fn:AQ,requiresIfExists:["offset"],data:{_skip:!1}};function iF(e,t,n){return n===void 0&&(n={x:0,y:0}),{top:e.top-t.height-n.y,right:e.right-t.width+n.x,bottom:e.bottom-t.height+n.y,left:e.left-t.width-n.x}}function oF(e){return[iu,gc,mc,ou].some(function(t){return e[t]>=0})}function RQ(e){var t=e.state,n=e.name,s=t.rects.reference,a=t.rects.popper,u=t.modifiersData.preventOverflow,f=Vx(t,{elementContext:"reference"}),_=Vx(t,{altBoundary:!0}),r=iF(f,s),C=iF(_,a,u),k=oF(r),I=oF(C);t.modifiersData[n]={referenceClippingOffsets:r,popperEscapeOffsets:C,isReferenceHidden:k,hasPopperEscaped:I},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":k,"data-popper-escaped":I})}const OQ={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:RQ};function DQ(e,t,n){var s=Gd(e),a=[ou,iu].indexOf(s)>=0?-1:1,u=typeof n=="function"?n(Object.assign({},t,{placement:e})):n,f=u[0],_=u[1];return f=f||0,_=(_||0)*a,[ou,gc].indexOf(s)>=0?{x:_,y:f}:{x:f,y:_}}function zQ(e){var t=e.state,n=e.options,s=e.name,a=n.offset,u=a===void 0?[0,0]:a,f=Nj.reduce(function(k,I){return k[I]=DQ(I,t.rects,u),k},{}),_=f[t.placement],r=_.x,C=_.y;t.modifiersData.popperOffsets!=null&&(t.modifiersData.popperOffsets.x+=r,t.modifiersData.popperOffsets.y+=C),t.modifiersData[s]=f}const FQ={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:zQ};function NQ(e){var t=e.state,n=e.name;t.modifiersData[n]=Hj({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})}const BQ={name:"popperOffsets",enabled:!0,phase:"read",fn:NQ,data:{}};function jQ(e){return e==="x"?"y":"x"}function VQ(e){var t=e.state,n=e.options,s=e.name,a=n.mainAxis,u=a===void 0?!0:a,f=n.altAxis,_=f===void 0?!1:f,r=n.boundary,C=n.rootBoundary,k=n.altBoundary,I=n.padding,P=n.tether,D=P===void 0?!0:P,N=n.tetherOffset,j=N===void 0?0:N,W=Vx(t,{boundary:r,rootBoundary:C,padding:I,altBoundary:k}),H=Gd(t.placement),q=r0(t.placement),Z=!q,re=dA(H),le=jQ(re),_e=t.modifiersData.popperOffsets,ye=t.rects.reference,de=t.rects.popper,ce=typeof j=="function"?j(Object.assign({},t.rects,{placement:t.placement})):j,oe=typeof ce=="number"?{mainAxis:ce,altAxis:ce}:Object.assign({mainAxis:0,altAxis:0},ce),xe=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,he={x:0,y:0};if(_e){if(u){var Ee,se=re==="y"?iu:ou,we=re==="y"?mc:gc,Se=re==="y"?"height":"width",Pe=_e[re],Me=Pe+W[se],Re=Pe-W[we],Oe=D?-de[Se]/2:0,$e=q===e0?ye[Se]:de[Se],Ke=q===e0?-de[Se]:-ye[Se],Ct=t.elements.arrow,Ue=D&&Ct?cA(Ct):{width:0,height:0},ft=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:Vj(),Bt=ft[se],hn=ft[we],ot=sx(0,ye[Se],Ue[Se]),en=Z?ye[Se]/2-Oe-ot-Bt-oe.mainAxis:$e-ot-Bt-oe.mainAxis,wt=Z?-ye[Se]/2+Oe+ot+hn+oe.mainAxis:Ke+ot+hn+oe.mainAxis,Ne=t.elements.arrow&&c1(t.elements.arrow),We=Ne?re==="y"?Ne.clientTop||0:Ne.clientLeft||0:0,Sn=(Ee=xe==null?void 0:xe[re])!=null?Ee:0,Ae=Pe+en-Sn-We,st=Pe+wt-Sn,gt=sx(D?lC(Me,Ae):Me,Pe,D?ym(Re,st):Re);_e[re]=gt,he[re]=gt-Pe}if(_){var ut,tt=re==="x"?iu:ou,nt=re==="x"?mc:gc,tn=_e[le],un=le==="y"?"height":"width",qt=tn+W[tt],an=tn-W[nt],Jt=[iu,ou].indexOf(H)!==-1,Wt=(ut=xe==null?void 0:xe[le])!=null?ut:0,Fn=Jt?qt:tn-ye[un]-de[un]-Wt+oe.altAxis,ar=Jt?tn+ye[un]+de[un]-Wt-oe.altAxis:an,bn=D&&Jt?dQ(Fn,tn,ar):sx(D?Fn:qt,tn,D?ar:an);_e[le]=bn,he[le]=bn-tn}t.modifiersData[s]=he}}const $Q={name:"preventOverflow",enabled:!0,phase:"main",fn:VQ,requiresIfExists:["offset"]};function UQ(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function GQ(e){return e===Mu(e)||!cc(e)?hA(e):UQ(e)}function HQ(e){var t=e.getBoundingClientRect(),n=t0(t.width)/e.offsetWidth||1,s=t0(t.height)/e.offsetHeight||1;return n!==1||s!==1}function WQ(e,t,n){n===void 0&&(n=!1);var s=cc(t),a=cc(t)&&HQ(t),u=_p(t),f=n0(e,a,n),_={scrollLeft:0,scrollTop:0},r={x:0,y:0};return(s||!s&&!n)&&((Yd(t)!=="body"||pA(u))&&(_=GQ(t)),cc(t)?(r=n0(t,!0),r.x+=t.clientLeft,r.y+=t.clientTop):u&&(r.x=fA(u))),{x:f.left+_.scrollLeft-r.x,y:f.top+_.scrollTop-r.y,width:f.width,height:f.height}}function qQ(e){var t=new Map,n=new Set,s=[];e.forEach(function(u){t.set(u.name,u)});function a(u){n.add(u.name);var f=[].concat(u.requires||[],u.requiresIfExists||[]);f.forEach(function(_){if(!n.has(_)){var r=t.get(_);r&&a(r)}}),s.push(u)}return e.forEach(function(u){n.has(u.name)||a(u)}),s}function XQ(e){var t=qQ(e);return oQ.reduce(function(n,s){return n.concat(t.filter(function(a){return a.phase===s}))},[])}function YQ(e){var t;return function(){return t||(t=new Promise(function(n){Promise.resolve().then(function(){t=void 0,n(e())})})),t}}function ZQ(e){var t=e.reduce(function(n,s){var a=n[s.name];return n[s.name]=a?Object.assign({},a,s,{options:Object.assign({},a.options,s.options),data:Object.assign({},a.data,s.data)}):s,n},{});return Object.keys(t).map(function(n){return t[n]})}var sF={placement:"bottom",modifiers:[],strategy:"absolute"};function aF(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return!t.some(function(s){return!(s&&typeof s.getBoundingClientRect=="function")})}function KQ(e){e===void 0&&(e={});var t=e,n=t.defaultModifiers,s=n===void 0?[]:n,a=t.defaultOptions,u=a===void 0?sF:a;return function(_,r,C){C===void 0&&(C=u);var k={placement:"bottom",orderedModifiers:[],options:Object.assign({},sF,u),modifiersData:{},elements:{reference:_,popper:r},attributes:{},styles:{}},I=[],P=!1,D={state:k,setOptions:function(H){var q=typeof H=="function"?H(k.options):H;j(),k.options=Object.assign({},u,k.options,q),k.scrollParents={reference:Im(_)?ax(_):_.contextElement?ax(_.contextElement):[],popper:ax(r)};var Z=XQ(ZQ([].concat(s,k.options.modifiers)));return k.orderedModifiers=Z.filter(function(re){return re.enabled}),N(),D.update()},forceUpdate:function(){if(!P){var H=k.elements,q=H.reference,Z=H.popper;if(aF(q,Z)){k.rects={reference:WQ(q,c1(Z),k.options.strategy==="fixed"),popper:cA(Z)},k.reset=!1,k.placement=k.options.placement,k.orderedModifiers.forEach(function(oe){return k.modifiersData[oe.name]=Object.assign({},oe.data)});for(var re=0;re<k.orderedModifiers.length;re++){if(k.reset===!0){k.reset=!1,re=-1;continue}var le=k.orderedModifiers[re],_e=le.fn,ye=le.options,de=ye===void 0?{}:ye,ce=le.name;typeof _e=="function"&&(k=_e({state:k,options:de,name:ce,instance:D})||k)}}}},update:YQ(function(){return new Promise(function(W){D.forceUpdate(),W(k)})}),destroy:function(){j(),P=!0}};if(!aF(_,r))return D;D.setOptions(C).then(function(W){!P&&C.onFirstUpdate&&C.onFirstUpdate(W)});function N(){k.orderedModifiers.forEach(function(W){var H=W.name,q=W.options,Z=q===void 0?{}:q,re=W.effect;if(typeof re=="function"){var le=re({state:k,name:H,instance:D,options:Z}),_e=function(){};I.push(le||_e)}})}function j(){I.forEach(function(W){return W()}),I=[]}return D}}var JQ=[bQ,BQ,vQ,lQ,FQ,LQ,$Q,mQ,OQ],QQ=KQ({defaultModifiers:JQ});function eee(e){return typeof e=="function"?e():e}const Wj=X.forwardRef(function(t,n){const{children:s,container:a,disablePortal:u=!1}=t,[f,_]=X.useState(null),r=mo(X.isValidElement(s)?$h(s):null,n);if(Io(()=>{u||_(eee(a)||document.body)},[a,u]),Io(()=>{if(f&&!u)return iC(n,f),()=>{iC(n,null)}},[n,f,u]),u){if(X.isValidElement(s)){const C={ref:r};return X.cloneElement(s,C)}return K.jsx(X.Fragment,{children:s})}return K.jsx(X.Fragment,{children:f&&kh.createPortal(s,f)})});function tee(e){return gi("MuiPopper",e)}pi("MuiPopper",["root"]);function nee(e,t){if(t==="ltr")return e;switch(e){case"bottom-end":return"bottom-start";case"bottom-start":return"bottom-end";case"top-end":return"top-start";case"top-start":return"top-end";default:return e}}function dP(e){return typeof e=="function"?e():e}function ree(e){return e.nodeType!==void 0}const iee=e=>{const{classes:t}=e;return yr({root:["root"]},tee,t)},oee={},see=X.forwardRef(function(t,n){const{anchorEl:s,children:a,direction:u,disablePortal:f,modifiers:_,open:r,placement:C,popperOptions:k,popperRef:I,slotProps:P={},slots:D={},TransitionProps:N,ownerState:j,...W}=t,H=X.useRef(null),q=mo(H,n),Z=X.useRef(null),re=mo(Z,I),le=X.useRef(re);Io(()=>{le.current=re},[re]),X.useImperativeHandle(I,()=>Z.current,[]);const _e=nee(C,u),[ye,de]=X.useState(_e),[ce,oe]=X.useState(dP(s));X.useEffect(()=>{Z.current&&Z.current.forceUpdate()}),X.useEffect(()=>{s&&oe(dP(s))},[s]),Io(()=>{if(!ce||!r)return;const we=Me=>{de(Me.placement)};let Se=[{name:"preventOverflow",options:{altBoundary:f}},{name:"flip",options:{altBoundary:f}},{name:"onUpdate",enabled:!0,phase:"afterWrite",fn:({state:Me})=>{we(Me)}}];_!=null&&(Se=Se.concat(_)),k&&k.modifiers!=null&&(Se=Se.concat(k.modifiers));const Pe=QQ(ce,H.current,{placement:_e,...k,modifiers:Se});return le.current(Pe),()=>{Pe.destroy(),le.current(null)}},[ce,f,_,r,k,_e]);const xe={placement:ye};N!==null&&(xe.TransitionProps=N);const he=iee(t),Ee=D.root??"div",se=Nx({elementType:Ee,externalSlotProps:P.root,externalForwardedProps:W,additionalProps:{role:"tooltip",ref:q},ownerState:t,className:he.root});return K.jsx(Ee,{...se,children:typeof a=="function"?a(xe):a})}),aee=X.forwardRef(function(t,n){const{anchorEl:s,children:a,container:u,direction:f="ltr",disablePortal:_=!1,keepMounted:r=!1,modifiers:C,open:k,placement:I="bottom",popperOptions:P=oee,popperRef:D,style:N,transition:j=!1,slotProps:W={},slots:H={},...q}=t,[Z,re]=X.useState(!0),le=()=>{re(!1)},_e=()=>{re(!0)};if(!r&&!k&&(!j||Z))return null;let ye;if(u)ye=u;else if(s){const oe=dP(s);ye=oe&&ree(oe)?As(oe).body:As(null).body}const de=!k&&r&&(!j||Z)?"none":void 0,ce=j?{in:k,onEnter:le,onExited:_e}:void 0;return K.jsx(Wj,{disablePortal:_,container:ye,children:K.jsx(see,{anchorEl:s,direction:f,disablePortal:_,modifiers:C,ref:n,open:j?!Z:k,placement:I,popperOptions:P,popperRef:D,slotProps:W,slots:H,...q,style:{position:"fixed",top:0,left:0,display:de,...N},TransitionProps:ce,children:a})})}),lee=Dn(aee,{name:"MuiPopper",slot:"Root",overridesResolver:(e,t)=>t.root})({}),Nm=X.forwardRef(function(t,n){const s=au(),a=xi({props:t,name:"MuiPopper"}),{anchorEl:u,component:f,components:_,componentsProps:r,container:C,disablePortal:k,keepMounted:I,modifiers:P,open:D,placement:N,popperOptions:j,popperRef:W,transition:H,slots:q,slotProps:Z,...re}=a,le=(q==null?void 0:q.root)??(_==null?void 0:_.Root),_e={anchorEl:u,container:C,disablePortal:k,keepMounted:I,modifiers:P,open:D,placement:N,popperOptions:j,popperRef:W,transition:H,...re};return K.jsx(lee,{as:f,direction:s?"rtl":"ltr",slots:{root:le},slotProps:Z??r,..._e,ref:n})});function uee(e){return gi("MuiListSubheader",e)}pi("MuiListSubheader",["root","colorPrimary","colorInherit","gutters","inset","sticky"]);const cee=e=>{const{classes:t,color:n,disableGutters:s,inset:a,disableSticky:u}=e,f={root:["root",n!=="default"&&`color${Rn(n)}`,!s&&"gutters",a&&"inset",!u&&"sticky"]};return yr(f,uee,t)},dee=Dn("li",{name:"MuiListSubheader",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.color!=="default"&&t[`color${Rn(n.color)}`],!n.disableGutters&&t.gutters,n.inset&&t.inset,!n.disableSticky&&t.sticky]}})($r(({theme:e})=>({boxSizing:"border-box",lineHeight:"48px",listStyle:"none",color:(e.vars||e).palette.text.secondary,fontFamily:e.typography.fontFamily,fontWeight:e.typography.fontWeightMedium,fontSize:e.typography.pxToRem(14),variants:[{props:{color:"primary"},style:{color:(e.vars||e).palette.primary.main}},{props:{color:"inherit"},style:{color:"inherit"}},{props:({ownerState:t})=>!t.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:t})=>t.inset,style:{paddingLeft:72}},{props:({ownerState:t})=>!t.disableSticky,style:{position:"sticky",top:0,zIndex:1,backgroundColor:(e.vars||e).palette.background.paper}}]}))),hP=X.forwardRef(function(t,n){const s=xi({props:t,name:"MuiListSubheader"}),{className:a,color:u="default",component:f="li",disableGutters:_=!1,disableSticky:r=!1,inset:C=!1,...k}=s,I={...s,color:u,component:f,disableGutters:_,disableSticky:r,inset:C},P=cee(I);return K.jsx(dee,{as:f,className:Hn(P.root,a),ref:n,ownerState:I,...k})});hP&&(hP.muiSkipListHighlight=!0);const hee=Jr(K.jsx("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"}),"Cancel");function fee(e){return gi("MuiChip",e)}const Yi=pi("MuiChip",["root","sizeSmall","sizeMedium","colorDefault","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","disabled","clickable","clickableColorPrimary","clickableColorSecondary","deletable","deletableColorPrimary","deletableColorSecondary","outlined","filled","outlinedPrimary","outlinedSecondary","filledPrimary","filledSecondary","avatar","avatarSmall","avatarMedium","avatarColorPrimary","avatarColorSecondary","icon","iconSmall","iconMedium","iconColorPrimary","iconColorSecondary","label","labelSmall","labelMedium","deleteIcon","deleteIconSmall","deleteIconMedium","deleteIconColorPrimary","deleteIconColorSecondary","deleteIconOutlinedColorPrimary","deleteIconOutlinedColorSecondary","deleteIconFilledColorPrimary","deleteIconFilledColorSecondary","focusVisible"]),pee=e=>{const{classes:t,disabled:n,size:s,color:a,iconColor:u,onDelete:f,clickable:_,variant:r}=e,C={root:["root",r,n&&"disabled",`size${Rn(s)}`,`color${Rn(a)}`,_&&"clickable",_&&`clickableColor${Rn(a)}`,f&&"deletable",f&&`deletableColor${Rn(a)}`,`${r}${Rn(a)}`],label:["label",`label${Rn(s)}`],avatar:["avatar",`avatar${Rn(s)}`,`avatarColor${Rn(a)}`],icon:["icon",`icon${Rn(s)}`,`iconColor${Rn(u)}`],deleteIcon:["deleteIcon",`deleteIcon${Rn(s)}`,`deleteIconColor${Rn(a)}`,`deleteIcon${Rn(r)}Color${Rn(a)}`]};return yr(C,fee,t)},mee=Dn("div",{name:"MuiChip",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e,{color:s,iconColor:a,clickable:u,onDelete:f,size:_,variant:r}=n;return[{[`& .${Yi.avatar}`]:t.avatar},{[`& .${Yi.avatar}`]:t[`avatar${Rn(_)}`]},{[`& .${Yi.avatar}`]:t[`avatarColor${Rn(s)}`]},{[`& .${Yi.icon}`]:t.icon},{[`& .${Yi.icon}`]:t[`icon${Rn(_)}`]},{[`& .${Yi.icon}`]:t[`iconColor${Rn(a)}`]},{[`& .${Yi.deleteIcon}`]:t.deleteIcon},{[`& .${Yi.deleteIcon}`]:t[`deleteIcon${Rn(_)}`]},{[`& .${Yi.deleteIcon}`]:t[`deleteIconColor${Rn(s)}`]},{[`& .${Yi.deleteIcon}`]:t[`deleteIcon${Rn(r)}Color${Rn(s)}`]},t.root,t[`size${Rn(_)}`],t[`color${Rn(s)}`],u&&t.clickable,u&&s!=="default"&&t[`clickableColor${Rn(s)})`],f&&t.deletable,f&&s!=="default"&&t[`deletableColor${Rn(s)}`],t[r],t[`${r}${Rn(s)}`]]}})($r(({theme:e})=>{const t=e.palette.mode==="light"?e.palette.grey[700]:e.palette.grey[300];return{maxWidth:"100%",fontFamily:e.typography.fontFamily,fontSize:e.typography.pxToRem(13),display:"inline-flex",alignItems:"center",justifyContent:"center",height:32,color:(e.vars||e).palette.text.primary,backgroundColor:(e.vars||e).palette.action.selected,borderRadius:32/2,whiteSpace:"nowrap",transition:e.transitions.create(["background-color","box-shadow"]),cursor:"unset",outline:0,textDecoration:"none",border:0,padding:0,verticalAlign:"middle",boxSizing:"border-box",[`&.${Yi.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity,pointerEvents:"none"},[`& .${Yi.avatar}`]:{marginLeft:5,marginRight:-6,width:24,height:24,color:e.vars?e.vars.palette.Chip.defaultAvatarColor:t,fontSize:e.typography.pxToRem(12)},[`& .${Yi.avatarColorPrimary}`]:{color:(e.vars||e).palette.primary.contrastText,backgroundColor:(e.vars||e).palette.primary.dark},[`& .${Yi.avatarColorSecondary}`]:{color:(e.vars||e).palette.secondary.contrastText,backgroundColor:(e.vars||e).palette.secondary.dark},[`& .${Yi.avatarSmall}`]:{marginLeft:4,marginRight:-4,width:18,height:18,fontSize:e.typography.pxToRem(10)},[`& .${Yi.icon}`]:{marginLeft:5,marginRight:-6},[`& .${Yi.deleteIcon}`]:{WebkitTapHighlightColor:"transparent",color:e.vars?`rgba(${e.vars.palette.text.primaryChannel} / 0.26)`:vi(e.palette.text.primary,.26),fontSize:22,cursor:"pointer",margin:"0 5px 0 -6px","&:hover":{color:e.vars?`rgba(${e.vars.palette.text.primaryChannel} / 0.4)`:vi(e.palette.text.primary,.4)}},variants:[{props:{size:"small"},style:{height:24,[`& .${Yi.icon}`]:{fontSize:18,marginLeft:4,marginRight:-4},[`& .${Yi.deleteIcon}`]:{fontSize:16,marginRight:4,marginLeft:-4}}},...Object.entries(e.palette).filter(Ms(["contrastText"])).map(([n])=>({props:{color:n},style:{backgroundColor:(e.vars||e).palette[n].main,color:(e.vars||e).palette[n].contrastText,[`& .${Yi.deleteIcon}`]:{color:e.vars?`rgba(${e.vars.palette[n].contrastTextChannel} / 0.7)`:vi(e.palette[n].contrastText,.7),"&:hover, &:active":{color:(e.vars||e).palette[n].contrastText}}}})),{props:n=>n.iconColor===n.color,style:{[`& .${Yi.icon}`]:{color:e.vars?e.vars.palette.Chip.defaultIconColor:t}}},{props:n=>n.iconColor===n.color&&n.color!=="default",style:{[`& .${Yi.icon}`]:{color:"inherit"}}},{props:{onDelete:!0},style:{[`&.${Yi.focusVisible}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.action.selectedChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.focusOpacity}))`:vi(e.palette.action.selected,e.palette.action.selectedOpacity+e.palette.action.focusOpacity)}}},...Object.entries(e.palette).filter(Ms(["dark"])).map(([n])=>({props:{color:n,onDelete:!0},style:{[`&.${Yi.focusVisible}`]:{background:(e.vars||e).palette[n].dark}}})),{props:{clickable:!0},style:{userSelect:"none",WebkitTapHighlightColor:"transparent",cursor:"pointer","&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.selectedChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:vi(e.palette.action.selected,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity)},[`&.${Yi.focusVisible}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.action.selectedChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.focusOpacity}))`:vi(e.palette.action.selected,e.palette.action.selectedOpacity+e.palette.action.focusOpacity)},"&:active":{boxShadow:(e.vars||e).shadows[1]}}},...Object.entries(e.palette).filter(Ms(["dark"])).map(([n])=>({props:{color:n,clickable:!0},style:{[`&:hover, &.${Yi.focusVisible}`]:{backgroundColor:(e.vars||e).palette[n].dark}}})),{props:{variant:"outlined"},style:{backgroundColor:"transparent",border:e.vars?`1px solid ${e.vars.palette.Chip.defaultBorder}`:`1px solid ${e.palette.mode==="light"?e.palette.grey[400]:e.palette.grey[700]}`,[`&.${Yi.clickable}:hover`]:{backgroundColor:(e.vars||e).palette.action.hover},[`&.${Yi.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`& .${Yi.avatar}`]:{marginLeft:4},[`& .${Yi.avatarSmall}`]:{marginLeft:2},[`& .${Yi.icon}`]:{marginLeft:4},[`& .${Yi.iconSmall}`]:{marginLeft:2},[`& .${Yi.deleteIcon}`]:{marginRight:5},[`& .${Yi.deleteIconSmall}`]:{marginRight:3}}},...Object.entries(e.palette).filter(Ms()).map(([n])=>({props:{variant:"outlined",color:n},style:{color:(e.vars||e).palette[n].main,border:`1px solid ${e.vars?`rgba(${e.vars.palette[n].mainChannel} / 0.7)`:vi(e.palette[n].main,.7)}`,[`&.${Yi.clickable}:hover`]:{backgroundColor:e.vars?`rgba(${e.vars.palette[n].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:vi(e.palette[n].main,e.palette.action.hoverOpacity)},[`&.${Yi.focusVisible}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette[n].mainChannel} / ${e.vars.palette.action.focusOpacity})`:vi(e.palette[n].main,e.palette.action.focusOpacity)},[`& .${Yi.deleteIcon}`]:{color:e.vars?`rgba(${e.vars.palette[n].mainChannel} / 0.7)`:vi(e.palette[n].main,.7),"&:hover, &:active":{color:(e.vars||e).palette[n].main}}}}))]}})),gee=Dn("span",{name:"MuiChip",slot:"Label",overridesResolver:(e,t)=>{const{ownerState:n}=e,{size:s}=n;return[t.label,t[`label${Rn(s)}`]]}})({overflow:"hidden",textOverflow:"ellipsis",paddingLeft:12,paddingRight:12,whiteSpace:"nowrap",variants:[{props:{variant:"outlined"},style:{paddingLeft:11,paddingRight:11}},{props:{size:"small"},style:{paddingLeft:8,paddingRight:8}},{props:{size:"small",variant:"outlined"},style:{paddingLeft:7,paddingRight:7}}]});function lF(e){return e.key==="Backspace"||e.key==="Delete"}const ME=X.forwardRef(function(t,n){const s=xi({props:t,name:"MuiChip"}),{avatar:a,className:u,clickable:f,color:_="default",component:r,deleteIcon:C,disabled:k=!1,icon:I,label:P,onClick:D,onDelete:N,onKeyDown:j,onKeyUp:W,size:H="medium",variant:q="filled",tabIndex:Z,skipFocusWhenDisabled:re=!1,...le}=s,_e=X.useRef(null),ye=mo(_e,n),de=Re=>{Re.stopPropagation(),N&&N(Re)},ce=Re=>{Re.currentTarget===Re.target&&lF(Re)&&Re.preventDefault(),j&&j(Re)},oe=Re=>{Re.currentTarget===Re.target&&N&&lF(Re)&&N(Re),W&&W(Re)},xe=f!==!1&&D?!0:f,he=xe||N?lp:r||"div",Ee={...s,component:he,disabled:k,size:H,color:_,iconColor:X.isValidElement(I)&&I.props.color||_,onDelete:!!N,clickable:xe,variant:q},se=pee(Ee),we=he===lp?{component:r||"div",focusVisibleClassName:se.focusVisible,...N&&{disableRipple:!0}}:{};let Se=null;N&&(Se=C&&X.isValidElement(C)?X.cloneElement(C,{className:Hn(C.props.className,se.deleteIcon),onClick:de}):K.jsx(hee,{className:Hn(se.deleteIcon),onClick:de}));let Pe=null;a&&X.isValidElement(a)&&(Pe=X.cloneElement(a,{className:Hn(se.avatar,a.props.className)}));let Me=null;return I&&X.isValidElement(I)&&(Me=X.cloneElement(I,{className:Hn(se.icon,I.props.className)})),K.jsxs(mee,{as:he,className:Hn(se.root,u),disabled:xe&&k?!0:void 0,onClick:D,onKeyDown:ce,onKeyUp:oe,ref:ye,tabIndex:re&&k?-1:Z,ownerState:Ee,...we,...le,children:[Pe||Me,K.jsx(gee,{className:Hn(se.label),ownerState:Ee,children:P}),Se]})});function Mw(e){return parseInt(e,10)||0}const yee={shadow:{visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"}};function _ee(e){return e==null||Object.keys(e).length===0||e.outerHeightStyle===0&&!e.overflowing}const vee=X.forwardRef(function(t,n){const{onChange:s,maxRows:a,minRows:u=1,style:f,value:_,...r}=t,{current:C}=X.useRef(_!=null),k=X.useRef(null),I=mo(n,k),P=X.useRef(null),D=X.useRef(null),N=X.useCallback(()=>{const H=k.current,Z=pc(H).getComputedStyle(H);if(Z.width==="0px")return{outerHeightStyle:0,overflowing:!1};const re=D.current;re.style.width=Z.width,re.value=H.value||t.placeholder||"x",re.value.slice(-1)===`
`&&(re.value+=" ");const le=Z.boxSizing,_e=Mw(Z.paddingBottom)+Mw(Z.paddingTop),ye=Mw(Z.borderBottomWidth)+Mw(Z.borderTopWidth),de=re.scrollHeight;re.value="x";const ce=re.scrollHeight;let oe=de;u&&(oe=Math.max(Number(u)*ce,oe)),a&&(oe=Math.min(Number(a)*ce,oe)),oe=Math.max(oe,ce);const xe=oe+(le==="border-box"?_e+ye:0),he=Math.abs(oe-de)<=1;return{outerHeightStyle:xe,overflowing:he}},[a,u,t.placeholder]),j=X.useCallback(()=>{const H=N();if(_ee(H))return;const q=H.outerHeightStyle,Z=k.current;P.current!==q&&(P.current=q,Z.style.height=`${q}px`),Z.style.overflow=H.overflowing?"hidden":""},[N]);Io(()=>{const H=()=>{j()};let q;const Z=rA(H),re=k.current,le=pc(re);le.addEventListener("resize",Z);let _e;return typeof ResizeObserver<"u"&&(_e=new ResizeObserver(H),_e.observe(re)),()=>{Z.clear(),cancelAnimationFrame(q),le.removeEventListener("resize",Z),_e&&_e.disconnect()}},[N,j]),Io(()=>{j()});const W=H=>{C||j(),s&&s(H)};return K.jsxs(X.Fragment,{children:[K.jsx("textarea",{value:_,onChange:W,ref:I,rows:u,style:f,...r}),K.jsx("textarea",{"aria-hidden":!0,className:t.className,readOnly:!0,ref:D,tabIndex:-1,style:{...yee.shadow,...f,paddingTop:0,paddingBottom:0}})]})});function uC(e){return typeof e=="string"}function Bm({props:e,states:t,muiFormControl:n}){return t.reduce((s,a)=>(s[a]=e[a],n&&typeof e[a]>"u"&&(s[a]=n[a]),s),{})}const PE=X.createContext(void 0);function Gh(){return X.useContext(PE)}function uF(e){return e!=null&&!(Array.isArray(e)&&e.length===0)}function cC(e,t=!1){return e&&(uF(e.value)&&e.value!==""||t&&uF(e.defaultValue)&&e.defaultValue!=="")}function xee(e){return e.startAdornment}function bee(e){return gi("MuiInputBase",e)}const xu=pi("MuiInputBase",["root","formControl","focused","disabled","adornedStart","adornedEnd","error","sizeSmall","multiline","colorSecondary","fullWidth","hiddenLabel","readOnly","input","inputSizeSmall","inputMultiline","inputTypeSearch","inputAdornedStart","inputAdornedEnd","inputHiddenLabel"]);var cF;const AE=(e,t)=>{const{ownerState:n}=e;return[t.root,n.formControl&&t.formControl,n.startAdornment&&t.adornedStart,n.endAdornment&&t.adornedEnd,n.error&&t.error,n.size==="small"&&t.sizeSmall,n.multiline&&t.multiline,n.color&&t[`color${Rn(n.color)}`],n.fullWidth&&t.fullWidth,n.hiddenLabel&&t.hiddenLabel]},LE=(e,t)=>{const{ownerState:n}=e;return[t.input,n.size==="small"&&t.inputSizeSmall,n.multiline&&t.inputMultiline,n.type==="search"&&t.inputTypeSearch,n.startAdornment&&t.inputAdornedStart,n.endAdornment&&t.inputAdornedEnd,n.hiddenLabel&&t.inputHiddenLabel]},wee=e=>{const{classes:t,color:n,disabled:s,error:a,endAdornment:u,focused:f,formControl:_,fullWidth:r,hiddenLabel:C,multiline:k,readOnly:I,size:P,startAdornment:D,type:N}=e,j={root:["root",`color${Rn(n)}`,s&&"disabled",a&&"error",r&&"fullWidth",f&&"focused",_&&"formControl",P&&P!=="medium"&&`size${Rn(P)}`,k&&"multiline",D&&"adornedStart",u&&"adornedEnd",C&&"hiddenLabel",I&&"readOnly"],input:["input",s&&"disabled",N==="search"&&"inputTypeSearch",k&&"inputMultiline",P==="small"&&"inputSizeSmall",C&&"inputHiddenLabel",D&&"inputAdornedStart",u&&"inputAdornedEnd",I&&"readOnly"]};return yr(j,bee,t)},RE=Dn("div",{name:"MuiInputBase",slot:"Root",overridesResolver:AE})($r(({theme:e})=>({...e.typography.body1,color:(e.vars||e).palette.text.primary,lineHeight:"1.4375em",boxSizing:"border-box",position:"relative",cursor:"text",display:"inline-flex",alignItems:"center",[`&.${xu.disabled}`]:{color:(e.vars||e).palette.text.disabled,cursor:"default"},variants:[{props:({ownerState:t})=>t.multiline,style:{padding:"4px 0 5px"}},{props:({ownerState:t,size:n})=>t.multiline&&n==="small",style:{paddingTop:1}},{props:({ownerState:t})=>t.fullWidth,style:{width:"100%"}}]}))),OE=Dn("input",{name:"MuiInputBase",slot:"Input",overridesResolver:LE})($r(({theme:e})=>{const t=e.palette.mode==="light",n={color:"currentColor",...e.vars?{opacity:e.vars.opacity.inputPlaceholder}:{opacity:t?.42:.5},transition:e.transitions.create("opacity",{duration:e.transitions.duration.shorter})},s={opacity:"0 !important"},a=e.vars?{opacity:e.vars.opacity.inputPlaceholder}:{opacity:t?.42:.5};return{font:"inherit",letterSpacing:"inherit",color:"currentColor",padding:"4px 0 5px",border:0,boxSizing:"content-box",background:"none",height:"1.4375em",margin:0,WebkitTapHighlightColor:"transparent",display:"block",minWidth:0,width:"100%","&::-webkit-input-placeholder":n,"&::-moz-placeholder":n,"&::-ms-input-placeholder":n,"&:focus":{outline:0},"&:invalid":{boxShadow:"none"},"&::-webkit-search-decoration":{WebkitAppearance:"none"},[`label[data-shrink=false] + .${xu.formControl} &`]:{"&::-webkit-input-placeholder":s,"&::-moz-placeholder":s,"&::-ms-input-placeholder":s,"&:focus::-webkit-input-placeholder":a,"&:focus::-moz-placeholder":a,"&:focus::-ms-input-placeholder":a},[`&.${xu.disabled}`]:{opacity:1,WebkitTextFillColor:(e.vars||e).palette.text.disabled},variants:[{props:({ownerState:u})=>!u.disableInjectingGlobalStyles,style:{animationName:"mui-auto-fill-cancel",animationDuration:"10ms","&:-webkit-autofill":{animationDuration:"5000s",animationName:"mui-auto-fill"}}},{props:{size:"small"},style:{paddingTop:1}},{props:({ownerState:u})=>u.multiline,style:{height:"auto",resize:"none",padding:0,paddingTop:0}},{props:{type:"search"},style:{MozAppearance:"textfield"}}]}})),dF=rJ({"@keyframes mui-auto-fill":{from:{display:"block"}},"@keyframes mui-auto-fill-cancel":{from:{display:"block"}}}),w0=X.forwardRef(function(t,n){const s=xi({props:t,name:"MuiInputBase"}),{"aria-describedby":a,autoComplete:u,autoFocus:f,className:_,color:r,components:C={},componentsProps:k={},defaultValue:I,disabled:P,disableInjectingGlobalStyles:D,endAdornment:N,error:j,fullWidth:W=!1,id:H,inputComponent:q="input",inputProps:Z={},inputRef:re,margin:le,maxRows:_e,minRows:ye,multiline:de=!1,name:ce,onBlur:oe,onChange:xe,onClick:he,onFocus:Ee,onKeyDown:se,onKeyUp:we,placeholder:Se,readOnly:Pe,renderSuffix:Me,rows:Re,size:Oe,slotProps:$e={},slots:Ke={},startAdornment:Ct,type:Ue="text",value:ft,...Bt}=s,hn=Z.value!=null?Z.value:ft,{current:ot}=X.useRef(hn!=null),en=X.useRef(),wt=X.useCallback(xn=>{},[]),Ne=mo(en,re,Z.ref,wt),[We,Sn]=X.useState(!1),Ae=Gh(),st=Bm({props:s,muiFormControl:Ae,states:["color","disabled","error","hiddenLabel","size","required","filled"]});st.focused=Ae?Ae.focused:We,X.useEffect(()=>{!Ae&&P&&We&&(Sn(!1),oe&&oe())},[Ae,P,We,oe]);const gt=Ae&&Ae.onFilled,ut=Ae&&Ae.onEmpty,tt=X.useCallback(xn=>{cC(xn)?gt&&gt():ut&&ut()},[gt,ut]);Io(()=>{ot&&tt({value:hn})},[hn,tt,ot]);const nt=xn=>{Ee&&Ee(xn),Z.onFocus&&Z.onFocus(xn),Ae&&Ae.onFocus?Ae.onFocus(xn):Sn(!0)},tn=xn=>{oe&&oe(xn),Z.onBlur&&Z.onBlur(xn),Ae&&Ae.onBlur?Ae.onBlur(xn):Sn(!1)},un=(xn,...Er)=>{if(!ot){const Rr=xn.target||en.current;if(Rr==null)throw new Error(zh(1));tt({value:Rr.value})}Z.onChange&&Z.onChange(xn,...Er),xe&&xe(xn,...Er)};X.useEffect(()=>{tt(en.current)},[]);const qt=xn=>{en.current&&xn.currentTarget===xn.target&&en.current.focus(),he&&he(xn)};let an=q,Jt=Z;de&&an==="input"&&(Re?Jt={type:void 0,minRows:Re,maxRows:Re,...Jt}:Jt={type:void 0,maxRows:_e,minRows:ye,...Jt},an=vee);const Wt=xn=>{tt(xn.animationName==="mui-auto-fill-cancel"?en.current:{value:"x"})};X.useEffect(()=>{Ae&&Ae.setAdornedStart(!!Ct)},[Ae,Ct]);const Fn={...s,color:st.color||"primary",disabled:st.disabled,endAdornment:N,error:st.error,focused:st.focused,formControl:Ae,fullWidth:W,hiddenLabel:st.hiddenLabel,multiline:de,size:st.size,startAdornment:Ct,type:Ue},ar=wee(Fn),bn=Ke.root||C.Root||RE,lr=$e.root||k.root||{},Cn=Ke.input||C.Input||OE;return Jt={...Jt,...$e.input??k.input},K.jsxs(X.Fragment,{children:[!D&&typeof dF=="function"&&(cF||(cF=K.jsx(dF,{}))),K.jsxs(bn,{...lr,ref:n,onClick:qt,...Bt,...!uC(bn)&&{ownerState:{...Fn,...lr.ownerState}},className:Hn(ar.root,lr.className,_,Pe&&"MuiInputBase-readOnly"),children:[Ct,K.jsx(PE.Provider,{value:null,children:K.jsx(Cn,{"aria-invalid":st.error,"aria-describedby":a,autoComplete:u,autoFocus:f,defaultValue:I,disabled:st.disabled,id:H,onAnimationStart:Wt,name:ce,placeholder:Se,readOnly:Pe,required:st.required,rows:Re,value:hn,onKeyDown:se,onKeyUp:we,type:Ue,...Jt,...!uC(Cn)&&{as:an,ownerState:{...Fn,...Jt.ownerState}},ref:Ne,className:Hn(ar.input,Jt.className,Pe&&"MuiInputBase-readOnly"),onBlur:tn,onChange:un,onFocus:nt})}),N,Me?Me({...st,startAdornment:Ct}):null]})]})});function See(e){return gi("MuiInput",e)}const Ff={...xu,...pi("MuiInput",["root","underline","input"])};function Cee(e){return gi("MuiOutlinedInput",e)}const Zu={...xu,...pi("MuiOutlinedInput",["root","notchedOutline","input"])};function Eee(e){return gi("MuiFilledInput",e)}const bu={...xu,...pi("MuiFilledInput",["root","underline","input","adornedStart","adornedEnd","sizeSmall","multiline","hiddenLabel"])},qj=Jr(K.jsx("path",{d:"M7 10l5 5 5-5z"}),"ArrowDropDown");function Tee(e){return gi("MuiAutocomplete",e)}const Ni=pi("MuiAutocomplete",["root","expanded","fullWidth","focused","focusVisible","tag","tagSizeSmall","tagSizeMedium","hasPopupIcon","hasClearIcon","inputRoot","input","inputFocused","endAdornment","clearIndicator","popupIndicator","popupIndicatorOpen","popper","popperDisablePortal","paper","listbox","loading","noOptions","option","groupLabel","groupUl"]);var hF,fF;const Iee=e=>{const{classes:t,disablePortal:n,expanded:s,focused:a,fullWidth:u,hasClearIcon:f,hasPopupIcon:_,inputFocused:r,popupOpen:C,size:k}=e,I={root:["root",s&&"expanded",a&&"focused",u&&"fullWidth",f&&"hasClearIcon",_&&"hasPopupIcon"],inputRoot:["inputRoot"],input:["input",r&&"inputFocused"],tag:["tag",`tagSize${Rn(k)}`],endAdornment:["endAdornment"],clearIndicator:["clearIndicator"],popupIndicator:["popupIndicator",C&&"popupIndicatorOpen"],popper:["popper",n&&"popperDisablePortal"],paper:["paper"],listbox:["listbox"],loading:["loading"],noOptions:["noOptions"],option:["option"],groupLabel:["groupLabel"],groupUl:["groupUl"]};return yr(I,Tee,t)},kee=Dn("div",{name:"MuiAutocomplete",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e,{fullWidth:s,hasClearIcon:a,hasPopupIcon:u,inputFocused:f,size:_}=n;return[{[`& .${Ni.tag}`]:t.tag},{[`& .${Ni.tag}`]:t[`tagSize${Rn(_)}`]},{[`& .${Ni.inputRoot}`]:t.inputRoot},{[`& .${Ni.input}`]:t.input},{[`& .${Ni.input}`]:f&&t.inputFocused},t.root,s&&t.fullWidth,u&&t.hasPopupIcon,a&&t.hasClearIcon]}})({[`&.${Ni.focused} .${Ni.clearIndicator}`]:{visibility:"visible"},"@media (pointer: fine)":{[`&:hover .${Ni.clearIndicator}`]:{visibility:"visible"}},[`& .${Ni.tag}`]:{margin:3,maxWidth:"calc(100% - 6px)"},[`& .${Ni.inputRoot}`]:{[`.${Ni.hasPopupIcon}&, .${Ni.hasClearIcon}&`]:{paddingRight:30},[`.${Ni.hasPopupIcon}.${Ni.hasClearIcon}&`]:{paddingRight:56},[`& .${Ni.input}`]:{width:0,minWidth:30}},[`& .${Ff.root}`]:{paddingBottom:1,"& .MuiInput-input":{padding:"4px 4px 4px 0px"}},[`& .${Ff.root}.${xu.sizeSmall}`]:{[`& .${Ff.input}`]:{padding:"2px 4px 3px 0"}},[`& .${Zu.root}`]:{padding:9,[`.${Ni.hasPopupIcon}&, .${Ni.hasClearIcon}&`]:{paddingRight:39},[`.${Ni.hasPopupIcon}.${Ni.hasClearIcon}&`]:{paddingRight:65},[`& .${Ni.input}`]:{padding:"7.5px 4px 7.5px 5px"},[`& .${Ni.endAdornment}`]:{right:9}},[`& .${Zu.root}.${xu.sizeSmall}`]:{paddingTop:6,paddingBottom:6,paddingLeft:6,[`& .${Ni.input}`]:{padding:"2.5px 4px 2.5px 8px"}},[`& .${bu.root}`]:{paddingTop:19,paddingLeft:8,[`.${Ni.hasPopupIcon}&, .${Ni.hasClearIcon}&`]:{paddingRight:39},[`.${Ni.hasPopupIcon}.${Ni.hasClearIcon}&`]:{paddingRight:65},[`& .${bu.input}`]:{padding:"7px 4px"},[`& .${Ni.endAdornment}`]:{right:9}},[`& .${bu.root}.${xu.sizeSmall}`]:{paddingBottom:1,[`& .${bu.input}`]:{padding:"2.5px 4px"}},[`& .${xu.hiddenLabel}`]:{paddingTop:8},[`& .${bu.root}.${xu.hiddenLabel}`]:{paddingTop:0,paddingBottom:0,[`& .${Ni.input}`]:{paddingTop:16,paddingBottom:17}},[`& .${bu.root}.${xu.hiddenLabel}.${xu.sizeSmall}`]:{[`& .${Ni.input}`]:{paddingTop:8,paddingBottom:9}},[`& .${Ni.input}`]:{flexGrow:1,textOverflow:"ellipsis",opacity:0},variants:[{props:{fullWidth:!0},style:{width:"100%"}},{props:{size:"small"},style:{[`& .${Ni.tag}`]:{margin:2,maxWidth:"calc(100% - 4px)"}}},{props:{inputFocused:!0},style:{[`& .${Ni.input}`]:{opacity:1}}},{props:{multiple:!0},style:{[`& .${Ni.inputRoot}`]:{flexWrap:"wrap"}}}]}),Mee=Dn("div",{name:"MuiAutocomplete",slot:"EndAdornment",overridesResolver:(e,t)=>t.endAdornment})({position:"absolute",right:0,top:"50%",transform:"translate(0, -50%)"}),Pee=Dn(ga,{name:"MuiAutocomplete",slot:"ClearIndicator",overridesResolver:(e,t)=>t.clearIndicator})({marginRight:-2,padding:4,visibility:"hidden"}),Aee=Dn(ga,{name:"MuiAutocomplete",slot:"PopupIndicator",overridesResolver:({ownerState:e},t)=>({...t.popupIndicator,...e.popupOpen&&t.popupIndicatorOpen})})({padding:2,marginRight:-2,variants:[{props:{popupOpen:!0},style:{transform:"rotate(180deg)"}}]}),Lee=Dn(Nm,{name:"MuiAutocomplete",slot:"Popper",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[{[`& .${Ni.option}`]:t.option},t.popper,n.disablePortal&&t.popperDisablePortal]}})($r(({theme:e})=>({zIndex:(e.vars||e).zIndex.modal,variants:[{props:{disablePortal:!0},style:{position:"absolute"}}]}))),Ree=Dn(b0,{name:"MuiAutocomplete",slot:"Paper",overridesResolver:(e,t)=>t.paper})($r(({theme:e})=>({...e.typography.body1,overflow:"auto"}))),Oee=Dn("div",{name:"MuiAutocomplete",slot:"Loading",overridesResolver:(e,t)=>t.loading})($r(({theme:e})=>({color:(e.vars||e).palette.text.secondary,padding:"14px 16px"}))),Dee=Dn("div",{name:"MuiAutocomplete",slot:"NoOptions",overridesResolver:(e,t)=>t.noOptions})($r(({theme:e})=>({color:(e.vars||e).palette.text.secondary,padding:"14px 16px"}))),zee=Dn("div",{name:"MuiAutocomplete",slot:"Listbox",overridesResolver:(e,t)=>t.listbox})($r(({theme:e})=>({listStyle:"none",margin:0,padding:"8px 0",maxHeight:"40vh",overflow:"auto",position:"relative",[`& .${Ni.option}`]:{minHeight:48,display:"flex",overflow:"hidden",justifyContent:"flex-start",alignItems:"center",cursor:"pointer",paddingTop:6,boxSizing:"border-box",outline:"0",WebkitTapHighlightColor:"transparent",paddingBottom:6,paddingLeft:16,paddingRight:16,[e.breakpoints.up("sm")]:{minHeight:"auto"},[`&.${Ni.focused}`]:{backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},'&[aria-disabled="true"]':{opacity:(e.vars||e).palette.action.disabledOpacity,pointerEvents:"none"},[`&.${Ni.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},'&[aria-selected="true"]':{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:vi(e.palette.primary.main,e.palette.action.selectedOpacity),[`&.${Ni.focused}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:vi(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:(e.vars||e).palette.action.selected}},[`&.${Ni.focusVisible}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.focusOpacity}))`:vi(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.focusOpacity)}}}}))),Fee=Dn(hP,{name:"MuiAutocomplete",slot:"GroupLabel",overridesResolver:(e,t)=>t.groupLabel})($r(({theme:e})=>({backgroundColor:(e.vars||e).palette.background.paper,top:-8}))),Nee=Dn("ul",{name:"MuiAutocomplete",slot:"GroupUl",overridesResolver:(e,t)=>t.groupUl})({padding:0,[`& .${Ni.option}`]:{paddingLeft:24}}),Xj=X.forwardRef(function(t,n){const s=xi({props:t,name:"MuiAutocomplete"}),{autoComplete:a=!1,autoHighlight:u=!1,autoSelect:f=!1,blurOnSelect:_=!1,ChipProps:r,className:C,clearIcon:k=hF||(hF=K.jsx(NJ,{fontSize:"small"})),clearOnBlur:I=!s.freeSolo,clearOnEscape:P=!1,clearText:D="Clear",closeText:N="Close",componentsProps:j,defaultValue:W=s.multiple?[]:null,disableClearable:H=!1,disableCloseOnSelect:q=!1,disabled:Z=!1,disabledItemsFocusable:re=!1,disableListWrap:le=!1,disablePortal:_e=!1,filterOptions:ye,filterSelectedOptions:de=!1,forcePopupIcon:ce="auto",freeSolo:oe=!1,fullWidth:xe=!1,getLimitTagsText:he=ei=>`+${ei}`,getOptionDisabled:Ee,getOptionKey:se,getOptionLabel:we,isOptionEqualToValue:Se,groupBy:Pe,handleHomeEndKeys:Me=!s.freeSolo,id:Re,includeInputInList:Oe=!1,inputValue:$e,limitTags:Ke=-1,ListboxComponent:Ct,ListboxProps:Ue,loading:ft=!1,loadingText:Bt="Loading…",multiple:hn=!1,noOptionsText:ot="No options",onChange:en,onClose:wt,onHighlightChange:Ne,onInputChange:We,onOpen:Sn,open:Ae,openOnFocus:st=!1,openText:gt="Open",options:ut,PaperComponent:tt,PopperComponent:nt,popupIcon:tn=fF||(fF=K.jsx(qj,{})),readOnly:un=!1,renderGroup:qt,renderInput:an,renderOption:Jt,renderTags:Wt,selectOnFocus:Fn=!s.freeSolo,size:ar="medium",slots:bn={},slotProps:lr={},value:Cn,...xn}=s,{getRootProps:Er,getInputProps:Rr,getInputLabelProps:Wn,getPopupIndicatorProps:Mn,getClearProps:Ar,getTagProps:fi,getListboxProps:yo,getOptionProps:vr,value:zi,dirty:Li,expanded:mi,id:ji,popupOpen:ko,focused:qo,focusedTag:Oo,anchorEl:Pn,setAnchorEl:Vt,inputValue:ze,groupedOptions:Ve}=qJ({...s,componentName:"Autocomplete"}),at=!H&&!Z&&Li&&!un,_t=(!oe||ce===!0)&&ce!==!1,{onMouseDown:ht}=Rr(),{ref:Mt,...Xt}=yo(),Gt=we||(ei=>ei.label??ei),Zt={...s,disablePortal:_e,expanded:mi,focused:qo,fullWidth:xe,getOptionLabel:Gt,hasClearIcon:at,hasPopupIcon:_t,inputFocused:Oo===-1,popupOpen:ko,size:ar},Ht=Iee(Zt),fn={slots:{listbox:Ct,paper:tt,popper:nt,...bn},slotProps:{chip:r,listbox:Ue,...j,...lr}},[Nt,zt]=pl("listbox",{elementType:"ul",externalForwardedProps:fn,ownerState:Zt,className:Ht.listbox,additionalProps:Xt,ref:Mt}),[yn,qn]=pl("paper",{elementType:b0,externalForwardedProps:fn,ownerState:Zt,className:Ht.paper}),[Jn,ur]=pl("popper",{elementType:Nm,externalForwardedProps:fn,ownerState:Zt,className:Ht.popper,additionalProps:{disablePortal:_e,style:{width:Pn?Pn.clientWidth:null},role:"presentation",anchorEl:Pn,open:ko}});let Cr;if(hn&&zi.length>0){const ei=Ji=>({className:Ht.tag,disabled:Z,...fi(Ji)});Wt?Cr=Wt(zi,ei,Zt):Cr=zi.map((Ji,ns)=>{const{key:Xo,...Rs}=ei({index:ns});return K.jsx(ME,{label:Gt(Ji),size:ar,...Rs,...fn.slotProps.chip},Xo)})}if(Ke>-1&&Array.isArray(Cr)){const ei=Cr.length-Ke;!qo&&ei>0&&(Cr=Cr.splice(0,Ke),Cr.push(K.jsx("span",{className:Ht.tag,children:he(ei)},Cr.length)))}const Fr=qt||(ei=>K.jsxs("li",{children:[K.jsx(Fee,{className:Ht.groupLabel,ownerState:Zt,component:"div",children:ei.group}),K.jsx(Nee,{className:Ht.groupUl,ownerState:Zt,children:ei.children})]},ei.key)),Mi=Jt||((ei,Ji)=>{const{key:ns,...Xo}=ei;return K.jsx("li",{...Xo,children:Gt(Ji)},ns)}),Wi=(ei,Ji)=>{const ns=vr({option:ei,index:Ji});return Mi({...ns,className:Ht.option},ei,{selected:ns["aria-selected"],index:Ji,inputValue:ze},Zt)},Ki=fn.slotProps.clearIndicator,yi=fn.slotProps.popupIndicator,bs=ei=>K.jsx(Lee,{as:Jn,...ur,children:K.jsx(Ree,{as:yn,...qn,children:ei})});let Us=null;return Ve.length>0?Us=bs(K.jsx(zee,{as:Nt,...zt,children:Ve.map((ei,Ji)=>Pe?Fr({key:ei.key,group:ei.group,children:ei.options.map((ns,Xo)=>Wi(ns,ei.index+Xo))}):Wi(ei,Ji))})):ft&&Ve.length===0?Us=bs(K.jsx(Oee,{className:Ht.loading,ownerState:Zt,children:Bt})):Ve.length===0&&!oe&&!ft&&(Us=bs(K.jsx(Dee,{className:Ht.noOptions,ownerState:Zt,role:"presentation",onMouseDown:ei=>{ei.preventDefault()},children:ot}))),K.jsxs(X.Fragment,{children:[K.jsx(kee,{ref:n,className:Hn(Ht.root,C),ownerState:Zt,...Er(xn),children:an({id:ji,disabled:Z,fullWidth:!0,size:ar==="small"?"small":void 0,InputLabelProps:Wn(),InputProps:{ref:Vt,className:Ht.inputRoot,startAdornment:Cr,onMouseDown:ei=>ht(ei),...(at||_t)&&{endAdornment:K.jsxs(Mee,{className:Ht.endAdornment,ownerState:Zt,children:[at?K.jsx(Pee,{...Ar(),"aria-label":D,title:D,ownerState:Zt,...Ki,className:Hn(Ht.clearIndicator,Ki==null?void 0:Ki.className),children:k}):null,_t?K.jsx(Aee,{...Mn(),disabled:Z,"aria-label":ko?N:gt,title:ko?N:gt,ownerState:Zt,...yi,className:Hn(Ht.popupIndicator,yi==null?void 0:yi.className),children:tn}):null]})}},inputProps:{className:Ht.input,disabled:Z,readOnly:un,...Rr()}})}),Pn?Us:null]})}),Bee={entering:{opacity:1},entered:{opacity:1}},jee=X.forwardRef(function(t,n){const s=Uh(),a={enter:s.transitions.duration.enteringScreen,exit:s.transitions.duration.leavingScreen},{addEndListener:u,appear:f=!0,children:_,easing:r,in:C,onEnter:k,onEntered:I,onEntering:P,onExit:D,onExited:N,onExiting:j,style:W,timeout:H=a,TransitionComponent:q=bc,...Z}=t,re=X.useRef(null),le=mo(re,$h(_),n),_e=se=>we=>{if(se){const Se=re.current;we===void 0?se(Se):se(Se,we)}},ye=_e(P),de=_e((se,we)=>{IE(se);const Se=ap({style:W,timeout:H,easing:r},{mode:"enter"});se.style.webkitTransition=s.transitions.create("opacity",Se),se.style.transition=s.transitions.create("opacity",Se),k&&k(se,we)}),ce=_e(I),oe=_e(j),xe=_e(se=>{const we=ap({style:W,timeout:H,easing:r},{mode:"exit"});se.style.webkitTransition=s.transitions.create("opacity",we),se.style.transition=s.transitions.create("opacity",we),D&&D(se)}),he=_e(N),Ee=se=>{u&&u(re.current,se)};return K.jsx(q,{appear:f,in:C,nodeRef:re,onEnter:de,onEntered:ce,onEntering:ye,onExit:xe,onExited:he,onExiting:oe,addEndListener:Ee,timeout:H,...Z,children:(se,we)=>X.cloneElement(_,{style:{opacity:0,visibility:se==="exited"&&!C?"hidden":void 0,...Bee[se],...W,..._.props.style},ref:le,...we})})});function Vee(e){return gi("MuiBackdrop",e)}pi("MuiBackdrop",["root","invisible"]);const $ee=e=>{const{ownerState:t,...n}=e;return n},Uee=e=>{const{classes:t,invisible:n}=e;return yr({root:["root",n&&"invisible"]},Vee,t)},Gee=Dn("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.invisible&&t.invisible]}})({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent",variants:[{props:{invisible:!0},style:{backgroundColor:"transparent"}}]}),Yj=X.forwardRef(function(t,n){const s=xi({props:t,name:"MuiBackdrop"}),{children:a,className:u,component:f="div",invisible:_=!1,open:r,components:C={},componentsProps:k={},slotProps:I={},slots:P={},TransitionComponent:D,transitionDuration:N,...j}=s,W={...s,component:f,invisible:_},H=Uee(W),q={transition:D,root:C.Root,...P},Z={...k,...I},re={slots:q,slotProps:Z},[le,_e]=pl("root",{elementType:Gee,externalForwardedProps:re,className:Hn(H.root,u),ownerState:W}),[ye,de]=pl("transition",{elementType:jee,externalForwardedProps:re,ownerState:W}),ce=$ee(de);return K.jsx(ye,{in:r,timeout:N,...j,...ce,children:K.jsx(le,{"aria-hidden":!0,..._e,classes:H,ref:n,children:a})})});function Hee(e){const{badgeContent:t,invisible:n=!1,max:s=99,showZero:a=!1}=e,u=iA({badgeContent:t,max:s});let f=n;n===!1&&t===0&&!a&&(f=!0);const{badgeContent:_,max:r=s}=f?u:e,C=_&&Number(_)>r?`${r}+`:_;return{badgeContent:_,invisible:f,max:r,displayValue:C}}function Wee(e){return gi("MuiBadge",e)}const If=pi("MuiBadge",["root","badge","dot","standard","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft","invisible","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","overlapRectangular","overlapCircular","anchorOriginTopLeftCircular","anchorOriginTopLeftRectangular","anchorOriginTopRightCircular","anchorOriginTopRightRectangular","anchorOriginBottomLeftCircular","anchorOriginBottomLeftRectangular","anchorOriginBottomRightCircular","anchorOriginBottomRightRectangular"]),xk=10,bk=4,qee=e=>{const{color:t,anchorOrigin:n,invisible:s,overlap:a,variant:u,classes:f={}}=e,_={root:["root"],badge:["badge",u,s&&"invisible",`anchorOrigin${Rn(n.vertical)}${Rn(n.horizontal)}`,`anchorOrigin${Rn(n.vertical)}${Rn(n.horizontal)}${Rn(a)}`,`overlap${Rn(a)}`,t!=="default"&&`color${Rn(t)}`]};return yr(_,Wee,f)},Xee=Dn("span",{name:"MuiBadge",slot:"Root",overridesResolver:(e,t)=>t.root})({position:"relative",display:"inline-flex",verticalAlign:"middle",flexShrink:0}),Yee=Dn("span",{name:"MuiBadge",slot:"Badge",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.badge,t[n.variant],t[`anchorOrigin${Rn(n.anchorOrigin.vertical)}${Rn(n.anchorOrigin.horizontal)}${Rn(n.overlap)}`],n.color!=="default"&&t[`color${Rn(n.color)}`],n.invisible&&t.invisible]}})($r(({theme:e})=>({display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"center",alignContent:"center",alignItems:"center",position:"absolute",boxSizing:"border-box",fontFamily:e.typography.fontFamily,fontWeight:e.typography.fontWeightMedium,fontSize:e.typography.pxToRem(12),minWidth:xk*2,lineHeight:1,padding:"0 6px",height:xk*2,borderRadius:xk,zIndex:1,transition:e.transitions.create("transform",{easing:e.transitions.easing.easeInOut,duration:e.transitions.duration.enteringScreen}),variants:[...Object.entries(e.palette).filter(Ms(["contrastText"])).map(([t])=>({props:{color:t},style:{backgroundColor:(e.vars||e).palette[t].main,color:(e.vars||e).palette[t].contrastText}})),{props:{variant:"dot"},style:{borderRadius:bk,height:bk*2,minWidth:bk*2,padding:0}},{props:({ownerState:t})=>t.anchorOrigin.vertical==="top"&&t.anchorOrigin.horizontal==="right"&&t.overlap==="rectangular",style:{top:0,right:0,transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${If.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:t})=>t.anchorOrigin.vertical==="bottom"&&t.anchorOrigin.horizontal==="right"&&t.overlap==="rectangular",style:{bottom:0,right:0,transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${If.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:t})=>t.anchorOrigin.vertical==="top"&&t.anchorOrigin.horizontal==="left"&&t.overlap==="rectangular",style:{top:0,left:0,transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${If.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:t})=>t.anchorOrigin.vertical==="bottom"&&t.anchorOrigin.horizontal==="left"&&t.overlap==="rectangular",style:{bottom:0,left:0,transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${If.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:({ownerState:t})=>t.anchorOrigin.vertical==="top"&&t.anchorOrigin.horizontal==="right"&&t.overlap==="circular",style:{top:"14%",right:"14%",transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${If.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:t})=>t.anchorOrigin.vertical==="bottom"&&t.anchorOrigin.horizontal==="right"&&t.overlap==="circular",style:{bottom:"14%",right:"14%",transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${If.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:t})=>t.anchorOrigin.vertical==="top"&&t.anchorOrigin.horizontal==="left"&&t.overlap==="circular",style:{top:"14%",left:"14%",transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${If.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:t})=>t.anchorOrigin.vertical==="bottom"&&t.anchorOrigin.horizontal==="left"&&t.overlap==="circular",style:{bottom:"14%",left:"14%",transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${If.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:{invisible:!0},style:{transition:e.transitions.create("transform",{easing:e.transitions.easing.easeInOut,duration:e.transitions.duration.leavingScreen})}}]})));function pF(e){return{vertical:(e==null?void 0:e.vertical)??"top",horizontal:(e==null?void 0:e.horizontal)??"right"}}const Zee=X.forwardRef(function(t,n){const s=xi({props:t,name:"MuiBadge"}),{anchorOrigin:a,className:u,classes:f,component:_,components:r={},componentsProps:C={},children:k,overlap:I="rectangular",color:P="default",invisible:D=!1,max:N=99,badgeContent:j,slots:W,slotProps:H,showZero:q=!1,variant:Z="standard",...re}=s,{badgeContent:le,invisible:_e,max:ye,displayValue:de}=Hee({max:N,invisible:D,badgeContent:j,showZero:q}),ce=iA({anchorOrigin:pF(a),color:P,overlap:I,variant:Z,badgeContent:j}),oe=_e||le==null&&Z!=="dot",{color:xe=P,overlap:he=I,anchorOrigin:Ee,variant:se=Z}=oe?ce:s,we=pF(Ee),Se=se!=="dot"?de:void 0,Pe={...s,badgeContent:le,invisible:oe,max:ye,displayValue:Se,showZero:q,anchorOrigin:we,color:xe,overlap:he,variant:se},Me=qee(Pe),Re=(W==null?void 0:W.root)??r.Root??Xee,Oe=(W==null?void 0:W.badge)??r.Badge??Yee,$e=(H==null?void 0:H.root)??C.root,Ke=(H==null?void 0:H.badge)??C.badge,Ct=Nx({elementType:Re,externalSlotProps:$e,externalForwardedProps:re,additionalProps:{ref:n,as:_},ownerState:Pe,className:Hn($e==null?void 0:$e.className,Me.root,u)}),Ue=Nx({elementType:Oe,externalSlotProps:Ke,ownerState:Pe,className:Hn(Me.badge,Ke==null?void 0:Ke.className)});return K.jsxs(Re,{...Ct,children:[k,K.jsx(Oe,{...Ue,children:Se})]})}),Kee=pi("MuiBox",["root"]),Jee=Lj(),Ci=qZ({themeId:r1,defaultTheme:Jee,defaultClassName:Kee.root,generateClassName:mj.generate});function Qee(e){return gi("MuiButton",e)}const Hg=pi("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","colorPrimary","colorSecondary","colorSuccess","colorError","colorInfo","colorWarning","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","icon","iconSizeSmall","iconSizeMedium","iconSizeLarge"]),ete=X.createContext({}),tte=X.createContext(void 0),nte=e=>{const{color:t,disableElevation:n,fullWidth:s,size:a,variant:u,classes:f}=e,_={root:["root",u,`${u}${Rn(t)}`,`size${Rn(a)}`,`${u}Size${Rn(a)}`,`color${Rn(t)}`,n&&"disableElevation",s&&"fullWidth"],label:["label"],startIcon:["icon","startIcon",`iconSize${Rn(a)}`],endIcon:["icon","endIcon",`iconSize${Rn(a)}`]},r=yr(_,Qee,f);return{...f,...r}},Zj=[{props:{size:"small"},style:{"& > *:nth-of-type(1)":{fontSize:18}}},{props:{size:"medium"},style:{"& > *:nth-of-type(1)":{fontSize:20}}},{props:{size:"large"},style:{"& > *:nth-of-type(1)":{fontSize:22}}}],rte=Dn(lp,{shouldForwardProp:e=>Ha(e)||e==="classes",name:"MuiButton",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.variant],t[`${n.variant}${Rn(n.color)}`],t[`size${Rn(n.size)}`],t[`${n.variant}Size${Rn(n.size)}`],n.color==="inherit"&&t.colorInherit,n.disableElevation&&t.disableElevation,n.fullWidth&&t.fullWidth]}})($r(({theme:e})=>{const t=e.palette.mode==="light"?e.palette.grey[300]:e.palette.grey[800],n=e.palette.mode==="light"?e.palette.grey.A100:e.palette.grey[700];return{...e.typography.button,minWidth:64,padding:"6px 16px",border:0,borderRadius:(e.vars||e).shape.borderRadius,transition:e.transitions.create(["background-color","box-shadow","border-color","color"],{duration:e.transitions.duration.short}),"&:hover":{textDecoration:"none"},[`&.${Hg.disabled}`]:{color:(e.vars||e).palette.action.disabled},variants:[{props:{variant:"contained"},style:{color:"var(--variant-containedColor)",backgroundColor:"var(--variant-containedBg)",boxShadow:(e.vars||e).shadows[2],"&:hover":{boxShadow:(e.vars||e).shadows[4],"@media (hover: none)":{boxShadow:(e.vars||e).shadows[2]}},"&:active":{boxShadow:(e.vars||e).shadows[8]},[`&.${Hg.focusVisible}`]:{boxShadow:(e.vars||e).shadows[6]},[`&.${Hg.disabled}`]:{color:(e.vars||e).palette.action.disabled,boxShadow:(e.vars||e).shadows[0],backgroundColor:(e.vars||e).palette.action.disabledBackground}}},{props:{variant:"outlined"},style:{padding:"5px 15px",border:"1px solid currentColor",borderColor:"var(--variant-outlinedBorder, currentColor)",backgroundColor:"var(--variant-outlinedBg)",color:"var(--variant-outlinedColor)",[`&.${Hg.disabled}`]:{border:`1px solid ${(e.vars||e).palette.action.disabledBackground}`}}},{props:{variant:"text"},style:{padding:"6px 8px",color:"var(--variant-textColor)",backgroundColor:"var(--variant-textBg)"}},...Object.entries(e.palette).filter(Ms()).map(([s])=>({props:{color:s},style:{"--variant-textColor":(e.vars||e).palette[s].main,"--variant-outlinedColor":(e.vars||e).palette[s].main,"--variant-outlinedBorder":e.vars?`rgba(${e.vars.palette[s].mainChannel} / 0.5)`:vi(e.palette[s].main,.5),"--variant-containedColor":(e.vars||e).palette[s].contrastText,"--variant-containedBg":(e.vars||e).palette[s].main,"@media (hover: hover)":{"&:hover":{"--variant-containedBg":(e.vars||e).palette[s].dark,"--variant-textBg":e.vars?`rgba(${e.vars.palette[s].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:vi(e.palette[s].main,e.palette.action.hoverOpacity),"--variant-outlinedBorder":(e.vars||e).palette[s].main,"--variant-outlinedBg":e.vars?`rgba(${e.vars.palette[s].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:vi(e.palette[s].main,e.palette.action.hoverOpacity)}}}})),{props:{color:"inherit"},style:{color:"inherit",borderColor:"currentColor","--variant-containedBg":e.vars?e.vars.palette.Button.inheritContainedBg:t,"@media (hover: hover)":{"&:hover":{"--variant-containedBg":e.vars?e.vars.palette.Button.inheritContainedHoverBg:n,"--variant-textBg":e.vars?`rgba(${e.vars.palette.text.primaryChannel} / ${e.vars.palette.action.hoverOpacity})`:vi(e.palette.text.primary,e.palette.action.hoverOpacity),"--variant-outlinedBg":e.vars?`rgba(${e.vars.palette.text.primaryChannel} / ${e.vars.palette.action.hoverOpacity})`:vi(e.palette.text.primary,e.palette.action.hoverOpacity)}}}},{props:{size:"small",variant:"text"},style:{padding:"4px 5px",fontSize:e.typography.pxToRem(13)}},{props:{size:"large",variant:"text"},style:{padding:"8px 11px",fontSize:e.typography.pxToRem(15)}},{props:{size:"small",variant:"outlined"},style:{padding:"3px 9px",fontSize:e.typography.pxToRem(13)}},{props:{size:"large",variant:"outlined"},style:{padding:"7px 21px",fontSize:e.typography.pxToRem(15)}},{props:{size:"small",variant:"contained"},style:{padding:"4px 10px",fontSize:e.typography.pxToRem(13)}},{props:{size:"large",variant:"contained"},style:{padding:"8px 22px",fontSize:e.typography.pxToRem(15)}},{props:{disableElevation:!0},style:{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${Hg.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${Hg.disabled}`]:{boxShadow:"none"}}},{props:{fullWidth:!0},style:{width:"100%"}}]}})),ite=Dn("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.startIcon,t[`iconSize${Rn(n.size)}`]]}})({display:"inherit",marginRight:8,marginLeft:-4,variants:[{props:{size:"small"},style:{marginLeft:-2}},...Zj]}),ote=Dn("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.endIcon,t[`iconSize${Rn(n.size)}`]]}})({display:"inherit",marginRight:-4,marginLeft:8,variants:[{props:{size:"small"},style:{marginRight:-2}},...Zj]}),km=X.forwardRef(function(t,n){const s=X.useContext(ete),a=X.useContext(tte),u=Qy(s,t),f=xi({props:u,name:"MuiButton"}),{children:_,color:r="primary",component:C="button",className:k,disabled:I=!1,disableElevation:P=!1,disableFocusRipple:D=!1,endIcon:N,focusVisibleClassName:j,fullWidth:W=!1,size:H="medium",startIcon:q,type:Z,variant:re="text",...le}=f,_e={...f,color:r,component:C,disabled:I,disableElevation:P,disableFocusRipple:D,fullWidth:W,size:H,type:Z,variant:re},ye=nte(_e),de=q&&K.jsx(ite,{className:ye.startIcon,ownerState:_e,children:q}),ce=N&&K.jsx(ote,{className:ye.endIcon,ownerState:_e,children:N}),oe=a||"";return K.jsxs(rte,{ownerState:_e,className:Hn(s.className,ye.root,k,oe),component:C,disabled:I,focusRipple:!D,focusVisibleClassName:Hn(ye.focusVisible,j),ref:n,type:Z,...le,classes:ye,children:[de,_,ce]})});function ste(e){return gi("PrivateSwitchBase",e)}pi("PrivateSwitchBase",["root","checked","disabled","input","edgeStart","edgeEnd"]);const ate=e=>{const{classes:t,checked:n,disabled:s,edge:a}=e,u={root:["root",n&&"checked",s&&"disabled",a&&`edge${Rn(a)}`],input:["input"]};return yr(u,ste,t)},lte=Dn(lp)({padding:9,borderRadius:"50%",variants:[{props:{edge:"start",size:"small"},style:{marginLeft:-3}},{props:({edge:e,ownerState:t})=>e==="start"&&t.size!=="small",style:{marginLeft:-12}},{props:{edge:"end",size:"small"},style:{marginRight:-3}},{props:({edge:e,ownerState:t})=>e==="end"&&t.size!=="small",style:{marginRight:-12}}]}),ute=Dn("input",{shouldForwardProp:Ha})({cursor:"inherit",position:"absolute",opacity:0,width:"100%",height:"100%",top:0,left:0,margin:0,padding:0,zIndex:1}),Kj=X.forwardRef(function(t,n){const{autoFocus:s,checked:a,checkedIcon:u,className:f,defaultChecked:_,disabled:r,disableFocusRipple:C=!1,edge:k=!1,icon:I,id:P,inputProps:D,inputRef:N,name:j,onBlur:W,onChange:H,onFocus:q,readOnly:Z,required:re=!1,tabIndex:le,type:_e,value:ye,...de}=t,[ce,oe]=Qf({controlled:a,default:!!_,name:"SwitchBase",state:"checked"}),xe=Gh(),he=Re=>{q&&q(Re),xe&&xe.onFocus&&xe.onFocus(Re)},Ee=Re=>{W&&W(Re),xe&&xe.onBlur&&xe.onBlur(Re)},se=Re=>{if(Re.nativeEvent.defaultPrevented)return;const Oe=Re.target.checked;oe(Oe),H&&H(Re,Oe)};let we=r;xe&&typeof we>"u"&&(we=xe.disabled);const Se=_e==="checkbox"||_e==="radio",Pe={...t,checked:ce,disabled:we,disableFocusRipple:C,edge:k},Me=ate(Pe);return K.jsxs(lte,{component:"span",className:Hn(Me.root,f),centerRipple:!0,focusRipple:!C,disabled:we,tabIndex:null,role:void 0,onFocus:he,onBlur:Ee,ownerState:Pe,ref:n,...de,children:[K.jsx(ute,{autoFocus:s,checked:a,defaultChecked:_,className:Me.input,disabled:we,id:Se?P:void 0,name:j,onChange:se,readOnly:Z,ref:N,required:re,ownerState:Pe,tabIndex:le,type:_e,..._e==="checkbox"&&ye===void 0?{}:{value:ye},...D}),ce?u:I]})}),cte=Jr(K.jsx("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank"),dte=Jr(K.jsx("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox"),hte=Jr(K.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}),"IndeterminateCheckBox");function fte(e){return gi("MuiCheckbox",e)}const wk=pi("MuiCheckbox",["root","checked","disabled","indeterminate","colorPrimary","colorSecondary","sizeSmall","sizeMedium"]),pte=e=>{const{classes:t,indeterminate:n,color:s,size:a}=e,u={root:["root",n&&"indeterminate",`color${Rn(s)}`,`size${Rn(a)}`]},f=yr(u,fte,t);return{...t,...f}},mte=Dn(Kj,{shouldForwardProp:e=>Ha(e)||e==="classes",name:"MuiCheckbox",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.indeterminate&&t.indeterminate,t[`size${Rn(n.size)}`],n.color!=="default"&&t[`color${Rn(n.color)}`]]}})($r(({theme:e})=>({color:(e.vars||e).palette.text.secondary,variants:[{props:{color:"default",disableRipple:!1},style:{"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.activeChannel} / ${e.vars.palette.action.hoverOpacity})`:vi(e.palette.action.active,e.palette.action.hoverOpacity)}}},...Object.entries(e.palette).filter(Ms()).map(([t])=>({props:{color:t,disableRipple:!1},style:{"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette[t].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:vi(e.palette[t].main,e.palette.action.hoverOpacity)}}})),...Object.entries(e.palette).filter(Ms()).map(([t])=>({props:{color:t},style:{[`&.${wk.checked}, &.${wk.indeterminate}`]:{color:(e.vars||e).palette[t].main},[`&.${wk.disabled}`]:{color:(e.vars||e).palette.action.disabled}}})),{props:{disableRipple:!1},style:{"&:hover":{"@media (hover: none)":{backgroundColor:"transparent"}}}}]}))),gte=K.jsx(dte,{}),yte=K.jsx(cte,{}),_te=K.jsx(hte,{}),vte=X.forwardRef(function(t,n){const s=xi({props:t,name:"MuiCheckbox"}),{checkedIcon:a=gte,color:u="primary",icon:f=yte,indeterminate:_=!1,indeterminateIcon:r=_te,inputProps:C,size:k="medium",disableRipple:I=!1,className:P,...D}=s,N=_?r:f,j=_?r:a,W={...s,disableRipple:I,color:u,indeterminate:_,size:k},H=pte(W);return K.jsx(mte,{type:"checkbox",inputProps:{"data-indeterminate":_,...C},icon:X.cloneElement(N,{fontSize:N.props.fontSize??k}),checkedIcon:X.cloneElement(j,{fontSize:j.props.fontSize??k}),ownerState:W,ref:n,className:Hn(H.root,P),disableRipple:I,...D,classes:H})});function xte(e){return gi("MuiCircularProgress",e)}pi("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);const kf=44,fP=Jd`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`,pP=Jd`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -125px;
  }
`,bte=typeof fP!="string"?yp`
        animation: ${fP} 1.4s linear infinite;
      `:null,wte=typeof pP!="string"?yp`
        animation: ${pP} 1.4s ease-in-out infinite;
      `:null,Ste=e=>{const{classes:t,variant:n,color:s,disableShrink:a}=e,u={root:["root",n,`color${Rn(s)}`],svg:["svg"],circle:["circle",`circle${Rn(n)}`,a&&"circleDisableShrink"]};return yr(u,xte,t)},Cte=Dn("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.variant],t[`color${Rn(n.color)}`]]}})($r(({theme:e})=>({display:"inline-block",variants:[{props:{variant:"determinate"},style:{transition:e.transitions.create("transform")}},{props:{variant:"indeterminate"},style:bte||{animation:`${fP} 1.4s linear infinite`}},...Object.entries(e.palette).filter(Ms()).map(([t])=>({props:{color:t},style:{color:(e.vars||e).palette[t].main}}))]}))),Ete=Dn("svg",{name:"MuiCircularProgress",slot:"Svg",overridesResolver:(e,t)=>t.svg})({display:"block"}),Tte=Dn("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.circle,t[`circle${Rn(n.variant)}`],n.disableShrink&&t.circleDisableShrink]}})($r(({theme:e})=>({stroke:"currentColor",variants:[{props:{variant:"determinate"},style:{transition:e.transitions.create("stroke-dashoffset")}},{props:{variant:"indeterminate"},style:{strokeDasharray:"80px, 200px",strokeDashoffset:0}},{props:({ownerState:t})=>t.variant==="indeterminate"&&!t.disableShrink,style:wte||{animation:`${pP} 1.4s ease-in-out infinite`}}]}))),Jj=X.forwardRef(function(t,n){const s=xi({props:t,name:"MuiCircularProgress"}),{className:a,color:u="primary",disableShrink:f=!1,size:_=40,style:r,thickness:C=3.6,value:k=0,variant:I="indeterminate",...P}=s,D={...s,color:u,disableShrink:f,size:_,thickness:C,value:k,variant:I},N=Ste(D),j={},W={},H={};if(I==="determinate"){const q=2*Math.PI*((kf-C)/2);j.strokeDasharray=q.toFixed(3),H["aria-valuenow"]=Math.round(k),j.strokeDashoffset=`${((100-k)/100*q).toFixed(3)}px`,W.transform="rotate(-90deg)"}return K.jsx(Cte,{className:Hn(N.root,a),style:{width:_,height:_,...W,...r},ownerState:D,ref:n,role:"progressbar",...H,...P,children:K.jsx(Ete,{className:N.svg,ownerState:D,viewBox:`${kf/2} ${kf/2} ${kf} ${kf}`,children:K.jsx(Tte,{className:N.circle,style:j,ownerState:D,cx:kf,cy:kf,r:(kf-C)/2,fill:"none",strokeWidth:C})})})});function mF(e){return e.substring(2).toLowerCase()}function Ite(e,t){return t.documentElement.clientWidth<e.clientX||t.documentElement.clientHeight<e.clientY}function Qj(e){const{children:t,disableReactTree:n=!1,mouseEvent:s="onClick",onClickAway:a,touchEvent:u="onTouchEnd"}=e,f=X.useRef(!1),_=X.useRef(null),r=X.useRef(!1),C=X.useRef(!1);X.useEffect(()=>(setTimeout(()=>{r.current=!0},0),()=>{r.current=!1}),[]);const k=mo($h(t),_),I=Ui(N=>{const j=C.current;C.current=!1;const W=As(_.current);if(!r.current||!_.current||"clientX"in N&&Ite(N,W))return;if(f.current){f.current=!1;return}let H;N.composedPath?H=N.composedPath().includes(_.current):H=!W.documentElement.contains(N.target)||_.current.contains(N.target),!H&&(n||!j)&&a(N)}),P=N=>j=>{C.current=!0;const W=t.props[N];W&&W(j)},D={ref:k};return u!==!1&&(D[u]=P(u)),X.useEffect(()=>{if(u!==!1){const N=mF(u),j=As(_.current),W=()=>{f.current=!0};return j.addEventListener(N,I),j.addEventListener("touchmove",W),()=>{j.removeEventListener(N,I),j.removeEventListener("touchmove",W)}}},[I,u]),s!==!1&&(D[s]=P(s)),X.useEffect(()=>{if(s!==!1){const N=mF(s),j=As(_.current);return j.addEventListener(N,I),()=>{j.removeEventListener(N,I)}}},[I,s]),K.jsx(X.Fragment,{children:X.cloneElement(t,D)})}function kte(e){const t=As(e);return t.body===e?pc(e).innerWidth>t.documentElement.clientWidth:e.scrollHeight>e.clientHeight}function lx(e,t){t?e.setAttribute("aria-hidden","true"):e.removeAttribute("aria-hidden")}function gF(e){return parseInt(pc(e).getComputedStyle(e).paddingRight,10)||0}function Mte(e){const n=["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].includes(e.tagName),s=e.tagName==="INPUT"&&e.getAttribute("type")==="hidden";return n||s}function yF(e,t,n,s,a){const u=[t,n,...s];[].forEach.call(e.children,f=>{const _=!u.includes(f),r=!Mte(f);_&&r&&lx(f,a)})}function Sk(e,t){let n=-1;return e.some((s,a)=>t(s)?(n=a,!0):!1),n}function Pte(e,t){const n=[],s=e.container;if(!t.disableScrollLock){if(kte(s)){const f=Cj(pc(s));n.push({value:s.style.paddingRight,property:"padding-right",el:s}),s.style.paddingRight=`${gF(s)+f}px`;const _=As(s).querySelectorAll(".mui-fixed");[].forEach.call(_,r=>{n.push({value:r.style.paddingRight,property:"padding-right",el:r}),r.style.paddingRight=`${gF(r)+f}px`})}let u;if(s.parentNode instanceof DocumentFragment)u=As(s).body;else{const f=s.parentElement,_=pc(s);u=(f==null?void 0:f.nodeName)==="HTML"&&_.getComputedStyle(f).overflowY==="scroll"?f:s}n.push({value:u.style.overflow,property:"overflow",el:u},{value:u.style.overflowX,property:"overflow-x",el:u},{value:u.style.overflowY,property:"overflow-y",el:u}),u.style.overflow="hidden"}return()=>{n.forEach(({value:u,el:f,property:_})=>{u?f.style.setProperty(_,u):f.style.removeProperty(_)})}}function Ate(e){const t=[];return[].forEach.call(e.children,n=>{n.getAttribute("aria-hidden")==="true"&&t.push(n)}),t}class Lte{constructor(){this.modals=[],this.containers=[]}add(t,n){let s=this.modals.indexOf(t);if(s!==-1)return s;s=this.modals.length,this.modals.push(t),t.modalRef&&lx(t.modalRef,!1);const a=Ate(n);yF(n,t.mount,t.modalRef,a,!0);const u=Sk(this.containers,f=>f.container===n);return u!==-1?(this.containers[u].modals.push(t),s):(this.containers.push({modals:[t],container:n,restore:null,hiddenSiblings:a}),s)}mount(t,n){const s=Sk(this.containers,u=>u.modals.includes(t)),a=this.containers[s];a.restore||(a.restore=Pte(a,n))}remove(t,n=!0){const s=this.modals.indexOf(t);if(s===-1)return s;const a=Sk(this.containers,f=>f.modals.includes(t)),u=this.containers[a];if(u.modals.splice(u.modals.indexOf(t),1),this.modals.splice(s,1),u.modals.length===0)u.restore&&u.restore(),t.modalRef&&lx(t.modalRef,n),yF(u.container,t.mount,t.modalRef,u.hiddenSiblings,!1),this.containers.splice(a,1);else{const f=u.modals[u.modals.length-1];f.modalRef&&lx(f.modalRef,!1)}return s}isTopModal(t){return this.modals.length>0&&this.modals[this.modals.length-1]===t}}const Rte=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function Ote(e){const t=parseInt(e.getAttribute("tabindex")||"",10);return Number.isNaN(t)?e.contentEditable==="true"||(e.nodeName==="AUDIO"||e.nodeName==="VIDEO"||e.nodeName==="DETAILS")&&e.getAttribute("tabindex")===null?0:e.tabIndex:t}function Dte(e){if(e.tagName!=="INPUT"||e.type!=="radio"||!e.name)return!1;const t=s=>e.ownerDocument.querySelector(`input[type="radio"]${s}`);let n=t(`[name="${e.name}"]:checked`);return n||(n=t(`[name="${e.name}"]`)),n!==e}function zte(e){return!(e.disabled||e.tagName==="INPUT"&&e.type==="hidden"||Dte(e))}function Fte(e){const t=[],n=[];return Array.from(e.querySelectorAll(Rte)).forEach((s,a)=>{const u=Ote(s);u===-1||!zte(s)||(u===0?t.push(s):n.push({documentOrder:a,tabIndex:u,node:s}))}),n.sort((s,a)=>s.tabIndex===a.tabIndex?s.documentOrder-a.documentOrder:s.tabIndex-a.tabIndex).map(s=>s.node).concat(t)}function Nte(){return!0}function e8(e){const{children:t,disableAutoFocus:n=!1,disableEnforceFocus:s=!1,disableRestoreFocus:a=!1,getTabbable:u=Fte,isEnabled:f=Nte,open:_}=e,r=X.useRef(!1),C=X.useRef(null),k=X.useRef(null),I=X.useRef(null),P=X.useRef(null),D=X.useRef(!1),N=X.useRef(null),j=mo($h(t),N),W=X.useRef(null);X.useEffect(()=>{!_||!N.current||(D.current=!n)},[n,_]),X.useEffect(()=>{if(!_||!N.current)return;const Z=As(N.current);return N.current.contains(Z.activeElement)||(N.current.hasAttribute("tabIndex")||N.current.setAttribute("tabIndex","-1"),D.current&&N.current.focus()),()=>{a||(I.current&&I.current.focus&&(r.current=!0,I.current.focus()),I.current=null)}},[_]),X.useEffect(()=>{if(!_||!N.current)return;const Z=As(N.current),re=ye=>{W.current=ye,!(s||!f()||ye.key!=="Tab")&&Z.activeElement===N.current&&ye.shiftKey&&(r.current=!0,k.current&&k.current.focus())},le=()=>{var ce,oe;const ye=N.current;if(ye===null)return;if(!Z.hasFocus()||!f()||r.current){r.current=!1;return}if(ye.contains(Z.activeElement)||s&&Z.activeElement!==C.current&&Z.activeElement!==k.current)return;if(Z.activeElement!==P.current)P.current=null;else if(P.current!==null)return;if(!D.current)return;let de=[];if((Z.activeElement===C.current||Z.activeElement===k.current)&&(de=u(N.current)),de.length>0){const xe=!!((ce=W.current)!=null&&ce.shiftKey&&((oe=W.current)==null?void 0:oe.key)==="Tab"),he=de[0],Ee=de[de.length-1];typeof he!="string"&&typeof Ee!="string"&&(xe?Ee.focus():he.focus())}else ye.focus()};Z.addEventListener("focusin",le),Z.addEventListener("keydown",re,!0);const _e=setInterval(()=>{Z.activeElement&&Z.activeElement.tagName==="BODY"&&le()},50);return()=>{clearInterval(_e),Z.removeEventListener("focusin",le),Z.removeEventListener("keydown",re,!0)}},[n,s,a,f,_,u]);const H=Z=>{I.current===null&&(I.current=Z.relatedTarget),D.current=!0,P.current=Z.target;const re=t.props.onFocus;re&&re(Z)},q=Z=>{I.current===null&&(I.current=Z.relatedTarget),D.current=!0};return K.jsxs(X.Fragment,{children:[K.jsx("div",{tabIndex:_?0:-1,onFocus:q,ref:C,"data-testid":"sentinelStart"}),X.cloneElement(t,{ref:j,onFocus:H}),K.jsx("div",{tabIndex:_?0:-1,onFocus:q,ref:k,"data-testid":"sentinelEnd"})]})}function Bte(e){return typeof e=="function"?e():e}function jte(e){return e?e.props.hasOwnProperty("in"):!1}const Pw=new Lte;function Vte(e){const{container:t,disableEscapeKeyDown:n=!1,disableScrollLock:s=!1,closeAfterTransition:a=!1,onTransitionEnter:u,onTransitionExited:f,children:_,onClose:r,open:C,rootRef:k}=e,I=X.useRef({}),P=X.useRef(null),D=X.useRef(null),N=mo(D,k),[j,W]=X.useState(!C),H=jte(_);let q=!0;(e["aria-hidden"]==="false"||e["aria-hidden"]===!1)&&(q=!1);const Z=()=>As(P.current),re=()=>(I.current.modalRef=D.current,I.current.mount=P.current,I.current),le=()=>{Pw.mount(re(),{disableScrollLock:s}),D.current&&(D.current.scrollTop=0)},_e=Ui(()=>{const we=Bte(t)||Z().body;Pw.add(re(),we),D.current&&le()}),ye=()=>Pw.isTopModal(re()),de=Ui(we=>{P.current=we,we&&(C&&ye()?le():D.current&&lx(D.current,q))}),ce=X.useCallback(()=>{Pw.remove(re(),q)},[q]);X.useEffect(()=>()=>{ce()},[ce]),X.useEffect(()=>{C?_e():(!H||!a)&&ce()},[C,ce,H,a,_e]);const oe=we=>Se=>{var Pe;(Pe=we.onKeyDown)==null||Pe.call(we,Se),!(Se.key!=="Escape"||Se.which===229||!ye())&&(n||(Se.stopPropagation(),r&&r(Se,"escapeKeyDown")))},xe=we=>Se=>{var Pe;(Pe=we.onClick)==null||Pe.call(we,Se),Se.target===Se.currentTarget&&r&&r(Se,"backdropClick")};return{getRootProps:(we={})=>{const Se=Ej(e);delete Se.onTransitionEnter,delete Se.onTransitionExited;const Pe={...Se,...we};return{role:"presentation",...Pe,onKeyDown:oe(Pe),ref:N}},getBackdropProps:(we={})=>{const Se=we;return{"aria-hidden":!0,...Se,onClick:xe(Se),open:C}},getTransitionProps:()=>{const we=()=>{W(!1),u&&u()},Se=()=>{W(!0),f&&f(),a&&ce()};return{onEnter:Dz(we,_==null?void 0:_.props.onEnter),onExited:Dz(Se,_==null?void 0:_.props.onExited)}},rootRef:N,portalRef:de,isTopModal:ye,exited:j,hasTransition:H}}function $te(e){return gi("MuiModal",e)}pi("MuiModal",["root","hidden","backdrop"]);const Ute=e=>{const{open:t,exited:n,classes:s}=e;return yr({root:["root",!t&&n&&"hidden"],backdrop:["backdrop"]},$te,s)},Gte=Dn("div",{name:"MuiModal",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,!n.open&&n.exited&&t.hidden]}})($r(({theme:e})=>({position:"fixed",zIndex:(e.vars||e).zIndex.modal,right:0,bottom:0,top:0,left:0,variants:[{props:({ownerState:t})=>!t.open&&t.exited,style:{visibility:"hidden"}}]}))),Hte=Dn(Yj,{name:"MuiModal",slot:"Backdrop",overridesResolver:(e,t)=>t.backdrop})({zIndex:-1}),mA=X.forwardRef(function(t,n){const s=xi({name:"MuiModal",props:t}),{BackdropComponent:a=Hte,BackdropProps:u,classes:f,className:_,closeAfterTransition:r=!1,children:C,container:k,component:I,components:P={},componentsProps:D={},disableAutoFocus:N=!1,disableEnforceFocus:j=!1,disableEscapeKeyDown:W=!1,disablePortal:H=!1,disableRestoreFocus:q=!1,disableScrollLock:Z=!1,hideBackdrop:re=!1,keepMounted:le=!1,onBackdropClick:_e,onClose:ye,onTransitionEnter:de,onTransitionExited:ce,open:oe,slotProps:xe={},slots:he={},theme:Ee,...se}=s,we={...s,closeAfterTransition:r,disableAutoFocus:N,disableEnforceFocus:j,disableEscapeKeyDown:W,disablePortal:H,disableRestoreFocus:q,disableScrollLock:Z,hideBackdrop:re,keepMounted:le},{getRootProps:Se,getBackdropProps:Pe,getTransitionProps:Me,portalRef:Re,isTopModal:Oe,exited:$e,hasTransition:Ke}=Vte({...we,rootRef:n}),Ct={...we,exited:$e},Ue=Ute(Ct),ft={};if(C.props.tabIndex===void 0&&(ft.tabIndex="-1"),Ke){const{onEnter:We,onExited:Sn}=Me();ft.onEnter=We,ft.onExited=Sn}const Bt={...se,slots:{root:P.Root,backdrop:P.Backdrop,...he},slotProps:{...D,...xe}},[hn,ot]=pl("root",{elementType:Gte,externalForwardedProps:Bt,getSlotProps:Se,additionalProps:{ref:n,as:I},ownerState:Ct,className:Hn(_,Ue==null?void 0:Ue.root,!Ct.open&&Ct.exited&&(Ue==null?void 0:Ue.hidden))}),[en,wt]=pl("backdrop",{elementType:a,externalForwardedProps:Bt,additionalProps:u,getSlotProps:We=>Pe({...We,onClick:Sn=>{_e&&_e(Sn),We!=null&&We.onClick&&We.onClick(Sn)}}),className:Hn(u==null?void 0:u.className,Ue==null?void 0:Ue.backdrop),ownerState:Ct}),Ne=mo(u==null?void 0:u.ref,wt.ref);return!le&&!oe&&(!Ke||$e)?null:K.jsx(Wj,{ref:Re,container:k,disablePortal:H,children:K.jsxs(hn,{...ot,children:[!re&&a?K.jsx(en,{...wt,ref:Ne}):null,K.jsx(e8,{disableEnforceFocus:j,disableAutoFocus:N,disableRestoreFocus:q,isEnabled:Oe,open:oe,children:X.cloneElement(C,ft)})]})})});function Wte(e){return gi("MuiDivider",e)}const _F=pi("MuiDivider",["root","absolute","fullWidth","inset","middle","flexItem","light","vertical","withChildren","withChildrenVertical","textAlignRight","textAlignLeft","wrapper","wrapperVertical"]),qte=e=>{const{absolute:t,children:n,classes:s,flexItem:a,light:u,orientation:f,textAlign:_,variant:r}=e;return yr({root:["root",t&&"absolute",r,u&&"light",f==="vertical"&&"vertical",a&&"flexItem",n&&"withChildren",n&&f==="vertical"&&"withChildrenVertical",_==="right"&&f!=="vertical"&&"textAlignRight",_==="left"&&f!=="vertical"&&"textAlignLeft"],wrapper:["wrapper",f==="vertical"&&"wrapperVertical"]},Wte,s)},Xte=Dn("div",{name:"MuiDivider",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.absolute&&t.absolute,t[n.variant],n.light&&t.light,n.orientation==="vertical"&&t.vertical,n.flexItem&&t.flexItem,n.children&&t.withChildren,n.children&&n.orientation==="vertical"&&t.withChildrenVertical,n.textAlign==="right"&&n.orientation!=="vertical"&&t.textAlignRight,n.textAlign==="left"&&n.orientation!=="vertical"&&t.textAlignLeft]}})($r(({theme:e})=>({margin:0,flexShrink:0,borderWidth:0,borderStyle:"solid",borderColor:(e.vars||e).palette.divider,borderBottomWidth:"thin",variants:[{props:{absolute:!0},style:{position:"absolute",bottom:0,left:0,width:"100%"}},{props:{light:!0},style:{borderColor:e.vars?`rgba(${e.vars.palette.dividerChannel} / 0.08)`:vi(e.palette.divider,.08)}},{props:{variant:"inset"},style:{marginLeft:72}},{props:{variant:"middle",orientation:"horizontal"},style:{marginLeft:e.spacing(2),marginRight:e.spacing(2)}},{props:{variant:"middle",orientation:"vertical"},style:{marginTop:e.spacing(1),marginBottom:e.spacing(1)}},{props:{orientation:"vertical"},style:{height:"100%",borderBottomWidth:0,borderRightWidth:"thin"}},{props:{flexItem:!0},style:{alignSelf:"stretch",height:"auto"}},{props:({ownerState:t})=>!!t.children,style:{display:"flex",whiteSpace:"nowrap",textAlign:"center",border:0,borderTopStyle:"solid",borderLeftStyle:"solid","&::before, &::after":{content:'""',alignSelf:"center"}}},{props:({ownerState:t})=>t.children&&t.orientation!=="vertical",style:{"&::before, &::after":{width:"100%",borderTop:`thin solid ${(e.vars||e).palette.divider}`,borderTopStyle:"inherit"}}},{props:({ownerState:t})=>t.orientation==="vertical"&&t.children,style:{flexDirection:"column","&::before, &::after":{height:"100%",borderLeft:`thin solid ${(e.vars||e).palette.divider}`,borderLeftStyle:"inherit"}}},{props:({ownerState:t})=>t.textAlign==="right"&&t.orientation!=="vertical",style:{"&::before":{width:"90%"},"&::after":{width:"10%"}}},{props:({ownerState:t})=>t.textAlign==="left"&&t.orientation!=="vertical",style:{"&::before":{width:"10%"},"&::after":{width:"90%"}}}]}))),Yte=Dn("span",{name:"MuiDivider",slot:"Wrapper",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.wrapper,n.orientation==="vertical"&&t.wrapperVertical]}})($r(({theme:e})=>({display:"inline-block",paddingLeft:`calc(${e.spacing(1)} * 1.2)`,paddingRight:`calc(${e.spacing(1)} * 1.2)`,variants:[{props:{orientation:"vertical"},style:{paddingTop:`calc(${e.spacing(1)} * 1.2)`,paddingBottom:`calc(${e.spacing(1)} * 1.2)`}}]}))),hm=X.forwardRef(function(t,n){const s=xi({props:t,name:"MuiDivider"}),{absolute:a=!1,children:u,className:f,orientation:_="horizontal",component:r=u||_==="vertical"?"div":"hr",flexItem:C=!1,light:k=!1,role:I=r!=="hr"?"separator":void 0,textAlign:P="center",variant:D="fullWidth",...N}=s,j={...s,absolute:a,component:r,flexItem:C,light:k,orientation:_,role:I,textAlign:P,variant:D},W=qte(j);return K.jsx(Xte,{as:r,className:Hn(W.root,f),role:I,ref:n,ownerState:j,"aria-orientation":I==="separator"&&(r!=="hr"||_==="vertical")?_:void 0,...N,children:u?K.jsx(Yte,{className:W.wrapper,ownerState:j,children:u}):null})});hm&&(hm.muiSkipListHighlight=!0);function Zte(e,t,n){const s=t.getBoundingClientRect(),a=n&&n.getBoundingClientRect(),u=pc(t);let f;if(t.fakeTransform)f=t.fakeTransform;else{const C=u.getComputedStyle(t);f=C.getPropertyValue("-webkit-transform")||C.getPropertyValue("transform")}let _=0,r=0;if(f&&f!=="none"&&typeof f=="string"){const C=f.split("(")[1].split(")")[0].split(",");_=parseInt(C[4],10),r=parseInt(C[5],10)}return e==="left"?a?`translateX(${a.right+_-s.left}px)`:`translateX(${u.innerWidth+_-s.left}px)`:e==="right"?a?`translateX(-${s.right-a.left-_}px)`:`translateX(-${s.left+s.width-_}px)`:e==="up"?a?`translateY(${a.bottom+r-s.top}px)`:`translateY(${u.innerHeight+r-s.top}px)`:a?`translateY(-${s.top-a.top+s.height-r}px)`:`translateY(-${s.top+s.height-r}px)`}function Kte(e){return typeof e=="function"?e():e}function Aw(e,t,n){const s=Kte(n),a=Zte(e,t,s);a&&(t.style.webkitTransform=a,t.style.transform=a)}const Jte=X.forwardRef(function(t,n){const s=Uh(),a={enter:s.transitions.easing.easeOut,exit:s.transitions.easing.sharp},u={enter:s.transitions.duration.enteringScreen,exit:s.transitions.duration.leavingScreen},{addEndListener:f,appear:_=!0,children:r,container:C,direction:k="down",easing:I=a,in:P,onEnter:D,onEntered:N,onEntering:j,onExit:W,onExited:H,onExiting:q,style:Z,timeout:re=u,TransitionComponent:le=bc,..._e}=t,ye=X.useRef(null),de=mo($h(r),ye,n),ce=Me=>Re=>{Me&&(Re===void 0?Me(ye.current):Me(ye.current,Re))},oe=ce((Me,Re)=>{Aw(k,Me,C),IE(Me),D&&D(Me,Re)}),xe=ce((Me,Re)=>{const Oe=ap({timeout:re,style:Z,easing:I},{mode:"enter"});Me.style.webkitTransition=s.transitions.create("-webkit-transform",{...Oe}),Me.style.transition=s.transitions.create("transform",{...Oe}),Me.style.webkitTransform="none",Me.style.transform="none",j&&j(Me,Re)}),he=ce(N),Ee=ce(q),se=ce(Me=>{const Re=ap({timeout:re,style:Z,easing:I},{mode:"exit"});Me.style.webkitTransition=s.transitions.create("-webkit-transform",Re),Me.style.transition=s.transitions.create("transform",Re),Aw(k,Me,C),W&&W(Me)}),we=ce(Me=>{Me.style.webkitTransition="",Me.style.transition="",H&&H(Me)}),Se=Me=>{f&&f(ye.current,Me)},Pe=X.useCallback(()=>{ye.current&&Aw(k,ye.current,C)},[k,C]);return X.useEffect(()=>{if(P||k==="down"||k==="right")return;const Me=rA(()=>{ye.current&&Aw(k,ye.current,C)}),Re=pc(ye.current);return Re.addEventListener("resize",Me),()=>{Me.clear(),Re.removeEventListener("resize",Me)}},[k,P,C]),X.useEffect(()=>{P||Pe()},[P,Pe]),K.jsx(le,{nodeRef:ye,onEnter:oe,onEntered:he,onEntering:xe,onExit:se,onExited:we,onExiting:Ee,addEndListener:Se,appear:_,in:P,timeout:re,..._e,children:(Me,Re)=>X.cloneElement(r,{ref:de,style:{visibility:Me==="exited"&&!P?"hidden":void 0,...Z,...r.props.style},...Re})})});function Qte(e){return gi("MuiDrawer",e)}pi("MuiDrawer",["root","docked","paper","paperAnchorLeft","paperAnchorRight","paperAnchorTop","paperAnchorBottom","paperAnchorDockedLeft","paperAnchorDockedRight","paperAnchorDockedTop","paperAnchorDockedBottom","modal"]);const t8=(e,t)=>{const{ownerState:n}=e;return[t.root,(n.variant==="permanent"||n.variant==="persistent")&&t.docked,t.modal]},ene=e=>{const{classes:t,anchor:n,variant:s}=e,a={root:["root"],docked:[(s==="permanent"||s==="persistent")&&"docked"],modal:["modal"],paper:["paper",`paperAnchor${Rn(n)}`,s!=="temporary"&&`paperAnchorDocked${Rn(n)}`]};return yr(a,Qte,t)},tne=Dn(mA,{name:"MuiDrawer",slot:"Root",overridesResolver:t8})($r(({theme:e})=>({zIndex:(e.vars||e).zIndex.drawer}))),vF=Dn("div",{shouldForwardProp:Ha,name:"MuiDrawer",slot:"Docked",skipVariantsResolver:!1,overridesResolver:t8})({flex:"0 0 auto"}),nne=Dn(b0,{name:"MuiDrawer",slot:"Paper",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.paper,t[`paperAnchor${Rn(n.anchor)}`],n.variant!=="temporary"&&t[`paperAnchorDocked${Rn(n.anchor)}`]]}})($r(({theme:e})=>({overflowY:"auto",display:"flex",flexDirection:"column",height:"100%",flex:"1 0 auto",zIndex:(e.vars||e).zIndex.drawer,WebkitOverflowScrolling:"touch",position:"fixed",top:0,outline:0,variants:[{props:{anchor:"left"},style:{left:0}},{props:{anchor:"top"},style:{top:0,left:0,right:0,height:"auto",maxHeight:"100%"}},{props:{anchor:"right"},style:{right:0}},{props:{anchor:"bottom"},style:{top:"auto",left:0,bottom:0,right:0,height:"auto",maxHeight:"100%"}},{props:({ownerState:t})=>t.anchor==="left"&&t.variant!=="temporary",style:{borderRight:`1px solid ${(e.vars||e).palette.divider}`}},{props:({ownerState:t})=>t.anchor==="top"&&t.variant!=="temporary",style:{borderBottom:`1px solid ${(e.vars||e).palette.divider}`}},{props:({ownerState:t})=>t.anchor==="right"&&t.variant!=="temporary",style:{borderLeft:`1px solid ${(e.vars||e).palette.divider}`}},{props:({ownerState:t})=>t.anchor==="bottom"&&t.variant!=="temporary",style:{borderTop:`1px solid ${(e.vars||e).palette.divider}`}}]}))),n8={left:"right",right:"left",top:"down",bottom:"up"};function rne(e){return["left","right"].includes(e)}function ine({direction:e},t){return e==="rtl"&&rne(t)?n8[t]:t}const one=X.forwardRef(function(t,n){const s=xi({props:t,name:"MuiDrawer"}),a=Uh(),u=au(),f={enter:a.transitions.duration.enteringScreen,exit:a.transitions.duration.leavingScreen},{anchor:_="left",BackdropProps:r,children:C,className:k,elevation:I=16,hideBackdrop:P=!1,ModalProps:{BackdropProps:D,...N}={},onClose:j,open:W=!1,PaperProps:H={},SlideProps:q,TransitionComponent:Z=Jte,transitionDuration:re=f,variant:le="temporary",..._e}=s,ye=X.useRef(!1);X.useEffect(()=>{ye.current=!0},[]);const de=ine({direction:u?"rtl":"ltr"},_),oe={...s,anchor:_,elevation:I,open:W,variant:le,..._e},xe=ene(oe),he=K.jsx(nne,{elevation:le==="temporary"?I:0,square:!0,...H,className:Hn(xe.paper,H.className),ownerState:oe,children:C});if(le==="permanent")return K.jsx(vF,{className:Hn(xe.root,xe.docked,k),ownerState:oe,ref:n,..._e,children:he});const Ee=K.jsx(Z,{in:W,direction:n8[de],timeout:re,appear:ye.current,...q,children:he});return le==="persistent"?K.jsx(vF,{className:Hn(xe.root,xe.docked,k),ownerState:oe,ref:n,..._e,children:Ee}):K.jsx(tne,{BackdropProps:{...r,...D,transitionDuration:re},className:Hn(xe.root,xe.modal,k),open:W,ownerState:oe,onClose:j,hideBackdrop:P,ref:n,..._e,...N,children:Ee})});function sne(e){return gi("MuiFab",e)}const xF=pi("MuiFab",["root","primary","secondary","extended","circular","focusVisible","disabled","colorInherit","sizeSmall","sizeMedium","sizeLarge","info","error","warning","success"]),ane=e=>{const{color:t,variant:n,classes:s,size:a}=e,u={root:["root",n,`size${Rn(a)}`,t==="inherit"?"colorInherit":t]},f=yr(u,sne,s);return{...s,...f}},lne=Dn(lp,{name:"MuiFab",slot:"Root",shouldForwardProp:e=>Ha(e)||e==="classes",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.variant],t[`size${Rn(n.size)}`],n.color==="inherit"&&t.colorInherit,t[Rn(n.size)],t[n.color]]}})($r(({theme:e})=>{var t,n;return{...e.typography.button,minHeight:36,transition:e.transitions.create(["background-color","box-shadow","border-color"],{duration:e.transitions.duration.short}),borderRadius:"50%",padding:0,minWidth:0,width:56,height:56,zIndex:(e.vars||e).zIndex.fab,boxShadow:(e.vars||e).shadows[6],"&:active":{boxShadow:(e.vars||e).shadows[12]},color:e.vars?e.vars.palette.text.primary:(n=(t=e.palette).getContrastText)==null?void 0:n.call(t,e.palette.grey[300]),backgroundColor:(e.vars||e).palette.grey[300],"&:hover":{backgroundColor:(e.vars||e).palette.grey.A100,"@media (hover: none)":{backgroundColor:(e.vars||e).palette.grey[300]},textDecoration:"none"},[`&.${xF.focusVisible}`]:{boxShadow:(e.vars||e).shadows[6]},variants:[{props:{size:"small"},style:{width:40,height:40}},{props:{size:"medium"},style:{width:48,height:48}},{props:{variant:"extended"},style:{borderRadius:48/2,padding:"0 16px",width:"auto",minHeight:"auto",minWidth:48,height:48}},{props:{variant:"extended",size:"small"},style:{width:"auto",padding:"0 8px",borderRadius:34/2,minWidth:34,height:34}},{props:{variant:"extended",size:"medium"},style:{width:"auto",padding:"0 16px",borderRadius:40/2,minWidth:40,height:40}},{props:{color:"inherit"},style:{color:"inherit"}}]}}),$r(({theme:e})=>({variants:[...Object.entries(e.palette).filter(Ms(["dark","contrastText"])).map(([t])=>({props:{color:t},style:{color:(e.vars||e).palette[t].contrastText,backgroundColor:(e.vars||e).palette[t].main,"&:hover":{backgroundColor:(e.vars||e).palette[t].dark,"@media (hover: none)":{backgroundColor:(e.vars||e).palette[t].main}}}}))]})),$r(({theme:e})=>({[`&.${xF.disabled}`]:{color:(e.vars||e).palette.action.disabled,boxShadow:(e.vars||e).shadows[0],backgroundColor:(e.vars||e).palette.action.disabledBackground}}))),r8=X.forwardRef(function(t,n){const s=xi({props:t,name:"MuiFab"}),{children:a,className:u,color:f="default",component:_="button",disabled:r=!1,disableFocusRipple:C=!1,focusVisibleClassName:k,size:I="large",variant:P="circular",...D}=s,N={...s,color:f,component:_,disabled:r,disableFocusRipple:C,size:I,variant:P},j=ane(N);return K.jsx(lne,{className:Hn(j.root,u),component:_,disabled:r,focusRipple:!C,focusVisibleClassName:Hn(j.focusVisible,k),ownerState:N,ref:n,...D,classes:j,children:a})}),une=e=>{const{classes:t,disableUnderline:n,startAdornment:s,endAdornment:a,size:u,hiddenLabel:f,multiline:_}=e,r={root:["root",!n&&"underline",s&&"adornedStart",a&&"adornedEnd",u==="small"&&`size${Rn(u)}`,f&&"hiddenLabel",_&&"multiline"],input:["input"]},C=yr(r,Eee,t);return{...t,...C}},cne=Dn(RE,{shouldForwardProp:e=>Ha(e)||e==="classes",name:"MuiFilledInput",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[...AE(e,t),!n.disableUnderline&&t.underline]}})($r(({theme:e})=>{const t=e.palette.mode==="light",n=t?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)",s=t?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)",a=t?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.13)",u=t?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)";return{position:"relative",backgroundColor:e.vars?e.vars.palette.FilledInput.bg:s,borderTopLeftRadius:(e.vars||e).shape.borderRadius,borderTopRightRadius:(e.vars||e).shape.borderRadius,transition:e.transitions.create("background-color",{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut}),"&:hover":{backgroundColor:e.vars?e.vars.palette.FilledInput.hoverBg:a,"@media (hover: none)":{backgroundColor:e.vars?e.vars.palette.FilledInput.bg:s}},[`&.${bu.focused}`]:{backgroundColor:e.vars?e.vars.palette.FilledInput.bg:s},[`&.${bu.disabled}`]:{backgroundColor:e.vars?e.vars.palette.FilledInput.disabledBg:u},variants:[{props:({ownerState:f})=>!f.disableUnderline,style:{"&::after":{left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:e.transitions.create("transform",{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${bu.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${bu.error}`]:{"&::before, &::after":{borderBottomColor:(e.vars||e).palette.error.main}},"&::before":{borderBottom:`1px solid ${e.vars?`rgba(${e.vars.palette.common.onBackgroundChannel} / ${e.vars.opacity.inputUnderline})`:n}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:e.transitions.create("border-bottom-color",{duration:e.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${bu.disabled}, .${bu.error}):before`]:{borderBottom:`1px solid ${(e.vars||e).palette.text.primary}`},[`&.${bu.disabled}:before`]:{borderBottomStyle:"dotted"}}},...Object.entries(e.palette).filter(Ms()).map(([f])=>{var _;return{props:{disableUnderline:!1,color:f},style:{"&::after":{borderBottom:`2px solid ${(_=(e.vars||e).palette[f])==null?void 0:_.main}`}}}}),{props:({ownerState:f})=>f.startAdornment,style:{paddingLeft:12}},{props:({ownerState:f})=>f.endAdornment,style:{paddingRight:12}},{props:({ownerState:f})=>f.multiline,style:{padding:"25px 12px 8px"}},{props:({ownerState:f,size:_})=>f.multiline&&_==="small",style:{paddingTop:21,paddingBottom:4}},{props:({ownerState:f})=>f.multiline&&f.hiddenLabel,style:{paddingTop:16,paddingBottom:17}},{props:({ownerState:f})=>f.multiline&&f.hiddenLabel&&f.size==="small",style:{paddingTop:8,paddingBottom:9}}]}})),dne=Dn(OE,{name:"MuiFilledInput",slot:"Input",overridesResolver:LE})($r(({theme:e})=>({paddingTop:25,paddingRight:12,paddingBottom:8,paddingLeft:12,...!e.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:e.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:e.palette.mode==="light"?null:"#fff",caretColor:e.palette.mode==="light"?null:"#fff",borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"}},...e.vars&&{"&:-webkit-autofill":{borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"},[e.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},variants:[{props:{size:"small"},style:{paddingTop:21,paddingBottom:4}},{props:({ownerState:t})=>t.hiddenLabel,style:{paddingTop:16,paddingBottom:17}},{props:({ownerState:t})=>t.startAdornment,style:{paddingLeft:0}},{props:({ownerState:t})=>t.endAdornment,style:{paddingRight:0}},{props:({ownerState:t})=>t.hiddenLabel&&t.size==="small",style:{paddingTop:8,paddingBottom:9}},{props:({ownerState:t})=>t.multiline,style:{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0}}]}))),dC=X.forwardRef(function(t,n){const s=xi({props:t,name:"MuiFilledInput"}),{disableUnderline:a=!1,components:u={},componentsProps:f,fullWidth:_=!1,hiddenLabel:r,inputComponent:C="input",multiline:k=!1,slotProps:I,slots:P={},type:D="text",...N}=s,j={...s,disableUnderline:a,fullWidth:_,inputComponent:C,multiline:k,type:D},W=une(s),H={root:{ownerState:j},input:{ownerState:j}},q=I??f?ml(H,I??f):H,Z=P.root??u.Root??cne,re=P.input??u.Input??dne;return K.jsx(w0,{slots:{root:Z,input:re},componentsProps:q,fullWidth:_,inputComponent:C,multiline:k,ref:n,type:D,...N,classes:W})});dC&&(dC.muiName="Input");function hne(e){return gi("MuiFormControl",e)}pi("MuiFormControl",["root","marginNone","marginNormal","marginDense","fullWidth","disabled"]);const fne=e=>{const{classes:t,margin:n,fullWidth:s}=e,a={root:["root",n!=="none"&&`margin${Rn(n)}`,s&&"fullWidth"]};return yr(a,hne,t)},pne=Dn("div",{name:"MuiFormControl",slot:"Root",overridesResolver:({ownerState:e},t)=>({...t.root,...t[`margin${Rn(e.margin)}`],...e.fullWidth&&t.fullWidth})})({display:"inline-flex",flexDirection:"column",position:"relative",minWidth:0,padding:0,margin:0,border:0,verticalAlign:"top",variants:[{props:{margin:"normal"},style:{marginTop:16,marginBottom:8}},{props:{margin:"dense"},style:{marginTop:8,marginBottom:4}},{props:{fullWidth:!0},style:{width:"100%"}}]}),up=X.forwardRef(function(t,n){const s=xi({props:t,name:"MuiFormControl"}),{children:a,className:u,color:f="primary",component:_="div",disabled:r=!1,error:C=!1,focused:k,fullWidth:I=!1,hiddenLabel:P=!1,margin:D="none",required:N=!1,size:j="medium",variant:W="outlined",...H}=s,q={...s,color:f,component:_,disabled:r,error:C,fullWidth:I,hiddenLabel:P,margin:D,required:N,size:j,variant:W},Z=fne(q),[re,le]=X.useState(()=>{let Ee=!1;return a&&X.Children.forEach(a,se=>{if(!pS(se,["Input","Select"]))return;const we=pS(se,["Select"])?se.props.input:se;we&&xee(we.props)&&(Ee=!0)}),Ee}),[_e,ye]=X.useState(()=>{let Ee=!1;return a&&X.Children.forEach(a,se=>{pS(se,["Input","Select"])&&(cC(se.props,!0)||cC(se.props.inputProps,!0))&&(Ee=!0)}),Ee}),[de,ce]=X.useState(!1);r&&de&&ce(!1);const oe=k!==void 0&&!r?k:de;let xe;X.useRef(!1);const he=X.useMemo(()=>({adornedStart:re,setAdornedStart:le,color:f,disabled:r,error:C,filled:_e,focused:oe,fullWidth:I,hiddenLabel:P,size:j,onBlur:()=>{ce(!1)},onEmpty:()=>{ye(!1)},onFilled:()=>{ye(!0)},onFocus:()=>{ce(!0)},registerEffect:xe,required:N,variant:W}),[re,f,r,C,_e,oe,I,P,xe,N,j,W]);return K.jsx(PE.Provider,{value:he,children:K.jsx(pne,{as:_,ownerState:q,className:Hn(Z.root,u),ref:n,...H,children:a})})});function mne(e){return gi("MuiFormControlLabel",e)}const qv=pi("MuiFormControlLabel",["root","labelPlacementStart","labelPlacementTop","labelPlacementBottom","disabled","label","error","required","asterisk"]),gne=e=>{const{classes:t,disabled:n,labelPlacement:s,error:a,required:u}=e,f={root:["root",n&&"disabled",`labelPlacement${Rn(s)}`,a&&"error",u&&"required"],label:["label",n&&"disabled"],asterisk:["asterisk",a&&"error"]};return yr(f,mne,t)},yne=Dn("label",{name:"MuiFormControlLabel",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[{[`& .${qv.label}`]:t.label},t.root,t[`labelPlacement${Rn(n.labelPlacement)}`]]}})($r(({theme:e})=>({display:"inline-flex",alignItems:"center",cursor:"pointer",verticalAlign:"middle",WebkitTapHighlightColor:"transparent",marginLeft:-11,marginRight:16,[`&.${qv.disabled}`]:{cursor:"default"},[`& .${qv.label}`]:{[`&.${qv.disabled}`]:{color:(e.vars||e).palette.text.disabled}},variants:[{props:{labelPlacement:"start"},style:{flexDirection:"row-reverse",marginRight:-11}},{props:{labelPlacement:"top"},style:{flexDirection:"column-reverse"}},{props:{labelPlacement:"bottom"},style:{flexDirection:"column"}},{props:({labelPlacement:t})=>t==="start"||t==="top"||t==="bottom",style:{marginLeft:16}}]}))),_ne=Dn("span",{name:"MuiFormControlLabel",slot:"Asterisk",overridesResolver:(e,t)=>t.asterisk})($r(({theme:e})=>({[`&.${qv.error}`]:{color:(e.vars||e).palette.error.main}}))),mP=X.forwardRef(function(t,n){const s=xi({props:t,name:"MuiFormControlLabel"}),{checked:a,className:u,componentsProps:f={},control:_,disabled:r,disableTypography:C,inputRef:k,label:I,labelPlacement:P="end",name:D,onChange:N,required:j,slots:W={},slotProps:H={},value:q,...Z}=s,re=Gh(),le=r??_.props.disabled??(re==null?void 0:re.disabled),_e=j??_.props.required,ye={disabled:le,required:_e};["checked","name","onChange","value","inputRef"].forEach(we=>{typeof _.props[we]>"u"&&typeof s[we]<"u"&&(ye[we]=s[we])});const de=Bm({props:s,muiFormControl:re,states:["error"]}),ce={...s,disabled:le,labelPlacement:P,required:_e,error:de.error},oe=gne(ce),xe={slots:W,slotProps:{...f,...H}},[he,Ee]=pl("typography",{elementType:To,externalForwardedProps:xe,ownerState:ce});let se=I;return se!=null&&se.type!==To&&!C&&(se=K.jsx(he,{component:"span",...Ee,className:Hn(oe.label,Ee==null?void 0:Ee.className),children:se})),K.jsxs(yne,{className:Hn(oe.root,u),ownerState:ce,ref:n,...Z,children:[X.cloneElement(_,ye),_e?K.jsxs("div",{children:[se,K.jsxs(_ne,{ownerState:ce,"aria-hidden":!0,className:oe.asterisk,children:[" ","*"]})]}):se]})});function vne(e){return gi("MuiFormHelperText",e)}const bF=pi("MuiFormHelperText",["root","error","disabled","sizeSmall","sizeMedium","contained","focused","filled","required"]);var wF;const xne=e=>{const{classes:t,contained:n,size:s,disabled:a,error:u,filled:f,focused:_,required:r}=e,C={root:["root",a&&"disabled",u&&"error",s&&`size${Rn(s)}`,n&&"contained",_&&"focused",f&&"filled",r&&"required"]};return yr(C,vne,t)},bne=Dn("p",{name:"MuiFormHelperText",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.size&&t[`size${Rn(n.size)}`],n.contained&&t.contained,n.filled&&t.filled]}})($r(({theme:e})=>({color:(e.vars||e).palette.text.secondary,...e.typography.caption,textAlign:"left",marginTop:3,marginRight:0,marginBottom:0,marginLeft:0,[`&.${bF.disabled}`]:{color:(e.vars||e).palette.text.disabled},[`&.${bF.error}`]:{color:(e.vars||e).palette.error.main},variants:[{props:{size:"small"},style:{marginTop:4}},{props:({ownerState:t})=>t.contained,style:{marginLeft:14,marginRight:14}}]}))),wne=X.forwardRef(function(t,n){const s=xi({props:t,name:"MuiFormHelperText"}),{children:a,className:u,component:f="p",disabled:_,error:r,filled:C,focused:k,margin:I,required:P,variant:D,...N}=s,j=Gh(),W=Bm({props:s,muiFormControl:j,states:["variant","size","disabled","error","filled","focused","required"]}),H={...s,component:f,contained:W.variant==="filled"||W.variant==="outlined",variant:W.variant,size:W.size,disabled:W.disabled,error:W.error,filled:W.filled,focused:W.focused,required:W.required};delete H.ownerState;const q=xne(H);return K.jsx(bne,{as:f,className:Hn(q.root,u),ref:n,...N,ownerState:H,children:a===" "?wF||(wF=K.jsx("span",{className:"notranslate",children:"​"})):a})});function Sne(e){return gi("MuiFormLabel",e)}const ux=pi("MuiFormLabel",["root","colorSecondary","focused","disabled","error","filled","required","asterisk"]),Cne=e=>{const{classes:t,color:n,focused:s,disabled:a,error:u,filled:f,required:_}=e,r={root:["root",`color${Rn(n)}`,a&&"disabled",u&&"error",f&&"filled",s&&"focused",_&&"required"],asterisk:["asterisk",u&&"error"]};return yr(r,Sne,t)},Ene=Dn("label",{name:"MuiFormLabel",slot:"Root",overridesResolver:({ownerState:e},t)=>({...t.root,...e.color==="secondary"&&t.colorSecondary,...e.filled&&t.filled})})($r(({theme:e})=>({color:(e.vars||e).palette.text.secondary,...e.typography.body1,lineHeight:"1.4375em",padding:0,position:"relative",variants:[...Object.entries(e.palette).filter(Ms()).map(([t])=>({props:{color:t},style:{[`&.${ux.focused}`]:{color:(e.vars||e).palette[t].main}}})),{props:{},style:{[`&.${ux.disabled}`]:{color:(e.vars||e).palette.text.disabled},[`&.${ux.error}`]:{color:(e.vars||e).palette.error.main}}}]}))),Tne=Dn("span",{name:"MuiFormLabel",slot:"Asterisk",overridesResolver:(e,t)=>t.asterisk})($r(({theme:e})=>({[`&.${ux.error}`]:{color:(e.vars||e).palette.error.main}}))),Ine=X.forwardRef(function(t,n){const s=xi({props:t,name:"MuiFormLabel"}),{children:a,className:u,color:f,component:_="label",disabled:r,error:C,filled:k,focused:I,required:P,...D}=s,N=Gh(),j=Bm({props:s,muiFormControl:N,states:["color","required","focused","disabled","error","filled"]}),W={...s,color:j.color||"primary",component:_,disabled:j.disabled,error:j.error,filled:j.filled,focused:j.focused,required:j.required},H=Cne(W);return K.jsxs(Ene,{as:_,ownerState:W,className:Hn(H.root,u),ref:n,...D,children:[a,j.required&&K.jsxs(Tne,{ownerState:W,"aria-hidden":!0,className:H.asterisk,children:[" ","*"]})]})});function gP(e){return`scale(${e}, ${e**2})`}const kne={entering:{opacity:1,transform:gP(1)},entered:{opacity:1,transform:"none"}},Ck=typeof navigator<"u"&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),i0=X.forwardRef(function(t,n){const{addEndListener:s,appear:a=!0,children:u,easing:f,in:_,onEnter:r,onEntered:C,onEntering:k,onExit:I,onExited:P,onExiting:D,style:N,timeout:j="auto",TransitionComponent:W=bc,...H}=t,q=Eu(),Z=X.useRef(),re=Uh(),le=X.useRef(null),_e=mo(le,$h(u),n),ye=we=>Se=>{if(we){const Pe=le.current;Se===void 0?we(Pe):we(Pe,Se)}},de=ye(k),ce=ye((we,Se)=>{IE(we);const{duration:Pe,delay:Me,easing:Re}=ap({style:N,timeout:j,easing:f},{mode:"enter"});let Oe;j==="auto"?(Oe=re.transitions.getAutoHeightDuration(we.clientHeight),Z.current=Oe):Oe=Pe,we.style.transition=[re.transitions.create("opacity",{duration:Oe,delay:Me}),re.transitions.create("transform",{duration:Ck?Oe:Oe*.666,delay:Me,easing:Re})].join(","),r&&r(we,Se)}),oe=ye(C),xe=ye(D),he=ye(we=>{const{duration:Se,delay:Pe,easing:Me}=ap({style:N,timeout:j,easing:f},{mode:"exit"});let Re;j==="auto"?(Re=re.transitions.getAutoHeightDuration(we.clientHeight),Z.current=Re):Re=Se,we.style.transition=[re.transitions.create("opacity",{duration:Re,delay:Pe}),re.transitions.create("transform",{duration:Ck?Re:Re*.666,delay:Ck?Pe:Pe||Re*.333,easing:Me})].join(","),we.style.opacity=0,we.style.transform=gP(.75),I&&I(we)}),Ee=ye(P),se=we=>{j==="auto"&&q.start(Z.current||0,we),s&&s(le.current,we)};return K.jsx(W,{appear:a,in:_,nodeRef:le,onEnter:ce,onEntered:oe,onEntering:de,onExit:he,onExited:Ee,onExiting:xe,addEndListener:se,timeout:j==="auto"?null:j,...H,children:(we,Se)=>X.cloneElement(u,{style:{opacity:0,transform:gP(.75),visibility:we==="exited"&&!_?"hidden":void 0,...kne[we],...N,...u.props.style},ref:_e,...Se})})});i0&&(i0.muiSupportAuto=!0);const Mne=e=>{const{classes:t,disableUnderline:n}=e,a=yr({root:["root",!n&&"underline"],input:["input"]},See,t);return{...t,...a}},Pne=Dn(RE,{shouldForwardProp:e=>Ha(e)||e==="classes",name:"MuiInput",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[...AE(e,t),!n.disableUnderline&&t.underline]}})($r(({theme:e})=>{let n=e.palette.mode==="light"?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return e.vars&&(n=`rgba(${e.vars.palette.common.onBackgroundChannel} / ${e.vars.opacity.inputUnderline})`),{position:"relative",variants:[{props:({ownerState:s})=>s.formControl,style:{"label + &":{marginTop:16}}},{props:({ownerState:s})=>!s.disableUnderline,style:{"&::after":{left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:e.transitions.create("transform",{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${Ff.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${Ff.error}`]:{"&::before, &::after":{borderBottomColor:(e.vars||e).palette.error.main}},"&::before":{borderBottom:`1px solid ${n}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:e.transitions.create("border-bottom-color",{duration:e.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${Ff.disabled}, .${Ff.error}):before`]:{borderBottom:`2px solid ${(e.vars||e).palette.text.primary}`,"@media (hover: none)":{borderBottom:`1px solid ${n}`}},[`&.${Ff.disabled}:before`]:{borderBottomStyle:"dotted"}}},...Object.entries(e.palette).filter(Ms()).map(([s])=>({props:{color:s,disableUnderline:!1},style:{"&::after":{borderBottom:`2px solid ${(e.vars||e).palette[s].main}`}}}))]}})),Ane=Dn(OE,{name:"MuiInput",slot:"Input",overridesResolver:LE})({}),hC=X.forwardRef(function(t,n){const s=xi({props:t,name:"MuiInput"}),{disableUnderline:a=!1,components:u={},componentsProps:f,fullWidth:_=!1,inputComponent:r="input",multiline:C=!1,slotProps:k,slots:I={},type:P="text",...D}=s,N=Mne(s),W={root:{ownerState:{disableUnderline:a}}},H=k??f?ml(k??f,W):W,q=I.root??u.Root??Pne,Z=I.input??u.Input??Ane;return K.jsx(w0,{slots:{root:q,input:Z},slotProps:H,fullWidth:_,inputComponent:r,multiline:C,ref:n,type:P,...D,classes:N})});hC&&(hC.muiName="Input");function Lne(e){return gi("MuiInputAdornment",e)}const SF=pi("MuiInputAdornment",["root","filled","standard","outlined","positionStart","positionEnd","disablePointerEvents","hiddenLabel","sizeSmall"]);var CF;const Rne=(e,t)=>{const{ownerState:n}=e;return[t.root,t[`position${Rn(n.position)}`],n.disablePointerEvents===!0&&t.disablePointerEvents,t[n.variant]]},One=e=>{const{classes:t,disablePointerEvents:n,hiddenLabel:s,position:a,size:u,variant:f}=e,_={root:["root",n&&"disablePointerEvents",a&&`position${Rn(a)}`,f,s&&"hiddenLabel",u&&`size${Rn(u)}`]};return yr(_,Lne,t)},Dne=Dn("div",{name:"MuiInputAdornment",slot:"Root",overridesResolver:Rne})($r(({theme:e})=>({display:"flex",maxHeight:"2em",alignItems:"center",whiteSpace:"nowrap",color:(e.vars||e).palette.action.active,variants:[{props:{variant:"filled"},style:{[`&.${SF.positionStart}&:not(.${SF.hiddenLabel})`]:{marginTop:16}}},{props:{position:"start"},style:{marginRight:8}},{props:{position:"end"},style:{marginLeft:8}},{props:{disablePointerEvents:!0},style:{pointerEvents:"none"}}]}))),zne=X.forwardRef(function(t,n){const s=xi({props:t,name:"MuiInputAdornment"}),{children:a,className:u,component:f="div",disablePointerEvents:_=!1,disableTypography:r=!1,position:C,variant:k,...I}=s,P=Gh()||{};let D=k;k&&P.variant,P&&!D&&(D=P.variant);const N={...s,hiddenLabel:P.hiddenLabel,size:P.size,disablePointerEvents:_,position:C,variant:D},j=One(N);return K.jsx(PE.Provider,{value:null,children:K.jsx(Dne,{as:f,ownerState:N,className:Hn(j.root,u),ref:n,...I,children:typeof a=="string"&&!r?K.jsx(To,{color:"textSecondary",children:a}):K.jsxs(X.Fragment,{children:[C==="start"?CF||(CF=K.jsx("span",{className:"notranslate",children:"​"})):null,a]})})})});function Fne(e){return gi("MuiInputLabel",e)}pi("MuiInputLabel",["root","focused","disabled","error","required","asterisk","formControl","sizeSmall","shrink","animated","standard","filled","outlined"]);const Nne=e=>{const{classes:t,formControl:n,size:s,shrink:a,disableAnimation:u,variant:f,required:_}=e,r={root:["root",n&&"formControl",!u&&"animated",a&&"shrink",s&&s!=="normal"&&`size${Rn(s)}`,f],asterisk:[_&&"asterisk"]},C=yr(r,Fne,t);return{...t,...C}},Bne=Dn(Ine,{shouldForwardProp:e=>Ha(e)||e==="classes",name:"MuiInputLabel",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[{[`& .${ux.asterisk}`]:t.asterisk},t.root,n.formControl&&t.formControl,n.size==="small"&&t.sizeSmall,n.shrink&&t.shrink,!n.disableAnimation&&t.animated,n.focused&&t.focused,t[n.variant]]}})($r(({theme:e})=>({display:"block",transformOrigin:"top left",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%",variants:[{props:({ownerState:t})=>t.formControl,style:{position:"absolute",left:0,top:0,transform:"translate(0, 20px) scale(1)"}},{props:{size:"small"},style:{transform:"translate(0, 17px) scale(1)"}},{props:({ownerState:t})=>t.shrink,style:{transform:"translate(0, -1.5px) scale(0.75)",transformOrigin:"top left",maxWidth:"133%"}},{props:({ownerState:t})=>!t.disableAnimation,style:{transition:e.transitions.create(["color","transform","max-width"],{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut})}},{props:{variant:"filled"},style:{zIndex:1,pointerEvents:"none",transform:"translate(12px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"}},{props:{variant:"filled",size:"small"},style:{transform:"translate(12px, 13px) scale(1)"}},{props:({variant:t,ownerState:n})=>t==="filled"&&n.shrink,style:{userSelect:"none",pointerEvents:"auto",transform:"translate(12px, 7px) scale(0.75)",maxWidth:"calc(133% - 24px)"}},{props:({variant:t,ownerState:n,size:s})=>t==="filled"&&n.shrink&&s==="small",style:{transform:"translate(12px, 4px) scale(0.75)"}},{props:{variant:"outlined"},style:{zIndex:1,pointerEvents:"none",transform:"translate(14px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"}},{props:{variant:"outlined",size:"small"},style:{transform:"translate(14px, 9px) scale(1)"}},{props:({variant:t,ownerState:n})=>t==="outlined"&&n.shrink,style:{userSelect:"none",pointerEvents:"auto",maxWidth:"calc(133% - 32px)",transform:"translate(14px, -9px) scale(0.75)"}}]}))),cp=X.forwardRef(function(t,n){const s=xi({name:"MuiInputLabel",props:t}),{disableAnimation:a=!1,margin:u,shrink:f,variant:_,className:r,...C}=s,k=Gh();let I=f;typeof I>"u"&&k&&(I=k.filled||k.focused||k.adornedStart);const P=Bm({props:s,muiFormControl:k,states:["size","variant","required","focused"]}),D={...s,disableAnimation:a,formControl:k,shrink:I,size:P.size,variant:P.variant,required:P.required,focused:P.focused},N=Nne(D);return K.jsx(Bne,{"data-shrink":I,ref:n,className:Hn(N.root,r),...C,ownerState:D,classes:N})});function jne(e){return gi("MuiLinearProgress",e)}pi("MuiLinearProgress",["root","colorPrimary","colorSecondary","determinate","indeterminate","buffer","query","dashed","dashedColorPrimary","dashedColorSecondary","bar","barColorPrimary","barColorSecondary","bar1Indeterminate","bar1Determinate","bar1Buffer","bar2Indeterminate","bar2Buffer"]);const yP=4,_P=Jd`
  0% {
    left: -35%;
    right: 100%;
  }

  60% {
    left: 100%;
    right: -90%;
  }

  100% {
    left: 100%;
    right: -90%;
  }
`,Vne=typeof _P!="string"?yp`
        animation: ${_P} 2.1s cubic-bezier(0.65, 0.815, 0.735, 0.395) infinite;
      `:null,vP=Jd`
  0% {
    left: -200%;
    right: 100%;
  }

  60% {
    left: 107%;
    right: -8%;
  }

  100% {
    left: 107%;
    right: -8%;
  }
`,$ne=typeof vP!="string"?yp`
        animation: ${vP} 2.1s cubic-bezier(0.165, 0.84, 0.44, 1) 1.15s infinite;
      `:null,xP=Jd`
  0% {
    opacity: 1;
    background-position: 0 -23px;
  }

  60% {
    opacity: 0;
    background-position: 0 -23px;
  }

  100% {
    opacity: 1;
    background-position: -200px -23px;
  }
`,Une=typeof xP!="string"?yp`
        animation: ${xP} 3s infinite linear;
      `:null,Gne=e=>{const{classes:t,variant:n,color:s}=e,a={root:["root",`color${Rn(s)}`,n],dashed:["dashed",`dashedColor${Rn(s)}`],bar1:["bar",`barColor${Rn(s)}`,(n==="indeterminate"||n==="query")&&"bar1Indeterminate",n==="determinate"&&"bar1Determinate",n==="buffer"&&"bar1Buffer"],bar2:["bar",n!=="buffer"&&`barColor${Rn(s)}`,n==="buffer"&&`color${Rn(s)}`,(n==="indeterminate"||n==="query")&&"bar2Indeterminate",n==="buffer"&&"bar2Buffer"]};return yr(a,jne,t)},gA=(e,t)=>e.vars?e.vars.palette.LinearProgress[`${t}Bg`]:e.palette.mode==="light"?Fm(e.palette[t].main,.62):zm(e.palette[t].main,.5),Hne=Dn("span",{name:"MuiLinearProgress",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[`color${Rn(n.color)}`],t[n.variant]]}})($r(({theme:e})=>({position:"relative",overflow:"hidden",display:"block",height:4,zIndex:0,"@media print":{colorAdjust:"exact"},variants:[...Object.entries(e.palette).filter(Ms()).map(([t])=>({props:{color:t},style:{backgroundColor:gA(e,t)}})),{props:({ownerState:t})=>t.color==="inherit"&&t.variant!=="buffer",style:{"&::before":{content:'""',position:"absolute",left:0,top:0,right:0,bottom:0,backgroundColor:"currentColor",opacity:.3}}},{props:{variant:"buffer"},style:{backgroundColor:"transparent"}},{props:{variant:"query"},style:{transform:"rotate(180deg)"}}]}))),Wne=Dn("span",{name:"MuiLinearProgress",slot:"Dashed",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.dashed,t[`dashedColor${Rn(n.color)}`]]}})($r(({theme:e})=>({position:"absolute",marginTop:0,height:"100%",width:"100%",backgroundSize:"10px 10px",backgroundPosition:"0 -23px",variants:[{props:{color:"inherit"},style:{opacity:.3,backgroundImage:"radial-gradient(currentColor 0%, currentColor 16%, transparent 42%)"}},...Object.entries(e.palette).filter(Ms()).map(([t])=>{const n=gA(e,t);return{props:{color:t},style:{backgroundImage:`radial-gradient(${n} 0%, ${n} 16%, transparent 42%)`}}})]})),Une||{animation:`${xP} 3s infinite linear`}),qne=Dn("span",{name:"MuiLinearProgress",slot:"Bar1",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.bar,t[`barColor${Rn(n.color)}`],(n.variant==="indeterminate"||n.variant==="query")&&t.bar1Indeterminate,n.variant==="determinate"&&t.bar1Determinate,n.variant==="buffer"&&t.bar1Buffer]}})($r(({theme:e})=>({width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left",variants:[{props:{color:"inherit"},style:{backgroundColor:"currentColor"}},...Object.entries(e.palette).filter(Ms()).map(([t])=>({props:{color:t},style:{backgroundColor:(e.vars||e).palette[t].main}})),{props:{variant:"determinate"},style:{transition:`transform .${yP}s linear`}},{props:{variant:"buffer"},style:{zIndex:1,transition:`transform .${yP}s linear`}},{props:({ownerState:t})=>t.variant==="indeterminate"||t.variant==="query",style:{width:"auto"}},{props:({ownerState:t})=>t.variant==="indeterminate"||t.variant==="query",style:Vne||{animation:`${_P} 2.1s cubic-bezier(0.65, 0.815, 0.735, 0.395) infinite`}}]}))),Xne=Dn("span",{name:"MuiLinearProgress",slot:"Bar2",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.bar,t[`barColor${Rn(n.color)}`],(n.variant==="indeterminate"||n.variant==="query")&&t.bar2Indeterminate,n.variant==="buffer"&&t.bar2Buffer]}})($r(({theme:e})=>({width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left",variants:[...Object.entries(e.palette).filter(Ms()).map(([t])=>({props:{color:t},style:{"--LinearProgressBar2-barColor":(e.vars||e).palette[t].main}})),{props:({ownerState:t})=>t.variant!=="buffer"&&t.color!=="inherit",style:{backgroundColor:"var(--LinearProgressBar2-barColor, currentColor)"}},{props:({ownerState:t})=>t.variant!=="buffer"&&t.color==="inherit",style:{backgroundColor:"currentColor"}},{props:{color:"inherit"},style:{opacity:.3}},...Object.entries(e.palette).filter(Ms()).map(([t])=>({props:{color:t,variant:"buffer"},style:{backgroundColor:gA(e,t),transition:`transform .${yP}s linear`}})),{props:({ownerState:t})=>t.variant==="indeterminate"||t.variant==="query",style:{width:"auto"}},{props:({ownerState:t})=>t.variant==="indeterminate"||t.variant==="query",style:$ne||{animation:`${vP} 2.1s cubic-bezier(0.165, 0.84, 0.44, 1) 1.15s infinite`}}]}))),Yne=X.forwardRef(function(t,n){const s=xi({props:t,name:"MuiLinearProgress"}),{className:a,color:u="primary",value:f,valueBuffer:_,variant:r="indeterminate",...C}=s,k={...s,color:u,variant:r},I=Gne(k),P=au(),D={},N={bar1:{},bar2:{}};if((r==="determinate"||r==="buffer")&&f!==void 0){D["aria-valuenow"]=Math.round(f),D["aria-valuemin"]=0,D["aria-valuemax"]=100;let j=f-100;P&&(j=-j),N.bar1.transform=`translateX(${j}%)`}if(r==="buffer"&&_!==void 0){let j=(_||0)-100;P&&(j=-j),N.bar2.transform=`translateX(${j}%)`}return K.jsxs(Hne,{className:Hn(I.root,a),ownerState:k,role:"progressbar",...D,ref:n,...C,children:[r==="buffer"?K.jsx(Wne,{className:I.dashed,ownerState:k}):null,K.jsx(qne,{className:I.bar1,ownerState:k,style:N.bar1}),r==="determinate"?null:K.jsx(Xne,{className:I.bar2,ownerState:k,style:N.bar2})]})}),Mm=X.createContext({});function Zne(e){return gi("MuiList",e)}pi("MuiList",["root","padding","dense","subheader"]);const Kne=e=>{const{classes:t,disablePadding:n,dense:s,subheader:a}=e;return yr({root:["root",!n&&"padding",s&&"dense",a&&"subheader"]},Zne,t)},Jne=Dn("ul",{name:"MuiList",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,!n.disablePadding&&t.padding,n.dense&&t.dense,n.subheader&&t.subheader]}})({listStyle:"none",margin:0,padding:0,position:"relative",variants:[{props:({ownerState:e})=>!e.disablePadding,style:{paddingTop:8,paddingBottom:8}},{props:({ownerState:e})=>e.subheader,style:{paddingTop:0}}]}),yA=X.forwardRef(function(t,n){const s=xi({props:t,name:"MuiList"}),{children:a,className:u,component:f="ul",dense:_=!1,disablePadding:r=!1,subheader:C,...k}=s,I=X.useMemo(()=>({dense:_}),[_]),P={...s,component:f,dense:_,disablePadding:r},D=Kne(P);return K.jsx(Mm.Provider,{value:I,children:K.jsxs(Jne,{as:f,className:Hn(D.root,u),ref:n,ownerState:P,...k,children:[C,a]})})});function Qne(e){return gi("MuiListItemButton",e)}const yv=pi("MuiListItemButton",["root","focusVisible","dense","alignItemsFlexStart","disabled","divider","gutters","selected"]),ere=(e,t)=>{const{ownerState:n}=e;return[t.root,n.dense&&t.dense,n.alignItems==="flex-start"&&t.alignItemsFlexStart,n.divider&&t.divider,!n.disableGutters&&t.gutters]},tre=e=>{const{alignItems:t,classes:n,dense:s,disabled:a,disableGutters:u,divider:f,selected:_}=e,C=yr({root:["root",s&&"dense",!u&&"gutters",f&&"divider",a&&"disabled",t==="flex-start"&&"alignItemsFlexStart",_&&"selected"]},Qne,n);return{...n,...C}},nre=Dn(lp,{shouldForwardProp:e=>Ha(e)||e==="classes",name:"MuiListItemButton",slot:"Root",overridesResolver:ere})($r(({theme:e})=>({display:"flex",flexGrow:1,justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minWidth:0,boxSizing:"border-box",textAlign:"left",paddingTop:8,paddingBottom:8,transition:e.transitions.create("background-color",{duration:e.transitions.duration.shortest}),"&:hover":{textDecoration:"none",backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${yv.selected}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:vi(e.palette.primary.main,e.palette.action.selectedOpacity),[`&.${yv.focusVisible}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.focusOpacity}))`:vi(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.focusOpacity)}},[`&.${yv.selected}:hover`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:vi(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:vi(e.palette.primary.main,e.palette.action.selectedOpacity)}},[`&.${yv.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`&.${yv.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity},variants:[{props:({ownerState:t})=>t.divider,style:{borderBottom:`1px solid ${(e.vars||e).palette.divider}`,backgroundClip:"padding-box"}},{props:{alignItems:"flex-start"},style:{alignItems:"flex-start"}},{props:({ownerState:t})=>!t.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:t})=>t.dense,style:{paddingTop:4,paddingBottom:4}}]}))),i8=X.forwardRef(function(t,n){const s=xi({props:t,name:"MuiListItemButton"}),{alignItems:a="center",autoFocus:u=!1,component:f="div",children:_,dense:r=!1,disableGutters:C=!1,divider:k=!1,focusVisibleClassName:I,selected:P=!1,className:D,...N}=s,j=X.useContext(Mm),W=X.useMemo(()=>({dense:r||j.dense||!1,alignItems:a,disableGutters:C}),[a,j.dense,r,C]),H=X.useRef(null);Io(()=>{u&&H.current&&H.current.focus()},[u]);const q={...s,alignItems:a,dense:W.dense,disableGutters:C,divider:k,selected:P},Z=tre(q),re=mo(H,n);return K.jsx(Mm.Provider,{value:W,children:K.jsx(nre,{ref:re,href:N.href||N.to,component:(N.href||N.to)&&f==="div"?"button":f,focusVisibleClassName:Hn(Z.focusVisible,I),ownerState:q,className:Hn(Z.root,D),...N,classes:Z,children:_})})});function rre(e){return gi("MuiListItemIcon",e)}const EF=pi("MuiListItemIcon",["root","alignItemsFlexStart"]),ire=e=>{const{alignItems:t,classes:n}=e;return yr({root:["root",t==="flex-start"&&"alignItemsFlexStart"]},rre,n)},ore=Dn("div",{name:"MuiListItemIcon",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.alignItems==="flex-start"&&t.alignItemsFlexStart]}})($r(({theme:e})=>({minWidth:56,color:(e.vars||e).palette.action.active,flexShrink:0,display:"inline-flex",variants:[{props:{alignItems:"flex-start"},style:{marginTop:8}}]}))),zy=X.forwardRef(function(t,n){const s=xi({props:t,name:"MuiListItemIcon"}),{className:a,...u}=s,f=X.useContext(Mm),_={...s,alignItems:f.alignItems},r=ire(_);return K.jsx(ore,{className:Hn(r.root,a),ownerState:_,ref:n,...u})});function sre(e){return gi("MuiListItemText",e)}const by=pi("MuiListItemText",["root","multiline","dense","inset","primary","secondary"]),are=e=>{const{classes:t,inset:n,primary:s,secondary:a,dense:u}=e;return yr({root:["root",n&&"inset",u&&"dense",s&&a&&"multiline"],primary:["primary"],secondary:["secondary"]},sre,t)},lre=Dn("div",{name:"MuiListItemText",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[{[`& .${by.primary}`]:t.primary},{[`& .${by.secondary}`]:t.secondary},t.root,n.inset&&t.inset,n.primary&&n.secondary&&t.multiline,n.dense&&t.dense]}})({flex:"1 1 auto",minWidth:0,marginTop:4,marginBottom:4,[`.${Yz.root}:where(& .${by.primary})`]:{display:"block"},[`.${Yz.root}:where(& .${by.secondary})`]:{display:"block"},variants:[{props:({ownerState:e})=>e.primary&&e.secondary,style:{marginTop:6,marginBottom:6}},{props:({ownerState:e})=>e.inset,style:{paddingLeft:56}}]}),ep=X.forwardRef(function(t,n){const s=xi({props:t,name:"MuiListItemText"}),{children:a,className:u,disableTypography:f=!1,inset:_=!1,primary:r,primaryTypographyProps:C,secondary:k,secondaryTypographyProps:I,...P}=s,{dense:D}=X.useContext(Mm);let N=r??a,j=k;const W={...s,disableTypography:f,inset:_,primary:!!N,secondary:!!j,dense:D},H=are(W);return N!=null&&N.type!==To&&!f&&(N=K.jsx(To,{variant:D?"body2":"body1",className:H.primary,component:C!=null&&C.variant?void 0:"span",...C,children:N})),j!=null&&j.type!==To&&!f&&(j=K.jsx(To,{variant:"body2",className:H.secondary,color:"textSecondary",...I,children:j})),K.jsxs(lre,{className:Hn(H.root,u),ownerState:W,ref:n,...P,children:[N,j]})});function Ek(e,t,n){return e===t?e.firstChild:t&&t.nextElementSibling?t.nextElementSibling:n?null:e.firstChild}function TF(e,t,n){return e===t?n?e.firstChild:e.lastChild:t&&t.previousElementSibling?t.previousElementSibling:n?null:e.lastChild}function o8(e,t){if(t===void 0)return!0;let n=e.innerText;return n===void 0&&(n=e.textContent),n=n.trim().toLowerCase(),n.length===0?!1:t.repeating?n[0]===t.keys[0]:n.startsWith(t.keys.join(""))}function _v(e,t,n,s,a,u){let f=!1,_=a(e,t,t?n:!1);for(;_;){if(_===e.firstChild){if(f)return!1;f=!0}const r=s?!1:_.disabled||_.getAttribute("aria-disabled")==="true";if(!_.hasAttribute("tabindex")||!o8(_,u)||r)_=a(e,_,n);else return _.focus(),!0}return!1}const _A=X.forwardRef(function(t,n){const{actions:s,autoFocus:a=!1,autoFocusItem:u=!1,children:f,className:_,disabledItemsFocusable:r=!1,disableListWrap:C=!1,onKeyDown:k,variant:I="selectedMenu",...P}=t,D=X.useRef(null),N=X.useRef({keys:[],repeating:!0,previousKeyMatched:!0,lastTime:null});Io(()=>{a&&D.current.focus()},[a]),X.useImperativeHandle(s,()=>({adjustStyleForScrollbar:(Z,{direction:re})=>{const le=!D.current.style.width;if(Z.clientHeight<D.current.clientHeight&&le){const _e=`${Cj(pc(Z))}px`;D.current.style[re==="rtl"?"paddingLeft":"paddingRight"]=_e,D.current.style.width=`calc(100% + ${_e})`}return D.current}}),[]);const j=Z=>{const re=D.current,le=Z.key;if(Z.ctrlKey||Z.metaKey||Z.altKey){k&&k(Z);return}const ye=As(re).activeElement;if(le==="ArrowDown")Z.preventDefault(),_v(re,ye,C,r,Ek);else if(le==="ArrowUp")Z.preventDefault(),_v(re,ye,C,r,TF);else if(le==="Home")Z.preventDefault(),_v(re,null,C,r,Ek);else if(le==="End")Z.preventDefault(),_v(re,null,C,r,TF);else if(le.length===1){const de=N.current,ce=le.toLowerCase(),oe=performance.now();de.keys.length>0&&(oe-de.lastTime>500?(de.keys=[],de.repeating=!0,de.previousKeyMatched=!0):de.repeating&&ce!==de.keys[0]&&(de.repeating=!1)),de.lastTime=oe,de.keys.push(ce);const xe=ye&&!de.repeating&&o8(ye,de);de.previousKeyMatched&&(xe||_v(re,ye,!1,r,Ek,de))?Z.preventDefault():de.previousKeyMatched=!1}k&&k(Z)},W=mo(D,n);let H=-1;X.Children.forEach(f,(Z,re)=>{if(!X.isValidElement(Z)){H===re&&(H+=1,H>=f.length&&(H=-1));return}Z.props.disabled||(I==="selectedMenu"&&Z.props.selected||H===-1)&&(H=re),H===re&&(Z.props.disabled||Z.props.muiSkipListHighlight||Z.type.muiSkipListHighlight)&&(H+=1,H>=f.length&&(H=-1))});const q=X.Children.map(f,(Z,re)=>{if(re===H){const le={};return u&&(le.autoFocus=!0),Z.props.tabIndex===void 0&&I==="selectedMenu"&&(le.tabIndex=0),X.cloneElement(Z,le)}return Z});return K.jsx(yA,{role:"menu",ref:W,className:_,onKeyDown:j,tabIndex:a?0:-1,...P,children:q})});function ure(e){return gi("MuiPopover",e)}pi("MuiPopover",["root","paper"]);function IF(e,t){let n=0;return typeof t=="number"?n=t:t==="center"?n=e.height/2:t==="bottom"&&(n=e.height),n}function kF(e,t){let n=0;return typeof t=="number"?n=t:t==="center"?n=e.width/2:t==="right"&&(n=e.width),n}function MF(e){return[e.horizontal,e.vertical].map(t=>typeof t=="number"?`${t}px`:t).join(" ")}function Tk(e){return typeof e=="function"?e():e}const cre=e=>{const{classes:t}=e;return yr({root:["root"],paper:["paper"]},ure,t)},dre=Dn(mA,{name:"MuiPopover",slot:"Root",overridesResolver:(e,t)=>t.root})({}),s8=Dn(b0,{name:"MuiPopover",slot:"Paper",overridesResolver:(e,t)=>t.paper})({position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:0}),hre=X.forwardRef(function(t,n){const s=xi({props:t,name:"MuiPopover"}),{action:a,anchorEl:u,anchorOrigin:f={vertical:"top",horizontal:"left"},anchorPosition:_,anchorReference:r="anchorEl",children:C,className:k,container:I,elevation:P=8,marginThreshold:D=16,open:N,PaperProps:j={},slots:W={},slotProps:H={},transformOrigin:q={vertical:"top",horizontal:"left"},TransitionComponent:Z=i0,transitionDuration:re="auto",TransitionProps:{onEntering:le,..._e}={},disableScrollLock:ye=!1,...de}=s,ce=(H==null?void 0:H.paper)??j,oe=X.useRef(),xe={...s,anchorOrigin:f,anchorReference:r,elevation:P,marginThreshold:D,externalPaperSlotProps:ce,transformOrigin:q,TransitionComponent:Z,transitionDuration:re,TransitionProps:_e},he=cre(xe),Ee=X.useCallback(()=>{if(r==="anchorPosition")return _;const wt=Tk(u),We=(wt&&wt.nodeType===1?wt:As(oe.current).body).getBoundingClientRect();return{top:We.top+IF(We,f.vertical),left:We.left+kF(We,f.horizontal)}},[u,f.horizontal,f.vertical,_,r]),se=X.useCallback(wt=>({vertical:IF(wt,q.vertical),horizontal:kF(wt,q.horizontal)}),[q.horizontal,q.vertical]),we=X.useCallback(wt=>{const Ne={width:wt.offsetWidth,height:wt.offsetHeight},We=se(Ne);if(r==="none")return{top:null,left:null,transformOrigin:MF(We)};const Sn=Ee();let Ae=Sn.top-We.vertical,st=Sn.left-We.horizontal;const gt=Ae+Ne.height,ut=st+Ne.width,tt=pc(Tk(u)),nt=tt.innerHeight-D,tn=tt.innerWidth-D;if(D!==null&&Ae<D){const un=Ae-D;Ae-=un,We.vertical+=un}else if(D!==null&&gt>nt){const un=gt-nt;Ae-=un,We.vertical+=un}if(D!==null&&st<D){const un=st-D;st-=un,We.horizontal+=un}else if(ut>tn){const un=ut-tn;st-=un,We.horizontal+=un}return{top:`${Math.round(Ae)}px`,left:`${Math.round(st)}px`,transformOrigin:MF(We)}},[u,r,Ee,se,D]),[Se,Pe]=X.useState(N),Me=X.useCallback(()=>{const wt=oe.current;if(!wt)return;const Ne=we(wt);Ne.top!==null&&wt.style.setProperty("top",Ne.top),Ne.left!==null&&(wt.style.left=Ne.left),wt.style.transformOrigin=Ne.transformOrigin,Pe(!0)},[we]);X.useEffect(()=>(ye&&window.addEventListener("scroll",Me),()=>window.removeEventListener("scroll",Me)),[u,ye,Me]);const Re=(wt,Ne)=>{le&&le(wt,Ne),Me()},Oe=()=>{Pe(!1)};X.useEffect(()=>{N&&Me()}),X.useImperativeHandle(a,()=>N?{updatePosition:()=>{Me()}}:null,[N,Me]),X.useEffect(()=>{if(!N)return;const wt=rA(()=>{Me()}),Ne=pc(u);return Ne.addEventListener("resize",wt),()=>{wt.clear(),Ne.removeEventListener("resize",wt)}},[u,N,Me]);let $e=re;re==="auto"&&!Z.muiSupportAuto&&($e=void 0);const Ke=I||(u?As(Tk(u)).body:void 0),Ct={slots:W,slotProps:{...H,paper:ce}},[Ue,ft]=pl("paper",{elementType:s8,externalForwardedProps:Ct,additionalProps:{elevation:P,className:Hn(he.paper,ce==null?void 0:ce.className),style:Se?ce.style:{...ce.style,opacity:0}},ownerState:xe}),[Bt,{slotProps:hn,...ot}]=pl("root",{elementType:dre,externalForwardedProps:Ct,additionalProps:{slotProps:{backdrop:{invisible:!0}},container:Ke,open:N},ownerState:xe,className:Hn(he.root,k)}),en=mo(oe,ft.ref);return K.jsx(Bt,{...ot,...!uC(Bt)&&{slotProps:hn,disableScrollLock:ye},...de,ref:n,children:K.jsx(Z,{appear:!0,in:N,onEntering:Re,onExited:Oe,timeout:$e,..._e,children:K.jsx(Ue,{...ft,ref:en,children:C})})})});function fre(e){return gi("MuiMenu",e)}pi("MuiMenu",["root","paper","list"]);const pre={vertical:"top",horizontal:"right"},mre={vertical:"top",horizontal:"left"},gre=e=>{const{classes:t}=e;return yr({root:["root"],paper:["paper"],list:["list"]},fre,t)},yre=Dn(hre,{shouldForwardProp:e=>Ha(e)||e==="classes",name:"MuiMenu",slot:"Root",overridesResolver:(e,t)=>t.root})({}),_re=Dn(s8,{name:"MuiMenu",slot:"Paper",overridesResolver:(e,t)=>t.paper})({maxHeight:"calc(100% - 96px)",WebkitOverflowScrolling:"touch"}),vre=Dn(_A,{name:"MuiMenu",slot:"List",overridesResolver:(e,t)=>t.list})({outline:0}),xre=X.forwardRef(function(t,n){const s=xi({props:t,name:"MuiMenu"}),{autoFocus:a=!0,children:u,className:f,disableAutoFocusItem:_=!1,MenuListProps:r={},onClose:C,open:k,PaperProps:I={},PopoverClasses:P,transitionDuration:D="auto",TransitionProps:{onEntering:N,...j}={},variant:W="selectedMenu",slots:H={},slotProps:q={},...Z}=s,re=au(),le={...s,autoFocus:a,disableAutoFocusItem:_,MenuListProps:r,onEntering:N,PaperProps:I,transitionDuration:D,TransitionProps:j,variant:W},_e=gre(le),ye=a&&!_&&k,de=X.useRef(null),ce=(Se,Pe)=>{de.current&&de.current.adjustStyleForScrollbar(Se,{direction:re?"rtl":"ltr"}),N&&N(Se,Pe)},oe=Se=>{Se.key==="Tab"&&(Se.preventDefault(),C&&C(Se,"tabKeyDown"))};let xe=-1;X.Children.map(u,(Se,Pe)=>{X.isValidElement(Se)&&(Se.props.disabled||(W==="selectedMenu"&&Se.props.selected||xe===-1)&&(xe=Pe))});const he=H.paper??_re,Ee=q.paper??I,se=Nx({elementType:H.root,externalSlotProps:q.root,ownerState:le,className:[_e.root,f]}),we=Nx({elementType:he,externalSlotProps:Ee,ownerState:le,className:_e.paper});return K.jsx(yre,{onClose:C,anchorOrigin:{vertical:"bottom",horizontal:re?"right":"left"},transformOrigin:re?pre:mre,slots:{paper:he,root:H.root},slotProps:{root:se,paper:we},open:k,ref:n,transitionDuration:D,TransitionProps:{onEntering:ce,...j},ownerState:le,...Z,classes:P,children:K.jsx(vre,{onKeyDown:oe,actions:de,autoFocus:a&&(xe===-1||_),autoFocusItem:ye,variant:W,...r,className:Hn(_e.list,r.className),children:u})})});function bre(e){return gi("MuiMenuItem",e)}const vv=pi("MuiMenuItem",["root","focusVisible","dense","disabled","divider","gutters","selected"]),wre=(e,t)=>{const{ownerState:n}=e;return[t.root,n.dense&&t.dense,n.divider&&t.divider,!n.disableGutters&&t.gutters]},Sre=e=>{const{disabled:t,dense:n,divider:s,disableGutters:a,selected:u,classes:f}=e,r=yr({root:["root",n&&"dense",t&&"disabled",!a&&"gutters",s&&"divider",u&&"selected"]},bre,f);return{...f,...r}},Cre=Dn(lp,{shouldForwardProp:e=>Ha(e)||e==="classes",name:"MuiMenuItem",slot:"Root",overridesResolver:wre})($r(({theme:e})=>({...e.typography.body1,display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minHeight:48,paddingTop:6,paddingBottom:6,boxSizing:"border-box",whiteSpace:"nowrap","&:hover":{textDecoration:"none",backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${vv.selected}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:vi(e.palette.primary.main,e.palette.action.selectedOpacity),[`&.${vv.focusVisible}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.focusOpacity}))`:vi(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.focusOpacity)}},[`&.${vv.selected}:hover`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:vi(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:vi(e.palette.primary.main,e.palette.action.selectedOpacity)}},[`&.${vv.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`&.${vv.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity},[`& + .${_F.root}`]:{marginTop:e.spacing(1),marginBottom:e.spacing(1)},[`& + .${_F.inset}`]:{marginLeft:52},[`& .${by.root}`]:{marginTop:0,marginBottom:0},[`& .${by.inset}`]:{paddingLeft:36},[`& .${EF.root}`]:{minWidth:36},variants:[{props:({ownerState:t})=>!t.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:t})=>t.divider,style:{borderBottom:`1px solid ${(e.vars||e).palette.divider}`,backgroundClip:"padding-box"}},{props:({ownerState:t})=>!t.dense,style:{[e.breakpoints.up("sm")]:{minHeight:"auto"}}},{props:({ownerState:t})=>t.dense,style:{minHeight:32,paddingTop:4,paddingBottom:4,...e.typography.body2,[`& .${EF.root} svg`]:{fontSize:"1.25rem"}}}]}))),gl=X.forwardRef(function(t,n){const s=xi({props:t,name:"MuiMenuItem"}),{autoFocus:a=!1,component:u="li",dense:f=!1,divider:_=!1,disableGutters:r=!1,focusVisibleClassName:C,role:k="menuitem",tabIndex:I,className:P,...D}=s,N=X.useContext(Mm),j=X.useMemo(()=>({dense:f||N.dense||!1,disableGutters:r}),[N.dense,f,r]),W=X.useRef(null);Io(()=>{a&&W.current&&W.current.focus()},[a]);const H={...s,dense:j.dense,divider:_,disableGutters:r},q=Sre(s),Z=mo(W,n);let re;return s.disabled||(re=I!==void 0?I:-1),K.jsx(Mm.Provider,{value:j,children:K.jsx(Cre,{ref:Z,role:k,tabIndex:re,component:u,focusVisibleClassName:Hn(q.focusVisible,C),className:Hn(q.root,P),...D,ownerState:H,classes:q})})});function Ere(e){return gi("MuiNativeSelect",e)}const vA=pi("MuiNativeSelect",["root","select","multiple","filled","outlined","standard","disabled","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),Tre=e=>{const{classes:t,variant:n,disabled:s,multiple:a,open:u,error:f}=e,_={select:["select",n,s&&"disabled",a&&"multiple",f&&"error"],icon:["icon",`icon${Rn(n)}`,u&&"iconOpen",s&&"disabled"]};return yr(_,Ere,t)},a8=Dn("select")(({theme:e})=>({MozAppearance:"none",WebkitAppearance:"none",userSelect:"none",borderRadius:0,cursor:"pointer","&:focus":{borderRadius:0},[`&.${vA.disabled}`]:{cursor:"default"},"&[multiple]":{height:"auto"},"&:not([multiple]) option, &:not([multiple]) optgroup":{backgroundColor:(e.vars||e).palette.background.paper},variants:[{props:({ownerState:t})=>t.variant!=="filled"&&t.variant!=="outlined",style:{"&&&":{paddingRight:24,minWidth:16}}},{props:{variant:"filled"},style:{"&&&":{paddingRight:32}}},{props:{variant:"outlined"},style:{borderRadius:(e.vars||e).shape.borderRadius,"&:focus":{borderRadius:(e.vars||e).shape.borderRadius},"&&&":{paddingRight:32}}}]})),Ire=Dn(a8,{name:"MuiNativeSelect",slot:"Select",shouldForwardProp:Ha,overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.select,t[n.variant],n.error&&t.error,{[`&.${vA.multiple}`]:t.multiple}]}})({}),l8=Dn("svg")(({theme:e})=>({position:"absolute",right:0,top:"calc(50% - .5em)",pointerEvents:"none",color:(e.vars||e).palette.action.active,[`&.${vA.disabled}`]:{color:(e.vars||e).palette.action.disabled},variants:[{props:({ownerState:t})=>t.open,style:{transform:"rotate(180deg)"}},{props:{variant:"filled"},style:{right:7}},{props:{variant:"outlined"},style:{right:7}}]})),kre=Dn(l8,{name:"MuiNativeSelect",slot:"Icon",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.icon,n.variant&&t[`icon${Rn(n.variant)}`],n.open&&t.iconOpen]}})({}),Mre=X.forwardRef(function(t,n){const{className:s,disabled:a,error:u,IconComponent:f,inputRef:_,variant:r="standard",...C}=t,k={...t,disabled:a,variant:r,error:u},I=Tre(k);return K.jsxs(X.Fragment,{children:[K.jsx(Ire,{ownerState:k,className:Hn(I.select,s),disabled:a,ref:_||n,...C}),t.multiple?null:K.jsx(kre,{as:f,ownerState:k,className:I.icon})]})});var PF;const Pre=Dn("fieldset",{shouldForwardProp:Ha})({textAlign:"left",position:"absolute",bottom:0,right:0,top:-5,left:0,margin:0,padding:"0 8px",pointerEvents:"none",borderRadius:"inherit",borderStyle:"solid",borderWidth:1,overflow:"hidden",minWidth:"0%"}),Are=Dn("legend",{shouldForwardProp:Ha})($r(({theme:e})=>({float:"unset",width:"auto",overflow:"hidden",variants:[{props:({ownerState:t})=>!t.withLabel,style:{padding:0,lineHeight:"11px",transition:e.transitions.create("width",{duration:150,easing:e.transitions.easing.easeOut})}},{props:({ownerState:t})=>t.withLabel,style:{display:"block",padding:0,height:11,fontSize:"0.75em",visibility:"hidden",maxWidth:.01,transition:e.transitions.create("max-width",{duration:50,easing:e.transitions.easing.easeOut}),whiteSpace:"nowrap","& > span":{paddingLeft:5,paddingRight:5,display:"inline-block",opacity:0,visibility:"visible"}}},{props:({ownerState:t})=>t.withLabel&&t.notched,style:{maxWidth:"100%",transition:e.transitions.create("max-width",{duration:100,easing:e.transitions.easing.easeOut,delay:50})}}]})));function Lre(e){const{children:t,classes:n,className:s,label:a,notched:u,...f}=e,_=a!=null&&a!=="",r={...e,notched:u,withLabel:_};return K.jsx(Pre,{"aria-hidden":!0,className:s,ownerState:r,...f,children:K.jsx(Are,{ownerState:r,children:_?K.jsx("span",{children:a}):PF||(PF=K.jsx("span",{className:"notranslate",children:"​"}))})})}const Rre=e=>{const{classes:t}=e,s=yr({root:["root"],notchedOutline:["notchedOutline"],input:["input"]},Cee,t);return{...t,...s}},Ore=Dn(RE,{shouldForwardProp:e=>Ha(e)||e==="classes",name:"MuiOutlinedInput",slot:"Root",overridesResolver:AE})($r(({theme:e})=>{const t=e.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{position:"relative",borderRadius:(e.vars||e).shape.borderRadius,[`&:hover .${Zu.notchedOutline}`]:{borderColor:(e.vars||e).palette.text.primary},"@media (hover: none)":{[`&:hover .${Zu.notchedOutline}`]:{borderColor:e.vars?`rgba(${e.vars.palette.common.onBackgroundChannel} / 0.23)`:t}},[`&.${Zu.focused} .${Zu.notchedOutline}`]:{borderWidth:2},variants:[...Object.entries(e.palette).filter(Ms()).map(([n])=>({props:{color:n},style:{[`&.${Zu.focused} .${Zu.notchedOutline}`]:{borderColor:(e.vars||e).palette[n].main}}})),{props:{},style:{[`&.${Zu.error} .${Zu.notchedOutline}`]:{borderColor:(e.vars||e).palette.error.main},[`&.${Zu.disabled} .${Zu.notchedOutline}`]:{borderColor:(e.vars||e).palette.action.disabled}}},{props:({ownerState:n})=>n.startAdornment,style:{paddingLeft:14}},{props:({ownerState:n})=>n.endAdornment,style:{paddingRight:14}},{props:({ownerState:n})=>n.multiline,style:{padding:"16.5px 14px"}},{props:({ownerState:n,size:s})=>n.multiline&&s==="small",style:{padding:"8.5px 14px"}}]}})),Dre=Dn(Lre,{name:"MuiOutlinedInput",slot:"NotchedOutline",overridesResolver:(e,t)=>t.notchedOutline})($r(({theme:e})=>{const t=e.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{borderColor:e.vars?`rgba(${e.vars.palette.common.onBackgroundChannel} / 0.23)`:t}})),zre=Dn(OE,{name:"MuiOutlinedInput",slot:"Input",overridesResolver:LE})($r(({theme:e})=>({padding:"16.5px 14px",...!e.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:e.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:e.palette.mode==="light"?null:"#fff",caretColor:e.palette.mode==="light"?null:"#fff",borderRadius:"inherit"}},...e.vars&&{"&:-webkit-autofill":{borderRadius:"inherit"},[e.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},variants:[{props:{size:"small"},style:{padding:"8.5px 14px"}},{props:({ownerState:t})=>t.multiline,style:{padding:0}},{props:({ownerState:t})=>t.startAdornment,style:{paddingLeft:0}},{props:({ownerState:t})=>t.endAdornment,style:{paddingRight:0}}]}))),fC=X.forwardRef(function(t,n){var s;const a=xi({props:t,name:"MuiOutlinedInput"}),{components:u={},fullWidth:f=!1,inputComponent:_="input",label:r,multiline:C=!1,notched:k,slots:I={},type:P="text",...D}=a,N=Rre(a),j=Gh(),W=Bm({props:a,muiFormControl:j,states:["color","disabled","error","focused","hiddenLabel","size","required"]}),H={...a,color:W.color||"primary",disabled:W.disabled,error:W.error,focused:W.focused,formControl:j,fullWidth:f,hiddenLabel:W.hiddenLabel,multiline:C,size:W.size,type:P},q=I.root??u.Root??Ore,Z=I.input??u.Input??zre;return K.jsx(w0,{slots:{root:q,input:Z},renderSuffix:re=>K.jsx(Dre,{ownerState:H,className:N.notchedOutline,label:r!=null&&r!==""&&W.required?s||(s=K.jsxs(X.Fragment,{children:[r," ","*"]})):r,notched:typeof k<"u"?k:!!(re.startAdornment||re.filled||re.focused)}),fullWidth:f,inputComponent:_,multiline:C,ref:n,type:P,...D,classes:{...N,notchedOutline:null}})});fC&&(fC.muiName="Input");const Fre=Jr(K.jsx("path",{d:"M18.41 16.59L13.82 12l4.59-4.59L17 6l-6 6 6 6zM6 6h2v12H6z"}),"FirstPage"),Nre=Jr(K.jsx("path",{d:"M5.59 7.41L10.18 12l-4.59 4.59L7 18l6-6-6-6zM16 6h2v12h-2z"}),"LastPage");function Bre(e){return gi("MuiSelect",e)}const xv=pi("MuiSelect",["root","select","multiple","filled","outlined","standard","disabled","focused","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]);var AF;const jre=Dn(a8,{name:"MuiSelect",slot:"Select",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[{[`&.${xv.select}`]:t.select},{[`&.${xv.select}`]:t[n.variant]},{[`&.${xv.error}`]:t.error},{[`&.${xv.multiple}`]:t.multiple}]}})({[`&.${xv.select}`]:{height:"auto",minHeight:"1.4375em",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}}),Vre=Dn(l8,{name:"MuiSelect",slot:"Icon",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.icon,n.variant&&t[`icon${Rn(n.variant)}`],n.open&&t.iconOpen]}})({}),$re=Dn("input",{shouldForwardProp:e=>Oj(e)&&e!=="classes",name:"MuiSelect",slot:"NativeInput",overridesResolver:(e,t)=>t.nativeInput})({bottom:0,left:0,position:"absolute",opacity:0,pointerEvents:"none",width:"100%",boxSizing:"border-box"});function LF(e,t){return typeof t=="object"&&t!==null?e===t:String(e)===String(t)}function Ure(e){return e==null||typeof e=="string"&&!e.trim()}const Gre=e=>{const{classes:t,variant:n,disabled:s,multiple:a,open:u,error:f}=e,_={select:["select",n,s&&"disabled",a&&"multiple",f&&"error"],icon:["icon",`icon${Rn(n)}`,u&&"iconOpen",s&&"disabled"],nativeInput:["nativeInput"]};return yr(_,Bre,t)},Hre=X.forwardRef(function(t,n){var Rr;const{"aria-describedby":s,"aria-label":a,autoFocus:u,autoWidth:f,children:_,className:r,defaultOpen:C,defaultValue:k,disabled:I,displayEmpty:P,error:D=!1,IconComponent:N,inputRef:j,labelId:W,MenuProps:H={},multiple:q,name:Z,onBlur:re,onChange:le,onClose:_e,onFocus:ye,onOpen:de,open:ce,readOnly:oe,renderValue:xe,SelectDisplayProps:he={},tabIndex:Ee,type:se,value:we,variant:Se="standard",...Pe}=t,[Me,Re]=Qf({controlled:we,default:k,name:"Select"}),[Oe,$e]=Qf({controlled:ce,default:C,name:"Select"}),Ke=X.useRef(null),Ct=X.useRef(null),[Ue,ft]=X.useState(null),{current:Bt}=X.useRef(ce!=null),[hn,ot]=X.useState(),en=mo(n,j),wt=X.useCallback(Wn=>{Ct.current=Wn,Wn&&ft(Wn)},[]),Ne=Ue==null?void 0:Ue.parentNode;X.useImperativeHandle(en,()=>({focus:()=>{Ct.current.focus()},node:Ke.current,value:Me}),[Me]),X.useEffect(()=>{C&&Oe&&Ue&&!Bt&&(ot(f?null:Ne.clientWidth),Ct.current.focus())},[Ue,f]),X.useEffect(()=>{u&&Ct.current.focus()},[u]),X.useEffect(()=>{if(!W)return;const Wn=As(Ct.current).getElementById(W);if(Wn){const Mn=()=>{getSelection().isCollapsed&&Ct.current.focus()};return Wn.addEventListener("click",Mn),()=>{Wn.removeEventListener("click",Mn)}}},[W]);const We=(Wn,Mn)=>{Wn?de&&de(Mn):_e&&_e(Mn),Bt||(ot(f?null:Ne.clientWidth),$e(Wn))},Sn=Wn=>{Wn.button===0&&(Wn.preventDefault(),Ct.current.focus(),We(!0,Wn))},Ae=Wn=>{We(!1,Wn)},st=X.Children.toArray(_),gt=Wn=>{const Mn=st.find(Ar=>Ar.props.value===Wn.target.value);Mn!==void 0&&(Re(Mn.props.value),le&&le(Wn,Mn))},ut=Wn=>Mn=>{let Ar;if(Mn.currentTarget.hasAttribute("tabindex")){if(q){Ar=Array.isArray(Me)?Me.slice():[];const fi=Me.indexOf(Wn.props.value);fi===-1?Ar.push(Wn.props.value):Ar.splice(fi,1)}else Ar=Wn.props.value;if(Wn.props.onClick&&Wn.props.onClick(Mn),Me!==Ar&&(Re(Ar),le)){const fi=Mn.nativeEvent||Mn,yo=new fi.constructor(fi.type,fi);Object.defineProperty(yo,"target",{writable:!0,value:{value:Ar,name:Z}}),le(yo,Wn)}q||We(!1,Mn)}},tt=Wn=>{oe||[" ","ArrowUp","ArrowDown","Enter"].includes(Wn.key)&&(Wn.preventDefault(),We(!0,Wn))},nt=Ue!==null&&Oe,tn=Wn=>{!nt&&re&&(Object.defineProperty(Wn,"target",{writable:!0,value:{value:Me,name:Z}}),re(Wn))};delete Pe["aria-invalid"];let un,qt;const an=[];let Jt=!1;(cC({value:Me})||P)&&(xe?un=xe(Me):Jt=!0);const Wt=st.map(Wn=>{if(!X.isValidElement(Wn))return null;let Mn;if(q){if(!Array.isArray(Me))throw new Error(zh(2));Mn=Me.some(Ar=>LF(Ar,Wn.props.value)),Mn&&Jt&&an.push(Wn.props.children)}else Mn=LF(Me,Wn.props.value),Mn&&Jt&&(qt=Wn.props.children);return X.cloneElement(Wn,{"aria-selected":Mn?"true":"false",onClick:ut(Wn),onKeyUp:Ar=>{Ar.key===" "&&Ar.preventDefault(),Wn.props.onKeyUp&&Wn.props.onKeyUp(Ar)},role:"option",selected:Mn,value:void 0,"data-value":Wn.props.value})});Jt&&(q?an.length===0?un=null:un=an.reduce((Wn,Mn,Ar)=>(Wn.push(Mn),Ar<an.length-1&&Wn.push(", "),Wn),[]):un=qt);let Fn=hn;!f&&Bt&&Ue&&(Fn=Ne.clientWidth);let ar;typeof Ee<"u"?ar=Ee:ar=I?null:0;const bn=he.id||(Z?`mui-component-select-${Z}`:void 0),lr={...t,variant:Se,value:Me,open:nt,error:D},Cn=Gre(lr),xn={...H.PaperProps,...(Rr=H.slotProps)==null?void 0:Rr.paper},Er=ls();return K.jsxs(X.Fragment,{children:[K.jsx(jre,{as:"div",ref:wt,tabIndex:ar,role:"combobox","aria-controls":Er,"aria-disabled":I?"true":void 0,"aria-expanded":nt?"true":"false","aria-haspopup":"listbox","aria-label":a,"aria-labelledby":[W,bn].filter(Boolean).join(" ")||void 0,"aria-describedby":s,onKeyDown:tt,onMouseDown:I||oe?null:Sn,onBlur:tn,onFocus:ye,...he,ownerState:lr,className:Hn(he.className,Cn.select,r),id:bn,children:Ure(un)?AF||(AF=K.jsx("span",{className:"notranslate",children:"​"})):un}),K.jsx($re,{"aria-invalid":D,value:Array.isArray(Me)?Me.join(","):Me,name:Z,ref:Ke,"aria-hidden":!0,onChange:gt,tabIndex:-1,disabled:I,className:Cn.nativeInput,autoFocus:u,...Pe,ownerState:lr}),K.jsx(Vre,{as:N,className:Cn.icon,ownerState:lr}),K.jsx(xre,{id:`menu-${Z||""}`,anchorEl:Ne,open:nt,onClose:Ae,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},...H,MenuListProps:{"aria-labelledby":W,role:"listbox","aria-multiselectable":q?"true":void 0,disableListWrap:!0,id:Er,...H.MenuListProps},slotProps:{...H.slotProps,paper:{...xn,style:{minWidth:Fn,...xn!=null?xn.style:null}}},children:Wt})]})}),Wre=e=>{const{classes:t}=e;return t},xA={name:"MuiSelect",overridesResolver:(e,t)=>t.root,shouldForwardProp:e=>Ha(e)&&e!=="variant",slot:"Root"},qre=Dn(hC,xA)(""),Xre=Dn(fC,xA)(""),Yre=Dn(dC,xA)(""),Zd=X.forwardRef(function(t,n){const s=Rj({name:"MuiSelect",props:t}),{autoWidth:a=!1,children:u,classes:f={},className:_,defaultOpen:r=!1,displayEmpty:C=!1,IconComponent:k=qj,id:I,input:P,inputProps:D,label:N,labelId:j,MenuProps:W,multiple:H=!1,native:q=!1,onClose:Z,onOpen:re,open:le,renderValue:_e,SelectDisplayProps:ye,variant:de="outlined",...ce}=s,oe=q?Mre:Hre,xe=Gh(),he=Bm({props:s,muiFormControl:xe,states:["variant","error"]}),Ee=he.variant||de,se={...s,variant:Ee,classes:f},we=Wre(se),{root:Se,...Pe}=we,Me=P||{standard:K.jsx(qre,{ownerState:se}),outlined:K.jsx(Xre,{label:N,ownerState:se}),filled:K.jsx(Yre,{ownerState:se})}[Ee],Re=mo(n,$h(Me));return K.jsx(X.Fragment,{children:X.cloneElement(Me,{inputComponent:oe,inputProps:{children:u,error:he.error,IconComponent:k,variant:Ee,type:void 0,multiple:H,...q?{id:I}:{autoWidth:a,defaultOpen:r,displayEmpty:C,labelId:j,MenuProps:W,onClose:Z,onOpen:re,open:le,renderValue:_e,SelectDisplayProps:{id:I,...ye}},...D,classes:D?ml(Pe,D.classes):Pe,...P?P.props.inputProps:{}},...(H&&q||C)&&Ee==="outlined"?{notched:!0}:{},ref:Re,className:Hn(Me.props.className,_,we.root),...!P&&{variant:Ee},...ce})})});Zd.muiName="Select";function Zre(e){return gi("MuiSkeleton",e)}pi("MuiSkeleton",["root","text","rectangular","rounded","circular","pulse","wave","withChildren","fitContent","heightAuto"]);const Kre=e=>{const{classes:t,variant:n,animation:s,hasChildren:a,width:u,height:f}=e;return yr({root:["root",n,s,a&&"withChildren",a&&!u&&"fitContent",a&&!f&&"heightAuto"]},Zre,t)},bP=Jd`
  0% {
    opacity: 1;
  }

  50% {
    opacity: 0.4;
  }

  100% {
    opacity: 1;
  }
`,wP=Jd`
  0% {
    transform: translateX(-100%);
  }

  50% {
    /* +0.5s of delay between each loop */
    transform: translateX(100%);
  }

  100% {
    transform: translateX(100%);
  }
`,Jre=typeof bP!="string"?yp`
        animation: ${bP} 2s ease-in-out 0.5s infinite;
      `:null,Qre=typeof wP!="string"?yp`
        &::after {
          animation: ${wP} 2s linear 0.5s infinite;
        }
      `:null,eie=Dn("span",{name:"MuiSkeleton",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.variant],n.animation!==!1&&t[n.animation],n.hasChildren&&t.withChildren,n.hasChildren&&!n.width&&t.fitContent,n.hasChildren&&!n.height&&t.heightAuto]}})($r(({theme:e})=>{const t=eJ(e.shape.borderRadius)||"px",n=tJ(e.shape.borderRadius);return{display:"block",backgroundColor:e.vars?e.vars.palette.Skeleton.bg:vi(e.palette.text.primary,e.palette.mode==="light"?.11:.13),height:"1.2em",variants:[{props:{variant:"text"},style:{marginTop:0,marginBottom:0,height:"auto",transformOrigin:"0 55%",transform:"scale(1, 0.60)",borderRadius:`${n}${t}/${Math.round(n/.6*10)/10}${t}`,"&:empty:before":{content:'"\\00a0"'}}},{props:{variant:"circular"},style:{borderRadius:"50%"}},{props:{variant:"rounded"},style:{borderRadius:(e.vars||e).shape.borderRadius}},{props:({ownerState:s})=>s.hasChildren,style:{"& > *":{visibility:"hidden"}}},{props:({ownerState:s})=>s.hasChildren&&!s.width,style:{maxWidth:"fit-content"}},{props:({ownerState:s})=>s.hasChildren&&!s.height,style:{height:"auto"}},{props:{animation:"pulse"},style:Jre||{animation:`${bP} 2s ease-in-out 0.5s infinite`}},{props:{animation:"wave"},style:{position:"relative",overflow:"hidden",WebkitMaskImage:"-webkit-radial-gradient(white, black)","&::after":{background:`linear-gradient(
                90deg,
                transparent,
                ${(e.vars||e).palette.action.hover},
                transparent
              )`,content:'""',position:"absolute",transform:"translateX(-100%)",bottom:0,left:0,right:0,top:0}}},{props:{animation:"wave"},style:Qre||{"&::after":{animation:`${wP} 2s linear 0.5s infinite`}}}]}})),tie=X.forwardRef(function(t,n){const s=xi({props:t,name:"MuiSkeleton"}),{animation:a="pulse",className:u,component:f="span",height:_,style:r,variant:C="text",width:k,...I}=s,P={...s,animation:a,component:f,variant:C,hasChildren:!!I.children},D=Kre(P);return K.jsx(eie,{as:f,ref:n,className:Hn(D.root,u),ownerState:P,...I,style:{width:k,height:_,...r}})}),nie={entering:{transform:"none"},entered:{transform:"none"}},rie=X.forwardRef(function(t,n){const s=Uh(),a={enter:s.transitions.duration.enteringScreen,exit:s.transitions.duration.leavingScreen},{addEndListener:u,appear:f=!0,children:_,easing:r,in:C,onEnter:k,onEntered:I,onEntering:P,onExit:D,onExited:N,onExiting:j,style:W,timeout:H=a,TransitionComponent:q=bc,...Z}=t,re=X.useRef(null),le=mo(re,$h(_),n),_e=se=>we=>{if(se){const Se=re.current;we===void 0?se(Se):se(Se,we)}},ye=_e(P),de=_e((se,we)=>{IE(se);const Se=ap({style:W,timeout:H,easing:r},{mode:"enter"});se.style.webkitTransition=s.transitions.create("transform",Se),se.style.transition=s.transitions.create("transform",Se),k&&k(se,we)}),ce=_e(I),oe=_e(j),xe=_e(se=>{const we=ap({style:W,timeout:H,easing:r},{mode:"exit"});se.style.webkitTransition=s.transitions.create("transform",we),se.style.transition=s.transitions.create("transform",we),D&&D(se)}),he=_e(N),Ee=se=>{u&&u(re.current,se)};return K.jsx(q,{appear:f,in:C,nodeRef:re,onEnter:de,onEntered:ce,onEntering:ye,onExit:xe,onExited:he,onExiting:oe,addEndListener:Ee,timeout:H,...Z,children:(se,we)=>X.cloneElement(_,{style:{transform:"scale(0)",visibility:se==="exited"&&!C?"hidden":void 0,...nie[se],...W,..._.props.style},ref:le,...we})})});function iie(e){return gi("MuiSpeedDial",e)}const Lw=pi("MuiSpeedDial",["root","fab","directionUp","directionDown","directionLeft","directionRight","actions","actionsClosed"]),oie=e=>{const{classes:t,open:n,direction:s}=e,a={root:["root",`direction${Rn(s)}`],fab:["fab"],actions:["actions",!n&&"actionsClosed"]};return yr(a,iie,t)};function bv(e){if(e==="up"||e==="down")return"vertical";if(e==="right"||e==="left")return"horizontal"}const Mf=32,Rw=16,sie=Dn("div",{name:"MuiSpeedDial",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[`direction${Rn(n.direction)}`]]}})($r(({theme:e})=>({zIndex:(e.vars||e).zIndex.speedDial,display:"flex",alignItems:"center",pointerEvents:"none",variants:[{props:{direction:"up"},style:{flexDirection:"column-reverse",[`& .${Lw.actions}`]:{flexDirection:"column-reverse",marginBottom:-Mf,paddingBottom:Rw+Mf}}},{props:{direction:"down"},style:{flexDirection:"column",[`& .${Lw.actions}`]:{flexDirection:"column",marginTop:-Mf,paddingTop:Rw+Mf}}},{props:{direction:"left"},style:{flexDirection:"row-reverse",[`& .${Lw.actions}`]:{flexDirection:"row-reverse",marginRight:-Mf,paddingRight:Rw+Mf}}},{props:{direction:"right"},style:{flexDirection:"row",[`& .${Lw.actions}`]:{flexDirection:"row",marginLeft:-Mf,paddingLeft:Rw+Mf}}}]}))),aie=Dn(r8,{name:"MuiSpeedDial",slot:"Fab",overridesResolver:(e,t)=>t.fab})({pointerEvents:"auto"}),lie=Dn("div",{name:"MuiSpeedDial",slot:"Actions",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.actions,!n.open&&t.actionsClosed]}})({display:"flex",pointerEvents:"auto",variants:[{props:({ownerState:e})=>!e.open,style:{transition:"top 0s linear 0.2s",pointerEvents:"none"}}]}),uie=X.forwardRef(function(t,n){const s=xi({props:t,name:"MuiSpeedDial"}),a=Uh(),u={enter:a.transitions.duration.enteringScreen,exit:a.transitions.duration.leavingScreen},{ariaLabel:f,FabProps:{ref:_,...r}={},children:C,className:k,direction:I="up",hidden:P=!1,icon:D,onBlur:N,onClose:j,onFocus:W,onKeyDown:H,onMouseEnter:q,onMouseLeave:Z,onOpen:re,open:le,openIcon:_e,slots:ye={},slotProps:de={},TransitionComponent:ce,TransitionProps:oe,transitionDuration:xe=u,...he}=s,[Ee,se]=Qf({controlled:le,default:!1,name:"SpeedDial",state:"open"}),we={...s,open:Ee,direction:I},Se=oie(we),Pe=Eu(),Me=X.useRef(0),Re=X.useRef(),Oe=X.useRef([]);Oe.current=[Oe.current[0]];const $e=X.useCallback(gt=>{Oe.current[0]=gt},[]),Ke=mo(_,$e),Ct=(gt,ut)=>tt=>{Oe.current[gt+1]=tt,ut&&ut(tt)},Ue=gt=>{H&&H(gt);const ut=gt.key.replace("Arrow","").toLowerCase(),{current:tt=ut}=Re;if(gt.key==="Escape"){se(!1),Oe.current[0].focus(),j&&j(gt,"escapeKeyDown");return}if(bv(ut)===bv(tt)&&bv(ut)!==void 0){gt.preventDefault();const nt=ut===tt?1:-1,tn=bj(Me.current+nt,0,Oe.current.length-1);Oe.current[tn].focus(),Me.current=tn,Re.current=tt}};X.useEffect(()=>{Ee||(Me.current=0,Re.current=void 0)},[Ee]);const ft=gt=>{gt.type==="mouseleave"&&Z&&Z(gt),gt.type==="blur"&&N&&N(gt),Pe.clear(),gt.type==="blur"?Pe.start(0,()=>{se(!1),j&&j(gt,"blur")}):(se(!1),j&&j(gt,"mouseLeave"))},Bt=gt=>{r.onClick&&r.onClick(gt),Pe.clear(),Ee?(se(!1),j&&j(gt,"toggle")):(se(!0),re&&re(gt,"toggle"))},hn=gt=>{gt.type==="mouseenter"&&q&&q(gt),gt.type==="focus"&&W&&W(gt),Pe.clear(),Ee||Pe.start(0,()=>{se(!0),re&&re(gt,{focus:"focus",mouseenter:"mouseEnter"}[gt.type])})},ot=f.replace(/^[^a-z]+|[^\w:.-]+/gi,""),en=X.Children.toArray(C).filter(gt=>X.isValidElement(gt)),wt=en.map((gt,ut)=>{const{FabProps:{ref:tt,...nt}={},tooltipPlacement:tn}=gt.props,un=tn||(bv(I)==="vertical"?"left":"top");return X.cloneElement(gt,{FabProps:{...nt,ref:Ct(ut,tt)},delay:30*(Ee?ut:en.length-ut),open:Ee,tooltipPlacement:un,id:`${ot}-action-${ut}`})}),Ne={transition:ce,...ye},We={transition:oe,...de},Sn={slots:Ne,slotProps:We},[Ae,st]=pl("transition",{elementType:rie,externalForwardedProps:Sn,ownerState:we});return K.jsxs(sie,{className:Hn(Se.root,k),ref:n,role:"presentation",onKeyDown:Ue,onBlur:ft,onFocus:hn,onMouseEnter:hn,onMouseLeave:ft,ownerState:we,...he,children:[K.jsx(Ae,{in:!P,timeout:xe,unmountOnExit:!0,...st,children:K.jsx(aie,{color:"primary","aria-label":f,"aria-haspopup":"true","aria-expanded":Ee,"aria-controls":`${ot}-actions`,...r,onClick:Bt,className:Hn(Se.fab,r.className),ref:Ke,ownerState:we,children:X.isValidElement(D)&&pS(D,["SpeedDialIcon"])?X.cloneElement(D,{open:Ee}):D})}),K.jsx(lie,{id:`${ot}-actions`,role:"menu","aria-orientation":bv(I),className:Hn(Se.actions,!Ee&&Se.actionsClosed),ownerState:we,children:wt})]})});function cie(e){return gi("MuiTooltip",e)}const Vs=pi("MuiTooltip",["popper","popperInteractive","popperArrow","popperClose","tooltip","tooltipArrow","touch","tooltipPlacementLeft","tooltipPlacementRight","tooltipPlacementTop","tooltipPlacementBottom","arrow"]);function die(e){return Math.round(e*1e5)/1e5}const hie=e=>{const{classes:t,disableInteractive:n,arrow:s,touch:a,placement:u}=e,f={popper:["popper",!n&&"popperInteractive",s&&"popperArrow"],tooltip:["tooltip",s&&"tooltipArrow",a&&"touch",`tooltipPlacement${Rn(u.split("-")[0])}`],arrow:["arrow"]};return yr(f,cie,t)},fie=Dn(Nm,{name:"MuiTooltip",slot:"Popper",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.popper,!n.disableInteractive&&t.popperInteractive,n.arrow&&t.popperArrow,!n.open&&t.popperClose]}})($r(({theme:e})=>({zIndex:(e.vars||e).zIndex.tooltip,pointerEvents:"none",variants:[{props:({ownerState:t})=>!t.disableInteractive,style:{pointerEvents:"auto"}},{props:({open:t})=>!t,style:{pointerEvents:"none"}},{props:({ownerState:t})=>t.arrow,style:{[`&[data-popper-placement*="bottom"] .${Vs.arrow}`]:{top:0,marginTop:"-0.71em","&::before":{transformOrigin:"0 100%"}},[`&[data-popper-placement*="top"] .${Vs.arrow}`]:{bottom:0,marginBottom:"-0.71em","&::before":{transformOrigin:"100% 0"}},[`&[data-popper-placement*="right"] .${Vs.arrow}`]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"100% 100%"}},[`&[data-popper-placement*="left"] .${Vs.arrow}`]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"0 0"}}}},{props:({ownerState:t})=>t.arrow&&!t.isRtl,style:{[`&[data-popper-placement*="right"] .${Vs.arrow}`]:{left:0,marginLeft:"-0.71em"}}},{props:({ownerState:t})=>t.arrow&&!!t.isRtl,style:{[`&[data-popper-placement*="right"] .${Vs.arrow}`]:{right:0,marginRight:"-0.71em"}}},{props:({ownerState:t})=>t.arrow&&!t.isRtl,style:{[`&[data-popper-placement*="left"] .${Vs.arrow}`]:{right:0,marginRight:"-0.71em"}}},{props:({ownerState:t})=>t.arrow&&!!t.isRtl,style:{[`&[data-popper-placement*="left"] .${Vs.arrow}`]:{left:0,marginLeft:"-0.71em"}}}]}))),pie=Dn("div",{name:"MuiTooltip",slot:"Tooltip",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.tooltip,n.touch&&t.touch,n.arrow&&t.tooltipArrow,t[`tooltipPlacement${Rn(n.placement.split("-")[0])}`]]}})($r(({theme:e})=>({backgroundColor:e.vars?e.vars.palette.Tooltip.bg:vi(e.palette.grey[700],.92),borderRadius:(e.vars||e).shape.borderRadius,color:(e.vars||e).palette.common.white,fontFamily:e.typography.fontFamily,padding:"4px 8px",fontSize:e.typography.pxToRem(11),maxWidth:300,margin:2,wordWrap:"break-word",fontWeight:e.typography.fontWeightMedium,[`.${Vs.popper}[data-popper-placement*="left"] &`]:{transformOrigin:"right center"},[`.${Vs.popper}[data-popper-placement*="right"] &`]:{transformOrigin:"left center"},[`.${Vs.popper}[data-popper-placement*="top"] &`]:{transformOrigin:"center bottom",marginBottom:"14px"},[`.${Vs.popper}[data-popper-placement*="bottom"] &`]:{transformOrigin:"center top",marginTop:"14px"},variants:[{props:({ownerState:t})=>t.arrow,style:{position:"relative",margin:0}},{props:({ownerState:t})=>t.touch,style:{padding:"8px 16px",fontSize:e.typography.pxToRem(14),lineHeight:`${die(16/14)}em`,fontWeight:e.typography.fontWeightRegular}},{props:({ownerState:t})=>!t.isRtl,style:{[`.${Vs.popper}[data-popper-placement*="left"] &`]:{marginRight:"14px"},[`.${Vs.popper}[data-popper-placement*="right"] &`]:{marginLeft:"14px"}}},{props:({ownerState:t})=>!t.isRtl&&t.touch,style:{[`.${Vs.popper}[data-popper-placement*="left"] &`]:{marginRight:"24px"},[`.${Vs.popper}[data-popper-placement*="right"] &`]:{marginLeft:"24px"}}},{props:({ownerState:t})=>!!t.isRtl,style:{[`.${Vs.popper}[data-popper-placement*="left"] &`]:{marginLeft:"14px"},[`.${Vs.popper}[data-popper-placement*="right"] &`]:{marginRight:"14px"}}},{props:({ownerState:t})=>!!t.isRtl&&t.touch,style:{[`.${Vs.popper}[data-popper-placement*="left"] &`]:{marginLeft:"24px"},[`.${Vs.popper}[data-popper-placement*="right"] &`]:{marginRight:"24px"}}},{props:({ownerState:t})=>t.touch,style:{[`.${Vs.popper}[data-popper-placement*="top"] &`]:{marginBottom:"24px"}}},{props:({ownerState:t})=>t.touch,style:{[`.${Vs.popper}[data-popper-placement*="bottom"] &`]:{marginTop:"24px"}}}]}))),mie=Dn("span",{name:"MuiTooltip",slot:"Arrow",overridesResolver:(e,t)=>t.arrow})($r(({theme:e})=>({overflow:"hidden",position:"absolute",width:"1em",height:"0.71em",boxSizing:"border-box",color:e.vars?e.vars.palette.Tooltip.bg:vi(e.palette.grey[700],.9),"&::before":{content:'""',margin:"auto",display:"block",width:"100%",height:"100%",backgroundColor:"currentColor",transform:"rotate(45deg)"}})));let Ow=!1;const RF=new EE;let wv={x:0,y:0};function Dw(e,t){return(n,...s)=>{t&&t(n,...s),e(n,...s)}}const d1=X.forwardRef(function(t,n){var ko,qo,Oo;const s=xi({props:t,name:"MuiTooltip"}),{arrow:a=!1,children:u,classes:f,components:_={},componentsProps:r={},describeChild:C=!1,disableFocusListener:k=!1,disableHoverListener:I=!1,disableInteractive:P=!1,disableTouchListener:D=!1,enterDelay:N=100,enterNextDelay:j=0,enterTouchDelay:W=700,followCursor:H=!1,id:q,leaveDelay:Z=0,leaveTouchDelay:re=1500,onClose:le,onOpen:_e,open:ye,placement:de="bottom",PopperComponent:ce,PopperProps:oe={},slotProps:xe={},slots:he={},title:Ee,TransitionComponent:se=i0,TransitionProps:we,...Se}=s,Pe=X.isValidElement(u)?u:K.jsx("span",{children:u}),Me=Uh(),Re=au(),[Oe,$e]=X.useState(),[Ke,Ct]=X.useState(null),Ue=X.useRef(!1),ft=P||H,Bt=Eu(),hn=Eu(),ot=Eu(),en=Eu(),[wt,Ne]=Qf({controlled:ye,default:!1,name:"Tooltip",state:"open"});let We=wt;const Sn=ls(q),Ae=X.useRef(),st=Ui(()=>{Ae.current!==void 0&&(document.body.style.WebkitUserSelect=Ae.current,Ae.current=void 0),en.clear()});X.useEffect(()=>st,[st]);const gt=Pn=>{RF.clear(),Ow=!0,Ne(!0),_e&&!We&&_e(Pn)},ut=Ui(Pn=>{RF.start(800+Z,()=>{Ow=!1}),Ne(!1),le&&We&&le(Pn),Bt.start(Me.transitions.duration.shortest,()=>{Ue.current=!1})}),tt=Pn=>{Ue.current&&Pn.type!=="touchstart"||(Oe&&Oe.removeAttribute("title"),hn.clear(),ot.clear(),N||Ow&&j?hn.start(Ow?j:N,()=>{gt(Pn)}):gt(Pn))},nt=Pn=>{hn.clear(),ot.start(Z,()=>{ut(Pn)})},[,tn]=X.useState(!1),un=Pn=>{oC(Pn.target)||(tn(!1),nt(Pn))},qt=Pn=>{Oe||$e(Pn.currentTarget),oC(Pn.target)&&(tn(!0),tt(Pn))},an=Pn=>{Ue.current=!0;const Vt=Pe.props;Vt.onTouchStart&&Vt.onTouchStart(Pn)},Jt=Pn=>{an(Pn),ot.clear(),Bt.clear(),st(),Ae.current=document.body.style.WebkitUserSelect,document.body.style.WebkitUserSelect="none",en.start(W,()=>{document.body.style.WebkitUserSelect=Ae.current,tt(Pn)})},Wt=Pn=>{Pe.props.onTouchEnd&&Pe.props.onTouchEnd(Pn),st(),ot.start(re,()=>{ut(Pn)})};X.useEffect(()=>{if(!We)return;function Pn(Vt){Vt.key==="Escape"&&ut(Vt)}return document.addEventListener("keydown",Pn),()=>{document.removeEventListener("keydown",Pn)}},[ut,We]);const Fn=mo($h(Pe),$e,n);!Ee&&Ee!==0&&(We=!1);const ar=X.useRef(),bn=Pn=>{const Vt=Pe.props;Vt.onMouseMove&&Vt.onMouseMove(Pn),wv={x:Pn.clientX,y:Pn.clientY},ar.current&&ar.current.update()},lr={},Cn=typeof Ee=="string";C?(lr.title=!We&&Cn&&!I?Ee:null,lr["aria-describedby"]=We?Sn:null):(lr["aria-label"]=Cn?Ee:null,lr["aria-labelledby"]=We&&!Cn?Sn:null);const xn={...lr,...Se,...Pe.props,className:Hn(Se.className,Pe.props.className),onTouchStart:an,ref:Fn,...H?{onMouseMove:bn}:{}},Er={};D||(xn.onTouchStart=Jt,xn.onTouchEnd=Wt),I||(xn.onMouseOver=Dw(tt,xn.onMouseOver),xn.onMouseLeave=Dw(nt,xn.onMouseLeave),ft||(Er.onMouseOver=tt,Er.onMouseLeave=nt)),k||(xn.onFocus=Dw(qt,xn.onFocus),xn.onBlur=Dw(un,xn.onBlur),ft||(Er.onFocus=qt,Er.onBlur=un));const Rr=X.useMemo(()=>{var Vt;let Pn=[{name:"arrow",enabled:!!Ke,options:{element:Ke,padding:4}}];return(Vt=oe.popperOptions)!=null&&Vt.modifiers&&(Pn=Pn.concat(oe.popperOptions.modifiers)),{...oe.popperOptions,modifiers:Pn}},[Ke,oe]),Wn={...s,isRtl:Re,arrow:a,disableInteractive:ft,placement:de,PopperComponentProp:ce,touch:Ue.current},Mn=hie(Wn),Ar=he.popper??_.Popper??fie,fi=he.transition??_.Transition??se??i0,yo=he.tooltip??_.Tooltip??pie,vr=he.arrow??_.Arrow??mie,zi=xy(Ar,{...oe,...xe.popper??r.popper,className:Hn(Mn.popper,oe==null?void 0:oe.className,(ko=xe.popper??r.popper)==null?void 0:ko.className)},Wn),Li=xy(fi,{...we,...xe.transition??r.transition},Wn),mi=xy(yo,{...xe.tooltip??r.tooltip,className:Hn(Mn.tooltip,(qo=xe.tooltip??r.tooltip)==null?void 0:qo.className)},Wn),ji=xy(vr,{...xe.arrow??r.arrow,className:Hn(Mn.arrow,(Oo=xe.arrow??r.arrow)==null?void 0:Oo.className)},Wn);return K.jsxs(X.Fragment,{children:[X.cloneElement(Pe,xn),K.jsx(Ar,{as:ce??Nm,placement:de,anchorEl:H?{getBoundingClientRect:()=>({top:wv.y,left:wv.x,right:wv.x,bottom:wv.y,width:0,height:0})}:Oe,popperRef:ar,open:Oe?We:!1,id:Sn,transition:!0,...Er,...zi,popperOptions:Rr,children:({TransitionProps:Pn})=>K.jsx(fi,{timeout:Me.transitions.duration.shorter,...Pn,...Li,children:K.jsxs(yo,{...mi,children:[Ee,a?K.jsx(vr,{...ji,ref:Ct}):null]})})})]})});function gie(e){return gi("MuiSpeedDialAction",e)}const zw=pi("MuiSpeedDialAction",["fab","fabClosed","staticTooltip","staticTooltipClosed","staticTooltipLabel","tooltipPlacementLeft","tooltipPlacementRight"]),yie=e=>{const{open:t,tooltipPlacement:n,classes:s}=e,a={fab:["fab",!t&&"fabClosed"],staticTooltip:["staticTooltip",`tooltipPlacement${Rn(n)}`,!t&&"staticTooltipClosed"],staticTooltipLabel:["staticTooltipLabel"]};return yr(a,gie,s)},_ie=Dn(r8,{name:"MuiSpeedDialAction",slot:"Fab",skipVariantsResolver:!1,overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.fab,!n.open&&t.fabClosed]}})($r(({theme:e})=>({margin:8,color:(e.vars||e).palette.text.secondary,backgroundColor:(e.vars||e).palette.background.paper,"&:hover":{backgroundColor:e.vars?e.vars.palette.SpeedDialAction.fabHoverBg:Sj(e.palette.background.paper,.15)},transition:`${e.transitions.create("transform",{duration:e.transitions.duration.shorter})}, opacity 0.8s`,opacity:1,variants:[{props:({ownerState:t})=>!t.open,style:{opacity:0,transform:"scale(0)"}}]}))),vie=Dn("span",{name:"MuiSpeedDialAction",slot:"StaticTooltip",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.staticTooltip,!n.open&&t.staticTooltipClosed,t[`tooltipPlacement${Rn(n.tooltipPlacement)}`]]}})($r(({theme:e})=>({position:"relative",display:"flex",alignItems:"center",[`& .${zw.staticTooltipLabel}`]:{transition:e.transitions.create(["transform","opacity"],{duration:e.transitions.duration.shorter}),opacity:1},variants:[{props:({ownerState:t})=>!t.open,style:{[`& .${zw.staticTooltipLabel}`]:{opacity:0,transform:"scale(0.5)"}}},{props:{tooltipPlacement:"left"},style:{[`& .${zw.staticTooltipLabel}`]:{transformOrigin:"100% 50%",right:"100%",marginRight:8}}},{props:{tooltipPlacement:"right"},style:{[`& .${zw.staticTooltipLabel}`]:{transformOrigin:"0% 50%",left:"100%",marginLeft:8}}}]}))),xie=Dn("span",{name:"MuiSpeedDialAction",slot:"StaticTooltipLabel",overridesResolver:(e,t)=>t.staticTooltipLabel})($r(({theme:e})=>({position:"absolute",...e.typography.body1,backgroundColor:(e.vars||e).palette.background.paper,borderRadius:(e.vars||e).shape.borderRadius,boxShadow:(e.vars||e).shadows[1],color:(e.vars||e).palette.text.secondary,padding:"4px 16px",wordBreak:"keep-all"}))),bie=X.forwardRef(function(t,n){const s=xi({props:t,name:"MuiSpeedDialAction"}),{className:a,delay:u=0,FabProps:f={},icon:_,id:r,open:C,TooltipClasses:k,tooltipOpen:I=!1,tooltipPlacement:P="left",tooltipTitle:D,...N}=s,j={...s,tooltipPlacement:P},W=yie(j),[H,q]=X.useState(I),Z=()=>{q(!1)},re=()=>{q(!0)},le={transitionDelay:`${u}ms`},_e=K.jsx(_ie,{size:"small",className:Hn(W.fab,a),tabIndex:-1,role:"menuitem",ownerState:j,...f,style:{...le,...f.style},children:_});return I?K.jsxs(vie,{id:r,ref:n,className:W.staticTooltip,ownerState:j,...N,children:[K.jsx(xie,{style:le,id:`${r}-label`,className:W.staticTooltipLabel,ownerState:j,children:D}),X.cloneElement(_e,{"aria-labelledby":`${r}-label`})]}):(!C&&H&&q(!1),K.jsx(d1,{id:r,ref:n,title:D,placement:P,onClose:Z,onOpen:re,open:C&&H,classes:k,...N,children:_e}))});function wie(e){return gi("MuiSwitch",e)}const Ml=pi("MuiSwitch",["root","edgeStart","edgeEnd","switchBase","colorPrimary","colorSecondary","sizeSmall","sizeMedium","checked","disabled","input","thumb","track"]),Sie=e=>{const{classes:t,edge:n,size:s,color:a,checked:u,disabled:f}=e,_={root:["root",n&&`edge${Rn(n)}`,`size${Rn(s)}`],switchBase:["switchBase",`color${Rn(a)}`,u&&"checked",f&&"disabled"],thumb:["thumb"],track:["track"],input:["input"]},r=yr(_,wie,t);return{...t,...r}},Cie=Dn("span",{name:"MuiSwitch",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.edge&&t[`edge${Rn(n.edge)}`],t[`size${Rn(n.size)}`]]}})({display:"inline-flex",width:34+12*2,height:14+12*2,overflow:"hidden",padding:12,boxSizing:"border-box",position:"relative",flexShrink:0,zIndex:0,verticalAlign:"middle","@media print":{colorAdjust:"exact"},variants:[{props:{edge:"start"},style:{marginLeft:-8}},{props:{edge:"end"},style:{marginRight:-8}},{props:{size:"small"},style:{width:40,height:24,padding:7,[`& .${Ml.thumb}`]:{width:16,height:16},[`& .${Ml.switchBase}`]:{padding:4,[`&.${Ml.checked}`]:{transform:"translateX(16px)"}}}}]}),Eie=Dn(Kj,{name:"MuiSwitch",slot:"SwitchBase",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.switchBase,{[`& .${Ml.input}`]:t.input},n.color!=="default"&&t[`color${Rn(n.color)}`]]}})($r(({theme:e})=>({position:"absolute",top:0,left:0,zIndex:1,color:e.vars?e.vars.palette.Switch.defaultColor:`${e.palette.mode==="light"?e.palette.common.white:e.palette.grey[300]}`,transition:e.transitions.create(["left","transform"],{duration:e.transitions.duration.shortest}),[`&.${Ml.checked}`]:{transform:"translateX(20px)"},[`&.${Ml.disabled}`]:{color:e.vars?e.vars.palette.Switch.defaultDisabledColor:`${e.palette.mode==="light"?e.palette.grey[100]:e.palette.grey[600]}`},[`&.${Ml.checked} + .${Ml.track}`]:{opacity:.5},[`&.${Ml.disabled} + .${Ml.track}`]:{opacity:e.vars?e.vars.opacity.switchTrackDisabled:`${e.palette.mode==="light"?.12:.2}`},[`& .${Ml.input}`]:{left:"-100%",width:"300%"}})),$r(({theme:e})=>({"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.activeChannel} / ${e.vars.palette.action.hoverOpacity})`:vi(e.palette.action.active,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},variants:[...Object.entries(e.palette).filter(Ms(["light"])).map(([t])=>({props:{color:t},style:{[`&.${Ml.checked}`]:{color:(e.vars||e).palette[t].main,"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette[t].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:vi(e.palette[t].main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${Ml.disabled}`]:{color:e.vars?e.vars.palette.Switch[`${t}DisabledColor`]:`${e.palette.mode==="light"?Fm(e.palette[t].main,.62):zm(e.palette[t].main,.55)}`}},[`&.${Ml.checked} + .${Ml.track}`]:{backgroundColor:(e.vars||e).palette[t].main}}}))]}))),Tie=Dn("span",{name:"MuiSwitch",slot:"Track",overridesResolver:(e,t)=>t.track})($r(({theme:e})=>({height:"100%",width:"100%",borderRadius:14/2,zIndex:-1,transition:e.transitions.create(["opacity","background-color"],{duration:e.transitions.duration.shortest}),backgroundColor:e.vars?e.vars.palette.common.onBackground:`${e.palette.mode==="light"?e.palette.common.black:e.palette.common.white}`,opacity:e.vars?e.vars.opacity.switchTrack:`${e.palette.mode==="light"?.38:.3}`}))),Iie=Dn("span",{name:"MuiSwitch",slot:"Thumb",overridesResolver:(e,t)=>t.thumb})($r(({theme:e})=>({boxShadow:(e.vars||e).shadows[1],backgroundColor:"currentColor",width:20,height:20,borderRadius:"50%"}))),kie=X.forwardRef(function(t,n){const s=xi({props:t,name:"MuiSwitch"}),{className:a,color:u="primary",edge:f=!1,size:_="medium",sx:r,...C}=s,k={...s,color:u,edge:f,size:_},I=Sie(k),P=K.jsx(Iie,{className:I.thumb,ownerState:k});return K.jsxs(Cie,{className:Hn(I.root,a),sx:r,ownerState:k,children:[K.jsx(Eie,{type:"checkbox",icon:P,checkedIcon:P,ref:n,ownerState:k,...C,classes:{...I,root:I.switchBase}}),K.jsx(Tie,{className:I.track,ownerState:k})]})}),Mie=X.createContext(),Pie=X.createContext();function Aie(e){return gi("MuiTableCell",e)}const Lie=pi("MuiTableCell",["root","head","body","footer","sizeSmall","sizeMedium","paddingCheckbox","paddingNone","alignLeft","alignCenter","alignRight","alignJustify","stickyHeader"]),Rie=e=>{const{classes:t,variant:n,align:s,padding:a,size:u,stickyHeader:f}=e,_={root:["root",n,f&&"stickyHeader",s!=="inherit"&&`align${Rn(s)}`,a!=="normal"&&`padding${Rn(a)}`,`size${Rn(u)}`]};return yr(_,Aie,t)},Oie=Dn("td",{name:"MuiTableCell",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.variant],t[`size${Rn(n.size)}`],n.padding!=="normal"&&t[`padding${Rn(n.padding)}`],n.align!=="inherit"&&t[`align${Rn(n.align)}`],n.stickyHeader&&t.stickyHeader]}})($r(({theme:e})=>({...e.typography.body2,display:"table-cell",verticalAlign:"inherit",borderBottom:e.vars?`1px solid ${e.vars.palette.TableCell.border}`:`1px solid
    ${e.palette.mode==="light"?Fm(vi(e.palette.divider,1),.88):zm(vi(e.palette.divider,1),.68)}`,textAlign:"left",padding:16,variants:[{props:{variant:"head"},style:{color:(e.vars||e).palette.text.primary,lineHeight:e.typography.pxToRem(24),fontWeight:e.typography.fontWeightMedium}},{props:{variant:"body"},style:{color:(e.vars||e).palette.text.primary}},{props:{variant:"footer"},style:{color:(e.vars||e).palette.text.secondary,lineHeight:e.typography.pxToRem(21),fontSize:e.typography.pxToRem(12)}},{props:{size:"small"},style:{padding:"6px 16px",[`&.${Lie.paddingCheckbox}`]:{width:24,padding:"0 12px 0 16px","& > *":{padding:0}}}},{props:{padding:"checkbox"},style:{width:48,padding:"0 0 0 4px"}},{props:{padding:"none"},style:{padding:0}},{props:{align:"left"},style:{textAlign:"left"}},{props:{align:"center"},style:{textAlign:"center"}},{props:{align:"right"},style:{textAlign:"right",flexDirection:"row-reverse"}},{props:{align:"justify"},style:{textAlign:"justify"}},{props:({ownerState:t})=>t.stickyHeader,style:{position:"sticky",top:0,zIndex:2,backgroundColor:(e.vars||e).palette.background.default}}]}))),SP=X.forwardRef(function(t,n){const s=xi({props:t,name:"MuiTableCell"}),{align:a="inherit",className:u,component:f,padding:_,scope:r,size:C,sortDirection:k,variant:I,...P}=s,D=X.useContext(Mie),N=X.useContext(Pie),j=N&&N.variant==="head";let W;f?W=f:W=j?"th":"td";let H=r;W==="td"?H=void 0:!H&&j&&(H="col");const q=I||N&&N.variant,Z={...s,align:a,component:W,padding:_||(D&&D.padding?D.padding:"normal"),size:C||(D&&D.size?D.size:"medium"),sortDirection:k,stickyHeader:q==="head"&&D&&D.stickyHeader,variant:q},re=Rie(Z);let le=null;return k&&(le=k==="asc"?"ascending":"descending"),K.jsx(Oie,{as:W,ref:n,className:Hn(re.root,u),"aria-sort":le,scope:H,ownerState:Z,...P})});function Die(e){return gi("MuiToolbar",e)}pi("MuiToolbar",["root","gutters","regular","dense"]);const zie=e=>{const{classes:t,disableGutters:n,variant:s}=e;return yr({root:["root",!n&&"gutters",s]},Die,t)},Fie=Dn("div",{name:"MuiToolbar",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,!n.disableGutters&&t.gutters,t[n.variant]]}})($r(({theme:e})=>({position:"relative",display:"flex",alignItems:"center",variants:[{props:({ownerState:t})=>!t.disableGutters,style:{paddingLeft:e.spacing(2),paddingRight:e.spacing(2),[e.breakpoints.up("sm")]:{paddingLeft:e.spacing(3),paddingRight:e.spacing(3)}}},{props:{variant:"dense"},style:{minHeight:48}},{props:{variant:"regular"},style:e.mixins.toolbar}]}))),u8=X.forwardRef(function(t,n){const s=xi({props:t,name:"MuiToolbar"}),{className:a,component:u="div",disableGutters:f=!1,variant:_="regular",...r}=s,C={...s,component:u,disableGutters:f,variant:_},k=zie(C);return K.jsx(Fie,{as:u,className:Hn(k.root,a),ref:n,ownerState:C,...r})}),Nie=Jr(K.jsx("path",{d:"M15.41 16.09l-4.58-4.59 4.58-4.59L14 5.5l-6 6 6 6z"}),"KeyboardArrowLeft"),Bie=Jr(K.jsx("path",{d:"M8.59 16.34l4.58-4.59-4.58-4.59L10 5.75l6 6-6 6z"}),"KeyboardArrowRight"),jie=X.forwardRef(function(t,n){const{backIconButtonProps:s,count:a,disabled:u=!1,getItemAriaLabel:f,nextIconButtonProps:_,onPageChange:r,page:C,rowsPerPage:k,showFirstButton:I,showLastButton:P,slots:D={},slotProps:N={},...j}=t,W=au(),H=$e=>{r($e,0)},q=$e=>{r($e,C-1)},Z=$e=>{r($e,C+1)},re=$e=>{r($e,Math.max(0,Math.ceil(a/k)-1))},le=D.firstButton??ga,_e=D.lastButton??ga,ye=D.nextButton??ga,de=D.previousButton??ga,ce=D.firstButtonIcon??Fre,oe=D.lastButtonIcon??Nre,xe=D.nextButtonIcon??Bie,he=D.previousButtonIcon??Nie,Ee=W?_e:le,se=W?ye:de,we=W?de:ye,Se=W?le:_e,Pe=W?N.lastButton:N.firstButton,Me=W?N.nextButton:N.previousButton,Re=W?N.previousButton:N.nextButton,Oe=W?N.firstButton:N.lastButton;return K.jsxs("div",{ref:n,...j,children:[I&&K.jsx(Ee,{onClick:H,disabled:u||C===0,"aria-label":f("first",C),title:f("first",C),...Pe,children:W?K.jsx(oe,{...N.lastButtonIcon}):K.jsx(ce,{...N.firstButtonIcon})}),K.jsx(se,{onClick:q,disabled:u||C===0,color:"inherit","aria-label":f("previous",C),title:f("previous",C),...Me??s,children:W?K.jsx(xe,{...N.nextButtonIcon}):K.jsx(he,{...N.previousButtonIcon})}),K.jsx(we,{onClick:Z,disabled:u||(a!==-1?C>=Math.ceil(a/k)-1:!1),color:"inherit","aria-label":f("next",C),title:f("next",C),...Re??_,children:W?K.jsx(he,{...N.previousButtonIcon}):K.jsx(xe,{...N.nextButtonIcon})}),P&&K.jsx(Se,{onClick:re,disabled:u||C>=Math.ceil(a/k)-1,"aria-label":f("last",C),title:f("last",C),...Oe,children:W?K.jsx(ce,{...N.firstButtonIcon}):K.jsx(oe,{...N.lastButtonIcon})})]})});function Vie(e){return gi("MuiTablePagination",e)}const _m=pi("MuiTablePagination",["root","toolbar","spacer","selectLabel","selectRoot","select","selectIcon","input","menuItem","displayedRows","actions"]);var OF;const $ie=Dn(SP,{name:"MuiTablePagination",slot:"Root",overridesResolver:(e,t)=>t.root})($r(({theme:e})=>({overflow:"auto",color:(e.vars||e).palette.text.primary,fontSize:e.typography.pxToRem(14),"&:last-child":{padding:0}}))),Uie=Dn(u8,{name:"MuiTablePagination",slot:"Toolbar",overridesResolver:(e,t)=>({[`& .${_m.actions}`]:t.actions,...t.toolbar})})($r(({theme:e})=>({minHeight:52,paddingRight:2,[`${e.breakpoints.up("xs")} and (orientation: landscape)`]:{minHeight:52},[e.breakpoints.up("sm")]:{minHeight:52,paddingRight:2},[`& .${_m.actions}`]:{flexShrink:0,marginLeft:20}}))),Gie=Dn("div",{name:"MuiTablePagination",slot:"Spacer",overridesResolver:(e,t)=>t.spacer})({flex:"1 1 100%"}),Hie=Dn("p",{name:"MuiTablePagination",slot:"SelectLabel",overridesResolver:(e,t)=>t.selectLabel})($r(({theme:e})=>({...e.typography.body2,flexShrink:0}))),Wie=Dn(Zd,{name:"MuiTablePagination",slot:"Select",overridesResolver:(e,t)=>({[`& .${_m.selectIcon}`]:t.selectIcon,[`& .${_m.select}`]:t.select,...t.input,...t.selectRoot})})({color:"inherit",fontSize:"inherit",flexShrink:0,marginRight:32,marginLeft:8,[`& .${_m.select}`]:{paddingLeft:8,paddingRight:24,textAlign:"right",textAlignLast:"right"}}),qie=Dn(gl,{name:"MuiTablePagination",slot:"MenuItem",overridesResolver:(e,t)=>t.menuItem})({}),Xie=Dn("p",{name:"MuiTablePagination",slot:"DisplayedRows",overridesResolver:(e,t)=>t.displayedRows})($r(({theme:e})=>({...e.typography.body2,flexShrink:0})));function Yie({from:e,to:t,count:n}){return`${e}–${t} of ${n!==-1?n:`more than ${t}`}`}function Zie(e){return`Go to ${e} page`}const Kie=e=>{const{classes:t}=e;return yr({root:["root"],toolbar:["toolbar"],spacer:["spacer"],selectLabel:["selectLabel"],select:["select"],input:["input"],selectIcon:["selectIcon"],menuItem:["menuItem"],displayedRows:["displayedRows"],actions:["actions"]},Vie,t)},Jie=X.forwardRef(function(t,n){const s=xi({props:t,name:"MuiTablePagination"}),{ActionsComponent:a=jie,backIconButtonProps:u,className:f,colSpan:_,component:r=SP,count:C,disabled:k=!1,getItemAriaLabel:I=Zie,labelDisplayedRows:P=Yie,labelRowsPerPage:D="Rows per page:",nextIconButtonProps:N,onPageChange:j,onRowsPerPageChange:W,page:H,rowsPerPage:q,rowsPerPageOptions:Z=[10,25,50,100],SelectProps:re={},showFirstButton:le=!1,showLastButton:_e=!1,slotProps:ye={},slots:de={},...ce}=s,oe=s,xe=Kie(oe),he=(ye==null?void 0:ye.select)??re,Ee=he.native?"option":qie;let se;(r===SP||r==="td")&&(se=_||1e3);const we=ls(he.id),Se=ls(he.labelId),Pe=()=>C===-1?(H+1)*q:q===-1?C:Math.min(C,(H+1)*q);return K.jsx($ie,{colSpan:se,ref:n,as:r,ownerState:oe,className:Hn(xe.root,f),...ce,children:K.jsxs(Uie,{className:xe.toolbar,children:[K.jsx(Gie,{className:xe.spacer}),Z.length>1&&K.jsx(Hie,{className:xe.selectLabel,id:Se,children:D}),Z.length>1&&K.jsx(Wie,{variant:"standard",...!he.variant&&{input:OF||(OF=K.jsx(w0,{}))},value:q,onChange:W,id:we,labelId:Se,...he,classes:{...he.classes,root:Hn(xe.input,xe.selectRoot,(he.classes||{}).root),select:Hn(xe.select,(he.classes||{}).select),icon:Hn(xe.selectIcon,(he.classes||{}).icon)},disabled:k,children:Z.map(Me=>X.createElement(Ee,{...!uC(Ee)&&{ownerState:oe},className:xe.menuItem,key:Me.label?Me.label:Me,value:Me.value?Me.value:Me},Me.label?Me.label:Me))}),K.jsx(Xie,{className:xe.displayedRows,children:P({from:C===0?0:H*q+1,to:Pe(),count:C===-1?-1:C,page:H})}),K.jsx(a,{className:xe.actions,backIconButtonProps:u,count:C,nextIconButtonProps:N,onPageChange:j,page:H,rowsPerPage:q,showFirstButton:le,showLastButton:_e,slotProps:ye.actions,slots:de.actions,getItemAriaLabel:I,disabled:k})]})})});function Qie(e){return gi("MuiTextField",e)}pi("MuiTextField",["root"]);const eoe={standard:hC,filled:dC,outlined:fC},toe=e=>{const{classes:t}=e;return yr({root:["root"]},Qie,t)},noe=Dn(up,{name:"MuiTextField",slot:"Root",overridesResolver:(e,t)=>t.root})({}),c8=X.forwardRef(function(t,n){const s=xi({props:t,name:"MuiTextField"}),{autoComplete:a,autoFocus:u=!1,children:f,className:_,color:r="primary",defaultValue:C,disabled:k=!1,error:I=!1,FormHelperTextProps:P,fullWidth:D=!1,helperText:N,id:j,InputLabelProps:W,inputProps:H,InputProps:q,inputRef:Z,label:re,maxRows:le,minRows:_e,multiline:ye=!1,name:de,onBlur:ce,onChange:oe,onFocus:xe,placeholder:he,required:Ee=!1,rows:se,select:we=!1,SelectProps:Se,slots:Pe={},slotProps:Me={},type:Re,value:Oe,variant:$e="outlined",...Ke}=s,Ct={...s,autoFocus:u,color:r,disabled:k,error:I,fullWidth:D,multiline:ye,required:Ee,select:we,variant:$e},Ue=toe(Ct),ft=ls(j),Bt=N&&ft?`${ft}-helper-text`:void 0,hn=re&&ft?`${ft}-label`:void 0,ot=eoe[$e],en={slots:Pe,slotProps:{input:q,inputLabel:W,htmlInput:H,formHelperText:P,select:Se,...Me}},wt={},Ne=en.slotProps.inputLabel;$e==="outlined"&&(Ne&&typeof Ne.shrink<"u"&&(wt.notched=Ne.shrink),wt.label=re),we&&((!Se||!Se.native)&&(wt.id=void 0),wt["aria-describedby"]=void 0);const[We,Sn]=pl("input",{elementType:ot,externalForwardedProps:en,additionalProps:wt,ownerState:Ct}),[Ae,st]=pl("inputLabel",{elementType:cp,externalForwardedProps:en,ownerState:Ct}),[gt,ut]=pl("htmlInput",{elementType:"input",externalForwardedProps:en,ownerState:Ct}),[tt,nt]=pl("formHelperText",{elementType:wne,externalForwardedProps:en,ownerState:Ct}),[tn,un]=pl("select",{elementType:Zd,externalForwardedProps:en,ownerState:Ct}),qt=K.jsx(We,{"aria-describedby":Bt,autoComplete:a,autoFocus:u,defaultValue:C,fullWidth:D,multiline:ye,name:de,rows:se,maxRows:le,minRows:_e,type:Re,value:Oe,id:ft,inputRef:Z,onBlur:ce,onChange:oe,onFocus:xe,placeholder:he,inputProps:ut,slots:{input:Pe.htmlInput?gt:void 0},...Sn});return K.jsxs(noe,{className:Hn(Ue.root,_),disabled:k,error:I,fullWidth:D,ref:n,required:Ee,color:r,variant:$e,ownerState:Ct,...Ke,children:[re!=null&&re!==""&&K.jsx(Ae,{htmlFor:ft,id:hn,...st,children:re}),we?K.jsx(tn,{"aria-describedby":Bt,id:ft,labelId:hn,value:Oe,input:qt,...un,children:f}):qt,N&&K.jsx(tt,{id:Bt,...nt,children:N})]})}),roe=Jr(K.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add"),ioe=Jr(K.jsx("path",{d:"m12 4-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"}),"ArrowForward"),ooe=Jr(K.jsx("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2m5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12z"}),"Cancel"),soe=Jr(K.jsx("path",{d:"M12 7.77 18.39 18H5.61zM12 4 2 20h20z"}),"ChangeHistory"),aoe=Jr(K.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8z"}),"CheckCircle"),loe=Jr(K.jsx("path",{d:"M15.41 7.41 14 6l-6 6 6 6 1.41-1.41L10.83 12z"}),"ChevronLeft"),h1=Jr(K.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close"),uoe=Jr(K.jsx("path",{d:"M9.64 7.64c.23-.5.36-1.05.36-1.64 0-2.21-1.79-4-4-4S2 3.79 2 6s1.79 4 4 4c.59 0 1.14-.13 1.64-.36L10 12l-2.36 2.36C7.14 14.13 6.59 14 6 14c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4c0-.59-.13-1.14-.36-1.64L12 14l7 7h3v-1zM6 8c-1.1 0-2-.89-2-2s.9-2 2-2 2 .89 2 2-.9 2-2 2m0 12c-1.1 0-2-.89-2-2s.9-2 2-2 2 .89 2 2-.9 2-2 2m6-7.5c-.28 0-.5-.22-.5-.5s.22-.5.5-.5.5.22.5.5-.22.5-.5.5M19 3l-6 6 2 2 7-7V3z"}),"ContentCut"),coe=Jr(K.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete"),doe=Jr(K.jsx("path",{d:"M5 20h14v-2H5zM19 9h-4V3H9v6H5l7 7z"}),"Download"),DF=Jr(K.jsx("path",{d:"M10.09 15.59 11.5 17l5-5-5-5-1.41 1.41L12.67 11H3v2h9.67zM19 3H5c-1.11 0-2 .9-2 2v4h2V5h14v14H5v-4H3v4c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2"}),"ExitToApp"),hoe=Jr(K.jsx("circle",{cx:"12",cy:"12",r:"8"}),"FiberManualRecord"),foe=Jr(K.jsx("path",{d:"M4.25 5.61C6.27 8.2 10 13 10 13v6c0 .55.45 1 1 1h2c.55 0 1-.45 1-1v-6s3.72-4.8 5.74-7.39c.51-.66.04-1.61-.79-1.61H5.04c-.83 0-1.3.95-.79 1.61"}),"FilterAlt"),Vc=Jr(K.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 17h-2v-2h2zm2.07-7.75-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25"}),"Help"),poe=Jr(K.jsx("path",{d:"m20.5 3-.16.03L15 5.1 9 3 3.36 4.9c-.21.07-.36.25-.36.48V20.5c0 .28.22.5.5.5l.16-.03L9 18.9l6 2.1 5.64-1.9c.21-.07.36-.25.36-.48V3.5c0-.28-.22-.5-.5-.5M15 19l-6-2.11V5l6 2.11z"}),"Map"),moe=Jr(K.jsx("path",{d:"M6 19h4V5H6zm8-14v14h4V5z"}),"Pause"),zF=Jr(K.jsx("path",{d:"M8 5v14l11-7z"}),"PlayArrow"),FF=Jr(K.jsx("path",{d:"M12 5V2L8 6l4 4V7c3.31 0 6 2.69 6 6 0 2.97-2.17 5.43-5 5.91v2.02c3.95-.49 7-3.85 7-7.93 0-4.42-3.58-8-8-8m-6 8c0-1.65.67-3.15 1.76-4.24L6.34 7.34C4.9 8.79 4 10.79 4 13c0 4.08 3.05 7.44 7 7.93v-2.02c-2.83-.48-5-2.94-5-5.91"}),"RestartAlt"),goe=Jr(K.jsx("path",{d:"M5 13.18v4L12 21l7-3.82v-4L12 17zM12 3 1 9l11 6 9-4.91V17h2V9z"}),"School"),yoe=Jr(K.jsx("path",{d:"M19 7H9c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V9c0-1.1-.9-2-2-2m0 2v2H9V9zm-6 6v-2h2v2zm2 2v2h-2v-2zm-4-2H9v-2h2zm6-2h2v2h-2zm-8 4h2v2H9zm8 2v-2h2v2zM6 17H5c-1.1 0-2-.9-2-2V5c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2v1h-2V5H5v10h1z"}),"TableView"),_oe=Jr(K.jsx("path",{d:"M23 8c0 1.1-.9 2-2 2-.18 0-.35-.02-.51-.07l-3.56 3.55c.05.16.07.34.07.52 0 1.1-.9 2-2 2s-2-.9-2-2c0-.18.02-.36.07-.52l-2.55-2.55c-.16.05-.34.07-.52.07s-.36-.02-.52-.07l-4.55 4.56c.05.16.07.33.07.51 0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2c.18 0 .35.02.51.07l4.56-4.55C8.02 9.36 8 9.18 8 9c0-1.1.9-2 2-2s2 .9 2 2c0 .18-.02.36-.07.52l2.55 2.55c.16-.05.34-.07.52-.07s.36.02.52.07l3.55-3.56C19.02 8.35 19 8.18 19 8c0-1.1.9-2 2-2s2 .9 2 2"}),"Timeline"),voe=Jr(K.jsx("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5M12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5m0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"}),"Visibility"),xoe=Jr(K.jsx("path",{d:"M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7M2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2m4.31-.78 3.15 3.15.02-.16c0-1.66-1.34-3-3-3z"}),"VisibilityOff"),DE=({onClick:e,tooltipTitle:t,icon:n,backgroundColor:s="#A8D99C",borderRadius:a="50%",tooltipPlacement:u="right",top:f,bottom:_,left:r,right:C,width:k=70,height:I=70,transform:P,absolute:D=!1,id:N})=>K.jsx(d1,{title:t,placement:u,arrow:!0,children:K.jsx(ga,{id:N,onClick:e,sx:{position:D?"absolute":"relative",top:f,bottom:_||void 0,left:r||void 0,right:C||void 0,transform:P,backgroundColor:s,borderRadius:a,zIndex:1100,width:k,height:I,display:"flex",justifyContent:"center",alignItems:"center",transition:"transform 0.3s ease, width 0.3s ease, height 0.3s ease",boxShadow:"0 4px 8px rgba(0, 0, 0, 0.15)","&:hover":{width:`calc(${k}px * 1.08)`,height:`calc(${I}px * 1.08)`,boxShadow:"0 6px 12px rgba(0, 0, 0, 0.25)",transform:`${P} scale(1.04)`,border:"1px solid #ccc"}},children:n})}),boe=({onClose:e,...t})=>K.jsx(km,{variant:"outlined",onClick:e,sx:{borderColor:"#ECAC7A",color:"#ECAC7A",mr:2,"&:hover":{backgroundColor:"rgba(236, 172, 122, 0.1)",borderColor:"#E59548"}},...t,children:"Cancel"}),woe=({id:e,label:t,handleSubmit:n,...s})=>K.jsx(km,{id:e,variant:"contained",onClick:n,sx:{backgroundColor:"#A8D99C",color:"#000","&:hover":{backgroundColor:"#89C287"}},...s,children:t}),od=({headerId:e,open:t,onClose:n,header:s,submitLabel:a,children:u,onSubmit:f,disableSubmit:_=!1,modalWidth:r,headermargin:C,tutorialHelp:k,openTutorial:I,submitButtonProps:P})=>(X.useEffect(()=>{const D=N=>{N.key==="Enter"&&!_&&(N.preventDefault(),f())};return t&&window.addEventListener("keydown",D),()=>{window.removeEventListener("keydown",D)}},[t,_,f]),K.jsx(mA,{open:t,onClose:n,children:K.jsxs(Ci,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",bgcolor:"#555555",color:"#ffffff",boxShadow:24,p:4,borderRadius:"8px",width:r||400,paddingTop:3},children:[K.jsx(ga,{onClick:n,sx:{position:"absolute",top:10,right:10,color:"#ffffff"},children:K.jsx(h1,{})}),K.jsx(To,{id:e,variant:"h6",sx:{mb:C||3},children:s}),u," ",K.jsxs(Ci,{mt:4,display:"flex",alignItems:"center",justifyContent:"space-between",children:[k&&K.jsx(d1,{title:"Tutorial steps",placement:"right",arrow:!0,children:K.jsx(ga,{"aria-label":"help",color:"inherit",onClick:I,sx:{color:"white",fontSize:25},children:K.jsx(Vc,{sx:{fontSize:20}})})}),K.jsxs(Ci,{ml:"auto",display:"flex",alignItems:"center",children:[K.jsx(boe,{onClose:n})," ",K.jsx(woe,{id:"submit-button",label:a,handleSubmit:f,disabled:_,...P})," "]})]})]})})),Bh=({id:e,label:t,...n})=>K.jsx(c8,{id:e,fullWidth:!0,label:t,variant:"standard",autoComplete:"off",sx:{mb:3,"& .MuiInput-root":{color:"#ffffff",backgroundColor:"#555555","&:before":{borderBottomColor:"#ffffff"},"&:hover:not(.Mui-disabled):before":{borderBottomColor:"#A8D99C"},"&:after":{borderBottomColor:"#A8D99C"}},"& .MuiInputLabel-root":{color:"#A8D99C"},"& .MuiInputLabel-root.Mui-focused":{color:"#A8D99C"}},...n}),jh=({id:e,label:t,options:n,value:s,onChange:a,error:u,helperText:f,..._})=>K.jsxs(up,{fullWidth:!0,variant:"standard",sx:{mb:3},error:u,children:[K.jsx(cp,{shrink:!0,sx:{color:"#A8D99C","&.Mui-focused":{color:"#A8D99C"}},children:t}),K.jsx(Zd,{id:e,value:s,onChange:a,MenuProps:{PaperProps:{sx:{bgcolor:"#555555",color:"#ffffff","& .MuiMenuItem-root":{"&:hover":{bgcolor:"rgba(255, 255, 255, 0.1)"},"&.Mui-selected":{bgcolor:"rgba(255, 255, 255, 0.1)"},"&.Mui-selected:hover":{bgcolor:"rgba(255, 255, 255, 0.1)"}}}}},sx:{bgcolor:"#555555",color:"#ffffff !important","&:before":{borderBottomColor:"#ffffff"},"&:hover:not(.Mui-disabled):before":{borderBottomColor:"#A8D99C"},"&:after":{borderBottomColor:"#A8D99C"},"& .MuiSelect-icon":{color:"#A8D99C"},"& .Mui-selected":{bgcolor:"#A8D99C !important",color:"black !important"}},..._,children:n.map(r=>K.jsx(gl,{value:r.value,sx:{color:"#ffffff"},children:r.label},r.value))}),f&&K.jsx("div",{style:{color:"#d32f2f",marginTop:"4px",fontSize:"12px"},children:f})," "]});function d8(e){return t=>typeof t===e}var Soe=d8("function"),Coe=e=>e===null,NF=e=>Object.prototype.toString.call(e).slice(8,-1)==="RegExp",BF=e=>!Eoe(e)&&!Coe(e)&&(Soe(e)||typeof e=="object"),Eoe=d8("undefined");function Toe(e,t){const{length:n}=e;if(n!==t.length)return!1;for(let s=n;s--!==0;)if(!Rl(e[s],t[s]))return!1;return!0}function Ioe(e,t){if(e.byteLength!==t.byteLength)return!1;const n=new DataView(e.buffer),s=new DataView(t.buffer);let a=e.byteLength;for(;a--;)if(n.getUint8(a)!==s.getUint8(a))return!1;return!0}function koe(e,t){if(e.size!==t.size)return!1;for(const n of e.entries())if(!t.has(n[0]))return!1;for(const n of e.entries())if(!Rl(n[1],t.get(n[0])))return!1;return!0}function Moe(e,t){if(e.size!==t.size)return!1;for(const n of e.entries())if(!t.has(n[0]))return!1;return!0}function Rl(e,t){if(e===t)return!0;if(e&&BF(e)&&t&&BF(t)){if(e.constructor!==t.constructor)return!1;if(Array.isArray(e)&&Array.isArray(t))return Toe(e,t);if(e instanceof Map&&t instanceof Map)return koe(e,t);if(e instanceof Set&&t instanceof Set)return Moe(e,t);if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(t))return Ioe(e,t);if(NF(e)&&NF(t))return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();const n=Object.keys(e),s=Object.keys(t);if(n.length!==s.length)return!1;for(let a=n.length;a--!==0;)if(!Object.prototype.hasOwnProperty.call(t,n[a]))return!1;for(let a=n.length;a--!==0;){const u=n[a];if(!(u==="_owner"&&e.$$typeof)&&!Rl(e[u],t[u]))return!1}return!0}return Number.isNaN(e)&&Number.isNaN(t)?!0:e===t}var Poe=["Array","ArrayBuffer","AsyncFunction","AsyncGenerator","AsyncGeneratorFunction","Date","Error","Function","Generator","GeneratorFunction","HTMLElement","Map","Object","Promise","RegExp","Set","WeakMap","WeakSet"],Aoe=["bigint","boolean","null","number","string","symbol","undefined"];function zE(e){const t=Object.prototype.toString.call(e).slice(8,-1);if(/HTML\w+Element/.test(t))return"HTMLElement";if(Loe(t))return t}function sd(e){return t=>zE(t)===e}function Loe(e){return Poe.includes(e)}function S0(e){return t=>typeof t===e}function Roe(e){return Aoe.includes(e)}var Ooe=["innerHTML","ownerDocument","style","attributes","nodeValue"];function Vr(e){if(e===null)return"null";switch(typeof e){case"bigint":return"bigint";case"boolean":return"boolean";case"number":return"number";case"string":return"string";case"symbol":return"symbol";case"undefined":return"undefined"}if(Vr.array(e))return"Array";if(Vr.plainFunction(e))return"Function";const t=zE(e);return t||"Object"}Vr.array=Array.isArray;Vr.arrayOf=(e,t)=>!Vr.array(e)&&!Vr.function(t)?!1:e.every(n=>t(n));Vr.asyncGeneratorFunction=e=>zE(e)==="AsyncGeneratorFunction";Vr.asyncFunction=sd("AsyncFunction");Vr.bigint=S0("bigint");Vr.boolean=e=>e===!0||e===!1;Vr.date=sd("Date");Vr.defined=e=>!Vr.undefined(e);Vr.domElement=e=>Vr.object(e)&&!Vr.plainObject(e)&&e.nodeType===1&&Vr.string(e.nodeName)&&Ooe.every(t=>t in e);Vr.empty=e=>Vr.string(e)&&e.length===0||Vr.array(e)&&e.length===0||Vr.object(e)&&!Vr.map(e)&&!Vr.set(e)&&Object.keys(e).length===0||Vr.set(e)&&e.size===0||Vr.map(e)&&e.size===0;Vr.error=sd("Error");Vr.function=S0("function");Vr.generator=e=>Vr.iterable(e)&&Vr.function(e.next)&&Vr.function(e.throw);Vr.generatorFunction=sd("GeneratorFunction");Vr.instanceOf=(e,t)=>!e||!t?!1:Object.getPrototypeOf(e)===t.prototype;Vr.iterable=e=>!Vr.nullOrUndefined(e)&&Vr.function(e[Symbol.iterator]);Vr.map=sd("Map");Vr.nan=e=>Number.isNaN(e);Vr.null=e=>e===null;Vr.nullOrUndefined=e=>Vr.null(e)||Vr.undefined(e);Vr.number=e=>S0("number")(e)&&!Vr.nan(e);Vr.numericString=e=>Vr.string(e)&&e.length>0&&!Number.isNaN(Number(e));Vr.object=e=>!Vr.nullOrUndefined(e)&&(Vr.function(e)||typeof e=="object");Vr.oneOf=(e,t)=>Vr.array(e)?e.indexOf(t)>-1:!1;Vr.plainFunction=sd("Function");Vr.plainObject=e=>{if(zE(e)!=="Object")return!1;const t=Object.getPrototypeOf(e);return t===null||t===Object.getPrototypeOf({})};Vr.primitive=e=>Vr.null(e)||Roe(typeof e);Vr.promise=sd("Promise");Vr.propertyOf=(e,t,n)=>{if(!Vr.object(e)||!t)return!1;const s=e[t];return Vr.function(n)?n(s):Vr.defined(s)};Vr.regexp=sd("RegExp");Vr.set=sd("Set");Vr.string=S0("string");Vr.symbol=S0("symbol");Vr.undefined=S0("undefined");Vr.weakMap=sd("WeakMap");Vr.weakSet=sd("WeakSet");var Wr=Vr;function Doe(...e){return e.every(t=>Wr.string(t)||Wr.array(t)||Wr.plainObject(t))}function zoe(e,t,n){return h8(e,t)?[e,t].every(Wr.array)?!e.some(GF(n))&&t.some(GF(n)):[e,t].every(Wr.plainObject)?!Object.entries(e).some(UF(n))&&Object.entries(t).some(UF(n)):t===n:!1}function jF(e,t,n){const{actual:s,key:a,previous:u,type:f}=n,_=Nd(e,a),r=Nd(t,a);let C=[_,r].every(Wr.number)&&(f==="increased"?_<r:_>r);return Wr.undefined(s)||(C=C&&r===s),Wr.undefined(u)||(C=C&&_===u),C}function VF(e,t,n){const{key:s,type:a,value:u}=n,f=Nd(e,s),_=Nd(t,s),r=a==="added"?f:_,C=a==="added"?_:f;if(!Wr.nullOrUndefined(u)){if(Wr.defined(r)){if(Wr.array(r)||Wr.plainObject(r))return zoe(r,C,u)}else return Rl(C,u);return!1}return[f,_].every(Wr.array)?!C.every(bA(r)):[f,_].every(Wr.plainObject)?Foe(Object.keys(r),Object.keys(C)):![f,_].every(k=>Wr.primitive(k)&&Wr.defined(k))&&(a==="added"?!Wr.defined(f)&&Wr.defined(_):Wr.defined(f)&&!Wr.defined(_))}function $F(e,t,{key:n}={}){let s=Nd(e,n),a=Nd(t,n);if(!h8(s,a))throw new TypeError("Inputs have different types");if(!Doe(s,a))throw new TypeError("Inputs don't have length");return[s,a].every(Wr.plainObject)&&(s=Object.keys(s),a=Object.keys(a)),[s,a]}function UF(e){return([t,n])=>Wr.array(e)?Rl(e,n)||e.some(s=>Rl(s,n)||Wr.array(n)&&bA(n)(s)):Wr.plainObject(e)&&e[t]?!!e[t]&&Rl(e[t],n):Rl(e,n)}function Foe(e,t){return t.some(n=>!e.includes(n))}function GF(e){return t=>Wr.array(e)?e.some(n=>Rl(n,t)||Wr.array(t)&&bA(t)(n)):Rl(e,t)}function Sv(e,t){return Wr.array(e)?e.some(n=>Rl(n,t)):Rl(e,t)}function bA(e){return t=>e.some(n=>Rl(n,t))}function h8(...e){return e.every(Wr.array)||e.every(Wr.number)||e.every(Wr.plainObject)||e.every(Wr.string)}function Nd(e,t){return Wr.plainObject(e)||Wr.array(e)?Wr.string(t)?t.split(".").reduce((s,a)=>s&&s[a],e):Wr.number(t)?e[t]:e:e}function pC(e,t){if([e,t].some(Wr.nullOrUndefined))throw new Error("Missing required parameters");if(![e,t].every(k=>Wr.plainObject(k)||Wr.array(k)))throw new Error("Expected plain objects or array");return{added:(k,I)=>{try{return VF(e,t,{key:k,type:"added",value:I})}catch{return!1}},changed:(k,I,P)=>{try{const D=Nd(e,k),N=Nd(t,k),j=Wr.defined(I),W=Wr.defined(P);if(j||W){const H=W?Sv(P,D):!Sv(I,D),q=Sv(I,N);return H&&q}return[D,N].every(Wr.array)||[D,N].every(Wr.plainObject)?!Rl(D,N):D!==N}catch{return!1}},changedFrom:(k,I,P)=>{if(!Wr.defined(k))return!1;try{const D=Nd(e,k),N=Nd(t,k),j=Wr.defined(P);return Sv(I,D)&&(j?Sv(P,N):!j)}catch{return!1}},decreased:(k,I,P)=>{if(!Wr.defined(k))return!1;try{return jF(e,t,{key:k,actual:I,previous:P,type:"decreased"})}catch{return!1}},emptied:k=>{try{const[I,P]=$F(e,t,{key:k});return!!I.length&&!P.length}catch{return!1}},filled:k=>{try{const[I,P]=$F(e,t,{key:k});return!I.length&&!!P.length}catch{return!1}},increased:(k,I,P)=>{if(!Wr.defined(k))return!1;try{return jF(e,t,{key:k,actual:I,previous:P,type:"increased"})}catch{return!1}},removed:(k,I)=>{try{return VF(e,t,{key:k,type:"removed",value:I})}catch{return!1}}}}var Noe=new Error("Element already at target scroll position"),Boe=new Error("Scroll cancelled"),joe=Math.min,HF=Date.now,Voe={left:WF("scrollLeft"),top:WF("scrollTop")};function WF(e){return function(n,s,a,u){a=a||{},typeof a=="function"&&(u=a,a={}),typeof u!="function"&&(u=Uoe);var f=HF(),_=n[e],r=a.ease||$oe,C=isNaN(a.duration)?350:+a.duration,k=!1;return _===s?u(Noe,n[e]):requestAnimationFrame(P),I;function I(){k=!0}function P(D){if(k)return u(Boe,n[e]);var N=HF(),j=joe(1,(N-f)/C),W=r(j);n[e]=W*(s-_)+_,j<1?requestAnimationFrame(P):requestAnimationFrame(function(){u(null,n[e])})}}}function $oe(e){return .5*(1-Math.cos(Math.PI*e))}function Uoe(){}const Goe=yc(Voe);var f8={exports:{}};(function(e){(function(t,n){e.exports?e.exports=n():t.Scrollparent=n()})(fl,function(){function t(s){var a=getComputedStyle(s,null).getPropertyValue("overflow");return a.indexOf("scroll")>-1||a.indexOf("auto")>-1}function n(s){if(s instanceof HTMLElement||s instanceof SVGElement){for(var a=s.parentNode;a.parentNode;){if(t(a))return a;a=a.parentNode}return document.scrollingElement||document.documentElement}}return n})})(f8);var Hoe=f8.exports;const p8=yc(Hoe);var Woe=function(e){return Object.prototype.hasOwnProperty.call(e,"props")},qoe=function(e,t){return e+$x(t)},$x=function(e){return e===null||typeof e=="boolean"||typeof e>"u"?"":typeof e=="number"?e.toString():typeof e=="string"?e:Array.isArray(e)?e.reduce(qoe,""):Woe(e)&&Object.prototype.hasOwnProperty.call(e.props,"children")?$x(e.props.children):""};$x.default=$x;var Xoe=$x;const qF=yc(Xoe);var Yoe=function(t){return Zoe(t)&&!Koe(t)};function Zoe(e){return!!e&&typeof e=="object"}function Koe(e){var t=Object.prototype.toString.call(e);return t==="[object RegExp]"||t==="[object Date]"||ese(e)}var Joe=typeof Symbol=="function"&&Symbol.for,Qoe=Joe?Symbol.for("react.element"):60103;function ese(e){return e.$$typeof===Qoe}function tse(e){return Array.isArray(e)?[]:{}}function Ux(e,t){return t.clone!==!1&&t.isMergeableObject(e)?o0(tse(e),e,t):e}function nse(e,t,n){return e.concat(t).map(function(s){return Ux(s,n)})}function rse(e,t){if(!t.customMerge)return o0;var n=t.customMerge(e);return typeof n=="function"?n:o0}function ise(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter(function(t){return Object.propertyIsEnumerable.call(e,t)}):[]}function XF(e){return Object.keys(e).concat(ise(e))}function m8(e,t){try{return t in e}catch{return!1}}function ose(e,t){return m8(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))}function sse(e,t,n){var s={};return n.isMergeableObject(e)&&XF(e).forEach(function(a){s[a]=Ux(e[a],n)}),XF(t).forEach(function(a){ose(e,a)||(m8(e,a)&&n.isMergeableObject(t[a])?s[a]=rse(a,n)(e[a],t[a],n):s[a]=Ux(t[a],n))}),s}function o0(e,t,n){n=n||{},n.arrayMerge=n.arrayMerge||nse,n.isMergeableObject=n.isMergeableObject||Yoe,n.cloneUnlessOtherwiseSpecified=Ux;var s=Array.isArray(t),a=Array.isArray(e),u=s===a;return u?s?n.arrayMerge(e,t,n):sse(e,t,n):Ux(t,n)}o0.all=function(t,n){if(!Array.isArray(t))throw new Error("first argument should be an array");return t.reduce(function(s,a){return o0(s,a,n)},{})};var ase=o0,lse=ase;const Zc=yc(lse);/**!
 * @fileOverview Kickass library to create and place poppers near their reference elements.
 * @version 1.16.1
 * @license
 * Copyright (c) 2016 Federico Zivolo and contributors
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var f1=typeof window<"u"&&typeof document<"u"&&typeof navigator<"u",use=function(){for(var e=["Edge","Trident","Firefox"],t=0;t<e.length;t+=1)if(f1&&navigator.userAgent.indexOf(e[t])>=0)return 1;return 0}();function cse(e){var t=!1;return function(){t||(t=!0,window.Promise.resolve().then(function(){t=!1,e()}))}}function dse(e){var t=!1;return function(){t||(t=!0,setTimeout(function(){t=!1,e()},use))}}var hse=f1&&window.Promise,fse=hse?cse:dse;function g8(e){var t={};return e&&t.toString.call(e)==="[object Function]"}function jm(e,t){if(e.nodeType!==1)return[];var n=e.ownerDocument.defaultView,s=n.getComputedStyle(e,null);return t?s[t]:s}function wA(e){return e.nodeName==="HTML"?e:e.parentNode||e.host}function p1(e){if(!e)return document.body;switch(e.nodeName){case"HTML":case"BODY":return e.ownerDocument.body;case"#document":return e.body}var t=jm(e),n=t.overflow,s=t.overflowX,a=t.overflowY;return/(auto|scroll|overlay)/.test(n+a+s)?e:p1(wA(e))}function y8(e){return e&&e.referenceNode?e.referenceNode:e}var YF=f1&&!!(window.MSInputMethodContext&&document.documentMode),ZF=f1&&/MSIE 10/.test(navigator.userAgent);function C0(e){return e===11?YF:e===10?ZF:YF||ZF}function s0(e){if(!e)return document.documentElement;for(var t=C0(10)?document.body:null,n=e.offsetParent||null;n===t&&e.nextElementSibling;)n=(e=e.nextElementSibling).offsetParent;var s=n&&n.nodeName;return!s||s==="BODY"||s==="HTML"?e?e.ownerDocument.documentElement:document.documentElement:["TH","TD","TABLE"].indexOf(n.nodeName)!==-1&&jm(n,"position")==="static"?s0(n):n}function pse(e){var t=e.nodeName;return t==="BODY"?!1:t==="HTML"||s0(e.firstElementChild)===e}function CP(e){return e.parentNode!==null?CP(e.parentNode):e}function mC(e,t){if(!e||!e.nodeType||!t||!t.nodeType)return document.documentElement;var n=e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_FOLLOWING,s=n?e:t,a=n?t:e,u=document.createRange();u.setStart(s,0),u.setEnd(a,0);var f=u.commonAncestorContainer;if(e!==f&&t!==f||s.contains(a))return pse(f)?f:s0(f);var _=CP(e);return _.host?mC(_.host,t):mC(e,CP(t).host)}function a0(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"top",n=t==="top"?"scrollTop":"scrollLeft",s=e.nodeName;if(s==="BODY"||s==="HTML"){var a=e.ownerDocument.documentElement,u=e.ownerDocument.scrollingElement||a;return u[n]}return e[n]}function mse(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=a0(t,"top"),a=a0(t,"left"),u=n?-1:1;return e.top+=s*u,e.bottom+=s*u,e.left+=a*u,e.right+=a*u,e}function KF(e,t){var n=t==="x"?"Left":"Top",s=n==="Left"?"Right":"Bottom";return parseFloat(e["border"+n+"Width"])+parseFloat(e["border"+s+"Width"])}function JF(e,t,n,s){return Math.max(t["offset"+e],t["scroll"+e],n["client"+e],n["offset"+e],n["scroll"+e],C0(10)?parseInt(n["offset"+e])+parseInt(s["margin"+(e==="Height"?"Top":"Left")])+parseInt(s["margin"+(e==="Height"?"Bottom":"Right")]):0)}function _8(e){var t=e.body,n=e.documentElement,s=C0(10)&&getComputedStyle(n);return{height:JF("Height",t,n,s),width:JF("Width",t,n,s)}}var gse=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},yse=function(){function e(t,n){for(var s=0;s<n.length;s++){var a=n[s];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(t,n,s){return n&&e(t.prototype,n),s&&e(t,s),t}}(),l0=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},ac=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e};function dp(e){return ac({},e,{right:e.left+e.width,bottom:e.top+e.height})}function EP(e){var t={};try{if(C0(10)){t=e.getBoundingClientRect();var n=a0(e,"top"),s=a0(e,"left");t.top+=n,t.left+=s,t.bottom+=n,t.right+=s}else t=e.getBoundingClientRect()}catch{}var a={left:t.left,top:t.top,width:t.right-t.left,height:t.bottom-t.top},u=e.nodeName==="HTML"?_8(e.ownerDocument):{},f=u.width||e.clientWidth||a.width,_=u.height||e.clientHeight||a.height,r=e.offsetWidth-f,C=e.offsetHeight-_;if(r||C){var k=jm(e);r-=KF(k,"x"),C-=KF(k,"y"),a.width-=r,a.height-=C}return dp(a)}function SA(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=C0(10),a=t.nodeName==="HTML",u=EP(e),f=EP(t),_=p1(e),r=jm(t),C=parseFloat(r.borderTopWidth),k=parseFloat(r.borderLeftWidth);n&&a&&(f.top=Math.max(f.top,0),f.left=Math.max(f.left,0));var I=dp({top:u.top-f.top-C,left:u.left-f.left-k,width:u.width,height:u.height});if(I.marginTop=0,I.marginLeft=0,!s&&a){var P=parseFloat(r.marginTop),D=parseFloat(r.marginLeft);I.top-=C-P,I.bottom-=C-P,I.left-=k-D,I.right-=k-D,I.marginTop=P,I.marginLeft=D}return(s&&!n?t.contains(_):t===_&&_.nodeName!=="BODY")&&(I=mse(I,t)),I}function _se(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=e.ownerDocument.documentElement,s=SA(e,n),a=Math.max(n.clientWidth,window.innerWidth||0),u=Math.max(n.clientHeight,window.innerHeight||0),f=t?0:a0(n),_=t?0:a0(n,"left"),r={top:f-s.top+s.marginTop,left:_-s.left+s.marginLeft,width:a,height:u};return dp(r)}function v8(e){var t=e.nodeName;if(t==="BODY"||t==="HTML")return!1;if(jm(e,"position")==="fixed")return!0;var n=wA(e);return n?v8(n):!1}function x8(e){if(!e||!e.parentElement||C0())return document.documentElement;for(var t=e.parentElement;t&&jm(t,"transform")==="none";)t=t.parentElement;return t||document.documentElement}function CA(e,t,n,s){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,u={top:0,left:0},f=a?x8(e):mC(e,y8(t));if(s==="viewport")u=_se(f,a);else{var _=void 0;s==="scrollParent"?(_=p1(wA(t)),_.nodeName==="BODY"&&(_=e.ownerDocument.documentElement)):s==="window"?_=e.ownerDocument.documentElement:_=s;var r=SA(_,f,a);if(_.nodeName==="HTML"&&!v8(f)){var C=_8(e.ownerDocument),k=C.height,I=C.width;u.top+=r.top-r.marginTop,u.bottom=k+r.top,u.left+=r.left-r.marginLeft,u.right=I+r.left}else u=r}n=n||0;var P=typeof n=="number";return u.left+=P?n:n.left||0,u.top+=P?n:n.top||0,u.right-=P?n:n.right||0,u.bottom-=P?n:n.bottom||0,u}function vse(e){var t=e.width,n=e.height;return t*n}function b8(e,t,n,s,a){var u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0;if(e.indexOf("auto")===-1)return e;var f=CA(n,s,u,a),_={top:{width:f.width,height:t.top-f.top},right:{width:f.right-t.right,height:f.height},bottom:{width:f.width,height:f.bottom-t.bottom},left:{width:t.left-f.left,height:f.height}},r=Object.keys(_).map(function(P){return ac({key:P},_[P],{area:vse(_[P])})}).sort(function(P,D){return D.area-P.area}),C=r.filter(function(P){var D=P.width,N=P.height;return D>=n.clientWidth&&N>=n.clientHeight}),k=C.length>0?C[0].key:r[0].key,I=e.split("-")[1];return k+(I?"-"+I:"")}function w8(e,t,n){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,a=s?x8(t):mC(t,y8(n));return SA(n,a,s)}function S8(e){var t=e.ownerDocument.defaultView,n=t.getComputedStyle(e),s=parseFloat(n.marginTop||0)+parseFloat(n.marginBottom||0),a=parseFloat(n.marginLeft||0)+parseFloat(n.marginRight||0),u={width:e.offsetWidth+a,height:e.offsetHeight+s};return u}function gC(e){var t={left:"right",right:"left",bottom:"top",top:"bottom"};return e.replace(/left|right|bottom|top/g,function(n){return t[n]})}function C8(e,t,n){n=n.split("-")[0];var s=S8(e),a={width:s.width,height:s.height},u=["right","left"].indexOf(n)!==-1,f=u?"top":"left",_=u?"left":"top",r=u?"height":"width",C=u?"width":"height";return a[f]=t[f]+t[r]/2-s[r]/2,n===_?a[_]=t[_]-s[C]:a[_]=t[gC(_)],a}function m1(e,t){return Array.prototype.find?e.find(t):e.filter(t)[0]}function xse(e,t,n){if(Array.prototype.findIndex)return e.findIndex(function(a){return a[t]===n});var s=m1(e,function(a){return a[t]===n});return e.indexOf(s)}function E8(e,t,n){var s=n===void 0?e:e.slice(0,xse(e,"name",n));return s.forEach(function(a){a.function&&console.warn("`modifier.function` is deprecated, use `modifier.fn`!");var u=a.function||a.fn;a.enabled&&g8(u)&&(t.offsets.popper=dp(t.offsets.popper),t.offsets.reference=dp(t.offsets.reference),t=u(t,a))}),t}function bse(){if(!this.state.isDestroyed){var e={instance:this,styles:{},arrowStyles:{},attributes:{},flipped:!1,offsets:{}};e.offsets.reference=w8(this.state,this.popper,this.reference,this.options.positionFixed),e.placement=b8(this.options.placement,e.offsets.reference,this.popper,this.reference,this.options.modifiers.flip.boundariesElement,this.options.modifiers.flip.padding),e.originalPlacement=e.placement,e.positionFixed=this.options.positionFixed,e.offsets.popper=C8(this.popper,e.offsets.reference,e.placement),e.offsets.popper.position=this.options.positionFixed?"fixed":"absolute",e=E8(this.modifiers,e),this.state.isCreated?this.options.onUpdate(e):(this.state.isCreated=!0,this.options.onCreate(e))}}function T8(e,t){return e.some(function(n){var s=n.name,a=n.enabled;return a&&s===t})}function EA(e){for(var t=[!1,"ms","Webkit","Moz","O"],n=e.charAt(0).toUpperCase()+e.slice(1),s=0;s<t.length;s++){var a=t[s],u=a?""+a+n:e;if(typeof document.body.style[u]<"u")return u}return null}function wse(){return this.state.isDestroyed=!0,T8(this.modifiers,"applyStyle")&&(this.popper.removeAttribute("x-placement"),this.popper.style.position="",this.popper.style.top="",this.popper.style.left="",this.popper.style.right="",this.popper.style.bottom="",this.popper.style.willChange="",this.popper.style[EA("transform")]=""),this.disableEventListeners(),this.options.removeOnDestroy&&this.popper.parentNode.removeChild(this.popper),this}function I8(e){var t=e.ownerDocument;return t?t.defaultView:window}function k8(e,t,n,s){var a=e.nodeName==="BODY",u=a?e.ownerDocument.defaultView:e;u.addEventListener(t,n,{passive:!0}),a||k8(p1(u.parentNode),t,n,s),s.push(u)}function Sse(e,t,n,s){n.updateBound=s,I8(e).addEventListener("resize",n.updateBound,{passive:!0});var a=p1(e);return k8(a,"scroll",n.updateBound,n.scrollParents),n.scrollElement=a,n.eventsEnabled=!0,n}function Cse(){this.state.eventsEnabled||(this.state=Sse(this.reference,this.options,this.state,this.scheduleUpdate))}function Ese(e,t){return I8(e).removeEventListener("resize",t.updateBound),t.scrollParents.forEach(function(n){n.removeEventListener("scroll",t.updateBound)}),t.updateBound=null,t.scrollParents=[],t.scrollElement=null,t.eventsEnabled=!1,t}function Tse(){this.state.eventsEnabled&&(cancelAnimationFrame(this.scheduleUpdate),this.state=Ese(this.reference,this.state))}function TA(e){return e!==""&&!isNaN(parseFloat(e))&&isFinite(e)}function TP(e,t){Object.keys(t).forEach(function(n){var s="";["width","height","top","right","bottom","left"].indexOf(n)!==-1&&TA(t[n])&&(s="px"),e.style[n]=t[n]+s})}function Ise(e,t){Object.keys(t).forEach(function(n){var s=t[n];s!==!1?e.setAttribute(n,t[n]):e.removeAttribute(n)})}function kse(e){return TP(e.instance.popper,e.styles),Ise(e.instance.popper,e.attributes),e.arrowElement&&Object.keys(e.arrowStyles).length&&TP(e.arrowElement,e.arrowStyles),e}function Mse(e,t,n,s,a){var u=w8(a,t,e,n.positionFixed),f=b8(n.placement,u,t,e,n.modifiers.flip.boundariesElement,n.modifiers.flip.padding);return t.setAttribute("x-placement",f),TP(t,{position:n.positionFixed?"fixed":"absolute"}),n}function Pse(e,t){var n=e.offsets,s=n.popper,a=n.reference,u=Math.round,f=Math.floor,_=function(H){return H},r=u(a.width),C=u(s.width),k=["left","right"].indexOf(e.placement)!==-1,I=e.placement.indexOf("-")!==-1,P=r%2===C%2,D=r%2===1&&C%2===1,N=t?k||I||P?u:f:_,j=t?u:_;return{left:N(D&&!I&&t?s.left-1:s.left),top:j(s.top),bottom:j(s.bottom),right:N(s.right)}}var Ase=f1&&/Firefox/i.test(navigator.userAgent);function Lse(e,t){var n=t.x,s=t.y,a=e.offsets.popper,u=m1(e.instance.modifiers,function(Z){return Z.name==="applyStyle"}).gpuAcceleration;u!==void 0&&console.warn("WARNING: `gpuAcceleration` option moved to `computeStyle` modifier and will not be supported in future versions of Popper.js!");var f=u!==void 0?u:t.gpuAcceleration,_=s0(e.instance.popper),r=EP(_),C={position:a.position},k=Pse(e,window.devicePixelRatio<2||!Ase),I=n==="bottom"?"top":"bottom",P=s==="right"?"left":"right",D=EA("transform"),N=void 0,j=void 0;if(I==="bottom"?_.nodeName==="HTML"?j=-_.clientHeight+k.bottom:j=-r.height+k.bottom:j=k.top,P==="right"?_.nodeName==="HTML"?N=-_.clientWidth+k.right:N=-r.width+k.right:N=k.left,f&&D)C[D]="translate3d("+N+"px, "+j+"px, 0)",C[I]=0,C[P]=0,C.willChange="transform";else{var W=I==="bottom"?-1:1,H=P==="right"?-1:1;C[I]=j*W,C[P]=N*H,C.willChange=I+", "+P}var q={"x-placement":e.placement};return e.attributes=ac({},q,e.attributes),e.styles=ac({},C,e.styles),e.arrowStyles=ac({},e.offsets.arrow,e.arrowStyles),e}function M8(e,t,n){var s=m1(e,function(_){var r=_.name;return r===t}),a=!!s&&e.some(function(_){return _.name===n&&_.enabled&&_.order<s.order});if(!a){var u="`"+t+"`",f="`"+n+"`";console.warn(f+" modifier is required by "+u+" modifier in order to work, be sure to include it before "+u+"!")}return a}function Rse(e,t){var n;if(!M8(e.instance.modifiers,"arrow","keepTogether"))return e;var s=t.element;if(typeof s=="string"){if(s=e.instance.popper.querySelector(s),!s)return e}else if(!e.instance.popper.contains(s))return console.warn("WARNING: `arrow.element` must be child of its popper element!"),e;var a=e.placement.split("-")[0],u=e.offsets,f=u.popper,_=u.reference,r=["left","right"].indexOf(a)!==-1,C=r?"height":"width",k=r?"Top":"Left",I=k.toLowerCase(),P=r?"left":"top",D=r?"bottom":"right",N=S8(s)[C];_[D]-N<f[I]&&(e.offsets.popper[I]-=f[I]-(_[D]-N)),_[I]+N>f[D]&&(e.offsets.popper[I]+=_[I]+N-f[D]),e.offsets.popper=dp(e.offsets.popper);var j=_[I]+_[C]/2-N/2,W=jm(e.instance.popper),H=parseFloat(W["margin"+k]),q=parseFloat(W["border"+k+"Width"]),Z=j-e.offsets.popper[I]-H-q;return Z=Math.max(Math.min(f[C]-N,Z),0),e.arrowElement=s,e.offsets.arrow=(n={},l0(n,I,Math.round(Z)),l0(n,P,""),n),e}function Ose(e){return e==="end"?"start":e==="start"?"end":e}var P8=["auto-start","auto","auto-end","top-start","top","top-end","right-start","right","right-end","bottom-end","bottom","bottom-start","left-end","left","left-start"],Ik=P8.slice(3);function QF(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=Ik.indexOf(e),s=Ik.slice(n+1).concat(Ik.slice(0,n));return t?s.reverse():s}var kk={FLIP:"flip",CLOCKWISE:"clockwise",COUNTERCLOCKWISE:"counterclockwise"};function Dse(e,t){if(T8(e.instance.modifiers,"inner")||e.flipped&&e.placement===e.originalPlacement)return e;var n=CA(e.instance.popper,e.instance.reference,t.padding,t.boundariesElement,e.positionFixed),s=e.placement.split("-")[0],a=gC(s),u=e.placement.split("-")[1]||"",f=[];switch(t.behavior){case kk.FLIP:f=[s,a];break;case kk.CLOCKWISE:f=QF(s);break;case kk.COUNTERCLOCKWISE:f=QF(s,!0);break;default:f=t.behavior}return f.forEach(function(_,r){if(s!==_||f.length===r+1)return e;s=e.placement.split("-")[0],a=gC(s);var C=e.offsets.popper,k=e.offsets.reference,I=Math.floor,P=s==="left"&&I(C.right)>I(k.left)||s==="right"&&I(C.left)<I(k.right)||s==="top"&&I(C.bottom)>I(k.top)||s==="bottom"&&I(C.top)<I(k.bottom),D=I(C.left)<I(n.left),N=I(C.right)>I(n.right),j=I(C.top)<I(n.top),W=I(C.bottom)>I(n.bottom),H=s==="left"&&D||s==="right"&&N||s==="top"&&j||s==="bottom"&&W,q=["top","bottom"].indexOf(s)!==-1,Z=!!t.flipVariations&&(q&&u==="start"&&D||q&&u==="end"&&N||!q&&u==="start"&&j||!q&&u==="end"&&W),re=!!t.flipVariationsByContent&&(q&&u==="start"&&N||q&&u==="end"&&D||!q&&u==="start"&&W||!q&&u==="end"&&j),le=Z||re;(P||H||le)&&(e.flipped=!0,(P||H)&&(s=f[r+1]),le&&(u=Ose(u)),e.placement=s+(u?"-"+u:""),e.offsets.popper=ac({},e.offsets.popper,C8(e.instance.popper,e.offsets.reference,e.placement)),e=E8(e.instance.modifiers,e,"flip"))}),e}function zse(e){var t=e.offsets,n=t.popper,s=t.reference,a=e.placement.split("-")[0],u=Math.floor,f=["top","bottom"].indexOf(a)!==-1,_=f?"right":"bottom",r=f?"left":"top",C=f?"width":"height";return n[_]<u(s[r])&&(e.offsets.popper[r]=u(s[r])-n[C]),n[r]>u(s[_])&&(e.offsets.popper[r]=u(s[_])),e}function Fse(e,t,n,s){var a=e.match(/((?:\-|\+)?\d*\.?\d*)(.*)/),u=+a[1],f=a[2];if(!u)return e;if(f.indexOf("%")===0){var _=void 0;switch(f){case"%p":_=n;break;case"%":case"%r":default:_=s}var r=dp(_);return r[t]/100*u}else if(f==="vh"||f==="vw"){var C=void 0;return f==="vh"?C=Math.max(document.documentElement.clientHeight,window.innerHeight||0):C=Math.max(document.documentElement.clientWidth,window.innerWidth||0),C/100*u}else return u}function Nse(e,t,n,s){var a=[0,0],u=["right","left"].indexOf(s)!==-1,f=e.split(/(\+|\-)/).map(function(k){return k.trim()}),_=f.indexOf(m1(f,function(k){return k.search(/,|\s/)!==-1}));f[_]&&f[_].indexOf(",")===-1&&console.warn("Offsets separated by white space(s) are deprecated, use a comma (,) instead.");var r=/\s*,\s*|\s+/,C=_!==-1?[f.slice(0,_).concat([f[_].split(r)[0]]),[f[_].split(r)[1]].concat(f.slice(_+1))]:[f];return C=C.map(function(k,I){var P=(I===1?!u:u)?"height":"width",D=!1;return k.reduce(function(N,j){return N[N.length-1]===""&&["+","-"].indexOf(j)!==-1?(N[N.length-1]=j,D=!0,N):D?(N[N.length-1]+=j,D=!1,N):N.concat(j)},[]).map(function(N){return Fse(N,P,t,n)})}),C.forEach(function(k,I){k.forEach(function(P,D){TA(P)&&(a[I]+=P*(k[D-1]==="-"?-1:1))})}),a}function Bse(e,t){var n=t.offset,s=e.placement,a=e.offsets,u=a.popper,f=a.reference,_=s.split("-")[0],r=void 0;return TA(+n)?r=[+n,0]:r=Nse(n,u,f,_),_==="left"?(u.top+=r[0],u.left-=r[1]):_==="right"?(u.top+=r[0],u.left+=r[1]):_==="top"?(u.left+=r[0],u.top-=r[1]):_==="bottom"&&(u.left+=r[0],u.top+=r[1]),e.popper=u,e}function jse(e,t){var n=t.boundariesElement||s0(e.instance.popper);e.instance.reference===n&&(n=s0(n));var s=EA("transform"),a=e.instance.popper.style,u=a.top,f=a.left,_=a[s];a.top="",a.left="",a[s]="";var r=CA(e.instance.popper,e.instance.reference,t.padding,n,e.positionFixed);a.top=u,a.left=f,a[s]=_,t.boundaries=r;var C=t.priority,k=e.offsets.popper,I={primary:function(D){var N=k[D];return k[D]<r[D]&&!t.escapeWithReference&&(N=Math.max(k[D],r[D])),l0({},D,N)},secondary:function(D){var N=D==="right"?"left":"top",j=k[N];return k[D]>r[D]&&!t.escapeWithReference&&(j=Math.min(k[N],r[D]-(D==="right"?k.width:k.height))),l0({},N,j)}};return C.forEach(function(P){var D=["left","top"].indexOf(P)!==-1?"primary":"secondary";k=ac({},k,I[D](P))}),e.offsets.popper=k,e}function Vse(e){var t=e.placement,n=t.split("-")[0],s=t.split("-")[1];if(s){var a=e.offsets,u=a.reference,f=a.popper,_=["bottom","top"].indexOf(n)!==-1,r=_?"left":"top",C=_?"width":"height",k={start:l0({},r,u[r]),end:l0({},r,u[r]+u[C]-f[C])};e.offsets.popper=ac({},f,k[s])}return e}function $se(e){if(!M8(e.instance.modifiers,"hide","preventOverflow"))return e;var t=e.offsets.reference,n=m1(e.instance.modifiers,function(s){return s.name==="preventOverflow"}).boundaries;if(t.bottom<n.top||t.left>n.right||t.top>n.bottom||t.right<n.left){if(e.hide===!0)return e;e.hide=!0,e.attributes["x-out-of-boundaries"]=""}else{if(e.hide===!1)return e;e.hide=!1,e.attributes["x-out-of-boundaries"]=!1}return e}function Use(e){var t=e.placement,n=t.split("-")[0],s=e.offsets,a=s.popper,u=s.reference,f=["left","right"].indexOf(n)!==-1,_=["top","left"].indexOf(n)===-1;return a[f?"left":"top"]=u[n]-(_?a[f?"width":"height"]:0),e.placement=gC(t),e.offsets.popper=dp(a),e}var Gse={shift:{order:100,enabled:!0,fn:Vse},offset:{order:200,enabled:!0,fn:Bse,offset:0},preventOverflow:{order:300,enabled:!0,fn:jse,priority:["left","right","top","bottom"],padding:5,boundariesElement:"scrollParent"},keepTogether:{order:400,enabled:!0,fn:zse},arrow:{order:500,enabled:!0,fn:Rse,element:"[x-arrow]"},flip:{order:600,enabled:!0,fn:Dse,behavior:"flip",padding:5,boundariesElement:"viewport",flipVariations:!1,flipVariationsByContent:!1},inner:{order:700,enabled:!1,fn:Use},hide:{order:800,enabled:!0,fn:$se},computeStyle:{order:850,enabled:!0,fn:Lse,gpuAcceleration:!0,x:"bottom",y:"right"},applyStyle:{order:900,enabled:!0,fn:kse,onLoad:Mse,gpuAcceleration:void 0}},Hse={placement:"bottom",positionFixed:!1,eventsEnabled:!0,removeOnDestroy:!1,onCreate:function(){},onUpdate:function(){},modifiers:Gse},Gx=function(){function e(t,n){var s=this,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};gse(this,e),this.scheduleUpdate=function(){return requestAnimationFrame(s.update)},this.update=fse(this.update.bind(this)),this.options=ac({},e.Defaults,a),this.state={isDestroyed:!1,isCreated:!1,scrollParents:[]},this.reference=t&&t.jquery?t[0]:t,this.popper=n&&n.jquery?n[0]:n,this.options.modifiers={},Object.keys(ac({},e.Defaults.modifiers,a.modifiers)).forEach(function(f){s.options.modifiers[f]=ac({},e.Defaults.modifiers[f]||{},a.modifiers?a.modifiers[f]:{})}),this.modifiers=Object.keys(this.options.modifiers).map(function(f){return ac({name:f},s.options.modifiers[f])}).sort(function(f,_){return f.order-_.order}),this.modifiers.forEach(function(f){f.enabled&&g8(f.onLoad)&&f.onLoad(s.reference,s.popper,s.options,f,s.state)}),this.update();var u=this.options.eventsEnabled;u&&this.enableEventListeners(),this.state.eventsEnabled=u}return yse(e,[{key:"update",value:function(){return bse.call(this)}},{key:"destroy",value:function(){return wse.call(this)}},{key:"enableEventListeners",value:function(){return Cse.call(this)}},{key:"disableEventListeners",value:function(){return Tse.call(this)}}]),e}();Gx.Utils=(typeof window<"u"?window:global).PopperUtils;Gx.placements=P8;Gx.Defaults=Hse;var Wse=["innerHTML","ownerDocument","style","attributes","nodeValue"],qse=["Array","ArrayBuffer","AsyncFunction","AsyncGenerator","AsyncGeneratorFunction","Date","Error","Function","Generator","GeneratorFunction","HTMLElement","Map","Object","Promise","RegExp","Set","WeakMap","WeakSet"],Xse=["bigint","boolean","null","number","string","symbol","undefined"];function FE(e){var t=Object.prototype.toString.call(e).slice(8,-1);if(/HTML\w+Element/.test(t))return"HTMLElement";if(Yse(t))return t}function ad(e){return function(t){return FE(t)===e}}function Yse(e){return qse.includes(e)}function E0(e){return function(t){return typeof t===e}}function Zse(e){return Xse.includes(e)}function Gn(e){if(e===null)return"null";switch(typeof e){case"bigint":return"bigint";case"boolean":return"boolean";case"number":return"number";case"string":return"string";case"symbol":return"symbol";case"undefined":return"undefined"}if(Gn.array(e))return"Array";if(Gn.plainFunction(e))return"Function";var t=FE(e);return t||"Object"}Gn.array=Array.isArray;Gn.arrayOf=function(e,t){return!Gn.array(e)&&!Gn.function(t)?!1:e.every(function(n){return t(n)})};Gn.asyncGeneratorFunction=function(e){return FE(e)==="AsyncGeneratorFunction"};Gn.asyncFunction=ad("AsyncFunction");Gn.bigint=E0("bigint");Gn.boolean=function(e){return e===!0||e===!1};Gn.date=ad("Date");Gn.defined=function(e){return!Gn.undefined(e)};Gn.domElement=function(e){return Gn.object(e)&&!Gn.plainObject(e)&&e.nodeType===1&&Gn.string(e.nodeName)&&Wse.every(function(t){return t in e})};Gn.empty=function(e){return Gn.string(e)&&e.length===0||Gn.array(e)&&e.length===0||Gn.object(e)&&!Gn.map(e)&&!Gn.set(e)&&Object.keys(e).length===0||Gn.set(e)&&e.size===0||Gn.map(e)&&e.size===0};Gn.error=ad("Error");Gn.function=E0("function");Gn.generator=function(e){return Gn.iterable(e)&&Gn.function(e.next)&&Gn.function(e.throw)};Gn.generatorFunction=ad("GeneratorFunction");Gn.instanceOf=function(e,t){return!e||!t?!1:Object.getPrototypeOf(e)===t.prototype};Gn.iterable=function(e){return!Gn.nullOrUndefined(e)&&Gn.function(e[Symbol.iterator])};Gn.map=ad("Map");Gn.nan=function(e){return Number.isNaN(e)};Gn.null=function(e){return e===null};Gn.nullOrUndefined=function(e){return Gn.null(e)||Gn.undefined(e)};Gn.number=function(e){return E0("number")(e)&&!Gn.nan(e)};Gn.numericString=function(e){return Gn.string(e)&&e.length>0&&!Number.isNaN(Number(e))};Gn.object=function(e){return!Gn.nullOrUndefined(e)&&(Gn.function(e)||typeof e=="object")};Gn.oneOf=function(e,t){return Gn.array(e)?e.indexOf(t)>-1:!1};Gn.plainFunction=ad("Function");Gn.plainObject=function(e){if(FE(e)!=="Object")return!1;var t=Object.getPrototypeOf(e);return t===null||t===Object.getPrototypeOf({})};Gn.primitive=function(e){return Gn.null(e)||Zse(typeof e)};Gn.promise=ad("Promise");Gn.propertyOf=function(e,t,n){if(!Gn.object(e)||!t)return!1;var s=e[t];return Gn.function(n)?n(s):Gn.defined(s)};Gn.regexp=ad("RegExp");Gn.set=ad("Set");Gn.string=E0("string");Gn.symbol=E0("symbol");Gn.undefined=E0("undefined");Gn.weakMap=ad("WeakMap");Gn.weakSet=ad("WeakSet");function A8(e){return function(t){return typeof t===e}}var Kse=A8("function"),Jse=function(e){return e===null},e4=function(e){return Object.prototype.toString.call(e).slice(8,-1)==="RegExp"},t4=function(e){return!Qse(e)&&!Jse(e)&&(Kse(e)||typeof e=="object")},Qse=A8("undefined"),IP=function(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],s=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&s>=e.length&&(e=void 0),{value:e&&e[s++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};function eae(e,t){var n=e.length;if(n!==t.length)return!1;for(var s=n;s--!==0;)if(!Ql(e[s],t[s]))return!1;return!0}function tae(e,t){if(e.byteLength!==t.byteLength)return!1;for(var n=new DataView(e.buffer),s=new DataView(t.buffer),a=e.byteLength;a--;)if(n.getUint8(a)!==s.getUint8(a))return!1;return!0}function nae(e,t){var n,s,a,u;if(e.size!==t.size)return!1;try{for(var f=IP(e.entries()),_=f.next();!_.done;_=f.next()){var r=_.value;if(!t.has(r[0]))return!1}}catch(I){n={error:I}}finally{try{_&&!_.done&&(s=f.return)&&s.call(f)}finally{if(n)throw n.error}}try{for(var C=IP(e.entries()),k=C.next();!k.done;k=C.next()){var r=k.value;if(!Ql(r[1],t.get(r[0])))return!1}}catch(I){a={error:I}}finally{try{k&&!k.done&&(u=C.return)&&u.call(C)}finally{if(a)throw a.error}}return!0}function rae(e,t){var n,s;if(e.size!==t.size)return!1;try{for(var a=IP(e.entries()),u=a.next();!u.done;u=a.next()){var f=u.value;if(!t.has(f[0]))return!1}}catch(_){n={error:_}}finally{try{u&&!u.done&&(s=a.return)&&s.call(a)}finally{if(n)throw n.error}}return!0}function Ql(e,t){if(e===t)return!0;if(e&&t4(e)&&t&&t4(t)){if(e.constructor!==t.constructor)return!1;if(Array.isArray(e)&&Array.isArray(t))return eae(e,t);if(e instanceof Map&&t instanceof Map)return nae(e,t);if(e instanceof Set&&t instanceof Set)return rae(e,t);if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(t))return tae(e,t);if(e4(e)&&e4(t))return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();var n=Object.keys(e),s=Object.keys(t);if(n.length!==s.length)return!1;for(var a=n.length;a--!==0;)if(!Object.prototype.hasOwnProperty.call(t,n[a]))return!1;for(var a=n.length;a--!==0;){var u=n[a];if(!(u==="_owner"&&e.$$typeof)&&!Ql(e[u],t[u]))return!1}return!0}return Number.isNaN(e)&&Number.isNaN(t)?!0:e===t}function iae(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.every(function(n){return Gn.string(n)||Gn.array(n)||Gn.plainObject(n)})}function oae(e,t,n){return L8(e,t)?[e,t].every(Gn.array)?!e.some(s4(n))&&t.some(s4(n)):[e,t].every(Gn.plainObject)?!Object.entries(e).some(o4(n))&&Object.entries(t).some(o4(n)):t===n:!1}function n4(e,t,n){var s=n.actual,a=n.key,u=n.previous,f=n.type,_=Bd(e,a),r=Bd(t,a),C=[_,r].every(Gn.number)&&(f==="increased"?_<r:_>r);return Gn.undefined(s)||(C=C&&r===s),Gn.undefined(u)||(C=C&&_===u),C}function r4(e,t,n){var s=n.key,a=n.type,u=n.value,f=Bd(e,s),_=Bd(t,s),r=a==="added"?f:_,C=a==="added"?_:f;if(!Gn.nullOrUndefined(u)){if(Gn.defined(r)){if(Gn.array(r)||Gn.plainObject(r))return oae(r,C,u)}else return Ql(C,u);return!1}return[f,_].every(Gn.array)?!C.every(IA(r)):[f,_].every(Gn.plainObject)?sae(Object.keys(r),Object.keys(C)):![f,_].every(function(k){return Gn.primitive(k)&&Gn.defined(k)})&&(a==="added"?!Gn.defined(f)&&Gn.defined(_):Gn.defined(f)&&!Gn.defined(_))}function i4(e,t,n){var s=n===void 0?{}:n,a=s.key,u=Bd(e,a),f=Bd(t,a);if(!L8(u,f))throw new TypeError("Inputs have different types");if(!iae(u,f))throw new TypeError("Inputs don't have length");return[u,f].every(Gn.plainObject)&&(u=Object.keys(u),f=Object.keys(f)),[u,f]}function o4(e){return function(t){var n=t[0],s=t[1];return Gn.array(e)?Ql(e,s)||e.some(function(a){return Ql(a,s)||Gn.array(s)&&IA(s)(a)}):Gn.plainObject(e)&&e[n]?!!e[n]&&Ql(e[n],s):Ql(e,s)}}function sae(e,t){return t.some(function(n){return!e.includes(n)})}function s4(e){return function(t){return Gn.array(e)?e.some(function(n){return Ql(n,t)||Gn.array(t)&&IA(t)(n)}):Ql(e,t)}}function Cv(e,t){return Gn.array(e)?e.some(function(n){return Ql(n,t)}):Ql(e,t)}function IA(e){return function(t){return e.some(function(n){return Ql(n,t)})}}function L8(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.every(Gn.array)||e.every(Gn.number)||e.every(Gn.plainObject)||e.every(Gn.string)}function Bd(e,t){if(Gn.plainObject(e)||Gn.array(e)){if(Gn.string(t)){var n=t.split(".");return n.reduce(function(s,a){return s&&s[a]},e)}return Gn.number(t)?e[t]:e}return e}function aae(e,t){if([e,t].some(Gn.nullOrUndefined))throw new Error("Missing required parameters");if(![e,t].every(function(I){return Gn.plainObject(I)||Gn.array(I)}))throw new Error("Expected plain objects or array");var n=function(I,P){try{return r4(e,t,{key:I,type:"added",value:P})}catch{return!1}},s=function(I,P,D){try{var N=Bd(e,I),j=Bd(t,I),W=Gn.defined(P),H=Gn.defined(D);if(W||H){var q=H?Cv(D,N):!Cv(P,N),Z=Cv(P,j);return q&&Z}return[N,j].every(Gn.array)||[N,j].every(Gn.plainObject)?!Ql(N,j):N!==j}catch{return!1}},a=function(I,P,D){if(!Gn.defined(I))return!1;try{var N=Bd(e,I),j=Bd(t,I),W=Gn.defined(D);return Cv(P,N)&&(W?Cv(D,j):!W)}catch{return!1}},u=function(I,P){return Gn.defined(I)?s(I,P):!1},f=function(I,P,D){if(!Gn.defined(I))return!1;try{return n4(e,t,{key:I,actual:P,previous:D,type:"decreased"})}catch{return!1}},_=function(I){try{var P=i4(e,t,{key:I}),D=P[0],N=P[1];return!!D.length&&!N.length}catch{return!1}},r=function(I){try{var P=i4(e,t,{key:I}),D=P[0],N=P[1];return!D.length&&!!N.length}catch{return!1}},C=function(I,P,D){if(!Gn.defined(I))return!1;try{return n4(e,t,{key:I,actual:P,previous:D,type:"increased"})}catch{return!1}},k=function(I,P){try{return r4(e,t,{key:I,type:"removed",value:P})}catch{return!1}};return{added:n,changed:s,changedFrom:a,changedTo:u,decreased:f,emptied:_,filled:r,increased:C,removed:k}}function a4(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,s)}return n}function vs(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?a4(Object(n),!0).forEach(function(s){ul(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a4(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function g1(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lae(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,O8(s.key),s)}}function y1(e,t,n){return t&&lae(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function ul(e,t,n){return t=O8(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _1(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&kP(e,t)}function yC(e){return yC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},yC(e)}function kP(e,t){return kP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},kP(e,t)}function uae(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function cae(e,t){if(e==null)return{};var n={},s=Object.keys(e),a,u;for(u=0;u<s.length;u++)a=s[u],!(t.indexOf(a)>=0)&&(n[a]=e[a]);return n}function R8(e,t){if(e==null)return{};var n=cae(e,t),s,a;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(a=0;a<u.length;a++)s=u[a],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function vh(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dae(e,t){if(t&&(typeof t=="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vh(e)}function v1(e){var t=uae();return function(){var s=yC(e),a;if(t){var u=yC(this).constructor;a=Reflect.construct(s,arguments,u)}else a=s.apply(this,arguments);return dae(this,a)}}function hae(e,t){if(typeof e!="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function O8(e){var t=hae(e,"string");return typeof t=="symbol"?t:String(t)}var fae={flip:{padding:20},preventOverflow:{padding:10}},pae="The typeValidator argument must be a function with the signature function(props, propName, componentName).",mae="The error message is optional, but must be a string if provided.";function gae(e,t,n,s){return typeof e=="boolean"?e:typeof e=="function"?e(t,n,s):e?!!e:!1}function yae(e,t){return Object.hasOwnProperty.call(e,t)}function _ae(e,t,n,s){return new Error("Required ".concat(e[t]," `").concat(t,"` was not specified in `").concat(n,"`."))}function vae(e,t){if(typeof e!="function")throw new TypeError(pae);if(t&&typeof t!="string")throw new TypeError(mae)}function l4(e,t,n){return vae(e,n),function(s,a,u){for(var f=arguments.length,_=new Array(f>3?f-3:0),r=3;r<f;r++)_[r-3]=arguments[r];return gae(t,s,a,u)?yae(s,a)?e.apply(void 0,[s,a,u].concat(_)):_ae(s,a,u):e.apply(void 0,[s,a,u].concat(_))}}var uo={INIT:"init",IDLE:"idle",OPENING:"opening",OPEN:"open",CLOSING:"closing",ERROR:"error"},Ev=Vf.createPortal!==void 0;function Rd(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}function Mk(){return"ontouchstart"in window&&/Mobi/.test(navigator.userAgent)}function Fw(e){var t=e.title,n=e.data,s=e.warn,a=s===void 0?!1:s,u=e.debug,f=u===void 0?!1:u,_=a?console.warn||console.error:console.log;f&&t&&n&&(console.groupCollapsed("%creact-floater: ".concat(t),"color: #9b00ff; font-weight: bold; font-size: 12px;"),Array.isArray(n)?n.forEach(function(r){Gn.plainObject(r)&&r.key?_.apply(console,[r.key,r.value]):_.apply(console,[r])}):_.apply(console,[n]),console.groupEnd())}function xae(e,t,n){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;e.addEventListener(t,n,s)}function bae(e,t,n){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;e.removeEventListener(t,n,s)}function wae(e,t,n){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,a;a=function(f){n(f),bae(e,t,a)},xae(e,t,a,s)}function u4(){}var D8=function(e){_1(n,e);var t=v1(n);function n(){return g1(this,n),t.apply(this,arguments)}return y1(n,[{key:"componentDidMount",value:function(){Rd()&&(this.node||this.appendNode(),Ev||this.renderPortal())}},{key:"componentDidUpdate",value:function(){Rd()&&(Ev||this.renderPortal())}},{key:"componentWillUnmount",value:function(){!Rd()||!this.node||(Ev||Vf.unmountComponentAtNode(this.node),this.node&&this.node.parentNode===document.body&&(document.body.removeChild(this.node),this.node=void 0))}},{key:"appendNode",value:function(){var a=this.props,u=a.id,f=a.zIndex;this.node||(this.node=document.createElement("div"),u&&(this.node.id=u),f&&(this.node.style.zIndex=f),document.body.appendChild(this.node))}},{key:"renderPortal",value:function(){if(!Rd())return null;var a=this.props,u=a.children,f=a.setRef;if(this.node||this.appendNode(),Ev)return Vf.createPortal(u,this.node);var _=Vf.unstable_renderSubtreeIntoContainer(this,u.length>1?Sr.createElement("div",null,u):u[0],this.node);return f(_),null}},{key:"renderReact16",value:function(){var a=this.props,u=a.hasChildren,f=a.placement,_=a.target;return u?this.renderPortal():_||f==="center"?this.renderPortal():null}},{key:"render",value:function(){return Ev?this.renderReact16():null}}]),n}(Sr.Component);ul(D8,"propTypes",{children:Pt.oneOfType([Pt.element,Pt.array]),hasChildren:Pt.bool,id:Pt.oneOfType([Pt.string,Pt.number]),placement:Pt.string,setRef:Pt.func.isRequired,target:Pt.oneOfType([Pt.object,Pt.string]),zIndex:Pt.number});var z8=function(e){_1(n,e);var t=v1(n);function n(){return g1(this,n),t.apply(this,arguments)}return y1(n,[{key:"parentStyle",get:function(){var a=this.props,u=a.placement,f=a.styles,_=f.arrow.length,r={pointerEvents:"none",position:"absolute",width:"100%"};return u.startsWith("top")?(r.bottom=0,r.left=0,r.right=0,r.height=_):u.startsWith("bottom")?(r.left=0,r.right=0,r.top=0,r.height=_):u.startsWith("left")?(r.right=0,r.top=0,r.bottom=0):u.startsWith("right")&&(r.left=0,r.top=0),r}},{key:"render",value:function(){var a=this.props,u=a.placement,f=a.setArrowRef,_=a.styles,r=_.arrow,C=r.color,k=r.display,I=r.length,P=r.margin,D=r.position,N=r.spread,j={display:k,position:D},W,H=N,q=I;return u.startsWith("top")?(W="0,0 ".concat(H/2,",").concat(q," ").concat(H,",0"),j.bottom=0,j.marginLeft=P,j.marginRight=P):u.startsWith("bottom")?(W="".concat(H,",").concat(q," ").concat(H/2,",0 0,").concat(q),j.top=0,j.marginLeft=P,j.marginRight=P):u.startsWith("left")?(q=N,H=I,W="0,0 ".concat(H,",").concat(q/2," 0,").concat(q),j.right=0,j.marginTop=P,j.marginBottom=P):u.startsWith("right")&&(q=N,H=I,W="".concat(H,",").concat(q," ").concat(H,",0 0,").concat(q/2),j.left=0,j.marginTop=P,j.marginBottom=P),Sr.createElement("div",{className:"__floater__arrow",style:this.parentStyle},Sr.createElement("span",{ref:f,style:j},Sr.createElement("svg",{width:H,height:q,version:"1.1",xmlns:"http://www.w3.org/2000/svg"},Sr.createElement("polygon",{points:W,fill:C}))))}}]),n}(Sr.Component);ul(z8,"propTypes",{placement:Pt.string.isRequired,setArrowRef:Pt.func.isRequired,styles:Pt.object.isRequired});var Sae=["color","height","width"];function F8(e){var t=e.handleClick,n=e.styles,s=n.color,a=n.height,u=n.width,f=R8(n,Sae);return Sr.createElement("button",{"aria-label":"close",onClick:t,style:f,type:"button"},Sr.createElement("svg",{width:"".concat(u,"px"),height:"".concat(a,"px"),viewBox:"0 0 18 18",version:"1.1",xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"xMidYMid"},Sr.createElement("g",null,Sr.createElement("path",{d:"M8.13911129,9.00268191 L0.171521827,17.0258467 C-0.0498027049,17.248715 -0.0498027049,17.6098394 0.171521827,17.8327545 C0.28204354,17.9443526 0.427188206,17.9998706 0.572051765,17.9998706 C0.71714958,17.9998706 0.862013139,17.9443526 0.972581703,17.8327545 L9.0000937,9.74924618 L17.0276057,17.8327545 C17.1384085,17.9443526 17.2832721,17.9998706 17.4281356,17.9998706 C17.5729992,17.9998706 17.718097,17.9443526 17.8286656,17.8327545 C18.0499901,17.6098862 18.0499901,17.2487618 17.8286656,17.0258467 L9.86135722,9.00268191 L17.8340066,0.973848225 C18.0553311,0.750979934 18.0553311,0.389855532 17.8340066,0.16694039 C17.6126821,-0.0556467968 17.254037,-0.0556467968 17.0329467,0.16694039 L9.00042166,8.25611765 L0.967006424,0.167268345 C0.745681892,-0.0553188426 0.387317931,-0.0553188426 0.165993399,0.167268345 C-0.0553311331,0.390136635 -0.0553311331,0.751261038 0.165993399,0.974176179 L8.13920499,9.00268191 L8.13911129,9.00268191 Z",fill:s}))))}F8.propTypes={handleClick:Pt.func.isRequired,styles:Pt.object.isRequired};function N8(e){var t=e.content,n=e.footer,s=e.handleClick,a=e.open,u=e.positionWrapper,f=e.showCloseButton,_=e.title,r=e.styles,C={content:Sr.isValidElement(t)?t:Sr.createElement("div",{className:"__floater__content",style:r.content},t)};return _&&(C.title=Sr.isValidElement(_)?_:Sr.createElement("div",{className:"__floater__title",style:r.title},_)),n&&(C.footer=Sr.isValidElement(n)?n:Sr.createElement("div",{className:"__floater__footer",style:r.footer},n)),(f||u)&&!Gn.boolean(a)&&(C.close=Sr.createElement(F8,{styles:r.close,handleClick:s})),Sr.createElement("div",{className:"__floater__container",style:r.container},C.close,C.title,C.content,C.footer)}N8.propTypes={content:Pt.node.isRequired,footer:Pt.node,handleClick:Pt.func.isRequired,open:Pt.bool,positionWrapper:Pt.bool.isRequired,showCloseButton:Pt.bool.isRequired,styles:Pt.object.isRequired,title:Pt.node};var B8=function(e){_1(n,e);var t=v1(n);function n(){return g1(this,n),t.apply(this,arguments)}return y1(n,[{key:"style",get:function(){var a=this.props,u=a.disableAnimation,f=a.component,_=a.placement,r=a.hideArrow,C=a.status,k=a.styles,I=k.arrow.length,P=k.floater,D=k.floaterCentered,N=k.floaterClosing,j=k.floaterOpening,W=k.floaterWithAnimation,H=k.floaterWithComponent,q={};return r||(_.startsWith("top")?q.padding="0 0 ".concat(I,"px"):_.startsWith("bottom")?q.padding="".concat(I,"px 0 0"):_.startsWith("left")?q.padding="0 ".concat(I,"px 0 0"):_.startsWith("right")&&(q.padding="0 0 0 ".concat(I,"px"))),[uo.OPENING,uo.OPEN].indexOf(C)!==-1&&(q=vs(vs({},q),j)),C===uo.CLOSING&&(q=vs(vs({},q),N)),C===uo.OPEN&&!u&&(q=vs(vs({},q),W)),_==="center"&&(q=vs(vs({},q),D)),f&&(q=vs(vs({},q),H)),vs(vs({},P),q)}},{key:"render",value:function(){var a=this.props,u=a.component,f=a.handleClick,_=a.hideArrow,r=a.setFloaterRef,C=a.status,k={},I=["__floater"];return u?Sr.isValidElement(u)?k.content=Sr.cloneElement(u,{closeFn:f}):k.content=u({closeFn:f}):k.content=Sr.createElement(N8,this.props),C===uo.OPEN&&I.push("__floater__open"),_||(k.arrow=Sr.createElement(z8,this.props)),Sr.createElement("div",{ref:r,className:I.join(" "),style:this.style},Sr.createElement("div",{className:"__floater__body"},k.content,k.arrow))}}]),n}(Sr.Component);ul(B8,"propTypes",{component:Pt.oneOfType([Pt.func,Pt.element]),content:Pt.node,disableAnimation:Pt.bool.isRequired,footer:Pt.node,handleClick:Pt.func.isRequired,hideArrow:Pt.bool.isRequired,open:Pt.bool,placement:Pt.string.isRequired,positionWrapper:Pt.bool.isRequired,setArrowRef:Pt.func.isRequired,setFloaterRef:Pt.func.isRequired,showCloseButton:Pt.bool,status:Pt.string.isRequired,styles:Pt.object.isRequired,title:Pt.node});var j8=function(e){_1(n,e);var t=v1(n);function n(){return g1(this,n),t.apply(this,arguments)}return y1(n,[{key:"render",value:function(){var a=this.props,u=a.children,f=a.handleClick,_=a.handleMouseEnter,r=a.handleMouseLeave,C=a.setChildRef,k=a.setWrapperRef,I=a.style,P=a.styles,D;if(u)if(Sr.Children.count(u)===1)if(!Sr.isValidElement(u))D=Sr.createElement("span",null,u);else{var N=Gn.function(u.type)?"innerRef":"ref";D=Sr.cloneElement(Sr.Children.only(u),ul({},N,C))}else D=u;return D?Sr.createElement("span",{ref:k,style:vs(vs({},P),I),onClick:f,onMouseEnter:_,onMouseLeave:r},D):null}}]),n}(Sr.Component);ul(j8,"propTypes",{children:Pt.node,handleClick:Pt.func.isRequired,handleMouseEnter:Pt.func.isRequired,handleMouseLeave:Pt.func.isRequired,setChildRef:Pt.func.isRequired,setWrapperRef:Pt.func.isRequired,style:Pt.object,styles:Pt.object.isRequired});var Cae={zIndex:100};function Eae(e){var t=Zc(Cae,e.options||{});return{wrapper:{cursor:"help",display:"inline-flex",flexDirection:"column",zIndex:t.zIndex},wrapperPosition:{left:-1e3,position:"absolute",top:-1e3,visibility:"hidden"},floater:{display:"inline-block",filter:"drop-shadow(0 0 3px rgba(0, 0, 0, 0.3))",maxWidth:300,opacity:0,position:"relative",transition:"opacity 0.3s",visibility:"hidden",zIndex:t.zIndex},floaterOpening:{opacity:1,visibility:"visible"},floaterWithAnimation:{opacity:1,transition:"opacity 0.3s, transform 0.2s",visibility:"visible"},floaterWithComponent:{maxWidth:"100%"},floaterClosing:{opacity:0,visibility:"visible"},floaterCentered:{left:"50%",position:"fixed",top:"50%",transform:"translate(-50%, -50%)"},container:{backgroundColor:"#fff",color:"#666",minHeight:60,minWidth:200,padding:20,position:"relative",zIndex:10},title:{borderBottom:"1px solid #555",color:"#555",fontSize:18,marginBottom:5,paddingBottom:6,paddingRight:18},content:{fontSize:15},close:{backgroundColor:"transparent",border:0,borderRadius:0,color:"#555",fontSize:0,height:15,outline:"none",padding:10,position:"absolute",right:0,top:0,width:15,WebkitAppearance:"none"},footer:{borderTop:"1px solid #ccc",fontSize:13,marginTop:10,paddingTop:5},arrow:{color:"#fff",display:"inline-flex",length:16,margin:8,position:"absolute",spread:32},options:t}}var Tae=["arrow","flip","offset"],Iae=["position","top","right","bottom","left"],kA=function(e){_1(n,e);var t=v1(n);function n(s){var a;return g1(this,n),a=t.call(this,s),ul(vh(a),"setArrowRef",function(u){a.arrowRef=u}),ul(vh(a),"setChildRef",function(u){a.childRef=u}),ul(vh(a),"setFloaterRef",function(u){a.floaterRef=u}),ul(vh(a),"setWrapperRef",function(u){a.wrapperRef=u}),ul(vh(a),"handleTransitionEnd",function(){var u=a.state.status,f=a.props.callback;a.wrapperPopper&&a.wrapperPopper.instance.update(),a.setState({status:u===uo.OPENING?uo.OPEN:uo.IDLE},function(){var _=a.state.status;f(_===uo.OPEN?"open":"close",a.props)})}),ul(vh(a),"handleClick",function(){var u=a.props,f=u.event,_=u.open;if(!Gn.boolean(_)){var r=a.state,C=r.positionWrapper,k=r.status;(a.event==="click"||a.event==="hover"&&C)&&(Fw({title:"click",data:[{event:f,status:k===uo.OPEN?"closing":"opening"}],debug:a.debug}),a.toggle())}}),ul(vh(a),"handleMouseEnter",function(){var u=a.props,f=u.event,_=u.open;if(!(Gn.boolean(_)||Mk())){var r=a.state.status;a.event==="hover"&&r===uo.IDLE&&(Fw({title:"mouseEnter",data:[{key:"originalEvent",value:f}],debug:a.debug}),clearTimeout(a.eventDelayTimeout),a.toggle())}}),ul(vh(a),"handleMouseLeave",function(){var u=a.props,f=u.event,_=u.eventDelay,r=u.open;if(!(Gn.boolean(r)||Mk())){var C=a.state,k=C.status,I=C.positionWrapper;a.event==="hover"&&(Fw({title:"mouseLeave",data:[{key:"originalEvent",value:f}],debug:a.debug}),_?[uo.OPENING,uo.OPEN].indexOf(k)!==-1&&!I&&!a.eventDelayTimeout&&(a.eventDelayTimeout=setTimeout(function(){delete a.eventDelayTimeout,a.toggle()},_*1e3)):a.toggle(uo.IDLE))}}),a.state={currentPlacement:s.placement,needsUpdate:!1,positionWrapper:s.wrapperOptions.position&&!!s.target,status:uo.INIT,statusWrapper:uo.INIT},a._isMounted=!1,a.hasMounted=!1,Rd()&&window.addEventListener("load",function(){a.popper&&a.popper.instance.update(),a.wrapperPopper&&a.wrapperPopper.instance.update()}),a}return y1(n,[{key:"componentDidMount",value:function(){if(Rd()){var a=this.state.positionWrapper,u=this.props,f=u.children,_=u.open,r=u.target;this._isMounted=!0,Fw({title:"init",data:{hasChildren:!!f,hasTarget:!!r,isControlled:Gn.boolean(_),positionWrapper:a,target:this.target,floater:this.floaterRef},debug:this.debug}),this.hasMounted||(this.initPopper(),this.hasMounted=!0),!f&&r&&Gn.boolean(_)}}},{key:"componentDidUpdate",value:function(a,u){if(Rd()){var f=this.props,_=f.autoOpen,r=f.open,C=f.target,k=f.wrapperOptions,I=aae(u,this.state),P=I.changedFrom,D=I.changed;if(a.open!==r){var N;Gn.boolean(r)&&(N=r?uo.OPENING:uo.CLOSING),this.toggle(N)}(a.wrapperOptions.position!==k.position||a.target!==C)&&this.changeWrapperPosition(this.props),D("status",uo.IDLE)&&r?this.toggle(uo.OPEN):P("status",uo.INIT,uo.IDLE)&&_&&this.toggle(uo.OPEN),this.popper&&D("status",uo.OPENING)&&this.popper.instance.update(),this.floaterRef&&(D("status",uo.OPENING)||D("status",uo.CLOSING))&&wae(this.floaterRef,"transitionend",this.handleTransitionEnd),D("needsUpdate",!0)&&this.rebuildPopper()}}},{key:"componentWillUnmount",value:function(){Rd()&&(this._isMounted=!1,this.popper&&this.popper.instance.destroy(),this.wrapperPopper&&this.wrapperPopper.instance.destroy())}},{key:"initPopper",value:function(){var a=this,u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.target,f=this.state.positionWrapper,_=this.props,r=_.disableFlip,C=_.getPopper,k=_.hideArrow,I=_.offset,P=_.placement,D=_.wrapperOptions,N=P==="top"||P==="bottom"?"flip":["right","bottom-end","top-end","left","top-start","bottom-start"];if(P==="center")this.setState({status:uo.IDLE});else if(u&&this.floaterRef){var j=this.options,W=j.arrow,H=j.flip,q=j.offset,Z=R8(j,Tae);new Gx(u,this.floaterRef,{placement:P,modifiers:vs({arrow:vs({enabled:!k,element:this.arrowRef},W),flip:vs({enabled:!r,behavior:N},H),offset:vs({offset:"0, ".concat(I,"px")},q)},Z),onCreate:function(_e){var ye;if(a.popper=_e,!((ye=a.floaterRef)!==null&&ye!==void 0&&ye.isConnected)){a.setState({needsUpdate:!0});return}C(_e,"floater"),a._isMounted&&a.setState({currentPlacement:_e.placement,status:uo.IDLE}),P!==_e.placement&&setTimeout(function(){_e.instance.update()},1)},onUpdate:function(_e){a.popper=_e;var ye=a.state.currentPlacement;a._isMounted&&_e.placement!==ye&&a.setState({currentPlacement:_e.placement})}})}if(f){var re=Gn.undefined(D.offset)?0:D.offset;new Gx(this.target,this.wrapperRef,{placement:D.placement||P,modifiers:{arrow:{enabled:!1},offset:{offset:"0, ".concat(re,"px")},flip:{enabled:!1}},onCreate:function(_e){a.wrapperPopper=_e,a._isMounted&&a.setState({statusWrapper:uo.IDLE}),C(_e,"wrapper"),P!==_e.placement&&setTimeout(function(){_e.instance.update()},1)}})}}},{key:"rebuildPopper",value:function(){var a=this;this.floaterRefInterval=setInterval(function(){var u;(u=a.floaterRef)!==null&&u!==void 0&&u.isConnected&&(clearInterval(a.floaterRefInterval),a.setState({needsUpdate:!1}),a.initPopper())},50)}},{key:"changeWrapperPosition",value:function(a){var u=a.target,f=a.wrapperOptions;this.setState({positionWrapper:f.position&&!!u})}},{key:"toggle",value:function(a){var u=this.state.status,f=u===uo.OPEN?uo.CLOSING:uo.OPENING;Gn.undefined(a)||(f=a),this.setState({status:f})}},{key:"debug",get:function(){var a=this.props.debug;return a||Rd()&&"ReactFloaterDebug"in window&&!!window.ReactFloaterDebug}},{key:"event",get:function(){var a=this.props,u=a.disableHoverToClick,f=a.event;return f==="hover"&&Mk()&&!u?"click":f}},{key:"options",get:function(){var a=this.props.options;return Zc(fae,a||{})}},{key:"styles",get:function(){var a=this,u=this.state,f=u.status,_=u.positionWrapper,r=u.statusWrapper,C=this.props.styles,k=Zc(Eae(C),C);if(_){var I;[uo.IDLE].indexOf(f)===-1||[uo.IDLE].indexOf(r)===-1?I=k.wrapperPosition:I=this.wrapperPopper.styles,k.wrapper=vs(vs({},k.wrapper),I)}if(this.target){var P=window.getComputedStyle(this.target);this.wrapperStyles?k.wrapper=vs(vs({},k.wrapper),this.wrapperStyles):["relative","static"].indexOf(P.position)===-1&&(this.wrapperStyles={},_||(Iae.forEach(function(D){a.wrapperStyles[D]=P[D]}),k.wrapper=vs(vs({},k.wrapper),this.wrapperStyles),this.target.style.position="relative",this.target.style.top="auto",this.target.style.right="auto",this.target.style.bottom="auto",this.target.style.left="auto"))}return k}},{key:"target",get:function(){if(!Rd())return null;var a=this.props.target;return a?Gn.domElement(a)?a:document.querySelector(a):this.childRef||this.wrapperRef}},{key:"render",value:function(){var a=this.state,u=a.currentPlacement,f=a.positionWrapper,_=a.status,r=this.props,C=r.children,k=r.component,I=r.content,P=r.disableAnimation,D=r.footer,N=r.hideArrow,j=r.id,W=r.open,H=r.showCloseButton,q=r.style,Z=r.target,re=r.title,le=Sr.createElement(j8,{handleClick:this.handleClick,handleMouseEnter:this.handleMouseEnter,handleMouseLeave:this.handleMouseLeave,setChildRef:this.setChildRef,setWrapperRef:this.setWrapperRef,style:q,styles:this.styles.wrapper},C),_e={};return f?_e.wrapperInPortal=le:_e.wrapperAsChildren=le,Sr.createElement("span",null,Sr.createElement(D8,{hasChildren:!!C,id:j,placement:u,setRef:this.setFloaterRef,target:Z,zIndex:this.styles.options.zIndex},Sr.createElement(B8,{component:k,content:I,disableAnimation:P,footer:D,handleClick:this.handleClick,hideArrow:N||u==="center",open:W,placement:u,positionWrapper:f,setArrowRef:this.setArrowRef,setFloaterRef:this.setFloaterRef,showCloseButton:H,status:_,styles:this.styles,title:re}),_e.wrapperInPortal),_e.wrapperAsChildren)}}]),n}(Sr.Component);ul(kA,"propTypes",{autoOpen:Pt.bool,callback:Pt.func,children:Pt.node,component:l4(Pt.oneOfType([Pt.func,Pt.element]),function(e){return!e.content}),content:l4(Pt.node,function(e){return!e.component}),debug:Pt.bool,disableAnimation:Pt.bool,disableFlip:Pt.bool,disableHoverToClick:Pt.bool,event:Pt.oneOf(["hover","click"]),eventDelay:Pt.number,footer:Pt.node,getPopper:Pt.func,hideArrow:Pt.bool,id:Pt.oneOfType([Pt.string,Pt.number]),offset:Pt.number,open:Pt.bool,options:Pt.object,placement:Pt.oneOf(["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end","auto","center"]),showCloseButton:Pt.bool,style:Pt.object,styles:Pt.object,target:Pt.oneOfType([Pt.object,Pt.string]),title:Pt.node,wrapperOptions:Pt.shape({offset:Pt.number,placement:Pt.oneOf(["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end","auto"]),position:Pt.bool})});ul(kA,"defaultProps",{autoOpen:!1,callback:u4,debug:!1,disableAnimation:!1,disableFlip:!1,disableHoverToClick:!1,event:"click",eventDelay:.4,getPopper:u4,hideArrow:!1,offset:15,placement:"bottom",showCloseButton:!1,styles:{},target:null,wrapperOptions:{position:!1}});var kae=Object.defineProperty,Mae=(e,t,n)=>t in e?kae(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,qr=(e,t,n)=>Mae(e,typeof t!="symbol"?t+"":t,n),Eo={INIT:"init",START:"start",STOP:"stop",RESET:"reset",PREV:"prev",NEXT:"next",GO:"go",CLOSE:"close",SKIP:"skip",UPDATE:"update"},Wc={TOUR_START:"tour:start",STEP_BEFORE:"step:before",BEACON:"beacon",TOOLTIP:"tooltip",STEP_AFTER:"step:after",TOUR_END:"tour:end",TOUR_STATUS:"tour:status",TARGET_NOT_FOUND:"error:target_not_found",ERROR:"error"},ki={INIT:"init",READY:"ready",BEACON:"beacon",TOOLTIP:"tooltip",COMPLETE:"complete",ERROR:"error"},eo={IDLE:"idle",READY:"ready",WAITING:"waiting",RUNNING:"running",PAUSED:"paused",SKIPPED:"skipped",FINISHED:"finished",ERROR:"error"};function Nf(){var e;return!!(typeof window<"u"&&((e=window.document)!=null&&e.createElement))}function V8(e){return e?e.getBoundingClientRect():null}function Pae(e=!1){const{body:t,documentElement:n}=document;if(!t||!n)return 0;if(e){const s=[t.scrollHeight,t.offsetHeight,n.clientHeight,n.scrollHeight,n.offsetHeight].sort((u,f)=>u-f),a=Math.floor(s.length/2);return s.length%2===0?(s[a-1]+s[a])/2:s[a]}return Math.max(t.scrollHeight,t.offsetHeight,n.clientHeight,n.scrollHeight,n.offsetHeight)}function Th(e){if(typeof e=="string")try{return document.querySelector(e)}catch{return null}return e}function Aae(e){return!e||e.nodeType!==1?null:getComputedStyle(e)}function Hx(e,t,n){if(!e)return fm();const s=p8(e);if(s){if(s.isSameNode(fm()))return n?document:fm();if(!(s.scrollHeight>s.offsetHeight)&&!t)return s.style.overflow="initial",fm()}return s}function NE(e,t){if(!e)return!1;const n=Hx(e,t);return n?!n.isSameNode(fm()):!1}function Lae(e){return e.offsetParent!==document.body}function u0(e,t="fixed"){if(!e||!(e instanceof HTMLElement))return!1;const{nodeName:n}=e,s=Aae(e);return n==="BODY"||n==="HTML"?!1:s&&s.position===t?!0:e.parentNode?u0(e.parentNode,t):!1}function Rae(e){var t;if(!e)return!1;let n=e;for(;n&&n!==document.body;){if(n instanceof HTMLElement){const{display:s,visibility:a}=getComputedStyle(n);if(s==="none"||a==="hidden")return!1}n=(t=n.parentElement)!=null?t:null}return!0}function Oae(e,t,n){var s,a,u;const f=V8(e),_=Hx(e,n),r=NE(e,n),C=u0(e);let k=0,I=(s=f==null?void 0:f.top)!=null?s:0;if(r&&C){const P=(a=e==null?void 0:e.offsetTop)!=null?a:0,D=(u=_==null?void 0:_.scrollTop)!=null?u:0;I=P-D}else _ instanceof HTMLElement&&(k=_.scrollTop,!r&&!u0(e)&&(I+=k),_.isSameNode(fm())||(I+=fm().scrollTop));return Math.floor(I-t)}function Dae(e,t,n){var s;if(!e)return 0;const{offsetTop:a=0,scrollTop:u=0}=(s=p8(e))!=null?s:{};let f=e.getBoundingClientRect().top+u;a&&(NE(e,n)||Lae(e))&&(f-=a);const _=Math.floor(f-t);return _<0?0:_}function fm(){var e;return(e=document.scrollingElement)!=null?e:document.documentElement}function zae(e,t){const{duration:n,element:s}=t;return new Promise((a,u)=>{const{scrollTop:f}=s,_=e>f?e-f:f-e;Goe.top(s,e,{duration:_<100?50:n},r=>r&&r.message!=="Element already at target scroll position"?u(r):a())})}var Tv=kh.createPortal!==void 0;function $8(e=navigator.userAgent){let t=e;return typeof window>"u"?t="node":document.documentMode?t="ie":/Edge/.test(e)?t="edge":window.opera||e.includes(" OPR/")?t="opera":typeof window.InstallTrigger<"u"?t="firefox":window.chrome?t="chrome":/(Version\/([\d._]+).*Safari|CriOS|FxiOS| Mobile\/)/.test(e)&&(t="safari"),t}function gS(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function Od(e,t={}){const{defaultValue:n,step:s,steps:a}=t;let u=qF(e);if(u)(u.includes("{step}")||u.includes("{steps}"))&&s&&a&&(u=u.replace("{step}",s.toString()).replace("{steps}",a.toString()));else if(X.isValidElement(e)&&!Object.values(e.props).length&&gS(e.type)==="function"){const f=e.type({});u=Od(f,t)}else u=qF(n);return u}function Fae(e,t){return!Wr.plainObject(e)||!Wr.array(t)?!1:Object.keys(e).every(n=>t.includes(n))}function Nae(e){const t=/^#?([\da-f])([\da-f])([\da-f])$/i,n=e.replace(t,(a,u,f,_)=>u+u+f+f+_+_),s=/^#?([\da-f]{2})([\da-f]{2})([\da-f]{2})$/i.exec(n);return s?[parseInt(s[1],16),parseInt(s[2],16),parseInt(s[3],16)]:[]}function c4(e){return e.disableBeacon||e.placement==="center"}function d4(){return!["chrome","safari","firefox","opera"].includes($8())}function Pm({data:e,debug:t=!1,title:n,warn:s=!1}){const a=s?console.warn||console.error:console.log;t&&(n&&e?(console.groupCollapsed(`%creact-joyride: ${n}`,"color: #ff0044; font-weight: bold; font-size: 12px;"),Array.isArray(e)?e.forEach(u=>{Wr.plainObject(u)&&u.key?a.apply(console,[u.key,u.value]):a.apply(console,[u])}):a.apply(console,[e]),console.groupEnd()):console.error("Missing title or data props"))}function Bae(e){return Object.keys(e)}function U8(e,...t){if(!Wr.plainObject(e))throw new TypeError("Expected an object");const n={};for(const s in e)({}).hasOwnProperty.call(e,s)&&(t.includes(s)||(n[s]=e[s]));return n}function jae(e,...t){if(!Wr.plainObject(e))throw new TypeError("Expected an object");if(!t.length)return e;const n={};for(const s in e)({}).hasOwnProperty.call(e,s)&&t.includes(s)&&(n[s]=e[s]);return n}function MP(e,t,n){const s=u=>u.replace("{step}",String(t)).replace("{steps}",String(n));if(gS(e)==="string")return s(e);if(!X.isValidElement(e))return e;const{children:a}=e.props;if(gS(a)==="string"&&a.includes("{step}"))return X.cloneElement(e,{children:s(a)});if(Array.isArray(a))return X.cloneElement(e,{children:a.map(u=>typeof u=="string"?s(u):MP(u,t,n))});if(gS(e.type)==="function"&&!Object.values(e.props).length){const u=e.type({});return MP(u,t,n)}return e}function Vae(e){const{isFirstStep:t,lifecycle:n,previousLifecycle:s,scrollToFirstStep:a,step:u,target:f}=e;return!u.disableScrolling&&(!t||a||n===ki.TOOLTIP)&&u.placement!=="center"&&(!u.isFixed||!u0(f))&&s!==n&&[ki.BEACON,ki.TOOLTIP].includes(n)}var $ae={options:{preventOverflow:{boundariesElement:"scrollParent"}},wrapperOptions:{offset:-18,position:!0}},G8={back:"Back",close:"Close",last:"Last",next:"Next",nextLabelWithProgress:"Next (Step {step} of {steps})",open:"Open the dialog",skip:"Skip"},Uae={event:"click",placement:"bottom",offset:10,disableBeacon:!1,disableCloseOnEsc:!1,disableOverlay:!1,disableOverlayClose:!1,disableScrollParentFix:!1,disableScrolling:!1,hideBackButton:!1,hideCloseButton:!1,hideFooter:!1,isFixed:!1,locale:G8,showProgress:!1,showSkipButton:!1,spotlightClicks:!1,spotlightPadding:10},Gae={continuous:!1,debug:!1,disableCloseOnEsc:!1,disableOverlay:!1,disableOverlayClose:!1,disableScrolling:!1,disableScrollParentFix:!1,getHelpers:void 0,hideBackButton:!1,run:!0,scrollOffset:20,scrollDuration:300,scrollToFirstStep:!1,showSkipButton:!1,showProgress:!1,spotlightClicks:!1,spotlightPadding:10,steps:[]},Hae={arrowColor:"#fff",backgroundColor:"#fff",beaconSize:36,overlayColor:"rgba(0, 0, 0, 0.5)",primaryColor:"#f04",spotlightShadow:"0 0 15px rgba(0, 0, 0, 0.5)",textColor:"#333",width:380,zIndex:100},Iv={backgroundColor:"transparent",border:0,borderRadius:0,color:"#555",cursor:"pointer",fontSize:16,lineHeight:1,padding:8,WebkitAppearance:"none"},h4={borderRadius:4,position:"absolute"};function Wae(e,t){var n,s,a,u,f;const{floaterProps:_,styles:r}=e,C=Zc((n=t.floaterProps)!=null?n:{},_??{}),k=Zc(r??{},(s=t.styles)!=null?s:{}),I=Zc(Hae,k.options||{}),P=t.placement==="center"||t.disableBeacon;let{width:D}=I;window.innerWidth>480&&(D=380),"width"in I&&(D=typeof I.width=="number"&&window.innerWidth<I.width?window.innerWidth-30:I.width);const N={bottom:0,left:0,overflow:"hidden",position:"absolute",right:0,top:0,zIndex:I.zIndex},j={beacon:{...Iv,display:P?"none":"inline-block",height:I.beaconSize,position:"relative",width:I.beaconSize,zIndex:I.zIndex},beaconInner:{animation:"joyride-beacon-inner 1.2s infinite ease-in-out",backgroundColor:I.primaryColor,borderRadius:"50%",display:"block",height:"50%",left:"50%",opacity:.7,position:"absolute",top:"50%",transform:"translate(-50%, -50%)",width:"50%"},beaconOuter:{animation:"joyride-beacon-outer 1.2s infinite ease-in-out",backgroundColor:`rgba(${Nae(I.primaryColor).join(",")}, 0.2)`,border:`2px solid ${I.primaryColor}`,borderRadius:"50%",boxSizing:"border-box",display:"block",height:"100%",left:0,opacity:.9,position:"absolute",top:0,transformOrigin:"center",width:"100%"},tooltip:{backgroundColor:I.backgroundColor,borderRadius:5,boxSizing:"border-box",color:I.textColor,fontSize:16,maxWidth:"100%",padding:15,position:"relative",width:D},tooltipContainer:{lineHeight:1.4,textAlign:"center"},tooltipTitle:{fontSize:18,margin:0},tooltipContent:{padding:"20px 10px"},tooltipFooter:{alignItems:"center",display:"flex",justifyContent:"flex-end",marginTop:15},tooltipFooterSpacer:{flex:1},buttonNext:{...Iv,backgroundColor:I.primaryColor,borderRadius:4,color:"#fff"},buttonBack:{...Iv,color:I.primaryColor,marginLeft:"auto",marginRight:5},buttonClose:{...Iv,color:I.textColor,height:14,padding:15,position:"absolute",right:0,top:0,width:14},buttonSkip:{...Iv,color:I.textColor,fontSize:14},overlay:{...N,backgroundColor:I.overlayColor,mixBlendMode:"hard-light"},overlayLegacy:{...N},overlayLegacyCenter:{...N,backgroundColor:I.overlayColor},spotlight:{...h4,backgroundColor:"gray"},spotlightLegacy:{...h4,boxShadow:`0 0 0 9999px ${I.overlayColor}, ${I.spotlightShadow}`},floaterStyles:{arrow:{color:(f=(u=(a=C==null?void 0:C.styles)==null?void 0:a.arrow)==null?void 0:u.color)!=null?f:I.arrowColor},options:{zIndex:I.zIndex+100}},options:I};return Zc(j,k)}function qae(e){return jae(e,"beaconComponent","disableCloseOnEsc","disableOverlay","disableOverlayClose","disableScrolling","disableScrollParentFix","floaterProps","hideBackButton","hideCloseButton","locale","showProgress","showSkipButton","spotlightClicks","spotlightPadding","styles","tooltipComponent")}function Wg(e,t){var n,s,a,u,f,_;const r=t??{},C=Zc.all([Uae,qae(e),r],{isMergeableObject:Wr.plainObject}),k=Wae(e,C),I=NE(Th(C.target),C.disableScrollParentFix),P=Zc.all([$ae,(n=e.floaterProps)!=null?n:{},(s=C.floaterProps)!=null?s:{}]);return P.offset=C.offset,P.styles=Zc((a=P.styles)!=null?a:{},k.floaterStyles),P.offset+=(f=(u=e.spotlightPadding)!=null?u:C.spotlightPadding)!=null?f:0,C.placementBeacon&&P.wrapperOptions&&(P.wrapperOptions.placement=C.placementBeacon),I&&P.options.preventOverflow&&(P.options.preventOverflow.boundariesElement="window"),{...C,locale:Zc.all([G8,(_=e.locale)!=null?_:{},C.locale||{}]),floaterProps:P,styles:U8(k,"floaterStyles")}}function H8(e,t=!1){return Wr.plainObject(e)?e.target?!0:(Pm({title:"validateStep",data:"target is missing from the step",warn:!0,debug:t}),!1):(Pm({title:"validateStep",data:"step must be an object",warn:!0,debug:t}),!1)}function f4(e,t=!1){return Wr.array(e)?e.every(n=>H8(n,t)):(Pm({title:"validateSteps",data:"steps must be an array",warn:!0,debug:t}),!1)}var W8={action:"init",controlled:!1,index:0,lifecycle:ki.INIT,origin:null,size:0,status:eo.IDLE},p4=Bae(U8(W8,"controlled","size")),Xae=class{constructor(t){qr(this,"beaconPopper"),qr(this,"tooltipPopper"),qr(this,"data",new Map),qr(this,"listener"),qr(this,"store",new Map),qr(this,"addListener",u=>{this.listener=u}),qr(this,"setSteps",u=>{const{size:f,status:_}=this.getState(),r={size:u.length,status:_};this.data.set("steps",u),_===eo.WAITING&&!f&&u.length&&(r.status=eo.RUNNING),this.setState(r)}),qr(this,"getPopper",u=>u==="beacon"?this.beaconPopper:this.tooltipPopper),qr(this,"setPopper",(u,f)=>{u==="beacon"?this.beaconPopper=f:this.tooltipPopper=f}),qr(this,"cleanupPoppers",()=>{this.beaconPopper=null,this.tooltipPopper=null}),qr(this,"close",(u=null)=>{const{index:f,status:_}=this.getState();_===eo.RUNNING&&this.setState({...this.getNextState({action:Eo.CLOSE,index:f+1,origin:u})})}),qr(this,"go",u=>{const{controlled:f,status:_}=this.getState();if(f||_!==eo.RUNNING)return;const r=this.getSteps()[u];this.setState({...this.getNextState({action:Eo.GO,index:u}),status:r?_:eo.FINISHED})}),qr(this,"info",()=>this.getState()),qr(this,"next",()=>{const{index:u,status:f}=this.getState();f===eo.RUNNING&&this.setState(this.getNextState({action:Eo.NEXT,index:u+1}))}),qr(this,"open",()=>{const{status:u}=this.getState();u===eo.RUNNING&&this.setState({...this.getNextState({action:Eo.UPDATE,lifecycle:ki.TOOLTIP})})}),qr(this,"prev",()=>{const{index:u,status:f}=this.getState();f===eo.RUNNING&&this.setState({...this.getNextState({action:Eo.PREV,index:u-1})})}),qr(this,"reset",(u=!1)=>{const{controlled:f}=this.getState();f||this.setState({...this.getNextState({action:Eo.RESET,index:0}),status:u?eo.RUNNING:eo.READY})}),qr(this,"skip",()=>{const{status:u}=this.getState();u===eo.RUNNING&&this.setState({action:Eo.SKIP,lifecycle:ki.INIT,status:eo.SKIPPED})}),qr(this,"start",u=>{const{index:f,size:_}=this.getState();this.setState({...this.getNextState({action:Eo.START,index:Wr.number(u)?u:f},!0),status:_?eo.RUNNING:eo.WAITING})}),qr(this,"stop",(u=!1)=>{const{index:f,status:_}=this.getState();[eo.FINISHED,eo.SKIPPED].includes(_)||this.setState({...this.getNextState({action:Eo.STOP,index:f+(u?1:0)}),status:eo.PAUSED})}),qr(this,"update",u=>{var f,_;if(!Fae(u,p4))throw new Error(`State is not valid. Valid keys: ${p4.join(", ")}`);this.setState({...this.getNextState({...this.getState(),...u,action:(f=u.action)!=null?f:Eo.UPDATE,origin:(_=u.origin)!=null?_:null},!0)})});const{continuous:n=!1,stepIndex:s,steps:a=[]}=t??{};this.setState({action:Eo.INIT,controlled:Wr.number(s),continuous:n,index:Wr.number(s)?s:0,lifecycle:ki.INIT,origin:null,status:a.length?eo.READY:eo.IDLE},!0),this.beaconPopper=null,this.tooltipPopper=null,this.listener=null,this.setSteps(a)}getState(){return this.store.size?{action:this.store.get("action")||"",controlled:this.store.get("controlled")||!1,index:parseInt(this.store.get("index"),10),lifecycle:this.store.get("lifecycle")||"",origin:this.store.get("origin")||null,size:this.store.get("size")||0,status:this.store.get("status")||""}:{...W8}}getNextState(t,n=!1){var s,a,u,f,_;const{action:r,controlled:C,index:k,size:I,status:P}=this.getState(),D=Wr.number(t.index)?t.index:k,N=C&&!n?k:Math.min(Math.max(D,0),I);return{action:(s=t.action)!=null?s:r,controlled:C,index:N,lifecycle:(a=t.lifecycle)!=null?a:ki.INIT,origin:(u=t.origin)!=null?u:null,size:(f=t.size)!=null?f:I,status:N===I?eo.FINISHED:(_=t.status)!=null?_:P}}getSteps(){const t=this.data.get("steps");return Array.isArray(t)?t:[]}hasUpdatedState(t){const n=JSON.stringify(t),s=JSON.stringify(this.getState());return n!==s}setState(t,n=!1){const s=this.getState(),{action:a,index:u,lifecycle:f,origin:_=null,size:r,status:C}={...s,...t};this.store.set("action",a),this.store.set("index",u),this.store.set("lifecycle",f),this.store.set("origin",_),this.store.set("size",r),this.store.set("status",C),n&&(this.store.set("controlled",t.controlled),this.store.set("continuous",t.continuous)),this.listener&&this.hasUpdatedState(s)&&this.listener(this.getState())}getHelpers(){return{close:this.close,go:this.go,info:this.info,next:this.next,open:this.open,prev:this.prev,reset:this.reset,skip:this.skip}}};function Yae(e){return new Xae(e)}function Zae({styles:e}){return X.createElement("div",{key:"JoyrideSpotlight",className:"react-joyride__spotlight","data-test-id":"spotlight",style:e})}var Kae=Zae,Jae=class extends X.Component{constructor(){super(...arguments),qr(this,"isActive",!1),qr(this,"resizeTimeout"),qr(this,"scrollTimeout"),qr(this,"scrollParent"),qr(this,"state",{isScrolling:!1,mouseOverSpotlight:!1,showSpotlight:!0}),qr(this,"hideSpotlight",()=>{const{continuous:e,disableOverlay:t,lifecycle:n}=this.props,s=[ki.INIT,ki.BEACON,ki.COMPLETE,ki.ERROR];return t||(e?s.includes(n):n!==ki.TOOLTIP)}),qr(this,"handleMouseMove",e=>{const{mouseOverSpotlight:t}=this.state,{height:n,left:s,position:a,top:u,width:f}=this.spotlightStyles,_=a==="fixed"?e.clientY:e.pageY,r=a==="fixed"?e.clientX:e.pageX,C=_>=u&&_<=u+n,I=r>=s&&r<=s+f&&C;I!==t&&this.updateState({mouseOverSpotlight:I})}),qr(this,"handleScroll",()=>{const{target:e}=this.props,t=Th(e);if(this.scrollParent!==document){const{isScrolling:n}=this.state;n||this.updateState({isScrolling:!0,showSpotlight:!1}),clearTimeout(this.scrollTimeout),this.scrollTimeout=window.setTimeout(()=>{this.updateState({isScrolling:!1,showSpotlight:!0})},50)}else u0(t,"sticky")&&this.updateState({})}),qr(this,"handleResize",()=>{clearTimeout(this.resizeTimeout),this.resizeTimeout=window.setTimeout(()=>{this.isActive&&this.forceUpdate()},100)})}componentDidMount(){const{debug:e,disableScrolling:t,disableScrollParentFix:n=!1,target:s}=this.props,a=Th(s);this.scrollParent=Hx(a??document.body,n,!0),this.isActive=!0,window.addEventListener("resize",this.handleResize)}componentDidUpdate(e){var t;const{disableScrollParentFix:n,lifecycle:s,spotlightClicks:a,target:u}=this.props,{changed:f}=pC(e,this.props);if(f("target")||f("disableScrollParentFix")){const _=Th(u);this.scrollParent=Hx(_??document.body,n,!0)}f("lifecycle",ki.TOOLTIP)&&((t=this.scrollParent)==null||t.addEventListener("scroll",this.handleScroll,{passive:!0}),setTimeout(()=>{const{isScrolling:_}=this.state;_||this.updateState({showSpotlight:!0})},100)),(f("spotlightClicks")||f("disableOverlay")||f("lifecycle"))&&(a&&s===ki.TOOLTIP?window.addEventListener("mousemove",this.handleMouseMove,!1):s!==ki.TOOLTIP&&window.removeEventListener("mousemove",this.handleMouseMove))}componentWillUnmount(){var e;this.isActive=!1,window.removeEventListener("mousemove",this.handleMouseMove),window.removeEventListener("resize",this.handleResize),clearTimeout(this.resizeTimeout),clearTimeout(this.scrollTimeout),(e=this.scrollParent)==null||e.removeEventListener("scroll",this.handleScroll)}get overlayStyles(){const{mouseOverSpotlight:e}=this.state,{disableOverlayClose:t,placement:n,styles:s}=this.props;let a=s.overlay;return d4()&&(a=n==="center"?s.overlayLegacyCenter:s.overlayLegacy),{cursor:t?"default":"pointer",height:Pae(),pointerEvents:e?"none":"auto",...a}}get spotlightStyles(){var e,t,n;const{showSpotlight:s}=this.state,{disableScrollParentFix:a=!1,spotlightClicks:u,spotlightPadding:f=0,styles:_,target:r}=this.props,C=Th(r),k=V8(C),I=u0(C),P=Oae(C,f,a);return{...d4()?_.spotlightLegacy:_.spotlight,height:Math.round(((e=k==null?void 0:k.height)!=null?e:0)+f*2),left:Math.round(((t=k==null?void 0:k.left)!=null?t:0)-f),opacity:s?1:0,pointerEvents:u?"none":"auto",position:I?"fixed":"absolute",top:P,transition:"opacity 0.2s",width:Math.round(((n=k==null?void 0:k.width)!=null?n:0)+f*2)}}updateState(e){this.isActive&&this.setState(t=>({...t,...e}))}render(){const{showSpotlight:e}=this.state,{onClickOverlay:t,placement:n}=this.props,{hideSpotlight:s,overlayStyles:a,spotlightStyles:u}=this;if(s())return null;let f=n!=="center"&&e&&X.createElement(Kae,{styles:u});if($8()==="safari"){const{mixBlendMode:_,zIndex:r,...C}=a;f=X.createElement("div",{style:{...C}},f),delete a.backgroundColor}return X.createElement("div",{className:"react-joyride__overlay","data-test-id":"overlay",onClick:t,role:"presentation",style:a},f)}},Qae=class extends X.Component{constructor(){super(...arguments),qr(this,"node",null)}componentDidMount(){const{id:e}=this.props;Nf()&&(this.node=document.createElement("div"),this.node.id=e,document.body.appendChild(this.node),Tv||this.renderReact15())}componentDidUpdate(){Nf()&&(Tv||this.renderReact15())}componentWillUnmount(){!Nf()||!this.node||(Tv||kh.unmountComponentAtNode(this.node),this.node.parentNode===document.body&&(document.body.removeChild(this.node),this.node=null))}renderReact15(){if(!Nf())return;const{children:e}=this.props;this.node&&kh.unstable_renderSubtreeIntoContainer(this,e,this.node)}renderReact16(){if(!Nf()||!Tv)return null;const{children:e}=this.props;return this.node?kh.createPortal(e,this.node):null}render(){return Tv?this.renderReact16():null}},ele=class{constructor(e,t){if(qr(this,"element"),qr(this,"options"),qr(this,"canBeTabbed",n=>{const{tabIndex:s}=n;return s===null||s<0?!1:this.canHaveFocus(n)}),qr(this,"canHaveFocus",n=>{const s=/input|select|textarea|button|object/,a=n.nodeName.toLowerCase();return(s.test(a)&&!n.getAttribute("disabled")||a==="a"&&!!n.getAttribute("href"))&&this.isVisible(n)}),qr(this,"findValidTabElements",()=>[].slice.call(this.element.querySelectorAll("*"),0).filter(this.canBeTabbed)),qr(this,"handleKeyDown",n=>{const{code:s="Tab"}=this.options;n.code===s&&this.interceptTab(n)}),qr(this,"interceptTab",n=>{n.preventDefault();const s=this.findValidTabElements(),{shiftKey:a}=n;if(!s.length)return;let u=document.activeElement?s.indexOf(document.activeElement):0;u===-1||!a&&u+1===s.length?u=0:a&&u===0?u=s.length-1:u+=a?-1:1,s[u].focus()}),qr(this,"isHidden",n=>{const s=n.offsetWidth<=0&&n.offsetHeight<=0,a=window.getComputedStyle(n);return s&&!n.innerHTML?!0:s&&a.getPropertyValue("overflow")!=="visible"||a.getPropertyValue("display")==="none"}),qr(this,"isVisible",n=>{let s=n;for(;s;)if(s instanceof HTMLElement){if(s===document.body)break;if(this.isHidden(s))return!1;s=s.parentNode}return!0}),qr(this,"removeScope",()=>{window.removeEventListener("keydown",this.handleKeyDown)}),qr(this,"checkFocus",n=>{document.activeElement!==n&&(n.focus(),window.requestAnimationFrame(()=>this.checkFocus(n)))}),qr(this,"setFocus",()=>{const{selector:n}=this.options;if(!n)return;const s=this.element.querySelector(n);s&&window.requestAnimationFrame(()=>this.checkFocus(s))}),!(e instanceof HTMLElement))throw new TypeError("Invalid parameter: element must be an HTMLElement");this.element=e,this.options=t,window.addEventListener("keydown",this.handleKeyDown,!1),this.setFocus()}},tle=class extends X.Component{constructor(e){if(super(e),qr(this,"beacon",null),qr(this,"setBeaconRef",a=>{this.beacon=a}),e.beaconComponent)return;const t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.id="joyride-beacon-animation",e.nonce&&n.setAttribute("nonce",e.nonce),n.appendChild(document.createTextNode(`
        @keyframes joyride-beacon-inner {
          20% {
            opacity: 0.9;
          }
        
          90% {
            opacity: 0.7;
          }
        }
        
        @keyframes joyride-beacon-outer {
          0% {
            transform: scale(1);
          }
        
          45% {
            opacity: 0.7;
            transform: scale(0.75);
          }
        
          100% {
            opacity: 0.9;
            transform: scale(1);
          }
        }
      `)),t.appendChild(n)}componentDidMount(){const{shouldFocus:e}=this.props;setTimeout(()=>{Wr.domElement(this.beacon)&&e&&this.beacon.focus()},0)}componentWillUnmount(){const e=document.getElementById("joyride-beacon-animation");e!=null&&e.parentNode&&e.parentNode.removeChild(e)}render(){const{beaconComponent:e,continuous:t,index:n,isLastStep:s,locale:a,onClickOrHover:u,size:f,step:_,styles:r}=this.props,C=Od(a.open),k={"aria-label":C,onClick:u,onMouseEnter:u,ref:this.setBeaconRef,title:C};let I;if(e){const P=e;I=X.createElement(P,{continuous:t,index:n,isLastStep:s,size:f,step:_,...k})}else I=X.createElement("button",{key:"JoyrideBeacon",className:"react-joyride__beacon","data-test-id":"button-beacon",style:r.beacon,type:"button",...k},X.createElement("span",{style:r.beaconInner}),X.createElement("span",{style:r.beaconOuter}));return I}};function nle({styles:e,...t}){const{color:n,height:s,width:a,...u}=e;return Sr.createElement("button",{style:u,type:"button",...t},Sr.createElement("svg",{height:typeof s=="number"?`${s}px`:s,preserveAspectRatio:"xMidYMid",version:"1.1",viewBox:"0 0 18 18",width:typeof a=="number"?`${a}px`:a,xmlns:"http://www.w3.org/2000/svg"},Sr.createElement("g",null,Sr.createElement("path",{d:"M8.13911129,9.00268191 L0.171521827,17.0258467 C-0.0498027049,17.248715 -0.0498027049,17.6098394 0.171521827,17.8327545 C0.28204354,17.9443526 0.427188206,17.9998706 0.572051765,17.9998706 C0.71714958,17.9998706 0.862013139,17.9443526 0.972581703,17.8327545 L9.0000937,9.74924618 L17.0276057,17.8327545 C17.1384085,17.9443526 17.2832721,17.9998706 17.4281356,17.9998706 C17.5729992,17.9998706 17.718097,17.9443526 17.8286656,17.8327545 C18.0499901,17.6098862 18.0499901,17.2487618 17.8286656,17.0258467 L9.86135722,9.00268191 L17.8340066,0.973848225 C18.0553311,0.750979934 18.0553311,0.389855532 17.8340066,0.16694039 C17.6126821,-0.0556467968 17.254037,-0.0556467968 17.0329467,0.16694039 L9.00042166,8.25611765 L0.967006424,0.167268345 C0.745681892,-0.0553188426 0.387317931,-0.0553188426 0.165993399,0.167268345 C-0.0553311331,0.390136635 -0.0553311331,0.751261038 0.165993399,0.974176179 L8.13920499,9.00268191 L8.13911129,9.00268191 Z",fill:n}))))}var rle=nle;function ile(e){const{backProps:t,closeProps:n,index:s,isLastStep:a,primaryProps:u,skipProps:f,step:_,tooltipProps:r}=e,{content:C,hideBackButton:k,hideCloseButton:I,hideFooter:P,showSkipButton:D,styles:N,title:j}=_,W={};return W.primary=X.createElement("button",{"data-test-id":"button-primary",style:N.buttonNext,type:"button",...u}),D&&!a&&(W.skip=X.createElement("button",{"aria-live":"off","data-test-id":"button-skip",style:N.buttonSkip,type:"button",...f})),!k&&s>0&&(W.back=X.createElement("button",{"data-test-id":"button-back",style:N.buttonBack,type:"button",...t})),W.close=!I&&X.createElement(rle,{"data-test-id":"button-close",styles:N.buttonClose,...n}),X.createElement("div",{key:"JoyrideTooltip","aria-label":Od(j??C),className:"react-joyride__tooltip",style:N.tooltip,...r},X.createElement("div",{style:N.tooltipContainer},j&&X.createElement("h1",{"aria-label":Od(j),style:N.tooltipTitle},j),X.createElement("div",{style:N.tooltipContent},C)),!P&&X.createElement("div",{style:N.tooltipFooter},X.createElement("div",{style:N.tooltipFooterSpacer},W.skip),W.back,W.primary),W.close)}var ole=ile,sle=class extends X.Component{constructor(){super(...arguments),qr(this,"handleClickBack",e=>{e.preventDefault();const{helpers:t}=this.props;t.prev()}),qr(this,"handleClickClose",e=>{e.preventDefault();const{helpers:t}=this.props;t.close("button_close")}),qr(this,"handleClickPrimary",e=>{e.preventDefault();const{continuous:t,helpers:n}=this.props;if(!t){n.close("button_primary");return}n.next()}),qr(this,"handleClickSkip",e=>{e.preventDefault();const{helpers:t}=this.props;t.skip()}),qr(this,"getElementsProps",()=>{const{continuous:e,index:t,isLastStep:n,setTooltipRef:s,size:a,step:u}=this.props,{back:f,close:_,last:r,next:C,nextLabelWithProgress:k,skip:I}=u.locale,P=Od(f),D=Od(_),N=Od(r),j=Od(C),W=Od(I);let H=_,q=D;if(e){if(H=C,q=j,u.showProgress&&!n){const Z=Od(k,{step:t+1,steps:a});H=MP(k,t+1,a),q=Z}n&&(H=r,q=N)}return{backProps:{"aria-label":P,children:f,"data-action":"back",onClick:this.handleClickBack,role:"button",title:P},closeProps:{"aria-label":D,children:_,"data-action":"close",onClick:this.handleClickClose,role:"button",title:D},primaryProps:{"aria-label":q,children:H,"data-action":"primary",onClick:this.handleClickPrimary,role:"button",title:q},skipProps:{"aria-label":W,children:I,"data-action":"skip",onClick:this.handleClickSkip,role:"button",title:W},tooltipProps:{"aria-modal":!0,ref:s,role:"alertdialog"}}})}render(){const{continuous:e,index:t,isLastStep:n,setTooltipRef:s,size:a,step:u}=this.props,{beaconComponent:f,tooltipComponent:_,...r}=u;let C;if(_){const k={...this.getElementsProps(),continuous:e,index:t,isLastStep:n,size:a,step:r,setTooltipRef:s},I=_;C=X.createElement(I,{...k})}else C=X.createElement(ole,{...this.getElementsProps(),continuous:e,index:t,isLastStep:n,size:a,step:u});return C}},ale=class extends X.Component{constructor(){super(...arguments),qr(this,"scope",null),qr(this,"tooltip",null),qr(this,"handleClickHoverBeacon",e=>{const{step:t,store:n}=this.props;e.type==="mouseenter"&&t.event!=="hover"||n.update({lifecycle:ki.TOOLTIP})}),qr(this,"setTooltipRef",e=>{this.tooltip=e}),qr(this,"setPopper",(e,t)=>{var n;const{action:s,lifecycle:a,step:u,store:f}=this.props;t==="wrapper"?f.setPopper("beacon",e):f.setPopper("tooltip",e),f.getPopper("beacon")&&(f.getPopper("tooltip")||u.placement==="center")&&a===ki.INIT&&f.update({action:s,lifecycle:ki.READY}),(n=u.floaterProps)!=null&&n.getPopper&&u.floaterProps.getPopper(e,t)}),qr(this,"renderTooltip",e=>{const{continuous:t,helpers:n,index:s,size:a,step:u}=this.props;return X.createElement(sle,{continuous:t,helpers:n,index:s,isLastStep:s+1===a,setTooltipRef:this.setTooltipRef,size:a,step:u,...e})})}componentDidMount(){const{debug:e,index:t}=this.props;Pm({title:`step:${t}`,data:[{key:"props",value:this.props}],debug:e})}componentDidUpdate(e){var t;const{action:n,callback:s,continuous:a,controlled:u,debug:f,helpers:_,index:r,lifecycle:C,shouldScroll:k,status:I,step:P,store:D}=this.props,{changed:N,changedFrom:j}=pC(e,this.props),W=_.info(),H=a&&n!==Eo.CLOSE&&(r>0||n===Eo.PREV),q=N("action")||N("index")||N("lifecycle")||N("status"),Z=j("lifecycle",[ki.TOOLTIP,ki.INIT],ki.INIT),re=N("action",[Eo.NEXT,Eo.PREV,Eo.SKIP,Eo.CLOSE]),le=u&&r===e.index;if(re&&(Z||le)&&s({...W,index:e.index,lifecycle:ki.COMPLETE,step:e.step,type:Wc.STEP_AFTER}),P.placement==="center"&&I===eo.RUNNING&&N("index")&&n!==Eo.START&&C===ki.INIT&&D.update({lifecycle:ki.READY}),q){const _e=Th(P.target),ye=!!_e;ye&&Rae(_e)?(j("status",eo.READY,eo.RUNNING)||j("lifecycle",ki.INIT,ki.READY))&&s({...W,step:P,type:Wc.STEP_BEFORE}):(console.warn(ye?"Target not visible":"Target not mounted",P),s({...W,type:Wc.TARGET_NOT_FOUND,step:P}),u||D.update({index:r+(n===Eo.PREV?-1:1)}))}j("lifecycle",ki.INIT,ki.READY)&&D.update({lifecycle:c4(P)||H?ki.TOOLTIP:ki.BEACON}),N("index")&&Pm({title:`step:${C}`,data:[{key:"props",value:this.props}],debug:f}),N("lifecycle",ki.BEACON)&&s({...W,step:P,type:Wc.BEACON}),N("lifecycle",ki.TOOLTIP)&&(s({...W,step:P,type:Wc.TOOLTIP}),k&&this.tooltip&&(this.scope=new ele(this.tooltip,{selector:"[data-action=primary]"}),this.scope.setFocus())),j("lifecycle",[ki.TOOLTIP,ki.INIT],ki.INIT)&&((t=this.scope)==null||t.removeScope(),D.cleanupPoppers())}componentWillUnmount(){var e;(e=this.scope)==null||e.removeScope()}get open(){const{lifecycle:e,step:t}=this.props;return c4(t)||e===ki.TOOLTIP}render(){const{continuous:e,debug:t,index:n,nonce:s,shouldScroll:a,size:u,step:f}=this.props,_=Th(f.target);return!H8(f)||!Wr.domElement(_)?null:X.createElement("div",{key:`JoyrideStep-${n}`,className:"react-joyride__step"},X.createElement(kA,{...f.floaterProps,component:this.renderTooltip,debug:t,getPopper:this.setPopper,id:`react-joyride-step-${n}`,open:this.open,placement:f.placement,target:f.target},X.createElement(tle,{beaconComponent:f.beaconComponent,continuous:e,index:n,isLastStep:n+1===u,locale:f.locale,nonce:s,onClickOrHover:this.handleClickHoverBeacon,shouldFocus:a,size:u,step:f,styles:f.styles})))}},q8=class extends X.Component{constructor(e){super(e),qr(this,"helpers"),qr(this,"store"),qr(this,"callback",f=>{const{callback:_}=this.props;Wr.function(_)&&_(f)}),qr(this,"handleKeyboard",f=>{const{index:_,lifecycle:r}=this.state,{steps:C}=this.props,k=C[_];r===ki.TOOLTIP&&f.code==="Escape"&&k&&!k.disableCloseOnEsc&&this.store.close("keyboard")}),qr(this,"handleClickOverlay",()=>{const{index:f}=this.state,{steps:_}=this.props;Wg(this.props,_[f]).disableOverlayClose||this.helpers.close("overlay")}),qr(this,"syncState",f=>{this.setState(f)});const{debug:t,getHelpers:n,run:s=!0,stepIndex:a}=e;this.store=Yae({...e,controlled:s&&Wr.number(a)}),this.helpers=this.store.getHelpers();const{addListener:u}=this.store;Pm({title:"init",data:[{key:"props",value:this.props},{key:"state",value:this.state}],debug:t}),u(this.syncState),n&&n(this.helpers),this.state=this.store.getState()}componentDidMount(){if(!Nf())return;const{debug:e,disableCloseOnEsc:t,run:n,steps:s}=this.props,{start:a}=this.store;f4(s,e)&&n&&a(),t||document.body.addEventListener("keydown",this.handleKeyboard,{passive:!0})}componentDidUpdate(e,t){if(!Nf())return;const{action:n,controlled:s,index:a,status:u}=this.state,{debug:f,run:_,stepIndex:r,steps:C}=this.props,{stepIndex:k,steps:I}=e,{reset:P,setSteps:D,start:N,stop:j,update:W}=this.store,{changed:H}=pC(e,this.props),{changed:q,changedFrom:Z}=pC(t,this.state),re=Wg(this.props,C[a]),le=!Rl(I,C),_e=Wr.number(r)&&H("stepIndex"),ye=Th(re.target);if(le&&(f4(C,f)?D(C):console.warn("Steps are not valid",C)),H("run")&&(_?N(r):j()),_e){let oe=Wr.number(k)&&k<r?Eo.NEXT:Eo.PREV;n===Eo.STOP&&(oe=Eo.START),[eo.FINISHED,eo.SKIPPED].includes(u)||W({action:n===Eo.CLOSE?Eo.CLOSE:oe,index:r,lifecycle:ki.INIT})}!s&&u===eo.RUNNING&&a===0&&!ye&&(this.store.update({index:a+1}),this.callback({...this.state,type:Wc.TARGET_NOT_FOUND,step:re}));const de={...this.state,index:a,step:re};if(q("action",[Eo.NEXT,Eo.PREV,Eo.SKIP,Eo.CLOSE])&&q("status",eo.PAUSED)){const oe=Wg(this.props,C[t.index]);this.callback({...de,index:t.index,lifecycle:ki.COMPLETE,step:oe,type:Wc.STEP_AFTER})}if(q("status",[eo.FINISHED,eo.SKIPPED])){const oe=Wg(this.props,C[t.index]);s||this.callback({...de,index:t.index,lifecycle:ki.COMPLETE,step:oe,type:Wc.STEP_AFTER}),this.callback({...de,type:Wc.TOUR_END,step:oe,index:t.index}),P()}else Z("status",[eo.IDLE,eo.READY],eo.RUNNING)?this.callback({...de,type:Wc.TOUR_START}):(q("status")||q("action",Eo.RESET))&&this.callback({...de,type:Wc.TOUR_STATUS});this.scrollToStep(t)}componentWillUnmount(){const{disableCloseOnEsc:e}=this.props;e||document.body.removeEventListener("keydown",this.handleKeyboard)}scrollToStep(e){const{index:t,lifecycle:n,status:s}=this.state,{debug:a,disableScrollParentFix:u=!1,scrollDuration:f,scrollOffset:_=20,scrollToFirstStep:r=!1,steps:C}=this.props,k=Wg(this.props,C[t]),I=Th(k.target),P=Vae({isFirstStep:t===0,lifecycle:n,previousLifecycle:e.lifecycle,scrollToFirstStep:r,step:k,target:I});if(s===eo.RUNNING&&P){const D=NE(I,u),N=Hx(I,u);let j=Math.floor(Dae(I,_,u))||0;Pm({title:"scrollToStep",data:[{key:"index",value:t},{key:"lifecycle",value:n},{key:"status",value:s}],debug:a});const W=this.store.getPopper("beacon"),H=this.store.getPopper("tooltip");if(n===ki.BEACON&&W){const{offsets:q,placement:Z}=W;!["bottom"].includes(Z)&&!D&&(j=Math.floor(q.popper.top-_))}else if(n===ki.TOOLTIP&&H){const{flipped:q,offsets:Z,placement:re}=H;["top","right","left"].includes(re)&&!q&&!D?j=Math.floor(Z.popper.top-_):j-=k.spotlightPadding}j=j>=0?j:0,s===eo.RUNNING&&zae(j,{element:N,duration:f}).then(()=>{setTimeout(()=>{var q;(q=this.store.getPopper("tooltip"))==null||q.instance.update()},10)})}}render(){if(!Nf())return null;const{index:e,lifecycle:t,status:n}=this.state,{continuous:s=!1,debug:a=!1,nonce:u,scrollToFirstStep:f=!1,steps:_}=this.props,r=n===eo.RUNNING,C={};if(r&&_[e]){const k=Wg(this.props,_[e]);C.step=X.createElement(ale,{...this.state,callback:this.callback,continuous:s,debug:a,helpers:this.helpers,nonce:u,shouldScroll:!k.disableScrolling&&(e!==0||f),step:k,store:this.store}),C.overlay=X.createElement(Qae,{id:"react-joyride-portal"},X.createElement(Jae,{...k,continuous:s,debug:a,lifecycle:t,onClickOverlay:this.handleClickOverlay}))}return X.createElement("div",{className:"react-joyride"},C.step,C.overlay)}};qr(q8,"defaultProps",Gae);var lle=q8;const BE=({steps:e,run:t,onClose:n,continuous:s=!0,showSkipButton:a=!1,showProgress:u=!0})=>{const f=_=>{const{status:r,action:C}=_;(r==="skipped"||C==="close")&&n(),r==="finished"&&n()};return K.jsx(lle,{steps:e,run:t,callback:f,continuous:s,showSkipButton:a,showProgress:u,scrollToFirstStep:!1,disableScrolling:!0,styles:{options:{arrowColor:"#555555",backgroundColor:"#555555",overlayColor:"rgba(0, 0, 0, 0.5)",primaryColor:"#A8D99C",textColor:"white",zIndex:2e3},buttonBack:{backgroundColor:"#ECAC7A",color:"#000",borderRadius:"4px",padding:"8px 16px",fontSize:"14px"},buttonNext:{backgroundColor:"#A8D99C",color:"#000",borderRadius:"4px",padding:"8px 16px",fontSize:"14px"},buttonClose:{backgroundColor:"transparent",color:"#ffffff",fontSize:"14px"},buttonSkip:{backgroundColor:"#FF6F61",color:"#ffffff",borderRadius:"4px",padding:"8px 16px"},tooltipContent:{color:"#FFFFFF",fontSize:"15px"}}})};function X8(e){var t,n,s="";if(typeof e=="string"||typeof e=="number")s+=e;else if(typeof e=="object")if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=X8(e[t]))&&(s&&(s+=" "),s+=n);else for(t in e)e[t]&&(s&&(s+=" "),s+=t);return s}function Vm(){for(var e,t,n=0,s="";n<arguments.length;)(e=arguments[n++])&&(t=X8(e))&&(s&&(s+=" "),s+=t);return s}let ule={data:""},cle=e=>typeof window=="object"?((e?e.querySelector("#_goober"):window._goober)||Object.assign((e||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:e||ule,dle=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,hle=/\/\*[^]*?\*\/|  +/g,m4=/\n+/g,am=(e,t)=>{let n="",s="",a="";for(let u in e){let f=e[u];u[0]=="@"?u[1]=="i"?n=u+" "+f+";":s+=u[1]=="f"?am(f,u):u+"{"+am(f,u[1]=="k"?"":t)+"}":typeof f=="object"?s+=am(f,t?t.replace(/([^,])+/g,_=>u.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,r=>/&/.test(r)?r.replace(/&/g,_):_?_+" "+r:r)):u):f!=null&&(u=/^--/.test(u)?u:u.replace(/[A-Z]/g,"-$&").toLowerCase(),a+=am.p?am.p(u,f):u+":"+f+";")}return n+(t&&a?t+"{"+a+"}":a)+s},gh={},Y8=e=>{if(typeof e=="object"){let t="";for(let n in e)t+=n+Y8(e[n]);return t}return e},fle=(e,t,n,s,a)=>{let u=Y8(e),f=gh[u]||(gh[u]=(r=>{let C=0,k=11;for(;C<r.length;)k=101*k+r.charCodeAt(C++)>>>0;return"go"+k})(u));if(!gh[f]){let r=u!==e?e:(C=>{let k,I,P=[{}];for(;k=dle.exec(C.replace(hle,""));)k[4]?P.shift():k[3]?(I=k[3].replace(m4," ").trim(),P.unshift(P[0][I]=P[0][I]||{})):P[0][k[1]]=k[2].replace(m4," ").trim();return P[0]})(e);gh[f]=am(a?{["@keyframes "+f]:r}:r,n?"":"."+f)}let _=n&&gh.g?gh.g:null;return n&&(gh.g=gh[f]),((r,C,k,I)=>{I?C.data=C.data.replace(I,r):C.data.indexOf(r)===-1&&(C.data=k?r+C.data:C.data+r)})(gh[f],t,s,_),f},ple=(e,t,n)=>e.reduce((s,a,u)=>{let f=t[u];if(f&&f.call){let _=f(n),r=_&&_.props&&_.props.className||/^go/.test(_)&&_;f=r?"."+r:_&&typeof _=="object"?_.props?"":am(_,""):_===!1?"":_}return s+a+(f??"")},"");function MA(e){let t=this||{},n=e.call?e(t.p):e;return fle(n.unshift?n.raw?ple(n,[].slice.call(arguments,1),t.p):n.reduce((s,a)=>Object.assign(s,a&&a.call?a(t.p):a),{}):n,cle(t.target),t.g,t.o,t.k)}MA.bind({g:1});MA.bind({k:1});function mle(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function Z8(e,t,n){return t&&mle(e.prototype,t),e}function Uo(){return Uo=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Uo.apply(this,arguments)}function K8(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function x1(e,t){if(e==null)return{};var n={},s=Object.keys(e),a,u;for(u=0;u<s.length;u++)a=s[u],!(t.indexOf(a)>=0)&&(n[a]=e[a]);return n}function g4(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var y4=function(){return""},J8=Sr.createContext({enqueueSnackbar:y4,closeSnackbar:y4}),om={downXs:"@media (max-width:599.95px)",upSm:"@media (min-width:600px)"},_4=function(t){return t.charAt(0).toUpperCase()+t.slice(1)},PA=function(t){return""+_4(t.vertical)+_4(t.horizontal)},Nw=function(t){return!!t||t===0},Bw="unmounted",qg="exited",Xg="entering",kv="entered",v4="exiting",AA=function(e){K8(t,e);function t(s){var a;a=e.call(this,s)||this;var u=s.appear,f;return a.appearStatus=null,s.in?u?(f=qg,a.appearStatus=Xg):f=kv:s.unmountOnExit||s.mountOnEnter?f=Bw:f=qg,a.state={status:f},a.nextCallback=null,a}t.getDerivedStateFromProps=function(a,u){var f=a.in;return f&&u.status===Bw?{status:qg}:null};var n=t.prototype;return n.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},n.componentDidUpdate=function(a){var u=null;if(a!==this.props){var f=this.state.status;this.props.in?f!==Xg&&f!==kv&&(u=Xg):(f===Xg||f===kv)&&(u=v4)}this.updateStatus(!1,u)},n.componentWillUnmount=function(){this.cancelNextCallback()},n.getTimeouts=function(){var a=this.props.timeout,u=a,f=a;return a!=null&&typeof a!="number"&&typeof a!="string"&&(f=a.exit,u=a.enter),{exit:f,enter:u}},n.updateStatus=function(a,u){a===void 0&&(a=!1),u!==null?(this.cancelNextCallback(),u===Xg?this.performEnter(a):this.performExit()):this.props.unmountOnExit&&this.state.status===qg&&this.setState({status:Bw})},n.performEnter=function(a){var u=this,f=this.props.enter,_=a,r=this.getTimeouts();if(!a&&!f){this.safeSetState({status:kv},function(){u.props.onEntered&&u.props.onEntered(u.node,_)});return}this.props.onEnter&&this.props.onEnter(this.node,_),this.safeSetState({status:Xg},function(){u.props.onEntering&&u.props.onEntering(u.node,_),u.onTransitionEnd(r.enter,function(){u.safeSetState({status:kv},function(){u.props.onEntered&&u.props.onEntered(u.node,_)})})})},n.performExit=function(){var a=this,u=this.props.exit,f=this.getTimeouts();if(!u){this.safeSetState({status:qg},function(){a.props.onExited&&a.props.onExited(a.node)});return}this.props.onExit&&this.props.onExit(this.node),this.safeSetState({status:v4},function(){a.props.onExiting&&a.props.onExiting(a.node),a.onTransitionEnd(f.exit,function(){a.safeSetState({status:qg},function(){a.props.onExited&&a.props.onExited(a.node)})})})},n.cancelNextCallback=function(){this.nextCallback!==null&&this.nextCallback.cancel&&(this.nextCallback.cancel(),this.nextCallback=null)},n.safeSetState=function(a,u){u=this.setNextCallback(u),this.setState(a,u)},n.setNextCallback=function(a){var u=this,f=!0;return this.nextCallback=function(){f&&(f=!1,u.nextCallback=null,a())},this.nextCallback.cancel=function(){f=!1},this.nextCallback},n.onTransitionEnd=function(a,u){this.setNextCallback(u);var f=a==null&&!this.props.addEndListener;if(!this.node||f){setTimeout(this.nextCallback,0);return}this.props.addEndListener&&this.props.addEndListener(this.node,this.nextCallback),a!=null&&setTimeout(this.nextCallback,a)},n.render=function(){var a=this.state.status;if(a===Bw)return null;var u=this.props,f=u.children,_=x1(u,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return f(a,_)},Z8(t,[{key:"node",get:function(){var a,u=(a=this.props.nodeRef)===null||a===void 0?void 0:a.current;if(!u)throw new Error("notistack - Custom snackbar is not refForwarding");return u}}]),t}(Sr.Component);function Yg(){}AA.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:Yg,onEntering:Yg,onEntered:Yg,onExit:Yg,onExiting:Yg,onExited:Yg};function x4(e,t){typeof e=="function"?e(t):e&&(e.current=t)}function PP(e,t){return X.useMemo(function(){return e==null&&t==null?null:function(n){x4(e,n),x4(t,n)}},[e,t])}function _C(e){var t=e.timeout,n=e.style,s=n===void 0?{}:n,a=e.mode;return{duration:typeof t=="object"?t[a]||0:t,easing:s.transitionTimingFunction,delay:s.transitionDelay}}var AP={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},Q8=function(t){t.scrollTop=t.scrollTop},b4=function(t){return Math.round(t)+"ms"};function wy(e,t){e===void 0&&(e=["all"]);var n=t||{},s=n.duration,a=s===void 0?300:s,u=n.easing,f=u===void 0?AP.easeInOut:u,_=n.delay,r=_===void 0?0:_,C=Array.isArray(e)?e:[e];return C.map(function(k){var I=typeof a=="string"?a:b4(a),P=typeof r=="string"?r:b4(r);return k+" "+I+" "+f+" "+P}).join(",")}function gle(e){return e&&e.ownerDocument||document}function eV(e){var t=gle(e);return t.defaultView||window}function yle(e,t){t===void 0&&(t=166);var n;function s(){for(var a=this,u=arguments.length,f=new Array(u),_=0;_<u;_++)f[_]=arguments[_];var r=function(){e.apply(a,f)};clearTimeout(n),n=setTimeout(r,t)}return s.clear=function(){clearTimeout(n)},s}function _le(e,t){var n=t.getBoundingClientRect(),s=eV(t),a;if(t.fakeTransform)a=t.fakeTransform;else{var u=s.getComputedStyle(t);a=u.getPropertyValue("-webkit-transform")||u.getPropertyValue("transform")}var f=0,_=0;if(a&&a!=="none"&&typeof a=="string"){var r=a.split("(")[1].split(")")[0].split(",");f=parseInt(r[4],10),_=parseInt(r[5],10)}switch(e){case"left":return"translateX("+(s.innerWidth+f-n.left)+"px)";case"right":return"translateX(-"+(n.left+n.width-f)+"px)";case"up":return"translateY("+(s.innerHeight+_-n.top)+"px)";default:return"translateY(-"+(n.top+n.height-_)+"px)"}}function jw(e,t){if(t){var n=_le(e,t);n&&(t.style.webkitTransform=n,t.style.transform=n)}}var tV=X.forwardRef(function(e,t){var n=e.children,s=e.direction,a=s===void 0?"down":s,u=e.in,f=e.style,_=e.timeout,r=_===void 0?0:_,C=e.onEnter,k=e.onEntered,I=e.onExit,P=e.onExited,D=x1(e,["children","direction","in","style","timeout","onEnter","onEntered","onExit","onExited"]),N=X.useRef(null),j=PP(n.ref,N),W=PP(j,t),H=function(ye,de){jw(a,ye),Q8(ye),C&&C(ye,de)},q=function(ye){var de=(f==null?void 0:f.transitionTimingFunction)||AP.easeOut,ce=_C({timeout:r,mode:"enter",style:Uo({},f,{transitionTimingFunction:de})});ye.style.webkitTransition=wy("-webkit-transform",ce),ye.style.transition=wy("transform",ce),ye.style.webkitTransform="none",ye.style.transform="none"},Z=function(ye){var de=(f==null?void 0:f.transitionTimingFunction)||AP.sharp,ce=_C({timeout:r,mode:"exit",style:Uo({},f,{transitionTimingFunction:de})});ye.style.webkitTransition=wy("-webkit-transform",ce),ye.style.transition=wy("transform",ce),jw(a,ye),I&&I(ye)},re=function(ye){ye.style.webkitTransition="",ye.style.transition="",P&&P(ye)},le=X.useCallback(function(){N.current&&jw(a,N.current)},[a]);return X.useEffect(function(){if(!(u||a==="down"||a==="right")){var _e=yle(function(){N.current&&jw(a,N.current)}),ye=eV(N.current);return ye.addEventListener("resize",_e),function(){_e.clear(),ye.removeEventListener("resize",_e)}}},[a,u]),X.useEffect(function(){u||le()},[u,le]),X.createElement(AA,Object.assign({appear:!0,nodeRef:N,onEnter:H,onEntered:k,onEntering:q,onExit:Z,onExited:re,in:u,timeout:r},D),function(_e,ye){return X.cloneElement(n,Uo({ref:W,style:Uo({visibility:_e==="exited"&&!u?"hidden":void 0},f,{},n.props.style)},ye))})});tV.displayName="Slide";var jE=function(t){return Sr.createElement("svg",Object.assign({viewBox:"0 0 24 24",focusable:"false",style:{fontSize:20,marginInlineEnd:8,userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:"currentColor",flexShrink:0}},t))},vle=function(){return Sr.createElement(jE,null,Sr.createElement("path",{d:`M12 2C6.5 2 2 6.5 2 12S6.5 22 12 22 22 17.5 22 12 17.5 2 12 2M10 17L5 12L6.41
        10.59L10 14.17L17.59 6.58L19 8L10 17Z`}))},xle=function(){return Sr.createElement(jE,null,Sr.createElement("path",{d:"M13,14H11V10H13M13,18H11V16H13M1,21H23L12,2L1,21Z"}))},ble=function(){return Sr.createElement(jE,null,Sr.createElement("path",{d:`M12,2C17.53,2 22,6.47 22,12C22,17.53 17.53,22 12,22C6.47,22 2,17.53 2,12C2,
        6.47 6.47,2 12,2M15.59,7L12,10.59L8.41,7L7,8.41L10.59,12L7,15.59L8.41,17L12,
        13.41L15.59,17L17,15.59L13.41,12L17,8.41L15.59,7Z`}))},wle=function(){return Sr.createElement(jE,null,Sr.createElement("path",{d:`M13,9H11V7H13M13,17H11V11H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,
        0 22,12A10,10 0 0,0 12,2Z`}))},Sle={default:void 0,success:Sr.createElement(vle,null),warning:Sr.createElement(xle,null),error:Sr.createElement(ble,null),info:Sr.createElement(wle,null)},vm={maxSnack:3,persist:!1,hideIconVariant:!1,disableWindowBlurListener:!1,variant:"default",autoHideDuration:5e3,iconVariant:Sle,anchorOrigin:{vertical:"bottom",horizontal:"left"},TransitionComponent:tV,transitionDuration:{enter:225,exit:195}},Cle=function(t,n){var s=function(u){return typeof u=="number"||u===null};return s(t)?t:s(n)?n:vm.autoHideDuration},Ele=function(t,n){var s=function(u,f){return f.some(function(_){return typeof u===_})};return s(t,["string","number"])?t:s(t,["object"])?Uo({},vm.transitionDuration,{},s(n,["object"])&&n,{},t):s(n,["string","number"])?n:s(n,["object"])?Uo({},vm.transitionDuration,{},n):vm.transitionDuration},Tle=function(t,n){return function(s,a){return a===void 0&&(a=!1),a?Uo({},vm[s],{},n[s],{},t[s]):s==="autoHideDuration"?Cle(t.autoHideDuration,n.autoHideDuration):s==="transitionDuration"?Ele(t.transitionDuration,n.transitionDuration):t[s]||n[s]||vm[s]}};function b1(e){return Object.entries(e).reduce(function(t,n){var s,a=n[0],u=n[1];return Uo({},t,(s={},s[a]=MA(u),s))},{})}var c0={SnackbarContainer:"notistack-SnackbarContainer",Snackbar:"notistack-Snackbar",CollapseWrapper:"notistack-CollapseWrapper",MuiContent:"notistack-MuiContent",MuiContentVariant:function(t){return"notistack-MuiContent-"+t}},w4=b1({root:{height:0},entered:{height:"auto"}}),Pk="0px",Ak=175,nV=X.forwardRef(function(e,t){var n=e.children,s=e.in,a=e.onExited,u=X.useRef(null),f=X.useRef(null),_=PP(t,f),r=function(){return u.current?u.current.clientHeight:0},C=function(j){j.style.height=Pk},k=function(j){var W=r(),H=_C({timeout:Ak,mode:"enter"}),q=H.duration,Z=H.easing;j.style.transitionDuration=typeof q=="string"?q:q+"ms",j.style.height=W+"px",j.style.transitionTimingFunction=Z||""},I=function(j){j.style.height="auto"},P=function(j){j.style.height=r()+"px"},D=function(j){Q8(j);var W=_C({timeout:Ak,mode:"exit"}),H=W.duration,q=W.easing;j.style.transitionDuration=typeof H=="string"?H:H+"ms",j.style.height=Pk,j.style.transitionTimingFunction=q||""};return X.createElement(AA,{in:s,unmountOnExit:!0,onEnter:C,onEntered:I,onEntering:k,onExit:P,onExited:a,onExiting:D,nodeRef:f,timeout:Ak},function(N,j){return X.createElement("div",Object.assign({ref:_,className:Vm(w4.root,N==="entered"&&w4.entered),style:Uo({pointerEvents:"all",overflow:"hidden",minHeight:Pk,transition:wy("height")},N==="entered"&&{overflow:"visible"},{},N==="exited"&&!s&&{visibility:"hidden"})},j),X.createElement("div",{ref:u,className:c0.CollapseWrapper,style:{display:"flex",width:"100%"}},n))})});nV.displayName="Collapse";var S4={right:"left",left:"right",bottom:"up",top:"down"},Ile=function(t){return t.horizontal!=="center"?S4[t.horizontal]:S4[t.vertical]},kle=function(t){return"anchorOrigin"+PA(t)},Mle=function(t){t===void 0&&(t={});var n={containerRoot:!0,containerAnchorOriginTopCenter:!0,containerAnchorOriginBottomCenter:!0,containerAnchorOriginTopRight:!0,containerAnchorOriginBottomRight:!0,containerAnchorOriginTopLeft:!0,containerAnchorOriginBottomLeft:!0};return Object.keys(t).filter(function(s){return!n[s]}).reduce(function(s,a){var u;return Uo({},s,(u={},u[a]=t[a],u))},{})},Ple=function(){};function cx(e,t){return e.reduce(function(n,s){return s==null?n:function(){for(var u=arguments.length,f=new Array(u),_=0;_<u;_++)f[_]=arguments[_];var r=[].concat(f);t&&r.indexOf(t)===-1&&r.push(t),n.apply(this,r),s.apply(this,r)}},Ple)}var Ale=typeof window<"u"?X.useLayoutEffect:X.useEffect;function C4(e){var t=X.useRef(e);return Ale(function(){t.current=e}),X.useCallback(function(){return t.current.apply(void 0,arguments)},[])}var rV=X.forwardRef(function(e,t){var n=e.children,s=e.className,a=e.autoHideDuration,u=e.disableWindowBlurListener,f=u===void 0?!1:u,_=e.onClose,r=e.id,C=e.open,k=e.SnackbarProps,I=k===void 0?{}:k,P=X.useRef(),D=C4(function(){_&&_.apply(void 0,arguments)}),N=C4(function(Z){!_||Z==null||(P.current&&clearTimeout(P.current),P.current=setTimeout(function(){D(null,"timeout",r)},Z))});X.useEffect(function(){return C&&N(a),function(){P.current&&clearTimeout(P.current)}},[C,a,N]);var j=function(){P.current&&clearTimeout(P.current)},W=X.useCallback(function(){a!=null&&N(a*.5)},[a,N]),H=function(re){I.onMouseEnter&&I.onMouseEnter(re),j()},q=function(re){I.onMouseLeave&&I.onMouseLeave(re),W()};return X.useEffect(function(){if(!f&&C)return window.addEventListener("focus",W),window.addEventListener("blur",j),function(){window.removeEventListener("focus",W),window.removeEventListener("blur",j)}},[f,W,C]),X.createElement("div",Object.assign({ref:t},I,{className:Vm(c0.Snackbar,s),onMouseEnter:H,onMouseLeave:q}),n)});rV.displayName="Snackbar";var Lk,Lle=b1({root:(Lk={display:"flex",flexWrap:"wrap",flexGrow:1},Lk[om.upSm]={flexGrow:"initial",minWidth:"288px"},Lk)}),iV=X.forwardRef(function(e,t){var n=e.className,s=x1(e,["className"]);return Sr.createElement("div",Object.assign({ref:t,className:Vm(Lle.root,n)},s))});iV.displayName="SnackbarContent";var Mv=b1({root:{backgroundColor:"#313131",fontSize:"0.875rem",lineHeight:1.43,letterSpacing:"0.01071em",color:"#fff",alignItems:"center",padding:"6px 16px",borderRadius:"4px",boxShadow:"0px 3px 5px -1px rgba(0,0,0,0.2),0px 6px 10px 0px rgba(0,0,0,0.14),0px 1px 18px 0px rgba(0,0,0,0.12)"},lessPadding:{paddingLeft:8*2.5+"px"},default:{backgroundColor:"#313131"},success:{backgroundColor:"#43a047"},error:{backgroundColor:"#d32f2f"},warning:{backgroundColor:"#ff9800"},info:{backgroundColor:"#2196f3"},message:{display:"flex",alignItems:"center",padding:"8px 0"},action:{display:"flex",alignItems:"center",marginLeft:"auto",paddingLeft:"16px",marginRight:"-8px"}}),E4="notistack-snackbar",oV=X.forwardRef(function(e,t){var n=e.id,s=e.message,a=e.action,u=e.iconVariant,f=e.variant,_=e.hideIconVariant,r=e.style,C=e.className,k=u[f],I=a;return typeof I=="function"&&(I=I(n)),Sr.createElement(iV,{ref:t,role:"alert","aria-describedby":E4,style:r,className:Vm(c0.MuiContent,c0.MuiContentVariant(f),Mv.root,Mv[f],C,!_&&k&&Mv.lessPadding)},Sr.createElement("div",{id:E4,className:Mv.message},_?null:k,s),I&&Sr.createElement("div",{className:Mv.action},I))});oV.displayName="MaterialDesignContent";var Rle=X.memo(oV),Ole=b1({wrappedRoot:{width:"100%",position:"relative",transform:"translateX(0)",top:0,right:0,bottom:0,left:0,minWidth:"288px"}}),Dle=function(t){var n=X.useRef(),s=X.useState(!0),a=s[0],u=s[1],f=cx([t.snack.onClose,t.onClose]),_=function(){t.snack.requestClose&&f(null,"instructed",t.snack.id)},r=X.useCallback(function(){n.current=setTimeout(function(){u(function(ce){return!ce})},125)},[]);X.useEffect(function(){return function(){n.current&&clearTimeout(n.current)}},[]);var C=t.snack,k=t.classes,I=t.Component,P=I===void 0?Rle:I,D=X.useMemo(function(){return Mle(k)},[k]),N=C.open,j=C.SnackbarProps,W=C.TransitionComponent,H=C.TransitionProps,q=C.transitionDuration,Z=C.disableWindowBlurListener,re=C.content,le=x1(C,["open","SnackbarProps","TransitionComponent","TransitionProps","transitionDuration","disableWindowBlurListener","content","entered","requestClose","onEnter","onEntered","onExit","onExited"]),_e=Uo({direction:Ile(le.anchorOrigin),timeout:q},H),ye=re;typeof ye=="function"&&(ye=ye(le.id,le.message));var de=["onEnter","onEntered","onExit","onExited"].reduce(function(ce,oe){var xe;return Uo({},ce,(xe={},xe[oe]=cx([t.snack[oe],t[oe]],le.id),xe))},{});return Sr.createElement(nV,{in:a,onExited:de.onExited},Sr.createElement(rV,{open:N,id:le.id,disableWindowBlurListener:Z,autoHideDuration:le.autoHideDuration,className:Vm(Ole.wrappedRoot,D.root,D[kle(le.anchorOrigin)]),SnackbarProps:j,onClose:f},Sr.createElement(W,Object.assign({},_e,{appear:!0,in:N,onExit:de.onExit,onExited:r,onEnter:de.onEnter,onEntered:cx([de.onEntered,_],le.id)}),ye||Sr.createElement(P,Object.assign({},le)))))},Pv,Rk,Vw,$w,Ok,yh={view:{default:20,dense:4},snackbar:{default:6,dense:2}},T4="."+c0.CollapseWrapper,Dk=16,Uw=b1({root:(Pv={boxSizing:"border-box",display:"flex",maxHeight:"100%",position:"fixed",zIndex:1400,height:"auto",width:"auto",transition:wy(["top","right","bottom","left","max-width"],{duration:300,easing:"ease"}),pointerEvents:"none"},Pv[T4]={padding:yh.snackbar.default+"px 0px",transition:"padding 300ms ease 0ms"},Pv.maxWidth="calc(100% - "+yh.view.default*2+"px)",Pv[om.downXs]={width:"100%",maxWidth:"calc(100% - "+Dk*2+"px)"},Pv),rootDense:(Rk={},Rk[T4]={padding:yh.snackbar.dense+"px 0px"},Rk),top:{top:yh.view.default-yh.snackbar.default+"px",flexDirection:"column"},bottom:{bottom:yh.view.default-yh.snackbar.default+"px",flexDirection:"column-reverse"},left:(Vw={left:yh.view.default+"px"},Vw[om.upSm]={alignItems:"flex-start"},Vw[om.downXs]={left:Dk+"px"},Vw),right:($w={right:yh.view.default+"px"},$w[om.upSm]={alignItems:"flex-end"},$w[om.downXs]={right:Dk+"px"},$w),center:(Ok={left:"50%",transform:"translateX(-50%)"},Ok[om.upSm]={alignItems:"center"},Ok)}),zle=function(t){var n=t.classes,s=n===void 0?{}:n,a=t.anchorOrigin,u=t.dense,f=t.children,_=Vm(c0.SnackbarContainer,Uw[a.vertical],Uw[a.horizontal],Uw.root,s.containerRoot,s["containerAnchorOrigin"+PA(a)],u&&Uw.rootDense);return Sr.createElement("div",{className:_},f)},Fle=X.memo(zle),I4=function(t){var n=typeof t=="string"||X.isValidElement(t);return!n},Nle,Ble=function(e){K8(t,e);function t(s){var a;return a=e.call(this,s)||this,a.enqueueSnackbar=function(u,f){if(f===void 0&&(f={}),u==null)throw new Error("enqueueSnackbar called with invalid argument");var _=I4(u)?u:f,r=I4(u)?u.message:u,C=_.key,k=_.preventDuplicate,I=x1(_,["key","preventDuplicate"]),P=Nw(C),D=P?C:new Date().getTime()+Math.random(),N=Tle(I,a.props),j=Uo({id:D},I,{message:r,open:!0,entered:!1,requestClose:!1,persist:N("persist"),action:N("action"),content:N("content"),variant:N("variant"),anchorOrigin:N("anchorOrigin"),disableWindowBlurListener:N("disableWindowBlurListener"),autoHideDuration:N("autoHideDuration"),hideIconVariant:N("hideIconVariant"),TransitionComponent:N("TransitionComponent"),transitionDuration:N("transitionDuration"),TransitionProps:N("TransitionProps",!0),iconVariant:N("iconVariant",!0),style:N("style",!0),SnackbarProps:N("SnackbarProps",!0),className:Vm(a.props.className,I.className)});return j.persist&&(j.autoHideDuration=void 0),a.setState(function(W){if(k===void 0&&a.props.preventDuplicate||k){var H=function(le){return P?le.id===D:le.message===r},q=W.queue.findIndex(H)>-1,Z=W.snacks.findIndex(H)>-1;if(q||Z)return W}return a.handleDisplaySnack(Uo({},W,{queue:[].concat(W.queue,[j])}))}),D},a.handleDisplaySnack=function(u){var f=u.snacks;return f.length>=a.maxSnack?a.handleDismissOldest(u):a.processQueue(u)},a.processQueue=function(u){var f=u.queue,_=u.snacks;return f.length>0?Uo({},u,{snacks:[].concat(_,[f[0]]),queue:f.slice(1,f.length)}):u},a.handleDismissOldest=function(u){if(u.snacks.some(function(k){return!k.open||k.requestClose}))return u;var f=!1,_=!1,r=u.snacks.reduce(function(k,I){return k+(I.open&&I.persist?1:0)},0);r===a.maxSnack&&(_=!0);var C=u.snacks.map(function(k){return!f&&(!k.persist||_)?(f=!0,k.entered?(k.onClose&&k.onClose(null,"maxsnack",k.id),a.props.onClose&&a.props.onClose(null,"maxsnack",k.id),Uo({},k,{open:!1})):Uo({},k,{requestClose:!0})):Uo({},k)});return Uo({},u,{snacks:C})},a.handleEnteredSnack=function(u,f,_){if(!Nw(_))throw new Error("handleEnteredSnack Cannot be called with undefined key");a.setState(function(r){var C=r.snacks;return{snacks:C.map(function(k){return k.id===_?Uo({},k,{entered:!0}):Uo({},k)})}})},a.handleCloseSnack=function(u,f,_){a.props.onClose&&a.props.onClose(u,f,_);var r=_===void 0;a.setState(function(C){var k=C.snacks,I=C.queue;return{snacks:k.map(function(P){return!r&&P.id!==_?Uo({},P):P.entered?Uo({},P,{open:!1}):Uo({},P,{requestClose:!0})}),queue:I.filter(function(P){return P.id!==_})}})},a.closeSnackbar=function(u){var f=a.state.snacks.find(function(_){return _.id===u});Nw(u)&&f&&f.onClose&&f.onClose(null,"instructed",u),a.handleCloseSnack(null,"instructed",u)},a.handleExitedSnack=function(u,f){if(!Nw(f))throw new Error("handleExitedSnack Cannot be called with undefined key");a.setState(function(_){var r=a.processQueue(Uo({},_,{snacks:_.snacks.filter(function(C){return C.id!==f})}));return r.queue.length===0?r:a.handleDismissOldest(r)})},Nle=a.enqueueSnackbar,a.closeSnackbar,a.state={snacks:[],queue:[],contextValue:{enqueueSnackbar:a.enqueueSnackbar.bind(g4(a)),closeSnackbar:a.closeSnackbar.bind(g4(a))}},a}var n=t.prototype;return n.render=function(){var a=this,u=this.state.contextValue,f=this.props,_=f.domRoot,r=f.children,C=f.dense,k=C===void 0?!1:C,I=f.Components,P=I===void 0?{}:I,D=f.classes,N=this.state.snacks.reduce(function(W,H){var q,Z=PA(H.anchorOrigin),re=W[Z]||[];return Uo({},W,(q={},q[Z]=[].concat(re,[H]),q))},{}),j=Object.keys(N).map(function(W){var H=N[W],q=H[0];return Sr.createElement(Fle,{key:W,dense:k,anchorOrigin:q.anchorOrigin,classes:D},H.map(function(Z){return Sr.createElement(Dle,{key:Z.id,snack:Z,classes:D,Component:P[Z.variant],onClose:a.handleCloseSnack,onEnter:a.props.onEnter,onExit:a.props.onExit,onExited:cx([a.handleExitedSnack,a.props.onExited],Z.id),onEntered:cx([a.handleEnteredSnack,a.props.onEntered],Z.id)})}))});return Sr.createElement(J8.Provider,{value:u},r,_?kh.createPortal(j,_):j)},Z8(t,[{key:"maxSnack",get:function(){return this.props.maxSnack||vm.maxSnack}}]),t}(X.Component),vp=function(){return X.useContext(J8)};const jle=({open:e,onClose:t})=>{const{layers:n}=Lu(),{addLayer:s}=_c(),[a,u]=X.useState(""),[f,_]=X.useState(""),[r,C]=X.useState(""),[k,I]=X.useState(!1),[P,D]=X.useState(!1),[N,j]=X.useState(!1),[W,H]=X.useState(!1),[q,Z]=X.useState(!1),{enqueueSnackbar:re}=vp(),le=()=>{const Ee=a!=="",se=f!==""&&!isNaN(Number(f))&&Number(f)>0,we=r!=="";return D(!Ee),I(!se),j(!we),Ee&&se&&we},_e=()=>{const Ee=n.find(se=>se.id===a);if(Ee)try{const se=vq(Ee.data,Number(f),{units:"meters"});if(se.type!=="FeatureCollection")throw new Error("Buffering did not produce a FeatureCollection.");const we={id:r||`${a}_buffer`,name:r||`${Ee.name}_buffer`,data:se,color:nd(),visible:!0,opacity:1,type:"Polygon"};s(we.data,we.color,we.name,!0),re("Buffer layer added successfully!",{variant:"success",autoHideDuration:2500})}catch(se){console.error("Buffering error:",se)}},ye=()=>{le()&&(_e(),t())},de=Ee=>{const se=Ee.target.value;u(se),D(!1);const we=n.find(Se=>Se.id===se);we&&!W&&C(`${we.name}_buffer`)},ce=Ee=>{_(Ee.target.value)},oe=Ee=>{C(Ee.target.value),H(!0)},xe=()=>Z(!0),he=[{target:"#buffer-header",content:"Now you are going to make a buffer of 3 km around Solvangen kindergarten.",disableBeacon:!0,spotlightClicks:!0,placement:"bottom"},{target:"#layer-select",content:"Select 'Solvangen barnehage' from the dropdown list.",disableBeacon:!0,spotlightClicks:!0,placement:"top",styles:{overlay:{pointerEvents:"none"}}},{target:"#buffer-radius",content:"Write '3000' in the buffer radius field.",disableBeacon:!0,spotlightClicks:!0,placement:"bottom"},{target:"#output-layer-name",content:"Name the new buffer layer 'buffer_3km'.",disableBeacon:!0,spotlightClicks:!0,placement:"bottom"},{target:"#submit-button",content:"Click to create layer with the selected row.",disableBeacon:!0,spotlightClicks:!0,placement:"bottom"}];return K.jsxs(K.Fragment,{children:[K.jsxs(od,{open:e,onClose:t,header:"Create Buffer",headerId:"buffer-header",submitLabel:"Create Buffer",onSubmit:ye,tutorialHelp:!0,openTutorial:xe,children:[K.jsx(jh,{id:"layer-select",label:"Select Layer",value:a,options:n.map(Ee=>({value:Ee.id,label:Ee.name})),onChange:de,error:P,helperText:P?"Please select a valid layer.":""}),K.jsx(Bh,{id:"buffer-radius",label:"Buffer Radius (meters)",type:"text",value:f,onChange:ce,error:k,helperText:k?"Please enter a valid positive number.":"",InputLabelProps:{shrink:!0}}),K.jsx(Bh,{id:"output-layer-name",label:"Output Layer Name",value:r,onChange:oe,error:N,helperText:N?"Please enter an output layer name.":"",InputLabelProps:{shrink:!0}})]}),K.jsx(BE,{steps:he,run:e&&q,onClose:()=>Z(!1)})]})},LA=({open:e,onClose:t,operationLabel:n,turfFunction:s})=>{const{layers:a}=Lu(),{addLayer:u}=_c(),{enqueueSnackbar:f}=vp(),[_,r]=X.useState(""),[C,k]=X.useState(""),[I,P]=X.useState(""),[D,N]=X.useState(!1),[j,W]=X.useState(!1),[H,q]=X.useState(!1),[Z,re]=X.useState(!1),[le,_e]=X.useState(""),[ye,de]=X.useState(!1),ce=a.filter(Me=>Me.type==="Polygon"||Me.type==="MultiPolygon"),oe=()=>{const Me=_!=="",Re=C!==""&&C!==_,Oe=I!=="";return N(!Me),W(!Re),q(!Oe),Me&&Re&&Oe},xe=()=>{const Me=ce.find(Oe=>Oe.id===_),Re=ce.find(Oe=>Oe.id===C);if(!Me||!Re)return _e("One or both layers could not be found."),!1;try{const Oe=[],$e=Me.data.features.filter(Ct=>{var Ue,ft;return((Ue=Ct.geometry)==null?void 0:Ue.type)==="Polygon"||((ft=Ct.geometry)==null?void 0:ft.type)==="MultiPolygon"}),Ke=Re.data.features.filter(Ct=>{var Ue,ft;return((Ue=Ct.geometry)==null?void 0:Ue.type)==="Polygon"||((ft=Ct.geometry)==null?void 0:ft.type)==="MultiPolygon"});return $e.forEach(Ct=>{Ke.forEach(Ue=>{const Bt=s({type:"FeatureCollection",features:[Ct,Ue]});Bt&&Oe.push(Bt)})}),Oe.length>0?(u({type:"FeatureCollection",features:Oe},nd(),I,!0),f(`${n} layer added successfully!`,{variant:"success",autoHideDuration:2500}),_e(""),!0):(_e(`No ${n} results found.`),!1)}catch{return _e(`An error occurred during ${n}.`),!1}},he=()=>{oe()&&xe()&&t()},Ee=Me=>{const Re=Me.target.value;r(Re),N(!1);const Oe=ce.find(Ke=>Ke.id===Re),$e=ce.find(Ke=>Ke.id===C);Oe&&C!==""&&!Z&&(P(`${Oe.name}_${$e==null?void 0:$e.name}_${n}`),q(!1))},se=Me=>{const Re=Me.target.value;k(Re),W(!1);const Oe=ce.find(Ke=>Ke.id===Re),$e=ce.find(Ke=>Ke.id===_);Oe&&_!==""&&!Z&&(P(`${Oe.name}_${$e==null?void 0:$e.name}_${n}`),q(!1))},we=Me=>{P(Me.target.value),re(!0)},Se=()=>de(!0),Pe=[{target:"#operation-header",content:"Now you are going to find forested areas close to a lake by creating the intersection of the nearby forest areas and the lake-buffer.",disableBeacon:!0,spotlightClicks:!0,placement:"bottom"},{target:"#first-layer",content:"Select 'skog_3km' from the dropdown list as first layer.",disableBeacon:!0,spotlightClicks:!0,placement:"top",styles:{overlay:{pointerEvents:"none"}}},{target:"#second-layer",content:"Select 'innsjø_100m' from the dropdown list as second layer.",disableBeacon:!0,spotlightClicks:!0,placement:"top",styles:{overlay:{pointerEvents:"none"}}},{target:"#output-layer-name",content:"Name the new intersection layer 'skog_potensiell'.",disableBeacon:!0,spotlightClicks:!0,placement:"bottom"},{target:"#submit-button",content:"Click to execute intersection and create the new layer.",disableBeacon:!0,spotlightClicks:!0,placement:"bottom"}];return K.jsxs(K.Fragment,{children:[K.jsxs(od,{open:e,onClose:t,header:`Create ${n}`,headerId:"operation-header",submitLabel:`Create ${n}`,onSubmit:he,headermargin:.5,tutorialHelp:n==="Intersection",openTutorial:Se,children:[K.jsxs(Ci,{sx:{mb:3},children:[K.jsx(To,{mx:{fontSize:"0.7rem",color:"#ECAC7A",mb:2},children:"Polygon layers only"}),le&&K.jsx(To,{sx:{color:"red",fontSize:"0.8rem"},children:le})]}),K.jsx(jh,{id:"first-layer",label:"Select First Layer",value:_,options:ce.map(Me=>({value:Me.id,label:Me.name})),onChange:Ee,error:D,helperText:D?"Please select a valid first layer.":""}),K.jsx(jh,{id:"second-layer",label:n==="Difference"?"Select Layer to Subtract":"Select Second Layer",value:C,options:ce.filter(Me=>Me.id!==_).map(Me=>({value:Me.id,label:Me.name})),onChange:se,error:j,helperText:j?"Please select a different layer for the operation.":""}),K.jsx(Bh,{id:"output-layer-name",label:"Output Layer Name",value:I,onChange:we,error:H,helperText:H?"Please enter an output layer name.":"",InputLabelProps:{shrink:!0}})]}),K.jsx(BE,{steps:Pe,run:e&&ye,onClose:()=>de(!1)})]})},Vle=({open:e,onClose:t})=>K.jsx(LA,{open:e,onClose:t,operationLabel:"Intersection",turfFunction:L3}),$le=({open:e,onClose:t})=>K.jsx(LA,{open:e,onClose:t,operationLabel:"Union",turfFunction:lX}),Ule=({open:e,onClose:t})=>K.jsx(LA,{open:e,onClose:t,operationLabel:"Difference",turfFunction:Qq}),Gle=({open:e,onClose:t})=>{var he,Ee,se;const{layers:n}=Lu(),{addLayer:s}=_c(),{enqueueSnackbar:a}=vp(),[u,f]=X.useState(""),[_,r]=X.useState(""),[C,k]=X.useState(""),[I,P]=X.useState(!1),[D,N]=X.useState(!1),[j,W]=X.useState(!1),[H,q]=X.useState(""),[Z,re]=X.useState(!1),le=n.filter(we=>we.type==="Polygon"),_e=()=>{const we=u!=="",Se=_!=="",Pe=C!=="";return P(!we),N(!Se),W(!Pe),we&&Se&&Pe},ye=()=>{const we=le.find(Se=>Se.id===u);if(!we)return q("Selected layer could not be found."),!1;try{const Se={type:"FeatureCollection",features:we.data.features.filter(Me=>{var Re;return((Re=Me.geometry)==null?void 0:Re.type)==="Polygon"})},Pe=eX(Se,{propertyName:_});return Pe&&Pe.features.length>0?(s(Pe,nd(),C,!0),a("Dissolve operation successful!",{variant:"success",autoHideDuration:2500}),q(""),!0):(q("Dissolve operation returned no results."),!1)}catch(Se){return console.error("Error during dissolve operation:",Se),q("An error occurred during the dissolve operation."),!1}},de=()=>{_e()&&ye()&&t()},ce=we=>{var Re,Oe;const Se=we.target.value;f(Se),P(!1);const Pe=le.find($e=>$e.id===Se);if(Pe&&!Z){const $e=Object.keys(((Re=Pe.data.features[0])==null?void 0:Re.properties)||[])[0];k(`dissolve_${Pe.name}_${$e||"none"}`)}const Me=Object.keys(((Oe=Pe==null?void 0:Pe.data.features[0])==null?void 0:Oe.properties)||{});r(Me[0]||"")},oe=we=>{const Se=we.target.value;if(r(Se),N(!1),!Z&&u){const Pe=le.find(Me=>Me.id===u);Pe&&k(`dissolve_${Pe.name}_${Se}`)}},xe=we=>{k(we.target.value),re(!0),W(!1)};return K.jsxs(od,{open:e,onClose:t,header:"Dissolve Tool",submitLabel:"Run Dissolve",onSubmit:de,headermargin:.5,children:[K.jsxs(Ci,{sx:{mb:3},children:[K.jsx(To,{mx:{fontSize:"0.7rem",color:"#ECAC7A",mb:2},children:"Polygon layers only"}),H&&K.jsx(To,{sx:{color:"red",fontSize:"0.8rem"},children:H})]}),K.jsx(jh,{label:"Select Layer",value:u,options:le.map(we=>({value:we.id,label:we.name})),onChange:ce,error:I,helperText:I?"Please select a valid layer.":""}),K.jsx(jh,{label:"Select Field for Dissolve",value:_,options:(Ee=(he=le.find(we=>we.id===u))==null?void 0:he.data.features[0])!=null&&Ee.properties?Object.keys(((se=le.find(we=>we.id===u))==null?void 0:se.data.features[0].properties)||{}).map(we=>({value:we,label:we})):[],onChange:oe,error:D,helperText:D?"Please select a valid field.":"",disabled:u===""}),K.jsx(Bh,{label:"Output Layer Name",value:C,onChange:xe,error:j,helperText:j?"Please enter an output layer name.":"",InputLabelProps:{shrink:!0}})]})},Hle=({open:e,onClose:t})=>{const{layers:n}=Lu(),{addLayer:s}=_c(),{enqueueSnackbar:a}=vp(),[u,f]=X.useState([]),[_,r]=X.useState(""),[C,k]=X.useState(!1),[I,P]=X.useState(""),[D,N]=X.useState(!1),[j,W]=X.useState(!1),H=n.filter(ye=>ye.type==="Polygon"||ye.type==="LineString"||ye.type==="Point"||ye.type==="MultiPolygon"||ye.type==="MultiLineString"),q=()=>{const ye=_!=="",de=u.length>0;return k(!ye),N(!de),ye&&de},Z=()=>{if(!q())return!1;try{const ye={type:"FeatureCollection",features:u.flatMap(xe=>{const he=n.find(Ee=>Ee.id===xe);return(he==null?void 0:he.data.features)||[]})},de=dl(ye),oe={type:"FeatureCollection",features:[ZH(de)]};return s(oe,nd(),_,!0),a("Bounding box created successfully!",{variant:"success",autoHideDuration:2500}),P(""),!0}catch(ye){return console.error("Error creating bounding box:",ye),P("An error occurred while creating the bounding box."),!1}},re=()=>{Z()&&t()},le=ye=>{r(ye.target.value),W(!0),k(!1)},_e=ye=>{const de=ye.target.value;if(f(de),N(!1),de.length>0&&!j){const ce=H.filter(oe=>de.includes(oe.id)).map(oe=>oe.name).join("_");r(`BoundingBox_${ce}`)}};return K.jsxs(od,{open:e,onClose:t,header:"Bounding Box Tool",submitLabel:"Create Bounding Box",onSubmit:re,headermargin:.5,children:[K.jsxs(Ci,{sx:{mb:3},children:[K.jsx(To,{mx:{fontSize:"0.7rem",color:"#ECAC7A",mb:2},children:"Select one or more layers to create a bounding box"}),I&&K.jsx(To,{sx:{color:"red",fontSize:"0.8rem"},children:I})]}),K.jsxs(up,{fullWidth:!0,variant:"standard",sx:{mb:3},error:D,children:[K.jsx(cp,{shrink:!0,sx:{color:"#A8D99C","&.Mui-focused":{color:"#A8D99C"}},children:"Select Layers"}),K.jsx(Zd,{multiple:!0,value:u,onChange:_e,renderValue:ye=>K.jsx(Ci,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:ye.map(de=>{const ce=H.find(oe=>oe.id===de);return K.jsx(ME,{label:(ce==null?void 0:ce.name)||de,sx:{bgcolor:"#A8D99C",color:"black","& .MuiChip-label":{color:"black"},"&:hover":{bgcolor:"#86C87A"}}},de)})}),MenuProps:{PaperProps:{sx:{bgcolor:"#555555",color:"#ffffff","& .MuiMenuItem-root":{"&:hover":{bgcolor:"rgba(255, 255, 255, 0.1)"},"&.Mui-selected":{bgcolor:"rgba(255, 255, 255, 0.1)"},"&.Mui-selected:hover":{bgcolor:"rgba(255, 255, 255, 0.1)"}}}}},sx:{bgcolor:"#555555",color:"#ffffff","&:before":{borderBottomColor:"#ffffff"},"&:hover:not(.Mui-disabled):before":{borderBottomColor:"#A8D99C"},"&:after":{borderBottomColor:"#A8D99C"},"& .MuiSelect-icon":{color:"#A8D99C"}},children:H.map(ye=>K.jsx(gl,{value:ye.id,sx:{color:"#ffffff"},children:ye.name},ye.id))}),D&&K.jsx("div",{style:{color:"#d32f2f",marginTop:"4px",fontSize:"12px"},children:"Please select at least one layer."})]}),K.jsx(Bh,{label:"Output Layer Name",value:_,onChange:le,error:C,helperText:C?"Please enter an output layer name.":"",InputLabelProps:{shrink:!0}})]})},Wle=({open:e,onClose:t})=>{const{layers:n}=Lu(),{addLayer:s}=_c(),{enqueueSnackbar:a}=vp(),[u,f]=X.useState(""),[_,r]=X.useState(""),[C,k]=X.useState(""),[I,P]=X.useState(!1),[D,N]=X.useState(!1),[j,W]=X.useState(!1),[H,q]=X.useState(""),[Z,re]=X.useState(!1),[le,_e]=X.useState(!1),ye=n.filter(Me=>Me.type==="Polygon"||Me.type==="MultiPolygon"||Me.type==="Point"||Me.type==="LineString"||Me.type==="MultiLineString"),de=n.filter(Me=>Me.type==="Polygon"||Me.type==="MultiPolygon"),ce=()=>{const Me=u.length>0,Re=_!=="",Oe=C!=="";return P(!Me),N(!Re),W(!Oe),Me&&Re&&Oe};function oe(Me,Re){return Me[0]===Re[0]&&Me[1]===Re[1]}const xe=()=>{if(!ce())return!1;try{const Me=de.find(Ue=>Ue.id===_);if(!Me||Me.data.features.length===0)return q("The selected polygon layer has no features."),!1;const Re=Me.data.features.filter(Ue=>{var ft,Bt;return((ft=Ue.geometry)==null?void 0:ft.type)==="Polygon"||((Bt=Ue.geometry)==null?void 0:Bt.type)==="MultiPolygon"}),Oe=[],$e=n.find(Ue=>Ue.id===u);return $e?($e.data.features.forEach(Ue=>{Re.forEach(ft=>{var Bt,hn,ot,en,wt;if(((Bt=Ue.geometry)==null?void 0:Bt.type)==="Point"||((hn=Ue.geometry)==null?void 0:hn.type)==="MultiPoint"){const Ne=aX({type:"FeatureCollection",features:[Ue]},ft);Ne.features.length>0&&Oe.push(...Ne.features)}else if(((ot=Ue.geometry)==null?void 0:ot.type)==="LineString"){const Ne=qc(Ue.geometry.coordinates,Ue.properties||{});if(uv(Ne,ft))Oe.push(Ne);else if(ak(Ne,ft)){const We=oX(Ne,ft);We&&We.features.length>0&&We.features.forEach(Sn=>{if(uv(Sn,ft))Oe.push(Sn);else if(ak(Sn,ft)){const Ae=Sn.geometry.coordinates,st=[];for(let gt=0;gt<Ae.length-1;gt++){const ut=Ae[gt],tt=Ae[gt+1],nt=qc([ut,tt]);uv(nt,ft)?(st.some(tn=>oe(tn,ut))||st.push(ut),st.some(tn=>oe(tn,tt))||st.push(tt)):ak(nt,ft)&&(_0(nt,ft).features.forEach(un=>{const qt=un.geometry.coordinates;st.some(an=>oe(an,qt))||st.push(qt)}),uv(qc([ut,ut]),ft)&&!st.some(un=>oe(un,ut))&&st.push(ut),uv(qc([tt,tt]),ft)&&!st.some(un=>oe(un,tt))&&st.push(tt))}if(st.length>1){const gt=qc(st,Sn.properties);Oe.push(gt)}}})}}else if(((en=Ue.geometry)==null?void 0:en.type)==="Polygon"||((wt=Ue.geometry)==null?void 0:wt.type)==="MultiPolygon"){const Ne=L3({type:"FeatureCollection",features:[{type:"Feature",geometry:Ue.geometry,properties:Ue.properties||{}},{type:"Feature",geometry:ft.geometry,properties:ft.properties||{}}]});Ne&&Oe.push(Ne)}})}),Oe.length===0?(q("No intersections found and no features clipped."),!1):(s({type:"FeatureCollection",features:Oe},nd(),C,!0),a("Clipping operation successful!",{variant:"success",autoHideDuration:2500}),q(""),!0)):(q("Selected layer not found."),!1)}catch(Me){return console.error("Error during clipping:",Me),q("An error occurred during the clipping operation."),!1}},he=()=>{xe()&&t()},Ee=Me=>{const Re=Me.target.value;if(f(Re),P(!1),!Z&&_){const Oe=ye.find(Ke=>Ke.id===Re),$e=de.find(Ke=>Ke.id===_);Oe&&$e&&k(`${Oe.name}_ClippedTo_${$e.name}`)}},se=Me=>{const Re=Me.target.value;if(r(Re),N(!1),!Z){const Oe=ye.find(Ke=>Ke.id===u),$e=de.find(Ke=>Ke.id===Re);Oe&&$e&&k(`${Oe.name}_ClippedTo_${$e.name}`)}},we=Me=>{k(Me.target.value),re(!0)},Se=()=>_e(!0),Pe=[{target:"#clip-header",content:"Now you are going to find the nearby forested areas by clipping the forest layer to the new buffer layer.",disableBeacon:!0,spotlightClicks:!0,placement:"bottom"},{target:"#layer-select",content:"Select 'skog' from the dropdown list as layer to clip.",disableBeacon:!0,spotlightClicks:!0,placement:"top",styles:{overlay:{pointerEvents:"none"}}},{target:"#clip-layer",content:"Select 'buffer_3km' from the dropdown list as the polygon to clip to.",disableBeacon:!0,spotlightClicks:!0,placement:"top",styles:{overlay:{pointerEvents:"none"}}},{target:"#output-layer-name",content:"Name the new buffer layer 'skog_3km'.",disableBeacon:!0,spotlightClicks:!0,placement:"bottom"},{target:"#submit-button",content:"Click to execute clip and create the new layer.",disableBeacon:!0,spotlightClicks:!0,placement:"bottom"}];return K.jsxs(K.Fragment,{children:[K.jsxs(od,{open:e,onClose:t,header:"Clip Tool",headerId:"clip-header",submitLabel:"Execute Clip",onSubmit:he,headermargin:.5,tutorialHelp:!0,openTutorial:Se,children:[K.jsxs(Ci,{sx:{mb:3},children:[K.jsx(To,{mx:{fontSize:"0.7rem",color:"#ECAC7A",mb:2},children:"Select a layer to clip and a polygon layer to clip to"}),H&&K.jsx(To,{sx:{color:"red",fontSize:"0.8rem"},children:H})]}),K.jsxs(up,{fullWidth:!0,variant:"standard",sx:{mb:3},error:I,children:[K.jsx(cp,{shrink:!0,sx:{color:"#A8D99C","&.Mui-focused":{color:"#A8D99C"}},children:"Select Layer to Clip"}),K.jsx(Zd,{id:"layer-select",value:u,onChange:Ee,renderValue:Me=>{const Re=ye.find(Oe=>Oe.id===Me);return(Re==null?void 0:Re.name)||Me},MenuProps:{PaperProps:{sx:{bgcolor:"#555555",color:"#ffffff","& .MuiMenuItem-root":{"&:hover":{bgcolor:"rgba(255, 255, 255, 0.1)"},"&.Mui-selected":{bgcolor:"rgba(255, 255, 255, 0.1)"},"&.Mui-selected:hover":{bgcolor:"rgba(255, 255, 255, 0.1)"}}}}},sx:{bgcolor:"#555555",color:"#ffffff","&:before":{borderBottomColor:"#ffffff"},"&:hover:not(.Mui-disabled):before":{borderBottomColor:"#A8D99C"},"&:after":{borderBottomColor:"#A8D99C"},"& .MuiSelect-icon":{color:"#A8D99C"}},children:ye.map(Me=>K.jsx(gl,{value:Me.id,sx:{color:"#ffffff"},children:Me.name},Me.id))}),I&&K.jsx("div",{style:{color:"#d32f2f",marginTop:"4px",fontSize:"12px"},children:"Please select at least one layer."})]}),K.jsx(jh,{id:"clip-layer",label:"Select Polygon to Clip To",value:_,options:de.map(Me=>({value:Me.id,label:Me.name})),onChange:se,error:D,helperText:D?"Please select a polygon layer to clip to.":""}),K.jsx(Bh,{id:"output-layer-name",label:"Output Layer Name",value:C,onChange:we,error:j,helperText:j?"Please enter an output layer name.":"",InputLabelProps:{shrink:!0}})]}),K.jsx(BE,{steps:Pe,run:e&&le,onClose:()=>_e(!1)})]})},qle=({open:e,onClose:t})=>{const{layers:n}=Lu(),{addLayer:s}=_c(),{enqueueSnackbar:a}=vp(),[u,f]=X.useState(""),[_,r]=X.useState(""),[C,k]=X.useState(!1),[I,P]=X.useState(""),[D,N]=X.useState(!1),[j,W]=X.useState(!1),[H,q]=X.useState(!1),Z=n.filter(oe=>oe.type==="Point"),re=n.filter(oe=>oe.type==="Polygon"||oe.type==="MultiPolygon"),le=()=>{const oe=u!=="",xe=_!=="",he=!C||I!=="";return N(!xe),oe&&xe&&he},_e=()=>{if(!le())return!1;try{const oe=Z.find(we=>we.id===u);if(!oe)return a("Selected layer not found.",{variant:"error",autoHideDuration:2500}),!1;const xe=(oe.data.features??[]).filter(we=>{var Se;return(we==null?void 0:we.geometry)!==null&&((Se=we==null?void 0:we.geometry)==null?void 0:Se.type)==="Point"&&we.geometry.coordinates.length===2&&we.geometry.coordinates.every(Pe=>typeof Pe=="number")});if(xe.length===0)return a("The selected layer has no valid point features.",{variant:"error",autoHideDuration:2500}),!1;const he={type:"FeatureCollection",features:xe},Ee={};if(C){const we=re.find(Se=>Se.id===I);if(!we||we.data.features.length===0)return a("The selected bounding box layer has no valid features.",{variant:"error",autoHideDuration:2500}),!1;Ee.bbox=dl(we.data)}else Ee.bbox=dl(he);const se=MX(he,Ee);return!se||!se.features?(a("No Voronoi polygons were generated.",{variant:"error",autoHideDuration:2500}),!1):(se.features=se.features.filter(we=>we!=null),se.features.length===0?(a("No valid Voronoi polygons were generated.",{variant:"error",autoHideDuration:2500}),!1):(se.features=se.features.map(we=>{const Se=nd();return{...we,properties:{...we.properties,stroke:"#000000","stroke-width":10,"stroke-opacity":20,fill:Se,"fill-opacity":.3}}}),s(se,nd(),_,!0,.5,!0),a("Voronoi polygons created successfully!",{variant:"success",autoHideDuration:2500}),!0))}catch(oe){return console.error("Error creating Voronoi polygons:",oe),a("An error occurred while creating Voronoi polygons.",{variant:"error",autoHideDuration:2500}),!1}},ye=()=>{W(!0),le()&&_e()&&t()},de=oe=>{const xe=oe.target.value;if(f(xe),!H){const he=Z.find(Ee=>Ee.id===xe);he&&r(`${he.name}_Voronoi`)}},ce=oe=>{r(oe.target.value),q(!0)};return K.jsxs(od,{open:e,onClose:t,header:"Voronoi Tool",submitLabel:"Generate Voronoi",onSubmit:ye,headermargin:.5,children:[K.jsx(Ci,{sx:{mb:3},children:K.jsx(To,{mx:{fontSize:"0.7rem",color:"#ECAC7A",mb:2},children:"Select a point layer to generate Voronoi polygons"})}),K.jsxs(up,{fullWidth:!0,variant:"standard",sx:{mb:3},error:!u&&j,children:[K.jsx(cp,{shrink:!0,sx:{color:"#A8D99C","&.Mui-focused":{color:"#A8D99C"}},children:"Select Point Layer"}),K.jsx(Zd,{value:u,onChange:de,MenuProps:{PaperProps:{sx:{bgcolor:"#555555",color:"#ffffff","& .MuiMenuItem-root":{"&:hover":{bgcolor:"rgba(255, 255, 255, 0.1)"},"&.Mui-selected":{bgcolor:"rgba(255, 255, 255, 0.1)"},"&.Mui-selected:hover":{bgcolor:"rgba(255, 255, 255, 0.1)"}}}}},sx:{bgcolor:"#555555",color:"#ffffff","&:before":{borderBottomColor:"#ffffff"},"&:hover:not(.Mui-disabled):before":{borderBottomColor:"#A8D99C"},"&:after":{borderBottomColor:"#A8D99C"},"& .MuiSelect-icon":{color:"#A8D99C"}},children:Z.map(oe=>K.jsx(gl,{value:oe.id,sx:{color:"#ffffff"},children:oe.name},oe.id))}),!u&&j&&K.jsx(To,{sx:{color:"#d32f2f",fontSize:"0.8rem",marginTop:"4px"},children:"Please select a layer containing points."})]}),K.jsx(mP,{control:K.jsx(kie,{checked:C,onChange:oe=>k(oe.target.checked),sx:{"&:active":{"& .MuiSwitch-track":{bgcolor:"#81c784"}},"& .MuiSwitch-switchBase":{"&.Mui-checked":{color:"#fff","& + .MuiSwitch-track":{bgcolor:"#A8D99C"}}},"& .MuiSwitch-thumb":{bgcolor:"#A8D99C"},"& .MuiSwitch-track":{bgcolor:"#e0e0e0"}}}),label:"Use Custom Bounding Box",sx:{mb:3}}),C&&K.jsxs(up,{fullWidth:!0,variant:"standard",sx:{mb:3},error:j&&C&&!I,children:[K.jsx(cp,{shrink:!0,sx:{color:"#A8D99C","&.Mui-focused":{color:"#A8D99C"}},children:"Select Bounding Box Layer"}),K.jsx(Zd,{value:I,onChange:oe=>P(oe.target.value),MenuProps:{PaperProps:{sx:{bgcolor:"#555555",color:"#ffffff","& .MuiMenuItem-root":{"&:hover":{bgcolor:"rgba(255, 255, 255, 0.1)"},"&.Mui-selected":{bgcolor:"rgba(255, 255, 255, 0.1)"},"&.Mui-selected:hover":{bgcolor:"rgba(255, 255, 255, 0.1)"}}}}},sx:{bgcolor:"#555555",color:"#ffffff","&:before":{borderBottomColor:"#ffffff"},"&:hover:not(.Mui-disabled):before":{borderBottomColor:"#A8D99C"},"&:after":{borderBottomColor:"#A8D99C"},"& .MuiSelect-icon":{color:"#A8D99C"}},children:re.map(oe=>K.jsx(gl,{value:oe.id,sx:{color:"#ffffff"},children:oe.name},oe.id))}),j&&C&&!I&&K.jsx(To,{sx:{color:"#d32f2f",fontSize:"0.8rem",marginTop:"4px"},children:"Please select a bounding box polygon layer."})]}),K.jsx(Bh,{label:"Output Layer Name",value:_,onChange:ce,error:D,helperText:D?"Please enter an output layer name.":"",InputLabelProps:{shrink:!0}})]})},Xle=({open:e,onClose:t})=>{const{layers:n}=Lu(),{addLayer:s}=_c(),{enqueueSnackbar:a}=vp(),[u,f]=X.useState(""),[_,r]=X.useState(""),[C,k]=X.useState(!1),[I,P]=X.useState(!1),[D,N]=X.useState(!1),j=n.filter(le=>le.type==="Point"),W=()=>{const le=u!=="",_e=_!=="";return k(!_e),le&&_e},H=()=>{if(!W())return!1;try{const le=j.find(xe=>xe.id===u);if(!le)return a("Selected layer not found.",{variant:"error",autoHideDuration:2500}),!1;const _e=(le.data.features??[]).filter(xe=>{var he;return(xe==null?void 0:xe.geometry)!==null&&((he=xe==null?void 0:xe.geometry)==null?void 0:he.type)==="Point"&&xe.geometry.coordinates.length===2&&xe.geometry.coordinates.every(Ee=>typeof Ee=="number")});if(_e.length===0)return a("The selected layer has no valid point features.",{variant:"error",autoHideDuration:2500}),!1;const ye=Array.from(new Map(_e.map(xe=>[xe.geometry.coordinates.toString(),xe])).values());if(ye.length<3)return a("Insufficient unique points to create a TIN. At least 3 unique points are required.",{variant:"error",autoHideDuration:2500}),!1;const de=ye.filter((xe,he,Ee)=>!Ee.some((se,we)=>{if(he===we)return!1;const[Se,Pe]=xe.geometry.coordinates,[Me,Re]=se.geometry.coordinates;return Math.sqrt((Me-Se)**2+(Re-Pe)**2)<1e-5}));if(de.length<3)return a("Insufficient valid points after filtering. Ensure points are not too close together.",{variant:"error",autoHideDuration:2500}),!1;const oe=bq({type:"FeatureCollection",features:de});return!oe||oe.features.length===0?(a("No TIN polygons were generated.",{variant:"error",autoHideDuration:2500}),!1):(s(oe,nd(),_,!0,.5,!0),a("TIN polygons created successfully!",{variant:"success",autoHideDuration:2500}),!0)}catch(le){return console.error("Error creating TIN polygons:",le),a("An error occurred while creating TIN polygons.",{variant:"error",autoHideDuration:2500}),!1}},q=()=>{P(!0),W()&&H()&&t()},Z=le=>{const _e=le.target.value;if(f(_e),!D){const ye=j.find(de=>de.id===_e);ye&&r(`${ye.name}_TIN`)}},re=le=>{r(le.target.value),N(!0)};return K.jsxs(od,{open:e,onClose:t,header:"TIN Tool",submitLabel:"Generate TIN",onSubmit:q,headermargin:.5,children:[K.jsx(Ci,{sx:{mb:3},children:K.jsx(To,{mx:{fontSize:"0.7rem",color:"#ECAC7A",mb:2},children:"Select a point layer to generate a Triangular Irregular Network"})}),K.jsxs(up,{fullWidth:!0,variant:"standard",sx:{mb:3},error:!u&&I,children:[K.jsx(cp,{shrink:!0,sx:{color:"#A8D99C","&.Mui-focused":{color:"#A8D99C"}},children:"Select Point Layer"}),K.jsx(Zd,{value:u,onChange:Z,MenuProps:{PaperProps:{sx:{bgcolor:"#555555",color:"#ffffff","& .MuiMenuItem-root":{"&:hover":{bgcolor:"rgba(255, 255, 255, 0.1)"},"&.Mui-selected":{bgcolor:"rgba(255, 255, 255, 0.1)"},"&.Mui-selected:hover":{bgcolor:"rgba(255, 255, 255, 0.1)"}}}}},sx:{bgcolor:"#555555",color:"#ffffff","&:before":{borderBottomColor:"#ffffff"},"&:hover:not(.Mui-disabled):before":{borderBottomColor:"#A8D99C"},"&:after":{borderBottomColor:"#A8D99C"},"& .MuiSelect-icon":{color:"#A8D99C"}},children:j.map(le=>K.jsx(gl,{value:le.id,sx:{color:"#ffffff"},children:le.name},le.id))}),!u&&I&&K.jsx(To,{sx:{color:"#d32f2f",fontSize:"0.8rem",marginTop:"4px"},children:"Please select a layer containing points."})]}),K.jsx(Bh,{label:"Output Layer Name",value:_,onChange:re,error:C,helperText:C?"Please enter an output layer name.":"",InputLabelProps:{shrink:!0}})]})},Yle="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20290%20290'%3e%3cpath%20d='M285.857,52.128l-42.557,42.557c-3.887,3.887-10.184,3.887-14.072,0l-33.914-33.914c-3.887-3.887-3.887-10.186,0-14.071%20l42.557-42.556c-26.965-9.211-58.012-3.066-79.518,18.441c-22.459,22.457-28.162,55.313-17.129,83.063l-45.361,45.359%20c-25.279-9.078-54.639-3.505-74.889,16.747c-27.967,27.966-27.965,73.308,0,101.271c27.961,27.964,73.303,27.966,101.27,0%20c20.252-20.253,25.826-49.614,16.748-74.893l45.359-45.359c27.75,11.032,60.607,5.33,83.065-17.127%20C288.922,110.141,295.068,79.095,285.857,52.128z%20M99.793,246.573L61.291,256.89l-28.182-28.181l10.318-38.501l38.5-10.318%20l28.184,28.182L99.793,246.573z'%20fill='%23424242'/%3e%3c/svg%3e",Zle="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!--%20Uploaded%20to:%20SVG%20Repo,%20www.svgrepo.com,%20Generator:%20SVG%20Repo%20Mixer%20Tools%20--%3e%3csvg%20width='800px'%20height='800px'%20viewBox='0%200%20100%20100'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20aria-hidden='true'%20role='img'%20class='iconify%20iconify--gis'%20preserveAspectRatio='xMidYMid%20meet'%3e%3cpath%20d='M72.61%202.514a24.606%2024.606%200%200%200-10.727%202.611l2.244%204.467a19.661%2019.661%200%200%201%208.541-2.078zm3.837.254l-.714%204.949a19.696%2019.696%200%200%201%208.197%203.181l2.808-4.136a24.635%2024.635%200%200%200-10.29-3.994zM57.24%208.146c-2.948%202.415-4.887%205.22-7.105%206.971l3.098%203.924c3.01-2.377%204.961-5.213%207.175-7.025zm33.711%202.229l-3.66%203.406a19.29%2019.29%200%200%201%204.334%207.623l4.795-1.42a24.23%2024.23%200%200%200-5.469-9.609zm-44.57%208.47l-7.072%207.073l3.537%203.535l7.07-7.07zm51.02%206.59l-4.989.34a20.11%2020.11%200%200%201-1.342%208.713l4.65%201.838a25.048%2025.048%200%200%200%201.68-10.89zm-61.627%204.018l-7.07%207.07l3.534%203.536l7.07-7.07zm53.218%208.934a18.87%2018.87%200%200%201-2.195%202.629l-.004.004l-4.324%204.324l3.535%203.535l4.32-4.32l.004-.004a23.832%2023.832%200%200%200%202.774-3.323zm-63.826%201.672l-7.07%207.07l3.535%203.537l7.07-7.072zm53.768%208.82l-7.07%207.072l3.535%203.535l7.07-7.072zm-64.375%201.787l-4.887%204.887a24.036%2024.036%200%200%200-2.254%202.601l4.004%202.994a19.044%2019.044%200%200%201%201.785-2.06l4.889-4.887zm53.767%208.82l-7.07%207.07l3.535%203.536l7.072-7.07zM4.621%2062.961a24.991%2024.991%200%200%200-2.066%2010.828l4.998-.164A20.055%2020.055%200%200%201%209.2%2064.967zm53.1%207.13l-7.07%207.073l3.535%203.535l7.07-7.07zM8.184%2078.024L3.342%2079.27a24.293%2024.293%200%200%200%205.111%209.8l3.785-3.267a19.353%2019.353%200%200%201-4.054-7.78zm39.244%202.41c-3.24%202.319-5.144%205.305-7.297%207.202l3.305%203.75c2.85-2.512%204.68-5.294%206.902-6.885zm-31.942%208.362l-2.943%204.04a24.49%2024.49%200%200%200%2010.176%204.298l.861-4.926c-2.912-.51-5.718-1.682-8.094-3.412zm21.02%201.37a19.883%2019.883%200%200%201-8.49%202.327l.226%204.994a24.823%2024.823%200%200%200%2010.637-2.922z'%20fill='%23000000'%20fill-rule='evenodd'%3e%3c/path%3e%3cg%20fill='%23000000'%20fill-rule='evenodd'%3e%3cpath%20d='M24.113%2075.887l51.774-51.774'%3e%3c/path%3e%3cpath%20d='M75.855%2021.613a2.5%202.5%200%200%200-1.736.733L22.346%2074.119a2.5%202.5%200%200%200%200%203.535a2.5%202.5%200%200%200%203.535%200l51.773-51.773a2.5%202.5%200%200%200%200-3.535a2.5%202.5%200%200%200-1.799-.733z'%3e%3c/path%3e%3c/g%3e%3c/svg%3e",Kle="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!--%20Uploaded%20to:%20SVG%20Repo,%20www.svgrepo.com,%20Generator:%20SVG%20Repo%20Mixer%20Tools%20--%3e%3csvg%20fill='%23000000'%20width='800px'%20height='800px'%20viewBox='0%200%20256.00098%20256.00098'%20id='Flat'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M174.63477,81.36523a79.99168,79.99168,0,1,0-93.26954,93.26954,79.99168,79.99168,0,1,0,93.26954-93.26954ZM32,96A64.00385,64.00385,0,0,1,157.98779,80.05127,80.06522,80.06522,0,0,0,80.051,157.98779,64.1144,64.1144,0,0,1,32,96ZM160,224a64.11421,64.11421,0,0,1-61.98779-48.05127A80.06522,80.06522,0,0,0,175.949,98.01221,64.00389,64.00389,0,0,1,160,224Z'/%3e%3c/svg%3e",Jle="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!--%20Uploaded%20to:%20SVG%20Repo,%20www.svgrepo.com,%20Generator:%20SVG%20Repo%20Mixer%20Tools%20--%3e%3csvg%20width='800px'%20height='800px'%20viewBox='0%200%20100%20100'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20aria-hidden='true'%20role='img'%20class='iconify%20iconify--gis'%20preserveAspectRatio='xMidYMid%20meet'%3e%3cpath%20d='M65%2010.875c-8.935%200-17.088%203.375-23.277%208.906A34.835%2034.835%200%200%200%2035%2019.125c-19.3%200-35%2015.7-35%2035s15.7%2035%2035%2035c8.935%200%2017.088-3.375%2023.277-8.906c2.176.427%204.423.656%206.723.656c19.3%200%2035-15.7%2035-35s-15.7-35-35-35zM48.805%2021.908a35.108%2035.108%200%200%201%209.093%205.684l-3.265%203.787a30.147%2030.147%200%200%200-7.799-4.873l1.97-4.598zM35.925%2026.4l4.155%202.784a30.15%2030.15%200%200%200-3.892%208.332l-4.801-1.399a35.114%2035.114%200%200%201%204.539-9.717zm25.766%205.004a34.787%2034.787%200%200%201%205.621%209.143l-4.61%201.93a29.822%2029.822%200%200%200-4.815-7.827l3.804-3.246zm-31.408%209.977l4.96.648a29.808%2029.808%200%200%200%20.234%209.186l-4.918.896a34.778%2034.778%200%200%201-.276-10.73zm38.719%204.273c.43%201.741.729%203.515.89%205.301c.163%201.786.187%203.586.073%205.379l-4.988-.318a30.26%2030.26%200%200%200-.83-9.162l4.855-1.2zM36.645%2055.682c1%202.908%202.452%205.665%204.289%208.127l-4.006%202.99a34.81%2034.81%200%200%201-5.012-9.49l4.729-1.627zM64.33%2060.58l4.88%201.082a34.906%2034.906%200%200%201-3.905%209.992l-4.323-2.513a29.948%2029.948%200%200%200%203.348-8.56zm-20.363%206.701a30.143%2030.143%200%200%200%207.472%205.364l-2.261%204.459a35.093%2035.093%200%200%201-8.713-6.254l3.502-3.569z'%20fill='%23000000'%3e%3c/path%3e%3c/svg%3e",Qle="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!--%20Uploaded%20to:%20SVG%20Repo,%20www.svgrepo.com,%20Generator:%20SVG%20Repo%20Mixer%20Tools%20--%3e%3csvg%20width='800px'%20height='800px'%20viewBox='0%200%20100%20100'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20aria-hidden='true'%20role='img'%20class='iconify%20iconify--gis'%20preserveAspectRatio='xMidYMid%20meet'%3e%3cpath%20d='M65.453%2010.826l-.053%205c3.073.034%206.144.549%209.059%201.52l1.58-4.744a34.758%2034.758%200%200%200-10.586-1.776zm-5.365.352a35.131%2035.131%200%200%200-10.26%203.119l2.17%204.506a30.166%2030.166%200%200%201%208.799-2.674l-.71-4.951zm20.908%203.51l-2.283%204.447a30.131%2030.131%200%200%201%207.447%205.394l3.522-3.549a35.101%2035.101%200%200%200-8.686-6.293zM35%2019.125c-19.3%200-35%2015.7-35%2035s15.7%2035%2035%2035c8.934%200%2017.087-3.374%2023.275-8.904c.005%200%20.01%200%20.014.002c.065-.059.127-.121.191-.18l.125-.115a34.677%2034.677%200%200%200%202.461-2.496c.083-.092.167-.183.248-.276c.399-.455.79-.919%201.165-1.394c-.482-.04-.961-.092-1.436-.155c-.318-.041-.632-.094-.947-.146c-.158-.026-.316-.046-.473-.074a29.93%2029.93%200%200%201-1.383-.283a29.851%2029.851%200%200%201-1.183-.301c-.065-.018-.13-.033-.194-.051C44.234%2071.216%2035%2059.651%2035%2045.875a29.876%2029.876%200%200%201%209.557-21.955c.162-.151.324-.302.49-.45c.249-.22.504-.436.76-.65c.158-.131.313-.266.474-.394c.415-.332.837-.656%201.27-.965a35.075%2035.075%200%200%200-2.867-.965l-.03-.008c-.287-.082-.577-.155-.867-.23c-.215-.056-.43-.118-.646-.17c-.349-.084-.701-.155-1.053-.229c-.126-.026-.25-.057-.377-.082l-.002.002A34.83%2034.83%200%200%200%2035%2019.125zm58.2%205.928l-4.028%202.967a30.012%2030.012%200%200%201%204.252%208.15l4.736-1.606a34.98%2034.98%200%200%200-4.96-9.511zm6.294%2014.717l-4.924.87c.536%203.029.603%206.145.194%209.19l4.955.666c.48-3.562.4-7.19-.225-10.726zM93.8%2054.338a30.198%2030.198%200%200%201-3.936%208.314l4.143%202.801a35.162%2035.162%200%200%200%204.586-9.695l-4.793-1.42zm-6.803%2011.928a29.79%2029.79%200%200%201-7.213%205.687l2.451%204.358a34.776%2034.776%200%200%200%208.428-6.647l-3.666-3.398zm-11.394%207.638a30.155%2030.155%200%200%201-9.002%201.887l.265%204.992a35.12%2035.12%200%200%200%2010.498-2.199l-1.761-4.68z'%20fill='%23000000'%3e%3c/path%3e%3c/svg%3e",eue="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!--%20Uploaded%20to:%20SVG%20Repo,%20www.svgrepo.com,%20Generator:%20SVG%20Repo%20Mixer%20Tools%20--%3e%3csvg%20width='800px'%20height='800px'%20viewBox='0%200%2024%2024'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M16.5%2019.786a7.228%207.228%200%200%201-4-1.196%207.286%207.286%200%201%201%200-12.18%207.286%207.286%200%201%201%204%2013.376zm-4-2.388l.286.209a6.314%206.314%200%201%200%200-10.214l-.286.209-.286-.209a6.314%206.314%200%201%200%200%2010.214z'/%3e%3cpath%20fill='none'%20d='M0%200h24v24H0z'/%3e%3c/svg%3e",tue="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!--%20Uploaded%20to:%20SVG%20Repo,%20www.svgrepo.com,%20Generator:%20SVG%20Repo%20Mixer%20Tools%20--%3e%3csvg%20width='800px'%20height='800px'%20viewBox='0%200%20100%20100'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20aria-hidden='true'%20role='img'%20class='iconify%20iconify--gis'%20preserveAspectRatio='xMidYMid%20meet'%3e%3cpath%20d='M2.5%2012.5A2.5%202.5%200%200%200%200%2015v70a2.5%202.5%200%200%200%202.5%202.5h95A2.5%202.5%200%200%200%20100%2085V15a2.5%202.5%200%200%200-2.5-2.5zm2.5%205h43.745l-.033%205.709l-16.68%2027.883L5%2064.367zm46.747%200H95v26.108l-25.982.397l-17.304-20.853zm-1.432%208.857l16.36%2019.53l-5.86%2012.244l-9.934%201.396l-15.722-7.808zM95%2046.761V82.5h-7.232L63.637%2059.213l5.84-12.204zm-61.991%207.184l16.15%208.053L50.966%2082.5H5V67.674zm28.26%207.15L83.448%2082.5H53.98L52.2%2062.371z'%20fill='%23000000'%3e%3c/path%3e%3cpath%20d='M60.366%2068.73a4%204%200%200%200-4%204a4%204%200%200%200%204%204a4%204%200%200%200%204-4a4%204%200%200%200-4-4z'%20fill='%23000000'%3e%3c/path%3e%3cpath%20d='M79.462%2054.984a4%204%200%200%200-4%204a4%204%200%200%200%204%204a4%204%200%200%200%204-4a4%204%200%200%200-4-4z'%20fill='%23000000'%3e%3c/path%3e%3cpath%20d='M74.561%2026.805a4%204%200%200%200-4%204a4%204%200%200%200%204%204a4%204%200%200%200%204-4a4%204%200%200%200-4-4z'%20fill='%23000000'%3e%3c/path%3e%3cpath%20d='M23.979%2026.105a4%204%200%200%200-4%204a4%204%200%200%200%204%204a4%204%200%200%200%204-4a4%204%200%200%200-4-4z'%20fill='%23000000'%3e%3c/path%3e%3cpath%20d='M53.908%2042.907a4%204%200%200%200-4%204a4%204%200%200%200%204%204a4%204%200%200%200%204-4a4%204%200%200%200-4-4z'%20fill='%23000000'%3e%3c/path%3e%3cpath%20d='M39.03%2064.435a4%204%200%200%200-4%204a4%204%200%200%200%204%204a4%204%200%200%200%204-4a4%204%200%200%200-4-4z'%20fill='%23000000'%3e%3c/path%3e%3c/svg%3e",nue="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!--%20Uploaded%20to:%20SVG%20Repo,%20www.svgrepo.com,%20Generator:%20SVG%20Repo%20Mixer%20Tools%20--%3e%3csvg%20width='800px'%20height='800px'%20viewBox='0%200%2016%2016'%20xmlns='http://www.w3.org/2000/svg'%20fill='%23000000'%20class='bi%20bi-bounding-box-circles'%3e%3cpath%20d='M2%201a1%201%200%201%200%200%202%201%201%200%200%200%200-2zM0%202a2%202%200%200%201%203.937-.5h8.126A2%202%200%201%201%2014.5%203.937v8.126a2%202%200%201%201-2.437%202.437H3.937A2%202%200%201%201%201.5%2012.063V3.937A2%202%200%200%201%200%202zm2.5%201.937v8.126c.703.18%201.256.734%201.437%201.437h8.126a2.004%202.004%200%200%201%201.437-1.437V3.937A2.004%202.004%200%200%201%2012.063%202.5H3.937A2.004%202.004%200%200%201%202.5%203.937zM14%201a1%201%200%201%200%200%202%201%201%200%200%200%200-2zM2%2013a1%201%200%201%200%200%202%201%201%200%200%200%200-2zm12%200a1%201%200%201%200%200%202%201%201%200%200%200%200-2z'/%3e%3c/svg%3e",rue=Dn(Ci)(()=>({position:"fixed",right:10,top:"55%",background:"rgba(255, 255, 255, 0.5)",boxShadow:"0 0 5px rgba(0,0,0,0.5)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start",transform:"translateY(-50%)",transition:"width 0.3s ease-in-out",zIndex:1e3,borderRadius:"20px",gap:"8px",paddingTop:"10px",paddingBottom:"10px"})),sV=Dn(Ci)(({isOpen:e})=>({opacity:e?1:0,transition:"opacity 0.5s ease"})),iue=Dn(Ci)(({isOpen:e})=>({opacity:e?1:0,transition:"opacity 2.0s ease"})),_h=({src:e,icon:t,tooltip:n,isOpen:s,onClick:a})=>K.jsx(sV,{isOpen:s,children:K.jsx(DE,{onClick:a,tooltipTitle:n,icon:e?K.jsx("img",{src:e,alt:n,style:{width:"100%",height:"100%"}}):t,tooltipPlacement:"right",width:50,height:50})}),oue=({isOpen:e,onToggle:t})=>{const[n,s]=X.useState(!1),[a,u]=X.useState(!1),[f,_]=X.useState(!1),[r,C]=X.useState(!1),[k,I]=X.useState(!1),[P,D]=X.useState(!1),[N,j]=X.useState(!1),[W,H]=X.useState(!1),[q,Z]=X.useState(!1);return K.jsxs(K.Fragment,{children:[K.jsxs(rue,{sx:{width:e?75:0},children:[K.jsx(_h,{src:Zle,tooltip:"Buffer",isOpen:e,onClick:()=>s(!0)}),K.jsx(_h,{src:Kle,tooltip:"Intersect",isOpen:e,onClick:()=>u(!0)}),K.jsx(_h,{src:Jle,tooltip:"Union",isOpen:e,onClick:()=>_(!0)}),K.jsx(_h,{src:Qle,tooltip:"Difference",isOpen:e,onClick:()=>C(!0)}),K.jsx(_h,{src:eue,tooltip:"Dissolve",isOpen:e,onClick:()=>I(!0)}),K.jsx(_h,{src:tue,tooltip:"Voronoi",isOpen:e,onClick:()=>H(!0)}),K.jsx(_h,{icon:K.jsx(soe,{sx:{color:"black",width:40,height:40,mt:-.5}}),tooltip:"TIN",isOpen:e,onClick:()=>Z(!0)}),K.jsx(_h,{src:nue,tooltip:"Bounding Box",isOpen:e,onClick:()=>D(!0)}),K.jsx(_h,{icon:K.jsx(uoe,{sx:{color:"black",width:24,height:24}}),tooltip:"Clip",isOpen:e,onClick:()=>j(!0)}),K.jsx(sV,{isOpen:e,children:K.jsx(ga,{onClick:t,sx:{marginTop:"auto"},children:K.jsx(ioe,{})})})]}),!e&&K.jsx(iue,{isOpen:!e,children:K.jsx(DE,{onClick:t,tooltipTitle:"GIS Tools",icon:K.jsx("img",{src:Yle,alt:"GIS Tools",style:{width:"80%",height:"80%"}}),tooltipPlacement:"right",top:"50%",right:15,transform:"translateY(-70%)",absolute:!0})}),n&&K.jsx(jle,{open:n,onClose:()=>s(!1)}),a&&K.jsx(Vle,{open:a,onClose:()=>u(!1),operationLabel:"Intersection",turfFunction:A3}),f&&K.jsx($le,{open:f,onClose:()=>_(!1),operationLabel:"Union",turfFunction:O3}),r&&K.jsx(Ule,{open:r,onClose:()=>C(!1),operationLabel:"Difference",turfFunction:P3}),k&&K.jsx(Gle,{open:k,onClose:()=>I(!1)}),P&&K.jsx(Hle,{open:P,onClose:()=>D(!1)}),N&&K.jsx(Wle,{open:N,onClose:()=>j(!1)}),W&&K.jsx(qle,{open:W,onClose:()=>H(!1)}),q&&K.jsx(Xle,{open:q,onClose:()=>Z(!1)})]})},sue="modulepreload",aue=function(e){return"/YouGIS/"+e},k4={},aV=function(t,n,s){let a=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const f=document.querySelector("meta[property=csp-nonce]"),_=(f==null?void 0:f.nonce)||(f==null?void 0:f.getAttribute("nonce"));a=Promise.allSettled(n.map(r=>{if(r=aue(r),r in k4)return;k4[r]=!0;const C=r.endsWith(".css"),k=C?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${r}"]${k}`))return;const I=document.createElement("link");if(I.rel=C?"stylesheet":sue,C||(I.as="script"),I.crossOrigin="",I.href=r,_&&I.setAttribute("nonce",_),document.head.appendChild(I),C)return new Promise((P,D)=>{I.addEventListener("load",P),I.addEventListener("error",()=>D(new Error(`Unable to preload CSS for ${r}`)))})}))}function u(f){const _=new Event("vite:preloadError",{cancelable:!0});if(_.payload=f,window.dispatchEvent(_),!_.defaultPrevented)throw f}return a.then(f=>{for(const _ of f||[])_.status==="rejected"&&u(_.reason);return t().catch(u)})},lue="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'?%3e%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%202048%202048'%3e%3cg%20id='Layer_x0020_1'%3e%3cg%20id='_309137896'%3e%3cpath%20d='M889.444%20679.767l-63.4016%202.88189%20-138.027%20-161.03c-0.94252,-1.27913%20-1.9937,-2.50394%20-3.15118,-3.66142%20-3.35315,-3.35315%20-7.26615,-5.80394%20-11.4378,-7.35827l365.711%20928.854c93.0414,159.715%20164.548,141.918%20343.65,97.1646%2089.4816,-22.3595%20209.004,-52.2248%20378.387,-65.8796%204.70788,-0.168898%209.45001,-1.38307%2013.8851,-3.74882%2015.5929,-8.31615%2021.4925,-27.7016%2013.1764,-43.2945l-0.109843%200.0590552%20-397.812%20-745.897c-5.05512,-12.0012%20-17.1862,-20.1697%20-30.9544,-19.5449l0.00472441%200.0956694%20-6.45%200.292914c-0.672048,8.14961%20-1.62756,16.2697%20-2.82992,24.3295%20-3.42874,22.9855%20-8.87245,45.6957%20-15.7039,67.8993%20-30.665,99.6757%20-97.0583,211.766%20-170.06,285.529%20-11.8583,11.9811%20-27.3024,19.3713%20-44.3197,19.3713%20-17.0173,0%20-32.4614,-7.39016%20-44.3197,-19.3713%20-73.0016,-73.7634%20-139.395,-185.854%20-170.06,-285.529%20-6.8315,-22.2036%20-12.2752,-44.9138%20-15.7039,-67.8993%20-0.161811,-1.08662%20-0.320079,-2.17323%20-0.472441,-3.26221zm-248.021%20-163.491c-0.62126,0.532678%20-1.22599,1.09252%20-1.81417,1.68071l0.00236221%200.00236221%20-123.567%20123.567%20372.873%20939.01%200.351969%20-0.571654%20-0.0637796%20-0.0897638%20103.237%20-172.061%20-351.019%20-891.538zm-159.554%20159.427l-0.735827%200.735827%20-36.6603%20-164.971c-1.20591,-9.1441%20-6.33544,-17.6988%20-14.7673,-22.9689%20-14.9858,-9.36615%20-34.7303,-4.81063%20-44.0965,10.1752l27.1358%2016.9606%20-27.1252%20-16.8756%20-123.749%20197.999c-4.51181,6.38032%20-6.71339,14.4154%20-5.58189,22.7681l0.0897638%20-0.011811%20118.043%20870.825c0.390945,6.68504%202.87362,13.3039%207.5378,18.8043%2011.4295,13.4788%2031.624,15.1417%2045.1028,3.71221l-0.0448819%20-0.0531496%20174.632%20-148.07%20-119.78%20-789.03zm151.678%20788.029l209.682%20125.81c0.687402,0.490158%201.39961,0.956694%202.13543,1.39843%204.80827,2.88425%2010.0689,4.35709%2015.3024,4.54252l-335.308%20-844.41%20108.188%20712.659z'%20fill='%23424242'%20/%3e%3cpath%20d='M1098.42%201013.95c6.65315,6.65315%2014.1354,9.74292%2021.5752,9.88111%207.43977,-0.138189%2014.9221,-3.22796%2021.5752,-9.88111%2060.0119,-61.2709%20129.821,-167.125%20162.22,-272.43%206.52678,-21.2162%2011.5358,-42.4087%2014.6398,-63.2115%205.63859,-37.7906%204.99252,-74.2902%20-4.25433,-107.286%20-53.6103,-191.294%20-334.751,-191.294%20-388.361,0%20-9.24686,32.9953%20-9.89292,69.4949%20-4.25433,107.286%203.10394,20.8028%208.113,41.9953%2014.6398,63.2115%2032.3988,105.305%20102.208,211.159%20162.22,272.43zm-52.6996%20-309.555c-19.337,-19.337%20-31.2981,-46.05%20-31.2981,-75.5505%200,-29.5016%2011.961,-56.2134%2031.2981,-75.5505%2041.3835,-41.3835%20107.166,-41.3835%20148.55,0%2019.337,19.337%2031.2981,46.0489%2031.2981,75.5505%200,29.5004%20-11.961,56.2134%20-31.2981,75.5505%20-41.3835,41.3835%20-107.166,41.3835%20-148.55,0z'%20fill='%23424242'%20/%3e%3c/g%3e%3c/g%3e%3crect%20fill='none'%20width='2048'%20height='2048'%20/%3e%3c/svg%3e",lV="/YouGIS/assets/YouGis-Dd679Htv.svg",Av=({icon:e,tooltipTitle:t,onClick:n,disabled:s=!1,id:a})=>K.jsx(d1,{title:t,placement:"top",arrow:!0,children:K.jsx("span",{children:K.jsx(ga,{id:a,onClick:s?void 0:n,disabled:s,sx:{color:"white",opacity:s?.7:1},children:e})})}),uV=X.createContext(void 0),uue=({children:e})=>{const[t,n]=X.useState([]),s=X.useCallback((C,k,I)=>{const P=C.features.length>0?C.features[0].geometry.type:"Unknown",D={id:J6(),name:k,color:I||nd(),data:C,opacity:1,type:P==="Point"?"Point":P==="LineString"||P==="MultiLineString"?"LineString":P==="Polygon"||P==="MultiPolygon"?"Polygon":"Unknown"};n(N=>[...N,D])},[]),a=X.useCallback(C=>{n(k=>k.filter(I=>I.id!==C))},[]),u=X.useCallback((C,k)=>{n(I=>I.map(P=>P.id===C?{...P,name:k}:P))},[]),f=X.useCallback((C,k)=>{n(I=>I.map(P=>P.id===C?{...P,color:k}:P))},[]),_=X.useCallback(()=>{n([])},[]),r=X.useMemo(()=>({tempLayers:t,addTempLayer:s,removeLayer:a,updateTempLayerName:u,updateTempLayerColor:f,clearTempLayers:_}),[t,s,a,u,f,_]);return K.jsx(uV.Provider,{value:r,children:e})},cV=()=>{const e=X.useContext(uV);if(!e)throw new Error("useTempLayerContext must be used within a TempLayerProvider");return e},cue=e=>K.jsx(Bx,{...e,children:K.jsx("rect",{width:"24",height:"24",rx:"3",ry:"3"})}),dV=({layerId:e,size:t=24,isTempLayers:n=!1})=>{const{layers:s}=Lu(),{tempLayers:a}=cV(),f=(n?a:s).find(k=>k.id===e);if(!f)return console.warn("Layer not found for ID:",e),null;const _=()=>f.color||"#000",r={display:"flex",alignItems:"center",justifyContent:"center",width:`${t}px`,height:`${t}px`,backgroundColor:"transparent",marginRight:"8px"},C=()=>{let k=t-4;switch(f.type){case"Polygon":case"MultiPolygon":return k=t-8,K.jsx(cue,{style:{fontSize:`${k}px`,color:_(),backgroundColor:"transparent",borderRadius:"1px",border:"none"}});case"LineString":case"MultiLineString":return k=t,K.jsx(_oe,{style:{fontSize:`${k}px`,color:_(),backgroundColor:"transparent"}});case"Point":return k=t-8,K.jsx(hoe,{style:{fontSize:`${k}px`,color:_(),backgroundColor:"transparent"}});default:return console.warn("Unidentified layer type:",f.type),null}};return K.jsx("div",{style:r,children:C()})},due=({open:e,onClose:t})=>{const{removeLayer:n}=_c(),{layers:s}=Lu(),{selectedLayerIds:a,deselectLayer:u}=$3(),f=s.filter(C=>a.includes(C.id)),_=C=>{u(C)},r=()=>{f.forEach(C=>n(C.id)),t()};return K.jsx(od,{open:e,onClose:t,header:"Delete Selected Layers",submitLabel:"Delete",onSubmit:r,disableSubmit:f.length===0,modalWidth:400,children:f.length===0?K.jsx(To,{children:"No layers selected for deletion."}):K.jsxs(Ci,{children:[K.jsx(To,{sx:{mb:2},children:"Are you sure you want to delete the following layers?"}),K.jsx(Ci,{sx:{maxHeight:"60vh",overflowY:"auto"},children:K.jsx(yA,{children:f.map(C=>K.jsxs(i8,{sx:{padding:1,backgroundColor:"rgba(255, 255, 255, 0.05)",marginBottom:"8px",borderRadius:"4px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[K.jsxs(Ci,{sx:{display:"flex",alignItems:"center",flex:1},children:[K.jsx(Ci,{sx:{display:"flex",alignItems:"center",justifyContent:"center",width:"30px",height:"30px",marginRight:"12px"},children:K.jsx(dV,{layerId:C.id,size:24})}),K.jsx(ep,{primary:C.name,sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",color:"white"}})]}),K.jsx(ga,{onClick:k=>{k.stopPropagation(),_(C.id)},"aria-label":"Remove from selection",sx:{color:"#ECAC7A","&:hover":{color:"#FF6F61"}},children:K.jsx(h1,{})})]},C.id))})})]})})};function Gw(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var hV={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(e,t){(function(n){e.exports=n()})(function(){return function n(s,a,u){function f(C,k){if(!a[C]){if(!s[C]){var I=typeof Gw=="function"&&Gw;if(!k&&I)return I(C,!0);if(_)return _(C,!0);var P=new Error("Cannot find module '"+C+"'");throw P.code="MODULE_NOT_FOUND",P}var D=a[C]={exports:{}};s[C][0].call(D.exports,function(N){var j=s[C][1][N];return f(j||N)},D,D.exports,n,s,a,u)}return a[C].exports}for(var _=typeof Gw=="function"&&Gw,r=0;r<u.length;r++)f(u[r]);return f}({1:[function(n,s,a){var u=n("./utils"),f=n("./support"),_="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";a.encode=function(r){for(var C,k,I,P,D,N,j,W=[],H=0,q=r.length,Z=q,re=u.getTypeOf(r)!=="string";H<r.length;)Z=q-H,I=re?(C=r[H++],k=H<q?r[H++]:0,H<q?r[H++]:0):(C=r.charCodeAt(H++),k=H<q?r.charCodeAt(H++):0,H<q?r.charCodeAt(H++):0),P=C>>2,D=(3&C)<<4|k>>4,N=1<Z?(15&k)<<2|I>>6:64,j=2<Z?63&I:64,W.push(_.charAt(P)+_.charAt(D)+_.charAt(N)+_.charAt(j));return W.join("")},a.decode=function(r){var C,k,I,P,D,N,j=0,W=0,H="data:";if(r.substr(0,H.length)===H)throw new Error("Invalid base64 input, it looks like a data url.");var q,Z=3*(r=r.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(r.charAt(r.length-1)===_.charAt(64)&&Z--,r.charAt(r.length-2)===_.charAt(64)&&Z--,Z%1!=0)throw new Error("Invalid base64 input, bad content length.");for(q=f.uint8array?new Uint8Array(0|Z):new Array(0|Z);j<r.length;)C=_.indexOf(r.charAt(j++))<<2|(P=_.indexOf(r.charAt(j++)))>>4,k=(15&P)<<4|(D=_.indexOf(r.charAt(j++)))>>2,I=(3&D)<<6|(N=_.indexOf(r.charAt(j++))),q[W++]=C,D!==64&&(q[W++]=k),N!==64&&(q[W++]=I);return q}},{"./support":30,"./utils":32}],2:[function(n,s,a){var u=n("./external"),f=n("./stream/DataWorker"),_=n("./stream/Crc32Probe"),r=n("./stream/DataLengthProbe");function C(k,I,P,D,N){this.compressedSize=k,this.uncompressedSize=I,this.crc32=P,this.compression=D,this.compressedContent=N}C.prototype={getContentWorker:function(){var k=new f(u.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new r("data_length")),I=this;return k.on("end",function(){if(this.streamInfo.data_length!==I.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),k},getCompressedWorker:function(){return new f(u.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},C.createWorkerFrom=function(k,I,P){return k.pipe(new _).pipe(new r("uncompressedSize")).pipe(I.compressWorker(P)).pipe(new r("compressedSize")).withStreamInfo("compression",I)},s.exports=C},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(n,s,a){var u=n("./stream/GenericWorker");a.STORE={magic:"\0\0",compressWorker:function(){return new u("STORE compression")},uncompressWorker:function(){return new u("STORE decompression")}},a.DEFLATE=n("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(n,s,a){var u=n("./utils"),f=function(){for(var _,r=[],C=0;C<256;C++){_=C;for(var k=0;k<8;k++)_=1&_?3988292384^_>>>1:_>>>1;r[C]=_}return r}();s.exports=function(_,r){return _!==void 0&&_.length?u.getTypeOf(_)!=="string"?function(C,k,I,P){var D=f,N=P+I;C^=-1;for(var j=P;j<N;j++)C=C>>>8^D[255&(C^k[j])];return-1^C}(0|r,_,_.length,0):function(C,k,I,P){var D=f,N=P+I;C^=-1;for(var j=P;j<N;j++)C=C>>>8^D[255&(C^k.charCodeAt(j))];return-1^C}(0|r,_,_.length,0):0}},{"./utils":32}],5:[function(n,s,a){a.base64=!1,a.binary=!1,a.dir=!1,a.createFolders=!0,a.date=null,a.compression=null,a.compressionOptions=null,a.comment=null,a.unixPermissions=null,a.dosPermissions=null},{}],6:[function(n,s,a){var u=null;u=typeof Promise<"u"?Promise:n("lie"),s.exports={Promise:u}},{lie:37}],7:[function(n,s,a){var u=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",f=n("pako"),_=n("./utils"),r=n("./stream/GenericWorker"),C=u?"uint8array":"array";function k(I,P){r.call(this,"FlateWorker/"+I),this._pako=null,this._pakoAction=I,this._pakoOptions=P,this.meta={}}a.magic="\b\0",_.inherits(k,r),k.prototype.processChunk=function(I){this.meta=I.meta,this._pako===null&&this._createPako(),this._pako.push(_.transformTo(C,I.data),!1)},k.prototype.flush=function(){r.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},k.prototype.cleanUp=function(){r.prototype.cleanUp.call(this),this._pako=null},k.prototype._createPako=function(){this._pako=new f[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var I=this;this._pako.onData=function(P){I.push({data:P,meta:I.meta})}},a.compressWorker=function(I){return new k("Deflate",I)},a.uncompressWorker=function(){return new k("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(n,s,a){function u(D,N){var j,W="";for(j=0;j<N;j++)W+=String.fromCharCode(255&D),D>>>=8;return W}function f(D,N,j,W,H,q){var Z,re,le=D.file,_e=D.compression,ye=q!==C.utf8encode,de=_.transformTo("string",q(le.name)),ce=_.transformTo("string",C.utf8encode(le.name)),oe=le.comment,xe=_.transformTo("string",q(oe)),he=_.transformTo("string",C.utf8encode(oe)),Ee=ce.length!==le.name.length,se=he.length!==oe.length,we="",Se="",Pe="",Me=le.dir,Re=le.date,Oe={crc32:0,compressedSize:0,uncompressedSize:0};N&&!j||(Oe.crc32=D.crc32,Oe.compressedSize=D.compressedSize,Oe.uncompressedSize=D.uncompressedSize);var $e=0;N&&($e|=8),ye||!Ee&&!se||($e|=2048);var Ke=0,Ct=0;Me&&(Ke|=16),H==="UNIX"?(Ct=798,Ke|=function(ft,Bt){var hn=ft;return ft||(hn=Bt?16893:33204),(65535&hn)<<16}(le.unixPermissions,Me)):(Ct=20,Ke|=function(ft){return 63&(ft||0)}(le.dosPermissions)),Z=Re.getUTCHours(),Z<<=6,Z|=Re.getUTCMinutes(),Z<<=5,Z|=Re.getUTCSeconds()/2,re=Re.getUTCFullYear()-1980,re<<=4,re|=Re.getUTCMonth()+1,re<<=5,re|=Re.getUTCDate(),Ee&&(Se=u(1,1)+u(k(de),4)+ce,we+="up"+u(Se.length,2)+Se),se&&(Pe=u(1,1)+u(k(xe),4)+he,we+="uc"+u(Pe.length,2)+Pe);var Ue="";return Ue+=`
\0`,Ue+=u($e,2),Ue+=_e.magic,Ue+=u(Z,2),Ue+=u(re,2),Ue+=u(Oe.crc32,4),Ue+=u(Oe.compressedSize,4),Ue+=u(Oe.uncompressedSize,4),Ue+=u(de.length,2),Ue+=u(we.length,2),{fileRecord:I.LOCAL_FILE_HEADER+Ue+de+we,dirRecord:I.CENTRAL_FILE_HEADER+u(Ct,2)+Ue+u(xe.length,2)+"\0\0\0\0"+u(Ke,4)+u(W,4)+de+we+xe}}var _=n("../utils"),r=n("../stream/GenericWorker"),C=n("../utf8"),k=n("../crc32"),I=n("../signature");function P(D,N,j,W){r.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=N,this.zipPlatform=j,this.encodeFileName=W,this.streamFiles=D,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}_.inherits(P,r),P.prototype.push=function(D){var N=D.meta.percent||0,j=this.entriesCount,W=this._sources.length;this.accumulate?this.contentBuffer.push(D):(this.bytesWritten+=D.data.length,r.prototype.push.call(this,{data:D.data,meta:{currentFile:this.currentFile,percent:j?(N+100*(j-W-1))/j:100}}))},P.prototype.openedSource=function(D){this.currentSourceOffset=this.bytesWritten,this.currentFile=D.file.name;var N=this.streamFiles&&!D.file.dir;if(N){var j=f(D,N,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:j.fileRecord,meta:{percent:0}})}else this.accumulate=!0},P.prototype.closedSource=function(D){this.accumulate=!1;var N=this.streamFiles&&!D.file.dir,j=f(D,N,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(j.dirRecord),N)this.push({data:function(W){return I.DATA_DESCRIPTOR+u(W.crc32,4)+u(W.compressedSize,4)+u(W.uncompressedSize,4)}(D),meta:{percent:100}});else for(this.push({data:j.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},P.prototype.flush=function(){for(var D=this.bytesWritten,N=0;N<this.dirRecords.length;N++)this.push({data:this.dirRecords[N],meta:{percent:100}});var j=this.bytesWritten-D,W=function(H,q,Z,re,le){var _e=_.transformTo("string",le(re));return I.CENTRAL_DIRECTORY_END+"\0\0\0\0"+u(H,2)+u(H,2)+u(q,4)+u(Z,4)+u(_e.length,2)+_e}(this.dirRecords.length,j,D,this.zipComment,this.encodeFileName);this.push({data:W,meta:{percent:100}})},P.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},P.prototype.registerPrevious=function(D){this._sources.push(D);var N=this;return D.on("data",function(j){N.processChunk(j)}),D.on("end",function(){N.closedSource(N.previous.streamInfo),N._sources.length?N.prepareNextSource():N.end()}),D.on("error",function(j){N.error(j)}),this},P.prototype.resume=function(){return!!r.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},P.prototype.error=function(D){var N=this._sources;if(!r.prototype.error.call(this,D))return!1;for(var j=0;j<N.length;j++)try{N[j].error(D)}catch{}return!0},P.prototype.lock=function(){r.prototype.lock.call(this);for(var D=this._sources,N=0;N<D.length;N++)D[N].lock()},s.exports=P},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(n,s,a){var u=n("../compressions"),f=n("./ZipFileWorker");a.generateWorker=function(_,r,C){var k=new f(r.streamFiles,C,r.platform,r.encodeFileName),I=0;try{_.forEach(function(P,D){I++;var N=function(q,Z){var re=q||Z,le=u[re];if(!le)throw new Error(re+" is not a valid compression method !");return le}(D.options.compression,r.compression),j=D.options.compressionOptions||r.compressionOptions||{},W=D.dir,H=D.date;D._compressWorker(N,j).withStreamInfo("file",{name:P,dir:W,date:H,comment:D.comment||"",unixPermissions:D.unixPermissions,dosPermissions:D.dosPermissions}).pipe(k)}),k.entriesCount=I}catch(P){k.error(P)}return k}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(n,s,a){function u(){if(!(this instanceof u))return new u;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var f=new u;for(var _ in this)typeof this[_]!="function"&&(f[_]=this[_]);return f}}(u.prototype=n("./object")).loadAsync=n("./load"),u.support=n("./support"),u.defaults=n("./defaults"),u.version="3.10.1",u.loadAsync=function(f,_){return new u().loadAsync(f,_)},u.external=n("./external"),s.exports=u},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(n,s,a){var u=n("./utils"),f=n("./external"),_=n("./utf8"),r=n("./zipEntries"),C=n("./stream/Crc32Probe"),k=n("./nodejsUtils");function I(P){return new f.Promise(function(D,N){var j=P.decompressed.getContentWorker().pipe(new C);j.on("error",function(W){N(W)}).on("end",function(){j.streamInfo.crc32!==P.decompressed.crc32?N(new Error("Corrupted zip : CRC32 mismatch")):D()}).resume()})}s.exports=function(P,D){var N=this;return D=u.extend(D||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:_.utf8decode}),k.isNode&&k.isStream(P)?f.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):u.prepareContent("the loaded zip file",P,!0,D.optimizedBinaryString,D.base64).then(function(j){var W=new r(D);return W.load(j),W}).then(function(j){var W=[f.Promise.resolve(j)],H=j.files;if(D.checkCRC32)for(var q=0;q<H.length;q++)W.push(I(H[q]));return f.Promise.all(W)}).then(function(j){for(var W=j.shift(),H=W.files,q=0;q<H.length;q++){var Z=H[q],re=Z.fileNameStr,le=u.resolve(Z.fileNameStr);N.file(le,Z.decompressed,{binary:!0,optimizedBinaryString:!0,date:Z.date,dir:Z.dir,comment:Z.fileCommentStr.length?Z.fileCommentStr:null,unixPermissions:Z.unixPermissions,dosPermissions:Z.dosPermissions,createFolders:D.createFolders}),Z.dir||(N.file(le).unsafeOriginalName=re)}return W.zipComment.length&&(N.comment=W.zipComment),N})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(n,s,a){var u=n("../utils"),f=n("../stream/GenericWorker");function _(r,C){f.call(this,"Nodejs stream input adapter for "+r),this._upstreamEnded=!1,this._bindStream(C)}u.inherits(_,f),_.prototype._bindStream=function(r){var C=this;(this._stream=r).pause(),r.on("data",function(k){C.push({data:k,meta:{percent:0}})}).on("error",function(k){C.isPaused?this.generatedError=k:C.error(k)}).on("end",function(){C.isPaused?C._upstreamEnded=!0:C.end()})},_.prototype.pause=function(){return!!f.prototype.pause.call(this)&&(this._stream.pause(),!0)},_.prototype.resume=function(){return!!f.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},s.exports=_},{"../stream/GenericWorker":28,"../utils":32}],13:[function(n,s,a){var u=n("readable-stream").Readable;function f(_,r,C){u.call(this,r),this._helper=_;var k=this;_.on("data",function(I,P){k.push(I)||k._helper.pause(),C&&C(P)}).on("error",function(I){k.emit("error",I)}).on("end",function(){k.push(null)})}n("../utils").inherits(f,u),f.prototype._read=function(){this._helper.resume()},s.exports=f},{"../utils":32,"readable-stream":16}],14:[function(n,s,a){s.exports={isNode:typeof Buffer<"u",newBufferFrom:function(u,f){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(u,f);if(typeof u=="number")throw new Error('The "data" argument must not be a number');return new Buffer(u,f)},allocBuffer:function(u){if(Buffer.alloc)return Buffer.alloc(u);var f=new Buffer(u);return f.fill(0),f},isBuffer:function(u){return Buffer.isBuffer(u)},isStream:function(u){return u&&typeof u.on=="function"&&typeof u.pause=="function"&&typeof u.resume=="function"}}},{}],15:[function(n,s,a){function u(le,_e,ye){var de,ce=_.getTypeOf(_e),oe=_.extend(ye||{},k);oe.date=oe.date||new Date,oe.compression!==null&&(oe.compression=oe.compression.toUpperCase()),typeof oe.unixPermissions=="string"&&(oe.unixPermissions=parseInt(oe.unixPermissions,8)),oe.unixPermissions&&16384&oe.unixPermissions&&(oe.dir=!0),oe.dosPermissions&&16&oe.dosPermissions&&(oe.dir=!0),oe.dir&&(le=H(le)),oe.createFolders&&(de=W(le))&&q.call(this,de,!0);var xe=ce==="string"&&oe.binary===!1&&oe.base64===!1;ye&&ye.binary!==void 0||(oe.binary=!xe),(_e instanceof I&&_e.uncompressedSize===0||oe.dir||!_e||_e.length===0)&&(oe.base64=!1,oe.binary=!0,_e="",oe.compression="STORE",ce="string");var he=null;he=_e instanceof I||_e instanceof r?_e:N.isNode&&N.isStream(_e)?new j(le,_e):_.prepareContent(le,_e,oe.binary,oe.optimizedBinaryString,oe.base64);var Ee=new P(le,he,oe);this.files[le]=Ee}var f=n("./utf8"),_=n("./utils"),r=n("./stream/GenericWorker"),C=n("./stream/StreamHelper"),k=n("./defaults"),I=n("./compressedObject"),P=n("./zipObject"),D=n("./generate"),N=n("./nodejsUtils"),j=n("./nodejs/NodejsStreamInputAdapter"),W=function(le){le.slice(-1)==="/"&&(le=le.substring(0,le.length-1));var _e=le.lastIndexOf("/");return 0<_e?le.substring(0,_e):""},H=function(le){return le.slice(-1)!=="/"&&(le+="/"),le},q=function(le,_e){return _e=_e!==void 0?_e:k.createFolders,le=H(le),this.files[le]||u.call(this,le,null,{dir:!0,createFolders:_e}),this.files[le]};function Z(le){return Object.prototype.toString.call(le)==="[object RegExp]"}var re={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(le){var _e,ye,de;for(_e in this.files)de=this.files[_e],(ye=_e.slice(this.root.length,_e.length))&&_e.slice(0,this.root.length)===this.root&&le(ye,de)},filter:function(le){var _e=[];return this.forEach(function(ye,de){le(ye,de)&&_e.push(de)}),_e},file:function(le,_e,ye){if(arguments.length!==1)return le=this.root+le,u.call(this,le,_e,ye),this;if(Z(le)){var de=le;return this.filter(function(oe,xe){return!xe.dir&&de.test(oe)})}var ce=this.files[this.root+le];return ce&&!ce.dir?ce:null},folder:function(le){if(!le)return this;if(Z(le))return this.filter(function(ce,oe){return oe.dir&&le.test(ce)});var _e=this.root+le,ye=q.call(this,_e),de=this.clone();return de.root=ye.name,de},remove:function(le){le=this.root+le;var _e=this.files[le];if(_e||(le.slice(-1)!=="/"&&(le+="/"),_e=this.files[le]),_e&&!_e.dir)delete this.files[le];else for(var ye=this.filter(function(ce,oe){return oe.name.slice(0,le.length)===le}),de=0;de<ye.length;de++)delete this.files[ye[de].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(le){var _e,ye={};try{if((ye=_.extend(le||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:f.utf8encode})).type=ye.type.toLowerCase(),ye.compression=ye.compression.toUpperCase(),ye.type==="binarystring"&&(ye.type="string"),!ye.type)throw new Error("No output type specified.");_.checkSupport(ye.type),ye.platform!=="darwin"&&ye.platform!=="freebsd"&&ye.platform!=="linux"&&ye.platform!=="sunos"||(ye.platform="UNIX"),ye.platform==="win32"&&(ye.platform="DOS");var de=ye.comment||this.comment||"";_e=D.generateWorker(this,ye,de)}catch(ce){(_e=new r("error")).error(ce)}return new C(_e,ye.type||"string",ye.mimeType)},generateAsync:function(le,_e){return this.generateInternalStream(le).accumulate(_e)},generateNodeStream:function(le,_e){return(le=le||{}).type||(le.type="nodebuffer"),this.generateInternalStream(le).toNodejsStream(_e)}};s.exports=re},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(n,s,a){s.exports=n("stream")},{stream:void 0}],17:[function(n,s,a){var u=n("./DataReader");function f(_){u.call(this,_);for(var r=0;r<this.data.length;r++)_[r]=255&_[r]}n("../utils").inherits(f,u),f.prototype.byteAt=function(_){return this.data[this.zero+_]},f.prototype.lastIndexOfSignature=function(_){for(var r=_.charCodeAt(0),C=_.charCodeAt(1),k=_.charCodeAt(2),I=_.charCodeAt(3),P=this.length-4;0<=P;--P)if(this.data[P]===r&&this.data[P+1]===C&&this.data[P+2]===k&&this.data[P+3]===I)return P-this.zero;return-1},f.prototype.readAndCheckSignature=function(_){var r=_.charCodeAt(0),C=_.charCodeAt(1),k=_.charCodeAt(2),I=_.charCodeAt(3),P=this.readData(4);return r===P[0]&&C===P[1]&&k===P[2]&&I===P[3]},f.prototype.readData=function(_){if(this.checkOffset(_),_===0)return[];var r=this.data.slice(this.zero+this.index,this.zero+this.index+_);return this.index+=_,r},s.exports=f},{"../utils":32,"./DataReader":18}],18:[function(n,s,a){var u=n("../utils");function f(_){this.data=_,this.length=_.length,this.index=0,this.zero=0}f.prototype={checkOffset:function(_){this.checkIndex(this.index+_)},checkIndex:function(_){if(this.length<this.zero+_||_<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+_+"). Corrupted zip ?")},setIndex:function(_){this.checkIndex(_),this.index=_},skip:function(_){this.setIndex(this.index+_)},byteAt:function(){},readInt:function(_){var r,C=0;for(this.checkOffset(_),r=this.index+_-1;r>=this.index;r--)C=(C<<8)+this.byteAt(r);return this.index+=_,C},readString:function(_){return u.transformTo("string",this.readData(_))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var _=this.readInt(4);return new Date(Date.UTC(1980+(_>>25&127),(_>>21&15)-1,_>>16&31,_>>11&31,_>>5&63,(31&_)<<1))}},s.exports=f},{"../utils":32}],19:[function(n,s,a){var u=n("./Uint8ArrayReader");function f(_){u.call(this,_)}n("../utils").inherits(f,u),f.prototype.readData=function(_){this.checkOffset(_);var r=this.data.slice(this.zero+this.index,this.zero+this.index+_);return this.index+=_,r},s.exports=f},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(n,s,a){var u=n("./DataReader");function f(_){u.call(this,_)}n("../utils").inherits(f,u),f.prototype.byteAt=function(_){return this.data.charCodeAt(this.zero+_)},f.prototype.lastIndexOfSignature=function(_){return this.data.lastIndexOf(_)-this.zero},f.prototype.readAndCheckSignature=function(_){return _===this.readData(4)},f.prototype.readData=function(_){this.checkOffset(_);var r=this.data.slice(this.zero+this.index,this.zero+this.index+_);return this.index+=_,r},s.exports=f},{"../utils":32,"./DataReader":18}],21:[function(n,s,a){var u=n("./ArrayReader");function f(_){u.call(this,_)}n("../utils").inherits(f,u),f.prototype.readData=function(_){if(this.checkOffset(_),_===0)return new Uint8Array(0);var r=this.data.subarray(this.zero+this.index,this.zero+this.index+_);return this.index+=_,r},s.exports=f},{"../utils":32,"./ArrayReader":17}],22:[function(n,s,a){var u=n("../utils"),f=n("../support"),_=n("./ArrayReader"),r=n("./StringReader"),C=n("./NodeBufferReader"),k=n("./Uint8ArrayReader");s.exports=function(I){var P=u.getTypeOf(I);return u.checkSupport(P),P!=="string"||f.uint8array?P==="nodebuffer"?new C(I):f.uint8array?new k(u.transformTo("uint8array",I)):new _(u.transformTo("array",I)):new r(I)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(n,s,a){a.LOCAL_FILE_HEADER="PK",a.CENTRAL_FILE_HEADER="PK",a.CENTRAL_DIRECTORY_END="PK",a.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",a.ZIP64_CENTRAL_DIRECTORY_END="PK",a.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(n,s,a){var u=n("./GenericWorker"),f=n("../utils");function _(r){u.call(this,"ConvertWorker to "+r),this.destType=r}f.inherits(_,u),_.prototype.processChunk=function(r){this.push({data:f.transformTo(this.destType,r.data),meta:r.meta})},s.exports=_},{"../utils":32,"./GenericWorker":28}],25:[function(n,s,a){var u=n("./GenericWorker"),f=n("../crc32");function _(){u.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}n("../utils").inherits(_,u),_.prototype.processChunk=function(r){this.streamInfo.crc32=f(r.data,this.streamInfo.crc32||0),this.push(r)},s.exports=_},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(n,s,a){var u=n("../utils"),f=n("./GenericWorker");function _(r){f.call(this,"DataLengthProbe for "+r),this.propName=r,this.withStreamInfo(r,0)}u.inherits(_,f),_.prototype.processChunk=function(r){if(r){var C=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=C+r.data.length}f.prototype.processChunk.call(this,r)},s.exports=_},{"../utils":32,"./GenericWorker":28}],27:[function(n,s,a){var u=n("../utils"),f=n("./GenericWorker");function _(r){f.call(this,"DataWorker");var C=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,r.then(function(k){C.dataIsReady=!0,C.data=k,C.max=k&&k.length||0,C.type=u.getTypeOf(k),C.isPaused||C._tickAndRepeat()},function(k){C.error(k)})}u.inherits(_,f),_.prototype.cleanUp=function(){f.prototype.cleanUp.call(this),this.data=null},_.prototype.resume=function(){return!!f.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,u.delay(this._tickAndRepeat,[],this)),!0)},_.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(u.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},_.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var r=null,C=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":r=this.data.substring(this.index,C);break;case"uint8array":r=this.data.subarray(this.index,C);break;case"array":case"nodebuffer":r=this.data.slice(this.index,C)}return this.index=C,this.push({data:r,meta:{percent:this.max?this.index/this.max*100:0}})},s.exports=_},{"../utils":32,"./GenericWorker":28}],28:[function(n,s,a){function u(f){this.name=f||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}u.prototype={push:function(f){this.emit("data",f)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(f){this.emit("error",f)}return!0},error:function(f){return!this.isFinished&&(this.isPaused?this.generatedError=f:(this.isFinished=!0,this.emit("error",f),this.previous&&this.previous.error(f),this.cleanUp()),!0)},on:function(f,_){return this._listeners[f].push(_),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(f,_){if(this._listeners[f])for(var r=0;r<this._listeners[f].length;r++)this._listeners[f][r].call(this,_)},pipe:function(f){return f.registerPrevious(this)},registerPrevious:function(f){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=f.streamInfo,this.mergeStreamInfo(),this.previous=f;var _=this;return f.on("data",function(r){_.processChunk(r)}),f.on("end",function(){_.end()}),f.on("error",function(r){_.error(r)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var f=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),f=!0),this.previous&&this.previous.resume(),!f},flush:function(){},processChunk:function(f){this.push(f)},withStreamInfo:function(f,_){return this.extraStreamInfo[f]=_,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var f in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,f)&&(this.streamInfo[f]=this.extraStreamInfo[f])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var f="Worker "+this.name;return this.previous?this.previous+" -> "+f:f}},s.exports=u},{}],29:[function(n,s,a){var u=n("../utils"),f=n("./ConvertWorker"),_=n("./GenericWorker"),r=n("../base64"),C=n("../support"),k=n("../external"),I=null;if(C.nodestream)try{I=n("../nodejs/NodejsStreamOutputAdapter")}catch{}function P(N,j){return new k.Promise(function(W,H){var q=[],Z=N._internalType,re=N._outputType,le=N._mimeType;N.on("data",function(_e,ye){q.push(_e),j&&j(ye)}).on("error",function(_e){q=[],H(_e)}).on("end",function(){try{var _e=function(ye,de,ce){switch(ye){case"blob":return u.newBlob(u.transformTo("arraybuffer",de),ce);case"base64":return r.encode(de);default:return u.transformTo(ye,de)}}(re,function(ye,de){var ce,oe=0,xe=null,he=0;for(ce=0;ce<de.length;ce++)he+=de[ce].length;switch(ye){case"string":return de.join("");case"array":return Array.prototype.concat.apply([],de);case"uint8array":for(xe=new Uint8Array(he),ce=0;ce<de.length;ce++)xe.set(de[ce],oe),oe+=de[ce].length;return xe;case"nodebuffer":return Buffer.concat(de);default:throw new Error("concat : unsupported type '"+ye+"'")}}(Z,q),le);W(_e)}catch(ye){H(ye)}q=[]}).resume()})}function D(N,j,W){var H=j;switch(j){case"blob":case"arraybuffer":H="uint8array";break;case"base64":H="string"}try{this._internalType=H,this._outputType=j,this._mimeType=W,u.checkSupport(H),this._worker=N.pipe(new f(H)),N.lock()}catch(q){this._worker=new _("error"),this._worker.error(q)}}D.prototype={accumulate:function(N){return P(this,N)},on:function(N,j){var W=this;return N==="data"?this._worker.on(N,function(H){j.call(W,H.data,H.meta)}):this._worker.on(N,function(){u.delay(j,arguments,W)}),this},resume:function(){return u.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(N){if(u.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new I(this,{objectMode:this._outputType!=="nodebuffer"},N)}},s.exports=D},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(n,s,a){if(a.base64=!0,a.array=!0,a.string=!0,a.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",a.nodebuffer=typeof Buffer<"u",a.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")a.blob=!1;else{var u=new ArrayBuffer(0);try{a.blob=new Blob([u],{type:"application/zip"}).size===0}catch{try{var f=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);f.append(u),a.blob=f.getBlob("application/zip").size===0}catch{a.blob=!1}}}try{a.nodestream=!!n("readable-stream").Readable}catch{a.nodestream=!1}},{"readable-stream":16}],31:[function(n,s,a){for(var u=n("./utils"),f=n("./support"),_=n("./nodejsUtils"),r=n("./stream/GenericWorker"),C=new Array(256),k=0;k<256;k++)C[k]=252<=k?6:248<=k?5:240<=k?4:224<=k?3:192<=k?2:1;C[254]=C[254]=1;function I(){r.call(this,"utf-8 decode"),this.leftOver=null}function P(){r.call(this,"utf-8 encode")}a.utf8encode=function(D){return f.nodebuffer?_.newBufferFrom(D,"utf-8"):function(N){var j,W,H,q,Z,re=N.length,le=0;for(q=0;q<re;q++)(64512&(W=N.charCodeAt(q)))==55296&&q+1<re&&(64512&(H=N.charCodeAt(q+1)))==56320&&(W=65536+(W-55296<<10)+(H-56320),q++),le+=W<128?1:W<2048?2:W<65536?3:4;for(j=f.uint8array?new Uint8Array(le):new Array(le),q=Z=0;Z<le;q++)(64512&(W=N.charCodeAt(q)))==55296&&q+1<re&&(64512&(H=N.charCodeAt(q+1)))==56320&&(W=65536+(W-55296<<10)+(H-56320),q++),W<128?j[Z++]=W:(W<2048?j[Z++]=192|W>>>6:(W<65536?j[Z++]=224|W>>>12:(j[Z++]=240|W>>>18,j[Z++]=128|W>>>12&63),j[Z++]=128|W>>>6&63),j[Z++]=128|63&W);return j}(D)},a.utf8decode=function(D){return f.nodebuffer?u.transformTo("nodebuffer",D).toString("utf-8"):function(N){var j,W,H,q,Z=N.length,re=new Array(2*Z);for(j=W=0;j<Z;)if((H=N[j++])<128)re[W++]=H;else if(4<(q=C[H]))re[W++]=65533,j+=q-1;else{for(H&=q===2?31:q===3?15:7;1<q&&j<Z;)H=H<<6|63&N[j++],q--;1<q?re[W++]=65533:H<65536?re[W++]=H:(H-=65536,re[W++]=55296|H>>10&1023,re[W++]=56320|1023&H)}return re.length!==W&&(re.subarray?re=re.subarray(0,W):re.length=W),u.applyFromCharCode(re)}(D=u.transformTo(f.uint8array?"uint8array":"array",D))},u.inherits(I,r),I.prototype.processChunk=function(D){var N=u.transformTo(f.uint8array?"uint8array":"array",D.data);if(this.leftOver&&this.leftOver.length){if(f.uint8array){var j=N;(N=new Uint8Array(j.length+this.leftOver.length)).set(this.leftOver,0),N.set(j,this.leftOver.length)}else N=this.leftOver.concat(N);this.leftOver=null}var W=function(q,Z){var re;for((Z=Z||q.length)>q.length&&(Z=q.length),re=Z-1;0<=re&&(192&q[re])==128;)re--;return re<0||re===0?Z:re+C[q[re]]>Z?re:Z}(N),H=N;W!==N.length&&(f.uint8array?(H=N.subarray(0,W),this.leftOver=N.subarray(W,N.length)):(H=N.slice(0,W),this.leftOver=N.slice(W,N.length))),this.push({data:a.utf8decode(H),meta:D.meta})},I.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:a.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},a.Utf8DecodeWorker=I,u.inherits(P,r),P.prototype.processChunk=function(D){this.push({data:a.utf8encode(D.data),meta:D.meta})},a.Utf8EncodeWorker=P},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(n,s,a){var u=n("./support"),f=n("./base64"),_=n("./nodejsUtils"),r=n("./external");function C(j){return j}function k(j,W){for(var H=0;H<j.length;++H)W[H]=255&j.charCodeAt(H);return W}n("setimmediate"),a.newBlob=function(j,W){a.checkSupport("blob");try{return new Blob([j],{type:W})}catch{try{var H=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return H.append(j),H.getBlob(W)}catch{throw new Error("Bug : can't construct the Blob.")}}};var I={stringifyByChunk:function(j,W,H){var q=[],Z=0,re=j.length;if(re<=H)return String.fromCharCode.apply(null,j);for(;Z<re;)W==="array"||W==="nodebuffer"?q.push(String.fromCharCode.apply(null,j.slice(Z,Math.min(Z+H,re)))):q.push(String.fromCharCode.apply(null,j.subarray(Z,Math.min(Z+H,re)))),Z+=H;return q.join("")},stringifyByChar:function(j){for(var W="",H=0;H<j.length;H++)W+=String.fromCharCode(j[H]);return W},applyCanBeUsed:{uint8array:function(){try{return u.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return u.nodebuffer&&String.fromCharCode.apply(null,_.allocBuffer(1)).length===1}catch{return!1}}()}};function P(j){var W=65536,H=a.getTypeOf(j),q=!0;if(H==="uint8array"?q=I.applyCanBeUsed.uint8array:H==="nodebuffer"&&(q=I.applyCanBeUsed.nodebuffer),q)for(;1<W;)try{return I.stringifyByChunk(j,H,W)}catch{W=Math.floor(W/2)}return I.stringifyByChar(j)}function D(j,W){for(var H=0;H<j.length;H++)W[H]=j[H];return W}a.applyFromCharCode=P;var N={};N.string={string:C,array:function(j){return k(j,new Array(j.length))},arraybuffer:function(j){return N.string.uint8array(j).buffer},uint8array:function(j){return k(j,new Uint8Array(j.length))},nodebuffer:function(j){return k(j,_.allocBuffer(j.length))}},N.array={string:P,array:C,arraybuffer:function(j){return new Uint8Array(j).buffer},uint8array:function(j){return new Uint8Array(j)},nodebuffer:function(j){return _.newBufferFrom(j)}},N.arraybuffer={string:function(j){return P(new Uint8Array(j))},array:function(j){return D(new Uint8Array(j),new Array(j.byteLength))},arraybuffer:C,uint8array:function(j){return new Uint8Array(j)},nodebuffer:function(j){return _.newBufferFrom(new Uint8Array(j))}},N.uint8array={string:P,array:function(j){return D(j,new Array(j.length))},arraybuffer:function(j){return j.buffer},uint8array:C,nodebuffer:function(j){return _.newBufferFrom(j)}},N.nodebuffer={string:P,array:function(j){return D(j,new Array(j.length))},arraybuffer:function(j){return N.nodebuffer.uint8array(j).buffer},uint8array:function(j){return D(j,new Uint8Array(j.length))},nodebuffer:C},a.transformTo=function(j,W){if(W=W||"",!j)return W;a.checkSupport(j);var H=a.getTypeOf(W);return N[H][j](W)},a.resolve=function(j){for(var W=j.split("/"),H=[],q=0;q<W.length;q++){var Z=W[q];Z==="."||Z===""&&q!==0&&q!==W.length-1||(Z===".."?H.pop():H.push(Z))}return H.join("/")},a.getTypeOf=function(j){return typeof j=="string"?"string":Object.prototype.toString.call(j)==="[object Array]"?"array":u.nodebuffer&&_.isBuffer(j)?"nodebuffer":u.uint8array&&j instanceof Uint8Array?"uint8array":u.arraybuffer&&j instanceof ArrayBuffer?"arraybuffer":void 0},a.checkSupport=function(j){if(!u[j.toLowerCase()])throw new Error(j+" is not supported by this platform")},a.MAX_VALUE_16BITS=65535,a.MAX_VALUE_32BITS=-1,a.pretty=function(j){var W,H,q="";for(H=0;H<(j||"").length;H++)q+="\\x"+((W=j.charCodeAt(H))<16?"0":"")+W.toString(16).toUpperCase();return q},a.delay=function(j,W,H){setImmediate(function(){j.apply(H||null,W||[])})},a.inherits=function(j,W){function H(){}H.prototype=W.prototype,j.prototype=new H},a.extend=function(){var j,W,H={};for(j=0;j<arguments.length;j++)for(W in arguments[j])Object.prototype.hasOwnProperty.call(arguments[j],W)&&H[W]===void 0&&(H[W]=arguments[j][W]);return H},a.prepareContent=function(j,W,H,q,Z){return r.Promise.resolve(W).then(function(re){return u.blob&&(re instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(re))!==-1)&&typeof FileReader<"u"?new r.Promise(function(le,_e){var ye=new FileReader;ye.onload=function(de){le(de.target.result)},ye.onerror=function(de){_e(de.target.error)},ye.readAsArrayBuffer(re)}):re}).then(function(re){var le=a.getTypeOf(re);return le?(le==="arraybuffer"?re=a.transformTo("uint8array",re):le==="string"&&(Z?re=f.decode(re):H&&q!==!0&&(re=function(_e){return k(_e,u.uint8array?new Uint8Array(_e.length):new Array(_e.length))}(re))),re):r.Promise.reject(new Error("Can't read the data of '"+j+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(n,s,a){var u=n("./reader/readerFor"),f=n("./utils"),_=n("./signature"),r=n("./zipEntry"),C=n("./support");function k(I){this.files=[],this.loadOptions=I}k.prototype={checkSignature:function(I){if(!this.reader.readAndCheckSignature(I)){this.reader.index-=4;var P=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+f.pretty(P)+", expected "+f.pretty(I)+")")}},isSignature:function(I,P){var D=this.reader.index;this.reader.setIndex(I);var N=this.reader.readString(4)===P;return this.reader.setIndex(D),N},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var I=this.reader.readData(this.zipCommentLength),P=C.uint8array?"uint8array":"array",D=f.transformTo(P,I);this.zipComment=this.loadOptions.decodeFileName(D)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var I,P,D,N=this.zip64EndOfCentralSize-44;0<N;)I=this.reader.readInt(2),P=this.reader.readInt(4),D=this.reader.readData(P),this.zip64ExtensibleData[I]={id:I,length:P,value:D}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var I,P;for(I=0;I<this.files.length;I++)P=this.files[I],this.reader.setIndex(P.localHeaderOffset),this.checkSignature(_.LOCAL_FILE_HEADER),P.readLocalPart(this.reader),P.handleUTF8(),P.processAttributes()},readCentralDir:function(){var I;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(_.CENTRAL_FILE_HEADER);)(I=new r({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(I);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var I=this.reader.lastIndexOfSignature(_.CENTRAL_DIRECTORY_END);if(I<0)throw this.isSignature(0,_.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(I);var P=I;if(this.checkSignature(_.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===f.MAX_VALUE_16BITS||this.diskWithCentralDirStart===f.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===f.MAX_VALUE_16BITS||this.centralDirRecords===f.MAX_VALUE_16BITS||this.centralDirSize===f.MAX_VALUE_32BITS||this.centralDirOffset===f.MAX_VALUE_32BITS){if(this.zip64=!0,(I=this.reader.lastIndexOfSignature(_.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(I),this.checkSignature(_.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,_.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(_.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(_.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var D=this.centralDirOffset+this.centralDirSize;this.zip64&&(D+=20,D+=12+this.zip64EndOfCentralSize);var N=P-D;if(0<N)this.isSignature(P,_.CENTRAL_FILE_HEADER)||(this.reader.zero=N);else if(N<0)throw new Error("Corrupted zip: missing "+Math.abs(N)+" bytes.")},prepareReader:function(I){this.reader=u(I)},load:function(I){this.prepareReader(I),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},s.exports=k},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(n,s,a){var u=n("./reader/readerFor"),f=n("./utils"),_=n("./compressedObject"),r=n("./crc32"),C=n("./utf8"),k=n("./compressions"),I=n("./support");function P(D,N){this.options=D,this.loadOptions=N}P.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(D){var N,j;if(D.skip(22),this.fileNameLength=D.readInt(2),j=D.readInt(2),this.fileName=D.readData(this.fileNameLength),D.skip(j),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((N=function(W){for(var H in k)if(Object.prototype.hasOwnProperty.call(k,H)&&k[H].magic===W)return k[H];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+f.pretty(this.compressionMethod)+" unknown (inner file : "+f.transformTo("string",this.fileName)+")");this.decompressed=new _(this.compressedSize,this.uncompressedSize,this.crc32,N,D.readData(this.compressedSize))},readCentralPart:function(D){this.versionMadeBy=D.readInt(2),D.skip(2),this.bitFlag=D.readInt(2),this.compressionMethod=D.readString(2),this.date=D.readDate(),this.crc32=D.readInt(4),this.compressedSize=D.readInt(4),this.uncompressedSize=D.readInt(4);var N=D.readInt(2);if(this.extraFieldsLength=D.readInt(2),this.fileCommentLength=D.readInt(2),this.diskNumberStart=D.readInt(2),this.internalFileAttributes=D.readInt(2),this.externalFileAttributes=D.readInt(4),this.localHeaderOffset=D.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");D.skip(N),this.readExtraFields(D),this.parseZIP64ExtraField(D),this.fileComment=D.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var D=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),D==0&&(this.dosPermissions=63&this.externalFileAttributes),D==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var D=u(this.extraFields[1].value);this.uncompressedSize===f.MAX_VALUE_32BITS&&(this.uncompressedSize=D.readInt(8)),this.compressedSize===f.MAX_VALUE_32BITS&&(this.compressedSize=D.readInt(8)),this.localHeaderOffset===f.MAX_VALUE_32BITS&&(this.localHeaderOffset=D.readInt(8)),this.diskNumberStart===f.MAX_VALUE_32BITS&&(this.diskNumberStart=D.readInt(4))}},readExtraFields:function(D){var N,j,W,H=D.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});D.index+4<H;)N=D.readInt(2),j=D.readInt(2),W=D.readData(j),this.extraFields[N]={id:N,length:j,value:W};D.setIndex(H)},handleUTF8:function(){var D=I.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=C.utf8decode(this.fileName),this.fileCommentStr=C.utf8decode(this.fileComment);else{var N=this.findExtraFieldUnicodePath();if(N!==null)this.fileNameStr=N;else{var j=f.transformTo(D,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(j)}var W=this.findExtraFieldUnicodeComment();if(W!==null)this.fileCommentStr=W;else{var H=f.transformTo(D,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(H)}}},findExtraFieldUnicodePath:function(){var D=this.extraFields[28789];if(D){var N=u(D.value);return N.readInt(1)!==1||r(this.fileName)!==N.readInt(4)?null:C.utf8decode(N.readData(D.length-5))}return null},findExtraFieldUnicodeComment:function(){var D=this.extraFields[25461];if(D){var N=u(D.value);return N.readInt(1)!==1||r(this.fileComment)!==N.readInt(4)?null:C.utf8decode(N.readData(D.length-5))}return null}},s.exports=P},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(n,s,a){function u(N,j,W){this.name=N,this.dir=W.dir,this.date=W.date,this.comment=W.comment,this.unixPermissions=W.unixPermissions,this.dosPermissions=W.dosPermissions,this._data=j,this._dataBinary=W.binary,this.options={compression:W.compression,compressionOptions:W.compressionOptions}}var f=n("./stream/StreamHelper"),_=n("./stream/DataWorker"),r=n("./utf8"),C=n("./compressedObject"),k=n("./stream/GenericWorker");u.prototype={internalStream:function(N){var j=null,W="string";try{if(!N)throw new Error("No output type specified.");var H=(W=N.toLowerCase())==="string"||W==="text";W!=="binarystring"&&W!=="text"||(W="string"),j=this._decompressWorker();var q=!this._dataBinary;q&&!H&&(j=j.pipe(new r.Utf8EncodeWorker)),!q&&H&&(j=j.pipe(new r.Utf8DecodeWorker))}catch(Z){(j=new k("error")).error(Z)}return new f(j,W,"")},async:function(N,j){return this.internalStream(N).accumulate(j)},nodeStream:function(N,j){return this.internalStream(N||"nodebuffer").toNodejsStream(j)},_compressWorker:function(N,j){if(this._data instanceof C&&this._data.compression.magic===N.magic)return this._data.getCompressedWorker();var W=this._decompressWorker();return this._dataBinary||(W=W.pipe(new r.Utf8EncodeWorker)),C.createWorkerFrom(W,N,j)},_decompressWorker:function(){return this._data instanceof C?this._data.getContentWorker():this._data instanceof k?this._data:new _(this._data)}};for(var I=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],P=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},D=0;D<I.length;D++)u.prototype[I[D]]=P;s.exports=u},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(n,s,a){(function(u){var f,_,r=u.MutationObserver||u.WebKitMutationObserver;if(r){var C=0,k=new r(N),I=u.document.createTextNode("");k.observe(I,{characterData:!0}),f=function(){I.data=C=++C%2}}else if(u.setImmediate||u.MessageChannel===void 0)f="document"in u&&"onreadystatechange"in u.document.createElement("script")?function(){var j=u.document.createElement("script");j.onreadystatechange=function(){N(),j.onreadystatechange=null,j.parentNode.removeChild(j),j=null},u.document.documentElement.appendChild(j)}:function(){setTimeout(N,0)};else{var P=new u.MessageChannel;P.port1.onmessage=N,f=function(){P.port2.postMessage(0)}}var D=[];function N(){var j,W;_=!0;for(var H=D.length;H;){for(W=D,D=[],j=-1;++j<H;)W[j]();H=D.length}_=!1}s.exports=function(j){D.push(j)!==1||_||f()}}).call(this,typeof fl<"u"?fl:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(n,s,a){var u=n("immediate");function f(){}var _={},r=["REJECTED"],C=["FULFILLED"],k=["PENDING"];function I(H){if(typeof H!="function")throw new TypeError("resolver must be a function");this.state=k,this.queue=[],this.outcome=void 0,H!==f&&j(this,H)}function P(H,q,Z){this.promise=H,typeof q=="function"&&(this.onFulfilled=q,this.callFulfilled=this.otherCallFulfilled),typeof Z=="function"&&(this.onRejected=Z,this.callRejected=this.otherCallRejected)}function D(H,q,Z){u(function(){var re;try{re=q(Z)}catch(le){return _.reject(H,le)}re===H?_.reject(H,new TypeError("Cannot resolve promise with itself")):_.resolve(H,re)})}function N(H){var q=H&&H.then;if(H&&(typeof H=="object"||typeof H=="function")&&typeof q=="function")return function(){q.apply(H,arguments)}}function j(H,q){var Z=!1;function re(ye){Z||(Z=!0,_.reject(H,ye))}function le(ye){Z||(Z=!0,_.resolve(H,ye))}var _e=W(function(){q(le,re)});_e.status==="error"&&re(_e.value)}function W(H,q){var Z={};try{Z.value=H(q),Z.status="success"}catch(re){Z.status="error",Z.value=re}return Z}(s.exports=I).prototype.finally=function(H){if(typeof H!="function")return this;var q=this.constructor;return this.then(function(Z){return q.resolve(H()).then(function(){return Z})},function(Z){return q.resolve(H()).then(function(){throw Z})})},I.prototype.catch=function(H){return this.then(null,H)},I.prototype.then=function(H,q){if(typeof H!="function"&&this.state===C||typeof q!="function"&&this.state===r)return this;var Z=new this.constructor(f);return this.state!==k?D(Z,this.state===C?H:q,this.outcome):this.queue.push(new P(Z,H,q)),Z},P.prototype.callFulfilled=function(H){_.resolve(this.promise,H)},P.prototype.otherCallFulfilled=function(H){D(this.promise,this.onFulfilled,H)},P.prototype.callRejected=function(H){_.reject(this.promise,H)},P.prototype.otherCallRejected=function(H){D(this.promise,this.onRejected,H)},_.resolve=function(H,q){var Z=W(N,q);if(Z.status==="error")return _.reject(H,Z.value);var re=Z.value;if(re)j(H,re);else{H.state=C,H.outcome=q;for(var le=-1,_e=H.queue.length;++le<_e;)H.queue[le].callFulfilled(q)}return H},_.reject=function(H,q){H.state=r,H.outcome=q;for(var Z=-1,re=H.queue.length;++Z<re;)H.queue[Z].callRejected(q);return H},I.resolve=function(H){return H instanceof this?H:_.resolve(new this(f),H)},I.reject=function(H){var q=new this(f);return _.reject(q,H)},I.all=function(H){var q=this;if(Object.prototype.toString.call(H)!=="[object Array]")return this.reject(new TypeError("must be an array"));var Z=H.length,re=!1;if(!Z)return this.resolve([]);for(var le=new Array(Z),_e=0,ye=-1,de=new this(f);++ye<Z;)ce(H[ye],ye);return de;function ce(oe,xe){q.resolve(oe).then(function(he){le[xe]=he,++_e!==Z||re||(re=!0,_.resolve(de,le))},function(he){re||(re=!0,_.reject(de,he))})}},I.race=function(H){var q=this;if(Object.prototype.toString.call(H)!=="[object Array]")return this.reject(new TypeError("must be an array"));var Z=H.length,re=!1;if(!Z)return this.resolve([]);for(var le=-1,_e=new this(f);++le<Z;)ye=H[le],q.resolve(ye).then(function(de){re||(re=!0,_.resolve(_e,de))},function(de){re||(re=!0,_.reject(_e,de))});var ye;return _e}},{immediate:36}],38:[function(n,s,a){var u={};(0,n("./lib/utils/common").assign)(u,n("./lib/deflate"),n("./lib/inflate"),n("./lib/zlib/constants")),s.exports=u},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(n,s,a){var u=n("./zlib/deflate"),f=n("./utils/common"),_=n("./utils/strings"),r=n("./zlib/messages"),C=n("./zlib/zstream"),k=Object.prototype.toString,I=0,P=-1,D=0,N=8;function j(H){if(!(this instanceof j))return new j(H);this.options=f.assign({level:P,method:N,chunkSize:16384,windowBits:15,memLevel:8,strategy:D,to:""},H||{});var q=this.options;q.raw&&0<q.windowBits?q.windowBits=-q.windowBits:q.gzip&&0<q.windowBits&&q.windowBits<16&&(q.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new C,this.strm.avail_out=0;var Z=u.deflateInit2(this.strm,q.level,q.method,q.windowBits,q.memLevel,q.strategy);if(Z!==I)throw new Error(r[Z]);if(q.header&&u.deflateSetHeader(this.strm,q.header),q.dictionary){var re;if(re=typeof q.dictionary=="string"?_.string2buf(q.dictionary):k.call(q.dictionary)==="[object ArrayBuffer]"?new Uint8Array(q.dictionary):q.dictionary,(Z=u.deflateSetDictionary(this.strm,re))!==I)throw new Error(r[Z]);this._dict_set=!0}}function W(H,q){var Z=new j(q);if(Z.push(H,!0),Z.err)throw Z.msg||r[Z.err];return Z.result}j.prototype.push=function(H,q){var Z,re,le=this.strm,_e=this.options.chunkSize;if(this.ended)return!1;re=q===~~q?q:q===!0?4:0,typeof H=="string"?le.input=_.string2buf(H):k.call(H)==="[object ArrayBuffer]"?le.input=new Uint8Array(H):le.input=H,le.next_in=0,le.avail_in=le.input.length;do{if(le.avail_out===0&&(le.output=new f.Buf8(_e),le.next_out=0,le.avail_out=_e),(Z=u.deflate(le,re))!==1&&Z!==I)return this.onEnd(Z),!(this.ended=!0);le.avail_out!==0&&(le.avail_in!==0||re!==4&&re!==2)||(this.options.to==="string"?this.onData(_.buf2binstring(f.shrinkBuf(le.output,le.next_out))):this.onData(f.shrinkBuf(le.output,le.next_out)))}while((0<le.avail_in||le.avail_out===0)&&Z!==1);return re===4?(Z=u.deflateEnd(this.strm),this.onEnd(Z),this.ended=!0,Z===I):re!==2||(this.onEnd(I),!(le.avail_out=0))},j.prototype.onData=function(H){this.chunks.push(H)},j.prototype.onEnd=function(H){H===I&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=f.flattenChunks(this.chunks)),this.chunks=[],this.err=H,this.msg=this.strm.msg},a.Deflate=j,a.deflate=W,a.deflateRaw=function(H,q){return(q=q||{}).raw=!0,W(H,q)},a.gzip=function(H,q){return(q=q||{}).gzip=!0,W(H,q)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(n,s,a){var u=n("./zlib/inflate"),f=n("./utils/common"),_=n("./utils/strings"),r=n("./zlib/constants"),C=n("./zlib/messages"),k=n("./zlib/zstream"),I=n("./zlib/gzheader"),P=Object.prototype.toString;function D(j){if(!(this instanceof D))return new D(j);this.options=f.assign({chunkSize:16384,windowBits:0,to:""},j||{});var W=this.options;W.raw&&0<=W.windowBits&&W.windowBits<16&&(W.windowBits=-W.windowBits,W.windowBits===0&&(W.windowBits=-15)),!(0<=W.windowBits&&W.windowBits<16)||j&&j.windowBits||(W.windowBits+=32),15<W.windowBits&&W.windowBits<48&&!(15&W.windowBits)&&(W.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new k,this.strm.avail_out=0;var H=u.inflateInit2(this.strm,W.windowBits);if(H!==r.Z_OK)throw new Error(C[H]);this.header=new I,u.inflateGetHeader(this.strm,this.header)}function N(j,W){var H=new D(W);if(H.push(j,!0),H.err)throw H.msg||C[H.err];return H.result}D.prototype.push=function(j,W){var H,q,Z,re,le,_e,ye=this.strm,de=this.options.chunkSize,ce=this.options.dictionary,oe=!1;if(this.ended)return!1;q=W===~~W?W:W===!0?r.Z_FINISH:r.Z_NO_FLUSH,typeof j=="string"?ye.input=_.binstring2buf(j):P.call(j)==="[object ArrayBuffer]"?ye.input=new Uint8Array(j):ye.input=j,ye.next_in=0,ye.avail_in=ye.input.length;do{if(ye.avail_out===0&&(ye.output=new f.Buf8(de),ye.next_out=0,ye.avail_out=de),(H=u.inflate(ye,r.Z_NO_FLUSH))===r.Z_NEED_DICT&&ce&&(_e=typeof ce=="string"?_.string2buf(ce):P.call(ce)==="[object ArrayBuffer]"?new Uint8Array(ce):ce,H=u.inflateSetDictionary(this.strm,_e)),H===r.Z_BUF_ERROR&&oe===!0&&(H=r.Z_OK,oe=!1),H!==r.Z_STREAM_END&&H!==r.Z_OK)return this.onEnd(H),!(this.ended=!0);ye.next_out&&(ye.avail_out!==0&&H!==r.Z_STREAM_END&&(ye.avail_in!==0||q!==r.Z_FINISH&&q!==r.Z_SYNC_FLUSH)||(this.options.to==="string"?(Z=_.utf8border(ye.output,ye.next_out),re=ye.next_out-Z,le=_.buf2string(ye.output,Z),ye.next_out=re,ye.avail_out=de-re,re&&f.arraySet(ye.output,ye.output,Z,re,0),this.onData(le)):this.onData(f.shrinkBuf(ye.output,ye.next_out)))),ye.avail_in===0&&ye.avail_out===0&&(oe=!0)}while((0<ye.avail_in||ye.avail_out===0)&&H!==r.Z_STREAM_END);return H===r.Z_STREAM_END&&(q=r.Z_FINISH),q===r.Z_FINISH?(H=u.inflateEnd(this.strm),this.onEnd(H),this.ended=!0,H===r.Z_OK):q!==r.Z_SYNC_FLUSH||(this.onEnd(r.Z_OK),!(ye.avail_out=0))},D.prototype.onData=function(j){this.chunks.push(j)},D.prototype.onEnd=function(j){j===r.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=f.flattenChunks(this.chunks)),this.chunks=[],this.err=j,this.msg=this.strm.msg},a.Inflate=D,a.inflate=N,a.inflateRaw=function(j,W){return(W=W||{}).raw=!0,N(j,W)},a.ungzip=N},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(n,s,a){var u=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";a.assign=function(r){for(var C=Array.prototype.slice.call(arguments,1);C.length;){var k=C.shift();if(k){if(typeof k!="object")throw new TypeError(k+"must be non-object");for(var I in k)k.hasOwnProperty(I)&&(r[I]=k[I])}}return r},a.shrinkBuf=function(r,C){return r.length===C?r:r.subarray?r.subarray(0,C):(r.length=C,r)};var f={arraySet:function(r,C,k,I,P){if(C.subarray&&r.subarray)r.set(C.subarray(k,k+I),P);else for(var D=0;D<I;D++)r[P+D]=C[k+D]},flattenChunks:function(r){var C,k,I,P,D,N;for(C=I=0,k=r.length;C<k;C++)I+=r[C].length;for(N=new Uint8Array(I),C=P=0,k=r.length;C<k;C++)D=r[C],N.set(D,P),P+=D.length;return N}},_={arraySet:function(r,C,k,I,P){for(var D=0;D<I;D++)r[P+D]=C[k+D]},flattenChunks:function(r){return[].concat.apply([],r)}};a.setTyped=function(r){r?(a.Buf8=Uint8Array,a.Buf16=Uint16Array,a.Buf32=Int32Array,a.assign(a,f)):(a.Buf8=Array,a.Buf16=Array,a.Buf32=Array,a.assign(a,_))},a.setTyped(u)},{}],42:[function(n,s,a){var u=n("./common"),f=!0,_=!0;try{String.fromCharCode.apply(null,[0])}catch{f=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{_=!1}for(var r=new u.Buf8(256),C=0;C<256;C++)r[C]=252<=C?6:248<=C?5:240<=C?4:224<=C?3:192<=C?2:1;function k(I,P){if(P<65537&&(I.subarray&&_||!I.subarray&&f))return String.fromCharCode.apply(null,u.shrinkBuf(I,P));for(var D="",N=0;N<P;N++)D+=String.fromCharCode(I[N]);return D}r[254]=r[254]=1,a.string2buf=function(I){var P,D,N,j,W,H=I.length,q=0;for(j=0;j<H;j++)(64512&(D=I.charCodeAt(j)))==55296&&j+1<H&&(64512&(N=I.charCodeAt(j+1)))==56320&&(D=65536+(D-55296<<10)+(N-56320),j++),q+=D<128?1:D<2048?2:D<65536?3:4;for(P=new u.Buf8(q),j=W=0;W<q;j++)(64512&(D=I.charCodeAt(j)))==55296&&j+1<H&&(64512&(N=I.charCodeAt(j+1)))==56320&&(D=65536+(D-55296<<10)+(N-56320),j++),D<128?P[W++]=D:(D<2048?P[W++]=192|D>>>6:(D<65536?P[W++]=224|D>>>12:(P[W++]=240|D>>>18,P[W++]=128|D>>>12&63),P[W++]=128|D>>>6&63),P[W++]=128|63&D);return P},a.buf2binstring=function(I){return k(I,I.length)},a.binstring2buf=function(I){for(var P=new u.Buf8(I.length),D=0,N=P.length;D<N;D++)P[D]=I.charCodeAt(D);return P},a.buf2string=function(I,P){var D,N,j,W,H=P||I.length,q=new Array(2*H);for(D=N=0;D<H;)if((j=I[D++])<128)q[N++]=j;else if(4<(W=r[j]))q[N++]=65533,D+=W-1;else{for(j&=W===2?31:W===3?15:7;1<W&&D<H;)j=j<<6|63&I[D++],W--;1<W?q[N++]=65533:j<65536?q[N++]=j:(j-=65536,q[N++]=55296|j>>10&1023,q[N++]=56320|1023&j)}return k(q,N)},a.utf8border=function(I,P){var D;for((P=P||I.length)>I.length&&(P=I.length),D=P-1;0<=D&&(192&I[D])==128;)D--;return D<0||D===0?P:D+r[I[D]]>P?D:P}},{"./common":41}],43:[function(n,s,a){s.exports=function(u,f,_,r){for(var C=65535&u|0,k=u>>>16&65535|0,I=0;_!==0;){for(_-=I=2e3<_?2e3:_;k=k+(C=C+f[r++]|0)|0,--I;);C%=65521,k%=65521}return C|k<<16|0}},{}],44:[function(n,s,a){s.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(n,s,a){var u=function(){for(var f,_=[],r=0;r<256;r++){f=r;for(var C=0;C<8;C++)f=1&f?3988292384^f>>>1:f>>>1;_[r]=f}return _}();s.exports=function(f,_,r,C){var k=u,I=C+r;f^=-1;for(var P=C;P<I;P++)f=f>>>8^k[255&(f^_[P])];return-1^f}},{}],46:[function(n,s,a){var u,f=n("../utils/common"),_=n("./trees"),r=n("./adler32"),C=n("./crc32"),k=n("./messages"),I=0,P=4,D=0,N=-2,j=-1,W=4,H=2,q=8,Z=9,re=286,le=30,_e=19,ye=2*re+1,de=15,ce=3,oe=258,xe=oe+ce+1,he=42,Ee=113,se=1,we=2,Se=3,Pe=4;function Me(Ae,st){return Ae.msg=k[st],st}function Re(Ae){return(Ae<<1)-(4<Ae?9:0)}function Oe(Ae){for(var st=Ae.length;0<=--st;)Ae[st]=0}function $e(Ae){var st=Ae.state,gt=st.pending;gt>Ae.avail_out&&(gt=Ae.avail_out),gt!==0&&(f.arraySet(Ae.output,st.pending_buf,st.pending_out,gt,Ae.next_out),Ae.next_out+=gt,st.pending_out+=gt,Ae.total_out+=gt,Ae.avail_out-=gt,st.pending-=gt,st.pending===0&&(st.pending_out=0))}function Ke(Ae,st){_._tr_flush_block(Ae,0<=Ae.block_start?Ae.block_start:-1,Ae.strstart-Ae.block_start,st),Ae.block_start=Ae.strstart,$e(Ae.strm)}function Ct(Ae,st){Ae.pending_buf[Ae.pending++]=st}function Ue(Ae,st){Ae.pending_buf[Ae.pending++]=st>>>8&255,Ae.pending_buf[Ae.pending++]=255&st}function ft(Ae,st){var gt,ut,tt=Ae.max_chain_length,nt=Ae.strstart,tn=Ae.prev_length,un=Ae.nice_match,qt=Ae.strstart>Ae.w_size-xe?Ae.strstart-(Ae.w_size-xe):0,an=Ae.window,Jt=Ae.w_mask,Wt=Ae.prev,Fn=Ae.strstart+oe,ar=an[nt+tn-1],bn=an[nt+tn];Ae.prev_length>=Ae.good_match&&(tt>>=2),un>Ae.lookahead&&(un=Ae.lookahead);do if(an[(gt=st)+tn]===bn&&an[gt+tn-1]===ar&&an[gt]===an[nt]&&an[++gt]===an[nt+1]){nt+=2,gt++;do;while(an[++nt]===an[++gt]&&an[++nt]===an[++gt]&&an[++nt]===an[++gt]&&an[++nt]===an[++gt]&&an[++nt]===an[++gt]&&an[++nt]===an[++gt]&&an[++nt]===an[++gt]&&an[++nt]===an[++gt]&&nt<Fn);if(ut=oe-(Fn-nt),nt=Fn-oe,tn<ut){if(Ae.match_start=st,un<=(tn=ut))break;ar=an[nt+tn-1],bn=an[nt+tn]}}while((st=Wt[st&Jt])>qt&&--tt!=0);return tn<=Ae.lookahead?tn:Ae.lookahead}function Bt(Ae){var st,gt,ut,tt,nt,tn,un,qt,an,Jt,Wt=Ae.w_size;do{if(tt=Ae.window_size-Ae.lookahead-Ae.strstart,Ae.strstart>=Wt+(Wt-xe)){for(f.arraySet(Ae.window,Ae.window,Wt,Wt,0),Ae.match_start-=Wt,Ae.strstart-=Wt,Ae.block_start-=Wt,st=gt=Ae.hash_size;ut=Ae.head[--st],Ae.head[st]=Wt<=ut?ut-Wt:0,--gt;);for(st=gt=Wt;ut=Ae.prev[--st],Ae.prev[st]=Wt<=ut?ut-Wt:0,--gt;);tt+=Wt}if(Ae.strm.avail_in===0)break;if(tn=Ae.strm,un=Ae.window,qt=Ae.strstart+Ae.lookahead,an=tt,Jt=void 0,Jt=tn.avail_in,an<Jt&&(Jt=an),gt=Jt===0?0:(tn.avail_in-=Jt,f.arraySet(un,tn.input,tn.next_in,Jt,qt),tn.state.wrap===1?tn.adler=r(tn.adler,un,Jt,qt):tn.state.wrap===2&&(tn.adler=C(tn.adler,un,Jt,qt)),tn.next_in+=Jt,tn.total_in+=Jt,Jt),Ae.lookahead+=gt,Ae.lookahead+Ae.insert>=ce)for(nt=Ae.strstart-Ae.insert,Ae.ins_h=Ae.window[nt],Ae.ins_h=(Ae.ins_h<<Ae.hash_shift^Ae.window[nt+1])&Ae.hash_mask;Ae.insert&&(Ae.ins_h=(Ae.ins_h<<Ae.hash_shift^Ae.window[nt+ce-1])&Ae.hash_mask,Ae.prev[nt&Ae.w_mask]=Ae.head[Ae.ins_h],Ae.head[Ae.ins_h]=nt,nt++,Ae.insert--,!(Ae.lookahead+Ae.insert<ce)););}while(Ae.lookahead<xe&&Ae.strm.avail_in!==0)}function hn(Ae,st){for(var gt,ut;;){if(Ae.lookahead<xe){if(Bt(Ae),Ae.lookahead<xe&&st===I)return se;if(Ae.lookahead===0)break}if(gt=0,Ae.lookahead>=ce&&(Ae.ins_h=(Ae.ins_h<<Ae.hash_shift^Ae.window[Ae.strstart+ce-1])&Ae.hash_mask,gt=Ae.prev[Ae.strstart&Ae.w_mask]=Ae.head[Ae.ins_h],Ae.head[Ae.ins_h]=Ae.strstart),gt!==0&&Ae.strstart-gt<=Ae.w_size-xe&&(Ae.match_length=ft(Ae,gt)),Ae.match_length>=ce)if(ut=_._tr_tally(Ae,Ae.strstart-Ae.match_start,Ae.match_length-ce),Ae.lookahead-=Ae.match_length,Ae.match_length<=Ae.max_lazy_match&&Ae.lookahead>=ce){for(Ae.match_length--;Ae.strstart++,Ae.ins_h=(Ae.ins_h<<Ae.hash_shift^Ae.window[Ae.strstart+ce-1])&Ae.hash_mask,gt=Ae.prev[Ae.strstart&Ae.w_mask]=Ae.head[Ae.ins_h],Ae.head[Ae.ins_h]=Ae.strstart,--Ae.match_length!=0;);Ae.strstart++}else Ae.strstart+=Ae.match_length,Ae.match_length=0,Ae.ins_h=Ae.window[Ae.strstart],Ae.ins_h=(Ae.ins_h<<Ae.hash_shift^Ae.window[Ae.strstart+1])&Ae.hash_mask;else ut=_._tr_tally(Ae,0,Ae.window[Ae.strstart]),Ae.lookahead--,Ae.strstart++;if(ut&&(Ke(Ae,!1),Ae.strm.avail_out===0))return se}return Ae.insert=Ae.strstart<ce-1?Ae.strstart:ce-1,st===P?(Ke(Ae,!0),Ae.strm.avail_out===0?Se:Pe):Ae.last_lit&&(Ke(Ae,!1),Ae.strm.avail_out===0)?se:we}function ot(Ae,st){for(var gt,ut,tt;;){if(Ae.lookahead<xe){if(Bt(Ae),Ae.lookahead<xe&&st===I)return se;if(Ae.lookahead===0)break}if(gt=0,Ae.lookahead>=ce&&(Ae.ins_h=(Ae.ins_h<<Ae.hash_shift^Ae.window[Ae.strstart+ce-1])&Ae.hash_mask,gt=Ae.prev[Ae.strstart&Ae.w_mask]=Ae.head[Ae.ins_h],Ae.head[Ae.ins_h]=Ae.strstart),Ae.prev_length=Ae.match_length,Ae.prev_match=Ae.match_start,Ae.match_length=ce-1,gt!==0&&Ae.prev_length<Ae.max_lazy_match&&Ae.strstart-gt<=Ae.w_size-xe&&(Ae.match_length=ft(Ae,gt),Ae.match_length<=5&&(Ae.strategy===1||Ae.match_length===ce&&4096<Ae.strstart-Ae.match_start)&&(Ae.match_length=ce-1)),Ae.prev_length>=ce&&Ae.match_length<=Ae.prev_length){for(tt=Ae.strstart+Ae.lookahead-ce,ut=_._tr_tally(Ae,Ae.strstart-1-Ae.prev_match,Ae.prev_length-ce),Ae.lookahead-=Ae.prev_length-1,Ae.prev_length-=2;++Ae.strstart<=tt&&(Ae.ins_h=(Ae.ins_h<<Ae.hash_shift^Ae.window[Ae.strstart+ce-1])&Ae.hash_mask,gt=Ae.prev[Ae.strstart&Ae.w_mask]=Ae.head[Ae.ins_h],Ae.head[Ae.ins_h]=Ae.strstart),--Ae.prev_length!=0;);if(Ae.match_available=0,Ae.match_length=ce-1,Ae.strstart++,ut&&(Ke(Ae,!1),Ae.strm.avail_out===0))return se}else if(Ae.match_available){if((ut=_._tr_tally(Ae,0,Ae.window[Ae.strstart-1]))&&Ke(Ae,!1),Ae.strstart++,Ae.lookahead--,Ae.strm.avail_out===0)return se}else Ae.match_available=1,Ae.strstart++,Ae.lookahead--}return Ae.match_available&&(ut=_._tr_tally(Ae,0,Ae.window[Ae.strstart-1]),Ae.match_available=0),Ae.insert=Ae.strstart<ce-1?Ae.strstart:ce-1,st===P?(Ke(Ae,!0),Ae.strm.avail_out===0?Se:Pe):Ae.last_lit&&(Ke(Ae,!1),Ae.strm.avail_out===0)?se:we}function en(Ae,st,gt,ut,tt){this.good_length=Ae,this.max_lazy=st,this.nice_length=gt,this.max_chain=ut,this.func=tt}function wt(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=q,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new f.Buf16(2*ye),this.dyn_dtree=new f.Buf16(2*(2*le+1)),this.bl_tree=new f.Buf16(2*(2*_e+1)),Oe(this.dyn_ltree),Oe(this.dyn_dtree),Oe(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new f.Buf16(de+1),this.heap=new f.Buf16(2*re+1),Oe(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new f.Buf16(2*re+1),Oe(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Ne(Ae){var st;return Ae&&Ae.state?(Ae.total_in=Ae.total_out=0,Ae.data_type=H,(st=Ae.state).pending=0,st.pending_out=0,st.wrap<0&&(st.wrap=-st.wrap),st.status=st.wrap?he:Ee,Ae.adler=st.wrap===2?0:1,st.last_flush=I,_._tr_init(st),D):Me(Ae,N)}function We(Ae){var st=Ne(Ae);return st===D&&function(gt){gt.window_size=2*gt.w_size,Oe(gt.head),gt.max_lazy_match=u[gt.level].max_lazy,gt.good_match=u[gt.level].good_length,gt.nice_match=u[gt.level].nice_length,gt.max_chain_length=u[gt.level].max_chain,gt.strstart=0,gt.block_start=0,gt.lookahead=0,gt.insert=0,gt.match_length=gt.prev_length=ce-1,gt.match_available=0,gt.ins_h=0}(Ae.state),st}function Sn(Ae,st,gt,ut,tt,nt){if(!Ae)return N;var tn=1;if(st===j&&(st=6),ut<0?(tn=0,ut=-ut):15<ut&&(tn=2,ut-=16),tt<1||Z<tt||gt!==q||ut<8||15<ut||st<0||9<st||nt<0||W<nt)return Me(Ae,N);ut===8&&(ut=9);var un=new wt;return(Ae.state=un).strm=Ae,un.wrap=tn,un.gzhead=null,un.w_bits=ut,un.w_size=1<<un.w_bits,un.w_mask=un.w_size-1,un.hash_bits=tt+7,un.hash_size=1<<un.hash_bits,un.hash_mask=un.hash_size-1,un.hash_shift=~~((un.hash_bits+ce-1)/ce),un.window=new f.Buf8(2*un.w_size),un.head=new f.Buf16(un.hash_size),un.prev=new f.Buf16(un.w_size),un.lit_bufsize=1<<tt+6,un.pending_buf_size=4*un.lit_bufsize,un.pending_buf=new f.Buf8(un.pending_buf_size),un.d_buf=1*un.lit_bufsize,un.l_buf=3*un.lit_bufsize,un.level=st,un.strategy=nt,un.method=gt,We(Ae)}u=[new en(0,0,0,0,function(Ae,st){var gt=65535;for(gt>Ae.pending_buf_size-5&&(gt=Ae.pending_buf_size-5);;){if(Ae.lookahead<=1){if(Bt(Ae),Ae.lookahead===0&&st===I)return se;if(Ae.lookahead===0)break}Ae.strstart+=Ae.lookahead,Ae.lookahead=0;var ut=Ae.block_start+gt;if((Ae.strstart===0||Ae.strstart>=ut)&&(Ae.lookahead=Ae.strstart-ut,Ae.strstart=ut,Ke(Ae,!1),Ae.strm.avail_out===0)||Ae.strstart-Ae.block_start>=Ae.w_size-xe&&(Ke(Ae,!1),Ae.strm.avail_out===0))return se}return Ae.insert=0,st===P?(Ke(Ae,!0),Ae.strm.avail_out===0?Se:Pe):(Ae.strstart>Ae.block_start&&(Ke(Ae,!1),Ae.strm.avail_out),se)}),new en(4,4,8,4,hn),new en(4,5,16,8,hn),new en(4,6,32,32,hn),new en(4,4,16,16,ot),new en(8,16,32,32,ot),new en(8,16,128,128,ot),new en(8,32,128,256,ot),new en(32,128,258,1024,ot),new en(32,258,258,4096,ot)],a.deflateInit=function(Ae,st){return Sn(Ae,st,q,15,8,0)},a.deflateInit2=Sn,a.deflateReset=We,a.deflateResetKeep=Ne,a.deflateSetHeader=function(Ae,st){return Ae&&Ae.state?Ae.state.wrap!==2?N:(Ae.state.gzhead=st,D):N},a.deflate=function(Ae,st){var gt,ut,tt,nt;if(!Ae||!Ae.state||5<st||st<0)return Ae?Me(Ae,N):N;if(ut=Ae.state,!Ae.output||!Ae.input&&Ae.avail_in!==0||ut.status===666&&st!==P)return Me(Ae,Ae.avail_out===0?-5:N);if(ut.strm=Ae,gt=ut.last_flush,ut.last_flush=st,ut.status===he)if(ut.wrap===2)Ae.adler=0,Ct(ut,31),Ct(ut,139),Ct(ut,8),ut.gzhead?(Ct(ut,(ut.gzhead.text?1:0)+(ut.gzhead.hcrc?2:0)+(ut.gzhead.extra?4:0)+(ut.gzhead.name?8:0)+(ut.gzhead.comment?16:0)),Ct(ut,255&ut.gzhead.time),Ct(ut,ut.gzhead.time>>8&255),Ct(ut,ut.gzhead.time>>16&255),Ct(ut,ut.gzhead.time>>24&255),Ct(ut,ut.level===9?2:2<=ut.strategy||ut.level<2?4:0),Ct(ut,255&ut.gzhead.os),ut.gzhead.extra&&ut.gzhead.extra.length&&(Ct(ut,255&ut.gzhead.extra.length),Ct(ut,ut.gzhead.extra.length>>8&255)),ut.gzhead.hcrc&&(Ae.adler=C(Ae.adler,ut.pending_buf,ut.pending,0)),ut.gzindex=0,ut.status=69):(Ct(ut,0),Ct(ut,0),Ct(ut,0),Ct(ut,0),Ct(ut,0),Ct(ut,ut.level===9?2:2<=ut.strategy||ut.level<2?4:0),Ct(ut,3),ut.status=Ee);else{var tn=q+(ut.w_bits-8<<4)<<8;tn|=(2<=ut.strategy||ut.level<2?0:ut.level<6?1:ut.level===6?2:3)<<6,ut.strstart!==0&&(tn|=32),tn+=31-tn%31,ut.status=Ee,Ue(ut,tn),ut.strstart!==0&&(Ue(ut,Ae.adler>>>16),Ue(ut,65535&Ae.adler)),Ae.adler=1}if(ut.status===69)if(ut.gzhead.extra){for(tt=ut.pending;ut.gzindex<(65535&ut.gzhead.extra.length)&&(ut.pending!==ut.pending_buf_size||(ut.gzhead.hcrc&&ut.pending>tt&&(Ae.adler=C(Ae.adler,ut.pending_buf,ut.pending-tt,tt)),$e(Ae),tt=ut.pending,ut.pending!==ut.pending_buf_size));)Ct(ut,255&ut.gzhead.extra[ut.gzindex]),ut.gzindex++;ut.gzhead.hcrc&&ut.pending>tt&&(Ae.adler=C(Ae.adler,ut.pending_buf,ut.pending-tt,tt)),ut.gzindex===ut.gzhead.extra.length&&(ut.gzindex=0,ut.status=73)}else ut.status=73;if(ut.status===73)if(ut.gzhead.name){tt=ut.pending;do{if(ut.pending===ut.pending_buf_size&&(ut.gzhead.hcrc&&ut.pending>tt&&(Ae.adler=C(Ae.adler,ut.pending_buf,ut.pending-tt,tt)),$e(Ae),tt=ut.pending,ut.pending===ut.pending_buf_size)){nt=1;break}nt=ut.gzindex<ut.gzhead.name.length?255&ut.gzhead.name.charCodeAt(ut.gzindex++):0,Ct(ut,nt)}while(nt!==0);ut.gzhead.hcrc&&ut.pending>tt&&(Ae.adler=C(Ae.adler,ut.pending_buf,ut.pending-tt,tt)),nt===0&&(ut.gzindex=0,ut.status=91)}else ut.status=91;if(ut.status===91)if(ut.gzhead.comment){tt=ut.pending;do{if(ut.pending===ut.pending_buf_size&&(ut.gzhead.hcrc&&ut.pending>tt&&(Ae.adler=C(Ae.adler,ut.pending_buf,ut.pending-tt,tt)),$e(Ae),tt=ut.pending,ut.pending===ut.pending_buf_size)){nt=1;break}nt=ut.gzindex<ut.gzhead.comment.length?255&ut.gzhead.comment.charCodeAt(ut.gzindex++):0,Ct(ut,nt)}while(nt!==0);ut.gzhead.hcrc&&ut.pending>tt&&(Ae.adler=C(Ae.adler,ut.pending_buf,ut.pending-tt,tt)),nt===0&&(ut.status=103)}else ut.status=103;if(ut.status===103&&(ut.gzhead.hcrc?(ut.pending+2>ut.pending_buf_size&&$e(Ae),ut.pending+2<=ut.pending_buf_size&&(Ct(ut,255&Ae.adler),Ct(ut,Ae.adler>>8&255),Ae.adler=0,ut.status=Ee)):ut.status=Ee),ut.pending!==0){if($e(Ae),Ae.avail_out===0)return ut.last_flush=-1,D}else if(Ae.avail_in===0&&Re(st)<=Re(gt)&&st!==P)return Me(Ae,-5);if(ut.status===666&&Ae.avail_in!==0)return Me(Ae,-5);if(Ae.avail_in!==0||ut.lookahead!==0||st!==I&&ut.status!==666){var un=ut.strategy===2?function(qt,an){for(var Jt;;){if(qt.lookahead===0&&(Bt(qt),qt.lookahead===0)){if(an===I)return se;break}if(qt.match_length=0,Jt=_._tr_tally(qt,0,qt.window[qt.strstart]),qt.lookahead--,qt.strstart++,Jt&&(Ke(qt,!1),qt.strm.avail_out===0))return se}return qt.insert=0,an===P?(Ke(qt,!0),qt.strm.avail_out===0?Se:Pe):qt.last_lit&&(Ke(qt,!1),qt.strm.avail_out===0)?se:we}(ut,st):ut.strategy===3?function(qt,an){for(var Jt,Wt,Fn,ar,bn=qt.window;;){if(qt.lookahead<=oe){if(Bt(qt),qt.lookahead<=oe&&an===I)return se;if(qt.lookahead===0)break}if(qt.match_length=0,qt.lookahead>=ce&&0<qt.strstart&&(Wt=bn[Fn=qt.strstart-1])===bn[++Fn]&&Wt===bn[++Fn]&&Wt===bn[++Fn]){ar=qt.strstart+oe;do;while(Wt===bn[++Fn]&&Wt===bn[++Fn]&&Wt===bn[++Fn]&&Wt===bn[++Fn]&&Wt===bn[++Fn]&&Wt===bn[++Fn]&&Wt===bn[++Fn]&&Wt===bn[++Fn]&&Fn<ar);qt.match_length=oe-(ar-Fn),qt.match_length>qt.lookahead&&(qt.match_length=qt.lookahead)}if(qt.match_length>=ce?(Jt=_._tr_tally(qt,1,qt.match_length-ce),qt.lookahead-=qt.match_length,qt.strstart+=qt.match_length,qt.match_length=0):(Jt=_._tr_tally(qt,0,qt.window[qt.strstart]),qt.lookahead--,qt.strstart++),Jt&&(Ke(qt,!1),qt.strm.avail_out===0))return se}return qt.insert=0,an===P?(Ke(qt,!0),qt.strm.avail_out===0?Se:Pe):qt.last_lit&&(Ke(qt,!1),qt.strm.avail_out===0)?se:we}(ut,st):u[ut.level].func(ut,st);if(un!==Se&&un!==Pe||(ut.status=666),un===se||un===Se)return Ae.avail_out===0&&(ut.last_flush=-1),D;if(un===we&&(st===1?_._tr_align(ut):st!==5&&(_._tr_stored_block(ut,0,0,!1),st===3&&(Oe(ut.head),ut.lookahead===0&&(ut.strstart=0,ut.block_start=0,ut.insert=0))),$e(Ae),Ae.avail_out===0))return ut.last_flush=-1,D}return st!==P?D:ut.wrap<=0?1:(ut.wrap===2?(Ct(ut,255&Ae.adler),Ct(ut,Ae.adler>>8&255),Ct(ut,Ae.adler>>16&255),Ct(ut,Ae.adler>>24&255),Ct(ut,255&Ae.total_in),Ct(ut,Ae.total_in>>8&255),Ct(ut,Ae.total_in>>16&255),Ct(ut,Ae.total_in>>24&255)):(Ue(ut,Ae.adler>>>16),Ue(ut,65535&Ae.adler)),$e(Ae),0<ut.wrap&&(ut.wrap=-ut.wrap),ut.pending!==0?D:1)},a.deflateEnd=function(Ae){var st;return Ae&&Ae.state?(st=Ae.state.status)!==he&&st!==69&&st!==73&&st!==91&&st!==103&&st!==Ee&&st!==666?Me(Ae,N):(Ae.state=null,st===Ee?Me(Ae,-3):D):N},a.deflateSetDictionary=function(Ae,st){var gt,ut,tt,nt,tn,un,qt,an,Jt=st.length;if(!Ae||!Ae.state||(nt=(gt=Ae.state).wrap)===2||nt===1&&gt.status!==he||gt.lookahead)return N;for(nt===1&&(Ae.adler=r(Ae.adler,st,Jt,0)),gt.wrap=0,Jt>=gt.w_size&&(nt===0&&(Oe(gt.head),gt.strstart=0,gt.block_start=0,gt.insert=0),an=new f.Buf8(gt.w_size),f.arraySet(an,st,Jt-gt.w_size,gt.w_size,0),st=an,Jt=gt.w_size),tn=Ae.avail_in,un=Ae.next_in,qt=Ae.input,Ae.avail_in=Jt,Ae.next_in=0,Ae.input=st,Bt(gt);gt.lookahead>=ce;){for(ut=gt.strstart,tt=gt.lookahead-(ce-1);gt.ins_h=(gt.ins_h<<gt.hash_shift^gt.window[ut+ce-1])&gt.hash_mask,gt.prev[ut&gt.w_mask]=gt.head[gt.ins_h],gt.head[gt.ins_h]=ut,ut++,--tt;);gt.strstart=ut,gt.lookahead=ce-1,Bt(gt)}return gt.strstart+=gt.lookahead,gt.block_start=gt.strstart,gt.insert=gt.lookahead,gt.lookahead=0,gt.match_length=gt.prev_length=ce-1,gt.match_available=0,Ae.next_in=un,Ae.input=qt,Ae.avail_in=tn,gt.wrap=nt,D},a.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(n,s,a){s.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(n,s,a){s.exports=function(u,f){var _,r,C,k,I,P,D,N,j,W,H,q,Z,re,le,_e,ye,de,ce,oe,xe,he,Ee,se,we;_=u.state,r=u.next_in,se=u.input,C=r+(u.avail_in-5),k=u.next_out,we=u.output,I=k-(f-u.avail_out),P=k+(u.avail_out-257),D=_.dmax,N=_.wsize,j=_.whave,W=_.wnext,H=_.window,q=_.hold,Z=_.bits,re=_.lencode,le=_.distcode,_e=(1<<_.lenbits)-1,ye=(1<<_.distbits)-1;e:do{Z<15&&(q+=se[r++]<<Z,Z+=8,q+=se[r++]<<Z,Z+=8),de=re[q&_e];t:for(;;){if(q>>>=ce=de>>>24,Z-=ce,(ce=de>>>16&255)===0)we[k++]=65535&de;else{if(!(16&ce)){if(!(64&ce)){de=re[(65535&de)+(q&(1<<ce)-1)];continue t}if(32&ce){_.mode=12;break e}u.msg="invalid literal/length code",_.mode=30;break e}oe=65535&de,(ce&=15)&&(Z<ce&&(q+=se[r++]<<Z,Z+=8),oe+=q&(1<<ce)-1,q>>>=ce,Z-=ce),Z<15&&(q+=se[r++]<<Z,Z+=8,q+=se[r++]<<Z,Z+=8),de=le[q&ye];n:for(;;){if(q>>>=ce=de>>>24,Z-=ce,!(16&(ce=de>>>16&255))){if(!(64&ce)){de=le[(65535&de)+(q&(1<<ce)-1)];continue n}u.msg="invalid distance code",_.mode=30;break e}if(xe=65535&de,Z<(ce&=15)&&(q+=se[r++]<<Z,(Z+=8)<ce&&(q+=se[r++]<<Z,Z+=8)),D<(xe+=q&(1<<ce)-1)){u.msg="invalid distance too far back",_.mode=30;break e}if(q>>>=ce,Z-=ce,(ce=k-I)<xe){if(j<(ce=xe-ce)&&_.sane){u.msg="invalid distance too far back",_.mode=30;break e}if(Ee=H,(he=0)===W){if(he+=N-ce,ce<oe){for(oe-=ce;we[k++]=H[he++],--ce;);he=k-xe,Ee=we}}else if(W<ce){if(he+=N+W-ce,(ce-=W)<oe){for(oe-=ce;we[k++]=H[he++],--ce;);if(he=0,W<oe){for(oe-=ce=W;we[k++]=H[he++],--ce;);he=k-xe,Ee=we}}}else if(he+=W-ce,ce<oe){for(oe-=ce;we[k++]=H[he++],--ce;);he=k-xe,Ee=we}for(;2<oe;)we[k++]=Ee[he++],we[k++]=Ee[he++],we[k++]=Ee[he++],oe-=3;oe&&(we[k++]=Ee[he++],1<oe&&(we[k++]=Ee[he++]))}else{for(he=k-xe;we[k++]=we[he++],we[k++]=we[he++],we[k++]=we[he++],2<(oe-=3););oe&&(we[k++]=we[he++],1<oe&&(we[k++]=we[he++]))}break}}break}}while(r<C&&k<P);r-=oe=Z>>3,q&=(1<<(Z-=oe<<3))-1,u.next_in=r,u.next_out=k,u.avail_in=r<C?C-r+5:5-(r-C),u.avail_out=k<P?P-k+257:257-(k-P),_.hold=q,_.bits=Z}},{}],49:[function(n,s,a){var u=n("../utils/common"),f=n("./adler32"),_=n("./crc32"),r=n("./inffast"),C=n("./inftrees"),k=1,I=2,P=0,D=-2,N=1,j=852,W=592;function H(he){return(he>>>24&255)+(he>>>8&65280)+((65280&he)<<8)+((255&he)<<24)}function q(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new u.Buf16(320),this.work=new u.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function Z(he){var Ee;return he&&he.state?(Ee=he.state,he.total_in=he.total_out=Ee.total=0,he.msg="",Ee.wrap&&(he.adler=1&Ee.wrap),Ee.mode=N,Ee.last=0,Ee.havedict=0,Ee.dmax=32768,Ee.head=null,Ee.hold=0,Ee.bits=0,Ee.lencode=Ee.lendyn=new u.Buf32(j),Ee.distcode=Ee.distdyn=new u.Buf32(W),Ee.sane=1,Ee.back=-1,P):D}function re(he){var Ee;return he&&he.state?((Ee=he.state).wsize=0,Ee.whave=0,Ee.wnext=0,Z(he)):D}function le(he,Ee){var se,we;return he&&he.state?(we=he.state,Ee<0?(se=0,Ee=-Ee):(se=1+(Ee>>4),Ee<48&&(Ee&=15)),Ee&&(Ee<8||15<Ee)?D:(we.window!==null&&we.wbits!==Ee&&(we.window=null),we.wrap=se,we.wbits=Ee,re(he))):D}function _e(he,Ee){var se,we;return he?(we=new q,(he.state=we).window=null,(se=le(he,Ee))!==P&&(he.state=null),se):D}var ye,de,ce=!0;function oe(he){if(ce){var Ee;for(ye=new u.Buf32(512),de=new u.Buf32(32),Ee=0;Ee<144;)he.lens[Ee++]=8;for(;Ee<256;)he.lens[Ee++]=9;for(;Ee<280;)he.lens[Ee++]=7;for(;Ee<288;)he.lens[Ee++]=8;for(C(k,he.lens,0,288,ye,0,he.work,{bits:9}),Ee=0;Ee<32;)he.lens[Ee++]=5;C(I,he.lens,0,32,de,0,he.work,{bits:5}),ce=!1}he.lencode=ye,he.lenbits=9,he.distcode=de,he.distbits=5}function xe(he,Ee,se,we){var Se,Pe=he.state;return Pe.window===null&&(Pe.wsize=1<<Pe.wbits,Pe.wnext=0,Pe.whave=0,Pe.window=new u.Buf8(Pe.wsize)),we>=Pe.wsize?(u.arraySet(Pe.window,Ee,se-Pe.wsize,Pe.wsize,0),Pe.wnext=0,Pe.whave=Pe.wsize):(we<(Se=Pe.wsize-Pe.wnext)&&(Se=we),u.arraySet(Pe.window,Ee,se-we,Se,Pe.wnext),(we-=Se)?(u.arraySet(Pe.window,Ee,se-we,we,0),Pe.wnext=we,Pe.whave=Pe.wsize):(Pe.wnext+=Se,Pe.wnext===Pe.wsize&&(Pe.wnext=0),Pe.whave<Pe.wsize&&(Pe.whave+=Se))),0}a.inflateReset=re,a.inflateReset2=le,a.inflateResetKeep=Z,a.inflateInit=function(he){return _e(he,15)},a.inflateInit2=_e,a.inflate=function(he,Ee){var se,we,Se,Pe,Me,Re,Oe,$e,Ke,Ct,Ue,ft,Bt,hn,ot,en,wt,Ne,We,Sn,Ae,st,gt,ut,tt=0,nt=new u.Buf8(4),tn=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!he||!he.state||!he.output||!he.input&&he.avail_in!==0)return D;(se=he.state).mode===12&&(se.mode=13),Me=he.next_out,Se=he.output,Oe=he.avail_out,Pe=he.next_in,we=he.input,Re=he.avail_in,$e=se.hold,Ke=se.bits,Ct=Re,Ue=Oe,st=P;e:for(;;)switch(se.mode){case N:if(se.wrap===0){se.mode=13;break}for(;Ke<16;){if(Re===0)break e;Re--,$e+=we[Pe++]<<Ke,Ke+=8}if(2&se.wrap&&$e===35615){nt[se.check=0]=255&$e,nt[1]=$e>>>8&255,se.check=_(se.check,nt,2,0),Ke=$e=0,se.mode=2;break}if(se.flags=0,se.head&&(se.head.done=!1),!(1&se.wrap)||(((255&$e)<<8)+($e>>8))%31){he.msg="incorrect header check",se.mode=30;break}if((15&$e)!=8){he.msg="unknown compression method",se.mode=30;break}if(Ke-=4,Ae=8+(15&($e>>>=4)),se.wbits===0)se.wbits=Ae;else if(Ae>se.wbits){he.msg="invalid window size",se.mode=30;break}se.dmax=1<<Ae,he.adler=se.check=1,se.mode=512&$e?10:12,Ke=$e=0;break;case 2:for(;Ke<16;){if(Re===0)break e;Re--,$e+=we[Pe++]<<Ke,Ke+=8}if(se.flags=$e,(255&se.flags)!=8){he.msg="unknown compression method",se.mode=30;break}if(57344&se.flags){he.msg="unknown header flags set",se.mode=30;break}se.head&&(se.head.text=$e>>8&1),512&se.flags&&(nt[0]=255&$e,nt[1]=$e>>>8&255,se.check=_(se.check,nt,2,0)),Ke=$e=0,se.mode=3;case 3:for(;Ke<32;){if(Re===0)break e;Re--,$e+=we[Pe++]<<Ke,Ke+=8}se.head&&(se.head.time=$e),512&se.flags&&(nt[0]=255&$e,nt[1]=$e>>>8&255,nt[2]=$e>>>16&255,nt[3]=$e>>>24&255,se.check=_(se.check,nt,4,0)),Ke=$e=0,se.mode=4;case 4:for(;Ke<16;){if(Re===0)break e;Re--,$e+=we[Pe++]<<Ke,Ke+=8}se.head&&(se.head.xflags=255&$e,se.head.os=$e>>8),512&se.flags&&(nt[0]=255&$e,nt[1]=$e>>>8&255,se.check=_(se.check,nt,2,0)),Ke=$e=0,se.mode=5;case 5:if(1024&se.flags){for(;Ke<16;){if(Re===0)break e;Re--,$e+=we[Pe++]<<Ke,Ke+=8}se.length=$e,se.head&&(se.head.extra_len=$e),512&se.flags&&(nt[0]=255&$e,nt[1]=$e>>>8&255,se.check=_(se.check,nt,2,0)),Ke=$e=0}else se.head&&(se.head.extra=null);se.mode=6;case 6:if(1024&se.flags&&(Re<(ft=se.length)&&(ft=Re),ft&&(se.head&&(Ae=se.head.extra_len-se.length,se.head.extra||(se.head.extra=new Array(se.head.extra_len)),u.arraySet(se.head.extra,we,Pe,ft,Ae)),512&se.flags&&(se.check=_(se.check,we,ft,Pe)),Re-=ft,Pe+=ft,se.length-=ft),se.length))break e;se.length=0,se.mode=7;case 7:if(2048&se.flags){if(Re===0)break e;for(ft=0;Ae=we[Pe+ft++],se.head&&Ae&&se.length<65536&&(se.head.name+=String.fromCharCode(Ae)),Ae&&ft<Re;);if(512&se.flags&&(se.check=_(se.check,we,ft,Pe)),Re-=ft,Pe+=ft,Ae)break e}else se.head&&(se.head.name=null);se.length=0,se.mode=8;case 8:if(4096&se.flags){if(Re===0)break e;for(ft=0;Ae=we[Pe+ft++],se.head&&Ae&&se.length<65536&&(se.head.comment+=String.fromCharCode(Ae)),Ae&&ft<Re;);if(512&se.flags&&(se.check=_(se.check,we,ft,Pe)),Re-=ft,Pe+=ft,Ae)break e}else se.head&&(se.head.comment=null);se.mode=9;case 9:if(512&se.flags){for(;Ke<16;){if(Re===0)break e;Re--,$e+=we[Pe++]<<Ke,Ke+=8}if($e!==(65535&se.check)){he.msg="header crc mismatch",se.mode=30;break}Ke=$e=0}se.head&&(se.head.hcrc=se.flags>>9&1,se.head.done=!0),he.adler=se.check=0,se.mode=12;break;case 10:for(;Ke<32;){if(Re===0)break e;Re--,$e+=we[Pe++]<<Ke,Ke+=8}he.adler=se.check=H($e),Ke=$e=0,se.mode=11;case 11:if(se.havedict===0)return he.next_out=Me,he.avail_out=Oe,he.next_in=Pe,he.avail_in=Re,se.hold=$e,se.bits=Ke,2;he.adler=se.check=1,se.mode=12;case 12:if(Ee===5||Ee===6)break e;case 13:if(se.last){$e>>>=7&Ke,Ke-=7&Ke,se.mode=27;break}for(;Ke<3;){if(Re===0)break e;Re--,$e+=we[Pe++]<<Ke,Ke+=8}switch(se.last=1&$e,Ke-=1,3&($e>>>=1)){case 0:se.mode=14;break;case 1:if(oe(se),se.mode=20,Ee!==6)break;$e>>>=2,Ke-=2;break e;case 2:se.mode=17;break;case 3:he.msg="invalid block type",se.mode=30}$e>>>=2,Ke-=2;break;case 14:for($e>>>=7&Ke,Ke-=7&Ke;Ke<32;){if(Re===0)break e;Re--,$e+=we[Pe++]<<Ke,Ke+=8}if((65535&$e)!=($e>>>16^65535)){he.msg="invalid stored block lengths",se.mode=30;break}if(se.length=65535&$e,Ke=$e=0,se.mode=15,Ee===6)break e;case 15:se.mode=16;case 16:if(ft=se.length){if(Re<ft&&(ft=Re),Oe<ft&&(ft=Oe),ft===0)break e;u.arraySet(Se,we,Pe,ft,Me),Re-=ft,Pe+=ft,Oe-=ft,Me+=ft,se.length-=ft;break}se.mode=12;break;case 17:for(;Ke<14;){if(Re===0)break e;Re--,$e+=we[Pe++]<<Ke,Ke+=8}if(se.nlen=257+(31&$e),$e>>>=5,Ke-=5,se.ndist=1+(31&$e),$e>>>=5,Ke-=5,se.ncode=4+(15&$e),$e>>>=4,Ke-=4,286<se.nlen||30<se.ndist){he.msg="too many length or distance symbols",se.mode=30;break}se.have=0,se.mode=18;case 18:for(;se.have<se.ncode;){for(;Ke<3;){if(Re===0)break e;Re--,$e+=we[Pe++]<<Ke,Ke+=8}se.lens[tn[se.have++]]=7&$e,$e>>>=3,Ke-=3}for(;se.have<19;)se.lens[tn[se.have++]]=0;if(se.lencode=se.lendyn,se.lenbits=7,gt={bits:se.lenbits},st=C(0,se.lens,0,19,se.lencode,0,se.work,gt),se.lenbits=gt.bits,st){he.msg="invalid code lengths set",se.mode=30;break}se.have=0,se.mode=19;case 19:for(;se.have<se.nlen+se.ndist;){for(;en=(tt=se.lencode[$e&(1<<se.lenbits)-1])>>>16&255,wt=65535&tt,!((ot=tt>>>24)<=Ke);){if(Re===0)break e;Re--,$e+=we[Pe++]<<Ke,Ke+=8}if(wt<16)$e>>>=ot,Ke-=ot,se.lens[se.have++]=wt;else{if(wt===16){for(ut=ot+2;Ke<ut;){if(Re===0)break e;Re--,$e+=we[Pe++]<<Ke,Ke+=8}if($e>>>=ot,Ke-=ot,se.have===0){he.msg="invalid bit length repeat",se.mode=30;break}Ae=se.lens[se.have-1],ft=3+(3&$e),$e>>>=2,Ke-=2}else if(wt===17){for(ut=ot+3;Ke<ut;){if(Re===0)break e;Re--,$e+=we[Pe++]<<Ke,Ke+=8}Ke-=ot,Ae=0,ft=3+(7&($e>>>=ot)),$e>>>=3,Ke-=3}else{for(ut=ot+7;Ke<ut;){if(Re===0)break e;Re--,$e+=we[Pe++]<<Ke,Ke+=8}Ke-=ot,Ae=0,ft=11+(127&($e>>>=ot)),$e>>>=7,Ke-=7}if(se.have+ft>se.nlen+se.ndist){he.msg="invalid bit length repeat",se.mode=30;break}for(;ft--;)se.lens[se.have++]=Ae}}if(se.mode===30)break;if(se.lens[256]===0){he.msg="invalid code -- missing end-of-block",se.mode=30;break}if(se.lenbits=9,gt={bits:se.lenbits},st=C(k,se.lens,0,se.nlen,se.lencode,0,se.work,gt),se.lenbits=gt.bits,st){he.msg="invalid literal/lengths set",se.mode=30;break}if(se.distbits=6,se.distcode=se.distdyn,gt={bits:se.distbits},st=C(I,se.lens,se.nlen,se.ndist,se.distcode,0,se.work,gt),se.distbits=gt.bits,st){he.msg="invalid distances set",se.mode=30;break}if(se.mode=20,Ee===6)break e;case 20:se.mode=21;case 21:if(6<=Re&&258<=Oe){he.next_out=Me,he.avail_out=Oe,he.next_in=Pe,he.avail_in=Re,se.hold=$e,se.bits=Ke,r(he,Ue),Me=he.next_out,Se=he.output,Oe=he.avail_out,Pe=he.next_in,we=he.input,Re=he.avail_in,$e=se.hold,Ke=se.bits,se.mode===12&&(se.back=-1);break}for(se.back=0;en=(tt=se.lencode[$e&(1<<se.lenbits)-1])>>>16&255,wt=65535&tt,!((ot=tt>>>24)<=Ke);){if(Re===0)break e;Re--,$e+=we[Pe++]<<Ke,Ke+=8}if(en&&!(240&en)){for(Ne=ot,We=en,Sn=wt;en=(tt=se.lencode[Sn+(($e&(1<<Ne+We)-1)>>Ne)])>>>16&255,wt=65535&tt,!(Ne+(ot=tt>>>24)<=Ke);){if(Re===0)break e;Re--,$e+=we[Pe++]<<Ke,Ke+=8}$e>>>=Ne,Ke-=Ne,se.back+=Ne}if($e>>>=ot,Ke-=ot,se.back+=ot,se.length=wt,en===0){se.mode=26;break}if(32&en){se.back=-1,se.mode=12;break}if(64&en){he.msg="invalid literal/length code",se.mode=30;break}se.extra=15&en,se.mode=22;case 22:if(se.extra){for(ut=se.extra;Ke<ut;){if(Re===0)break e;Re--,$e+=we[Pe++]<<Ke,Ke+=8}se.length+=$e&(1<<se.extra)-1,$e>>>=se.extra,Ke-=se.extra,se.back+=se.extra}se.was=se.length,se.mode=23;case 23:for(;en=(tt=se.distcode[$e&(1<<se.distbits)-1])>>>16&255,wt=65535&tt,!((ot=tt>>>24)<=Ke);){if(Re===0)break e;Re--,$e+=we[Pe++]<<Ke,Ke+=8}if(!(240&en)){for(Ne=ot,We=en,Sn=wt;en=(tt=se.distcode[Sn+(($e&(1<<Ne+We)-1)>>Ne)])>>>16&255,wt=65535&tt,!(Ne+(ot=tt>>>24)<=Ke);){if(Re===0)break e;Re--,$e+=we[Pe++]<<Ke,Ke+=8}$e>>>=Ne,Ke-=Ne,se.back+=Ne}if($e>>>=ot,Ke-=ot,se.back+=ot,64&en){he.msg="invalid distance code",se.mode=30;break}se.offset=wt,se.extra=15&en,se.mode=24;case 24:if(se.extra){for(ut=se.extra;Ke<ut;){if(Re===0)break e;Re--,$e+=we[Pe++]<<Ke,Ke+=8}se.offset+=$e&(1<<se.extra)-1,$e>>>=se.extra,Ke-=se.extra,se.back+=se.extra}if(se.offset>se.dmax){he.msg="invalid distance too far back",se.mode=30;break}se.mode=25;case 25:if(Oe===0)break e;if(ft=Ue-Oe,se.offset>ft){if((ft=se.offset-ft)>se.whave&&se.sane){he.msg="invalid distance too far back",se.mode=30;break}Bt=ft>se.wnext?(ft-=se.wnext,se.wsize-ft):se.wnext-ft,ft>se.length&&(ft=se.length),hn=se.window}else hn=Se,Bt=Me-se.offset,ft=se.length;for(Oe<ft&&(ft=Oe),Oe-=ft,se.length-=ft;Se[Me++]=hn[Bt++],--ft;);se.length===0&&(se.mode=21);break;case 26:if(Oe===0)break e;Se[Me++]=se.length,Oe--,se.mode=21;break;case 27:if(se.wrap){for(;Ke<32;){if(Re===0)break e;Re--,$e|=we[Pe++]<<Ke,Ke+=8}if(Ue-=Oe,he.total_out+=Ue,se.total+=Ue,Ue&&(he.adler=se.check=se.flags?_(se.check,Se,Ue,Me-Ue):f(se.check,Se,Ue,Me-Ue)),Ue=Oe,(se.flags?$e:H($e))!==se.check){he.msg="incorrect data check",se.mode=30;break}Ke=$e=0}se.mode=28;case 28:if(se.wrap&&se.flags){for(;Ke<32;){if(Re===0)break e;Re--,$e+=we[Pe++]<<Ke,Ke+=8}if($e!==(4294967295&se.total)){he.msg="incorrect length check",se.mode=30;break}Ke=$e=0}se.mode=29;case 29:st=1;break e;case 30:st=-3;break e;case 31:return-4;case 32:default:return D}return he.next_out=Me,he.avail_out=Oe,he.next_in=Pe,he.avail_in=Re,se.hold=$e,se.bits=Ke,(se.wsize||Ue!==he.avail_out&&se.mode<30&&(se.mode<27||Ee!==4))&&xe(he,he.output,he.next_out,Ue-he.avail_out)?(se.mode=31,-4):(Ct-=he.avail_in,Ue-=he.avail_out,he.total_in+=Ct,he.total_out+=Ue,se.total+=Ue,se.wrap&&Ue&&(he.adler=se.check=se.flags?_(se.check,Se,Ue,he.next_out-Ue):f(se.check,Se,Ue,he.next_out-Ue)),he.data_type=se.bits+(se.last?64:0)+(se.mode===12?128:0)+(se.mode===20||se.mode===15?256:0),(Ct==0&&Ue===0||Ee===4)&&st===P&&(st=-5),st)},a.inflateEnd=function(he){if(!he||!he.state)return D;var Ee=he.state;return Ee.window&&(Ee.window=null),he.state=null,P},a.inflateGetHeader=function(he,Ee){var se;return he&&he.state&&2&(se=he.state).wrap?((se.head=Ee).done=!1,P):D},a.inflateSetDictionary=function(he,Ee){var se,we=Ee.length;return he&&he.state?(se=he.state).wrap!==0&&se.mode!==11?D:se.mode===11&&f(1,Ee,we,0)!==se.check?-3:xe(he,Ee,we,we)?(se.mode=31,-4):(se.havedict=1,P):D},a.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(n,s,a){var u=n("../utils/common"),f=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],_=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],r=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],C=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];s.exports=function(k,I,P,D,N,j,W,H){var q,Z,re,le,_e,ye,de,ce,oe,xe=H.bits,he=0,Ee=0,se=0,we=0,Se=0,Pe=0,Me=0,Re=0,Oe=0,$e=0,Ke=null,Ct=0,Ue=new u.Buf16(16),ft=new u.Buf16(16),Bt=null,hn=0;for(he=0;he<=15;he++)Ue[he]=0;for(Ee=0;Ee<D;Ee++)Ue[I[P+Ee]]++;for(Se=xe,we=15;1<=we&&Ue[we]===0;we--);if(we<Se&&(Se=we),we===0)return N[j++]=20971520,N[j++]=20971520,H.bits=1,0;for(se=1;se<we&&Ue[se]===0;se++);for(Se<se&&(Se=se),he=Re=1;he<=15;he++)if(Re<<=1,(Re-=Ue[he])<0)return-1;if(0<Re&&(k===0||we!==1))return-1;for(ft[1]=0,he=1;he<15;he++)ft[he+1]=ft[he]+Ue[he];for(Ee=0;Ee<D;Ee++)I[P+Ee]!==0&&(W[ft[I[P+Ee]]++]=Ee);if(ye=k===0?(Ke=Bt=W,19):k===1?(Ke=f,Ct-=257,Bt=_,hn-=257,256):(Ke=r,Bt=C,-1),he=se,_e=j,Me=Ee=$e=0,re=-1,le=(Oe=1<<(Pe=Se))-1,k===1&&852<Oe||k===2&&592<Oe)return 1;for(;;){for(de=he-Me,oe=W[Ee]<ye?(ce=0,W[Ee]):W[Ee]>ye?(ce=Bt[hn+W[Ee]],Ke[Ct+W[Ee]]):(ce=96,0),q=1<<he-Me,se=Z=1<<Pe;N[_e+($e>>Me)+(Z-=q)]=de<<24|ce<<16|oe|0,Z!==0;);for(q=1<<he-1;$e&q;)q>>=1;if(q!==0?($e&=q-1,$e+=q):$e=0,Ee++,--Ue[he]==0){if(he===we)break;he=I[P+W[Ee]]}if(Se<he&&($e&le)!==re){for(Me===0&&(Me=Se),_e+=se,Re=1<<(Pe=he-Me);Pe+Me<we&&!((Re-=Ue[Pe+Me])<=0);)Pe++,Re<<=1;if(Oe+=1<<Pe,k===1&&852<Oe||k===2&&592<Oe)return 1;N[re=$e&le]=Se<<24|Pe<<16|_e-j|0}}return $e!==0&&(N[_e+$e]=he-Me<<24|64<<16|0),H.bits=Se,0}},{"../utils/common":41}],51:[function(n,s,a){s.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(n,s,a){var u=n("../utils/common"),f=0,_=1;function r(tt){for(var nt=tt.length;0<=--nt;)tt[nt]=0}var C=0,k=29,I=256,P=I+1+k,D=30,N=19,j=2*P+1,W=15,H=16,q=7,Z=256,re=16,le=17,_e=18,ye=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],de=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],ce=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],oe=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],xe=new Array(2*(P+2));r(xe);var he=new Array(2*D);r(he);var Ee=new Array(512);r(Ee);var se=new Array(256);r(se);var we=new Array(k);r(we);var Se,Pe,Me,Re=new Array(D);function Oe(tt,nt,tn,un,qt){this.static_tree=tt,this.extra_bits=nt,this.extra_base=tn,this.elems=un,this.max_length=qt,this.has_stree=tt&&tt.length}function $e(tt,nt){this.dyn_tree=tt,this.max_code=0,this.stat_desc=nt}function Ke(tt){return tt<256?Ee[tt]:Ee[256+(tt>>>7)]}function Ct(tt,nt){tt.pending_buf[tt.pending++]=255&nt,tt.pending_buf[tt.pending++]=nt>>>8&255}function Ue(tt,nt,tn){tt.bi_valid>H-tn?(tt.bi_buf|=nt<<tt.bi_valid&65535,Ct(tt,tt.bi_buf),tt.bi_buf=nt>>H-tt.bi_valid,tt.bi_valid+=tn-H):(tt.bi_buf|=nt<<tt.bi_valid&65535,tt.bi_valid+=tn)}function ft(tt,nt,tn){Ue(tt,tn[2*nt],tn[2*nt+1])}function Bt(tt,nt){for(var tn=0;tn|=1&tt,tt>>>=1,tn<<=1,0<--nt;);return tn>>>1}function hn(tt,nt,tn){var un,qt,an=new Array(W+1),Jt=0;for(un=1;un<=W;un++)an[un]=Jt=Jt+tn[un-1]<<1;for(qt=0;qt<=nt;qt++){var Wt=tt[2*qt+1];Wt!==0&&(tt[2*qt]=Bt(an[Wt]++,Wt))}}function ot(tt){var nt;for(nt=0;nt<P;nt++)tt.dyn_ltree[2*nt]=0;for(nt=0;nt<D;nt++)tt.dyn_dtree[2*nt]=0;for(nt=0;nt<N;nt++)tt.bl_tree[2*nt]=0;tt.dyn_ltree[2*Z]=1,tt.opt_len=tt.static_len=0,tt.last_lit=tt.matches=0}function en(tt){8<tt.bi_valid?Ct(tt,tt.bi_buf):0<tt.bi_valid&&(tt.pending_buf[tt.pending++]=tt.bi_buf),tt.bi_buf=0,tt.bi_valid=0}function wt(tt,nt,tn,un){var qt=2*nt,an=2*tn;return tt[qt]<tt[an]||tt[qt]===tt[an]&&un[nt]<=un[tn]}function Ne(tt,nt,tn){for(var un=tt.heap[tn],qt=tn<<1;qt<=tt.heap_len&&(qt<tt.heap_len&&wt(nt,tt.heap[qt+1],tt.heap[qt],tt.depth)&&qt++,!wt(nt,un,tt.heap[qt],tt.depth));)tt.heap[tn]=tt.heap[qt],tn=qt,qt<<=1;tt.heap[tn]=un}function We(tt,nt,tn){var un,qt,an,Jt,Wt=0;if(tt.last_lit!==0)for(;un=tt.pending_buf[tt.d_buf+2*Wt]<<8|tt.pending_buf[tt.d_buf+2*Wt+1],qt=tt.pending_buf[tt.l_buf+Wt],Wt++,un===0?ft(tt,qt,nt):(ft(tt,(an=se[qt])+I+1,nt),(Jt=ye[an])!==0&&Ue(tt,qt-=we[an],Jt),ft(tt,an=Ke(--un),tn),(Jt=de[an])!==0&&Ue(tt,un-=Re[an],Jt)),Wt<tt.last_lit;);ft(tt,Z,nt)}function Sn(tt,nt){var tn,un,qt,an=nt.dyn_tree,Jt=nt.stat_desc.static_tree,Wt=nt.stat_desc.has_stree,Fn=nt.stat_desc.elems,ar=-1;for(tt.heap_len=0,tt.heap_max=j,tn=0;tn<Fn;tn++)an[2*tn]!==0?(tt.heap[++tt.heap_len]=ar=tn,tt.depth[tn]=0):an[2*tn+1]=0;for(;tt.heap_len<2;)an[2*(qt=tt.heap[++tt.heap_len]=ar<2?++ar:0)]=1,tt.depth[qt]=0,tt.opt_len--,Wt&&(tt.static_len-=Jt[2*qt+1]);for(nt.max_code=ar,tn=tt.heap_len>>1;1<=tn;tn--)Ne(tt,an,tn);for(qt=Fn;tn=tt.heap[1],tt.heap[1]=tt.heap[tt.heap_len--],Ne(tt,an,1),un=tt.heap[1],tt.heap[--tt.heap_max]=tn,tt.heap[--tt.heap_max]=un,an[2*qt]=an[2*tn]+an[2*un],tt.depth[qt]=(tt.depth[tn]>=tt.depth[un]?tt.depth[tn]:tt.depth[un])+1,an[2*tn+1]=an[2*un+1]=qt,tt.heap[1]=qt++,Ne(tt,an,1),2<=tt.heap_len;);tt.heap[--tt.heap_max]=tt.heap[1],function(bn,lr){var Cn,xn,Er,Rr,Wn,Mn,Ar=lr.dyn_tree,fi=lr.max_code,yo=lr.stat_desc.static_tree,vr=lr.stat_desc.has_stree,zi=lr.stat_desc.extra_bits,Li=lr.stat_desc.extra_base,mi=lr.stat_desc.max_length,ji=0;for(Rr=0;Rr<=W;Rr++)bn.bl_count[Rr]=0;for(Ar[2*bn.heap[bn.heap_max]+1]=0,Cn=bn.heap_max+1;Cn<j;Cn++)mi<(Rr=Ar[2*Ar[2*(xn=bn.heap[Cn])+1]+1]+1)&&(Rr=mi,ji++),Ar[2*xn+1]=Rr,fi<xn||(bn.bl_count[Rr]++,Wn=0,Li<=xn&&(Wn=zi[xn-Li]),Mn=Ar[2*xn],bn.opt_len+=Mn*(Rr+Wn),vr&&(bn.static_len+=Mn*(yo[2*xn+1]+Wn)));if(ji!==0){do{for(Rr=mi-1;bn.bl_count[Rr]===0;)Rr--;bn.bl_count[Rr]--,bn.bl_count[Rr+1]+=2,bn.bl_count[mi]--,ji-=2}while(0<ji);for(Rr=mi;Rr!==0;Rr--)for(xn=bn.bl_count[Rr];xn!==0;)fi<(Er=bn.heap[--Cn])||(Ar[2*Er+1]!==Rr&&(bn.opt_len+=(Rr-Ar[2*Er+1])*Ar[2*Er],Ar[2*Er+1]=Rr),xn--)}}(tt,nt),hn(an,ar,tt.bl_count)}function Ae(tt,nt,tn){var un,qt,an=-1,Jt=nt[1],Wt=0,Fn=7,ar=4;for(Jt===0&&(Fn=138,ar=3),nt[2*(tn+1)+1]=65535,un=0;un<=tn;un++)qt=Jt,Jt=nt[2*(un+1)+1],++Wt<Fn&&qt===Jt||(Wt<ar?tt.bl_tree[2*qt]+=Wt:qt!==0?(qt!==an&&tt.bl_tree[2*qt]++,tt.bl_tree[2*re]++):Wt<=10?tt.bl_tree[2*le]++:tt.bl_tree[2*_e]++,an=qt,ar=(Wt=0)===Jt?(Fn=138,3):qt===Jt?(Fn=6,3):(Fn=7,4))}function st(tt,nt,tn){var un,qt,an=-1,Jt=nt[1],Wt=0,Fn=7,ar=4;for(Jt===0&&(Fn=138,ar=3),un=0;un<=tn;un++)if(qt=Jt,Jt=nt[2*(un+1)+1],!(++Wt<Fn&&qt===Jt)){if(Wt<ar)for(;ft(tt,qt,tt.bl_tree),--Wt!=0;);else qt!==0?(qt!==an&&(ft(tt,qt,tt.bl_tree),Wt--),ft(tt,re,tt.bl_tree),Ue(tt,Wt-3,2)):Wt<=10?(ft(tt,le,tt.bl_tree),Ue(tt,Wt-3,3)):(ft(tt,_e,tt.bl_tree),Ue(tt,Wt-11,7));an=qt,ar=(Wt=0)===Jt?(Fn=138,3):qt===Jt?(Fn=6,3):(Fn=7,4)}}r(Re);var gt=!1;function ut(tt,nt,tn,un){Ue(tt,(C<<1)+(un?1:0),3),function(qt,an,Jt,Wt){en(qt),Ct(qt,Jt),Ct(qt,~Jt),u.arraySet(qt.pending_buf,qt.window,an,Jt,qt.pending),qt.pending+=Jt}(tt,nt,tn)}a._tr_init=function(tt){gt||(function(){var nt,tn,un,qt,an,Jt=new Array(W+1);for(qt=un=0;qt<k-1;qt++)for(we[qt]=un,nt=0;nt<1<<ye[qt];nt++)se[un++]=qt;for(se[un-1]=qt,qt=an=0;qt<16;qt++)for(Re[qt]=an,nt=0;nt<1<<de[qt];nt++)Ee[an++]=qt;for(an>>=7;qt<D;qt++)for(Re[qt]=an<<7,nt=0;nt<1<<de[qt]-7;nt++)Ee[256+an++]=qt;for(tn=0;tn<=W;tn++)Jt[tn]=0;for(nt=0;nt<=143;)xe[2*nt+1]=8,nt++,Jt[8]++;for(;nt<=255;)xe[2*nt+1]=9,nt++,Jt[9]++;for(;nt<=279;)xe[2*nt+1]=7,nt++,Jt[7]++;for(;nt<=287;)xe[2*nt+1]=8,nt++,Jt[8]++;for(hn(xe,P+1,Jt),nt=0;nt<D;nt++)he[2*nt+1]=5,he[2*nt]=Bt(nt,5);Se=new Oe(xe,ye,I+1,P,W),Pe=new Oe(he,de,0,D,W),Me=new Oe(new Array(0),ce,0,N,q)}(),gt=!0),tt.l_desc=new $e(tt.dyn_ltree,Se),tt.d_desc=new $e(tt.dyn_dtree,Pe),tt.bl_desc=new $e(tt.bl_tree,Me),tt.bi_buf=0,tt.bi_valid=0,ot(tt)},a._tr_stored_block=ut,a._tr_flush_block=function(tt,nt,tn,un){var qt,an,Jt=0;0<tt.level?(tt.strm.data_type===2&&(tt.strm.data_type=function(Wt){var Fn,ar=4093624447;for(Fn=0;Fn<=31;Fn++,ar>>>=1)if(1&ar&&Wt.dyn_ltree[2*Fn]!==0)return f;if(Wt.dyn_ltree[18]!==0||Wt.dyn_ltree[20]!==0||Wt.dyn_ltree[26]!==0)return _;for(Fn=32;Fn<I;Fn++)if(Wt.dyn_ltree[2*Fn]!==0)return _;return f}(tt)),Sn(tt,tt.l_desc),Sn(tt,tt.d_desc),Jt=function(Wt){var Fn;for(Ae(Wt,Wt.dyn_ltree,Wt.l_desc.max_code),Ae(Wt,Wt.dyn_dtree,Wt.d_desc.max_code),Sn(Wt,Wt.bl_desc),Fn=N-1;3<=Fn&&Wt.bl_tree[2*oe[Fn]+1]===0;Fn--);return Wt.opt_len+=3*(Fn+1)+5+5+4,Fn}(tt),qt=tt.opt_len+3+7>>>3,(an=tt.static_len+3+7>>>3)<=qt&&(qt=an)):qt=an=tn+5,tn+4<=qt&&nt!==-1?ut(tt,nt,tn,un):tt.strategy===4||an===qt?(Ue(tt,2+(un?1:0),3),We(tt,xe,he)):(Ue(tt,4+(un?1:0),3),function(Wt,Fn,ar,bn){var lr;for(Ue(Wt,Fn-257,5),Ue(Wt,ar-1,5),Ue(Wt,bn-4,4),lr=0;lr<bn;lr++)Ue(Wt,Wt.bl_tree[2*oe[lr]+1],3);st(Wt,Wt.dyn_ltree,Fn-1),st(Wt,Wt.dyn_dtree,ar-1)}(tt,tt.l_desc.max_code+1,tt.d_desc.max_code+1,Jt+1),We(tt,tt.dyn_ltree,tt.dyn_dtree)),ot(tt),un&&en(tt)},a._tr_tally=function(tt,nt,tn){return tt.pending_buf[tt.d_buf+2*tt.last_lit]=nt>>>8&255,tt.pending_buf[tt.d_buf+2*tt.last_lit+1]=255&nt,tt.pending_buf[tt.l_buf+tt.last_lit]=255&tn,tt.last_lit++,nt===0?tt.dyn_ltree[2*tn]++:(tt.matches++,nt--,tt.dyn_ltree[2*(se[tn]+I+1)]++,tt.dyn_dtree[2*Ke(nt)]++),tt.last_lit===tt.lit_bufsize-1},a._tr_align=function(tt){Ue(tt,2,3),ft(tt,Z,xe),function(nt){nt.bi_valid===16?(Ct(nt,nt.bi_buf),nt.bi_buf=0,nt.bi_valid=0):8<=nt.bi_valid&&(nt.pending_buf[nt.pending++]=255&nt.bi_buf,nt.bi_buf>>=8,nt.bi_valid-=8)}(tt)}},{"../utils/common":41}],53:[function(n,s,a){s.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(n,s,a){(function(u){(function(f,_){if(!f.setImmediate){var r,C,k,I,P=1,D={},N=!1,j=f.document,W=Object.getPrototypeOf&&Object.getPrototypeOf(f);W=W&&W.setTimeout?W:f,r={}.toString.call(f.process)==="[object process]"?function(re){process.nextTick(function(){q(re)})}:function(){if(f.postMessage&&!f.importScripts){var re=!0,le=f.onmessage;return f.onmessage=function(){re=!1},f.postMessage("","*"),f.onmessage=le,re}}()?(I="setImmediate$"+Math.random()+"$",f.addEventListener?f.addEventListener("message",Z,!1):f.attachEvent("onmessage",Z),function(re){f.postMessage(I+re,"*")}):f.MessageChannel?((k=new MessageChannel).port1.onmessage=function(re){q(re.data)},function(re){k.port2.postMessage(re)}):j&&"onreadystatechange"in j.createElement("script")?(C=j.documentElement,function(re){var le=j.createElement("script");le.onreadystatechange=function(){q(re),le.onreadystatechange=null,C.removeChild(le),le=null},C.appendChild(le)}):function(re){setTimeout(q,0,re)},W.setImmediate=function(re){typeof re!="function"&&(re=new Function(""+re));for(var le=new Array(arguments.length-1),_e=0;_e<le.length;_e++)le[_e]=arguments[_e+1];var ye={callback:re,args:le};return D[P]=ye,r(P),P++},W.clearImmediate=H}function H(re){delete D[re]}function q(re){if(N)setTimeout(q,0,re);else{var le=D[re];if(le){N=!0;try{(function(_e){var ye=_e.callback,de=_e.args;switch(de.length){case 0:ye();break;case 1:ye(de[0]);break;case 2:ye(de[0],de[1]);break;case 3:ye(de[0],de[1],de[2]);break;default:ye.apply(_,de)}})(le)}finally{H(re),N=!1}}}}function Z(re){re.source===f&&typeof re.data=="string"&&re.data.indexOf(I)===0&&q(+re.data.slice(I.length))}})(typeof self>"u"?u===void 0?this:u:self)}).call(this,typeof fl<"u"?fl:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(hV);var hue=hV.exports;const fue=yc(hue),pue=({open:e,onClose:t})=>{const{layers:n}=Lu(),{selectedLayerIds:s,deselectLayer:a}=$3(),u=n.filter(r=>s.includes(r.id)),f=r=>{a(r)},_=async()=>{const r=new fue;if(u.forEach(P=>{const D={type:"FeatureCollection",features:P.data.features||[]},N=`${P.name||"layer"}.geojson`;r.file(N,JSON.stringify(D,null,2))}),u.length===0){console.warn("No layers selected for download");return}const C=await r.generateAsync({type:"blob"}),k=URL.createObjectURL(C),I=document.createElement("a");I.href=k,I.download="geojson_layers.zip",document.body.appendChild(I),I.click(),document.body.removeChild(I),t()};return K.jsx(od,{open:e,onClose:t,header:"Download Selected Layers",submitLabel:"Download",onSubmit:_,disableSubmit:u.length===0,modalWidth:400,children:u.length===0?K.jsx(To,{children:"No layers selected for download"}):K.jsxs(Ci,{children:[K.jsx(To,{sx:{mb:2},children:"Do you want to download the following layers?"}),K.jsx(Ci,{sx:{maxHeight:"60vh",overflowY:"auto"},children:K.jsx(yA,{children:u.map(r=>K.jsxs(i8,{sx:{padding:1,backgroundColor:"rgba(255, 255, 255, 0.05)",marginBottom:"8px",borderRadius:"4px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[K.jsxs(Ci,{sx:{display:"flex",alignItems:"center",flex:1},children:[K.jsx(Ci,{sx:{display:"flex",alignItems:"center",justifyContent:"center",width:"30px",height:"30px",marginRight:"12px"},children:K.jsx(dV,{layerId:r.id,size:24})}),K.jsx(ep,{primary:r.name,sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",color:"white"}})]}),K.jsx(ga,{onClick:C=>{C.stopPropagation(),f(r.id)},"aria-label":"Remove from selection",sx:{color:"#ECAC7A","&:hover":{color:"#FF6F61"}},children:K.jsx(h1,{})})]},r.id))})})]})})},mue=({layers:e,selectedLayerId:t,setSelectedLayerId:n,toggleFilterRow:s,isFilterRowVisible:a})=>K.jsxs(Ci,{display:"flex",alignItems:"center",justifyContent:"center",mb:1,children:[K.jsx(Ci,{sx:{flex:2,alignItems:"center"},children:K.jsx(jh,{id:"layer-select",label:"Select layer to view attributes",value:t||"",options:e.map(u=>({value:u.id,label:u.name})),onChange:u=>n(u.target.value||null)})}),K.jsx(Ci,{sx:{flex:1,display:"flex",justifyContent:"center",mb:2},children:K.jsx(km,{id:"filter-button",variant:a?"outlined":"contained",startIcon:a?K.jsx(h1,{}):K.jsx(foe,{}),onClick:s,sx:{backgroundColor:a?void 0:"#A8D99C",color:a?"#ECAC7A":"#000",borderColor:a?"#ECAC7A":void 0,"&:hover":{backgroundColor:a?"rgba(236, 172, 122, 0.1)":"#89C287",borderColor:a?"#E59548":void 0}},children:a?"Close Filtering":"Filter on Attributes"})})]}),fV=X.createContext(void 0);function Bi(){const e=X.useContext(fV);if(e===void 0)throw new Error(["MUI X: Could not find the Data Grid context.","It looks like you rendered your component outside of a DataGrid, DataGridPro or DataGridPremium parent component.","This can also happen if you are bundling multiple versions of the Data Grid."].join(`
`));return e}const pV=X.createContext(void 0),Ur=()=>{const e=X.useContext(pV);if(!e)throw new Error("MUI X: useGridRootProps should only be used inside the DataGrid, DataGridPro or DataGridPremium component.");return e},gue=Object.is;function mV(e,t){if(e===t)return!0;if(!(e instanceof Object)||!(t instanceof Object))return!1;let n=0,s=0;for(const a in e)if(n+=1,!gue(e[a],t[a])||!(a in t))return!1;for(const a in t)s+=1;return n===s}function xp(e){return X.memo(e,mV)}const yue={noRowsLabel:"No rows",noResultsOverlayLabel:"No results found.",toolbarDensity:"Density",toolbarDensityLabel:"Density",toolbarDensityCompact:"Compact",toolbarDensityStandard:"Standard",toolbarDensityComfortable:"Comfortable",toolbarColumns:"Columns",toolbarColumnsLabel:"Select columns",toolbarFilters:"Filters",toolbarFiltersLabel:"Show filters",toolbarFiltersTooltipHide:"Hide filters",toolbarFiltersTooltipShow:"Show filters",toolbarFiltersTooltipActive:e=>e!==1?`${e} active filters`:`${e} active filter`,toolbarQuickFilterPlaceholder:"Search…",toolbarQuickFilterLabel:"Search",toolbarQuickFilterDeleteIconLabel:"Clear",toolbarExport:"Export",toolbarExportLabel:"Export",toolbarExportCSV:"Download as CSV",toolbarExportPrint:"Print",toolbarExportExcel:"Download as Excel",columnsManagementSearchTitle:"Search",columnsManagementNoColumns:"No columns",columnsManagementShowHideAllText:"Show/Hide All",columnsManagementReset:"Reset",filterPanelAddFilter:"Add filter",filterPanelRemoveAll:"Remove all",filterPanelDeleteIconLabel:"Delete",filterPanelLogicOperator:"Logic operator",filterPanelOperator:"Operator",filterPanelOperatorAnd:"And",filterPanelOperatorOr:"Or",filterPanelColumns:"Columns",filterPanelInputLabel:"Value",filterPanelInputPlaceholder:"Filter value",filterOperatorContains:"contains",filterOperatorDoesNotContain:"does not contain",filterOperatorEquals:"equals",filterOperatorDoesNotEqual:"does not equal",filterOperatorStartsWith:"starts with",filterOperatorEndsWith:"ends with",filterOperatorIs:"is",filterOperatorNot:"is not",filterOperatorAfter:"is after",filterOperatorOnOrAfter:"is on or after",filterOperatorBefore:"is before",filterOperatorOnOrBefore:"is on or before",filterOperatorIsEmpty:"is empty",filterOperatorIsNotEmpty:"is not empty",filterOperatorIsAnyOf:"is any of","filterOperator=":"=","filterOperator!=":"!=","filterOperator>":">","filterOperator>=":">=","filterOperator<":"<","filterOperator<=":"<=",headerFilterOperatorContains:"Contains",headerFilterOperatorDoesNotContain:"Does not contain",headerFilterOperatorEquals:"Equals",headerFilterOperatorDoesNotEqual:"Does not equal",headerFilterOperatorStartsWith:"Starts with",headerFilterOperatorEndsWith:"Ends with",headerFilterOperatorIs:"Is",headerFilterOperatorNot:"Is not",headerFilterOperatorAfter:"Is after",headerFilterOperatorOnOrAfter:"Is on or after",headerFilterOperatorBefore:"Is before",headerFilterOperatorOnOrBefore:"Is on or before",headerFilterOperatorIsEmpty:"Is empty",headerFilterOperatorIsNotEmpty:"Is not empty",headerFilterOperatorIsAnyOf:"Is any of","headerFilterOperator=":"Equals","headerFilterOperator!=":"Not equals","headerFilterOperator>":"Greater than","headerFilterOperator>=":"Greater than or equal to","headerFilterOperator<":"Less than","headerFilterOperator<=":"Less than or equal to",filterValueAny:"any",filterValueTrue:"true",filterValueFalse:"false",columnMenuLabel:"Menu",columnMenuShowColumns:"Show columns",columnMenuManageColumns:"Manage columns",columnMenuFilter:"Filter",columnMenuHideColumn:"Hide column",columnMenuUnsort:"Unsort",columnMenuSortAsc:"Sort by ASC",columnMenuSortDesc:"Sort by DESC",columnHeaderFiltersTooltipActive:e=>e!==1?`${e} active filters`:`${e} active filter`,columnHeaderFiltersLabel:"Show filters",columnHeaderSortIconLabel:"Sort",footerRowSelected:e=>e!==1?`${e.toLocaleString()} rows selected`:`${e.toLocaleString()} row selected`,footerTotalRows:"Total Rows:",footerTotalVisibleRows:(e,t)=>`${e.toLocaleString()} of ${t.toLocaleString()}`,checkboxSelectionHeaderName:"Checkbox selection",checkboxSelectionSelectAllRows:"Select all rows",checkboxSelectionUnselectAllRows:"Unselect all rows",checkboxSelectionSelectRow:"Select row",checkboxSelectionUnselectRow:"Unselect row",booleanCellTrueLabel:"yes",booleanCellFalseLabel:"no",actionsCellMore:"more",pinToLeft:"Pin to left",pinToRight:"Pin to right",unpin:"Unpin",treeDataGroupingHeaderName:"Group",treeDataExpand:"see children",treeDataCollapse:"hide children",groupingColumnHeaderName:"Group",groupColumn:e=>`Group by ${e}`,unGroupColumn:e=>`Stop grouping by ${e}`,detailPanelToggle:"Detail panel toggle",expandDetailPanel:"Expand",collapseDetailPanel:"Collapse",MuiTablePagination:{},rowReorderingHeaderName:"Row reordering",aggregationMenuItemHeader:"Aggregation",aggregationFunctionLabelSum:"sum",aggregationFunctionLabelAvg:"avg",aggregationFunctionLabelMin:"min",aggregationFunctionLabelMax:"max",aggregationFunctionLabelSize:"size"};function Gi(e){return gi("MuiDataGrid",e)}const xt=pi("MuiDataGrid",["actionsCell","aggregationColumnHeader","aggregationColumnHeader--alignLeft","aggregationColumnHeader--alignCenter","aggregationColumnHeader--alignRight","aggregationColumnHeaderLabel","autoHeight","autosizing","booleanCell","cell--editable","cell--editing","cell--flex","cell--textCenter","cell--textLeft","cell--textRight","cell--rangeTop","cell--rangeBottom","cell--rangeLeft","cell--rangeRight","cell--pinnedLeft","cell--pinnedRight","cell--selectionMode","cell","cellCheckbox","cellEmpty","cellSkeleton","cellOffsetLeft","checkboxInput","columnHeader","columnHeader--alignCenter","columnHeader--alignLeft","columnHeader--alignRight","columnHeader--dragging","columnHeader--moving","columnHeader--numeric","columnHeader--sortable","columnHeader--sorted","columnHeader--filtered","columnHeader--pinnedLeft","columnHeader--pinnedRight","columnHeader--last","columnHeader--lastUnpinned","columnHeader--siblingFocused","columnHeaderCheckbox","columnHeaderDraggableContainer","columnHeaderTitle","columnHeaderTitleContainer","columnHeaderTitleContainerContent","columnHeader--filledGroup","columnHeader--emptyGroup","columnHeaders","columnSeparator--resizable","columnSeparator--resizing","columnSeparator--sideLeft","columnSeparator--sideRight","columnSeparator","columnsManagement","columnsManagementRow","columnsManagementHeader","columnsManagementFooter","container--top","container--bottom","detailPanel","detailPanels","detailPanelToggleCell","detailPanelToggleCell--expanded","footerCell","panel","panelHeader","panelWrapper","panelContent","panelFooter","paper","editBooleanCell","editInputCell","filler","filler--borderBottom","filler--pinnedLeft","filler--pinnedRight","filterForm","filterFormDeleteIcon","filterFormLogicOperatorInput","filterFormColumnInput","filterFormOperatorInput","filterFormValueInput","filterIcon","footerContainer","headerFilterRow","iconButtonContainer","iconSeparator","main","main--hasPinnedRight","main--hasSkeletonLoadingOverlay","menu","menuIcon","menuIconButton","menuOpen","menuList","overlay","overlayWrapper","overlayWrapperInner","root","root--densityStandard","root--densityComfortable","root--densityCompact","root--disableUserSelection","root--noToolbar","row","row--editable","row--editing","row--firstVisible","row--lastVisible","row--dragging","row--dynamicHeight","row--detailPanelExpanded","row--borderBottom","rowReorderCellPlaceholder","rowCount","rowReorderCellContainer","rowReorderCell","rowReorderCell--draggable","rowSkeleton","scrollArea--left","scrollArea--right","scrollArea","scrollbar","scrollbar--vertical","scrollbar--horizontal","scrollbarFiller","scrollbarFiller--header","scrollbarFiller--borderTop","scrollbarFiller--borderBottom","scrollbarFiller--pinnedRight","selectedRowCount","sortIcon","toolbarContainer","toolbarFilterList","virtualScroller","virtualScroller--hasScrollX","virtualScrollerContent","virtualScrollerContent--overflowed","virtualScrollerRenderZone","pinnedColumns","withVerticalBorder","withBorderColor","cell--withRightBorder","cell--withLeftBorder","columnHeader--withRightBorder","columnHeader--withLeftBorder","treeDataGroupingCell","treeDataGroupingCellToggle","treeDataGroupingCellLoadingContainer","groupingCriteriaCell","groupingCriteriaCellToggle","groupingCriteriaCellLoadingContainer","pinnedRows","pinnedRows--top","pinnedRows--bottom","pinnedRowsRenderZone"]),M4=1e3;class _ue{constructor(t=M4){this.timeouts=new Map,this.cleanupTimeout=M4,this.cleanupTimeout=t}register(t,n,s){this.timeouts||(this.timeouts=new Map);const a=setTimeout(()=>{typeof n=="function"&&n(),this.timeouts.delete(s.cleanupToken)},this.cleanupTimeout);this.timeouts.set(s.cleanupToken,a)}unregister(t){const n=this.timeouts.get(t.cleanupToken);n&&(this.timeouts.delete(t.cleanupToken),clearTimeout(n))}reset(){this.timeouts&&(this.timeouts.forEach((t,n)=>{this.unregister({cleanupToken:n})}),this.timeouts=void 0)}}class vue{constructor(){this.registry=new FinalizationRegistry(t=>{typeof t=="function"&&t()})}register(t,n,s){this.registry.register(t,n,s)}unregister(t){this.registry.unregister(t)}reset(){}}var dc=function(e){return e.DataGrid="DataGrid",e.DataGridPro="DataGridPro",e.DataGridPremium="DataGridPremium",e}(dc||{});class xue{}function bue(e){let t=0;return function(s,a,u,f){e.registry===null&&(e.registry=typeof FinalizationRegistry<"u"?new vue:new _ue);const[_]=X.useState(new xue),r=X.useRef(null),C=X.useRef();C.current=u;const k=X.useRef(null);if(!r.current&&C.current){const I=(P,D,N)=>{var j;D.defaultMuiPrevented||(j=C.current)==null||j.call(C,P,D,N)};r.current=s.current.subscribeEvent(a,I,f),t+=1,k.current={cleanupToken:t},e.registry.register(_,()=>{var P;(P=r.current)==null||P.call(r),r.current=null,k.current=null},k.current)}else!C.current&&r.current&&(r.current(),r.current=null,k.current&&(e.registry.unregister(k.current),k.current=null));X.useEffect(()=>{if(!r.current&&C.current){const I=(P,D,N)=>{var j;D.defaultMuiPrevented||(j=C.current)==null||j.call(C,P,D,N)};r.current=s.current.subscribeEvent(a,I,f)}return k.current&&e.registry&&(e.registry.unregister(k.current),k.current=null),()=>{var I;(I=r.current)==null||I.call(r),r.current=null}},[s,a,f])}}const wue={registry:null},Lr=bue(wue),Sue={isFirst:!0};function Vo(e,t,n){Lr(e,t,n,Sue)}function Cue(e){return e.acceptsApiRef}function P4(e,t){return Cue(t)?t(e):t(e.current.state)}const Eue=Object.is,gV=mV,Tue=()=>({state:null,equals:null,selector:null}),Kn=(e,t,n=Eue)=>{const s=id(Tue),a=s.current.selector!==null,[u,f]=X.useState(a?null:P4(e,t));return s.current.state=u,s.current.equals=n,s.current.selector=t,CE(()=>e.current.store.subscribe(()=>{const _=P4(e,s.current.selector);s.current.equals(s.current.state,_)||(s.current.state=_,f(_))})),u},Ga=e=>e.dimensions;var vC=Symbol("NOT_FOUND");function Iue(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function kue(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function Mue(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(n=>typeof n=="function")){const n=e.map(s=>typeof s=="function"?`function ${s.name||"unnamed"}()`:typeof s).join(", ");throw new TypeError(`${t}[${n}]`)}}var A4=e=>Array.isArray(e)?e:[e];function Pue(e){const t=Array.isArray(e[0])?e[0]:e;return Mue(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function Aue(e,t){const n=[],{length:s}=e;for(let a=0;a<s;a++)n.push(e[a].apply(null,t));return n}function Lue(e){let t;return{get(n){return t&&e(t.key,n)?t.value:vC},put(n,s){t={key:n,value:s}},getEntries(){return t?[t]:[]},clear(){t=void 0}}}function Rue(e,t){let n=[];function s(_){const r=n.findIndex(C=>t(_,C.key));if(r>-1){const C=n[r];return r>0&&(n.splice(r,1),n.unshift(C)),C.value}return vC}function a(_,r){s(_)===vC&&(n.unshift({key:_,value:r}),n.length>e&&n.pop())}function u(){return n}function f(){n=[]}return{get:s,put:a,getEntries:u,clear:f}}var Oue=(e,t)=>e===t;function Due(e){return function(n,s){if(n===null||s===null||n.length!==s.length)return!1;const{length:a}=n;for(let u=0;u<a;u++)if(!e(n[u],s[u]))return!1;return!0}}function yV(e,t){const n=typeof t=="object"?t:{equalityCheck:t},{equalityCheck:s=Oue,maxSize:a=1,resultEqualityCheck:u}=n,f=Due(s);let _=0;const r=a<=1?Lue(f):Rue(a,f);function C(){let k=r.get(arguments);if(k===vC){if(k=e.apply(null,arguments),_++,u){const P=r.getEntries().find(D=>u(D.value,k));P&&(k=P.value,_!==0&&_--)}r.put(arguments,k)}return k}return C.clearCache=()=>{r.clear(),C.resetResultsCount()},C.resultsCount=()=>_,C.resetResultsCount=()=>{_=0},C}var zue=class{constructor(e){this.value=e}deref(){return this.value}},Fue=typeof WeakRef<"u"?WeakRef:zue,Nue=0,L4=1;function Hw(){return{s:Nue,v:void 0,o:null,p:null}}function _V(e,t={}){let n=Hw();const{resultEqualityCheck:s}=t;let a,u=0;function f(){var I;let _=n;const{length:r}=arguments;for(let P=0,D=r;P<D;P++){const N=arguments[P];if(typeof N=="function"||typeof N=="object"&&N!==null){let j=_.o;j===null&&(_.o=j=new WeakMap);const W=j.get(N);W===void 0?(_=Hw(),j.set(N,_)):_=W}else{let j=_.p;j===null&&(_.p=j=new Map);const W=j.get(N);W===void 0?(_=Hw(),j.set(N,_)):_=W}}const C=_;let k;if(_.s===L4)k=_.v;else if(k=e.apply(null,arguments),u++,s){const P=((I=a==null?void 0:a.deref)==null?void 0:I.call(a))??a;P!=null&&s(P,k)&&(k=P,u!==0&&u--),a=typeof k=="object"&&k!==null||typeof k=="function"?new Fue(k):k}return C.s=L4,C.v=k,k}return f.clearCache=()=>{n=Hw(),f.resetResultsCount()},f.resultsCount=()=>u,f.resetResultsCount=()=>{u=0},f}function vV(e,...t){const n=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,s=(...a)=>{let u=0,f=0,_,r={},C=a.pop();typeof C=="object"&&(r=C,C=a.pop()),Iue(C,`createSelector expects an output function after the inputs, but received: [${typeof C}]`);const k={...n,...r},{memoize:I,memoizeOptions:P=[],argsMemoize:D=_V,argsMemoizeOptions:N=[],devModeChecks:j={}}=k,W=A4(P),H=A4(N),q=Pue(a),Z=I(function(){return u++,C.apply(null,arguments)},...W),re=D(function(){f++;const _e=Aue(q,arguments);return _=Z.apply(null,_e),_},...H);return Object.assign(re,{resultFunc:C,memoizedResultFunc:Z,dependencies:q,dependencyRecomputations:()=>f,resetDependencyRecomputations:()=>{f=0},lastResult:()=>_,recomputations:()=>u,resetRecomputations:()=>{u=0},memoize:I,argsMemoize:D})};return Object.assign(s,{withTypes:()=>s}),s}var Bue=vV(_V),jue=Object.assign((e,t=Bue)=>{kue(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const n=Object.keys(e),s=n.map(u=>e[u]);return t(s,(...u)=>u.reduce((f,_,r)=>(f[n[r]]=_,f),{}))},{withTypes:()=>jue});const Vue=vV({memoize:yV,memoizeOptions:{maxSize:1,equalityCheck:Object.is}}),R4=new WeakMap;function ry(e){return"current"in e&&"instanceId"in e.current}const iy={id:"default"},ui=(e,t,n,s,a,u,...f)=>{if(f.length>0)throw new Error("Unsupported number of selectors");let _;if(e&&t&&n&&s&&a&&u)_=(r,C)=>{const k=ry(r),I=C??(k?r.current.instanceId:iy),P=k?r.current.state:r,D=e(P,I),N=t(P,I),j=n(P,I),W=s(P,I),H=a(P,I);return u(D,N,j,W,H)};else if(e&&t&&n&&s&&a)_=(r,C)=>{const k=ry(r),I=C??(k?r.current.instanceId:iy),P=k?r.current.state:r,D=e(P,I),N=t(P,I),j=n(P,I),W=s(P,I);return a(D,N,j,W)};else if(e&&t&&n&&s)_=(r,C)=>{const k=ry(r),I=C??(k?r.current.instanceId:iy),P=k?r.current.state:r,D=e(P,I),N=t(P,I),j=n(P,I);return s(D,N,j)};else if(e&&t&&n)_=(r,C)=>{const k=ry(r),I=C??(k?r.current.instanceId:iy),P=k?r.current.state:r,D=e(P,I),N=t(P,I);return n(D,N)};else if(e&&t)_=(r,C)=>{const k=ry(r),I=C??(k?r.current.instanceId:iy),P=k?r.current.state:r,D=e(P,I);return t(D)};else throw new Error("Missing arguments");return _.acceptsApiRef=!0,_},Ro=(...e)=>{const t=(n,s)=>{const a=ry(n),u=a?n.current.instanceId:s??iy,f=a?n.current.state:n,_=R4.get(u),r=_??new Map,C=r==null?void 0:r.get(e);if(r&&C)return C(f,u);const k=Vue(...e);return _||R4.set(u,r),r.set(e,k),k(f,u)};return t.acceptsApiRef=!0,t},$ue=.7,Uue=1.3,Gue={compact:$ue,comfortable:Uue,standard:1},Sy=e=>e.density,w1=ui(Sy,e=>Gue[e]);let Go=function(e){return e.LEFT="left",e.RIGHT="right",e}({});const LP={left:[],right:[]},Hue=e=>e.isRtl,Hd=e=>e.columns,Ph=ui(Hd,e=>e.orderedFields),Hh=ui(Hd,e=>e.lookup),Qc=Ro(Ph,Hh,(e,t)=>e.map(n=>t[n])),lc=ui(Hd,e=>e.columnVisibilityModel),ua=Ro(Qc,lc,(e,t)=>e.filter(n=>t[n.field]!==!1)),T0=Ro(ua,e=>e.map(t=>t.field)),Wue=e=>e.pinnedColumns,S1=Ro(Hd,Wue,T0,Hue,(e,t,n,s)=>{const a=que(t,n,s);return{left:a.left.map(f=>e.lookup[f]),right:a.right.map(f=>e.lookup[f])}});function que(e,t,n){var _,r;if(!Array.isArray(e.left)&&!Array.isArray(e.right)||((_=e.left)==null?void 0:_.length)===0&&((r=e.right)==null?void 0:r.length)===0)return LP;const s=(C,k)=>Array.isArray(C)?C.filter(I=>k.includes(I)):[],a=s(e.left,t),u=t.filter(C=>!a.includes(C)),f=s(e.right,u);return n?{left:f,right:a}:{left:a,right:f}}const bp=Ro(ua,e=>{const t=[];let n=0;for(let s=0;s<e.length;s+=1)t.push(n),n+=e[s].computedWidth;return t}),RA=ui(ua,bp,(e,t)=>{const n=e.length;return n===0?0:t[n-1]+e[n-1].computedWidth}),xV=Ro(Qc,e=>e.filter(t=>t.filterable)),Xue=Ro(Qc,e=>e.reduce((t,n)=>(n.filterable&&(t[n.field]=n),t),{})),Yue=Ro(Qc,e=>e.some(t=>t.colSpan!==void 0)),Zue=["id","value","formattedValue","api","field","row","rowNode","colDef","cellMode","isEditable","tabIndex","hasFocus","isValidating","debounceMs","isProcessingProps","onValueChange"],Kue=e=>{const{classes:t}=e;return yr({root:["editInputCell"]},Gi,t)},Jue=Dn(w0,{name:"MuiDataGrid",slot:"EditInputCell",overridesResolver:(e,t)=>t.editInputCell})(({theme:e})=>Ge({},e.typography.body2,{padding:"1px 0","& input":{padding:"0 16px",height:"100%"}})),Que=X.forwardRef((e,t)=>{const n=Ur(),{id:s,value:a,field:u,colDef:f,hasFocus:_,debounceMs:r=200,isProcessingProps:C,onValueChange:k}=e,I=Zr(e,Zue),P=Bi(),D=X.useRef(),[N,j]=X.useState(a),W=Kue(n),H=X.useCallback(async Z=>{const re=Z.target.value;k&&await k(Z,re);const le=P.current.getColumn(u);let _e=re;le.valueParser&&(_e=le.valueParser(re,P.current.getRow(s),le,P)),j(_e),P.current.setEditCellValue({id:s,field:u,value:_e,debounceMs:r,unstable_skipValueParser:!0},Z)},[P,r,u,s,k]),q=P.current.unstable_getEditCellMeta(s,u);return X.useEffect(()=>{(q==null?void 0:q.changeReason)!=="debouncedSetEditCellValue"&&j(a)},[q,a]),Io(()=>{_&&D.current.focus()},[_]),K.jsx(Jue,Ge({ref:t,inputRef:D,className:W.root,ownerState:n,fullWidth:!0,type:f.type==="number"?f.type:"text",value:N??"",onChange:H,endAdornment:C?K.jsx(n.slots.loadIcon,{fontSize:"small",color:"action"}):void 0},I))}),ece=e=>K.jsx(Que,Ge({},e)),bV=(e,t)=>t&&e.length>1?[e[0]]:e,O4=(e,t)=>n=>Ge({},n,{sorting:Ge({},n.sorting,{sortModel:bV(e,t)})}),tce=e=>e==="desc",nce=(e,t)=>{const n=t.current.getColumn(e.field);if(!n||e.sort===null)return null;let s;return n.getSortComparator?s=n.getSortComparator(e.sort):s=tce(e.sort)?(...u)=>-1*n.sortComparator(...u):n.sortComparator,s?{getSortCellParams:u=>({id:u,field:n.field,rowNode:t.current.getRowNode(u),value:t.current.getCellValue(u,n.field),api:t.current}),comparator:s}:null},rce=(e,t,n)=>e.reduce((s,a,u)=>{if(s!==0)return s;const f=t.params[u],_=n.params[u];return s=a.comparator(f.value,_.value,f,_),s},0),ice=(e,t)=>{const n=e.map(s=>nce(s,t)).filter(s=>!!s);return n.length===0?null:s=>s.map(a=>({node:a,params:n.map(u=>u.getSortCellParams(a.id))})).sort((a,u)=>rce(n,a,u)).map(a=>a.node.id)},D4=(e,t)=>{const n=e.indexOf(t);return!t||n===-1||n+1===e.length?e[0]:e[n+1]},OA=(e,t)=>e==null&&t!=null?-1:t==null&&e!=null?1:e==null&&t==null?0:null,oce=new Intl.Collator,sce=(e,t)=>{const n=OA(e,t);return n!==null?n:typeof e=="string"?oce.compare(e.toString(),t.toString()):e-t},wV=(e,t)=>{const n=OA(e,t);return n!==null?n:Number(e)-Number(t)},SV=(e,t)=>{const n=OA(e,t);return n!==null?n:e>t?1:e<t?-1:0},ace=["item","applyValue","type","apiRef","focusElementRef","tabIndex","disabled","isFilterActive","clearButton","InputProps","variant"];function oc(e){var re;const{item:t,applyValue:n,type:s,apiRef:a,focusElementRef:u,tabIndex:f,disabled:_,clearButton:r,InputProps:C,variant:k="standard"}=e,I=Zr(e,ace),P=Eu(),[D,N]=X.useState(t.value??""),[j,W]=X.useState(!1),H=ls(),q=Ur(),Z=X.useCallback(le=>{const{value:_e}=le.target;N(String(_e)),W(!0),P.start(q.filterDebounceMs,()=>{const ye=Ge({},t,{value:s==="number"?Number(_e):_e,fromInput:H});n(ye),W(!1)})},[P,q.filterDebounceMs,t,s,H,n]);return X.useEffect(()=>{(t.fromInput!==H||t.value===void 0)&&N(String(t.value??""))},[H,t]),K.jsx(q.slots.baseTextField,Ge({id:H,label:a.current.getLocaleText("filterPanelInputLabel"),placeholder:a.current.getLocaleText("filterPanelInputPlaceholder"),value:D,onChange:Z,variant:k,type:s||"text",InputProps:Ge({},j||r?{endAdornment:j?K.jsx(q.slots.loadIcon,{fontSize:"small",color:"action"}):r}:{},{disabled:_},C,{inputProps:Ge({tabIndex:f},C==null?void 0:C.inputProps)}),InputLabelProps:{shrink:!0},inputRef:u},I,(re=q.slotProps)==null?void 0:re.baseTextField))}function lce(e){return typeof e=="number"&&!Number.isNaN(e)}function CV(e){return typeof e=="function"}function DA(e){return typeof e=="object"&&e!==null}function uce(){try{const e="__some_random_key_you_are_not_going_to_use__";return window.localStorage.setItem(e,e),window.localStorage.removeItem(e),!0}catch{return!1}}function xC(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}const Wd=(e,t,n)=>Math.max(t,Math.min(n,e));function z4(e,t){return Array.from({length:t-e}).map((n,s)=>e+s)}function Fy(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;if(Array.isArray(e)){const a=e.length;if(a!==t.length)return!1;for(let u=0;u<a;u+=1)if(!Fy(e[u],t[u]))return!1;return!0}if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;const a=Array.from(e.entries());for(let u=0;u<a.length;u+=1)if(!t.has(a[u][0]))return!1;for(let u=0;u<a.length;u+=1){const f=a[u];if(!Fy(f[1],t.get(f[0])))return!1}return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;const a=Array.from(e.entries());for(let u=0;u<a.length;u+=1)if(!t.has(a[u][0]))return!1;return!0}if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){const a=e.length;if(a!==t.length)return!1;for(let u=0;u<a;u+=1)if(e[u]!==t[u])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();const n=Object.keys(e),s=n.length;if(s!==Object.keys(t).length)return!1;for(let a=0;a<s;a+=1)if(!Object.prototype.hasOwnProperty.call(t,n[a]))return!1;for(let a=0;a<s;a+=1){const u=n[a];if(!Fy(e[u],t[u]))return!1}return!0}return e!==e&&t!==t}function cce(e){return()=>{let t=e+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296}}function dce(e){const t=cce(e);return(n,s)=>n+(s-n)*t()}function EV(e){return typeof structuredClone=="function"?structuredClone(e):JSON.parse(JSON.stringify(e))}const hce=["item","applyValue","type","apiRef","focusElementRef","color","error","helperText","size","variant"],fce=["key"];function TV(e){const{item:t,applyValue:n,type:s,apiRef:a,focusElementRef:u,color:f,error:_,helperText:r,size:C,variant:k="standard"}=e,I=Zr(e,hce),P={color:f,error:_,helperText:r,size:C,variant:k},[D,N]=X.useState(t.value||[]),j=ls(),W=Ur();X.useEffect(()=>{const q=t.value??[];N(q.map(String))},[t.value]);const H=X.useCallback((q,Z)=>{N(Z.map(String)),n(Ge({},t,{value:[...Z.map(re=>s==="number"?Number(re):re)]}))},[n,t,s]);return K.jsx(Xj,Ge({multiple:!0,freeSolo:!0,options:[],filterOptions:(q,Z)=>{const{inputValue:re}=Z;return re==null||re===""?[]:[re]},id:j,value:D,onChange:H,renderTags:(q,Z)=>q.map((re,le)=>{const _e=Z({index:le}),{key:ye}=_e,de=Zr(_e,fce);return K.jsx(W.slots.baseChip,Ge({variant:"outlined",size:"small",label:re},de),ye)}),renderInput:q=>{var Z;return K.jsx(W.slots.baseTextField,Ge({},q,{label:a.current.getLocaleText("filterPanelInputLabel"),placeholder:a.current.getLocaleText("filterPanelInputPlaceholder"),InputLabelProps:Ge({},q.InputLabelProps,{shrink:!0}),inputRef:u,type:s||"text"},P,(Z=W.slotProps)==null?void 0:Z.baseTextField))}},I))}var Kd=function(e){return e.Cell="cell",e.Row="row",e}(Kd||{}),Co=function(e){return e.Edit="edit",e.View="view",e}(Co||{}),jo=function(e){return e.Edit="edit",e.View="view",e}(jo||{}),Ll=function(e){return e.And="and",e.Or="or",e}(Ll||{}),xh=function(e){return e.enterKeyDown="enterKeyDown",e.cellDoubleClick="cellDoubleClick",e.printableKeyDown="printableKeyDown",e.deleteKeyDown="deleteKeyDown",e.pasteKeyDown="pasteKeyDown",e}(xh||{}),Uc=function(e){return e.cellFocusOut="cellFocusOut",e.escapeKeyDown="escapeKeyDown",e.enterKeyDown="enterKeyDown",e.tabKeyDown="tabKeyDown",e.shiftTabKeyDown="shiftTabKeyDown",e}(Uc||{}),Pf=function(e){return e.enterKeyDown="enterKeyDown",e.cellDoubleClick="cellDoubleClick",e.printableKeyDown="printableKeyDown",e.deleteKeyDown="deleteKeyDown",e}(Pf||{}),Md=function(e){return e.rowFocusOut="rowFocusOut",e.escapeKeyDown="escapeKeyDown",e.enterKeyDown="enterKeyDown",e.tabKeyDown="tabKeyDown",e.shiftTabKeyDown="shiftTabKeyDown",e}(Md||{});function IV(e){return e.field!==void 0}const Wx=()=>({items:[],logicOperator:Ll.And,quickFilterValues:[],quickFilterLogicOperator:Ll.And});function kV(e){return{current:e.current.getPublicApi()}}let Lv;function pce(){if(Lv!==void 0)return Lv;try{Lv=new Function("return true")()}catch{Lv=!1}return Lv}const RP=(e,t)=>{const n=Ge({},e);if(n.id==null&&(n.id=Math.round(Math.random()*1e5)),n.operator==null){const s=Hh(t)[n.field];n.operator=s&&s.filterOperators[0].value}return n},zA=(e,t,n)=>{const s=e.items.length>1;let a;s&&t?a=[e.items[0]]:a=e.items;const u=s&&a.some(_=>_.id==null);return a.some(_=>_.operator==null)||u?Ge({},e,{items:a.map(_=>RP(_,n))}):e.items!==a?Ge({},e,{items:a}):e},F4=(e,t,n)=>s=>Ge({},s,{filterModel:zA(e,t,n)}),qx=e=>typeof e=="string"?e.normalize("NFD").replace(/[\u0300-\u036f]/g,""):e,MV=(e,t)=>{var k;if(!e.field||!e.operator)return null;const n=t.current.getColumn(e.field);if(!n)return null;let s;if(n.valueParser){const I=n.valueParser;s=Array.isArray(e.value)?(k=e.value)==null?void 0:k.map(P=>I(P,void 0,n,t)):I(e.value,void 0,n,t)}else s=e.value;const{ignoreDiacritics:a}=t.current.rootProps;a&&(s=qx(s));const u=Ge({},e,{value:s}),f=n.filterOperators;if(!(f!=null&&f.length))throw new Error(`MUI X: No filter operators found for column '${n.field}'.`);const _=f.find(I=>I.value===u.operator);if(!_)throw new Error(`MUI X: No filter operator found for column '${n.field}' and operator value '${u.operator}'.`);const r=kV(t),C=_.getApplyFilterFn(u,n);return typeof C!="function"?null:{item:u,fn:I=>{let P=t.current.getRowValue(I,n);return a&&(P=qx(P)),C(P,I,n,r)}}};let N4=1;const mce=(e,t,n)=>{const{items:s}=e,a=s.map(_=>MV(_,t)).filter(_=>!!_);if(a.length===0)return null;if(n||!pce())return(_,r)=>{const C={};for(let k=0;k<a.length;k+=1){const I=a[k];(!r||r(I.item.field))&&(C[I.item.id]=I.fn(_))}return C};const u=new Function("appliers","row","shouldApplyFilter",`"use strict";
${a.map((_,r)=>`const shouldApply${r} = !shouldApplyFilter || shouldApplyFilter(${JSON.stringify(_.item.field)});`).join(`
`)}

const result$$ = {
${a.map((_,r)=>`  ${JSON.stringify(String(_.item.id))}: !shouldApply${r} ? false : appliers[${r}].fn(row),`).join(`
`)}
};

return result$$;`.replaceAll("$$",String(N4)));return N4+=1,(_,r)=>u(a,_,r)},PV=e=>e.quickFilterExcludeHiddenColumns??!0,gce=(e,t)=>{var _;const n=((_=e.quickFilterValues)==null?void 0:_.filter(Boolean))??[];if(n.length===0)return null;const s=PV(e)?T0(t):Ph(t),a=[],{ignoreDiacritics:u}=t.current.rootProps,f=kV(t);return s.forEach(r=>{const C=t.current.getColumn(r),k=C==null?void 0:C.getApplyQuickFilterFn;k&&a.push({column:C,appliers:n.map(I=>{const P=u?qx(I):I;return{fn:k(P,C,f)}})})}),function(C,k){const I={};e:for(let P=0;P<n.length;P+=1){const D=n[P];for(let N=0;N<a.length;N+=1){const{column:j,appliers:W}=a[N],{field:H}=j;if(k&&!k(H))continue;const q=W[P];let Z=t.current.getRowValue(C,j);if(q.fn===null)continue;if(u&&(Z=qx(Z)),q.fn(Z,C,j,f)){I[D]=!0;continue e}}I[D]=!1}return I}},yce=(e,t,n)=>{const s=mce(e,t,n),a=gce(e,t);return function(f,_,r){r.passingFilterItems=(s==null?void 0:s(f,_))??null,r.passingQuickFilterValues=(a==null?void 0:a(f,_))??null}},B4=e=>e!=null,_ce=(e,t,n)=>(e.cleanedFilterItems||(e.cleanedFilterItems=n.filter(s=>MV(s,t)!==null)),e.cleanedFilterItems),vce=(e,t,n,s,a)=>{const u=_ce(a,s,n.items),f=e.filter(B4),_=t.filter(B4);if(f.length>0){const r=k=>f.some(I=>I[k.id]);if((n.logicOperator??Wx().logicOperator)===Ll.And){if(!u.every(r))return!1}else if(!u.some(r))return!1}if(_.length>0&&n.quickFilterValues!=null){const r=k=>_.some(I=>I[k]);if((n.quickFilterLogicOperator??Wx().quickFilterLogicOperator)===Ll.And){if(!n.quickFilterValues.every(r))return!1}else if(!n.quickFilterValues.some(r))return!1}return!0},xce=e=>{if(!e)return null;const t=new RegExp(xC(e),"i");return(n,s,a,u)=>{let f=u.current.getRowFormattedValue(s,a);return u.current.ignoreDiacritics&&(f=qx(f)),f!=null?t.test(f.toString()):!1}},j4=(e,t)=>n=>{if(!n.value)return null;const s=e?n.value:n.value.trim(),a=new RegExp(xC(s),"i");return u=>{if(u==null)return t;const f=a.test(String(u));return t?!f:f}},V4=(e,t)=>n=>{if(!n.value)return null;const s=e?n.value:n.value.trim(),a=new Intl.Collator(void 0,{sensitivity:"base",usage:"search"});return u=>{if(u==null)return t;const f=a.compare(s,u.toString())===0;return t?!f:f}},$4=e=>()=>t=>{const n=t===""||t==null;return e?!n:n},bce=(e=!1)=>[{value:"contains",getApplyFilterFn:j4(e,!1),InputComponent:oc},{value:"doesNotContain",getApplyFilterFn:j4(e,!0),InputComponent:oc},{value:"equals",getApplyFilterFn:V4(e,!1),InputComponent:oc},{value:"doesNotEqual",getApplyFilterFn:V4(e,!0),InputComponent:oc},{value:"startsWith",getApplyFilterFn:t=>{if(!t.value)return null;const n=e?t.value:t.value.trim(),s=new RegExp(`^${xC(n)}.*$`,"i");return a=>a!=null?s.test(a.toString()):!1},InputComponent:oc},{value:"endsWith",getApplyFilterFn:t=>{if(!t.value)return null;const n=e?t.value:t.value.trim(),s=new RegExp(`.*${xC(n)}$`,"i");return a=>a!=null?s.test(a.toString()):!1},InputComponent:oc},{value:"isEmpty",getApplyFilterFn:$4(!1),requiresFilterValue:!1},{value:"isNotEmpty",getApplyFilterFn:$4(!0),requiresFilterValue:!1},{value:"isAnyOf",getApplyFilterFn:t=>{if(!Array.isArray(t.value)||t.value.length===0)return null;const n=e?t.value:t.value.map(a=>a.trim()),s=new Intl.Collator(void 0,{sensitivity:"base",usage:"search"});return a=>a!=null?n.some(u=>s.compare(u,a.toString()||"")===0):!1},InputComponent:TV}],ed={width:100,minWidth:50,maxWidth:1/0,hideable:!0,sortable:!0,resizable:!0,filterable:!0,groupable:!0,pinnable:!0,aggregable:!0,editable:!1,sortComparator:sce,type:"string",align:"left",filterOperators:bce(),renderEditCell:ece,getApplyQuickFilterFn:xce},wce=["open","target","onClose","children","position","className","onExited"],Sce=e=>{const{classes:t}=e;return yr({root:["menu"]},Gi,t)},Cce=Dn(Nm,{name:"MuiDataGrid",slot:"Menu",overridesResolver:(e,t)=>t.menu})(({theme:e})=>({zIndex:e.zIndex.modal,[`& .${xt.menuList}`]:{outline:0}})),Ece={"bottom-start":"top left","bottom-end":"top right"};function AV(e){var j;const{open:t,target:n,onClose:s,children:a,position:u,className:f,onExited:_}=e,r=Zr(e,wce),C=Bi(),k=Ur(),I=Sce(k),P=X.useRef(null);Io(()=>{var W,H;t?P.current=document.activeElement instanceof HTMLElement?document.activeElement:null:((H=(W=P.current)==null?void 0:W.focus)==null||H.call(W),P.current=null)},[t]),X.useEffect(()=>{const W=t?"menuOpen":"menuClose";C.current.publishEvent(W,{target:n})},[C,t,n]);const D=W=>H=>{W&&W(),_&&_(H)},N=W=>{W.target&&(n===W.target||n!=null&&n.contains(W.target))||s(W)};return K.jsx(Cce,Ge({as:k.slots.basePopper,className:Hn(I.root,f),ownerState:k,open:t,anchorEl:n,transition:!0,placement:u},r,(j=k.slotProps)==null?void 0:j.basePopper,{children:({TransitionProps:W,placement:H})=>K.jsx(Qj,{onClickAway:N,mouseEvent:"onMouseDown",children:K.jsx(i0,Ge({},W,{style:{transformOrigin:Ece[H]},onExited:D(W==null?void 0:W.onExited),children:K.jsx(b0,{children:a})}))})}))}const Tce=["api","colDef","id","hasFocus","isEditable","field","value","formattedValue","row","rowNode","cellMode","tabIndex","position","focusElementRef"],Ice=e=>typeof e.getActions=="function";function kce(e){var we;const{colDef:t,id:n,hasFocus:s,tabIndex:a,position:u="bottom-end",focusElementRef:f}=e,_=Zr(e,Tce),[r,C]=X.useState(-1),[k,I]=X.useState(!1),P=Bi(),D=X.useRef(null),N=X.useRef(null),j=X.useRef(!1),W=X.useRef({}),H=au(),q=ls(),Z=ls(),re=Ur();if(!Ice(t))throw new Error("MUI X: Missing the `getActions` property in the `GridColDef`.");const le=t.getActions(P.current.getRowParams(n)),_e=le.filter(Se=>!Se.props.showInMenu),ye=le.filter(Se=>Se.props.showInMenu),de=_e.length+(ye.length?1:0);X.useLayoutEffect(()=>{s||Object.entries(W.current).forEach(([Se,Pe])=>{Pe==null||Pe.stop({},()=>{delete W.current[Se]})})},[s]),X.useEffect(()=>{if(r<0||!D.current||r>=D.current.children.length)return;D.current.children[r].focus({preventScroll:!0})},[r]),X.useEffect(()=>{s||(C(-1),j.current=!1)},[s]),X.useImperativeHandle(f,()=>({focus(){if(!j.current){const Se=le.findIndex(Pe=>!Pe.props.disabled);C(Se)}}}),[le]),X.useEffect(()=>{r>=de&&C(de-1)},[r,de]);const ce=()=>{I(!0),C(de-1),j.current=!0},oe=()=>{I(!1)},xe=Se=>Pe=>{W.current[Se]=Pe},he=(Se,Pe)=>Me=>{C(Se),j.current=!0,Pe&&Pe(Me)},Ee=Se=>{if(de<=1)return;const Pe=(Re,Oe)=>{var Ct;if(Re<0||Re>le.length)return Re;const Ke=(Oe==="left"?-1:1)*(H?-1:1);return(Ct=le[Re+Ke])!=null&&Ct.props.disabled?Pe(Re+Ke,Oe):Re+Ke};let Me=r;Se.key==="ArrowRight"?Me=Pe(r,"right"):Se.key==="ArrowLeft"&&(Me=Pe(r,"left")),!(Me<0||Me>=de)&&Me!==r&&(Se.preventDefault(),Se.stopPropagation(),C(Me))},se=Se=>{Se.key==="Tab"&&Se.preventDefault(),["Tab","Escape"].includes(Se.key)&&oe()};return K.jsxs("div",Ge({role:"menu",ref:D,tabIndex:-1,className:xt.actionsCell,onKeyDown:Ee},_,{children:[_e.map((Se,Pe)=>X.cloneElement(Se,{key:Pe,touchRippleRef:xe(Pe),onClick:he(Pe,Se.props.onClick),tabIndex:r===Pe?a:-1})),ye.length>0&&Z&&K.jsx(re.slots.baseIconButton,Ge({ref:N,id:Z,"aria-label":P.current.getLocaleText("actionsCellMore"),"aria-haspopup":"menu","aria-expanded":k,"aria-controls":k?q:void 0,role:"menuitem",size:"small",onClick:ce,touchRippleRef:xe(Z),tabIndex:r===_e.length?a:-1},(we=re.slotProps)==null?void 0:we.baseIconButton,{children:K.jsx(re.slots.moreActionsIcon,{fontSize:"small"})})),ye.length>0&&K.jsx(AV,{open:k,target:N.current,position:u,onClose:oe,children:K.jsx(_A,{id:q,className:xt.menuList,onKeyDown:se,"aria-labelledby":Z,variant:"menu",autoFocusItem:!0,children:ye.map((Se,Pe)=>X.cloneElement(Se,{key:Pe,closeMenu:oe}))})})]}))}const Mce=e=>K.jsx(kce,Ge({},e)),VE="actions",Pce=Ge({},ed,{sortable:!1,filterable:!1,aggregable:!1,width:100,display:"flex",align:"center",headerAlign:"center",headerName:"",disableColumnMenu:!0,disableExport:!0,renderCell:Mce,getApplyQuickFilterFn:void 0}),wc=e=>e.rows,$E=ui(wc,e=>e.totalRowCount),Ace=ui(wc,e=>e.loading),Lce=ui(wc,e=>e.totalTopLevelRowCount),Uf=ui(wc,e=>e.dataRowIdToModelLookup),bC=ui(wc,e=>e.dataRowIdToIdLookup),hl=ui(wc,e=>e.tree),Rce=ui(wc,e=>e.groupsToFetch),Oce=ui(wc,e=>e.groupingName),U4=ui(wc,e=>e.treeDepths),I0=Ro(wc,e=>{const t=Object.entries(e.treeDepths);return t.length===0?1:t.filter(([,n])=>n>0).map(([n])=>Number(n)).sort((n,s)=>s-n)[0]+1}),Ww=ui(wc,e=>e.dataRowIds),Dce=ui(wc,e=>e==null?void 0:e.additionalRowGroups),$m=Ro(Dce,e=>{var n,s;const t=e==null?void 0:e.pinnedRows;return{bottom:((n=t==null?void 0:t.bottom)==null?void 0:n.map(a=>({id:a.id,model:a.model??{}})))??[],top:((s=t==null?void 0:t.top)==null?void 0:s.map(a=>({id:a.id,model:a.model??{}})))??[]}}),zce=ui($m,e=>{var t,n;return(((t=e==null?void 0:e.top)==null?void 0:t.length)||0)+(((n=e==null?void 0:e.bottom)==null?void 0:n.length)||0)}),Va="auto-generated-group-node-root",Ny=Symbol("mui.id_autogenerated"),Fce=()=>({type:"group",id:Va,depth:-1,groupingField:null,groupingKey:null,isAutoGenerated:!0,children:[],childrenFromPath:{},childrenExpanded:!0,parent:null});function Nce(e,t,n="A row was provided without id in the rows prop:"){if(e==null)throw new Error(["MUI X: The Data Grid component requires all rows to have a unique `id` property.","Alternatively, you can use the `getRowId` prop to specify a custom id for each row.",n,JSON.stringify(t)].join(`
`))}const UE=(e,t,n)=>{const s=t?t(e):e.id;return Nce(s,e,n),s},yS=({rows:e,getRowId:t,loading:n,rowCount:s})=>{const a={type:"full",rows:[]},u={},f={};for(let _=0;_<e.length;_+=1){const r=e[_],C=UE(r,t);u[C]=r,f[C]=C,a.rows.push(C)}return{rowsBeforePartialUpdates:e,loadingPropBeforePartialUpdates:n,rowCountPropBeforePartialUpdates:s,updates:a,dataRowIdToIdLookup:f,dataRowIdToModelLookup:u}},LV=({tree:e,rowCountProp:t=0})=>{const n=e[Va];return Math.max(t,n.children.length+(n.footerId==null?0:1))},RV=({apiRef:e,rowCountProp:t=0,loadingProp:n,previousTree:s,previousTreeDepths:a,previousGroupsToFetch:u})=>{const f=e.current.caches.rows,{tree:_,treeDepths:r,dataRowIds:C,groupingName:k,groupsToFetch:I=[]}=e.current.applyStrategyProcessor("rowTreeCreation",{previousTree:s,previousTreeDepths:a,updates:f.updates,dataRowIdToIdLookup:f.dataRowIdToIdLookup,dataRowIdToModelLookup:f.dataRowIdToModelLookup,previousGroupsToFetch:u}),P=e.current.unstable_applyPipeProcessors("hydrateRows",{tree:_,treeDepths:r,dataRowIdToIdLookup:f.dataRowIdToIdLookup,dataRowIds:C,dataRowIdToModelLookup:f.dataRowIdToModelLookup});return e.current.caches.rows.updates={type:"partial",actions:{insert:[],modify:[],remove:[]},idToActionLookup:{}},Ge({},P,{totalRowCount:Math.max(t,P.dataRowIds.length),totalTopLevelRowCount:LV({tree:P.tree,rowCountProp:t}),groupingName:k,loading:n,groupsToFetch:I})},d0=e=>e.type==="skeletonRow"||e.type==="footer"||e.type==="group"&&e.isAutoGenerated||e.type==="pinnedRow"&&e.isAutoGenerated,FA=(e,t,n)=>{const s=e[t];if(s.type!=="group")return[];const a=[];for(let u=0;u<s.children.length;u+=1){const f=s.children[u];(!n||!d0(e[f]))&&a.push(f);const _=FA(e,f,n);for(let r=0;r<_.length;r+=1)a.push(_[r])}return!n&&s.footerId!=null&&a.push(s.footerId),a},G4=({previousCache:e,getRowId:t,updates:n,groupKeys:s})=>{if(e.updates.type==="full")throw new Error("MUI X: Unable to prepare a partial update if a full update is not applied yet.");const a=new Map;n.forEach(k=>{const I=UE(k,t,"A row was provided without id when calling updateRows():");a.has(I)?a.set(I,Ge({},a.get(I),k)):a.set(I,k)});const u={type:"partial",actions:{insert:[...e.updates.actions.insert??[]],modify:[...e.updates.actions.modify??[]],remove:[...e.updates.actions.remove??[]]},idToActionLookup:Ge({},e.updates.idToActionLookup),groupKeys:s},f=Ge({},e.dataRowIdToModelLookup),_=Ge({},e.dataRowIdToIdLookup),r={insert:{},modify:{},remove:{}};a.forEach((k,I)=>{const P=u.idToActionLookup[I];if(k._action==="delete"){if(P==="remove"||!f[I])return;P!=null&&(r[P][I]=!0),u.actions.remove.push(I),delete f[I],delete _[I];return}const D=f[I];if(D){P==="remove"?(r.remove[I]=!0,u.actions.modify.push(I)):P==null&&u.actions.modify.push(I),f[I]=Ge({},D,k);return}P==="remove"?(r.remove[I]=!0,u.actions.insert.push(I)):P==null&&u.actions.insert.push(I),f[I]=k,_[I]=I});const C=Object.keys(r);for(let k=0;k<C.length;k+=1){const I=C[k],P=r[I];Object.keys(P).length>0&&(u.actions[I]=u.actions[I].filter(D=>!P[D]))}return{dataRowIdToModelLookup:f,dataRowIdToIdLookup:_,updates:u,rowsBeforePartialUpdates:e.rowsBeforePartialUpdates,loadingPropBeforePartialUpdates:e.loadingPropBeforePartialUpdates,rowCountPropBeforePartialUpdates:e.rowCountPropBeforePartialUpdates}};function Bce(e){var a,u;const t=$m(e),n=((a=t==null?void 0:t.top)==null?void 0:a.reduce((f,_)=>(f+=e.current.unstable_getRowHeight(_.id),f),0))||0,s=((u=t==null?void 0:t.bottom)==null?void 0:u.reduce((f,_)=>(f+=e.current.unstable_getRowHeight(_.id),f),0))||0;return{top:n,bottom:s}}function OV(e){return`var(--DataGrid-overlayHeight, ${2*Ga(e.current.state).rowHeight}px)`}function H4(e,t,n){const s=[];return t.forEach(a=>{const u=UE(a,n,"A row was provided without id when calling updateRows():"),f=e.current.getRowNode(u);if((f==null?void 0:f.type)==="pinnedRow"){const _=e.current.caches.pinnedRows,r=_.idLookup[u];r&&(_.idLookup[u]=Ge({},r,a))}else s.push(a)}),s}const DV=(e,t,n)=>typeof e=="number"&&e>0?e:t,jce="__tree_data_group__",zV="__row_group_by_columns_group__",GE="__detail_panel_toggle__",Vce=["id","value","formattedValue","api","field","row","rowNode","colDef","cellMode","isEditable","hasFocus","tabIndex","hideDescendantCount"],$ce=e=>{const{classes:t}=e;return yr({root:["booleanCell"]},Gi,t)};function Uce(e){const{value:t,rowNode:n}=e,s=Zr(e,Vce),a=Bi(),u=Ur(),f={classes:u.classes},_=$ce(f),C=Kn(a,I0)>0&&n.type==="group"&&u.treeData===!1,k=X.useMemo(()=>t?u.slots.booleanCellTrueIcon:u.slots.booleanCellFalseIcon,[u.slots.booleanCellFalseIcon,u.slots.booleanCellTrueIcon,t]);return C&&t===void 0?null:K.jsx(k,Ge({fontSize:"small",className:_.root,titleAccess:a.current.getLocaleText(t?"booleanCellTrueLabel":"booleanCellFalseLabel"),"data-value":!!t},s))}const Gce=X.memo(Uce),Hce=e=>e.field!==zV&&d0(e.rowNode)?"":K.jsx(Gce,Ge({},e)),Wce=["id","value","formattedValue","api","field","row","rowNode","colDef","cellMode","isEditable","tabIndex","className","hasFocus","isValidating","isProcessingProps","error","onValueChange"],qce=e=>{const{classes:t}=e;return yr({root:["editBooleanCell"]},Gi,t)};function Xce(e){var H;const{id:t,value:n,field:s,className:a,hasFocus:u,onValueChange:f}=e,_=Zr(e,Wce),r=Bi(),C=X.useRef(null),k=ls(),[I,P]=X.useState(n),D=Ur(),N={classes:D.classes},j=qce(N),W=X.useCallback(async q=>{const Z=q.target.checked;f&&await f(q,Z),P(Z),await r.current.setEditCellValue({id:t,field:s,value:Z},q)},[r,s,t,f]);return X.useEffect(()=>{P(n)},[n]),Io(()=>{u&&C.current.focus()},[u]),K.jsx("label",Ge({htmlFor:k,className:Hn(j.root,a)},_,{children:K.jsx(D.slots.baseCheckbox,Ge({id:k,inputRef:C,checked:!!I,onChange:W,size:"small"},(H=D.slotProps)==null?void 0:H.baseCheckbox))}))}const Yce=e=>K.jsx(Xce,Ge({},e)),Zce=["item","applyValue","apiRef","focusElementRef","isFilterActive","clearButton","tabIndex","label","variant","InputLabelProps"],_S=e=>{if(String(e).toLowerCase()==="true")return!0;if(String(e).toLowerCase()==="false")return!1},Kce=Dn("div")({display:"flex",alignItems:"center",width:"100%","& button":{margin:"auto 0px 5px 5px"}});function Jce(e){var re,le,_e;const{item:t,applyValue:n,apiRef:s,focusElementRef:a,clearButton:u,tabIndex:f,label:_,variant:r="standard"}=e,C=Zr(e,Zce),[k,I]=X.useState(_S(t.value)),P=Ur(),D=ls(),N=ls(),j=((re=P.slotProps)==null?void 0:re.baseSelect)||{},W=j.native??!1,H=((le=P.slotProps)==null?void 0:le.baseSelectOption)||{},q=X.useCallback(ye=>{const de=_S(ye.target.value);I(de),n(Ge({},t,{value:de}))},[n,t]);X.useEffect(()=>{I(_S(t.value))},[t.value]);const Z=_??s.current.getLocaleText("filterPanelInputLabel");return K.jsxs(Kce,{children:[K.jsxs(P.slots.baseFormControl,{fullWidth:!0,children:[K.jsx(P.slots.baseInputLabel,Ge({},(_e=P.slotProps)==null?void 0:_e.baseInputLabel,{id:D,shrink:!0,variant:r,children:Z})),K.jsxs(P.slots.baseSelect,Ge({labelId:D,id:N,label:Z,value:k===void 0?"":String(k),onChange:q,variant:r,notched:r==="outlined"?!0:void 0,native:W,displayEmpty:!0,inputProps:{ref:a,tabIndex:f}},C,j,{children:[K.jsx(P.slots.baseSelectOption,Ge({},H,{native:W,value:"",children:s.current.getLocaleText("filterValueAny")})),K.jsx(P.slots.baseSelectOption,Ge({},H,{native:W,value:"true",children:s.current.getLocaleText("filterValueTrue")})),K.jsx(P.slots.baseSelectOption,Ge({},H,{native:W,value:"false",children:s.current.getLocaleText("filterValueFalse")}))]}))]}),u]})}const Qce=()=>[{value:"is",getApplyFilterFn:e=>{const t=_S(e.value);return t===void 0?null:n=>!!n===t},InputComponent:Jce}],ede=(e,t,n,s)=>e?s.current.getLocaleText("booleanCellTrueLabel"):s.current.getLocaleText("booleanCellFalseLabel"),tde=e=>{switch(e.toLowerCase().trim()){case"true":case"yes":case"1":return!0;case"false":case"no":case"0":case"null":case"undefined":return!1;default:return}},FV=Ge({},ed,{type:"boolean",display:"flex",align:"center",headerAlign:"center",renderCell:Hce,renderEditCell:Yce,sortComparator:wV,valueFormatter:ede,filterOperators:Qce(),getApplyQuickFilterFn:void 0,aggregable:!1,pastedValueParser:e=>tde(e)}),NV=e=>e.sorting,C1=ui(NV,e=>e.sortedRows),NA=Ro(C1,Uf,hl,(e,t,n)=>e.reduce((s,a)=>{const u=t[a];u&&s.push({id:a,model:u});const f=n[a];return f&&d0(f)&&s.push({id:a,model:{[Ny]:a}}),s},[])),Ju=ui(NV,e=>e.sortModel),nde=Ro(Ju,e=>e.reduce((n,s,a)=>(n[s.field]={sortDirection:s.sort,sortIndex:e.length>1?a+1:void 0},n),{})),HE=e=>e.filter,Ba=ui(HE,e=>e.filterModel);ui(Ba,e=>e.quickFilterValues);const rde=e=>e.visibleRowsLookup,k0=ui(HE,e=>e.filteredRowsLookup);ui(HE,e=>e.filteredChildrenCountLookup);ui(HE,e=>e.filteredDescendantCountLookup);const wp=Ro(rde,NA,(e,t)=>t.filter(n=>e[n.id]!==!1)),By=Ro(wp,e=>e.map(t=>t.id)),BV=Ro(k0,NA,(e,t)=>t.filter(n=>e[n.id]!==!1)),jV=Ro(BV,e=>e.map(t=>t.id));Ro(By,hl,(e,t)=>{const n={};let s=0;return e.reduce((a,u)=>{const f=t[u];return n[f.depth]||(n[f.depth]=0),f.depth>s&&(n[f.depth]=0),s=f.depth,n[f.depth]+=1,a[u]=n[f.depth],a},{})});const VV=Ro(wp,hl,I0,(e,t,n)=>n<2?e:e.filter(s=>{var a;return((a=t[s.id])==null?void 0:a.depth)===0})),BA=ui(wp,e=>e.length),jA=ui(VV,e=>e.length),ide=ui(BV,e=>e.length);ui(ide,jA,(e,t)=>e-t);const ode=Ro(Ba,Hh,(e,t)=>{var n;return(n=e.items)==null?void 0:n.filter(s=>{var f,_;if(!s.field)return!1;const a=t[s.field];if(!(a!=null&&a.filterOperators)||((f=a==null?void 0:a.filterOperators)==null?void 0:f.length)===0)return!1;const u=a.filterOperators.find(r=>r.value===s.operator);return u?!u.InputComponent||s.value!=null&&((_=s.value)==null?void 0:_.toString())!=="":!1})}),sde=Ro(ode,e=>e.reduce((n,s)=>(n[s.field]?n[s.field].push(s):n[s.field]=[s],n),{})),Qu=e=>e.rowSelection,ade=ui(Qu,e=>e.length),lde=Ro(Qu,Uf,(e,t)=>new Map(e.map(n=>[n,t[n]]))),Ah=Ro(Qu,e=>e.reduce((t,n)=>(t[n]=n,t),{}));function $V(e,t){var r;const n=hl(e),s=C1(e),a=k0(e),u=n[t];if(!u||u.type!=="group")return[];const f=[],_=s.findIndex(C=>C===t)+1;for(let C=_;C<s.length&&((r=n[s[C]])==null?void 0:r.depth)>u.depth;C+=1){const k=s[C];a[k]!==!1&&e.current.isRowSelectable(k)&&f.push(k)}return f}function ude(e,t){return ui(hl,C1,k0,Ah,(n,s,a,u)=>{var k;const f=n[e];if(!f||f.type!=="group")return{isIndeterminate:!1,isChecked:u[e]===e};if(u[e]===e)return{isIndeterminate:!1,isChecked:!0};let _=0,r=0;const C=s.findIndex(I=>I===e)+1;for(let I=C;I<s.length&&((k=n[s[I]])==null?void 0:k.depth)>f.depth;I+=1){const P=s[I];a[P]!==!1&&(_+=1,u[P]!==void 0&&(r+=1))}return{isIndeterminate:r>0&&(r<_||u[e]===void 0),isChecked:t?r>0:u[e]===e}})}function VA(e){return e.signature===dc.DataGrid?e.checkboxSelection&&e.disableMultipleRowSelection!==!0:!e.disableMultipleRowSelection}const cde=(e,t)=>{const n=[];let s=t;for(;s!=null&&s!==Va;){const a=e[s];if(!a)return n;n.push(s),s=a.parent}return n},dde=(e,t,n)=>{const s=e[n];if(!s)return[];const a=s.parent;return a==null?[]:e[a].children.filter(f=>f!==n&&t[f])},qw=(e,t,n,s,a,u)=>{const f=k0(e),_=Ah(e),r=new Set([]);if(!(!s&&!a)){if(s){const C=t[n];(C==null?void 0:C.type)==="group"&&$V(e,n).forEach(I=>{u(I),r.add(I)})}if(a){const C=I=>{if(_[I]!==I&&!r.has(I))return!1;const P=t[I];return(P==null?void 0:P.type)!=="group"?!0:P.children.every(C)},k=I=>{const P=dde(t,f,I);if(P.length===0||P.every(C)){const N=t[I].parent;N!=null&&N!==Va&&e.current.isRowSelectable(N)&&(u(N),r.add(N),k(N))}};k(n)}}},W4=(e,t,n,s,a,u)=>{const f=Ah(e);if(!(!a&&!s)&&(a&&cde(t,n).forEach(r=>{f[r]===r&&u(r)}),s)){const _=t[n];(_==null?void 0:_.type)==="group"&&$V(e,n).forEach(C=>{u(C)})}},hde=["field","id","formattedValue","row","rowNode","colDef","isEditable","cellMode","hasFocus","tabIndex","api"],fde=e=>{const{classes:t}=e;return yr({root:["checkboxInput"]},Gi,t)},pde=X.forwardRef(function(t,n){var de,ce;const{field:s,id:a,rowNode:u,hasFocus:f,tabIndex:_}=t,r=Zr(t,hde),C=Bi(),k=Ur(),I={classes:k.classes},P=fde(I),D=X.useRef(null),N=X.useRef(null),j=mo(D,n),W=oe=>{const xe={value:oe.target.checked,id:a};C.current.publishEvent("rowSelectionCheckboxChange",xe,oe)};X.useLayoutEffect(()=>{if(_===0){const oe=C.current.getCellElement(a,s);oe&&(oe.tabIndex=-1)}},[C,_,a,s]),X.useEffect(()=>{var oe;if(f){const xe=(oe=D.current)==null?void 0:oe.querySelector("input");xe==null||xe.focus({preventScroll:!0})}else N.current&&N.current.stop({})},[f]);const H=X.useCallback(oe=>{oe.key===" "&&oe.stopPropagation()},[]),q=C.current.isRowSelectable(a),Z=ude(a,((de=k.rowSelectionPropagation)==null?void 0:de.parents)??!1),{isIndeterminate:re,isChecked:le}=Kn(C,Z);if(u.type==="footer"||u.type==="pinnedRow")return null;const _e=C.current.getLocaleText(le?"checkboxSelectionUnselectRow":"checkboxSelectionSelectRow"),ye=k.indeterminateCheckboxAction==="select"?le&&!re:le;return K.jsx(k.slots.baseCheckbox,Ge({ref:j,tabIndex:_,checked:ye,onChange:W,className:P.root,inputProps:{"aria-label":_e},onKeyDown:H,indeterminate:re,disabled:!q,touchRippleRef:N},(ce=k.slotProps)==null?void 0:ce.baseCheckbox,r))}),mde=pde,WE=e=>e.focus,_u=ui(WE,e=>e.cell),gde=ui(WE,e=>e.columnHeader);ui(WE,e=>e.columnHeaderFilter);const wC=ui(WE,e=>e.columnGroupHeader),qE=e=>e.tabIndex,$A=ui(qE,e=>e.cell),UV=ui(qE,e=>e.columnHeader);ui(qE,e=>e.columnHeaderFilter);const yde=ui(qE,e=>e.columnGroupHeader);function Ei(e,t,n){const s=X.useRef(!0);Io(()=>{s.current=!1,e.current.register(n,t)},[e,n,t]),s.current&&e.current.register(n,t)}function _a(e,t){const n=X.useRef(null);if(n.current)return n.current;const s=e.current.getLogger(t);return n.current=s,s}const GV=(e,t,n,s,a)=>{const u=_a(e,"useNativeEventListener"),[f,_]=X.useState(!1),r=X.useRef(s),C=CV(t)?t():(t==null?void 0:t.current)??null,k=X.useCallback(I=>r.current&&r.current(I),[]);X.useEffect(()=>{r.current=s},[s]),X.useEffect(()=>{if(C&&n&&!f){u.debug(`Binding native ${n} event`),C.addEventListener(n,k,a),_(!0);const I=()=>{u.debug(`Clearing native ${n} event`),C.removeEventListener(n,k,a)};e.current.subscribeEvent("unmount",I)}},[C,k,n,f,u,a,e])},E1=e=>{const t=X.useRef(!0);t.current&&(t.current=!1,e())},_de=()=>{},vde=(e,t)=>{const n=X.useRef(!1);Io(()=>n.current||!e?_de:(n.current=!0,t()),[n.current||e])},xde=100,bde=e=>e?0:100,HV=(e,t,n)=>t>0&&e>0?Math.ceil(e/t):e===-1?n+2:0,WV=e=>({page:0,pageSize:e?0:100}),wde=(e,t=0)=>t===0?e:Math.max(Math.min(e,t-1),0),qV=(e,t)=>{if(t===dc.DataGrid&&e>xde)throw new Error(["MUI X: `pageSize` cannot exceed 100 in the MIT version of the DataGrid.","You need to upgrade to DataGridPro or DataGridPremium component to unlock this feature."].join(`
`))},Sde=-1,XE=e=>e.pagination,Al=ui(XE,e=>e.paginationModel),Cy=ui(XE,e=>e.rowCount),Xv=ui(XE,e=>e.meta),Cde=ui(Al,e=>e.page),Ede=ui(Al,e=>e.pageSize),XV=ui(Al,Cy,(e,t)=>HV(t,e.pageSize,e.page)),UA=Ro(Al,hl,I0,wp,VV,(e,t,n,s,a)=>{var D;const u=a.length,f=Math.min(e.pageSize*e.page,u-1),_=e.pageSize===Sde?u-1:Math.min(f+e.pageSize-1,u-1);if(f===-1||_===-1)return null;if(n<2)return{firstRowIndex:f,lastRowIndex:_};const r=a[f],C=_-f+1,k=s.findIndex(N=>N.id===r.id);let I=k,P=0;for(;I<s.length&&P<=C;){const N=s[I],j=(D=t[N.id])==null?void 0:D.depth;j===void 0?I+=1:((P<C||j>0)&&(I+=1),j===0&&(P+=1))}return{firstRowIndex:k,lastRowIndex:I-1}}),Tde=Ro(wp,UA,(e,t)=>t?e.slice(t.firstRowIndex,t.lastRowIndex+1):[]),YV=Ro(By,UA,(e,t)=>t?e.slice(t.firstRowIndex,t.lastRowIndex+1):[]),Ide=["field","colDef"],kde=e=>{const{classes:t}=e;return yr({root:["checkboxInput"]},Gi,t)},Mde=X.forwardRef(function(t,n){var de;const s=Zr(t,Ide),[,a]=X.useState(!1),u=Bi(),f=Ur(),_={classes:f.classes},r=kde(_),C=Kn(u,UV),k=Kn(u,Qu),I=Kn(u,By),P=Kn(u,YV),D=X.useMemo(()=>typeof f.isRowSelectable!="function"?k:k.filter(ce=>u.current.getRow(ce)?f.isRowSelectable(u.current.getRowParams(ce)):!1),[u,f.isRowSelectable,k]),N=X.useMemo(()=>(!f.pagination||!f.checkboxSelectionVisibleOnly?I:P).reduce((oe,xe)=>(oe[xe]=!0,oe),{}),[f.pagination,f.checkboxSelectionVisibleOnly,P,I]),j=X.useMemo(()=>D.filter(ce=>N[ce]).length,[D,N]),W=j>0&&j<Object.keys(N).length,H=j>0,q=ce=>{const oe={value:ce.target.checked};u.current.publishEvent("headerSelectionCheckboxChange",oe)},Z=C!==null&&C.field===t.field?0:-1;X.useLayoutEffect(()=>{const ce=u.current.getColumnHeaderElement(t.field);Z===0&&ce&&(ce.tabIndex=-1)},[Z,u,t.field]);const re=X.useCallback(ce=>{ce.key===" "&&u.current.publishEvent("headerSelectionCheckboxChange",{value:!H})},[u,H]),le=X.useCallback(()=>{a(ce=>!ce)},[]);X.useEffect(()=>u.current.subscribeEvent("rowSelectionChange",le),[u,le]);const _e=u.current.getLocaleText(H?"checkboxSelectionUnselectAllRows":"checkboxSelectionSelectAllRows"),ye=f.indeterminateCheckboxAction==="select"?H&&!W:H;return K.jsx(f.slots.baseCheckbox,Ge({ref:n,indeterminate:W,checked:ye,onChange:q,className:r.root,inputProps:{"aria-label":_e},tabIndex:Z,onKeyDown:re,disabled:!VA(f)},(de=f.slotProps)==null?void 0:de.baseCheckbox,s))}),wh="__check__",M0=Ge({},FV,{type:"custom",field:wh,width:50,resizable:!1,sortable:!1,filterable:!1,aggregable:!1,disableColumnMenu:!0,disableReorder:!0,disableExport:!0,getApplyQuickFilterFn:void 0,display:"flex",valueGetter:(e,t,n,s)=>{const a=Ah(s),u=s.current.getRowId(t);return a[u]!==void 0},renderHeader:e=>K.jsx(Mde,Ge({},e)),renderCell:e=>K.jsx(mde,Ge({},e))}),Pde=["item","applyValue","type","apiRef","focusElementRef","InputProps","isFilterActive","clearButton","tabIndex","disabled"];function q4(e,t){if(e==null)return"";const n=new Date(e);return Number.isNaN(n.getTime())?"":t==="date"?n.toISOString().substring(0,10):t==="datetime-local"?(n.setMinutes(n.getMinutes()-n.getTimezoneOffset()),n.toISOString().substring(0,19)):n.toISOString().substring(0,10)}function Zg(e){var Z;const{item:t,applyValue:n,type:s,apiRef:a,focusElementRef:u,InputProps:f,clearButton:_,tabIndex:r,disabled:C}=e,k=Zr(e,Pde),I=Eu(),[P,D]=X.useState(()=>q4(t.value,s)),[N,j]=X.useState(!1),W=ls(),H=Ur(),q=X.useCallback(re=>{I.clear();const le=re.target.value;D(le),j(!0),I.start(H.filterDebounceMs,()=>{const _e=new Date(le);n(Ge({},t,{value:Number.isNaN(_e.getTime())?void 0:_e})),j(!1)})},[n,t,H.filterDebounceMs,I]);return X.useEffect(()=>{const re=q4(t.value,s);D(re)},[t.value,s]),K.jsx(H.slots.baseTextField,Ge({fullWidth:!0,id:W,label:a.current.getLocaleText("filterPanelInputLabel"),placeholder:a.current.getLocaleText("filterPanelInputPlaceholder"),value:P,onChange:q,variant:"standard",type:s||"text",InputLabelProps:{shrink:!0},inputRef:u,InputProps:Ge({},N||_?{endAdornment:N?K.jsx(H.slots.loadIcon,{fontSize:"small",color:"action"}):_}:{},{disabled:C},f,{inputProps:Ge({max:s==="datetime-local"?"9999-12-31T23:59":"9999-12-31",tabIndex:r},f==null?void 0:f.inputProps)})},k,(Z=H.slotProps)==null?void 0:Z.baseTextField))}function Kg(e,t,n,s){if(!e.value)return null;const a=new Date(e.value);n?a.setSeconds(0,0):(a.setMinutes(a.getMinutes()+a.getTimezoneOffset()),a.setHours(0,0,0,0));const u=a.getTime();return f=>{if(!f)return!1;if(s)return t(f.getTime(),u);const _=new Date(f);return n?_.setSeconds(0,0):_.setHours(0,0,0,0),t(_.getTime(),u)}}const ZV=e=>[{value:"is",getApplyFilterFn:t=>Kg(t,(n,s)=>n===s,e),InputComponent:Zg,InputComponentProps:{type:e?"datetime-local":"date"}},{value:"not",getApplyFilterFn:t=>Kg(t,(n,s)=>n!==s,e),InputComponent:Zg,InputComponentProps:{type:e?"datetime-local":"date"}},{value:"after",getApplyFilterFn:t=>Kg(t,(n,s)=>n>s,e),InputComponent:Zg,InputComponentProps:{type:e?"datetime-local":"date"}},{value:"onOrAfter",getApplyFilterFn:t=>Kg(t,(n,s)=>n>=s,e),InputComponent:Zg,InputComponentProps:{type:e?"datetime-local":"date"}},{value:"before",getApplyFilterFn:t=>Kg(t,(n,s)=>n<s,e,!e),InputComponent:Zg,InputComponentProps:{type:e?"datetime-local":"date"}},{value:"onOrBefore",getApplyFilterFn:t=>Kg(t,(n,s)=>n<=s,e),InputComponent:Zg,InputComponentProps:{type:e?"datetime-local":"date"}},{value:"isEmpty",getApplyFilterFn:()=>t=>t==null,requiresFilterValue:!1},{value:"isNotEmpty",getApplyFilterFn:()=>t=>t!=null,requiresFilterValue:!1}],Ade=["id","value","formattedValue","api","field","row","rowNode","colDef","cellMode","isEditable","tabIndex","hasFocus","inputProps","isValidating","isProcessingProps","onValueChange"],Lde=Dn(w0)({fontSize:"inherit"}),Rde=e=>{const{classes:t}=e;return yr({root:["editInputCell"]},Gi,t)};function Ode(e){const{id:t,value:n,field:s,colDef:a,hasFocus:u,inputProps:f,onValueChange:_}=e,r=Zr(e,Ade),C=a.type==="dateTime",k=Bi(),I=X.useRef(),P=X.useMemo(()=>{let re;n==null?re=null:n instanceof Date?re=n:re=new Date((n??"").toString());let le;return re==null||Number.isNaN(re.getTime())?le="":le=new Date(re.getTime()-re.getTimezoneOffset()*60*1e3).toISOString().substr(0,C?16:10),{parsed:re,formatted:le}},[n,C]),[D,N]=X.useState(P),W={classes:Ur().classes},H=Rde(W),q=X.useCallback(re=>{if(re==="")return null;const[le,_e]=re.split("T"),[ye,de,ce]=le.split("-"),oe=new Date;if(oe.setFullYear(Number(ye),Number(de)-1,Number(ce)),oe.setHours(0,0,0,0),_e){const[xe,he]=_e.split(":");oe.setHours(Number(xe),Number(he),0,0)}return oe},[]),Z=X.useCallback(async re=>{const le=re.target.value,_e=q(le);_&&await _(re,_e),N({parsed:_e,formatted:le}),k.current.setEditCellValue({id:t,field:s,value:_e},re)},[k,s,t,_,q]);return X.useEffect(()=>{N(re=>{var le,_e;return P.parsed!==re.parsed&&((le=P.parsed)==null?void 0:le.getTime())!==((_e=re.parsed)==null?void 0:_e.getTime())?P:re})},[P]),Io(()=>{u&&I.current.focus()},[u]),K.jsx(Lde,Ge({inputRef:I,fullWidth:!0,className:H.root,type:C?"datetime-local":"date",inputProps:Ge({max:C?"9999-12-31T23:59":"9999-12-31"},f),value:D.formatted,onChange:Z},r))}const KV=e=>K.jsx(Ode,Ge({},e));function JV({value:e,columnType:t,rowId:n,field:s}){if(!(e instanceof Date))throw new Error([`MUI X: \`${t}\` column type only accepts \`Date\` objects as values.`,"Use `valueGetter` to transform the value into a `Date` object.",`Row ID: ${n}, field: "${s}".`].join(`
`))}const Dde=(e,t,n,s)=>{if(!e)return"";const a=s.current.getRowId(t);return JV({value:e,columnType:"date",rowId:a,field:n.field}),e.toLocaleDateString()},zde=(e,t,n,s)=>{if(!e)return"";const a=s.current.getRowId(t);return JV({value:e,columnType:"dateTime",rowId:a,field:n.field}),e.toLocaleString()},Fde=Ge({},ed,{type:"date",sortComparator:SV,valueFormatter:Dde,filterOperators:ZV(),renderEditCell:KV,pastedValueParser:e=>new Date(e)}),Nde=Ge({},ed,{type:"dateTime",sortComparator:SV,valueFormatter:zde,filterOperators:ZV(!0),renderEditCell:KV,pastedValueParser:e=>new Date(e)}),Rf=e=>e==null?null:Number(e),Bde=e=>e==null||Number.isNaN(e)||e===""?null:t=>Rf(t)===Rf(e),jde=()=>[{value:"=",getApplyFilterFn:e=>e.value==null||Number.isNaN(e.value)?null:t=>Rf(t)===e.value,InputComponent:oc,InputComponentProps:{type:"number"}},{value:"!=",getApplyFilterFn:e=>e.value==null||Number.isNaN(e.value)?null:t=>Rf(t)!==e.value,InputComponent:oc,InputComponentProps:{type:"number"}},{value:">",getApplyFilterFn:e=>e.value==null||Number.isNaN(e.value)?null:t=>t==null?!1:Rf(t)>e.value,InputComponent:oc,InputComponentProps:{type:"number"}},{value:">=",getApplyFilterFn:e=>e.value==null||Number.isNaN(e.value)?null:t=>t==null?!1:Rf(t)>=e.value,InputComponent:oc,InputComponentProps:{type:"number"}},{value:"<",getApplyFilterFn:e=>e.value==null||Number.isNaN(e.value)?null:t=>t==null?!1:Rf(t)<e.value,InputComponent:oc,InputComponentProps:{type:"number"}},{value:"<=",getApplyFilterFn:e=>e.value==null||Number.isNaN(e.value)?null:t=>t==null?!1:Rf(t)<=e.value,InputComponent:oc,InputComponentProps:{type:"number"}},{value:"isEmpty",getApplyFilterFn:()=>e=>e==null,requiresFilterValue:!1},{value:"isNotEmpty",getApplyFilterFn:()=>e=>e!=null,requiresFilterValue:!1},{value:"isAnyOf",getApplyFilterFn:e=>!Array.isArray(e.value)||e.value.length===0?null:t=>t!=null&&e.value.includes(Number(t)),InputComponent:TV,InputComponentProps:{type:"number"}}],Vde=Ge({},ed,{type:"number",align:"right",headerAlign:"right",sortComparator:wV,valueParser:e=>e===""?null:Number(e),valueFormatter:e=>lce(e)?e.toLocaleString():e||"",filterOperators:jde(),getApplyQuickFilterFn:Bde});function h0(e){return(e==null?void 0:e.type)==="singleSelect"}function Am(e,t){if(e)return typeof e.valueOptions=="function"?e.valueOptions(Ge({field:e.field},t)):e.valueOptions}function SC(e,t,n){if(t===void 0)return;const s=t.find(a=>{const u=n(a);return String(u)===String(e)});return n(s)}const $de=["id","value","formattedValue","api","field","row","rowNode","colDef","cellMode","isEditable","tabIndex","className","hasFocus","isValidating","isProcessingProps","error","onValueChange","initialOpen"],Ude=["MenuProps"];function Gde(e){return!!e.key}function Hde(e){var he,Ee;const t=Ur(),{id:n,value:s,field:a,row:u,colDef:f,hasFocus:_,error:r,onValueChange:C,initialOpen:k=t.editMode===Kd.Cell}=e,I=Zr(e,$de),P=Bi(),D=X.useRef(),N=X.useRef(),[j,W]=X.useState(k),q=(((he=t.slotProps)==null?void 0:he.baseSelect)||{}).native??!1,Z=((Ee=t.slotProps)==null?void 0:Ee.baseSelect)||{},{MenuProps:re}=Z,le=Zr(Z,Ude);if(Io(()=>{var se;_&&((se=N.current)==null||se.focus())},[_]),!h0(f))return null;const _e=Am(f,{id:n,row:u});if(!_e)return null;const ye=f.getOptionValue,de=f.getOptionLabel,ce=async se=>{if(!h0(f)||!_e)return;W(!1);const we=se.target,Se=SC(we.value,_e,ye);C&&await C(se,Se),await P.current.setEditCellValue({id:n,field:a,value:Se},se)},oe=(se,we)=>{if(t.editMode===Kd.Row){W(!1);return}if(we==="backdropClick"||se.key==="Escape"){const Se=P.current.getCellParams(n,a);P.current.publishEvent("cellEditStop",Ge({},Se,{reason:se.key==="Escape"?Uc.escapeKeyDown:Uc.cellFocusOut}))}},xe=se=>{Gde(se)&&se.key==="Enter"||W(!0)};return!_e||!f?null:K.jsx(t.slots.baseSelect,Ge({ref:D,inputRef:N,value:s,onChange:ce,open:j,onOpen:xe,MenuProps:Ge({onClose:oe},re),error:r,native:q,fullWidth:!0},I,le,{children:_e.map(se=>{var Se;const we=ye(se);return X.createElement(t.slots.baseSelectOption,Ge({},((Se=t.slotProps)==null?void 0:Se.baseSelectOption)||{},{native:q,key:we,value:we}),de(se))})}))}const Wde=e=>K.jsx(Hde,Ge({},e)),qde=["item","applyValue","type","apiRef","focusElementRef","placeholder","tabIndex","label","variant","isFilterActive","clearButton","InputLabelProps"],Xde=({column:e,OptionComponent:t,getOptionLabel:n,getOptionValue:s,isSelectNative:a,baseSelectOptionProps:u})=>["",...Am(e)||[]].map(_=>{const r=s(_);let C=n(_);return C===""&&(C=" "),X.createElement(t,Ge({},u,{native:a,key:r,value:r}),C)}),Yde=Dn("div")({display:"flex",alignItems:"flex-end",width:"100%","& button":{margin:"auto 0px 5px 5px"}});function X4(e){var ye,de,ce,oe,xe;const{item:t,applyValue:n,type:s,apiRef:a,focusElementRef:u,placeholder:f,tabIndex:_,label:r,variant:C="standard",clearButton:k}=e,I=Zr(e,qde),P=t.value??"",D=ls(),N=ls(),j=Ur(),W=((de=(ye=j.slotProps)==null?void 0:ye.baseSelect)==null?void 0:de.native)??!1;let H=null;if(t.field){const he=a.current.getColumn(t.field);h0(he)&&(H=he)}const q=H==null?void 0:H.getOptionValue,Z=H==null?void 0:H.getOptionLabel,re=X.useMemo(()=>Am(H),[H]),le=X.useCallback(he=>{let Ee=he.target.value;Ee=SC(Ee,re,q),n(Ge({},t,{value:Ee}))},[re,q,n,t]);if(!h0(H))return null;const _e=r??a.current.getLocaleText("filterPanelInputLabel");return K.jsxs(Yde,{children:[K.jsxs(j.slots.baseFormControl,{fullWidth:!0,children:[K.jsx(j.slots.baseInputLabel,Ge({},(ce=j.slotProps)==null?void 0:ce.baseInputLabel,{id:N,htmlFor:D,shrink:!0,variant:C,children:_e})),K.jsx(j.slots.baseSelect,Ge({id:D,label:_e,labelId:N,value:P,onChange:le,variant:C,type:s||"text",inputProps:{tabIndex:_,ref:u,placeholder:f??a.current.getLocaleText("filterPanelInputPlaceholder")},native:W,notched:C==="outlined"?!0:void 0},I,(oe=j.slotProps)==null?void 0:oe.baseSelect,{children:Xde({column:H,OptionComponent:j.slots.baseSelectOption,getOptionLabel:Z,getOptionValue:q,isSelectNative:W,baseSelectOptionProps:(xe=j.slotProps)==null?void 0:xe.baseSelectOption})}))]}),k]})}const Zde=["item","applyValue","type","apiRef","focusElementRef","color","error","helperText","size","variant"],Kde=["key"],Jde=zj();function Qde(e){const{item:t,applyValue:n,apiRef:s,focusElementRef:a,color:u,error:f,helperText:_,size:r,variant:C="standard"}=e,k=Zr(e,Zde),I={color:u,error:f,helperText:_,size:r,variant:C},P=ls(),D=Ur();let N=null;if(t.field){const le=s.current.getColumn(t.field);h0(le)&&(N=le)}const j=N==null?void 0:N.getOptionValue,W=N==null?void 0:N.getOptionLabel,H=X.useCallback((le,_e)=>j(le)===j(_e),[j]),q=X.useMemo(()=>Am(N)||[],[N]),Z=X.useMemo(()=>Array.isArray(t.value)?t.value.reduce((le,_e)=>{const ye=q.find(de=>j(de)===_e);return ye!=null&&le.push(ye),le},[]):[],[j,t.value,q]),re=X.useCallback((le,_e)=>{n(Ge({},t,{value:_e.map(j)}))},[n,t,j]);return K.jsx(Xj,Ge({multiple:!0,options:q,isOptionEqualToValue:H,filterOptions:Jde,id:P,value:Z,onChange:re,getOptionLabel:W,renderTags:(le,_e)=>le.map((ye,de)=>{const ce=_e({index:de}),{key:oe}=ce,xe=Zr(ce,Kde);return K.jsx(D.slots.baseChip,Ge({variant:"outlined",size:"small",label:W(ye)},xe),oe)}),renderInput:le=>{var _e;return K.jsx(D.slots.baseTextField,Ge({},le,{label:s.current.getLocaleText("filterPanelInputLabel"),placeholder:s.current.getLocaleText("filterPanelInputPlaceholder"),InputLabelProps:Ge({},le.InputLabelProps,{shrink:!0}),inputRef:a,type:"singleSelect"},I,(_e=D.slotProps)==null?void 0:_e.baseTextField))}},k))}const Jg=e=>e==null||!DA(e)?e:e.value,ehe=()=>[{value:"is",getApplyFilterFn:e=>e.value==null||e.value===""?null:t=>Jg(t)===Jg(e.value),InputComponent:X4},{value:"not",getApplyFilterFn:e=>e.value==null||e.value===""?null:t=>Jg(t)!==Jg(e.value),InputComponent:X4},{value:"isAnyOf",getApplyFilterFn:e=>{if(!Array.isArray(e.value)||e.value.length===0)return null;const t=e.value.map(Jg);return n=>t.includes(Jg(n))},InputComponent:Qde}],the=e=>typeof e[0]=="object",nhe=e=>DA(e)?e.value:e,rhe=e=>DA(e)?e.label:String(e),ihe=Ge({},ed,{type:"singleSelect",getOptionLabel:rhe,getOptionValue:nhe,valueFormatter(e,t,n,s){const a=s.current.getRowId(t);if(!h0(n))return"";const u=Am(n,{id:a,row:t});if(e==null)return"";if(!u)return e;if(!the(u))return n.getOptionLabel(e);const f=u.find(_=>n.getOptionValue(_)===e);return f?n.getOptionLabel(f):""},renderEditCell:Wde,filterOperators:ehe(),pastedValueParser:(e,t,n)=>{const s=n,a=Am(s)||[],u=s.getOptionValue;if(a.find(_=>u(_)===e))return e}}),ohe="string",she=()=>({string:ed,number:Vde,date:Fde,dateTime:Nde,boolean:FV,singleSelect:ihe,[VE]:Pce,custom:ed}),GA=e=>e.headerFiltering,ahe=ui(GA,e=>(e==null?void 0:e.enabled)??!1),lhe=ui(GA,e=>e.editing),uhe=ui(GA,e=>e.menuOpen),YE=e=>e.columnGrouping,QV=Ro(YE,e=>(e==null?void 0:e.unwrappedGroupingModel)??{}),e$=Ro(YE,e=>(e==null?void 0:e.lookup)??{}),che=Ro(YE,e=>(e==null?void 0:e.headerStructure)??[]),T1=ui(YE,e=>(e==null?void 0:e.maxDepth)??0),t$=["maxWidth","minWidth","width","flex"],zk=she();function dhe({initialFreeSpace:e,totalFlexUnits:t,flexColumns:n}){const s=new Set(n.map(f=>f.field)),a={all:{},frozenFields:[],freeze:f=>{const _=a.all[f];_&&_.frozen!==!0&&(a.all[f].frozen=!0,a.frozenFields.push(f))}};function u(){if(a.frozenFields.length===s.size)return;const f={min:{},max:{}};let _=e,r=t,C=0;a.frozenFields.forEach(k=>{_-=a.all[k].computedWidth,r-=a.all[k].flex});for(let k=0;k<n.length;k+=1){const I=n[k];if(a.all[I.field]&&a.all[I.field].frozen===!0)continue;let D=_/r*I.flex;D<I.minWidth?(C+=I.minWidth-D,D=I.minWidth,f.min[I.field]=!0):D>I.maxWidth&&(C+=I.maxWidth-D,D=I.maxWidth,f.max[I.field]=!0),a.all[I.field]={frozen:!1,computedWidth:D,flex:I.flex}}C<0?Object.keys(f.max).forEach(k=>{a.freeze(k)}):C>0?Object.keys(f.min).forEach(k=>{a.freeze(k)}):n.forEach(({field:k})=>{a.freeze(k)}),u()}return u(),a.all}const OP=(e,t)=>{const n={};let s=0,a=0;const u=[];e.orderedFields.forEach(r=>{let C=e.lookup[r],k=0,I=!1;e.columnVisibilityModel[r]!==!1&&(C.flex&&C.flex>0?(s+=C.flex,I=!0):k=Wd(C.width||ed.width,C.minWidth||ed.minWidth,C.maxWidth||ed.maxWidth),a+=k),C.computedWidth!==k&&(C=Ge({},C,{computedWidth:k})),I&&u.push(C),n[r]=C});const f=t===void 0?0:t.viewportOuterSize.width-(t.hasScrollY?t.scrollbarSize:0),_=Math.max(f-a,0);if(s>0&&f>0){const r=dhe({initialFreeSpace:_,totalFlexUnits:s,flexColumns:u});Object.keys(r).forEach(C=>{n[C].computedWidth=r[C].computedWidth})}return Ge({},e,{lookup:n})},hhe=(e,t)=>{if(!t)return e;const{orderedFields:n=[],dimensions:s={}}=t,a=Object.keys(s);if(a.length===0&&n.length===0)return e;const u={},f=[];for(let k=0;k<n.length;k+=1){const I=n[k];e.lookup[I]&&(u[I]=!0,f.push(I))}const _=f.length===0?e.orderedFields:[...f,...e.orderedFields.filter(k=>!u[k])],r=Ge({},e.lookup);for(let k=0;k<a.length;k+=1){const I=a[k],P=Ge({},r[I],{hasBeenResized:!0});Object.entries(s[I]).forEach(([D,N])=>{P[D]=N===-1?1/0:N}),r[I]=P}return Ge({},e,{orderedFields:_,lookup:r})};function Y4(e){let t=zk[ohe];return e&&zk[e]&&(t=zk[e]),t}const oy=({apiRef:e,columnsToUpsert:t,initialState:n,columnVisibilityModel:s=lc(e),keepOnlyColumnsToUpsert:a=!1})=>{var k,I;const u=!e.current.state.columns;let f;if(u)f={orderedFields:[],lookup:{},columnVisibilityModel:s};else{const P=Hd(e.current.state);f={orderedFields:a?[]:[...P.orderedFields],lookup:Ge({},P.lookup),columnVisibilityModel:s}}let _={};a&&!u&&(_=Object.keys(f.lookup).reduce((P,D)=>Ge({},P,{[D]:!1}),{})),t.forEach(P=>{const{field:D}=P;_[D]=!0;let N=f.lookup[D];N==null?(N=Ge({},Y4(P.type),{field:D,hasBeenResized:!1}),f.orderedFields.push(D)):a&&f.orderedFields.push(D),N&&N.type!==P.type&&(N=Ge({},Y4(P.type),{field:D}));let j=N.hasBeenResized;t$.forEach(W=>{P[W]!==void 0&&(j=!0,P[W]===-1&&(P[W]=1/0))}),f.lookup[D]=Qy(N,Ge({},P,{hasBeenResized:j}))}),a&&!u&&Object.keys(f.lookup).forEach(P=>{_[P]||delete f.lookup[P]});const r=e.current.unstable_applyPipeProcessors("hydrateColumns",f),C=hhe(r,n);return OP(C,((I=(k=e.current).getRootDimensions)==null?void 0:I.call(k))??void 0)};function fhe({firstColumnToRender:e,apiRef:t,firstRowToRender:n,lastRowToRender:s,visibleRows:a}){let u=e;for(let f=n;f<s;f+=1)if(a[f]){const r=a[f].id,C=t.current.unstable_getCellColSpanInfo(r,e);C&&C.spannedByColSpan&&(u=C.leftVisibleCellIndex)}return u}function HA(e,t){if(t.unstable_listView)return 0;const n=w1(e),s=T1(e),a=ahe(e),u=Math.floor(t.columnHeaderHeight*n),f=a?Math.floor((t.headerFilterHeight??t.columnHeaderHeight)*n):0;return u*(1+(s??0))+f}const Z4=1,phe=1.5,mhe=e=>{const{scrollDirection:t,classes:n}=e,s={root:["scrollArea",`scrollArea--${t}`]};return yr(s,Gi,n)},ghe=Wo("div",{name:"MuiDataGrid",slot:"ScrollArea",overridesResolver:(e,t)=>[{[`&.${xt["scrollArea--left"]}`]:t["scrollArea--left"]},{[`&.${xt["scrollArea--right"]}`]:t["scrollArea--right"]},t.scrollArea]})(()=>({position:"absolute",top:0,zIndex:101,width:20,bottom:0,[`&.${xt["scrollArea--left"]}`]:{left:0},[`&.${xt["scrollArea--right"]}`]:{right:0}}));function yhe(e){const{scrollDirection:t}=e,n=X.useRef(null),s=Bi(),a=Eu(),u=Kn(s,w1),f=Kn(s,RA),_=Kn(s,Ga),r=X.useRef({left:0,top:0}),C=()=>{if(t==="left")return r.current.left>0;if(t==="right"){const de=f-_.viewportInnerSize.width;return r.current.left<de}return!1},[k,I]=X.useState(!1),[P,D]=X.useState(C),N=Ur(),j=Ge({},N,{scrollDirection:t}),W=mhe(j),H=HA(s,N),q=Math.floor(N.columnHeaderHeight*u),Z={height:q,top:H-q};t==="left"?Z.left=_.leftPinnedWidth:t==="right"&&(Z.right=_.rightPinnedWidth+(_.hasScrollX?_.scrollbarSize:0));const re=de=>{r.current=de,D(C)},le=Ui(de=>{let ce;if(de.preventDefault(),t==="left")ce=de.clientX-n.current.getBoundingClientRect().right;else if(t==="right")ce=Math.max(1,de.clientX-n.current.getBoundingClientRect().left);else throw new Error("MUI X: Wrong drag direction");ce=(ce-Z4)*phe+Z4,a.start(0,()=>{s.current.scroll({left:r.current.left+ce,top:r.current.top})})}),_e=Ui(()=>{I(!0)}),ye=Ui(()=>{I(!1)});return Lr(s,"scrollPositionChange",re),Lr(s,"columnHeaderDragStart",_e),Lr(s,"columnHeaderDragEnd",ye),!k||!P?null:K.jsx(ghe,{ref:n,className:Hn(W.root),ownerState:j,onDragOver:le,style:Z})}const K4=xp(yhe),_he=()=>{};function vhe(e,t,n){const s=X.useRef(null);s.current=t,Io(()=>{if(typeof ResizeObserver>"u")return _he;const a=e.current,u=new ResizeObserver(f=>{s.current(f)});return a&&u.observe(a),()=>{u.disconnect()}},[e,n])}const n$=X.createContext(void 0);function Sc(){const e=X.useContext(n$);if(e===void 0)throw new Error(["MUI X: Could not find the Data Grid private context.","It looks like you rendered your component outside of a DataGrid, DataGridPro or DataGridPremium parent component.","This can also happen if you are bundling multiple versions of the Data Grid."].join(`
`));return e}const jy=(e,t)=>{let n,s;return t.pagination&&t.paginationMode==="client"?(s=UA(e),n=Tde(e)):(n=wp(e),n.length===0?s=null:s={firstRowIndex:0,lastRowIndex:n.length-1}),{rows:n,range:s}},Sp=(e,t)=>{const n=jy(e,t);return X.useMemo(()=>({rows:n.rows,range:n.range}),[n.rows,n.range])},xhe=typeof navigator<"u"?navigator.userAgent.toLowerCase():"empty",bhe=xhe.includes("firefox"),P0=e=>e.rowsMeta,ZE=e=>e.virtualization;ui(ZE,e=>e.enabled);const WA=ui(ZE,e=>e.enabledForColumns),whe=ui(ZE,e=>e.enabledForRows),KE=ui(ZE,e=>e.renderContext),She=Ro(e=>e.virtualization.renderContext.firstColumnIndex,e=>e.virtualization.renderContext.lastColumnIndex,(e,t)=>({firstColumnIndex:e,lastColumnIndex:t})),r$={firstRowIndex:0,lastRowIndex:0,firstColumnIndex:0,lastColumnIndex:0},Che=(e,t)=>{const{disableVirtualization:n,autoHeight:s}=t;return Ge({},e,{virtualization:{enabled:!n,enabledForColumns:!n,enabledForRows:!n&&!s,renderContext:r$}})};function Ehe(e,t){const n=u=>{e.current.setState(f=>Ge({},f,{virtualization:Ge({},f.virtualization,{enabled:u,enabledForColumns:u,enabledForRows:u&&!t.autoHeight})}))};Ei(e,{unstable_setVirtualization:n,unstable_setColumnVirtualization:u=>{e.current.setState(f=>Ge({},f,{virtualization:Ge({},f.virtualization,{enabledForColumns:u})}))}},"public"),X.useEffect(()=>{n(!t.disableVirtualization)},[t.disableVirtualization,t.autoHeight])}const qA=e=>e.rowSpanning,i$=ui(qA,e=>e.hiddenCells),The=ui(qA,e=>e.spannedCells),Ihe=ui(qA,e=>e.hiddenCellOriginMap),f0=e=>e.listViewColumn,Fk=50;var Ks=function(e){return e[e.NONE=0]="NONE",e[e.UP=1]="UP",e[e.DOWN=2]="DOWN",e[e.LEFT=3]="LEFT",e[e.RIGHT=4]="RIGHT",e}(Ks||{});const J4={top:0,left:0},khe=Object.freeze(new Map),Mhe=(e,t,n,s,a)=>({direction:Ks.NONE,buffer:s$(e,Ks.NONE,t,n,s,a)});let DP=!1;try{typeof window<"u"&&(DP=/jsdom/.test(window.navigator.userAgent))}catch{}const Phe=()=>{const e=Sc(),t=Ur(),{unstable_listView:n}=t,s=Kn(e,()=>n?[f0(e.current.state)]:ua(e)),a=Kn(e,whe)&&!DP,u=Kn(e,WA)&&!DP,f=Kn(e,Ga),_=f.viewportOuterSize,r=Kn(e,$m),C=Kn(e,S1),k=n?{left:[],right:[]}:C,I=r.bottom.length>0,[P,D]=X.useState(khe),N=au(),j=Kn(e,_u),W=Kn(e,$A),H=Kn(e,P0),q=Kn(e,Ah),Z=Sp(e,t),re=e.current.rootElementRef,le=e.current.mainElementRef,_e=e.current.virtualScrollerRef,ye=e.current.virtualScrollbarVerticalRef,de=e.current.virtualScrollbarHorizontalRef,ce=f.contentSize.height,oe=f.columnsTotalWidth,xe=Kn(e,Yue);vhe(le,()=>e.current.resize());const he=X.useRef(J4),Ee=X.useRef(J4),se=X.useRef(r$),we=Kn(e,KE),Se=Eu(),Pe=X.useRef(void 0),Me=id(()=>Mhe(N,t.rowBufferPx,t.columnBufferPx,f.rowHeight*15,Fk*6)).current,Re={rowIndex:X.useMemo(()=>j?Z.rows.findIndex(wt=>wt.id===j.id):-1,[j,Z.rows]),columnIndex:X.useMemo(()=>j?s.findIndex(wt=>wt.field===j.field):-1,[j,s])},Oe=X.useCallback(wt=>{if(Rhe(wt,e.current.state.virtualization.renderContext))return;const Ne=wt.firstRowIndex!==se.current.firstRowIndex||wt.lastRowIndex!==se.current.lastRowIndex;e.current.setState(We=>Ge({},We,{virtualization:Ge({},We.virtualization,{renderContext:wt})})),f.isReady&&Ne&&(se.current=wt,e.current.publishEvent("renderedRowsIntervalChange",wt)),Ee.current=he.current},[e,f.isReady]),$e=Ui(()=>{const wt={top:_e.current.scrollTop,left:_e.current.scrollLeft},Ne=wt.left-he.current.left,We=wt.top-he.current.top,Sn=Ne!==0||We!==0;he.current=wt;const Ae=Sn?Ohe(Ne,We):Ks.NONE,st=Math.abs(he.current.top-Ee.current.top),gt=Math.abs(he.current.left-Ee.current.left),ut=st>=f.rowHeight||gt>=Fk,tt=Me.direction!==Ae;if(!(ut||tt))return we;if(tt)switch(Ae){case Ks.NONE:case Ks.LEFT:case Ks.RIGHT:Pe.current=void 0;break;default:Pe.current=we;break}Me.direction=Ae,Me.buffer=s$(N,Ae,t.rowBufferPx,t.columnBufferPx,f.rowHeight*15,Fk*6);const tn=Nk(e,t,a,u),un=Bk(tn,he.current,Me);return kh.flushSync(()=>{Oe(un)}),Se.start(1e3,$e),un}),Ke=()=>{const wt=Nk(e,t,a,u),Ne=Bk(wt,he.current,Me);Pe.current=void 0,Oe(Ne)},Ct=Ui(wt=>{const{scrollTop:Ne,scrollLeft:We}=wt.currentTarget;if(Ne<0||!N&&We<0||N&&We>0)return;const Sn=$e();e.current.publishEvent("scrollPositionChange",{top:Ne,left:We,renderContext:Sn})}),Ue=Ui(wt=>{e.current.publishEvent("virtualScrollerWheel",{},wt)}),ft=Ui(wt=>{e.current.publishEvent("virtualScrollerTouchMove",{},wt)}),Bt=(wt={})=>{var an;if(!wt.rows&&!Z.range)return[];const Ne=wt.renderContext??we,We=!I&&wt.position===void 0||I&&wt.position==="bottom",Sn=wt.position!==void 0;let Ae;switch(wt.position){case"top":Ae=0;break;case"bottom":Ae=r.top.length+Z.rows.length;break;case void 0:Ae=r.top.length;break}const st=wt.rows??Z.rows,gt=Ne.firstRowIndex,ut=Math.min(Ne.lastRowIndex,st.length),tt=wt.rows?z4(0,wt.rows.length):z4(gt,ut);let nt=-1;!Sn&&Re.rowIndex!==-1&&(Re.rowIndex<gt&&(nt=Re.rowIndex,tt.unshift(nt)),Re.rowIndex>=ut&&(nt=Re.rowIndex,tt.push(nt)));const tn=[],un=(an=t.slotProps)==null?void 0:an.row,qt=bp(e);return tt.forEach(Jt=>{var Li,mi,ji;const{id:Wt,model:Fn}=st[Jt],ar=(((Li=Z==null?void 0:Z.range)==null?void 0:Li.firstRowIndex)||0)+Ae+Jt;if(xe){const ko=k.left.length,qo=s.length-k.right.length;e.current.calculateColSpan({rowId:Wt,minFirstColumn:ko,maxLastColumn:qo,columns:s}),k.left.length>0&&e.current.calculateColSpan({rowId:Wt,minFirstColumn:0,maxLastColumn:k.left.length,columns:s}),k.right.length>0&&e.current.calculateColSpan({rowId:Wt,minFirstColumn:s.length-k.right.length,maxLastColumn:s.length,columns:s})}const bn=(j==null?void 0:j.id)===Wt,lr=e.current.rowHasAutoHeight(Wt)?"auto":e.current.unstable_getRowHeight(Wt);let Cn;q[Wt]==null?Cn=!1:Cn=e.current.isRowSelectable(Wt);let xn=!1;wt.position===void 0&&(xn=Jt===0);let Er=!1;const Rr=Jt===st.length-1;if(We)if(Sn)Er=Rr;else{const ko=Z.rows.length-1;Jt===ko&&(Er=!0)}const Mn=Jt===nt;let Ar=null;W!==null&&W.id===Wt&&(Ar=e.current.getCellParams(Wt,W.field).cellMode==="view"?W.field:null);let fi=Ne;!Sn&&Pe.current&&Jt>=Pe.current.firstRowIndex&&Jt<Pe.current.lastRowIndex&&(fi=Pe.current);const yo=o$(qt,fi,k.left.length),vr=Rr&&wt.position==="top";if(tn.push(K.jsx(t.slots.row,Ge({row:Fn,rowId:Wt,index:ar,selected:Cn,offsetTop:wt.rows?void 0:H.positions[Jt],offsetLeft:yo,dimensions:f,rowHeight:lr,tabbableCell:Ar,pinnedColumns:k,visibleColumns:s,renderContext:fi,focusedColumnIndex:bn?Re.columnIndex:void 0,isFirstVisible:xn,isLastVisible:Er,isNotVisible:Mn,showBottomBorder:vr},un),Wt)),Mn)return;const zi=P.get(Wt);zi&&tn.push(zi),wt.position===void 0&&Rr&&tn.push((ji=(mi=e.current).getInfiniteLoadingTriggerElement)==null?void 0:ji.call(mi,{lastRowId:Wt}))}),tn},hn=_.width&&oe>_.width,ot=X.useMemo(()=>({overflowX:!hn||n?"hidden":void 0,overflowY:t.autoHeight?"hidden":void 0}),[hn,t.autoHeight,n]),en=X.useMemo(()=>{const wt={width:hn?oe:"auto",flexBasis:ce,flexShrink:0};return t.autoHeight&&Z.rows.length===0&&(wt.flexBasis=OV(e)),wt},[e,oe,ce,hn,t.autoHeight,Z.rows.length]);return X.useEffect(()=>{e.current.publishEvent("virtualScrollerContentSizeChange")},[e,en]),Io(()=>{e.current.resize()},[e,H.currentPageTotalHeight]),Io(()=>{u&&(_e.current.scrollLeft=0),a&&(_e.current.scrollTop=0)},[u,a,re,_e]),Io(()=>{n&&(_e.current.scrollLeft=0)},[n,_e]),vde(_.width!==0,()=>{const wt=Nk(e,t,a,u),Ne=Bk(wt,he.current,Me);Oe(Ne),e.current.publishEvent("scrollPositionChange",{top:he.current.top,left:he.current.left,renderContext:Ne})}),e.current.register("private",{updateRenderContext:Ke}),Lr(e,"columnsChange",Ke),Lr(e,"filteredRowsSet",Ke),Lr(e,"rowExpansionChange",Ke),{renderContext:we,setPanels:D,getRows:Bt,getContainerProps:()=>({ref:le}),getScrollerProps:()=>({ref:_e,onScroll:Ct,onWheel:Ue,onTouchMove:ft,style:ot,role:"presentation",tabIndex:bhe?-1:void 0}),getContentProps:()=>({style:en,role:"presentation"}),getRenderZoneProps:()=>({role:"rowgroup"}),getScrollbarVerticalProps:()=>({ref:ye,role:"presentation"}),getScrollbarHorizontalProps:()=>({ref:de,role:"presentation"})}};function Nk(e,t,n,s){const a=Ga(e.current.state),u=jy(e,t),f=t.unstable_listView?[f0(e.current.state)]:ua(e),_=Ihe(e),r=e.current.state.rows.dataRowIds.at(-1),C=f.at(-1);return{enabledForRows:n,enabledForColumns:s,apiRef:e,autoHeight:t.autoHeight,rowBufferPx:t.rowBufferPx,columnBufferPx:t.columnBufferPx,leftPinnedWidth:a.leftPinnedWidth,columnsTotalWidth:a.columnsTotalWidth,viewportInnerWidth:a.viewportInnerSize.width,viewportInnerHeight:a.viewportInnerSize.height,lastRowHeight:r!==void 0?e.current.unstable_getRowHeight(r):0,lastColumnWidth:(C==null?void 0:C.computedWidth)??0,rowsMeta:P0(e.current.state),columnPositions:bp(e),rows:u.rows,range:u.range,pinnedColumns:S1(e),visibleColumns:f,hiddenCellsOriginMap:_,listView:t.unstable_listView??!1}}function Bk(e,t,n){const s={firstRowIndex:0,lastRowIndex:e.rows.length,firstColumnIndex:0,lastColumnIndex:e.visibleColumns.length},{top:a,left:u}=t,f=Math.abs(u)+e.leftPinnedWidth;if(e.enabledForRows){let r=Math.min(Q4(e,a,{atStart:!0,lastPosition:e.rowsMeta.positions[e.rowsMeta.positions.length-1]+e.lastRowHeight}),e.rowsMeta.positions.length-1);const C=e.hiddenCellsOriginMap[r];if(C){const I=Math.min(...Object.values(C));r=Math.min(r,I)}const k=e.autoHeight?r+e.rows.length:Q4(e,a+e.viewportInnerHeight);s.firstRowIndex=r,s.lastRowIndex=k}if(e.enabledForColumns){let r=0,C=e.columnPositions.length,k=!1;const[I,P]=zP({firstIndex:s.firstRowIndex,lastIndex:s.lastRowIndex,minFirstIndex:0,maxLastIndex:e.rows.length,bufferBefore:n.buffer.rowBefore,bufferAfter:n.buffer.rowAfter,positions:e.rowsMeta.positions,lastSize:e.lastRowHeight});for(let D=I;D<P&&!k;D+=1){const N=e.rows[D];k=e.apiRef.current.rowHasAutoHeight(N.id)}k||(r=hp(f,e.columnPositions,{atStart:!0,lastPosition:e.columnsTotalWidth}),C=hp(f+e.viewportInnerWidth,e.columnPositions)),s.firstColumnIndex=r,s.lastColumnIndex=C}return Ahe(e,s,n)}function Q4(e,t,n){var f,_;const s=e.apiRef.current.getLastMeasuredRowIndex();let a=s===1/0;(f=e.range)!=null&&f.lastRowIndex&&!a&&(a=s>=e.range.lastRowIndex);const u=Wd(s-(((_=e.range)==null?void 0:_.firstRowIndex)||0),0,e.rowsMeta.positions.length);return a||e.rowsMeta.positions[u]>=t?hp(t,e.rowsMeta.positions,n):Lhe(t,e.rowsMeta.positions,u,n)}function Ahe(e,t,n){const[s,a]=zP({firstIndex:t.firstRowIndex,lastIndex:t.lastRowIndex,minFirstIndex:0,maxLastIndex:e.rows.length,bufferBefore:n.buffer.rowBefore,bufferAfter:n.buffer.rowAfter,positions:e.rowsMeta.positions,lastSize:e.lastRowHeight}),[u,f]=zP({firstIndex:t.firstColumnIndex,lastIndex:t.lastColumnIndex,minFirstIndex:e.pinnedColumns.left.length,maxLastIndex:e.visibleColumns.length-e.pinnedColumns.right.length,bufferBefore:n.buffer.columnBefore,bufferAfter:n.buffer.columnAfter,positions:e.columnPositions,lastSize:e.lastColumnWidth}),_=fhe({firstColumnToRender:u,apiRef:e.apiRef,firstRowToRender:s,lastRowToRender:a,visibleRows:e.rows});return{firstRowIndex:s,lastRowIndex:a,firstColumnIndex:_,lastColumnIndex:f}}function hp(e,t,n=void 0,s=0,a=t.length){if(t.length<=0)return-1;if(s>=a)return s;const u=s+Math.floor((a-s)/2),f=t[u];let _;if(n!=null&&n.atStart){const r=(u===t.length-1?n.lastPosition:t[u+1])-f;_=e-r<f}else _=e<=f;return _?hp(e,t,n,s,u):hp(e,t,n,u+1,a)}function Lhe(e,t,n,s=void 0){let a=1;for(;n<t.length&&Math.abs(t[n])<e;)n+=a,a*=2;return hp(e,t,s,Math.floor(n/2),Math.min(n,t.length))}function zP({firstIndex:e,lastIndex:t,bufferBefore:n,bufferAfter:s,minFirstIndex:a,maxLastIndex:u,positions:f,lastSize:_}){const r=f[e]-n,C=f[t]+s,k=hp(r,f,{atStart:!0,lastPosition:f[f.length-1]+_}),I=hp(C,f);return[Wd(k,a,u),Wd(I,a,u)]}function Rhe(e,t){return e===t?!0:e.firstRowIndex===t.firstRowIndex&&e.lastRowIndex===t.lastRowIndex&&e.firstColumnIndex===t.firstColumnIndex&&e.lastColumnIndex===t.lastColumnIndex}function o$(e,t,n){const s=(e[t.firstColumnIndex]??0)-(e[n]??0);return Math.abs(s)}function Ohe(e,t){return e===0&&t===0?Ks.NONE:Math.abs(t)>=Math.abs(e)?t>0?Ks.DOWN:Ks.UP:e>0?Ks.RIGHT:Ks.LEFT}function s$(e,t,n,s,a,u){if(e)switch(t){case Ks.LEFT:t=Ks.RIGHT;break;case Ks.RIGHT:t=Ks.LEFT;break}switch(t){case Ks.NONE:return{rowAfter:n,rowBefore:n,columnAfter:s,columnBefore:s};case Ks.LEFT:return{rowAfter:0,rowBefore:0,columnAfter:0,columnBefore:u};case Ks.RIGHT:return{rowAfter:0,rowBefore:0,columnAfter:u,columnBefore:0};case Ks.UP:return{rowAfter:0,rowBefore:a,columnAfter:0,columnBefore:0};case Ks.DOWN:return{rowAfter:a,rowBefore:0,columnAfter:0,columnBefore:0};default:throw new Error("unreachable")}}const Dhe=()=>{var k,I;const e=Bi(),t=Ur(),n=Kn(e,$E),s=Kn(e,BA),a=n===0,u=Kn(e,Ace),f=!u&&a,_=!u&&n>0&&s===0;let r=null,C=null;return f&&(r="noRowsOverlay"),_&&(r="noResultsOverlay"),u&&(r="loadingOverlay",C=((I=(k=t.slotProps)==null?void 0:k.loadingOverlay)==null?void 0:I[a?"noRowsVariant":"variant"])||null),{overlayType:r,loadingOverlayVariant:C}},zhe=Wo("div",{name:"MuiDataGrid",slot:"OverlayWrapper",shouldForwardProp:e=>e!=="overlayType"&&e!=="loadingOverlayVariant",overridesResolver:(e,t)=>t.overlayWrapper})(({overlayType:e,loadingOverlayVariant:t})=>t!=="skeleton"?{position:"sticky",top:"var(--DataGrid-headersTotalHeight)",left:0,width:0,height:0,zIndex:e==="loadingOverlay"?5:4}:{}),Fhe=Wo("div",{name:"MuiDataGrid",slot:"OverlayWrapperInner",shouldForwardProp:e=>e!=="overlayType"&&e!=="loadingOverlayVariant",overridesResolver:(e,t)=>t.overlayWrapperInner})({}),Nhe=e=>{const{classes:t}=e;return yr({root:["overlayWrapper"],inner:["overlayWrapperInner"]},Gi,t)};function Bhe(e){const t=Bi(),n=Ur(),s=Sp(t,n),a=Kn(t,Ga);let u=a.viewportOuterSize.height-a.topContainerHeight-a.bottomContainerHeight-(a.hasScrollX?a.scrollbarSize:0);(n.autoHeight&&s.rows.length===0||u===0)&&(u=OV(t));const f=Nhe(Ge({},e,{classes:n.classes}));return K.jsx(zhe,Ge({className:Hn(f.root)},e,{children:K.jsx(Fhe,Ge({className:Hn(f.inner),style:{height:u,width:a.viewportOuterSize.width}},e))}))}function jhe(e){var u,f;const{overlayType:t}=e,n=Ur();if(!t)return null;const s=(u=n.slots)==null?void 0:u[t],a=(f=n.slotProps)==null?void 0:f[t];return K.jsx(Bhe,Ge({},e,{children:K.jsx(s,Ge({},a))}))}const vS=e=>e.columnMenu;function Vhe(){var W;const e=Sc(),t=Ur(),n=Kn(e,ua),s=Kn(e,sde),a=Kn(e,nde),u=Kn(e,UV),f=Kn(e,$A),_=Kn(e,yde),r=Kn(e,gde),C=Kn(e,wC),k=Kn(e,T1),I=Kn(e,vS),P=Kn(e,lc),D=Kn(e,che),N=!(_===null&&u===null&&f===null),j=e.current.columnHeadersContainerRef;return K.jsx(t.slots.columnHeaders,Ge({ref:j,visibleColumns:n,filterColumnLookup:s,sortColumnLookup:a,columnHeaderTabIndexState:u,columnGroupHeaderTabIndexState:_,columnHeaderFocus:r,columnGroupHeaderFocus:C,headerGroupingMaxDepth:k,columnMenuState:I,columnVisibility:P,columnGroupsHeaderStructure:D,hasOtherElementInTabSequence:N},(W=t.slotProps)==null?void 0:W.columnHeaders))}const $he=xp(Vhe),a$=X.createContext(void 0),l$=()=>{const e=X.useContext(a$);if(e===void 0)throw new Error(["MUI X: Could not find the Data Grid configuration context.","It looks like you rendered your component outside of a DataGrid, DataGridPro or DataGridPremium parent component.","This can also happen if you are bundling multiple versions of the Data Grid."].join(`
`));return e},Uhe=Wo("div")({position:"absolute",top:"var(--DataGrid-headersTotalHeight)",left:0,width:"calc(100% - (var(--DataGrid-hasScrollY) * var(--DataGrid-scrollbarSize)))"}),Ghe=Wo("div",{name:"MuiDataGrid",slot:"Main",overridesResolver:(e,t)=>t.main})({flexGrow:1,position:"relative",overflow:"hidden",display:"flex",flexDirection:"column"}),Hhe=X.forwardRef((e,t)=>{const n=Ur(),a=l$().hooks.useGridAriaAttributes();return K.jsxs(Ghe,Ge({ref:t,ownerState:n,className:e.className,tabIndex:-1},a,{children:[K.jsx(Uhe,{role:"presentation","data-id":"gridPanelAnchor"}),e.children]}))}),Whe=()=>yr({root:["topContainer"]},Gi,{}),qhe=Wo("div")({position:"sticky",zIndex:4,top:0});function Xhe(e){const t=Whe();return K.jsx(qhe,Ge({},e,{className:Hn(t.root,xt["container--top"]),role:"presentation"}))}const Yhe=()=>yr({root:["bottomContainer"]},Gi,{}),Zhe=Wo("div")({position:"sticky",zIndex:4,bottom:"calc(var(--DataGrid-hasScrollX) * var(--DataGrid-scrollbarSize))"});function Khe(e){const t=Yhe();return K.jsx(Zhe,Ge({},e,{className:Hn(t.root,xt["container--bottom"]),role:"presentation"}))}const Jhe=(e,t)=>{const{classes:n}=e;return yr({root:["virtualScrollerContent",t&&"virtualScrollerContent--overflowed"]},Gi,n)},Qhe=Wo("div",{name:"MuiDataGrid",slot:"VirtualScrollerContent",overridesResolver:(e,t)=>t.virtualScrollerContent})({}),efe=X.forwardRef(function(t,n){var f;const s=Ur(),a=!s.autoHeight&&((f=t.style)==null?void 0:f.minHeight)==="auto",u=Jhe(s,a);return K.jsx(Qhe,Ge({ref:n},t,{ownerState:s,className:Hn(u.root,t.className)}))}),tfe=Wo("div")({display:"flex",flexDirection:"row",width:"var(--DataGrid-rowWidth)",boxSizing:"border-box"}),u$=Wo("div")({position:"sticky",height:"100%",boxSizing:"border-box",borderTop:"1px solid var(--rowBorderColor)",backgroundColor:"var(--DataGrid-pinnedBackground)"}),nfe=Wo(u$)({left:0,borderRight:"1px solid var(--rowBorderColor)"}),rfe=Wo(u$)({right:0,borderLeft:"1px solid var(--rowBorderColor)"}),ife=Wo("div")({flexGrow:1,borderTop:"1px solid var(--rowBorderColor)"});function ofe({rowsLength:e}){const t=Bi(),{viewportOuterSize:n,minimumSize:s,hasScrollX:a,hasScrollY:u,scrollbarSize:f,leftPinnedWidth:_,rightPinnedWidth:r}=Kn(t,Ga),C=a?f:0,k=n.height-s.height>0;return C===0&&!k?null:K.jsxs(tfe,{className:xt.filler,role:"presentation",style:{height:C,"--rowBorderColor":e===0?"transparent":"var(--DataGrid-rowBorderColor)"},children:[_>0&&K.jsx(nfe,{className:xt["filler--pinnedLeft"],style:{width:_}}),K.jsx(ife,{}),r>0&&K.jsx(rfe,{className:xt["filler--pinnedRight"],style:{width:r+(u?f:0)}})]})}const sfe=xp(ofe),afe=["className"],lfe=e=>{const{classes:t}=e;return yr({root:["virtualScrollerRenderZone"]},Gi,t)},ufe=Wo("div",{name:"MuiDataGrid",slot:"VirtualScrollerRenderZone",overridesResolver:(e,t)=>t.virtualScrollerRenderZone})({position:"absolute",display:"flex",flexDirection:"column"}),cfe=X.forwardRef(function(t,n){const{className:s}=t,a=Zr(t,afe),u=Bi(),f=Ur(),_=lfe(f),r=Kn(u,()=>{const C=KE(u);return P0(u.current.state).positions[C.firstRowIndex]??0});return K.jsx(ufe,Ge({ref:n,className:Hn(_.root,s),ownerState:f,style:{transform:`translate3d(0, ${r}px, 0)`}},a))}),dfe={includeHeaders:!0,includeOutliers:!1,outliersFactor:1.5,expand:!1},Ca=e=>e.editRows,Xx=e=>e.preferencePanel;var Lm=function(e){return e.filters="filters",e.columns="columns",e}(Lm||{});const hfe=(e,t)=>{const{classes:n}=e,s={root:["scrollbar",`scrollbar--${t}`],content:["scrollbarContent"]};return yr(s,Gi,n)},c$=Wo("div")({position:"absolute",display:"inline-block",zIndex:6,"--size":"calc(max(var(--DataGrid-scrollbarSize), 14px))"}),ffe=Wo(c$)({width:"var(--size)",height:"calc(var(--DataGrid-hasScrollY) * (100% - var(--DataGrid-topContainerHeight) - var(--DataGrid-bottomContainerHeight) - var(--DataGrid-hasScrollX) * var(--DataGrid-scrollbarSize)))",overflowY:"auto",overflowX:"hidden",outline:0,"& > div":{width:"var(--size)"},top:"var(--DataGrid-topContainerHeight)",right:"0px"}),pfe=Wo(c$)({width:"100%",height:"var(--size)",overflowY:"hidden",overflowX:"auto",outline:0,"& > div":{height:"var(--size)"},bottom:"0px"}),eN=X.forwardRef(function(t,n){const s=Sc(),a=Ur(),u=X.useRef(!1),f=X.useRef(0),_=X.useRef(null),r=X.useRef(null),C=hfe(a,t.position),k=Kn(s,Ga),I=t.position==="vertical"?"height":"width",P=t.position==="vertical"?"scrollTop":"scrollLeft",D=t.position==="vertical"?k.hasScrollX:k.hasScrollY,N=k.minimumSize[I]+(D?k.scrollbarSize:0),W=(t.position==="vertical"?k.viewportInnerSize.height:k.viewportOuterSize.width)*(N/k.viewportOuterSize[I]),H=Ui(()=>{const re=s.current.virtualScrollerRef.current,le=_.current;if(!le||re[P]===f.current)return;if(f.current=re[P],u.current){u.current=!1;return}u.current=!0;const _e=re[P]/N;le[P]=_e*W}),q=Ui(()=>{const re=s.current.virtualScrollerRef.current,le=_.current;if(!le)return;if(u.current){u.current=!1;return}u.current=!0;const _e=le[P]/W;re[P]=_e*N});CE(()=>{const re=s.current.virtualScrollerRef.current,le=_.current;return re.addEventListener("scroll",H,{capture:!0}),le.addEventListener("scroll",q,{capture:!0}),()=>{re.removeEventListener("scroll",H,{capture:!0}),le.removeEventListener("scroll",q,{capture:!0})}}),X.useEffect(()=>{r.current.style.setProperty(I,`${W}px`)},[W,I]);const Z=t.position==="vertical"?ffe:pfe;return K.jsx(Z,{ref:mo(n,_),className:C.root,style:t.position==="vertical"&&a.unstable_listView?{height:"100%",top:0}:void 0,tabIndex:-1,"aria-hidden":"true",children:K.jsx("div",{ref:r,className:C.content})})}),mfe=(e,t,n)=>{const{classes:s}=e,a={root:["main",t.rightPinnedWidth>0&&"main--hasPinnedRight",n==="skeleton"&&"main--hasSkeletonLoadingOverlay"],scroller:["virtualScroller",t.hasScrollX&&"virtualScroller--hasScrollX"]};return yr(a,Gi,s)},gfe=Wo("div",{name:"MuiDataGrid",slot:"VirtualScroller",overridesResolver:(e,t)=>t.virtualScroller})({position:"relative",height:"100%",flexGrow:1,overflow:"scroll",scrollbarWidth:"none",display:"flex",flexDirection:"column","&::-webkit-scrollbar":{display:"none"},"@media print":{overflow:"hidden"},zIndex:0});function yfe(e){const t=Bi(),n=Ur(),s=Kn(t,Ga),a=Dhe(),u=mfe(n,s,a.loadingOverlayVariant),f=Phe(),{getContainerProps:_,getScrollerProps:r,getContentProps:C,getRenderZoneProps:k,getScrollbarVerticalProps:I,getScrollbarHorizontalProps:P,getRows:D}=f,N=D();return K.jsxs(Hhe,Ge({className:u.root},_(),{children:[K.jsx(K4,{scrollDirection:"left"}),K.jsx(K4,{scrollDirection:"right"}),K.jsxs(gfe,Ge({className:u.scroller},r(),{ownerState:n,children:[K.jsxs(Xhe,{children:[!n.unstable_listView&&K.jsx($he,{}),K.jsx(n.slots.pinnedRows,{position:"top",virtualScroller:f})]}),K.jsx(jhe,Ge({},a)),K.jsx(efe,Ge({},C(),{children:K.jsxs(cfe,Ge({},k(),{children:[N,K.jsx(n.slots.detailPanels,{virtualScroller:f})]}))})),K.jsx(sfe,{rowsLength:N.length}),K.jsx(Khe,{children:K.jsx(n.slots.pinnedRows,{position:"bottom",virtualScroller:f})})]})),s.hasScrollY&&K.jsx(eN,Ge({position:"vertical"},I())),s.hasScrollX&&!n.unstable_listView&&K.jsx(eN,Ge({position:"horizontal"},P())),e.children]}))}function _fe(){var t;const e=Ur();return e.hideFooter?null:K.jsx(e.slots.footer,Ge({},(t=e.slotProps)==null?void 0:t.footer))}let jk;function vfe(){return jk===void 0&&document.createElement("div").focus({get preventScroll(){return jk=!0,!1}}),jk}function xfe(e){return e.scrollHeight>e.clientHeight||e.scrollWidth>e.clientWidth}function CC(e,t){return e.closest(`.${t}`)}function Wh(e){return e.replace(/["\\]/g,"\\$&")}function bfe(e,t){return e.querySelector(`[role="columnheader"][data-field="${Wh(t)}"]`)}function d$(e){return`.${xt.row}[data-id="${Wh(String(e))}"]`}function wfe(e,t){return e.querySelector(d$(t))}function Sfe(e,{id:t,field:n}){const s=d$(t),a=`.${xt.cell}[data-field="${Wh(n)}"]`,u=`${s} ${a}`;return e.querySelector(u)}function I1(e){return e.target.nodeType===1&&!e.currentTarget.contains(e.target)}function Cfe(e){return e.getAttribute("data-field")}function Efe(e,t){return e.querySelector(`[data-field="${Wh(t)}"]`)}function Tfe(e){return e.getAttribute("data-fields").slice(2,-2).split("-|-")}function Ife(e,t){return Array.from(e.querySelectorAll(`[data-fields*="|-${Wh(t)}-|"]`)??[])}function kfe(e,t){var f;if(!CC(e,xt.root))throw new Error("MUI X: The root element is not found.");const s=e.getAttribute("aria-colindex");if(!s)return[];const a=Number(s)-1,u=[];return(f=t.virtualScrollerRef)!=null&&f.current?(p$(t).forEach(_=>{const r=_.getAttribute("data-id");if(!r)return;let C=a;const k=t.unstable_getCellColSpanInfo(r,a);k&&k.spannedByColSpan&&(C=k.leftVisibleCellIndex);const I=_.querySelector(`[data-colindex="${C}"]`);I&&u.push(I)}),u):[]}function tN(e,t){return e.rootElementRef.current.querySelector(`.${xt[t]}`)}const h$=({api:e,colIndex:t,position:n,filterFn:s})=>{if(t===null)return[];const a=[];return p$(e).forEach(u=>{u.getAttribute("data-id")&&u.querySelectorAll(`.${xt[n==="left"?"cell--pinnedLeft":"cell--pinnedRight"]}`).forEach(_=>{const r=A0(_);r!==null&&s(r)&&a.push(_)})}),a};function Mfe(e,t,n){const s=A0(t);return h$({api:e,colIndex:s,position:n?"right":"left",filterFn:a=>n?a<s:a>s})}function Pfe(e,t,n){const s=A0(t);return h$({api:e,colIndex:s,position:n?"left":"right",filterFn:a=>n?a>s:a<s})}const f$=({api:e,colIndex:t,position:n,filterFn:s})=>{var u;if(!((u=e.columnHeadersContainerRef)!=null&&u.current))return[];if(t===null)return[];const a=[];return e.columnHeadersContainerRef.current.querySelectorAll(`.${xt[n==="left"?"columnHeader--pinnedLeft":"columnHeader--pinnedRight"]}`).forEach(f=>{const _=A0(f);_!==null&&s(_)&&a.push(f)}),a};function Afe(e,t,n){const s=A0(t);return f$({api:e,position:n?"right":"left",colIndex:s,filterFn:a=>n?a<s:a>s})}function Lfe(e,t,n){const s=A0(t);return f$({api:e,position:n?"left":"right",colIndex:s,filterFn:a=>n?a>s:a<s})}function Rfe(e,t){return e.columnHeadersContainerRef.current.querySelector(`:scope > div > [data-field="${Wh(t)}"][role="columnheader"]`)}function Ofe(e,t){const n=e.virtualScrollerRef.current;return Array.from(n.querySelectorAll(`:scope > div > div > div > [data-field="${Wh(t)}"][role="gridcell"]`))}function p$(e){return e.virtualScrollerRef.current.querySelectorAll(`:scope > div > div > .${xt.row}`)}function A0(e){const t=e.getAttribute("aria-colindex");return t?Number(t)-1:null}class xS extends Error{}function Dfe(e,t){const n=X.useCallback(P=>({field:P,colDef:e.current.getColumn(P)}),[e]),s=X.useCallback(P=>{const D=e.current.getRow(P);if(!D)throw new xS(`No row with id #${P} found`);return{id:P,columns:e.current.getAllColumns(),row:D}},[e]),a=X.useCallback((P,D)=>{const N=t.unstable_listView?f0(e.current.state):e.current.getColumn(D),j=e.current.getRow(P),W=e.current.getRowNode(P);if(!j||!W)throw new xS(`No row with id #${P} found`);const H=j[D],q=N!=null&&N.valueGetter?N.valueGetter(H,j,N,e):H,Z=_u(e),re=$A(e),le={id:P,field:D,row:j,rowNode:W,colDef:N,cellMode:e.current.getCellMode(P,D),hasFocus:Z!==null&&Z.field===D&&Z.id===P,tabIndex:re&&re.field===D&&re.id===P?0:-1,value:q,formattedValue:q,isEditable:!1,api:{}};return N&&N.valueFormatter&&(le.formattedValue=N.valueFormatter(q,j,N,e)),le.isEditable=N&&e.current.isCellEditable(le),le},[e,t.unstable_listView]),u=X.useCallback((P,D)=>{const N=e.current.getColumn(D),j=e.current.getRow(P);if(!j)throw new xS(`No row with id #${P} found`);return!N||!N.valueGetter?j[D]:N.valueGetter(j[N.field],j,N,e)},[e]),f=X.useCallback((P,D)=>{const N=D.field;if(!D||!D.valueGetter)return P[N];const j=P[D.field];return D.valueGetter(j,P,D,e)},[e]),_=X.useCallback((P,D)=>{const N=f(P,D);return!D||!D.valueFormatter?N:D.valueFormatter(N,P,D,e)},[e,f]),r=X.useCallback(P=>e.current.rootElementRef.current?bfe(e.current.rootElementRef.current,P):null,[e]),C=X.useCallback(P=>e.current.rootElementRef.current?wfe(e.current.rootElementRef.current,P):null,[e]),k=X.useCallback((P,D)=>e.current.rootElementRef.current?Sfe(e.current.rootElementRef.current,{id:P,field:D}):null,[e]);Ei(e,{getCellValue:u,getCellParams:a,getCellElement:k,getRowValue:f,getRowFormattedValue:_,getRowParams:s,getRowElement:C,getColumnHeaderParams:n,getColumnHeaderElement:r},"public")}const JE=(e,t,n,s,a)=>{const u=t===n-1;return e===Go.LEFT&&u?!0:s?e===Go.LEFT?!0:e===Go.RIGHT?!u:!u||a:!1},QE=(e,t)=>e===Go.RIGHT&&t===0,zfe=["column","rowId","editCellState","align","children","colIndex","width","className","style","gridHasScrollX","colSpan","disableDragEvents","isNotVisible","pinnedOffset","pinnedPosition","sectionIndex","sectionLength","gridHasFiller","onClick","onDoubleClick","onMouseDown","onMouseUp","onMouseOver","onKeyDown","onKeyUp","onDragEnter","onDragOver"],Ffe=["changeReason","unstable_updateValueOnRender"];let Kl=function(e){return e[e.NONE=0]="NONE",e[e.LEFT=1]="LEFT",e[e.RIGHT=2]="RIGHT",e[e.VIRTUAL=3]="VIRTUAL",e}({});const m$={[Kl.LEFT]:Go.LEFT,[Kl.RIGHT]:Go.RIGHT,[Kl.NONE]:void 0,[Kl.VIRTUAL]:void 0},nN={id:-1,field:"__unset__",row:{},rowNode:{id:-1,depth:0,type:"leaf",parent:-1,groupingKey:null},colDef:{type:"string",field:"__unset__",computedWidth:0},cellMode:Co.View,hasFocus:!1,tabIndex:-1,value:null,formattedValue:"__unset__",isEditable:!1,api:{}},Nfe=e=>{const{align:t,showLeftBorder:n,showRightBorder:s,pinnedPosition:a,isEditable:u,isSelected:f,isSelectionMode:_,classes:r}=e,C={root:["cell",`cell--text${Rn(t)}`,f&&"selected",u&&"cell--editable",n&&"cell--withLeftBorder",s&&"cell--withRightBorder",a===Kl.LEFT&&"cell--pinnedLeft",a===Kl.RIGHT&&"cell--pinnedRight",_&&!u&&"cell--selectionMode"]};return yr(C,Gi,r)},Bfe=X.forwardRef(function(t,n){var xn,Er,Rr;const{column:s,rowId:a,editCellState:u,align:f,colIndex:_,width:r,className:C,style:k,colSpan:I,disableDragEvents:P,isNotVisible:D,pinnedOffset:N,pinnedPosition:j,sectionIndex:W,sectionLength:H,gridHasFiller:q,onClick:Z,onDoubleClick:re,onMouseDown:le,onMouseUp:_e,onMouseOver:ye,onKeyDown:de,onKeyUp:ce,onDragEnter:oe,onDragOver:xe}=t,he=Zr(t,zfe),Ee=Bi(),se=Ur(),we=au(),Se=s.field,Pe=Kn(Ee,()=>{try{const Wn=Ee.current.getCellParams(a,Se);return Wn.api=Ee.current,Wn}catch(Wn){if(Wn instanceof xS)return nN;throw Wn}},gV),Me=Kn(Ee,()=>Ee.current.unstable_applyPipeProcessors("isCellSelected",!1,{id:a,field:Se})),Re=Kn(Ee,i$),Oe=Kn(Ee,The),{cellMode:$e,hasFocus:Ke,isEditable:Ct=!1,value:Ue}=Pe,ft=s.type==="actions"&&((xn=s.getActions)==null?void 0:xn.call(s,Ee.current.getRowParams(a)).some(Wn=>!Wn.props.disabled)),Bt=($e==="view"||!Ct)&&!ft?Pe.tabIndex:-1,{classes:hn,getCellClassName:ot}=se,wt=[Kn(Ee,()=>Ee.current.unstable_applyPipeProcessors("cellClassName",[],{id:a,field:Se}).filter(Boolean).join(" "))];s.cellClassName&&wt.push(typeof s.cellClassName=="function"?s.cellClassName(Pe):s.cellClassName),s.display==="flex"&&wt.push(xt["cell--flex"]),ot&&wt.push(ot(Pe));const Ne=Pe.formattedValue??Ue,We=X.useRef(null),Sn=mo(n,We),Ae=X.useRef(null),st=se.cellSelection??!1,gt=m$[j],ut=QE(gt,W),tt=JE(gt,W,H,se.showCellVerticalBorder,q),nt={align:f,showLeftBorder:ut,showRightBorder:tt,isEditable:Ct,classes:se.classes,pinnedPosition:j,isSelected:Me,isSelectionMode:st},tn=Nfe(nt),un=X.useCallback(Wn=>Mn=>{const Ar=Ee.current.getCellParams(a,Se||"");Ee.current.publishEvent(Wn,Ar,Mn),_e&&_e(Mn)},[Ee,Se,_e,a]),qt=X.useCallback(Wn=>Mn=>{const Ar=Ee.current.getCellParams(a,Se||"");Ee.current.publishEvent(Wn,Ar,Mn),le&&le(Mn)},[Ee,Se,le,a]),an=X.useCallback((Wn,Mn)=>Ar=>{if(!Ee.current.getRow(a))return;const fi=Ee.current.getCellParams(a,Se||"");Ee.current.publishEvent(Wn,fi,Ar),Mn&&Mn(Ar)},[Ee,Se,a]),Jt=((Er=Re[a])==null?void 0:Er[Se])??!1,Wt=((Rr=Oe[a])==null?void 0:Rr[Se])??1,Fn=X.useMemo(()=>{if(D)return{padding:0,opacity:0,width:0,border:0};const Wn=Ge({"--width":`${r}px`},k),Mn=j===Kl.LEFT,Ar=j===Kl.RIGHT;if(Mn||Ar){let fi=Mn?"left":"right";we&&(fi=Mn?"right":"left"),Wn[fi]=N}return Wt>1&&(Wn.height=`calc(var(--height) * ${Wt})`,Wn.zIndex=5),Wn},[r,D,k,N,j,we,Wt]);if(X.useEffect(()=>{if(!Ke||$e===Co.Edit)return;const Wn=As(Ee.current.rootElementRef.current);if(We.current&&!We.current.contains(Wn.activeElement)){const Mn=We.current.querySelector('[tabindex="0"]'),Ar=Ae.current||Mn||We.current;if(vfe())Ar.focus({preventScroll:!0});else{const fi=Ee.current.getScrollPosition();Ar.focus(),Ee.current.scroll(fi)}}},[Ke,$e,Ee]),Jt)return K.jsx("div",{"data-colindex":_,role:"presentation",style:Ge({width:"var(--width)"},Fn)});if(Pe===nN)return null;let ar=he.onFocus,bn,lr;if(u===null&&s.renderCell&&(bn=s.renderCell(Pe)),u!==null&&s.renderEditCell){const Wn=Ee.current.getRowWithUpdatedValues(a,s.field),Mn=Zr(u,Ffe),Ar=s.valueFormatter?s.valueFormatter(u.value,Wn,s,Ee):Pe.formattedValue,fi=Ge({},Pe,{row:Wn,formattedValue:Ar},Mn);bn=s.renderEditCell(fi),wt.push(xt["cell--editing"]),wt.push(hn==null?void 0:hn["cell--editing"])}if(bn===void 0){const Wn=Ne==null?void 0:Ne.toString();bn=Wn,lr=Wn}X.isValidElement(bn)&&ft&&(bn=X.cloneElement(bn,{focusElementRef:Ae}));const Cn=P?null:{onDragEnter:an("cellDragEnter",oe),onDragOver:an("cellDragOver",xe)};return K.jsx("div",Ge({ref:Sn,className:Hn(tn.root,wt,C),role:"gridcell","data-field":Se,"data-colindex":_,"aria-colindex":_+1,"aria-colspan":I,"aria-rowspan":Wt,style:Fn,title:lr,tabIndex:Bt,onClick:an("cellClick",Z),onDoubleClick:an("cellDoubleClick",re),onMouseOver:an("cellMouseOver",ye),onMouseDown:qt("cellMouseDown"),onMouseUp:un("cellMouseUp"),onKeyDown:an("cellKeyDown",de),onKeyUp:an("cellKeyUp",ce)},Cn,he,{onFocus:ar,children:bn}))}),jfe=xp(Bfe),Vfe=["field","type","align","width","height","empty","style","className"],rN="1.3em",$fe="1.2em",iN=[40,80],Ufe={number:[40,60],string:[40,80],date:[40,60],dateTime:[60,80],singleSelect:[40,80]},Gfe=e=>{const{align:t,classes:n,empty:s}=e,a={root:["cell","cellSkeleton",`cell--text${t?Rn(t):"Left"}`,s&&"cellEmpty"]};return yr(a,Gi,n)},Hfe=dce(12345);function Wfe(e){const{field:t,type:n,align:s,width:a,height:u,empty:f=!1,style:_,className:r}=e,C=Zr(e,Vfe),I={classes:Ur().classes,align:s,empty:f},P=Gfe(I),D=X.useMemo(()=>{if(n==="boolean"||n==="actions")return{variant:"circular",width:rN,height:rN};const[j,W]=n?Ufe[n]??iN:iN;return{variant:"text",width:`${Math.round(Hfe(j,W))}%`,height:$fe}},[n]);return K.jsx("div",Ge({"data-field":t,className:Hn(P.root,r),style:Ge({height:u,maxWidth:a,minWidth:a},_)},C,{children:!f&&K.jsx(tie,Ge({},D))}))}const qfe=xp(Wfe);function Xfe(e){return e.vars?e.vars.palette.TableCell.border:e.palette.mode==="light"?Fm(vi(e.palette.divider,1),.88):zm(vi(e.palette.divider,1),.68)}const oN={[`& .${xt.iconButtonContainer}`]:{visibility:"visible",width:"auto"},[`& .${xt.menuIcon}`]:{width:"auto",visibility:"visible"}},Yfe=10,Xw=-5,Qg=1,sN={width:3,rx:1.5,x:10.5},Zfe="/* emotion-disable-server-rendering-unsafe-selector-warning-please-do-not-use-this-the-warning-exists-for-a-reason */",Kfe=Dn("div",{name:"MuiDataGrid",slot:"Root",overridesResolver:(e,t)=>[{[`&.${xt.autoHeight}`]:t.autoHeight},{[`&.${xt.aggregationColumnHeader}`]:t.aggregationColumnHeader},{[`&.${xt["aggregationColumnHeader--alignLeft"]}`]:t["aggregationColumnHeader--alignLeft"]},{[`&.${xt["aggregationColumnHeader--alignCenter"]}`]:t["aggregationColumnHeader--alignCenter"]},{[`&.${xt["aggregationColumnHeader--alignRight"]}`]:t["aggregationColumnHeader--alignRight"]},{[`&.${xt.aggregationColumnHeaderLabel}`]:t.aggregationColumnHeaderLabel},{[`&.${xt["root--disableUserSelection"]} .${xt.cell}`]:t["root--disableUserSelection"]},{[`&.${xt.autosizing}`]:t.autosizing},{[`& .${xt.editBooleanCell}`]:t.editBooleanCell},{[`& .${xt.cell}`]:t.cell},{[`& .${xt["cell--editing"]}`]:t["cell--editing"]},{[`& .${xt["cell--textCenter"]}`]:t["cell--textCenter"]},{[`& .${xt["cell--textLeft"]}`]:t["cell--textLeft"]},{[`& .${xt["cell--textRight"]}`]:t["cell--textRight"]},{[`& .${xt["cell--rangeTop"]}`]:t["cell--rangeTop"]},{[`& .${xt["cell--rangeBottom"]}`]:t["cell--rangeBottom"]},{[`& .${xt["cell--rangeLeft"]}`]:t["cell--rangeLeft"]},{[`& .${xt["cell--rangeRight"]}`]:t["cell--rangeRight"]},{[`& .${xt["cell--withRightBorder"]}`]:t["cell--withRightBorder"]},{[`& .${xt.cellCheckbox}`]:t.cellCheckbox},{[`& .${xt.cellSkeleton}`]:t.cellSkeleton},{[`& .${xt.checkboxInput}`]:t.checkboxInput},{[`& .${xt["columnHeader--alignCenter"]}`]:t["columnHeader--alignCenter"]},{[`& .${xt["columnHeader--alignLeft"]}`]:t["columnHeader--alignLeft"]},{[`& .${xt["columnHeader--alignRight"]}`]:t["columnHeader--alignRight"]},{[`& .${xt["columnHeader--dragging"]}`]:t["columnHeader--dragging"]},{[`& .${xt["columnHeader--moving"]}`]:t["columnHeader--moving"]},{[`& .${xt["columnHeader--numeric"]}`]:t["columnHeader--numeric"]},{[`& .${xt["columnHeader--sortable"]}`]:t["columnHeader--sortable"]},{[`& .${xt["columnHeader--sorted"]}`]:t["columnHeader--sorted"]},{[`& .${xt["columnHeader--withRightBorder"]}`]:t["columnHeader--withRightBorder"]},{[`& .${xt.columnHeader}`]:t.columnHeader},{[`& .${xt.headerFilterRow}`]:t.headerFilterRow},{[`& .${xt.columnHeaderCheckbox}`]:t.columnHeaderCheckbox},{[`& .${xt.columnHeaderDraggableContainer}`]:t.columnHeaderDraggableContainer},{[`& .${xt.columnHeaderTitleContainer}`]:t.columnHeaderTitleContainer},{[`& .${xt["columnSeparator--resizable"]}`]:t["columnSeparator--resizable"]},{[`& .${xt["columnSeparator--resizing"]}`]:t["columnSeparator--resizing"]},{[`& .${xt.columnSeparator}`]:t.columnSeparator},{[`& .${xt.filterIcon}`]:t.filterIcon},{[`& .${xt.iconSeparator}`]:t.iconSeparator},{[`& .${xt.menuIcon}`]:t.menuIcon},{[`& .${xt.menuIconButton}`]:t.menuIconButton},{[`& .${xt.menuOpen}`]:t.menuOpen},{[`& .${xt.menuList}`]:t.menuList},{[`& .${xt["row--editable"]}`]:t["row--editable"]},{[`& .${xt["row--editing"]}`]:t["row--editing"]},{[`& .${xt["row--dragging"]}`]:t["row--dragging"]},{[`& .${xt.row}`]:t.row},{[`& .${xt.rowReorderCellPlaceholder}`]:t.rowReorderCellPlaceholder},{[`& .${xt.rowReorderCell}`]:t.rowReorderCell},{[`& .${xt["rowReorderCell--draggable"]}`]:t["rowReorderCell--draggable"]},{[`& .${xt.sortIcon}`]:t.sortIcon},{[`& .${xt.withBorderColor}`]:t.withBorderColor},{[`& .${xt.treeDataGroupingCell}`]:t.treeDataGroupingCell},{[`& .${xt.treeDataGroupingCellToggle}`]:t.treeDataGroupingCellToggle},{[`& .${xt.treeDataGroupingCellLoadingContainer}`]:t.treeDataGroupingCellLoadingContainer},{[`& .${xt.groupingCriteriaCellLoadingContainer}`]:t.groupingCriteriaCellLoadingContainer},{[`& .${xt.detailPanelToggleCell}`]:t.detailPanelToggleCell},{[`& .${xt["detailPanelToggleCell--expanded"]}`]:t["detailPanelToggleCell--expanded"]},t.root]})(({theme:e})=>{var de,ce;const t=Sc(),n=Kn(t,Ga),s=Xfe(e),a=e.shape.borderRadius,u=e.vars?e.vars.palette.background.default:((de=e.mixins.MuiDataGrid)==null?void 0:de.containerBackground)??e.palette.background.default,f=((ce=e.mixins.MuiDataGrid)==null?void 0:ce.pinnedBackground)??u,_=e.vars?`rgba(${e.vars.palette.background.defaultChannel} / ${e.vars.palette.action.disabledOpacity})`:vi(e.palette.background.default,e.palette.action.disabledOpacity),r=(e.vars||e).palette.action.hoverOpacity,C=(e.vars||e).palette.action.hover,k=(e.vars||e).palette.action.selectedOpacity,I=e.vars?`calc(${r} + ${k})`:r+k,P=e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${k})`:vi(e.palette.primary.main,k),D=e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${I})`:vi(e.palette.primary.main,I),N=e.vars?epe:Jfe,j=oe=>({[`& .${xt["cell--pinnedLeft"]}, & .${xt["cell--pinnedRight"]}`]:{backgroundColor:oe,"&.Mui-selected":{backgroundColor:N(oe,P,k),"&:hover":{backgroundColor:N(oe,P,I)}}}}),W=N(f,C,r),H=j(W),q=N(f,P,k),Z=j(q),re=N(f,D,I),le=j(re),_e={backgroundColor:P,"&:hover":{backgroundColor:D,"@media (hover: none)":{backgroundColor:P}}};return Ge({"--unstable_DataGrid-radius":typeof a=="number"?`${a}px`:a,"--unstable_DataGrid-headWeight":e.typography.fontWeightMedium,"--unstable_DataGrid-overlayBackground":_,"--DataGrid-containerBackground":u,"--DataGrid-pinnedBackground":f,"--DataGrid-rowBorderColor":s,"--DataGrid-cellOffsetMultiplier":2,"--DataGrid-width":"0px","--DataGrid-hasScrollX":"0","--DataGrid-hasScrollY":"0","--DataGrid-scrollbarSize":"10px","--DataGrid-rowWidth":"0px","--DataGrid-columnsTotalWidth":"0px","--DataGrid-leftPinnedWidth":"0px","--DataGrid-rightPinnedWidth":"0px","--DataGrid-headerHeight":"0px","--DataGrid-headersTotalHeight":"0px","--DataGrid-topContainerHeight":"0px","--DataGrid-bottomContainerHeight":"0px",flex:1,boxSizing:"border-box",position:"relative",borderWidth:"1px",borderStyle:"solid",borderColor:s,borderRadius:"var(--unstable_DataGrid-radius)",color:(e.vars||e).palette.text.primary},e.typography.body2,{outline:"none",height:"100%",display:"flex",minWidth:0,minHeight:0,flexDirection:"column",overflow:"hidden",overflowAnchor:"none",[`.${xt.main} > *:first-child${Zfe}`]:{borderTopLeftRadius:"var(--unstable_DataGrid-radius)",borderTopRightRadius:"var(--unstable_DataGrid-radius)"},[`&.${xt.autoHeight}`]:{height:"auto"},[`&.${xt.autosizing}`]:{[`& .${xt.columnHeaderTitleContainerContent} > *`]:{overflow:"visible !important"},"@media (hover: hover)":{[`& .${xt.iconButtonContainer}`]:{width:"0 !important",visibility:"hidden !important"},[`& .${xt.menuIcon}`]:{width:"0 !important",visibility:"hidden !important"}},[`& .${xt.cell}`]:{overflow:"visible !important",whiteSpace:"nowrap",minWidth:"max-content !important",maxWidth:"max-content !important"},[`& .${xt.groupingCriteriaCell}`]:{width:"unset"},[`& .${xt.treeDataGroupingCell}`]:{width:"unset"}},[`& .${xt.columnHeader}, & .${xt.cell}`]:{WebkitTapHighlightColor:"transparent",padding:"0 10px",boxSizing:"border-box"},[`& .${xt.columnHeader}:focus-within, & .${xt.cell}:focus-within`]:{outline:`solid ${e.vars?`rgba(${e.vars.palette.primary.mainChannel} / 0.5)`:vi(e.palette.primary.main,.5)} ${Qg}px`,outlineOffset:Qg*-1},[`& .${xt.columnHeader}:focus, & .${xt.cell}:focus`]:{outline:`solid ${e.palette.primary.main} ${Qg}px`,outlineOffset:Qg*-1},[`& .${xt.columnHeader}:focus,
      & .${xt["columnHeader--withLeftBorder"]},
      & .${xt["columnHeader--withRightBorder"]},
      & .${xt["columnHeader--siblingFocused"]},
      & .${xt["virtualScroller--hasScrollX"]} .${xt["columnHeader--lastUnpinned"]},
      & .${xt["virtualScroller--hasScrollX"]} .${xt["columnHeader--last"]}
      `]:{[`& .${xt.columnSeparator}`]:{opacity:0},"@media (hover: none)":{[`& .${xt["columnSeparator--resizable"]}`]:{opacity:1}},[`& .${xt["columnSeparator--resizable"]}:hover`]:{opacity:1}},[`&.${xt["root--noToolbar"]} [aria-rowindex="1"] [aria-colindex="1"]`]:{borderTopLeftRadius:"calc(var(--unstable_DataGrid-radius) - 1px)"},[`&.${xt["root--noToolbar"]} [aria-rowindex="1"] .${xt["columnHeader--last"]}`]:{borderTopRightRadius:n.hasScrollX&&(!n.hasScrollY||n.scrollbarSize===0)?"calc(var(--unstable_DataGrid-radius) - 1px)":void 0},[`& .${xt.columnHeaderCheckbox}, & .${xt.cellCheckbox}`]:{padding:0,justifyContent:"center",alignItems:"center"},[`& .${xt.columnHeader}`]:{position:"relative",display:"flex",alignItems:"center"},[`& .${xt["virtualScroller--hasScrollX"]} .${xt["columnHeader--last"]}`]:{overflow:"hidden"},[`& .${xt["columnHeader--sorted"]} .${xt.iconButtonContainer}, & .${xt["columnHeader--filtered"]} .${xt.iconButtonContainer}`]:{visibility:"visible",width:"auto"},[`& .${xt.columnHeader}:not(.${xt["columnHeader--sorted"]}) .${xt.sortIcon}`]:{opacity:0,transition:e.transitions.create(["opacity"],{duration:e.transitions.duration.shorter})},[`& .${xt.columnHeaderTitleContainer}`]:{display:"flex",alignItems:"center",gap:e.spacing(.25),minWidth:0,flex:1,whiteSpace:"nowrap",overflow:"hidden"},[`& .${xt.columnHeaderTitleContainerContent}`]:{overflow:"hidden",display:"flex",alignItems:"center"},[`& .${xt["columnHeader--filledGroup"]} .${xt.columnHeaderTitleContainer}`]:{borderBottomWidth:"1px",borderBottomStyle:"solid",boxSizing:"border-box"},[`& .${xt.sortIcon}, & .${xt.filterIcon}`]:{fontSize:"inherit"},[`& .${xt["columnHeader--sortable"]}`]:{cursor:"pointer"},[`& .${xt["columnHeader--alignCenter"]} .${xt.columnHeaderTitleContainer}`]:{justifyContent:"center"},[`& .${xt["columnHeader--alignRight"]} .${xt.columnHeaderDraggableContainer}, & .${xt["columnHeader--alignRight"]} .${xt.columnHeaderTitleContainer}`]:{flexDirection:"row-reverse"},[`& .${xt["columnHeader--alignCenter"]} .${xt.menuIcon}`]:{marginLeft:"auto"},[`& .${xt["columnHeader--alignRight"]} .${xt.menuIcon}`]:{marginRight:"auto",marginLeft:-5},[`& .${xt["columnHeader--moving"]}`]:{backgroundColor:(e.vars||e).palette.action.hover},[`& .${xt["columnHeader--pinnedLeft"]}, & .${xt["columnHeader--pinnedRight"]}`]:{position:"sticky",zIndex:4,background:"var(--DataGrid-pinnedBackground)"},[`& .${xt.columnSeparator}`]:{position:"absolute",overflow:"hidden",zIndex:3,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",maxWidth:Yfe,color:s},[`& .${xt.columnHeaders}`]:{width:"var(--DataGrid-rowWidth)"},"@media (hover: hover)":{[`& .${xt.columnHeader}:hover`]:oN,[`& .${xt.columnHeader}:not(.${xt["columnHeader--sorted"]}):hover .${xt.sortIcon}`]:{opacity:.5}},"@media (hover: none)":{[`& .${xt.columnHeader}`]:oN,[`& .${xt.columnHeader}:focus,
        & .${xt["columnHeader--siblingFocused"]}`]:{[`.${xt["columnSeparator--resizable"]}`]:{color:(e.vars||e).palette.primary.main}}},[`& .${xt["columnSeparator--sideLeft"]}`]:{left:Xw},[`& .${xt["columnSeparator--sideRight"]}`]:{right:Xw},[`& .${xt["columnHeader--withRightBorder"]} .${xt["columnSeparator--sideLeft"]}`]:{left:Xw-.5},[`& .${xt["columnHeader--withRightBorder"]} .${xt["columnSeparator--sideRight"]}`]:{right:Xw-.5},[`& .${xt["columnSeparator--resizable"]}`]:{cursor:"col-resize",touchAction:"none",[`&.${xt["columnSeparator--resizing"]}`]:{color:(e.vars||e).palette.primary.main},"@media (hover: none)":{[`& .${xt.iconSeparator} rect`]:sN},"@media (hover: hover)":{"&:hover":{color:(e.vars||e).palette.primary.main,[`& .${xt.iconSeparator} rect`]:sN}},"& svg":{pointerEvents:"none"}},[`& .${xt.iconSeparator}`]:{color:"inherit",transition:e.transitions.create(["color","width"],{duration:e.transitions.duration.shortest})},[`& .${xt.menuIcon}`]:{width:0,visibility:"hidden",fontSize:20,marginRight:-5,display:"flex",alignItems:"center"},[`.${xt.menuOpen}`]:{visibility:"visible",width:"auto"},[`& .${xt.headerFilterRow}`]:{[`& .${xt.columnHeader}`]:{boxSizing:"border-box",borderBottom:"1px solid var(--DataGrid-rowBorderColor)"}},[`& .${xt["row--borderBottom"]} .${xt.columnHeader},
      & .${xt["row--borderBottom"]} .${xt.filler},
      & .${xt["row--borderBottom"]} .${xt.scrollbarFiller}`]:{borderBottom:"1px solid var(--DataGrid-rowBorderColor)"},[`& .${xt["row--borderBottom"]} .${xt.cell}`]:{borderBottom:"1px solid var(--rowBorderColor)"},[`.${xt.row}`]:{display:"flex",width:"var(--DataGrid-rowWidth)",breakInside:"avoid","--rowBorderColor":"var(--DataGrid-rowBorderColor)",[`&.${xt["row--firstVisible"]}`]:{"--rowBorderColor":"transparent"},"&:hover":{backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${xt.rowSkeleton}:hover`]:{backgroundColor:"transparent"},"&.Mui-selected":_e},[`& .${xt["container--top"]}, & .${xt["container--bottom"]}`]:{"[role=row]":{background:"var(--DataGrid-containerBackground)"}},[`& .${xt.cell}`]:{flex:"0 0 auto",height:"var(--height)",width:"var(--width)",lineHeight:"calc(var(--height) - 1px)",boxSizing:"border-box",borderTop:"1px solid var(--rowBorderColor)",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis","&.Mui-selected":_e},[`& .${xt["virtualScrollerContent--overflowed"]} .${xt["row--lastVisible"]} .${xt.cell}`]:{borderTopColor:"transparent"},[`& .${xt["pinnedRows--top"]} :first-of-type`]:{[`& .${xt.cell}, .${xt.scrollbarFiller}`]:{borderTop:"none"}},[`&.${xt["root--disableUserSelection"]} .${xt.cell}`]:{userSelect:"none"},[`& .${xt["row--dynamicHeight"]} > .${xt.cell}`]:{whiteSpace:"initial",lineHeight:"inherit"},[`& .${xt.cellEmpty}`]:{padding:0,height:"unset"},[`& .${xt.cell}.${xt["cell--selectionMode"]}`]:{cursor:"default"},[`& .${xt.cell}.${xt["cell--editing"]}`]:{padding:1,display:"flex",boxShadow:e.shadows[2],backgroundColor:(e.vars||e).palette.background.paper,"&:focus-within":{outline:`${Qg}px solid ${(e.vars||e).palette.primary.main}`,outlineOffset:Qg*-1}},[`& .${xt["row--editing"]}`]:{boxShadow:e.shadows[2]},[`& .${xt["row--editing"]} .${xt.cell}`]:{boxShadow:e.shadows[0],backgroundColor:(e.vars||e).palette.background.paper},[`& .${xt.editBooleanCell}`]:{display:"flex",height:"100%",width:"100%",alignItems:"center",justifyContent:"center"},[`& .${xt.booleanCell}[data-value="true"]`]:{color:(e.vars||e).palette.text.secondary},[`& .${xt.booleanCell}[data-value="false"]`]:{color:(e.vars||e).palette.text.disabled},[`& .${xt.actionsCell}`]:{display:"inline-flex",alignItems:"center",gridGap:e.spacing(1)},[`& .${xt.rowReorderCell}`]:{display:"inline-flex",flex:1,alignItems:"center",justifyContent:"center",opacity:(e.vars||e).palette.action.disabledOpacity},[`& .${xt["rowReorderCell--draggable"]}`]:{cursor:"move",opacity:1},[`& .${xt.rowReorderCellContainer}`]:{padding:0,display:"flex",alignItems:"stretch"},[`.${xt.withBorderColor}`]:{borderColor:s},[`& .${xt["cell--withLeftBorder"]}, & .${xt["columnHeader--withLeftBorder"]}`]:{borderLeftColor:"var(--DataGrid-rowBorderColor)",borderLeftWidth:"1px",borderLeftStyle:"solid"},[`& .${xt["cell--withRightBorder"]}, & .${xt["columnHeader--withRightBorder"]}`]:{borderRightColor:"var(--DataGrid-rowBorderColor)",borderRightWidth:"1px",borderRightStyle:"solid"},[`& .${xt["cell--flex"]}`]:{display:"flex",alignItems:"center",lineHeight:"inherit"},[`& .${xt["cell--textLeft"]}`]:{textAlign:"left",justifyContent:"flex-start"},[`& .${xt["cell--textRight"]}`]:{textAlign:"right",justifyContent:"flex-end"},[`& .${xt["cell--textCenter"]}`]:{textAlign:"center",justifyContent:"center"},[`& .${xt["cell--pinnedLeft"]}, & .${xt["cell--pinnedRight"]}`]:{position:"sticky",zIndex:3,background:"var(--DataGrid-pinnedBackground)","&.Mui-selected":{backgroundColor:q}},[`& .${xt.virtualScrollerContent} .${xt.row}`]:{"&:hover":H,"&.Mui-selected":Z,"&.Mui-selected:hover":le},[`& .${xt.cellOffsetLeft}`]:{flex:"0 0 auto",display:"inline-block"},[`& .${xt.cellSkeleton}`]:{flex:"0 0 auto",height:"100%",display:"inline-flex",alignItems:"center"},[`& .${xt.columnHeaderDraggableContainer}`]:{display:"flex",width:"100%",height:"100%"},[`& .${xt.rowReorderCellPlaceholder}`]:{display:"none"},[`& .${xt["columnHeader--dragging"]}, & .${xt["row--dragging"]}`]:{background:(e.vars||e).palette.background.paper,padding:"0 12px",borderRadius:"var(--unstable_DataGrid-radius)",opacity:(e.vars||e).palette.action.disabledOpacity},[`& .${xt["row--dragging"]}`]:{background:(e.vars||e).palette.background.paper,padding:"0 12px",borderRadius:"var(--unstable_DataGrid-radius)",opacity:(e.vars||e).palette.action.disabledOpacity,[`& .${xt.rowReorderCellPlaceholder}`]:{display:"flex"}},[`& .${xt.treeDataGroupingCell}`]:{display:"flex",alignItems:"center",width:"100%"},[`& .${xt.treeDataGroupingCellToggle}`]:{flex:"0 0 28px",alignSelf:"stretch",marginRight:e.spacing(2)},[`& .${xt.treeDataGroupingCellLoadingContainer}, .${xt.groupingCriteriaCellLoadingContainer}`]:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%"},[`& .${xt.groupingCriteriaCell}`]:{display:"flex",alignItems:"center",width:"100%"},[`& .${xt.groupingCriteriaCellToggle}`]:{flex:"0 0 28px",alignSelf:"stretch",marginRight:e.spacing(2)},[`.${xt.scrollbarFiller}`]:{minWidth:"calc(var(--DataGrid-hasScrollY) * var(--DataGrid-scrollbarSize))",alignSelf:"stretch",[`&.${xt["scrollbarFiller--borderTop"]}`]:{borderTop:"1px solid var(--DataGrid-rowBorderColor)"},[`&.${xt["scrollbarFiller--borderBottom"]}`]:{borderBottom:"1px solid var(--DataGrid-rowBorderColor)"},[`&.${xt["scrollbarFiller--pinnedRight"]}`]:{backgroundColor:"var(--DataGrid-pinnedBackground)",position:"sticky",right:0}},[`& .${xt.filler}`]:{flex:"1 0 auto"},[`& .${xt["filler--borderBottom"]}`]:{borderBottom:"1px solid var(--DataGrid-rowBorderColor)"},[`& .${xt["main--hasSkeletonLoadingOverlay"]}`]:{[`& .${xt.virtualScrollerContent}`]:{position:"fixed",visibility:"hidden"},[`& .${xt["scrollbar--vertical"]}, & .${xt.pinnedRows}, & .${xt.virtualScroller} > .${xt.filler}`]:{display:"none"}}})});function Jfe(e,t,n,s=1){const a=(r,C)=>Math.round((r**(1/s)*(1-n)+C**(1/s)*n)**s),u=Xd(e),f=Xd(t),_=[a(u.values[0],f.values[0]),a(u.values[1],f.values[1]),a(u.values[2],f.values[2])];return l1({type:"rgb",values:_})}const Qfe=e=>`rgb(from ${e} r g b / 1)`;function epe(e,t,n){return`color-mix(in srgb,${e}, ${Qfe(t)} calc(${n} * 100%))`}const tpe=["className"],npe=(e,t)=>{const{autoHeight:n,classes:s,showCellVerticalBorder:a}=e,u={root:["root",n&&"autoHeight",`root--density${Rn(t)}`,e.slots.toolbar===null&&"root--noToolbar","withBorderColor",a&&"withVerticalBorder"]};return yr(u,Gi,s)},rpe=X.forwardRef(function(t,n){const s=Ur(),{className:a}=t,u=Zr(t,tpe),f=Sc(),_=Kn(f,Sy),r=f.current.rootElementRef,C=mo(r,n),k=s,I=npe(k,_),[P,D]=X.useState(!1);return Io(()=>{D(!0)},[]),P?K.jsx(Kfe,Ge({ref:C,className:Hn(I.root,a),ownerState:k},u)):null}),ipe=["className"],ope=e=>{const{classes:t}=e;return yr({root:["footerContainer","withBorderColor"]},Gi,t)},spe=Wo("div",{name:"MuiDataGrid",slot:"FooterContainer",overridesResolver:(e,t)=>t.footerContainer})({display:"flex",justifyContent:"space-between",alignItems:"center",minHeight:52,borderTop:"1px solid"}),ape=X.forwardRef(function(t,n){const{className:s}=t,a=Zr(t,ipe),u=Ur(),f=ope(u);return K.jsx(spe,Ge({ref:n,className:Hn(f.root,s),ownerState:u},a))}),lpe=["className"],upe=e=>{const{classes:t}=e;return yr({root:["overlay"]},Gi,t)},cpe=Wo("div",{name:"MuiDataGrid",slot:"Overlay",overridesResolver:(e,t)=>t.overlay})({width:"100%",height:"100%",display:"flex",alignSelf:"center",alignItems:"center",justifyContent:"center",backgroundColor:"var(--unstable_DataGrid-overlayBackground)"}),XA=X.forwardRef(function(t,n){const{className:s}=t,a=Zr(t,lpe),u=Ur(),f=upe(u);return K.jsx(cpe,Ge({ref:n,className:Hn(f.root,s),ownerState:u},a))}),dpe=e=>{const{classes:t,open:n}=e;return yr({root:["menuIcon",n&&"menuOpen"],button:["menuIconButton"]},Gi,t)},hpe=X.memo(e=>{var I,P;const{colDef:t,open:n,columnMenuId:s,columnMenuButtonId:a,iconButtonRef:u}=e,f=Bi(),_=Ur(),r=Ge({},e,{classes:_.classes}),C=dpe(r),k=X.useCallback(D=>{D.preventDefault(),D.stopPropagation(),f.current.toggleColumnMenu(t.field)},[f,t.field]);return K.jsx("div",{className:C.root,children:K.jsx(_.slots.baseTooltip,Ge({title:f.current.getLocaleText("columnMenuLabel"),enterDelay:1e3},(I=_.slotProps)==null?void 0:I.baseTooltip,{children:K.jsx(_.slots.baseIconButton,Ge({ref:u,tabIndex:-1,className:C.button,"aria-label":f.current.getLocaleText("columnMenuLabel"),size:"small",onClick:k,"aria-haspopup":"menu","aria-expanded":n,"aria-controls":n?s:void 0,id:a},(P=_.slotProps)==null?void 0:P.baseIconButton,{children:K.jsx(_.slots.columnMenuIcon,{fontSize:"inherit"})}))}))})});function fpe({columnMenuId:e,columnMenuButtonId:t,ContentComponent:n,contentComponentProps:s,field:a,open:u,target:f,onExited:_}){const r=Bi(),C=r.current.getColumn(a),k=Ui(I=>{I&&(I.stopPropagation(),f!=null&&f.contains(I.target))||r.current.hideColumnMenu()});return!f||!C?null:K.jsx(AV,{placement:`bottom-${C.align==="right"?"start":"end"}`,open:u,target:f,onClose:k,onExited:_,children:K.jsx(n,Ge({colDef:C,hideMenu:k,open:u,id:e,labelledby:t},s))})}const ppe=["className","aria-label"],mpe=e=>{const{classes:t}=e;return yr({root:["columnHeaderTitle"]},Gi,t)},gpe=Wo("div",{name:"MuiDataGrid",slot:"ColumnHeaderTitle",overridesResolver:(e,t)=>t.columnHeaderTitle})({textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",fontWeight:"var(--unstable_DataGrid-headWeight)",lineHeight:"normal"}),ype=X.forwardRef(function(t,n){const{className:s}=t,a=Zr(t,ppe),u=Ur(),f=mpe(u);return K.jsx(gpe,Ge({ref:n,className:Hn(f.root,s),ownerState:u},a))});function _pe(e){var r;const{label:t,description:n}=e,s=Ur(),a=X.useRef(null),[u,f]=X.useState(""),_=X.useCallback(()=>{if(!n&&(a!=null&&a.current)){const C=xfe(a.current);f(C?t:"")}},[n,t]);return K.jsx(s.slots.baseTooltip,Ge({title:n||u},(r=s.slotProps)==null?void 0:r.baseTooltip,{children:K.jsx(ype,{onMouseOver:_,ref:a,children:t})}))}const vpe=["resizable","resizing","height","side"];var YA=function(e){return e.Left="left",e.Right="right",e}(YA||{});const xpe=e=>{const{resizable:t,resizing:n,classes:s,side:a}=e,u={root:["columnSeparator",t&&"columnSeparator--resizable",n&&"columnSeparator--resizing",a&&`columnSeparator--side${Rn(a)}`],icon:["iconSeparator"]};return yr(u,Gi,s)};function bpe(e){const{height:t,side:n=YA.Right}=e,s=Zr(e,vpe),a=Ur(),u=Ge({},e,{side:n,classes:a.classes}),f=xpe(u),_=X.useCallback(r=>{r.preventDefault(),r.stopPropagation()},[]);return K.jsx("div",Ge({className:f.root,style:{minHeight:t}},s,{onClick:_,children:K.jsx(a.slots.columnResizeIcon,{className:f.icon})}))}const wpe=X.memo(bpe),Spe=["classes","columnMenuOpen","colIndex","height","isResizing","sortDirection","hasFocus","tabIndex","separatorSide","isDraggable","headerComponent","description","elementId","width","columnMenuIconButton","columnMenu","columnTitleIconButtons","headerClassName","label","resizable","draggableContainerProps","columnHeaderSeparatorProps","style"],g$=X.forwardRef(function(t,n){const{classes:s,colIndex:a,height:u,isResizing:f,sortDirection:_,hasFocus:r,tabIndex:C,separatorSide:k,isDraggable:I,headerComponent:P,description:D,width:N,columnMenuIconButton:j=null,columnMenu:W=null,columnTitleIconButtons:H=null,headerClassName:q,label:Z,resizable:re,draggableContainerProps:le,columnHeaderSeparatorProps:_e,style:ye}=t,de=Zr(t,Spe),ce=Sc(),oe=Ur(),xe=X.useRef(null),he=mo(xe,n);let Ee="none";return _!=null&&(Ee=_==="asc"?"ascending":"descending"),X.useLayoutEffect(()=>{var we;const se=ce.current.state.columnMenu;if(r&&!se.open){const Pe=xe.current.querySelector('[tabindex="0"]')||xe.current;Pe==null||Pe.focus(),(we=ce.current.columnHeadersContainerRef)!=null&&we.current&&(ce.current.columnHeadersContainerRef.current.scrollLeft=0)}},[ce,r]),K.jsxs("div",Ge({ref:he,className:Hn(s.root,q),style:Ge({},ye,{height:u,width:N}),role:"columnheader",tabIndex:C,"aria-colindex":a+1,"aria-sort":Ee},de,{children:[K.jsxs("div",Ge({className:s.draggableContainer,draggable:I,role:"presentation"},le,{children:[K.jsxs("div",{className:s.titleContainer,role:"presentation",children:[K.jsx("div",{className:s.titleContainerContent,children:P!==void 0?P:K.jsx(_pe,{label:Z,description:D,columnWidth:N})}),H]}),j]})),K.jsx(wpe,Ge({resizable:!oe.disableColumnResize&&!!re,resizing:f,height:u,side:k},_e)),W]}))}),Cpe=e=>{const{colDef:t,classes:n,isDragging:s,sortDirection:a,showRightBorder:u,showLeftBorder:f,filterItemsCounter:_,pinnedPosition:r,isLastUnpinned:C,isSiblingFocused:k}=e,I=a!=null,P=_!=null&&_>0,D=t.type==="number",N={root:["columnHeader",t.headerAlign==="left"&&"columnHeader--alignLeft",t.headerAlign==="center"&&"columnHeader--alignCenter",t.headerAlign==="right"&&"columnHeader--alignRight",t.sortable&&"columnHeader--sortable",s&&"columnHeader--moving",I&&"columnHeader--sorted",P&&"columnHeader--filtered",D&&"columnHeader--numeric","withBorderColor",u&&"columnHeader--withRightBorder",f&&"columnHeader--withLeftBorder",r==="left"&&"columnHeader--pinnedLeft",r==="right"&&"columnHeader--pinnedRight",C&&"columnHeader--lastUnpinned",k&&"columnHeader--siblingFocused"],draggableContainer:["columnHeaderDraggableContainer"],titleContainer:["columnHeaderTitleContainer"],titleContainerContent:["columnHeaderTitleContainerContent"]};return yr(N,Gi,n)};function Epe(e){var en,wt,Ne;const{colDef:t,columnMenuOpen:n,colIndex:s,headerHeight:a,isResizing:u,isLast:f,sortDirection:_,sortIndex:r,filterItemsCounter:C,hasFocus:k,tabIndex:I,disableReorder:P,separatorSide:D,style:N,pinnedPosition:j,indexInSection:W,sectionLength:H,gridHasFiller:q}=e,Z=Sc(),re=Ur(),le=X.useRef(null),_e=ls(),ye=ls(),de=X.useRef(null),[ce,oe]=X.useState(n),xe=X.useMemo(()=>!re.disableColumnReorder&&!P&&!t.disableReorder,[re.disableColumnReorder,P,t.disableReorder]);let he;t.renderHeader&&(he=t.renderHeader(Z.current.getColumnHeaderParams(t.field)));const Ee=QE(j,W),se=JE(j,W,H,re.showColumnVerticalBorder,q),we=Ge({},e,{classes:re.classes,showRightBorder:se,showLeftBorder:Ee}),Se=Cpe(we),Pe=X.useCallback(We=>Sn=>{I1(Sn)||Z.current.publishEvent(We,Z.current.getColumnHeaderParams(t.field),Sn)},[Z,t.field]),Me=X.useMemo(()=>({onClick:Pe("columnHeaderClick"),onContextMenu:Pe("columnHeaderContextMenu"),onDoubleClick:Pe("columnHeaderDoubleClick"),onMouseOver:Pe("columnHeaderOver"),onMouseOut:Pe("columnHeaderOut"),onMouseEnter:Pe("columnHeaderEnter"),onMouseLeave:Pe("columnHeaderLeave"),onKeyDown:Pe("columnHeaderKeyDown"),onFocus:Pe("columnHeaderFocus"),onBlur:Pe("columnHeaderBlur")}),[Pe]),Re=X.useMemo(()=>xe?{onDragStart:Pe("columnHeaderDragStart"),onDragEnter:Pe("columnHeaderDragEnter"),onDragOver:Pe("columnHeaderDragOver"),onDragEnd:Pe("columnHeaderDragEnd")}:{},[xe,Pe]),Oe=X.useMemo(()=>({onMouseDown:Pe("columnSeparatorMouseDown"),onDoubleClick:Pe("columnSeparatorDoubleClick")}),[Pe]);X.useEffect(()=>{ce||oe(n)},[ce,n]);const $e=X.useCallback(()=>{oe(!1)},[]),Ke=!re.disableColumnMenu&&!t.disableColumnMenu&&K.jsx(hpe,{colDef:t,columnMenuId:_e,columnMenuButtonId:ye,open:ce,iconButtonRef:de}),Ct=K.jsx(fpe,{columnMenuId:_e,columnMenuButtonId:ye,field:t.field,open:n,target:de.current,ContentComponent:re.slots.columnMenu,contentComponentProps:(en=re.slotProps)==null?void 0:en.columnMenu,onExited:$e}),Ue=t.sortingOrder??re.sortingOrder,ft=(t.sortable||_!=null)&&!t.hideSortIcons&&!re.disableColumnSorting,Bt=K.jsxs(X.Fragment,{children:[!re.disableColumnFilter&&K.jsx(re.slots.columnHeaderFilterIconButton,Ge({field:t.field,counter:C},(wt=re.slotProps)==null?void 0:wt.columnHeaderFilterIconButton)),ft&&K.jsx(re.slots.columnHeaderSortIcon,Ge({field:t.field,direction:_,index:r,sortingOrder:Ue,disabled:!t.sortable},(Ne=re.slotProps)==null?void 0:Ne.columnHeaderSortIcon))]});X.useLayoutEffect(()=>{var Sn;const We=Z.current.state.columnMenu;if(k&&!We.open){const st=le.current.querySelector('[tabindex="0"]')||le.current;st==null||st.focus(),(Sn=Z.current.columnHeadersContainerRef)!=null&&Sn.current&&(Z.current.columnHeadersContainerRef.current.scrollLeft=0)}},[Z,k]);const hn=typeof t.headerClassName=="function"?t.headerClassName({field:t.field,colDef:t}):t.headerClassName,ot=t.headerName??t.field;return K.jsx(g$,Ge({ref:le,classes:Se,columnMenuOpen:n,colIndex:s,height:a,isResizing:u,sortDirection:_,hasFocus:k,tabIndex:I,separatorSide:D,isDraggable:xe,headerComponent:he,description:t.description,elementId:t.field,width:t.computedWidth,columnMenuIconButton:Ke,columnTitleIconButtons:Bt,headerClassName:Hn(hn,f&&xt["columnHeader--last"]),label:ot,resizable:!re.disableColumnResize&&!!t.resizable,"data-field":t.field,columnMenu:Ct,draggableContainerProps:Re,columnHeaderSeparatorProps:Oe,style:N},Me))}const Tpe=xp(Epe),Ipe=["className"],kpe=e=>{const{classes:t}=e;return yr({root:["iconButtonContainer"]},Gi,t)},Mpe=Wo("div",{name:"MuiDataGrid",slot:"IconButtonContainer",overridesResolver:(e,t)=>t.iconButtonContainer})(()=>({display:"flex",visibility:"hidden",width:0})),y$=X.forwardRef(function(t,n){const{className:s}=t,a=Zr(t,Ipe),u=Ur(),f=kpe(u);return K.jsx(Mpe,Ge({ref:n,className:Hn(f.root,s),ownerState:u},a))}),Ppe=["direction","index","sortingOrder","disabled"],Ape=e=>{const{classes:t}=e;return yr({icon:["sortIcon"]},Gi,t)};function Lpe(e,t,n,s){let a;const u={};return t==="asc"?a=e.columnSortedAscendingIcon:t==="desc"?a=e.columnSortedDescendingIcon:(a=e.columnUnsortedIcon,u.sortingOrder=s),a?K.jsx(a,Ge({fontSize:"small",className:n},u)):null}function Rpe(e){var P;const{direction:t,index:n,sortingOrder:s,disabled:a}=e,u=Zr(e,Ppe),f=Bi(),_=Ur(),r=Ge({},e,{classes:_.classes}),C=Ape(r),k=Lpe(_.slots,t,C.icon,s);if(!k)return null;const I=K.jsx(_.slots.baseIconButton,Ge({tabIndex:-1,"aria-label":f.current.getLocaleText("columnHeaderSortIconLabel"),title:f.current.getLocaleText("columnHeaderSortIconLabel"),size:"small",disabled:a},(P=_.slotProps)==null?void 0:P.baseIconButton,u,{children:k}));return K.jsxs(y$,{children:[n!=null&&K.jsx(_.slots.baseBadge,{badgeContent:n,color:"default",overlap:"circular",children:I}),n==null&&I]})}const Ope=X.memo(Rpe),Dpe=e=>{const{classes:t}=e;return yr({icon:["filterIcon"]},Gi,t)};function zpe(e){var N,j;const{counter:t,field:n,onClick:s}=e,a=Bi(),u=Ur(),f=Ge({},e,{classes:u.classes}),_=Dpe(f),r=Kn(a,Xx),C=ls(),k=ls(),I=X.useCallback(W=>{W.preventDefault(),W.stopPropagation();const{open:H,openedPanelValue:q}=Xx(a.current.state);H&&q===Lm.filters?a.current.hideFilterPanel():a.current.showFilterPanel(void 0,k,C),s&&s(a.current.getColumnHeaderParams(n),W)},[a,n,s,k,C]);if(!t)return null;const P=r.open&&r.labelId===C,D=K.jsx(u.slots.baseIconButton,Ge({id:C,onClick:I,color:"default","aria-label":a.current.getLocaleText("columnHeaderFiltersLabel"),size:"small",tabIndex:-1,"aria-haspopup":"menu","aria-expanded":P,"aria-controls":P?k:void 0},(N=u.slotProps)==null?void 0:N.baseIconButton,{children:K.jsx(u.slots.columnFilteredIcon,{className:_.icon,fontSize:"small"})}));return K.jsx(u.slots.baseTooltip,Ge({title:a.current.getLocaleText("columnHeaderFiltersTooltipActive")(t),enterDelay:1e3},(j=u.slotProps)==null?void 0:j.baseTooltip,{children:K.jsxs(y$,{children:[t>1&&K.jsx(u.slots.baseBadge,{badgeContent:t,color:"default",children:D}),t===1&&D]})}))}const aN=Jr(K.jsx("path",{d:"M4 12l1.41 1.41L11 7.83V20h2V7.83l5.58 5.59L20 12l-8-8-8 8z"}),"ArrowUpward"),lN=Jr(K.jsx("path",{d:"M20 12l-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8 8-8z"}),"ArrowDownward"),uN=Jr(K.jsx("path",{d:"M8.59 16.59 13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"}),"KeyboardArrowRight"),cN=Jr(K.jsx("path",{d:"M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"}),"ExpandMore"),Fpe=Jr(K.jsx("path",{d:"M10 18h4v-2h-4v2zM3 6v2h18V6H3zm3 7h12v-2H6v2z"}),"FilterList"),dN=Jr(K.jsx("path",{d:"M4.25 5.61C6.27 8.2 10 13 10 13v6c0 .55.45 1 1 1h2c.55 0 1-.45 1-1v-6s3.72-4.8 5.74-7.39c.51-.66.04-1.61-.79-1.61H5.04c-.83 0-1.3.95-.79 1.61z"}),"FilterAlt"),Npe=Jr(K.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"}),"Search");Jr(K.jsx("path",{d:"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"}),"Menu");Jr(K.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckCircle");const Bpe=Jr(K.jsx("path",{d:"M6 5H3c-.55 0-1 .45-1 1v12c0 .55.45 1 1 1h3c.55 0 1-.45 1-1V6c0-.55-.45-1-1-1zm14 0h-3c-.55 0-1 .45-1 1v12c0 .55.45 1 1 1h3c.55 0 1-.45 1-1V6c0-.55-.45-1-1-1zm-7 0h-3c-.55 0-1 .45-1 1v12c0 .55.45 1 1 1h3c.55 0 1-.45 1-1V6c0-.55-.45-1-1-1z"}),"ColumnIcon"),jpe=Jr(K.jsx("rect",{width:"1",height:"24",x:"11.5",rx:"0.5"}),"Separator"),Vpe=Jr(K.jsx("path",{d:"M4 15h16v-2H4v2zm0 4h16v-2H4v2zm0-8h16V9H4v2zm0-6v2h16V5H4z"}),"ViewHeadline"),$pe=Jr(K.jsx("path",{d:"M21,8H3V4h18V8z M21,10H3v4h18V10z M21,16H3v4h18V16z"}),"TableRows"),Upe=Jr(K.jsx("path",{d:"M4 18h17v-6H4v6zM4 5v6h17V5H4z"}),"ViewStream"),Gpe=Jr(K.jsx("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"}),"TripleDotsVertical"),Vk=Jr(K.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close"),hN=Jr(K.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"}),"Add"),Hpe=Jr(K.jsx("path",{d:"M19 13H5v-2h14v2z"}),"Remove"),Wpe=Jr(K.jsx("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"}),"Load"),fN=Jr(K.jsx("path",{d:"M11 18c0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2 2 .9 2 2zm-2-8c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0-6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm6 4c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"}),"Drag"),qpe=Jr(K.jsx("path",{d:"M19 12v7H5v-7H3v7c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-7h-2zm-6 .67l2.59-2.58L17 11.5l-5 5-5-5 1.41-1.41L11 12.67V3h2z"}),"SaveAlt"),Xpe=Jr(K.jsx("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"}),"Check"),Ype=Jr(K.jsx("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"}),"MoreVert"),Zpe=Jr(K.jsx("path",{d:"M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7zM2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3 2 4.27zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2zm4.31-.78l3.15 3.15.02-.16c0-1.66-1.34-3-3-3l-.17.01z"}),"VisibilityOff"),Kpe=Jr(K.jsx("g",{children:K.jsx("path",{d:"M14.67,5v14H9.33V5H14.67z M15.67,19H21V5h-5.33V19z M8.33,19V5H3v14H8.33z"})}),"ViewColumn"),Jpe=Jr(K.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Clear");Jr(K.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),"Delete");const Qpe=Jr(K.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zm2.46-7.12l1.41-1.41L12 12.59l2.12-2.12 1.41 1.41L13.41 14l2.12 2.12-1.41 1.41L12 15.41l-2.12 2.12-1.41-1.41L10.59 14l-2.13-2.12zM15.5 4l-1-1h-5l-1 1H5v2h14V4z"}),"Delete");function _$(e){return e.key.length===1&&!e.ctrlKey&&!e.metaKey}const EC=e=>e.indexOf("Arrow")===0||e.indexOf("Page")===0||e===" "||e==="Home"||e==="End",eme=e=>!!e.key,tme=e=>e==="Tab"||e==="Escape";function v$(e){return(e.ctrlKey||e.metaKey)&&String.fromCharCode(e.keyCode)==="V"&&!e.shiftKey&&!e.altKey}function nme(e){return(e.ctrlKey||e.metaKey)&&String.fromCharCode(e.keyCode)==="C"&&!e.shiftKey&&!e.altKey}const rme=["hideMenu","colDef","id","labelledby","className","children","open"],ime=Dn(_A)(()=>({minWidth:248})),ome=X.forwardRef(function(t,n){const{hideMenu:s,id:a,labelledby:u,className:f,children:_,open:r}=t,C=Zr(t,rme),k=X.useCallback(I=>{I.key==="Tab"&&I.preventDefault(),tme(I.key)&&s(I)},[s]);return K.jsx(ime,Ge({id:a,ref:n,className:Hn(xt.menuList,f),"aria-labelledby":u,onKeyDown:k,autoFocus:r},C,{children:_}))}),sme=["displayOrder"],ame=e=>{const t=Sc(),n=Ur(),{defaultSlots:s,defaultSlotProps:a,slots:u={},slotProps:f={},hideMenu:_,colDef:r,addDividers:C=!0}=e,k=X.useMemo(()=>Ge({},s,u),[s,u]),I=X.useMemo(()=>{if(!f||Object.keys(f).length===0)return a;const N=Ge({},f);return Object.entries(a).forEach(([j,W])=>{N[j]=Ge({},W,f[j]||{})}),N},[a,f]),P=t.current.unstable_applyPipeProcessors("columnMenu",[],e.colDef),D=X.useMemo(()=>{const N=Object.keys(s);return Object.keys(u).filter(j=>!N.includes(j))},[u,s]);return X.useMemo(()=>{const W=Array.from(new Set([...P,...D])).filter(H=>k[H]!=null).sort((H,q)=>{const Z=I[H],re=I[q],le=Number.isFinite(Z==null?void 0:Z.displayOrder)?Z.displayOrder:100,_e=Number.isFinite(re==null?void 0:re.displayOrder)?re.displayOrder:100;return le-_e});return W.reduce((H,q,Z)=>{let re={colDef:r,onClick:_};const le=I[q];if(le){const _e=Zr(le,sme);re=Ge({},re,_e)}return C&&Z!==W.length-1?[...H,[k[q],re],[n.slots.baseDivider,{}]]:[...H,[k[q],re]]},[])},[C,r,P,_,k,I,D,n.slots.baseDivider])};function lme(e){const{colDef:t,onClick:n}=e,s=Bi(),a=Ur(),_=ua(s).filter(C=>C.disableColumnMenu!==!0).length===1,r=X.useCallback(C=>{_||(s.current.setColumnVisibility(t.field,!1),n(C))},[s,t.field,n,_]);return a.disableColumnSelector||t.hideable===!1?null:K.jsxs(gl,{onClick:r,disabled:_,children:[K.jsx(zy,{children:K.jsx(a.slots.columnMenuHideIcon,{fontSize:"small"})}),K.jsx(ep,{children:s.current.getLocaleText("columnMenuHideColumn")})]})}function ume(e){const{onClick:t}=e,n=Bi(),s=Ur(),a=X.useCallback(u=>{t(u),n.current.showPreferences(Lm.columns)},[n,t]);return s.disableColumnSelector?null:K.jsxs(gl,{onClick:a,children:[K.jsx(zy,{children:K.jsx(s.slots.columnMenuManageColumnsIcon,{fontSize:"small"})}),K.jsx(ep,{children:n.current.getLocaleText("columnMenuManageColumns")})]})}function cme(e){return K.jsxs(X.Fragment,{children:[K.jsx(lme,Ge({},e)),K.jsx(ume,Ge({},e))]})}function dme(e){const{colDef:t,onClick:n}=e,s=Bi(),a=Ur(),u=X.useCallback(f=>{n(f),s.current.showFilterPanel(t.field)},[s,t.field,n]);return a.disableColumnFilter||!t.filterable?null:K.jsxs(gl,{onClick:u,children:[K.jsx(zy,{children:K.jsx(a.slots.columnMenuFilterIcon,{fontSize:"small"})}),K.jsx(ep,{children:s.current.getLocaleText("columnMenuFilter")})]})}function hme(e){const{colDef:t,onClick:n}=e,s=Bi(),a=Kn(s,Ju),u=Ur(),f=X.useMemo(()=>{if(!t)return null;const k=a.find(I=>I.field===t.field);return k==null?void 0:k.sort},[t,a]),_=t.sortingOrder??u.sortingOrder,r=X.useCallback(k=>{n(k);const I=k.currentTarget.getAttribute("data-value")||null;s.current.sortColumn(t.field,I===f?null:I)},[s,t,n,f]);if(u.disableColumnSorting||!t||!t.sortable||!_.some(k=>!!k))return null;const C=k=>{const I=s.current.getLocaleText(k);return typeof I=="function"?I(t):I};return K.jsxs(X.Fragment,{children:[_.includes("asc")&&f!=="asc"?K.jsxs(gl,{onClick:r,"data-value":"asc",children:[K.jsx(zy,{children:K.jsx(u.slots.columnMenuSortAscendingIcon,{fontSize:"small"})}),K.jsx(ep,{children:C("columnMenuSortAsc")})]}):null,_.includes("desc")&&f!=="desc"?K.jsxs(gl,{onClick:r,"data-value":"desc",children:[K.jsx(zy,{children:K.jsx(u.slots.columnMenuSortDescendingIcon,{fontSize:"small"})}),K.jsx(ep,{children:C("columnMenuSortDesc")})]}):null,_.includes(null)&&f!=null?K.jsxs(gl,{onClick:r,children:[K.jsx(zy,{}),K.jsx(ep,{children:s.current.getLocaleText("columnMenuUnsort")})]}):null]})}const fme=["defaultSlots","defaultSlotProps","slots","slotProps"],pme={columnMenuSortItem:hme,columnMenuFilterItem:dme,columnMenuColumnsItem:cme},mme={columnMenuSortItem:{displayOrder:10},columnMenuFilterItem:{displayOrder:20},columnMenuColumnsItem:{displayOrder:30}},gme=X.forwardRef(function(t,n){const{defaultSlots:s,defaultSlotProps:a,slots:u,slotProps:f}=t,_=Zr(t,fme),r=ame(Ge({},_,{defaultSlots:s,defaultSlotProps:a,slots:u,slotProps:f}));return K.jsx(ome,Ge({ref:n},_,{children:r.map(([C,k],I)=>K.jsx(C,Ge({},k),I))}))}),yme=X.forwardRef(function(t,n){return K.jsx(gme,Ge({},t,{ref:n,defaultSlots:pme,defaultSlotProps:mme}))}),_me=["className","slotProps"],vme=e=>{const{classes:t}=e;return yr({root:["panelWrapper"]},Gi,t)},xme=Dn("div",{name:"MuiDataGrid",slot:"PanelWrapper",overridesResolver:(e,t)=>t.panelWrapper})({display:"flex",flexDirection:"column",flex:1,"&:focus":{outline:0}}),bme=()=>!0,x$=X.forwardRef(function(t,n){const{className:s,slotProps:a={}}=t,u=Zr(t,_me),f=Ur(),_=vme(f);return K.jsx(e8,Ge({open:!0,disableEnforceFocus:!0,isEnabled:bme},a.TrapFocus,{children:K.jsx(xme,Ge({ref:n,tabIndex:-1,className:Hn(_.root,s),ownerState:f},u))}))}),wme=(e,t)=>{const n=new Set(Object.keys(e).filter(u=>e[u]===!1)),s=new Set(Object.keys(t).filter(u=>t[u]===!1));if(n.size!==s.size)return!1;let a=!0;return n.forEach(u=>{s.has(u)||(a=!1)}),a},Sme=(e,t)=>(e.headerName||e.field).toLowerCase().indexOf(t)>-1,Cme=e=>{const{classes:t}=e;return yr({root:["columnsManagement"],header:["columnsManagementHeader"],footer:["columnsManagementFooter"],row:["columnsManagementRow"]},Gi,t)},pN=new Intl.Collator;function b$(e){var Ee,se,we;const t=Bi(),n=X.useRef(null),s=Kn(t,Qc),a=id(()=>lc(t)).current,u=Kn(t,lc),f=Ur(),[_,r]=X.useState(""),C=Cme(f),{sort:k,searchPredicate:I=Sme,autoFocusSearchField:P=!0,disableShowHideToggle:D=!1,disableResetButton:N=!1,toggleAllMode:j="all",getTogglableColumns:W}=e,H=X.useMemo(()=>wme(u,a),[u,a]),q=X.useMemo(()=>{switch(k){case"asc":return[...s].sort((Se,Pe)=>pN.compare(Se.headerName||Se.field,Pe.headerName||Pe.field));case"desc":return[...s].sort((Se,Pe)=>-pN.compare(Se.headerName||Se.field,Pe.headerName||Pe.field));default:return s}},[s,k]),Z=Se=>{const{name:Pe}=Se.target;t.current.setColumnVisibility(Pe,u[Pe]===!1)},re=X.useMemo(()=>{const Se=W?W(q):null,Pe=Se?q.filter(({field:Me})=>Se.includes(Me)):q;return _?Pe.filter(Me=>I(Me,_.toLowerCase())):Pe},[q,_,I,W]),le=X.useCallback(Se=>{const Pe=lc(t),Me=Ge({},Pe),Re=W?W(s):null;return(j==="filteredOnly"?re:s).forEach(Oe=>{Oe.hideable&&(Re==null||Re.includes(Oe.field))&&(Se?delete Me[Oe.field]:Me[Oe.field]=!1)}),t.current.setColumnVisibilityModel(Me)},[t,s,W,j,re]),_e=X.useCallback(Se=>{r(Se.target.value)},[]),ye=X.useMemo(()=>re.filter(Se=>Se.hideable),[re]),de=X.useMemo(()=>ye.every(Se=>u[Se.field]==null||u[Se.field]!==!1),[u,ye]),ce=X.useMemo(()=>ye.every(Se=>u[Se.field]===!1),[u,ye]),oe=X.useRef(null);X.useEffect(()=>{P?n.current.focus():oe.current&&typeof oe.current.focus=="function"&&oe.current.focus()},[P]);let xe=!1;const he=Se=>xe===!1&&Se.hideable!==!1?(xe=!0,!0):!1;return K.jsxs(X.Fragment,{children:[K.jsx(Tme,{className:C.header,ownerState:f,children:K.jsx(f.slots.baseTextField,Ge({placeholder:t.current.getLocaleText("columnsManagementSearchTitle"),inputRef:n,value:_,onChange:_e,variant:"outlined",size:"small",InputProps:{startAdornment:K.jsx(f.slots.baseInputAdornment,{position:"start",children:K.jsx(f.slots.quickFilterIcon,{})}),sx:{pl:1.5}},fullWidth:!0},(Ee=f.slotProps)==null?void 0:Ee.baseTextField))}),K.jsxs(Eme,{className:C.root,ownerState:f,children:[re.map(Se=>{var Pe;return K.jsx(mP,{className:C.row,control:K.jsx(f.slots.baseCheckbox,Ge({disabled:Se.hideable===!1,checked:u[Se.field]!==!1,onClick:Z,name:Se.field,sx:{p:.5},inputRef:he(Se)?oe:void 0},(Pe=f.slotProps)==null?void 0:Pe.baseCheckbox)),label:Se.headerName||Se.field},Se.field)}),re.length===0&&K.jsx(kme,{ownerState:f,children:t.current.getLocaleText("columnsManagementNoColumns")})]}),(!D||!N)&&re.length>0?K.jsxs(Ime,{ownerState:f,className:C.footer,children:[D?K.jsx("span",{}):K.jsx(mP,{control:K.jsx(f.slots.baseCheckbox,Ge({disabled:ye.length===0,checked:de,indeterminate:!de&&!ce,onClick:()=>le(!de),name:t.current.getLocaleText("columnsManagementShowHideAllText"),sx:{p:.5}},(se=f.slotProps)==null?void 0:se.baseCheckbox)),label:t.current.getLocaleText("columnsManagementShowHideAllText")}),N?null:K.jsx(f.slots.baseButton,Ge({onClick:()=>t.current.setColumnVisibilityModel(a),disabled:H},(we=f.slotProps)==null?void 0:we.baseButton,{children:t.current.getLocaleText("columnsManagementReset")}))]}):null]})}const Eme=Dn("div",{name:"MuiDataGrid",slot:"ColumnsManagement",overridesResolver:(e,t)=>t.columnsManagement})(({theme:e})=>({padding:e.spacing(0,3,1.5),display:"flex",flexDirection:"column",overflow:"auto",flex:"1 1",maxHeight:400,alignItems:"flex-start"})),Tme=Dn("div",{name:"MuiDataGrid",slot:"ColumnsManagementHeader",overridesResolver:(e,t)=>t.columnsManagementHeader})(({theme:e})=>({padding:e.spacing(1.5,3)})),Ime=Dn("div",{name:"MuiDataGrid",slot:"ColumnsManagementFooter",overridesResolver:(e,t)=>t.columnsManagementFooter})(({theme:e})=>({padding:e.spacing(.5,1,.5,3),display:"flex",justifyContent:"space-between",borderTop:`1px solid ${e.palette.divider}`})),kme=Dn("div")(({theme:e})=>({padding:e.spacing(.5,0),color:e.palette.grey[500]}));function Mme(e){var n;const t=Ur();return K.jsx(x$,Ge({},e,{children:K.jsx(b$,Ge({},(n=t.slotProps)==null?void 0:n.columnsManagement))}))}const Pme=["children","className","classes"],Ame=pi("MuiDataGrid",["panel","paper"]),Lme=Dn(Nm,{name:"MuiDataGrid",slot:"Panel",overridesResolver:(e,t)=>t.panel})(({theme:e})=>({zIndex:e.zIndex.modal})),Rme=Dn(b0,{name:"MuiDataGrid",slot:"Paper",overridesResolver:(e,t)=>t.paper})(({theme:e})=>({backgroundColor:(e.vars||e).palette.background.paper,minWidth:300,maxHeight:450,display:"flex",maxWidth:`calc(100vw - ${e.spacing(.5)})`,overflow:"auto"})),Ome=X.forwardRef((e,t)=>{const{children:n,className:s}=e,a=Zr(e,Pme),u=Bi(),f=Ur(),_=Ame,[r,C]=X.useState(!1),k=X.useCallback(()=>{u.current.hidePreferences()},[u]),I=X.useCallback(j=>{j.key==="Escape"&&u.current.hidePreferences()},[u]),P=X.useMemo(()=>[{name:"flip",enabled:!0,options:{rootBoundary:"document"}},{name:"isPlaced",enabled:!0,phase:"main",fn:()=>{C(!0)},effect:()=>()=>{C(!1)}}],[]),[D,N]=X.useState(null);return X.useEffect(()=>{var W,H;const j=(H=(W=u.current.rootElementRef)==null?void 0:W.current)==null?void 0:H.querySelector('[data-id="gridPanelAnchor"]');j&&N(j)},[u]),D?K.jsx(Lme,Ge({ref:t,placement:"bottom-start",className:Hn(_.panel,s),ownerState:f,anchorEl:D,modifiers:P},a,{children:K.jsx(Qj,{mouseEvent:"onMouseUp",onClickAway:k,children:K.jsx(Rme,{className:_.paper,ownerState:f,elevation:8,onKeyDown:I,children:r&&n})})})):null}),Dme=["className"],zme=e=>{const{classes:t}=e;return yr({root:["panelContent"]},Gi,t)},Fme=Wo("div",{name:"MuiDataGrid",slot:"PanelContent",overridesResolver:(e,t)=>t.panelContent})({display:"flex",flexDirection:"column",overflow:"auto",flex:"1 1",maxHeight:400});function Nme(e){const{className:t}=e,n=Zr(e,Dme),s=Ur(),a=zme(s);return K.jsx(Fme,Ge({className:Hn(a.root,t),ownerState:s},n))}const Bme=["className"],jme=e=>{const{classes:t}=e;return yr({root:["panelFooter"]},Gi,t)},Vme=Wo("div",{name:"MuiDataGrid",slot:"PanelFooter",overridesResolver:(e,t)=>t.panelFooter})(({theme:e})=>({padding:e.spacing(.5),display:"flex",justifyContent:"space-between"}));function $me(e){const{className:t}=e,n=Zr(e,Bme),s=Ur(),a=jme(s);return K.jsx(Vme,Ge({className:Hn(a.root,t),ownerState:s},n))}const Ume=["item","hasMultipleFilters","deleteFilter","applyFilterChanges","showMultiFilterOperators","disableMultiFilterOperator","applyMultiFilterOperatorChanges","focusElementRef","logicOperators","columnsSort","filterColumns","deleteIconProps","logicOperatorInputProps","operatorInputProps","columnInputProps","valueInputProps","readOnly","children"],Gme=["InputComponentProps"],Hme=e=>{const{classes:t}=e;return yr({root:["filterForm"],deleteIcon:["filterFormDeleteIcon"],logicOperatorInput:["filterFormLogicOperatorInput"],columnInput:["filterFormColumnInput"],operatorInput:["filterFormOperatorInput"],valueInput:["filterFormValueInput"]},Gi,t)},Wme=Dn("div",{name:"MuiDataGrid",slot:"FilterForm",overridesResolver:(e,t)=>t.filterForm})(({theme:e})=>({display:"flex",padding:e.spacing(1)})),qme=Dn("div",{name:"MuiDataGrid",slot:"FilterFormDeleteIcon",overridesResolver:(e,t)=>t.filterFormDeleteIcon})(({theme:e})=>({flexShrink:0,justifyContent:"flex-end",marginRight:e.spacing(.5),marginBottom:e.spacing(.2)})),Xme=Dn("div",{name:"MuiDataGrid",slot:"FilterFormLogicOperatorInput",overridesResolver:(e,t)=>t.filterFormLogicOperatorInput})({minWidth:55,marginRight:5,justifyContent:"end"}),Yme=Dn("div",{name:"MuiDataGrid",slot:"FilterFormColumnInput",overridesResolver:(e,t)=>t.filterFormColumnInput})({width:150}),Zme=Dn("div",{name:"MuiDataGrid",slot:"FilterFormOperatorInput",overridesResolver:(e,t)=>t.filterFormOperatorInput})({width:150}),Kme=Dn("div",{name:"MuiDataGrid",slot:"FilterFormValueInput",overridesResolver:(e,t)=>t.filterFormValueInput})({width:190}),Jme=e=>{switch(e){case Ll.And:return"filterPanelOperatorAnd";case Ll.Or:return"filterPanelOperatorOr";default:throw new Error("MUI X: Invalid `logicOperator` property in the `GridFilterPanel`.")}},Rv=e=>e.headerName||e.field,mN=new Intl.Collator,gN=X.forwardRef(function(t,n){var st,gt,ut,tt,nt,tn,un,qt,an;const{item:s,hasMultipleFilters:a,deleteFilter:u,applyFilterChanges:f,showMultiFilterOperators:_,disableMultiFilterOperator:r,applyMultiFilterOperatorChanges:C,focusElementRef:k,logicOperators:I=[Ll.And,Ll.Or],columnsSort:P,filterColumns:D,deleteIconProps:N={},logicOperatorInputProps:j={},operatorInputProps:W={},columnInputProps:H={},valueInputProps:q={},readOnly:Z}=t,re=Zr(t,Ume),le=Bi(),_e=Kn(le,Hh),ye=Kn(le,xV),de=Kn(le,Ba),ce=ls(),oe=ls(),xe=ls(),he=ls(),Ee=Ur(),se=Hme(Ee),we=X.useRef(null),Se=X.useRef(null),Pe=de.logicOperator??Ll.And,Me=a&&I.length>0,Re=((st=Ee.slotProps)==null?void 0:st.baseFormControl)||{},$e=(((gt=Ee.slotProps)==null?void 0:gt.baseSelect)||{}).native??!1,Ke=((ut=Ee.slotProps)==null?void 0:ut.baseInputLabel)||{},Ct=((tt=Ee.slotProps)==null?void 0:tt.baseSelectOption)||{},{InputComponentProps:Ue}=q,ft=Zr(q,Gme),{filteredColumns:Bt,selectedField:hn}=X.useMemo(()=>{let Jt=s.field;const Wt=_e[s.field].filterable===!1?_e[s.field]:null;if(Wt)return{filteredColumns:[Wt],selectedField:Jt};if(D===void 0||typeof D!="function")return{filteredColumns:ye,selectedField:Jt};const Fn=D({field:s.field,columns:ye,currentFilters:(de==null?void 0:de.items)||[]});return{filteredColumns:ye.filter(ar=>{const bn=Fn.includes(ar.field);return ar.field===s.field&&!bn&&(Jt=void 0),bn}),selectedField:Jt}},[D,de==null?void 0:de.items,ye,s.field,_e]),ot=X.useMemo(()=>{switch(P){case"asc":return Bt.sort((Jt,Wt)=>mN.compare(Rv(Jt),Rv(Wt)));case"desc":return Bt.sort((Jt,Wt)=>-mN.compare(Rv(Jt),Rv(Wt)));default:return Bt}},[Bt,P]),en=s.field?le.current.getColumn(s.field):null,wt=X.useMemo(()=>{var Jt;return!s.operator||!en?null:(Jt=en.filterOperators)==null?void 0:Jt.find(Wt=>Wt.value===s.operator)},[s,en]),Ne=X.useCallback(Jt=>{const Wt=Jt.target.value,Fn=le.current.getColumn(Wt);if(Fn.field===en.field)return;const ar=Fn.filterOperators.find(Cn=>Cn.value===s.operator)||Fn.filterOperators[0];let lr=!ar.InputComponent||ar.InputComponent!==(wt==null?void 0:wt.InputComponent)||Fn.type!==en.type?void 0:s.value;if(Fn.type==="singleSelect"&&lr!==void 0){const Cn=Fn,xn=Am(Cn);Array.isArray(lr)?lr=lr.filter(Er=>SC(Er,xn,Cn==null?void 0:Cn.getOptionValue)!==void 0):SC(s.value,xn,Cn==null?void 0:Cn.getOptionValue)===void 0&&(lr=void 0)}f(Ge({},s,{field:Wt,operator:ar.value,value:lr}))},[le,f,s,en,wt]),We=X.useCallback(Jt=>{const Wt=Jt.target.value,Fn=en==null?void 0:en.filterOperators.find(bn=>bn.value===Wt),ar=!(Fn!=null&&Fn.InputComponent)||(Fn==null?void 0:Fn.InputComponent)!==(wt==null?void 0:wt.InputComponent);f(Ge({},s,{operator:Wt,value:ar?void 0:s.value}))},[f,s,en,wt]),Sn=X.useCallback(Jt=>{const Wt=Jt.target.value===Ll.And.toString()?Ll.And:Ll.Or;C(Wt)},[C]),Ae=()=>{u(s)};return X.useImperativeHandle(k,()=>({focus:()=>{var Jt;wt!=null&&wt.InputComponent?(Jt=we==null?void 0:we.current)==null||Jt.focus():Se.current.focus()}}),[wt]),K.jsxs(Wme,Ge({ref:n,className:se.root,"data-id":s.id,ownerState:Ee},re,{children:[K.jsx(qme,Ge({variant:"standard",as:Ee.slots.baseFormControl},Re,N,{className:Hn(se.deleteIcon,Re.className,N.className),ownerState:Ee,children:K.jsx(Ee.slots.baseIconButton,Ge({"aria-label":le.current.getLocaleText("filterPanelDeleteIconLabel"),title:le.current.getLocaleText("filterPanelDeleteIconLabel"),onClick:Ae,size:"small",disabled:Z},(nt=Ee.slotProps)==null?void 0:nt.baseIconButton,{children:K.jsx(Ee.slots.filterPanelDeleteIcon,{fontSize:"small"})}))})),K.jsx(Xme,Ge({variant:"standard",as:Ee.slots.baseFormControl},Re,j,{sx:[Me?{display:"flex"}:{display:"none"},_?{visibility:"visible"}:{visibility:"hidden"},Re.sx,j.sx],className:Hn(se.logicOperatorInput,Re.className,j.className),ownerState:Ee,children:K.jsx(Ee.slots.baseSelect,Ge({inputProps:{"aria-label":le.current.getLocaleText("filterPanelLogicOperator")},value:Pe??"",onChange:Sn,disabled:!!r||I.length===1,native:$e},(tn=Ee.slotProps)==null?void 0:tn.baseSelect,{children:I.map(Jt=>X.createElement(Ee.slots.baseSelectOption,Ge({},Ct,{native:$e,key:Jt.toString(),value:Jt.toString()}),le.current.getLocaleText(Jme(Jt))))}))})),K.jsxs(Yme,Ge({variant:"standard",as:Ee.slots.baseFormControl},Re,H,{className:Hn(se.columnInput,Re.className,H.className),ownerState:Ee,children:[K.jsx(Ee.slots.baseInputLabel,Ge({},Ke,{htmlFor:ce,id:oe,children:le.current.getLocaleText("filterPanelColumns")})),K.jsx(Ee.slots.baseSelect,Ge({labelId:oe,id:ce,label:le.current.getLocaleText("filterPanelColumns"),value:hn??"",onChange:Ne,native:$e,disabled:Z},(un=Ee.slotProps)==null?void 0:un.baseSelect,{children:ot.map(Jt=>X.createElement(Ee.slots.baseSelectOption,Ge({},Ct,{native:$e,key:Jt.field,value:Jt.field}),Rv(Jt)))}))]})),K.jsxs(Zme,Ge({variant:"standard",as:Ee.slots.baseFormControl},Re,W,{className:Hn(se.operatorInput,Re.className,W.className),ownerState:Ee,children:[K.jsx(Ee.slots.baseInputLabel,Ge({},Ke,{htmlFor:xe,id:he,children:le.current.getLocaleText("filterPanelOperator")})),K.jsx(Ee.slots.baseSelect,Ge({labelId:he,label:le.current.getLocaleText("filterPanelOperator"),id:xe,value:s.operator,onChange:We,native:$e,inputRef:Se,disabled:Z},(qt=Ee.slotProps)==null?void 0:qt.baseSelect,{children:(an=en==null?void 0:en.filterOperators)==null?void 0:an.map(Jt=>X.createElement(Ee.slots.baseSelectOption,Ge({},Ct,{native:$e,key:Jt.value,value:Jt.value}),Jt.label||le.current.getLocaleText(`filterOperator${Rn(Jt.value)}`)))}))]})),K.jsx(Kme,Ge({variant:"standard",as:Ee.slots.baseFormControl},Re,ft,{className:Hn(se.valueInput,Re.className,ft.className),ownerState:Ee,children:wt!=null&&wt.InputComponent?K.jsx(wt.InputComponent,Ge({apiRef:le,item:s,applyValue:f,focusElementRef:we,disabled:Z},wt.InputComponentProps,Ue),s.field):null}))]}))}),Qme=["logicOperators","columnsSort","filterFormProps","getColumnForNewFilter","children","disableAddFilterButton","disableRemoveAllButton"],yN=e=>({field:e.field,operator:e.filterOperators[0].value,id:Math.round(Math.random()*1e5)}),ege=X.forwardRef(function(t,n){var he,Ee;const s=Bi(),a=Ur(),u=Kn(s,Ba),f=Kn(s,xV),_=Kn(s,Xue),r=X.useRef(null),C=X.useRef(null),{logicOperators:k=[Ll.And,Ll.Or],columnsSort:I,filterFormProps:P,getColumnForNewFilter:D,disableAddFilterButton:N=!1,disableRemoveAllButton:j=!1}=t,W=Zr(t,Qme),H=s.current.upsertFilterItem,q=X.useCallback(se=>{s.current.setFilterLogicOperator(se)},[s]),Z=X.useCallback(()=>{let se;if(D&&typeof D=="function"){const we=D({currentFilters:(u==null?void 0:u.items)||[],columns:f});if(we===null)return null;se=f.find(({field:Se})=>Se===we)}else se=f.find(we=>{var Se;return(Se=we.filterOperators)==null?void 0:Se.length});return se?yN(se):null},[u==null?void 0:u.items,f,D]),re=X.useCallback(()=>{if(D===void 0||typeof D!="function")return Z();const se=u.items.length?u.items:[Z()].filter(Boolean),we=D({currentFilters:se,columns:f});if(we===null)return null;const Se=f.find(({field:Pe})=>Pe===we);return Se?yN(Se):null},[u.items,f,D,Z]),le=X.useMemo(()=>u.items.length?u.items:(C.current||(C.current=Z()),C.current?[C.current]:[]),[u.items,Z]),_e=le.length>1,{readOnlyFilters:ye,validFilters:de}=X.useMemo(()=>le.reduce((se,we)=>(_[we.field]?se.validFilters.push(we):se.readOnlyFilters.push(we),se),{readOnlyFilters:[],validFilters:[]}),[le,_]),ce=X.useCallback(()=>{const se=re();se&&s.current.upsertFilterItems([...le,se])},[s,re,le]),oe=X.useCallback(se=>{const we=de.length===1;s.current.deleteFilterItem(se),we&&s.current.hideFilterPanel()},[s,de.length]),xe=X.useCallback(()=>de.length===1&&de[0].value===void 0?(s.current.deleteFilterItem(de[0]),s.current.hideFilterPanel()):s.current.setFilterModel(Ge({},u,{items:ye}),"removeAllFilterItems"),[s,ye,u,de]);return X.useEffect(()=>{k.length>0&&u.logicOperator&&!k.includes(u.logicOperator)&&q(k[0])},[k,q,u.logicOperator]),X.useEffect(()=>{de.length>0&&r.current.focus()},[de.length]),K.jsxs(x$,Ge({ref:n},W,{children:[K.jsxs(Nme,{children:[ye.map((se,we)=>K.jsx(gN,Ge({item:se,applyFilterChanges:H,deleteFilter:oe,hasMultipleFilters:_e,showMultiFilterOperators:we>0,disableMultiFilterOperator:we!==1,applyMultiFilterOperatorChanges:q,focusElementRef:null,readOnly:!0,logicOperators:k,columnsSort:I},P),se.id==null?we:se.id)),de.map((se,we)=>K.jsx(gN,Ge({item:se,applyFilterChanges:H,deleteFilter:oe,hasMultipleFilters:_e,showMultiFilterOperators:ye.length+we>0,disableMultiFilterOperator:ye.length+we!==1,applyMultiFilterOperatorChanges:q,focusElementRef:we===de.length-1?r:null,logicOperators:k,columnsSort:I},P),se.id==null?we+ye.length:se.id))]}),!a.disableMultipleColumnsFiltering&&!(N&&j)?K.jsxs($me,{children:[N?K.jsx("span",{}):K.jsx(a.slots.baseButton,Ge({onClick:ce,startIcon:K.jsx(a.slots.filterPanelAddIcon,{})},(he=a.slotProps)==null?void 0:he.baseButton,{children:s.current.getLocaleText("filterPanelAddFilter")})),!j&&de.length>0?K.jsx(a.slots.baseButton,Ge({onClick:xe,startIcon:K.jsx(a.slots.filterPanelRemoveAllIcon,{})},(Ee=a.slotProps)==null?void 0:Ee.baseButton,{children:s.current.getLocaleText("filterPanelRemoveAll")})):null]}):null]}))}),tge=["hideMenu","options"],nge=["hideMenu","options"];function rge(e){const t=Bi(),{hideMenu:n,options:s}=e,a=Zr(e,tge);return K.jsx(gl,Ge({onClick:()=>{t.current.exportDataAsCsv(s),n==null||n()}},a,{children:t.current.getLocaleText("toolbarExportCSV")}))}function ige(e){const t=Bi(),{hideMenu:n,options:s}=e,a=Zr(e,nge);return K.jsx(gl,Ge({onClick:()=>{t.current.exportDataAsPrint(s),n==null||n()}},a,{children:t.current.getLocaleText("toolbarExportPrint")}))}const oge=["className","selectedRowCount"],sge=e=>{const{classes:t}=e;return yr({root:["selectedRowCount"]},Gi,t)},age=Wo("div",{name:"MuiDataGrid",slot:"SelectedRowCount",overridesResolver:(e,t)=>t.selectedRowCount})(({theme:e})=>({alignItems:"center",display:"flex",margin:e.spacing(0,2),visibility:"hidden",width:0,height:0,[e.breakpoints.up("sm")]:{visibility:"visible",width:"auto",height:"auto"}})),lge=X.forwardRef(function(t,n){const{className:s,selectedRowCount:a}=t,u=Zr(t,oge),f=Bi(),_=Ur(),r=sge(_),C=f.current.getLocaleText("footerRowSelected")(a);return K.jsx(age,Ge({ref:n,className:Hn(r.root,s),ownerState:_},u,{children:C}))}),uge=X.forwardRef(function(t,n){var I,P;const s=Bi(),a=Ur(),u=Kn(s,Lce),f=Kn(s,ade),_=Kn(s,jA),r=!a.hideFooterSelectedRowCount&&f>0?K.jsx(lge,{selectedRowCount:f}):K.jsx("div",{}),C=!a.hideFooterRowCount&&!a.pagination?K.jsx(a.slots.footerRowCount,Ge({},(I=a.slotProps)==null?void 0:I.footerRowCount,{rowCount:u,visibleRowCount:_})):null,k=a.pagination&&!a.hideFooterPagination&&a.slots.pagination&&K.jsx(a.slots.pagination,Ge({},(P=a.slotProps)==null?void 0:P.pagination));return K.jsxs(ape,Ge({ref:n},t,{children:[r,C,k]}))});function cge(){var u,f;const e=Bi(),t=Kn(e,Qc),n=Ur(),s=Kn(e,Xx),a=e.current.unstable_applyPipeProcessors("preferencePanel",null,s.openedPanelValue??Lm.filters);return K.jsx(n.slots.panel,Ge({as:n.slots.basePopper,open:t.length>0&&s.open,id:s.panelId,"aria-labelledby":s.labelId},(u=n.slotProps)==null?void 0:u.panel,(f=n.slotProps)==null?void 0:f.basePopper,{children:a}))}function dge(){var t;const e=Ur();return K.jsxs(X.Fragment,{children:[K.jsx(cge,{}),e.slots.toolbar&&K.jsx(e.slots.toolbar,Ge({},(t=e.slotProps)==null?void 0:t.toolbar))]})}const ZA=(e,t,n,s,a)=>{const u=a.hasScrollY?a.scrollbarSize:0;let f;switch(e){case Go.LEFT:f=s[n];break;case Go.RIGHT:f=a.columnsTotalWidth-s[n]-t+u;break;default:f=0;break}return f},Ov={root:xt.scrollbarFiller,header:xt["scrollbarFiller--header"],borderTop:xt["scrollbarFiller--borderTop"],borderBottom:xt["scrollbarFiller--borderBottom"],pinnedRight:xt["scrollbarFiller--pinnedRight"]};function KA({header:e,borderTop:t=!0,borderBottom:n,pinnedRight:s}){return K.jsx("div",{role:"presentation",className:Hn(Ov.root,e&&Ov.header,t&&Ov.borderTop,n&&Ov.borderBottom,s&&Ov.pinnedRight)})}const hge=Wo("div",{name:"MuiDataGrid",slot:"SkeletonLoadingOverlay",overridesResolver:(e,t)=>t.skeletonLoadingOverlay})({minWidth:"100%",width:"max-content",height:"100%",overflow:"clip"}),fge=e=>{const{classes:t}=e;return yr({root:["skeletonLoadingOverlay"]},Gi,t)},_N=e=>parseInt(e.getAttribute("data-colindex"),10),pge=X.forwardRef(function(t,n){const s=Ur(),{slots:a}=s,u=fge({classes:s.classes}),f=X.useRef(null),_=mo(f,n),r=Bi(),C=Kn(r,Ga),k=(C==null?void 0:C.viewportInnerSize.height)??0,I=Math.ceil(k/C.rowHeight),P=Kn(r,RA),D=Kn(r,bp),N=X.useMemo(()=>D.filter(_e=>_e<=P).length,[P,D]),j=Kn(r,ua),W=X.useMemo(()=>j.slice(0,N),[j,N]),H=Kn(r,S1),q=X.useCallback((_e,ye,de)=>{const ce=ZA(de,_e,ye,D,C);return{[de]:ce}},[C,D]),Z=X.useCallback(_e=>{if(H.left.findIndex(ye=>ye.field===_e)!==-1)return Go.LEFT;if(H.right.findIndex(ye=>ye.field===_e)!==-1)return Go.RIGHT},[H.left,H.right]),re=X.useMemo(()=>{const _e=[];for(let ye=0;ye<I;ye+=1){const de=[];for(let ce=0;ce<W.length;ce+=1){const oe=W[ce],xe=Z(oe.field),he=xe===Go.LEFT,Ee=xe===Go.RIGHT,se=xe?H[xe].length:W.length-H.left.length-H.right.length,we=xe?H[xe].findIndex(en=>en.field===oe.field):ce-H.left.length,Se=xe&&q(oe.computedWidth,ce,xe),Pe=C.columnsTotalWidth<C.viewportOuterSize.width,Me=JE(xe,we,se,s.showCellVerticalBorder,Pe),Re=QE(xe,we),Oe=ce===W.length-1,$e=Ee&&we===0,Ke=$e&&Pe,Ct=Oe&&!$e&&Pe,Ue=C.viewportOuterSize.width-C.columnsTotalWidth,ft=Math.max(0,Ue),Bt=K.jsx(a.skeletonCell,{width:ft,empty:!0},`skeleton-filler-column-${ye}`),hn=C.hasScrollY?C.scrollbarSize:0,ot=Oe&&hn!==0;Ke&&de.push(Bt),de.push(K.jsx(a.skeletonCell,{field:oe.field,type:oe.type,align:oe.align,width:"var(--width)",height:C.rowHeight,"data-colindex":ce,className:Hn(he&&xt["cell--pinnedLeft"],Ee&&xt["cell--pinnedRight"],Me&&xt["cell--withRightBorder"],Re&&xt["cell--withLeftBorder"]),style:Ge({"--width":`${oe.computedWidth}px`},Se)},`skeleton-column-${ye}-${oe.field}`)),Ct&&de.push(Bt),ot&&de.push(K.jsx(KA,{pinnedRight:H.right.length>0},`skeleton-scrollbar-filler-${ye}`))}_e.push(K.jsx("div",{className:Hn(xt.row,xt.rowSkeleton,ye===0&&xt["row--firstVisible"]),children:de},`skeleton-row-${ye}`))}return _e},[a,W,H,I,s.showCellVerticalBorder,C.columnsTotalWidth,C.viewportOuterSize.width,C.rowHeight,C.hasScrollY,C.scrollbarSize,Z,q]);return Lr(r,"columnResize",_e=>{var Se,Pe,Me;const{colDef:ye,width:de}=_e,ce=(Se=f.current)==null?void 0:Se.querySelectorAll(`[data-field="${Wh(ye.field)}"]`);if(!ce)throw new Error("MUI X: Expected skeleton cells to be defined with `data-field` attribute.");const oe=W.findIndex(Re=>Re.field===ye.field),xe=Z(ye.field),he=xe===Go.LEFT,Ee=xe===Go.RIGHT,se=getComputedStyle(ce[0]).getPropertyValue("--width"),we=parseInt(se,10)-de;if(ce&&ce.forEach(Re=>{Re.style.setProperty("--width",`${de}px`)}),he){const Re=(Pe=f.current)==null?void 0:Pe.querySelectorAll(`.${xt["cell--pinnedLeft"]}`);Re==null||Re.forEach(Oe=>{_N(Oe)>oe&&(Oe.style.left=`${parseInt(getComputedStyle(Oe).left,10)-we}px`)})}if(Ee){const Re=(Me=f.current)==null?void 0:Me.querySelectorAll(`.${xt["cell--pinnedRight"]}`);Re==null||Re.forEach(Oe=>{_N(Oe)<oe&&(Oe.style.right=`${parseInt(getComputedStyle(Oe).right,10)+we}px`)})}}),K.jsx(hge,Ge({className:u.root,ref:_},t,{children:re}))}),mge=["variant","noRowsVariant","style"],gge={"circular-progress":{component:Jj,style:{}},"linear-progress":{component:Yne,style:{display:"block"}},skeleton:{component:pge,style:{display:"block"}}},yge=X.forwardRef(function(t,n){const{variant:s="circular-progress",noRowsVariant:a="circular-progress",style:u}=t,f=Zr(t,mge),_=Bi(),r=Kn(_,$E),C=gge[r===0?a:s];return K.jsx(XA,Ge({ref:n,style:Ge({},C.style,u)},f,{children:K.jsx(C.component,{})}))}),_ge=X.forwardRef(function(t,n){const a=Bi().current.getLocaleText("noRowsLabel");return K.jsx(XA,Ge({ref:n},t,{children:a}))}),vge=Dn(Jie)(({theme:e})=>({maxHeight:"calc(100% + 1px)",flexGrow:1,[`& .${_m.selectLabel}`]:{display:"none",[e.breakpoints.up("sm")]:{display:"block"}},[`& .${_m.input}`]:{display:"none",[e.breakpoints.up("sm")]:{display:"inline-flex"}}})),xge=(e,t)=>({from:n,to:s,count:a,page:u})=>e({from:n,to:s,count:a,page:u,estimated:t}),bge=({from:e,to:t,count:n,estimated:s})=>s?`${e}–${t} of ${n!==-1?n:`more than ${s>t?s:t}`}`:`${e}–${t} of ${n!==-1?n:`more than ${t}`}`,wge=X.forwardRef(function(t,n){const s=Bi(),a=Ur(),u=Kn(s,Al),f=Kn(s,Cy),_=Kn(s,XV),{paginationMode:r,loading:C,estimatedRowCount:k}=a,I=X.useMemo(()=>f===-1&&r==="server"&&C?{backIconButtonProps:{disabled:!0},nextIconButtonProps:{disabled:!0}}:{},[C,r,f]),P=X.useMemo(()=>Math.max(0,_-1),[_]),D=X.useMemo(()=>f===-1||u.page<=P?u.page:P,[P,u.page,f]),N=X.useCallback(re=>{const le=Number(re.target.value);s.current.setPageSize(le)},[s]),j=X.useCallback((re,le)=>{s.current.setPage(le)},[s]),H=(re=>{for(let le=0;le<a.pageSizeOptions.length;le+=1){const _e=a.pageSizeOptions[le];if(typeof _e=="number"){if(_e===re)return!0}else if(_e.value===re)return!0}return!1})(u.pageSize)?a.pageSizeOptions:[],q=s.current.getLocaleText("MuiTablePagination"),Z=xge(q.labelDisplayedRows||bge,k);return K.jsx(vge,Ge({ref:n,component:"div",count:f,page:D,rowsPerPageOptions:H,rowsPerPage:u.pageSize,onPageChange:j,onRowsPerPageChange:N},I,q,{labelDisplayedRows:Z},t))}),Sge=["className","rowCount","visibleRowCount"],Cge=e=>{const{classes:t}=e;return yr({root:["rowCount"]},Gi,t)},Ege=Wo("div",{name:"MuiDataGrid",slot:"RowCount",overridesResolver:(e,t)=>t.rowCount})(({theme:e})=>({alignItems:"center",display:"flex",margin:e.spacing(0,2)})),Tge=X.forwardRef(function(t,n){const{className:s,rowCount:a,visibleRowCount:u}=t,f=Zr(t,Sge),_=Bi(),r=Ur(),C=Cge(r);if(a===0)return null;const k=u<a?_.current.getLocaleText("footerTotalVisibleRows")(u,a):a.toLocaleString();return K.jsxs(Ege,Ge({ref:n,className:Hn(C.root,s),ownerState:r},f,{children:[_.current.getLocaleText("footerTotalRows")," ",k]}))});function Ige(e,t){return yr(t,Gi,e)}const kge=["selected","rowId","row","index","style","rowHeight","className","visibleColumns","pinnedColumns","offsetTop","offsetLeft","dimensions","renderContext","focusedColumnIndex","isFirstVisible","isLastVisible","isNotVisible","showBottomBorder","focusedCell","tabbableCell","onClick","onDoubleClick","onMouseEnter","onMouseLeave","onMouseOut","onMouseOver"];function Mge({width:e}){return e?K.jsx("div",{role:"presentation",className:Hn(xt.cell,xt.cellEmpty),style:{"--width":`${e}px`}}):null}const Pge=X.forwardRef(function(t,n){var lr;const{selected:s,rowId:a,row:u,index:f,style:_,rowHeight:r,className:C,visibleColumns:k,pinnedColumns:I,offsetLeft:P,dimensions:D,renderContext:N,focusedColumnIndex:j,isFirstVisible:W,isLastVisible:H,isNotVisible:q,showBottomBorder:Z,onClick:re,onDoubleClick:le,onMouseEnter:_e,onMouseLeave:ye,onMouseOut:de,onMouseOver:ce}=t,oe=Zr(t,kge),xe=Sc(),he=l$(),Ee=X.useRef(null),se=Ur(),we=Sp(xe,se),Se=Kn(xe,Ju),Pe=Kn(xe,I0),Me=Kn(xe,bp),Re=Kn(xe,Ca),Oe=mo(Ee,n),$e=xe.current.getRowNode(a),Ke=D.hasScrollY?D.scrollbarSize:0,Ct=D.columnsTotalWidth<D.viewportOuterSize.width,Ue=xe.current.getRowMode(a)===jo.Edit,ft=se.editMode===Kd.Row,Bt=j!==void 0,hn=Bt&&j>=I.left.length&&j<N.firstColumnIndex,ot=Bt&&j<k.length-I.right.length&&j>=N.lastColumnIndex,en=Ige(se.classes,{root:["row",s&&"selected",ft&&"row--editable",Ue&&"row--editing",W&&"row--firstVisible",H&&"row--lastVisible",Z&&"row--borderBottom",r==="auto"&&"row--dynamicHeight"]}),wt=he.hooks.useGridRowAriaAttributes();X.useLayoutEffect(()=>{if(we.range){const Cn=xe.current.getRowIndexRelativeToVisibleRows(a);Cn!==void 0&&xe.current.unstable_setLastMeasuredRowIndex(Cn)}if(Ee.current&&r==="auto")return xe.current.observeRowHeight(Ee.current,a)},[xe,we.range,r,a]);const Ne=X.useCallback((Cn,xn)=>Er=>{I1(Er)||xe.current.getRow(a)&&(xe.current.publishEvent(Cn,xe.current.getRowParams(a),Er),xn&&xn(Er))},[xe,a]),We=X.useCallback(Cn=>{const xn=CC(Cn.target,xt.cell),Er=xn==null?void 0:xn.getAttribute("data-field");if(Er){if(Er===M0.field||Er===GE||Er==="__reorder__"||xe.current.getCellMode(a,Er)===Co.Edit)return;const Rr=xe.current.getColumn(Er);if((Rr==null?void 0:Rr.type)===VE)return}Ne("rowClick",re)(Cn)},[xe,re,Ne,a]),{slots:Sn,slotProps:Ae,disableColumnReorder:st}=se,gt=se.rowReordering,ut=Kn(xe,()=>Ge({},xe.current.getRowHeightEntry(a)),gV),tt=X.useMemo(()=>{if(q)return{opacity:0,width:0,height:0};const Cn=Ge({},_,{maxHeight:r==="auto"?"none":r,minHeight:r,"--height":typeof r=="number"?`${r}px`:r});if(ut.spacingTop){const xn=se.rowSpacingType==="border"?"borderTopWidth":"marginTop";Cn[xn]=ut.spacingTop}if(ut.spacingBottom){const xn=se.rowSpacingType==="border"?"borderBottomWidth":"marginBottom";let Er=Cn[xn];typeof Er!="number"&&(Er=parseInt(Er||"0",10)),Er+=ut.spacingBottom,Cn[xn]=Er}return Cn},[q,r,_,ut,se.rowSpacingType]),nt=xe.current.unstable_applyPipeProcessors("rowClassName",[],a),tn=$e?wt($e,f):void 0;if(typeof se.getRowClassName=="function"){const Cn=f-(((lr=we.range)==null?void 0:lr.firstRowIndex)||0),xn=Ge({},xe.current.getRowParams(a),{isFirstVisible:Cn===0,isLastVisible:Cn===we.rows.length-1,indexRelativeToCurrentPage:Cn});nt.push(se.getRowClassName(xn))}const un=(Cn,xn,Er,Rr,Wn=Kl.NONE)=>{var Oo;const Mn=xe.current.unstable_getCellColSpanInfo(a,Er);if(Mn!=null&&Mn.spannedByColSpan)return null;const Ar=(Mn==null?void 0:Mn.cellProps.width)??Cn.computedWidth,fi=(Mn==null?void 0:Mn.cellProps.colSpan)??1,yo=ZA(m$[Wn],Cn.computedWidth,Er,Me,D);if(($e==null?void 0:$e.type)==="skeletonRow")return K.jsx(Sn.skeletonCell,{type:Cn.type,width:Ar,height:r,field:Cn.field,align:Cn.align},Cn.field);const vr=((Oo=Re[a])==null?void 0:Oo[Cn.field])??null,zi=Cn.field==="__reorder__",Li=Object.keys(Re).length>0,mi=!(st||Cn.disableReorder),ji=gt&&!Se.length&&Pe<=1&&!Li,ko=!(mi||zi&&ji),qo=Wn===Kl.VIRTUAL;return K.jsx(Sn.cell,Ge({column:Cn,width:Ar,rowId:a,align:Cn.align||"left",colIndex:Er,colSpan:fi,disableDragEvents:ko,editCellState:vr,isNotVisible:qo,pinnedOffset:yo,pinnedPosition:Wn,sectionIndex:xn,sectionLength:Rr,gridHasFiller:Ct},Ae==null?void 0:Ae.cell),Cn.field)};if(!$e)return null;const qt=I.left.map((Cn,xn)=>un(Cn,xn,xn,I.left.length,Kl.LEFT)),an=I.right.map((Cn,xn)=>{const Er=k.length-I.right.length+xn;return un(Cn,xn,Er,I.right.length,Kl.RIGHT)}),Jt=k.length-I.left.length-I.right.length,Wt=[];hn&&Wt.push(un(k[j],j-I.left.length,j,Jt,Kl.VIRTUAL));for(let Cn=N.firstColumnIndex;Cn<N.lastColumnIndex;Cn+=1){const xn=k[Cn],Er=Cn-I.left.length;xn&&Wt.push(un(xn,Er,Cn,Jt))}ot&&Wt.push(un(k[j],j-I.left.length,j,Jt,Kl.VIRTUAL));const Fn=u?{onClick:We,onDoubleClick:Ne("rowDoubleClick",le),onMouseEnter:Ne("rowMouseEnter",_e),onMouseLeave:Ne("rowMouseLeave",ye),onMouseOut:Ne("rowMouseOut",de),onMouseOver:Ne("rowMouseOver",ce)}:null,ar=D.viewportOuterSize.width-D.columnsTotalWidth-Ke,bn=Math.max(0,ar);return K.jsxs("div",Ge({ref:Oe,"data-id":a,"data-rowindex":f,role:"row",className:Hn(...nt,en.root,C),style:tt},tn,Fn,oe,{children:[qt,K.jsx("div",{role:"presentation",className:xt.cellOffsetLeft,style:{width:P}}),Wt,bn>0&&K.jsx(Mge,{width:bn}),an.length>0&&K.jsx("div",{role:"presentation",className:xt.filler}),an,Ke!==0&&K.jsx(KA,{pinnedRight:I.right.length>0})]}))}),Age=xp(Pge),Lge=()=>{const e=Sc(),t=Ur(),n=Kn(e,ua),s=Kn(e,BA),a=Kn(e,T1),u=Kn(e,zce);return{role:"grid","aria-colcount":n.length,"aria-rowcount":a+1+u+s,"aria-multiselectable":VA(t)}},Rge=()=>{const e=Sc(),t=Kn(e,Ah),n=Kn(e,T1);return X.useCallback((s,a)=>{const u={},f=a+n+2;return u["aria-rowindex"]=f,e.current.isRowSelectable(s.id)&&(u["aria-selected"]=t[s.id]!==void 0),u},[e,t,n])};function Oge({privateApiRef:e,configuration:t,props:n,children:s}){const a=X.useRef(e.current.getPublicApi());return K.jsx(a$.Provider,{value:t,children:K.jsx(pV.Provider,{value:n,children:K.jsx(n$.Provider,{value:e,children:K.jsx(fV.Provider,{value:a,children:s})})})})}const Dge=e=>{const t=X.useRef(null),n=X.useRef(null),s=X.useRef(null),a=X.useRef(null),u=X.useRef(null),f=X.useRef(null);e.current.register("public",{rootElementRef:t}),e.current.register("private",{mainElementRef:n,virtualScrollerRef:s,virtualScrollbarVerticalRef:a,virtualScrollbarHorizontalRef:u,columnHeadersContainerRef:f})},zge=e=>{const t=au();e.current.state.isRtl===void 0&&(e.current.state.isRtl=t);const n=X.useRef(!0);X.useEffect(()=>{n.current?n.current=!1:e.current.setState(s=>Ge({},s,{isRtl:t}))},[e,t])},Fge=uce()&&window.localStorage.getItem("DEBUG")!=null,Yv=()=>{},Nge={debug:Yv,info:Yv,warn:Yv,error:Yv},vN=["debug","info","warn","error"];function xN(e,t,n=console){const s=vN.indexOf(t);if(s===-1)throw new Error(`MUI X: Log level ${t} not recognized.`);return vN.reduce((u,f,_)=>(_>=s?u[f]=(...r)=>{const[C,...k]=r;n[f](`MUI X: ${e} - ${C}`,...k)}:u[f]=Yv,u),{})}const Bge=(e,t)=>{const n=X.useCallback(s=>Fge?xN(s,"debug",t.logger):t.logLevel?xN(s,t.logLevel.toString(),t.logger):Nge,[t.logLevel,t.logger]);Ei(e,{getLogger:n},"private")};class jge{constructor(){this.maxListeners=20,this.warnOnce=!1,this.events={}}on(t,n,s={}){let a=this.events[t];a||(a={highPriority:new Map,regular:new Map},this.events[t]=a),s.isFirst?a.highPriority.set(n,!0):a.regular.set(n,!0)}removeListener(t,n){this.events[t]&&(this.events[t].regular.delete(n),this.events[t].highPriority.delete(n))}removeAllListeners(){this.events={}}emit(t,...n){const s=this.events[t];if(!s)return;const a=Array.from(s.highPriority.keys()),u=Array.from(s.regular.keys());for(let f=a.length-1;f>=0;f-=1){const _=a[f];s.highPriority.has(_)&&_.apply(this,n)}for(let f=0;f<u.length;f+=1){const _=u[f];s.regular.has(_)&&_.apply(this,n)}}once(t,n){const s=this;this.on(t,function a(...u){s.removeListener(t,a),n.apply(s,u)})}}class JA{static create(t){return new JA(t)}constructor(t){this.value=void 0,this.listeners=void 0,this.subscribe=n=>(this.listeners.add(n),()=>{this.listeners.delete(n)}),this.getSnapshot=()=>this.value,this.update=n=>{this.value=n,this.listeners.forEach(s=>s(n))},this.value=t,this.listeners=new Set}}const w$=Symbol("mui.api_private"),Vge=e=>e.isPropagationStopped!==void 0;let bN=0;function $ge(e){var a;const t=(a=e.current)==null?void 0:a[w$];if(t)return t;const n={},s={state:n,store:JA.create(n),instanceId:{id:bN}};return bN+=1,s.getPublicApi=()=>e.current,s.register=(u,f)=>{Object.keys(f).forEach(_=>{const r=f[_],C=s[_];if((C==null?void 0:C.spying)===!0?C.target=r:s[_]=r,u==="public"){const k=e.current,I=k[_];(I==null?void 0:I.spying)===!0?I.target=r:k[_]=r}})},s.register("private",{caches:{},eventManager:new jge}),s}function Uge(e){return{get state(){return e.current.state},get store(){return e.current.store},get instanceId(){return e.current.instanceId},[w$]:e.current}}function Gge(e,t){var f;const n=X.useRef(),s=X.useRef();s.current||(s.current=$ge(n)),n.current||(n.current=Uge(s));const a=X.useCallback((..._)=>{const[r,C,k={}]=_;if(k.defaultMuiPrevented=!1,Vge(k)&&k.isPropagationStopped())return;const I=t.signature===dc.DataGridPro||t.signature===dc.DataGridPremium?{api:s.current.getPublicApi()}:{};s.current.eventManager.emit(r,C,k,I)},[s,t.signature]),u=X.useCallback((_,r,C)=>{s.current.eventManager.on(_,r,C);const k=s.current;return()=>{k.eventManager.removeListener(_,r)}},[s]);return Ei(s,{subscribeEvent:u,publishEvent:a},"public"),e&&!((f=e.current)!=null&&f.state)&&(e.current=n.current),X.useImperativeHandle(e,()=>n.current,[n]),X.useEffect(()=>{const _=s.current;return()=>{_.publishEvent("unmount")}},[s]),s}const Hge=(e,t)=>{const n=X.useCallback(s=>{if(t.localeText[s]==null)throw new Error(`Missing translation for key ${s}.`);return t.localeText[s]},[t.localeText]);e.current.register("public",{getLocaleText:n})};function Yx(e){"@babel/helpers - typeof";return Yx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yx(e)}function Wge(e,t){if(Yx(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(Yx(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function Zx(e){var t=Wge(e,"string");return Yx(t)=="symbol"?t:t+""}const qge=e=>{const t=X.useRef({}),n=X.useRef(!1),s=X.useCallback(k=>{n.current||!k||(n.current=!0,Object.values(k.appliers).forEach(I=>{I()}),n.current=!1)},[]),a=X.useCallback((k,I,P)=>{t.current[k]||(t.current[k]={processors:new Map,processorsAsArray:[],appliers:{}});const D=t.current[k];return D.processors.get(I)!==P&&(D.processors.set(I,P),D.processorsAsArray=Array.from(t.current[k].processors.values()),s(D)),()=>{t.current[k].processors.delete(I),t.current[k].processorsAsArray=Array.from(t.current[k].processors.values())}},[s]),u=X.useCallback((k,I,P)=>(t.current[k]||(t.current[k]={processors:new Map,processorsAsArray:[],appliers:{}}),t.current[k].appliers[I]=P,()=>{const D=t.current[k].appliers,N=Zr(D,[I].map(Zx));t.current[k].appliers=N}),[]),f=X.useCallback(k=>{s(t.current[k])},[s]),_=X.useCallback((...k)=>{const[I,P,D]=k;if(!t.current[I])return P;const N=t.current[I].processorsAsArray;let j=P;for(let W=0;W<N.length;W+=1)j=N[W](j,D);return j},[]),r={registerPipeProcessor:a,registerPipeApplier:u,requestPipeProcessorsApplication:f},C={unstable_applyPipeProcessors:_};Ei(e,r,"private"),Ei(e,C,"public")},ms=(e,t,n)=>{const s=X.useRef(),a=X.useRef(`mui-${Math.round(Math.random()*1e9)}`),u=X.useCallback(()=>{s.current=e.current.registerPipeProcessor(t,a.current,n)},[e,n,t]);E1(()=>{u()});const f=X.useRef(!0);X.useEffect(()=>(f.current?f.current=!1:u(),()=>{s.current&&(s.current(),s.current=null)}),[u])},QA=(e,t,n)=>{const s=X.useRef(),a=X.useRef(`mui-${Math.round(Math.random()*1e9)}`),u=X.useCallback(()=>{s.current=e.current.registerPipeApplier(t,a.current,n)},[e,n,t]);E1(()=>{u()});const f=X.useRef(!0);X.useEffect(()=>(f.current?f.current=!1:u(),()=>{s.current&&(s.current(),s.current=null)}),[u])},TC=(e,t,n,s)=>{const a=X.useCallback(()=>{e.current.registerStrategyProcessor(t,n,s)},[e,s,n,t]);E1(()=>{a()});const u=X.useRef(!0);X.useEffect(()=>{u.current?u.current=!1:a()},[a])},Rm="none",wN={rowTreeCreation:"rowTree",filtering:"rowTree",sorting:"rowTree",visibleRowsLookupCreation:"rowTree"},Xge=e=>{const t=X.useRef(new Map),n=X.useRef({}),s=X.useCallback((r,C,k)=>{const I=()=>{const N=n.current[C],j=Zr(N,[r].map(Zx));n.current[C]=j};n.current[C]||(n.current[C]={});const P=n.current[C],D=P[r];return P[r]=k,!D||D===k||r===e.current.getActiveStrategy(wN[C])&&e.current.publishEvent("activeStrategyProcessorChange",C),I},[e]),a=X.useCallback((r,C)=>{const k=e.current.getActiveStrategy(wN[r]);if(k==null)throw new Error("Can't apply a strategy processor before defining an active strategy");const I=n.current[r];if(!I||!I[k])throw new Error(`No processor found for processor "${r}" on strategy "${k}"`);const P=I[k];return P(C)},[e]),u=X.useCallback(r=>{const k=Array.from(t.current.entries()).find(([,I])=>I.group!==r?!1:I.isAvailable());return(k==null?void 0:k[0])??Rm},[]),f=X.useCallback((r,C,k)=>{t.current.set(C,{group:r,isAvailable:k}),e.current.publishEvent("strategyAvailabilityChange")},[e]);Ei(e,{registerStrategyProcessor:s,applyStrategyProcessor:a,getActiveStrategy:u,setStrategyAvailability:f},"private")},Yge=e=>{const t=X.useRef({}),[,n]=X.useState(),s=X.useCallback(C=>{t.current[C.stateId]=C},[]),a=X.useCallback((C,k)=>{let I;if(CV(C)?I=C(e.current.state):I=C,e.current.state===I)return!1;let P=!1;const D=[];if(Object.keys(t.current).forEach(N=>{const j=t.current[N],W=j.stateSelector(e.current.state,e.current.instanceId),H=j.stateSelector(I,e.current.instanceId);H!==W&&(D.push({stateId:j.stateId,hasPropChanged:H!==j.propModel}),j.propModel!==void 0&&H!==j.propModel&&(P=!0))}),D.length>1)throw new Error(`You're not allowed to update several sub-state in one transaction. You already updated ${D[0].stateId}, therefore, you're not allowed to update ${D.map(N=>N.stateId).join(", ")} in the same transaction.`);if(P||(e.current.state=I,e.current.publishEvent("stateChange",I),e.current.store.update(I)),D.length===1){const{stateId:N,hasPropChanged:j}=D[0],W=t.current[N],H=W.stateSelector(I,e.current.instanceId);W.propOnChange&&j&&W.propOnChange(H,{reason:k,api:e.current}),P||e.current.publishEvent(W.changeEvent,H,{reason:k})}return!P},[e]),u=X.useCallback((C,k,I)=>e.current.setState(P=>Ge({},P,{[C]:k(P[C])}),I),[e]),f=X.useCallback(()=>n(()=>e.current.state),[e]),_={setState:a,forceUpdate:f},r={updateControlState:u,registerControlState:s};Ei(e,_,"public"),Ei(e,r,"private")},Zge=(e,t)=>{const n=Gge(e,t);return Dge(n),zge(n),Bge(n,t),Yge(n),qge(n),Xge(n),Hge(n,t),n.current.register("private",{rootProps:t}),n},Sa=(e,t,n)=>{const s=X.useRef(!1);s.current||(t.current.state=e(t.current.state,n,t),s.current=!0)};function FP(e,t){if(e==null)return"";const n=typeof e=="string"?e:`${e}`;if(t.shouldAppendQuotes||t.escapeFormulas){const s=n.replace(/"/g,'""');return t.escapeFormulas&&["=","+","-","@","	","\r"].includes(s[0])?`"'${s}"`:[t.delimiter,`
`,"\r",'"'].some(a=>n.includes(a))?`"${s}"`:s}return n}const S$=(e,t)=>{var u,f;const{csvOptions:n,ignoreValueFormatter:s}=t;let a;if(s){const _=e.colDef.type;_==="number"?a=String(e.value):_==="date"||_==="dateTime"?a=(u=e.value)==null?void 0:u.toISOString():typeof((f=e.value)==null?void 0:f.toString)=="function"?a=e.value.toString():a=e.value}else a=e.formattedValue;return FP(a,n)};class NP{constructor(t){this.options=void 0,this.rowString="",this.isEmpty=!0,this.options=t}addValue(t){this.isEmpty||(this.rowString+=this.options.csvOptions.delimiter),typeof this.options.sanitizeCellValue=="function"?this.rowString+=this.options.sanitizeCellValue(t,this.options.csvOptions):this.rowString+=t,this.isEmpty=!1}getRowString(){return this.rowString}}const Kge=({id:e,columns:t,getCellParams:n,csvOptions:s,ignoreValueFormatter:a})=>{const u=new NP({csvOptions:s});return t.forEach(f=>{const _=n(e,f.field);u.addValue(S$(_,{ignoreValueFormatter:a,csvOptions:s}))}),u.getRowString()};function Jge(e){const{columns:t,rowIds:n,csvOptions:s,ignoreValueFormatter:a,apiRef:u}=e,f=n.reduce((I,P)=>`${I}${Kge({id:P,columns:t,getCellParams:u.current.getCellParams,ignoreValueFormatter:a,csvOptions:s})}\r
`,"").trim();if(!s.includeHeaders)return f;const _=t.filter(I=>I.field!==M0.field),r=[];if(s.includeColumnGroupsHeaders){const I=u.current.getAllGroupDetails();let P=0;const D=_.reduce((N,j)=>{const W=u.current.getColumnGroupPath(j.field);return N[j.field]=W,P=Math.max(P,W.length),N},{});for(let N=0;N<P;N+=1){const j=new NP({csvOptions:s,sanitizeCellValue:FP});r.push(j),_.forEach(W=>{const H=(D[W.field]||[])[N],q=I[H];j.addValue(q?q.headerName||q.groupId:"")})}}const C=new NP({csvOptions:s,sanitizeCellValue:FP});return _.forEach(I=>{C.addValue(I.headerName||I.field)}),r.push(C),`${`${r.map(I=>I.getRowString()).join(`\r
`)}\r
`}${f}`.trim()}function SN(e){const t=document.createElement("span");t.style.whiteSpace="pre",t.style.userSelect="all",t.style.opacity="0px",t.textContent=e,document.body.appendChild(t);const n=document.createRange();n.selectNode(t);const s=window.getSelection();s.removeAllRanges(),s.addRange(n);try{document.execCommand("copy")}finally{document.body.removeChild(t)}}function Qge(e){navigator.clipboard?navigator.clipboard.writeText(e).catch(()=>{SN(e)}):SN(e)}function eye(e){var t;return!!((t=window.getSelection())!=null&&t.toString()||e&&(e.selectionEnd||0)-(e.selectionStart||0)>0)}const tye=(e,t)=>{const n=t.ignoreValueFormatterDuringExport,s=(typeof n=="object"?n==null?void 0:n.clipboardExport:n)||!1,a=t.clipboardCopyCellDelimiter,u=X.useCallback(f=>{if(!nme(f)||eye(f.target))return;let _="";if(e.current.getSelectedRows().size>0)_=e.current.getDataAsCsv({includeHeaders:!1,delimiter:a,shouldAppendQuotes:!1,escapeFormulas:!1});else{const C=_u(e);if(C){const k=e.current.getCellParams(C.id,C.field);_=S$(k,{csvOptions:{delimiter:a,shouldAppendQuotes:!1,escapeFormulas:!1},ignoreValueFormatter:s})}}_=e.current.unstable_applyPipeProcessors("clipboardCopy",_),_&&(Qge(_),e.current.publishEvent("clipboardCopy",_))},[e,s,a]);GV(e,e.current.rootElementRef,"keydown",u),Vo(e,"clipboardCopy",t.onClipboardCopy)},nye=e=>Ge({},e,{columnMenu:{open:!1}}),rye=e=>{const t=_a(e,"useGridColumnMenu"),n=X.useCallback(f=>{const _=vS(e.current.state),r={open:!0,field:f};(r.open!==_.open||r.field!==_.field)&&(e.current.setState(k=>k.columnMenu.open&&k.columnMenu.field===f?k:(t.debug("Opening Column Menu"),Ge({},k,{columnMenu:{open:!0,field:f}}))),e.current.hidePreferences(),e.current.forceUpdate())},[e,t]),s=X.useCallback(()=>{const f=vS(e.current.state);if(f.field){const C=Hh(e),k=lc(e),I=Ph(e);let P=f.field;if(C[P]||(P=I[0]),k[P]===!1){const D=I.filter(j=>j===P?!0:k[j]!==!1),N=D.indexOf(P);P=D[N+1]||D[N-1]}e.current.setColumnHeaderFocus(P)}const _={open:!1,field:void 0};(_.open!==f.open||_.field!==f.field)&&(e.current.setState(C=>(t.debug("Hiding Column Menu"),Ge({},C,{columnMenu:_}))),e.current.forceUpdate())},[e,t]),a=X.useCallback(f=>{t.debug("Toggle Column Menu");const _=vS(e.current.state);!_.open||_.field!==f?n(f):s()},[e,t,n,s]);Ei(e,{showColumnMenu:n,hideColumnMenu:s,toggleColumnMenu:a},"public"),Lr(e,"columnResizeStart",s),Lr(e,"virtualScrollerWheel",e.current.hideColumnMenu),Lr(e,"virtualScrollerTouchMove",e.current.hideColumnMenu)},iye=(e,t,n)=>{var a,u,f;const s=oy({apiRef:n,columnsToUpsert:t.columns,initialState:(a=t.initialState)==null?void 0:a.columns,columnVisibilityModel:t.columnVisibilityModel??((f=(u=t.initialState)==null?void 0:u.columns)==null?void 0:f.columnVisibilityModel)??{},keepOnlyColumnsToUpsert:!0});return Ge({},e,{columns:s,pinnedColumns:e.pinnedColumns??LP})};function oye(e,t){var oe,xe;const n=_a(e,"useGridColumns"),s=X.useRef(t.columns);e.current.registerControlState({stateId:"visibleColumns",propModel:t.columnVisibilityModel,propOnChange:t.onColumnVisibilityModelChange,stateSelector:lc,changeEvent:"columnVisibilityModelChange"});const a=X.useCallback(he=>{var Ee,se;n.debug("Updating columns state."),e.current.setState(CN(he)),e.current.publishEvent("columnsChange",he.orderedFields),(se=(Ee=e.current).updateRenderContext)==null||se.call(Ee),e.current.forceUpdate()},[n,e]),u=X.useCallback(he=>Hh(e)[he],[e]),f=X.useCallback(()=>Qc(e),[e]),_=X.useCallback(()=>ua(e),[e]),r=X.useCallback((he,Ee=!0)=>(Ee?ua(e):Qc(e)).findIndex(we=>we.field===he),[e]),C=X.useCallback(he=>{const Ee=r(he);return bp(e)[Ee]},[e,r]),k=X.useCallback(he=>{var se,we;lc(e)!==he&&(e.current.setState(Se=>Ge({},Se,{columns:oy({apiRef:e,columnsToUpsert:[],initialState:void 0,columnVisibilityModel:he,keepOnlyColumnsToUpsert:!1})})),(we=(se=e.current).updateRenderContext)==null||we.call(se),e.current.forceUpdate())},[e]),I=X.useCallback(he=>{const Ee=oy({apiRef:e,columnsToUpsert:he,initialState:void 0,keepOnlyColumnsToUpsert:!1});a(Ee)},[e,a]),P=X.useCallback((he,Ee)=>{const se=lc(e),we=se[he]??!0;if(Ee!==we){const Se=Ge({},se,{[he]:Ee});e.current.setColumnVisibilityModel(Se)}},[e]),D=X.useCallback(he=>Ph(e).findIndex(se=>se===he),[e]),N=X.useCallback((he,Ee)=>{const se=Ph(e),we=D(he);if(we===Ee)return;n.debug(`Moving column ${he} to index ${Ee}`);const Se=[...se],Pe=Se.splice(we,1)[0];Se.splice(Ee,0,Pe),a(Ge({},Hd(e.current.state),{orderedFields:Se}));const Me={column:e.current.getColumn(he),targetIndex:e.current.getColumnIndexRelativeToVisibleColumns(he),oldIndex:we};e.current.publishEvent("columnIndexChange",Me)},[e,n,a,D]),j=X.useCallback((he,Ee)=>{n.debug(`Updating column ${he} width to ${Ee}`);const se=Hd(e.current.state),we=se.lookup[he],Se=Ge({},we,{width:Ee,hasBeenResized:!0});a(OP(Ge({},se,{lookup:Ge({},se.lookup,{[he]:Se})}),e.current.getRootDimensions())),e.current.publishEvent("columnWidthChange",{element:e.current.getColumnHeaderElement(he),colDef:Se,width:Ee})},[e,n,a]),W={getColumn:u,getAllColumns:f,getColumnIndex:r,getColumnPosition:C,getVisibleColumns:_,getColumnIndexRelativeToVisibleColumns:D,updateColumns:I,setColumnVisibilityModel:k,setColumnVisibility:P,setColumnWidth:j},H={setColumnIndex:N};Ei(e,W,"public"),Ei(e,H,t.signature===dc.DataGrid?"private":"public");const q=X.useCallback((he,Ee)=>{var Re,Oe;const se={},we=lc(e);(!Ee.exportOnlyDirtyModels||t.columnVisibilityModel!=null||Object.keys(((Oe=(Re=t.initialState)==null?void 0:Re.columns)==null?void 0:Oe.columnVisibilityModel)??{}).length>0||Object.keys(we).length>0)&&(se.columnVisibilityModel=we),se.orderedFields=Ph(e);const Pe=Qc(e),Me={};return Pe.forEach($e=>{if($e.hasBeenResized){const Ke={};t$.forEach(Ct=>{let Ue=$e[Ct];Ue===1/0&&(Ue=-1),Ke[Ct]=Ue}),Me[$e.field]=Ke}}),Object.keys(Me).length>0&&(se.dimensions=Me),Ge({},he,{columns:se})},[e,t.columnVisibilityModel,(oe=t.initialState)==null?void 0:oe.columns]),Z=X.useCallback((he,Ee)=>{var Pe;const se=(Pe=Ee.stateToRestore.columns)==null?void 0:Pe.columnVisibilityModel,we=Ee.stateToRestore.columns;if(se==null&&we==null)return he;const Se=oy({apiRef:e,columnsToUpsert:[],initialState:we,columnVisibilityModel:se,keepOnlyColumnsToUpsert:!1});return e.current.setState(CN(Se)),we!=null&&e.current.publishEvent("columnsChange",Se.orderedFields),he},[e]),re=X.useCallback((he,Ee)=>{var se;if(Ee===Lm.columns){const we=t.slots.columnsPanel;return K.jsx(we,Ge({},(se=t.slotProps)==null?void 0:se.columnsPanel))}return he},[t.slots.columnsPanel,(xe=t.slotProps)==null?void 0:xe.columnsPanel]),le=X.useCallback(he=>t.disableColumnSelector?he:[...he,"columnMenuColumnsItem"],[t.disableColumnSelector]);ms(e,"columnMenu",le),ms(e,"exportState",q),ms(e,"restoreState",Z),ms(e,"preferencePanel",re);const _e=X.useRef(null);Lr(e,"viewportInnerSizeChange",he=>{_e.current!==he.width&&(_e.current=he.width,a(OP(Hd(e.current.state),e.current.getRootDimensions())))});const de=X.useCallback(()=>{n.info("Columns pipe processing have changed, regenerating the columns");const he=oy({apiRef:e,columnsToUpsert:[],initialState:void 0,keepOnlyColumnsToUpsert:!1});a(he)},[e,n,a]);QA(e,"hydrateColumns",de);const ce=X.useRef(!0);X.useEffect(()=>{if(ce.current){ce.current=!1;return}if(n.info(`GridColumns have changed, new length ${t.columns.length}`),s.current===t.columns)return;const he=oy({apiRef:e,initialState:void 0,columnsToUpsert:t.columns,keepOnlyColumnsToUpsert:!0});s.current=t.columns,a(he)},[n,e,a,t.columns]),X.useEffect(()=>{t.columnVisibilityModel!==void 0&&e.current.setColumnVisibilityModel(t.columnVisibilityModel)},[e,n,t.columnVisibilityModel])}function CN(e){return t=>Ge({},t,{columns:e})}const sye=(e,t)=>{var n;return Ge({},e,{density:((n=t.initialState)==null?void 0:n.density)??t.density??"standard"})},aye=(e,t)=>{var _;const n=_a(e,"useDensity");e.current.registerControlState({stateId:"density",propModel:t.density,propOnChange:t.onDensityChange,stateSelector:Sy,changeEvent:"densityChange"});const a={setDensity:Ui(r=>{Sy(e.current.state)!==r&&(n.debug(`Set grid density to ${r}`),e.current.setState(k=>Ge({},k,{density:r})))})};Ei(e,a,"public");const u=X.useCallback((r,C)=>{var P;const k=Sy(e.current.state);return!C.exportOnlyDirtyModels||t.density!=null||((P=t.initialState)==null?void 0:P.density)!=null?Ge({},r,{density:k}):r},[e,t.density,(_=t.initialState)==null?void 0:_.density]),f=X.useCallback((r,C)=>{var I;const k=(I=C.stateToRestore)!=null&&I.density?C.stateToRestore.density:Sy(e.current.state);return e.current.setState(P=>Ge({},P,{density:k})),r},[e]);ms(e,"exportState",u),ms(e,"restoreState",f),X.useEffect(()=>{t.density&&e.current.setDensity(t.density)},[e,t.density])};function lye(e,t="csv",n=document.title||"untitled"){const s=`${n}.${t}`;if("download"in HTMLAnchorElement.prototype){const a=URL.createObjectURL(e),u=document.createElement("a");u.href=a,u.download=s,u.click(),setTimeout(()=>{URL.revokeObjectURL(a)});return}throw new Error("MUI X: exportAs not supported.")}const C$=({apiRef:e,options:t})=>{const n=Qc(e);return t.fields?t.fields.reduce((a,u)=>{const f=n.find(_=>_.field===u);return f&&a.push(f),a},[]):(t.allColumns?n:ua(e)).filter(a=>!a.disableExport)},E$=({apiRef:e})=>{var r,C;const t=jV(e),n=hl(e),s=e.current.getSelectedRows(),a=t.filter(k=>n[k].type!=="footer"),u=$m(e),f=((r=u==null?void 0:u.top)==null?void 0:r.map(k=>k.id))||[],_=((C=u==null?void 0:u.bottom)==null?void 0:C.map(k=>k.id))||[];return a.unshift(...f),a.push(..._),s.size>0?a.filter(k=>s.has(k)):a},uye=(e,t)=>{const n=_a(e,"useGridCsvExport"),s=t.ignoreValueFormatterDuringExport,a=(typeof s=="object"?s==null?void 0:s.csvExport:s)||!1,u=X.useCallback((C={})=>{n.debug("Get data as CSV");const k=C$({apiRef:e,options:C}),P=(C.getRowsToExport??E$)({apiRef:e});return Jge({columns:k,rowIds:P,csvOptions:{delimiter:C.delimiter||",",shouldAppendQuotes:C.shouldAppendQuotes??!0,includeHeaders:C.includeHeaders??!0,includeColumnGroupsHeaders:C.includeColumnGroupsHeaders??!0,escapeFormulas:C.escapeFormulas??!0},ignoreValueFormatter:a,apiRef:e})},[n,e,a]),f=X.useCallback(C=>{n.debug("Export data as CSV");const k=u(C),I=new Blob([C!=null&&C.utf8WithBom?new Uint8Array([239,187,191]):"",k],{type:"text/csv"});lye(I,"csv",C==null?void 0:C.fileName)},[n,u]);Ei(e,{getDataAsCsv:u,exportDataAsCsv:f},"public");const r=X.useCallback((C,k)=>{var I;return(I=k.csvOptions)!=null&&I.disableToolbarButton?C:[...C,{component:K.jsx(rge,{options:k.csvOptions}),componentName:"csvExport"}]},[]);ms(e,"exportMenu",r)},bS=(e,t,n)=>{let s=e.paginationModel;const a=e.rowCount,u=(n==null?void 0:n.pageSize)??s.pageSize,f=(n==null?void 0:n.page)??s.page,_=HV(a,u,f);n&&((n==null?void 0:n.page)!==s.page||(n==null?void 0:n.pageSize)!==s.pageSize)&&(s=n);const r=wde(s.page,_);return r!==s.page&&(s=Ge({},s,{page:r})),qV(s.pageSize,t),s},cye=(e,t)=>{var N,j;const n=_a(e,"useGridPaginationModel"),s=Kn(e,w1),a=Math.floor(t.rowHeight*s);e.current.registerControlState({stateId:"paginationModel",propModel:t.paginationModel,propOnChange:t.onPaginationModelChange,stateSelector:Al,changeEvent:"paginationModelChange"});const u=X.useCallback(W=>{const H=Al(e);W!==H.page&&(n.debug(`Setting page to ${W}`),e.current.setPaginationModel({page:W,pageSize:H.pageSize}))},[e,n]),f=X.useCallback(W=>{const H=Al(e);W!==H.pageSize&&(n.debug(`Setting page size to ${W}`),e.current.setPaginationModel({pageSize:W,page:H.page}))},[e,n]),_=X.useCallback(W=>{const H=Al(e);W!==H&&(n.debug("Setting 'paginationModel' to",W),e.current.setState(q=>Ge({},q,{pagination:Ge({},q.pagination,{paginationModel:bS(q.pagination,t.signature,W)})})))},[e,n,t.signature]);Ei(e,{setPage:u,setPageSize:f,setPaginationModel:_},"public");const C=X.useCallback((W,H)=>{var re,le;const q=Al(e);return!H.exportOnlyDirtyModels||t.paginationModel!=null||((le=(re=t.initialState)==null?void 0:re.pagination)==null?void 0:le.paginationModel)!=null||q.page!==0&&q.pageSize!==bde(t.autoPageSize)?Ge({},W,{pagination:Ge({},W.pagination,{paginationModel:q})}):W},[e,t.paginationModel,(j=(N=t.initialState)==null?void 0:N.pagination)==null?void 0:j.paginationModel,t.autoPageSize]),k=X.useCallback((W,H)=>{var Z,re;const q=(Z=H.stateToRestore.pagination)!=null&&Z.paginationModel?Ge({},WV(t.autoPageSize),(re=H.stateToRestore.pagination)==null?void 0:re.paginationModel):Al(e);return e.current.setState(le=>Ge({},le,{pagination:Ge({},le.pagination,{paginationModel:bS(le.pagination,t.signature,q)})})),W},[e,t.autoPageSize,t.signature]);ms(e,"exportState",C),ms(e,"restoreState",k);const I=()=>{var H;const W=Al(e);(H=e.current.virtualScrollerRef)!=null&&H.current&&e.current.scrollToIndexes({rowIndex:W.page*W.pageSize})},P=X.useCallback(()=>{if(!t.autoPageSize)return;const W=e.current.getRootDimensions(),H=Math.floor(W.viewportInnerSize.height/a);e.current.setPageSize(H)},[e,t.autoPageSize,a]),D=X.useCallback(W=>{if(W==null)return;const H=Al(e),q=XV(e);H.page>q-1&&e.current.setPage(Math.max(0,q-1))},[e]);Lr(e,"viewportInnerSizeChange",P),Lr(e,"paginationModelChange",I),Lr(e,"rowCountChange",D),X.useEffect(()=>{e.current.setState(W=>Ge({},W,{pagination:Ge({},W.pagination,{paginationModel:bS(W.pagination,t.signature,t.paginationModel)})}))},[e,t.paginationModel,t.paginationMode,t.signature]),X.useEffect(P,[P])};function dye(){return new Promise(e=>{requestAnimationFrame(()=>{e()})})}function hye(e){const t=document.createElement("iframe");return t.style.position="absolute",t.style.width="0px",t.style.height="0px",t.title=e||document.title,t}const fye=(e,t)=>{const n=e.current.rootElementRef.current!==null,s=_a(e,"useGridPrintExport"),a=X.useRef(null),u=X.useRef(null),f=X.useRef({}),_=X.useRef([]),r=X.useRef();X.useEffect(()=>{a.current=As(e.current.rootElementRef.current)},[e,n]);const C=X.useCallback((W,H,q)=>new Promise(Z=>{const re=C$({apiRef:e,options:{fields:W,allColumns:H}}).map(ye=>ye.field),le=Qc(e),_e={};le.forEach(ye=>{_e[ye.field]=re.includes(ye.field)}),q&&(_e[M0.field]=!0),e.current.setColumnVisibilityModel(_e),Z()}),[e]),k=X.useCallback(W=>{const q=W({apiRef:e}).reduce((Z,re)=>{const le=e.current.getRow(re);return le[Ny]||Z.push(le),Z},[]);e.current.setRows(q)},[e]),I=X.useCallback((W,H)=>{var se,we,Se,Pe;const q=Ge({copyStyles:!0,hideToolbar:!1,hideFooter:!1,includeCheckboxes:!1},H),Z=W.contentDocument;if(!Z)return;const re=P0(e.current.state),le=e.current.rootElementRef.current,_e=le.cloneNode(!0),ye=_e.querySelector(`.${xt.main}`);ye.style.overflow="visible",_e.style.contain="size";let de=((se=le.querySelector(`.${xt.toolbarContainer}`))==null?void 0:se.offsetHeight)||0,ce=((we=le.querySelector(`.${xt.footerContainer}`))==null?void 0:we.offsetHeight)||0;q.hideToolbar&&((Se=_e.querySelector(`.${xt.toolbarContainer}`))==null||Se.remove(),de=0),q.hideFooter&&((Pe=_e.querySelector(`.${xt.footerContainer}`))==null||Pe.remove(),ce=0);const oe=re.currentPageTotalHeight+HA(e,t)+de+ce;if(_e.style.height=`${oe}px`,_e.style.boxSizing="content-box",!q.hideFooter){const Me=_e.querySelector(`.${xt.footerContainer}`);Me.style.position="absolute",Me.style.width="100%",Me.style.top=`${oe-ce}px`}const xe=document.createElement("div");xe.appendChild(_e),Z.body.style.marginTop="0px",Z.body.innerHTML=xe.innerHTML;const he=typeof q.pageStyle=="function"?q.pageStyle():q.pageStyle;if(typeof he=="string"){const Me=Z.createElement("style");Me.appendChild(Z.createTextNode(he)),Z.head.appendChild(Me)}q.bodyClassName&&Z.body.classList.add(...q.bodyClassName.split(" "));const Ee=[];if(q.copyStyles){const Me=le.getRootNode(),Oe=(Me.constructor.name==="ShadowRoot"?Me:a.current).querySelectorAll("style, link[rel='stylesheet']");for(let $e=0;$e<Oe.length;$e+=1){const Ke=Oe[$e];if(Ke.tagName==="STYLE"){const Ct=Z.createElement(Ke.tagName),Ue=Ke.sheet;if(Ue){let ft="";for(let Bt=0;Bt<Ue.cssRules.length;Bt+=1)typeof Ue.cssRules[Bt].cssText=="string"&&(ft+=`${Ue.cssRules[Bt].cssText}\r
`);Ct.appendChild(Z.createTextNode(ft)),Z.head.appendChild(Ct)}}else if(Ke.getAttribute("href")){const Ct=Z.createElement(Ke.tagName);for(let Ue=0;Ue<Ke.attributes.length;Ue+=1){const ft=Ke.attributes[Ue];ft&&Ct.setAttribute(ft.nodeName,ft.nodeValue||"")}Ee.push(new Promise(Ue=>{Ct.addEventListener("load",()=>Ue())})),Z.head.appendChild(Ct)}}}Promise.all(Ee).then(()=>{W.contentWindow.print()})},[e,a,t]),P=X.useCallback(W=>{var H,q;a.current.body.removeChild(W),e.current.restoreState(u.current||{}),(q=(H=u.current)==null?void 0:H.columns)!=null&&q.columnVisibilityModel||e.current.setColumnVisibilityModel(f.current),e.current.setState(Z=>Ge({},Z,{virtualization:r.current})),e.current.setRows(_.current),u.current=null,f.current={},_.current=[]},[e]),N={exportDataAsPrint:X.useCallback(async W=>{if(s.debug("Export data as Print"),!e.current.rootElementRef.current)throw new Error("MUI X: No grid root element available.");if(u.current=e.current.exportState(),f.current=lc(e),_.current=e.current.getSortedRows().filter(q=>!q[Ny]),t.pagination){const Z={page:0,pageSize:BA(e)};e.current.setState(re=>Ge({},re,{pagination:Ge({},re.pagination,{paginationModel:bS(re.pagination,"DataGridPro",Z)})}))}r.current=e.current.state.virtualization,e.current.setState(q=>Ge({},q,{virtualization:Ge({},q.virtualization,{enabled:!1,enabledForColumns:!1})})),await C(W==null?void 0:W.fields,W==null?void 0:W.allColumns,W==null?void 0:W.includeCheckboxes),k((W==null?void 0:W.getRowsToExport)??E$),await dye();const H=hye(W==null?void 0:W.fileName);H.onload=()=>{I(H,W),H.contentWindow.matchMedia("print").addEventListener("change",Z=>{Z.matches===!1&&P(H)})},a.current.body.appendChild(H)},[t,s,e,I,P,C,k])};Ei(e,N,"public");const j=X.useCallback((W,H)=>{var q;return(q=H.printOptions)!=null&&q.disableToolbarButton?W:[...W,{component:K.jsx(ige,{options:H.printOptions}),componentName:"printExport"}]},[]);ms(e,"exportMenu",j)},pye=(e,t,n)=>{var a,u;const s=t.filterModel??((u=(a=t.initialState)==null?void 0:a.filter)==null?void 0:u.filterModel)??Wx();return Ge({},e,{filter:{filterModel:zA(s,t.disableMultipleColumnsFiltering,n),filteredRowsLookup:{},filteredChildrenCountLookup:{},filteredDescendantCountLookup:{}},visibleRowsLookup:{}})},mye=e=>e.filteredRowsLookup;function EN(e,t){return e.current.applyStrategyProcessor("visibleRowsLookupCreation",{tree:t.rows.tree,filteredRowsLookup:t.filter.filteredRowsLookup})}function gye(){return yV(Object.values)}const yye=(e,t)=>{var ce,oe,xe;const n=_a(e,"useGridFilter");e.current.registerControlState({stateId:"filter",propModel:t.filterModel,propOnChange:t.onFilterModelChange,stateSelector:Ba,changeEvent:"filterModelChange"});const s=X.useCallback(()=>{e.current.setState(he=>{const Ee=Ba(he,e.current.instanceId),se=e.current.getFilterState(Ee),we=Ge({},he,{filter:Ge({},he.filter,se)}),Se=EN(e,we);return Ge({},we,{visibleRowsLookup:Se})}),e.current.publishEvent("filteredRowsSet")},[e]),a=X.useCallback((he,Ee)=>Ee==null||Ee.filterable===!1||t.disableColumnFilter?he:[...he,"columnMenuFilterItem"],[t.disableColumnFilter]),u=X.useCallback(()=>{s(),e.current.forceUpdate()},[e,s]),f=X.useCallback(he=>{const Ee=Ba(e),se=[...Ee.items],we=se.findIndex(Se=>Se.id===he.id);we===-1?se.push(he):se[we]=he,e.current.setFilterModel(Ge({},Ee,{items:se}),"upsertFilterItem")},[e]),_=X.useCallback(he=>{const Ee=Ba(e),se=[...Ee.items];he.forEach(we=>{const Se=se.findIndex(Pe=>Pe.id===we.id);Se===-1?se.push(we):se[Se]=we}),e.current.setFilterModel(Ge({},Ee,{items:se}),"upsertFilterItems")},[e]),r=X.useCallback(he=>{const Ee=Ba(e),se=Ee.items.filter(we=>we.id!==he.id);se.length!==Ee.items.length&&e.current.setFilterModel(Ge({},Ee,{items:se}),"deleteFilterItem")},[e]),C=X.useCallback((he,Ee,se)=>{if(n.debug("Displaying filter panel"),he){const we=Ba(e),Se=we.items.filter(Oe=>{var Ue;if(Oe.value!==void 0)return!(Array.isArray(Oe.value)&&Oe.value.length===0);const Ke=(Ue=e.current.getColumn(Oe.field).filterOperators)==null?void 0:Ue.find(ft=>ft.value===Oe.operator);return!(typeof(Ke==null?void 0:Ke.requiresFilterValue)>"u"?!0:Ke==null?void 0:Ke.requiresFilterValue)});let Pe;const Me=Se.find(Oe=>Oe.field===he),Re=e.current.getColumn(he);Me?Pe=Se:t.disableMultipleColumnsFiltering?Pe=[RP({field:he,operator:Re.filterOperators[0].value},e)]:Pe=[...Se,RP({field:he,operator:Re.filterOperators[0].value},e)],e.current.setFilterModel(Ge({},we,{items:Pe}))}e.current.showPreferences(Lm.filters,Ee,se)},[e,n,t.disableMultipleColumnsFiltering]),k=X.useCallback(()=>{n.debug("Hiding filter panel"),e.current.hidePreferences()},[e,n]),I=X.useCallback(he=>{const Ee=Ba(e);Ee.logicOperator!==he&&e.current.setFilterModel(Ge({},Ee,{logicOperator:he}),"changeLogicOperator")},[e]),P=X.useCallback(he=>{const Ee=Ba(e);Fy(Ee.quickFilterValues,he)||e.current.setFilterModel(Ge({},Ee,{quickFilterValues:[...he]}))},[e]),D=X.useCallback((he,Ee)=>{Ba(e)!==he&&(n.debug("Setting filter model"),e.current.updateControlState("filter",F4(he,t.disableMultipleColumnsFiltering,e),Ee),e.current.unstable_applyFilters())},[e,n,t.disableMultipleColumnsFiltering]),N=X.useCallback(he=>{const Ee=zA(he,t.disableMultipleColumnsFiltering,e),se=t.filterMode==="client"?yce(Ee,e,t.disableEval):null,we=e.current.applyStrategyProcessor("filtering",{isRowMatchingFilters:se,filterModel:Ee??Wx()});return Ge({},we,{filterModel:Ee})},[t.disableMultipleColumnsFiltering,t.filterMode,t.disableEval,e]),j={setFilterLogicOperator:I,unstable_applyFilters:u,deleteFilterItem:r,upsertFilterItem:f,upsertFilterItems:_,setFilterModel:D,showFilterPanel:C,hideFilterPanel:k,setQuickFilterValues:P,ignoreDiacritics:t.ignoreDiacritics,getFilterState:N};Ei(e,j,"public");const W=X.useCallback((he,Ee)=>{var Se,Pe;const se=Ba(e);return!Ee.exportOnlyDirtyModels||t.filterModel!=null||((Pe=(Se=t.initialState)==null?void 0:Se.filter)==null?void 0:Pe.filterModel)!=null||!Fy(se,Wx())?Ge({},he,{filter:{filterModel:se}}):he},[e,t.filterModel,(oe=(ce=t.initialState)==null?void 0:ce.filter)==null?void 0:oe.filterModel]),H=X.useCallback((he,Ee)=>{var we;const se=(we=Ee.stateToRestore.filter)==null?void 0:we.filterModel;return se==null?he:(e.current.updateControlState("filter",F4(se,t.disableMultipleColumnsFiltering,e),"restoreState"),Ge({},he,{callbacks:[...he.callbacks,e.current.unstable_applyFilters]}))},[e,t.disableMultipleColumnsFiltering]),q=X.useCallback((he,Ee)=>{var se;if(Ee===Lm.filters){const we=t.slots.filterPanel;return K.jsx(we,Ge({},(se=t.slotProps)==null?void 0:se.filterPanel))}return he},[t.slots.filterPanel,(xe=t.slotProps)==null?void 0:xe.filterPanel]),{getRowId:Z}=t,re=id(gye),le=X.useCallback(he=>{if(t.filterMode!=="client"||!he.isRowMatchingFilters)return{filteredRowsLookup:{},filteredChildrenCountLookup:{},filteredDescendantCountLookup:{}};const Ee=Uf(e),se={},{isRowMatchingFilters:we}=he,Se={},Pe={passingFilterItems:null,passingQuickFilterValues:null},Me=re.current(e.current.state.rows.dataRowIdToModelLookup);for(let $e=0;$e<Me.length;$e+=1){const Ke=Me[$e],Ct=Z?Z(Ke):Ke.id;we(Ke,void 0,Pe);const Ue=vce([Pe.passingFilterItems],[Pe.passingQuickFilterValues],he.filterModel,e,Se);se[Ct]=Ue}const Re="auto-generated-group-footer-root";return Ee[Re]&&(se[Re]=!0),{filteredRowsLookup:se,filteredChildrenCountLookup:{},filteredDescendantCountLookup:{}}},[e,t.filterMode,Z,re]);ms(e,"columnMenu",a),ms(e,"exportState",W),ms(e,"restoreState",H),ms(e,"preferencePanel",q),TC(e,Rm,"filtering",le),TC(e,Rm,"visibleRowsLookupCreation",mye);const _e=X.useCallback(()=>{n.debug("onColUpdated - GridColumns changed, applying filters");const he=Ba(e),Ee=Hh(e),se=he.items.filter(we=>we.field&&Ee[we.field]);se.length<he.items.length&&e.current.setFilterModel(Ge({},he,{items:se}))},[e,n]),ye=X.useCallback(he=>{he==="filtering"&&e.current.unstable_applyFilters()},[e]),de=X.useCallback(()=>{e.current.setState(he=>Ge({},he,{visibleRowsLookup:EN(e,he)})),e.current.forceUpdate()},[e]);Lr(e,"rowsSet",s),Lr(e,"columnsChange",_e),Lr(e,"activeStrategyProcessorChange",ye),Lr(e,"rowExpansionChange",de),Lr(e,"columnVisibilityModelChange",()=>{const he=Ba(e);he.quickFilterValues&&PV(he)&&e.current.unstable_applyFilters()}),E1(()=>{e.current.unstable_applyFilters()}),Io(()=>{t.filterModel!==void 0&&e.current.setFilterModel(t.filterModel)},[e,n,t.filterModel])},_ye=e=>Ge({},e,{focus:{cell:null,columnHeader:null,columnHeaderFilter:null,columnGroupHeader:null},tabIndex:{cell:null,columnHeader:null,columnHeaderFilter:null,columnGroupHeader:null}}),vye=(e,t)=>{const n=_a(e,"useGridFocus"),s=X.useRef(null),a=e.current.rootElementRef.current!==null,u=X.useCallback((de,ce)=>{de&&e.current.getRow(de.id)&&e.current.publishEvent("cellFocusOut",e.current.getCellParams(de.id,de.field),ce)},[e]),f=X.useCallback((de,ce)=>{const oe=_u(e);(oe==null?void 0:oe.id)===de&&(oe==null?void 0:oe.field)===ce||(e.current.setState(xe=>(n.debug(`Focusing on cell with id=${de} and field=${ce}`),Ge({},xe,{tabIndex:{cell:{id:de,field:ce},columnHeader:null,columnHeaderFilter:null,columnGroupHeader:null},focus:{cell:{id:de,field:ce},columnHeader:null,columnHeaderFilter:null,columnGroupHeader:null}}))),e.current.forceUpdate(),e.current.getRow(de)&&(oe&&u(oe,{}),e.current.publishEvent("cellFocusIn",e.current.getCellParams(de,ce))))},[e,n,u]),_=X.useCallback((de,ce={})=>{const oe=_u(e);u(oe,ce),e.current.setState(xe=>(n.debug(`Focusing on column header with colIndex=${de}`),Ge({},xe,{tabIndex:{columnHeader:{field:de},columnHeaderFilter:null,cell:null,columnGroupHeader:null},focus:{columnHeader:{field:de},columnHeaderFilter:null,cell:null,columnGroupHeader:null}}))),e.current.forceUpdate()},[e,n,u]),r=X.useCallback((de,ce={})=>{const oe=_u(e);u(oe,ce),e.current.setState(xe=>(n.debug(`Focusing on column header filter with colIndex=${de}`),Ge({},xe,{tabIndex:{columnHeader:null,columnHeaderFilter:{field:de},cell:null,columnGroupHeader:null},focus:{columnHeader:null,columnHeaderFilter:{field:de},cell:null,columnGroupHeader:null}}))),e.current.forceUpdate()},[e,n,u]),C=X.useCallback((de,ce,oe={})=>{const xe=_u(e);xe&&e.current.publishEvent("cellFocusOut",e.current.getCellParams(xe.id,xe.field),oe),e.current.setState(he=>Ge({},he,{tabIndex:{columnGroupHeader:{field:de,depth:ce},columnHeader:null,columnHeaderFilter:null,cell:null},focus:{columnGroupHeader:{field:de,depth:ce},columnHeader:null,columnHeaderFilter:null,cell:null}})),e.current.forceUpdate()},[e]),k=X.useCallback(()=>wC(e),[e]),I=X.useCallback((de,ce,oe)=>{let xe=e.current.getColumnIndex(ce);const he=ua(e),Ee=jy(e,{pagination:t.pagination,paginationMode:t.paginationMode}),se=$m(e),we=[].concat(se.top||[],Ee.rows,se.bottom||[]);let Se=we.findIndex(Oe=>Oe.id===de);oe==="right"?xe+=1:oe==="left"?xe-=1:Se+=1,xe>=he.length?(Se+=1,Se<we.length&&(xe=0)):xe<0&&(Se-=1,Se>=0&&(xe=he.length-1)),Se=Wd(Se,0,we.length-1);const Pe=we[Se];if(!Pe)return;const Me=e.current.unstable_getCellColSpanInfo(Pe.id,xe);Me&&Me.spannedByColSpan&&(oe==="left"||oe==="below"?xe=Me.leftVisibleCellIndex:oe==="right"&&(xe=Me.rightVisibleCellIndex)),xe=Wd(xe,0,he.length-1);const Re=he[xe];e.current.setCellFocus(Pe.id,Re.field)},[e,t.pagination,t.paginationMode]),P=X.useCallback(({id:de,field:ce})=>{e.current.setCellFocus(de,ce)},[e]),D=X.useCallback((de,ce)=>{ce.key==="Enter"||ce.key==="Tab"||ce.key==="Shift"||EC(ce.key)||e.current.setCellFocus(de.id,de.field)},[e]),N=X.useCallback(({field:de},ce)=>{ce.target===ce.currentTarget&&e.current.setColumnHeaderFocus(de,ce)},[e]),j=X.useCallback(({fields:de,depth:ce},oe)=>{if(oe.target!==oe.currentTarget)return;const xe=wC(e);xe!==null&&xe.depth===ce&&de.includes(xe.field)||e.current.setColumnGroupHeaderFocus(de[0],ce,oe)},[e]),W=X.useCallback((de,ce)=>{var oe,xe;(xe=(oe=ce.relatedTarget)==null?void 0:oe.getAttribute("class"))!=null&&xe.includes(xt.columnHeader)||(n.debug("Clearing focus"),e.current.setState(he=>Ge({},he,{focus:{cell:null,columnHeader:null,columnHeaderFilter:null,columnGroupHeader:null}})))},[n,e]),H=X.useCallback(de=>{s.current=de},[]),q=X.useCallback(de=>{const ce=s.current;s.current=null;const oe=_u(e);if(!e.current.unstable_applyPipeProcessors("canUpdateFocus",!0,{event:de,cell:ce}))return;if(!oe){ce&&e.current.setCellFocus(ce.id,ce.field);return}if((ce==null?void 0:ce.id)===oe.id&&(ce==null?void 0:ce.field)===oe.field)return;const he=e.current.getCellElement(oe.id,oe.field);he!=null&&he.contains(de.target)||(ce?e.current.setCellFocus(ce.id,ce.field):(e.current.setState(Ee=>Ge({},Ee,{focus:{cell:null,columnHeader:null,columnHeaderFilter:null,columnGroupHeader:null}})),e.current.forceUpdate(),u(oe,de)))},[e,u]),Z=X.useCallback(de=>{if(de.cellMode==="view")return;const ce=_u(e);((ce==null?void 0:ce.id)!==de.id||(ce==null?void 0:ce.field)!==de.field)&&e.current.setCellFocus(de.id,de.field)},[e]),re=X.useCallback(()=>{var ce;const de=_u(e);if(de&&!e.current.getRow(de.id)){const oe=(ce=_u(e))==null?void 0:ce.id;let xe=null;if(typeof oe<"u"){const he=e.current.getRowIndexRelativeToVisibleRows(oe),Ee=jy(e,{pagination:t.pagination,paginationMode:t.paginationMode}),se=Ee.rows[Wd(he,0,Ee.rows.length-1)];xe=(se==null?void 0:se.id)??null}e.current.setState(he=>Ge({},he,{focus:{cell:xe===null?null:{id:xe,field:de.field},columnHeader:null,columnHeaderFilter:null,columnGroupHeader:null}}))}},[e,t.pagination,t.paginationMode]),le=Ui(()=>{const de=_u(e);if(!de)return;const ce=jy(e,{pagination:t.pagination,paginationMode:t.paginationMode});if(ce.rows.find(he=>he.id===de.id))return;const xe=ua(e);e.current.setState(he=>Ge({},he,{tabIndex:{cell:{id:ce.rows[0].id,field:xe[0].field},columnGroupHeader:null,columnHeader:null,columnHeaderFilter:null}}))}),_e={setCellFocus:f,setColumnHeaderFocus:_,setColumnHeaderFilterFocus:r},ye={moveFocusToRelativeCell:I,setColumnGroupHeaderFocus:C,getColumnGroupHeaderFocus:k};Ei(e,_e,"public"),Ei(e,ye,"private"),X.useEffect(()=>{const de=As(e.current.rootElementRef.current);return de.addEventListener("mouseup",q),()=>{de.removeEventListener("mouseup",q)}},[e,a,q]),Lr(e,"columnHeaderBlur",W),Lr(e,"cellDoubleClick",P),Lr(e,"cellMouseDown",H),Lr(e,"cellKeyDown",D),Lr(e,"cellModeChange",Z),Lr(e,"columnHeaderFocus",N),Lr(e,"columnGroupHeaderFocus",j),Lr(e,"rowsSet",re),Lr(e,"paginationModelChange",le)},xye=e=>{const t=e.match(/^__row_group_by_columns_group_(.*)__$/);return t?t[1]:null},bye=e=>e===zV||xye(e)!==null;function wye(e,t){const n=$m(e)||{};return[...n.top||[],...t,...n.bottom||[]]}const $k=({currentColIndex:e,firstColIndex:t,lastColIndex:n,isRtl:s})=>{if(s){if(e<n)return e+1}else if(!s&&e>t)return e-1;return null},Uk=({currentColIndex:e,firstColIndex:t,lastColIndex:n,isRtl:s})=>{if(s){if(e>t)return e-1}else if(!s&&e<n)return e+1;return null};function Sye(e,t,n,s){var _,r;const a=i$(e);if(!((_=a[t])!=null&&_[n]))return t;const u=jV(e);let f=u.indexOf(t)+(s==="down"?1:-1);for(;f>=0&&f<u.length;){const C=u[f];if(!((r=a[C])!=null&&r[n]))return C;f+=s==="down"?1:-1}return t}const Cye=(e,t)=>{const n=_a(e,"useGridKeyboardNavigation"),s=Sp(e,t).rows,a=au(),u=t.unstable_listView,f=X.useMemo(()=>wye(e,s),[e,s]),_=t.signature!=="DataGrid"&&t.headerFilters,r=X.useCallback((q,Z,re="left",le="up")=>{const _e=wp(e),ye=e.current.unstable_getCellColSpanInfo(Z,q);ye&&ye.spannedByColSpan&&(re==="left"?q=ye.leftVisibleCellIndex:re==="right"&&(q=ye.rightVisibleCellIndex));const de=u?f0(e.current.state).field:T0(e)[q],ce=Sye(e,Z,de,le),oe=_e.findIndex(xe=>xe.id===ce);n.debug(`Navigating to cell row ${oe}, col ${q}`),e.current.scrollToIndexes({colIndex:q,rowIndex:oe}),e.current.setCellFocus(ce,de)},[e,n,u]),C=X.useCallback((q,Z)=>{n.debug(`Navigating to header col ${q}`),e.current.scrollToIndexes({colIndex:q});const re=e.current.getVisibleColumns()[q].field;e.current.setColumnHeaderFocus(re,Z)},[e,n]),k=X.useCallback((q,Z)=>{n.debug(`Navigating to header filter col ${q}`),e.current.scrollToIndexes({colIndex:q});const re=e.current.getVisibleColumns()[q].field;e.current.setColumnHeaderFilterFocus(re,Z)},[e,n]),I=X.useCallback((q,Z,re)=>{n.debug(`Navigating to header col ${q}`),e.current.scrollToIndexes({colIndex:q});const{field:le}=e.current.getVisibleColumns()[q];e.current.setColumnGroupHeaderFocus(le,Z,re)},[e,n]),P=X.useCallback(q=>{var Z;return(Z=f[q])==null?void 0:Z.id},[f]),D=X.useCallback((q,Z)=>{const re=Z.currentTarget.querySelector(`.${xt.columnHeaderTitleContainerContent}`);if(!!re&&re.contains(Z.target)&&q.field!==M0.field)return;const _e=e.current.getViewportPageSize(),ye=q.field?e.current.getColumnIndex(q.field):0,de=f.length>0?0:null,ce=f.length-1,oe=0,xe=ua(e).length-1,he=T1(e);let Ee=!0;switch(Z.key){case"ArrowDown":{de!==null&&(_?k(ye,Z):r(ye,P(de)));break}case"ArrowRight":{const se=Uk({currentColIndex:ye,firstColIndex:oe,lastColIndex:xe,isRtl:a});se!==null&&C(se,Z);break}case"ArrowLeft":{const se=$k({currentColIndex:ye,firstColIndex:oe,lastColIndex:xe,isRtl:a});se!==null&&C(se,Z);break}case"ArrowUp":{he>0&&I(ye,he-1,Z);break}case"PageDown":{de!==null&&ce!==null&&r(ye,P(Math.min(de+_e,ce)));break}case"Home":{C(oe,Z);break}case"End":{C(xe,Z);break}case"Enter":{(Z.ctrlKey||Z.metaKey)&&e.current.toggleColumnMenu(q.field);break}case" ":break;default:Ee=!1}Ee&&Z.preventDefault()},[e,f.length,_,k,r,P,a,C,I]),N=X.useCallback((q,Z)=>{const re=lhe(e)===q.field,le=uhe(e)===q.field;if(re||le||!EC(Z.key))return;const _e=e.current.getViewportPageSize(),ye=q.field?e.current.getColumnIndex(q.field):0,de=0,ce=f.length-1,oe=0,xe=ua(e).length-1;let he=!0;switch(Z.key){case"ArrowDown":{const Ee=P(de);Ee!=null&&r(ye,Ee);break}case"ArrowRight":{const Ee=Uk({currentColIndex:ye,firstColIndex:oe,lastColIndex:xe,isRtl:a});Ee!==null&&k(Ee,Z);break}case"ArrowLeft":{const Ee=$k({currentColIndex:ye,firstColIndex:oe,lastColIndex:xe,isRtl:a});Ee!==null?k(Ee,Z):e.current.setColumnHeaderFilterFocus(q.field,Z);break}case"ArrowUp":{C(ye,Z);break}case"PageDown":{ce!==null&&r(ye,P(Math.min(de+_e,ce)));break}case"Home":{k(oe,Z);break}case"End":{k(xe,Z);break}case" ":break;default:he=!1}he&&Z.preventDefault()},[e,f.length,k,a,C,r,P]),j=X.useCallback((q,Z)=>{const re=wC(e);if(re===null)return;const{field:le,depth:_e}=re,{fields:ye,depth:de,maxDepth:ce}=q,oe=e.current.getViewportPageSize(),xe=e.current.getColumnIndex(le),he=le?e.current.getColumnIndex(le):0,Ee=0,se=f.length-1,we=0,Se=ua(e).length-1;let Pe=!0;switch(Z.key){case"ArrowDown":{de===ce-1?C(xe,Z):I(xe,_e+1,Z);break}case"ArrowUp":{de>0&&I(xe,_e-1,Z);break}case"ArrowRight":{const Me=ye.length-ye.indexOf(le)-1;xe+Me+1<=Se&&I(xe+Me+1,_e,Z);break}case"ArrowLeft":{const Me=ye.indexOf(le);xe-Me-1>=we&&I(xe-Me-1,_e,Z);break}case"PageDown":{se!==null&&r(he,P(Math.min(Ee+oe,se)));break}case"Home":{I(we,_e,Z);break}case"End":{I(Se,_e,Z);break}case" ":break;default:Pe=!1}Pe&&Z.preventDefault()},[e,f.length,C,I,r,P]),W=X.useCallback((q,Z)=>{if(I1(Z))return;const re=e.current.getCellParams(q.id,q.field);if(re.cellMode===Co.Edit||!EC(Z.key)||!e.current.unstable_applyPipeProcessors("canUpdateFocus",!0,{event:Z,cell:re})||f.length===0)return;const _e=e.current.getViewportPageSize(),ye=u?()=>0:e.current.getColumnIndex,de=q.field?ye(q.field):0,ce=f.findIndex(Se=>Se.id===q.id),oe=0,xe=f.length-1,he=0,se=(u?[f0(e.current.state)]:ua(e)).length-1;let we=!0;switch(Z.key){case"ArrowDown":{ce<xe&&r(de,P(ce+1),a?"right":"left","down");break}case"ArrowUp":{ce>oe?r(de,P(ce-1)):_?k(de,Z):C(de,Z);break}case"ArrowRight":{const Se=Uk({currentColIndex:de,firstColIndex:he,lastColIndex:se,isRtl:a});Se!==null&&r(Se,P(ce),a?"left":"right");break}case"ArrowLeft":{const Se=$k({currentColIndex:de,firstColIndex:he,lastColIndex:se,isRtl:a});Se!==null&&r(Se,P(ce),a?"right":"left");break}case"Tab":{Z.shiftKey&&de>he?r(de-1,P(ce),"left"):!Z.shiftKey&&de<se&&r(de+1,P(ce),"right");break}case" ":{if(q.field===GE)break;const Pe=q.colDef;if(Pe&&(Pe.field===jce||bye(Pe.field)))break;!Z.shiftKey&&ce<xe&&r(de,P(Math.min(ce+_e,xe)));break}case"PageDown":{ce<xe&&r(de,P(Math.min(ce+_e,xe)));break}case"PageUp":{const Se=Math.max(ce-_e,oe);Se!==ce&&Se>=oe?r(de,P(Se)):C(de,Z);break}case"Home":{Z.ctrlKey||Z.metaKey||Z.shiftKey?r(he,P(oe)):r(he,P(ce));break}case"End":{Z.ctrlKey||Z.metaKey||Z.shiftKey?r(se,P(xe)):r(se,P(ce));break}default:we=!1}we&&Z.preventDefault()},[e,f,a,r,P,_,k,C,u]),H=X.useCallback((q,{event:Z})=>Z.key===" "?!1:q,[]);ms(e,"canStartEditing",H),Lr(e,"columnHeaderKeyDown",D),Lr(e,"headerFilterKeyDown",N),Lr(e,"columnGroupHeaderKeyDown",j),Lr(e,"cellKeyDown",W)},Eye=(e,t)=>{var N,j;const n=_a(e,"useGridRowCount"),s=Kn(e,jA),a=Kn(e,Cy),u=Kn(e,Xv),f=Kn(e,Al),_=id(()=>Al(e).pageSize);e.current.registerControlState({stateId:"paginationRowCount",propModel:t.rowCount,propOnChange:t.onRowCountChange,stateSelector:Cy,changeEvent:"rowCountChange"});const C={setRowCount:X.useCallback(W=>{a!==W&&(n.debug("Setting 'rowCount' to",W),e.current.setState(H=>Ge({},H,{pagination:Ge({},H.pagination,{rowCount:W})})))},[e,n,a])};Ei(e,C,"public");const k=X.useCallback((W,H)=>{var re,le;const q=Cy(e);return!H.exportOnlyDirtyModels||t.rowCount!=null||((le=(re=t.initialState)==null?void 0:re.pagination)==null?void 0:le.rowCount)!=null?Ge({},W,{pagination:Ge({},W.pagination,{rowCount:q})}):W},[e,t.rowCount,(j=(N=t.initialState)==null?void 0:N.pagination)==null?void 0:j.rowCount]),I=X.useCallback((W,H)=>{var Z;const q=(Z=H.stateToRestore.pagination)!=null&&Z.rowCount?H.stateToRestore.pagination.rowCount:Cy(e);return e.current.setState(re=>Ge({},re,{pagination:Ge({},re.pagination,{rowCount:q})})),W},[e]);ms(e,"exportState",k),ms(e,"restoreState",I);const P=X.useCallback(W=>{t.paginationMode==="client"||!_.current||W.pageSize!==_.current&&(_.current=W.pageSize,a===-1&&e.current.setPage(0))},[t.paginationMode,_,a,e]);Lr(e,"paginationModelChange",P),X.useEffect(()=>{t.paginationMode==="client"?e.current.setRowCount(s):t.rowCount!=null&&e.current.setRowCount(t.rowCount)},[e,t.paginationMode,s,t.rowCount]);const D=u.hasNextPage===!1;X.useEffect(()=>{D&&a===-1&&e.current.setRowCount(f.pageSize*f.page+s)},[e,s,D,a,f])},Tye=(e,t)=>{var r,C;const n=_a(e,"useGridPaginationMeta"),s=Kn(e,Xv);e.current.registerControlState({stateId:"paginationMeta",propModel:t.paginationMeta,propOnChange:t.onPaginationMetaChange,stateSelector:Xv,changeEvent:"paginationMetaChange"});const u={setPaginationMeta:X.useCallback(k=>{s!==k&&(n.debug("Setting 'paginationMeta' to",k),e.current.setState(I=>Ge({},I,{pagination:Ge({},I.pagination,{meta:k})})))},[e,n,s])};Ei(e,u,"public");const f=X.useCallback((k,I)=>{var N,j;const P=Xv(e);return!I.exportOnlyDirtyModels||t.paginationMeta!=null||((j=(N=t.initialState)==null?void 0:N.pagination)==null?void 0:j.meta)!=null?Ge({},k,{pagination:Ge({},k.pagination,{meta:P})}):k},[e,t.paginationMeta,(C=(r=t.initialState)==null?void 0:r.pagination)==null?void 0:C.meta]),_=X.useCallback((k,I)=>{var D;const P=(D=I.stateToRestore.pagination)!=null&&D.meta?I.stateToRestore.pagination.meta:Xv(e);return e.current.setState(N=>Ge({},N,{pagination:Ge({},N.pagination,{meta:P})})),k},[e]);ms(e,"exportState",f),ms(e,"restoreState",_),X.useEffect(()=>{t.paginationMeta&&e.current.setPaginationMeta(t.paginationMeta)},[e,t.paginationMeta])},Iye=(e,t)=>{var u,f,_,r,C,k;const n=Ge({},WV(t.autoPageSize),t.paginationModel??((f=(u=t.initialState)==null?void 0:u.pagination)==null?void 0:f.paginationModel));qV(n.pageSize,t.signature);const s=t.rowCount??((r=(_=t.initialState)==null?void 0:_.pagination)==null?void 0:r.rowCount),a=t.paginationMeta??((k=(C=t.initialState)==null?void 0:C.pagination)==null?void 0:k.meta)??{};return Ge({},e,{pagination:{paginationModel:n,rowCount:s,meta:a}})},kye=(e,t)=>{Tye(e,t),cye(e,t),Eye(e,t)},Mye=(e,t)=>{var n;return Ge({},e,{preferencePanel:((n=t.initialState)==null?void 0:n.preferencePanel)??{open:!1}})},Pye=(e,t)=>{var I;const n=_a(e,"useGridPreferencesPanel"),s=X.useRef(),a=X.useRef(),u=X.useCallback(()=>{n.debug("Hiding Preferences Panel");const P=Xx(e.current.state);P.openedPanelValue&&e.current.publishEvent("preferencePanelClose",{openedPanelValue:P.openedPanelValue}),e.current.setState(D=>Ge({},D,{preferencePanel:{open:!1}})),e.current.forceUpdate()},[e,n]),f=X.useCallback(()=>{a.current=setTimeout(()=>clearTimeout(s.current),0)},[]),_=X.useCallback(()=>{s.current=setTimeout(u,100)},[u]),r=X.useCallback((P,D,N)=>{n.debug("Opening Preferences Panel"),f(),e.current.setState(j=>Ge({},j,{preferencePanel:Ge({},j.preferencePanel,{open:!0,openedPanelValue:P,panelId:D,labelId:N})})),e.current.publishEvent("preferencePanelOpen",{openedPanelValue:P}),e.current.forceUpdate()},[n,f,e]);Ei(e,{showPreferences:r,hidePreferences:_},"public");const C=X.useCallback((P,D)=>{var W;const N=Xx(e.current.state);return!D.exportOnlyDirtyModels||((W=t.initialState)==null?void 0:W.preferencePanel)!=null||N.open?Ge({},P,{preferencePanel:N}):P},[e,(I=t.initialState)==null?void 0:I.preferencePanel]),k=X.useCallback((P,D)=>{const N=D.stateToRestore.preferencePanel;return N!=null&&e.current.setState(j=>Ge({},j,{preferencePanel:N})),P},[e]);ms(e,"exportState",C),ms(e,"restoreState",k),X.useEffect(()=>()=>{clearTimeout(s.current),clearTimeout(a.current)},[])},BP=e=>{switch(e.type){case"boolean":return!1;case"date":case"dateTime":case"number":return;case"singleSelect":return null;case"string":default:return""}},Aye=["id","field"],Lye=["id","field"],Rye=(e,t)=>{const[n,s]=X.useState({}),a=X.useRef(n),u=X.useRef({}),{processRowUpdate:f,onProcessRowUpdateError:_,cellModesModel:r,onCellModesModelChange:C}=t,k=we=>(...Se)=>{t.editMode===Kd.Cell&&we(...Se)},I=X.useCallback((we,Se)=>{const Pe=e.current.getCellParams(we,Se);if(!e.current.isCellEditable(Pe))throw new Error(`MUI X: The cell with id=${we} and field=${Se} is not editable.`)},[e]),P=X.useCallback((we,Se,Pe)=>{if(e.current.getCellMode(we,Se)!==Pe)throw new Error(`MUI X: The cell with id=${we} and field=${Se} is not in ${Pe} mode.`)},[e]),D=X.useCallback((we,Se)=>{if(!we.isEditable||we.cellMode===Co.Edit)return;const Pe=Ge({},we,{reason:xh.cellDoubleClick});e.current.publishEvent("cellEditStart",Pe,Se)},[e]),N=X.useCallback((we,Se)=>{if(we.cellMode===Co.View||e.current.getCellMode(we.id,we.field)===Co.View)return;const Pe=Ge({},we,{reason:Uc.cellFocusOut});e.current.publishEvent("cellEditStop",Pe,Se)},[e]),j=X.useCallback((we,Se)=>{if(we.cellMode===Co.Edit){if(Se.which===229)return;let Pe;if(Se.key==="Escape"?Pe=Uc.escapeKeyDown:Se.key==="Enter"?Pe=Uc.enterKeyDown:Se.key==="Tab"&&(Pe=Se.shiftKey?Uc.shiftTabKeyDown:Uc.tabKeyDown,Se.preventDefault()),Pe){const Me=Ge({},we,{reason:Pe});e.current.publishEvent("cellEditStop",Me,Se)}}else if(we.isEditable){let Pe;if(!e.current.unstable_applyPipeProcessors("canStartEditing",!0,{event:Se,cellParams:we,editMode:"cell"}))return;if(_$(Se)?Pe=xh.printableKeyDown:v$(Se)?Pe=xh.pasteKeyDown:Se.key==="Enter"?Pe=xh.enterKeyDown:(Se.key==="Backspace"||Se.key==="Delete")&&(Pe=xh.deleteKeyDown),Pe){const Re=Ge({},we,{reason:Pe,key:Se.key});e.current.publishEvent("cellEditStart",Re,Se)}}},[e]),W=X.useCallback(we=>{const{id:Se,field:Pe,reason:Me}=we,Re={id:Se,field:Pe};(Me===xh.printableKeyDown||Me===xh.deleteKeyDown||Me===xh.pasteKeyDown)&&(Re.deleteValue=!0),e.current.startCellEditMode(Re)},[e]),H=X.useCallback(we=>{const{id:Se,field:Pe,reason:Me}=we;e.current.runPendingEditCellValueMutation(Se,Pe);let Re;Me===Uc.enterKeyDown?Re="below":Me===Uc.tabKeyDown?Re="right":Me===Uc.shiftTabKeyDown&&(Re="left");const Oe=Me==="escapeKeyDown";e.current.stopCellEditMode({id:Se,field:Pe,ignoreModifications:Oe,cellToFocusAfter:Re})},[e]),q=we=>async(...Se)=>{var Pe;if(we){const{id:Me,field:Re}=Se[0];((Pe=e.current.state.editRows[Me][Re])==null?void 0:Pe.error)||we(...Se)}};Lr(e,"cellDoubleClick",k(D)),Lr(e,"cellFocusOut",k(N)),Lr(e,"cellKeyDown",k(j)),Lr(e,"cellEditStart",k(W)),Lr(e,"cellEditStop",k(H)),Vo(e,"cellEditStart",t.onCellEditStart),Vo(e,"cellEditStop",q(t.onCellEditStop));const Z=X.useCallback((we,Se)=>{const Pe=Ca(e.current.state);return Pe[we]&&Pe[we][Se]?Co.Edit:Co.View},[e]),re=Ui(we=>{const Se=we!==t.cellModesModel;C&&Se&&C(we,{api:e.current}),!(t.cellModesModel&&Se)&&(s(we),a.current=we,e.current.publishEvent("cellModesModelChange",we))}),le=X.useCallback((we,Se,Pe)=>{const Me=Ge({},a.current);if(Pe!==null)Me[we]=Ge({},Me[we],{[Se]:Ge({},Pe)});else{const Re=Me[we],Oe=Zr(Re,[Se].map(Zx));Me[we]=Oe,Object.keys(Me[we]).length===0&&delete Me[we]}re(Me)},[re]),_e=X.useCallback((we,Se,Pe)=>{e.current.setState(Me=>{const Re=Ge({},Me.editRows);return Pe!==null?Re[we]=Ge({},Re[we],{[Se]:Ge({},Pe)}):(delete Re[we][Se],Object.keys(Re[we]).length===0&&delete Re[we]),Ge({},Me,{editRows:Re})}),e.current.forceUpdate()},[e]),ye=X.useCallback(we=>{const{id:Se,field:Pe}=we,Me=Zr(we,Aye);I(Se,Pe),P(Se,Pe,Co.View),le(Se,Pe,Ge({mode:Co.Edit},Me))},[I,P,le]),de=Ui(async we=>{const{id:Se,field:Pe,deleteValue:Me,initialValue:Re}=we,Oe=e.current.getCellValue(Se,Pe);let $e=Oe;Me?$e=BP(e.current.getColumn(Pe)):Re&&($e=Re);const Ke=e.current.getColumn(Pe),Ct=!!Ke.preProcessEditCellProps&&Me;let Ue={value:$e,error:!1,isProcessingProps:Ct};if(_e(Se,Pe,Ue),e.current.setCellFocus(Se,Pe),Ct&&(Ue=await Promise.resolve(Ke.preProcessEditCellProps({id:Se,row:e.current.getRow(Se),props:Ue,hasChanged:$e!==Oe})),e.current.getCellMode(Se,Pe)===Co.Edit)){const ft=Ca(e.current.state);_e(Se,Pe,Ge({},Ue,{value:ft[Se][Pe].value,isProcessingProps:!1}))}}),ce=X.useCallback(we=>{const{id:Se,field:Pe}=we,Me=Zr(we,Lye);P(Se,Pe,Co.Edit),le(Se,Pe,Ge({mode:Co.View},Me))},[P,le]),oe=Ui(async we=>{const{id:Se,field:Pe,ignoreModifications:Me,cellToFocusAfter:Re="none"}=we;P(Se,Pe,Co.Edit),e.current.runPendingEditCellValueMutation(Se,Pe);const Oe=()=>{_e(Se,Pe,null),le(Se,Pe,null),Re!=="none"&&e.current.moveFocusToRelativeCell(Se,Pe,Re)};if(Me){Oe();return}const $e=Ca(e.current.state),{error:Ke,isProcessingProps:Ct}=$e[Se][Pe];if(Ke||Ct){u.current[Se][Pe].mode=Co.Edit,le(Se,Pe,{mode:Co.Edit});return}const Ue=e.current.getRowWithUpdatedValuesFromCellEditing(Se,Pe);if(f){const ft=Bt=>{u.current[Se][Pe].mode=Co.Edit,le(Se,Pe,{mode:Co.Edit}),_&&_(Bt)};try{const Bt=e.current.getRow(Se);Promise.resolve(f(Ue,Bt,{rowId:Se})).then(hn=>{e.current.updateRows([hn]),Oe()}).catch(ft)}catch(Bt){ft(Bt)}}else e.current.updateRows([Ue]),Oe()}),xe=X.useCallback(async we=>{var Bt,hn;const{id:Se,field:Pe,value:Me,debounceMs:Re,unstable_skipValueParser:Oe}=we;I(Se,Pe),P(Se,Pe,Co.Edit);const $e=e.current.getColumn(Pe),Ke=e.current.getRow(Se);let Ct=Me;$e.valueParser&&!Oe&&(Ct=$e.valueParser(Me,Ke,$e,e));let Ue=Ca(e.current.state),ft=Ge({},Ue[Se][Pe],{value:Ct,changeReason:Re?"debouncedSetEditCellValue":"setEditCellValue"});if($e.preProcessEditCellProps){const ot=Me!==Ue[Se][Pe].value;ft=Ge({},ft,{isProcessingProps:!0}),_e(Se,Pe,ft),ft=await Promise.resolve($e.preProcessEditCellProps({id:Se,row:Ke,props:ft,hasChanged:ot}))}return e.current.getCellMode(Se,Pe)===Co.View?!1:(Ue=Ca(e.current.state),ft=Ge({},ft,{isProcessingProps:!1}),ft.value=$e.preProcessEditCellProps?Ue[Se][Pe].value:Ct,_e(Se,Pe,ft),Ue=Ca(e.current.state),!((hn=(Bt=Ue[Se])==null?void 0:Bt[Pe])!=null&&hn.error))},[e,I,P,_e]),he=X.useCallback((we,Se)=>{const Pe=e.current.getColumn(Se),Me=Ca(e.current.state),Re=e.current.getRow(we);if(!Me[we]||!Me[we][Se])return e.current.getRow(we);const{value:Oe}=Me[we][Se];return Pe.valueSetter?Pe.valueSetter(Oe,Re,Pe,e):Ge({},Re,{[Se]:Oe})},[e]),Ee={getCellMode:Z,startCellEditMode:ye,stopCellEditMode:ce},se={setCellEditingEditCellValue:xe,getRowWithUpdatedValuesFromCellEditing:he};Ei(e,Ee,"public"),Ei(e,se,"private"),X.useEffect(()=>{r&&re(r)},[r,re]),Io(()=>{const we=bC(e),Se=u.current;u.current=EV(n),Object.entries(n).forEach(([Pe,Me])=>{Object.entries(Me).forEach(([Re,Oe])=>{var Ct,Ue;const $e=((Ue=(Ct=Se[Pe])==null?void 0:Ct[Re])==null?void 0:Ue.mode)||Co.View,Ke=we[Pe]??Pe;Oe.mode===Co.Edit&&$e===Co.View?de(Ge({id:Ke,field:Re},Oe)):Oe.mode===Co.View&&$e===Co.Edit&&oe(Ge({id:Ke,field:Re},Oe))})})},[e,n,de,oe])},Oye=["id"],Dye=["id"],zye=(e,t)=>{const[n,s]=X.useState({}),a=X.useRef(n),u=X.useRef({}),f=X.useRef(),_=X.useRef(null),{processRowUpdate:r,onProcessRowUpdateError:C,rowModesModel:k,onRowModesModelChange:I}=t,P=Re=>(...Oe)=>{t.editMode===Kd.Row&&Re(...Oe)},D=X.useCallback((Re,Oe)=>{const $e=e.current.getCellParams(Re,Oe);if(!e.current.isCellEditable($e))throw new Error(`MUI X: The cell with id=${Re} and field=${Oe} is not editable.`)},[e]),N=X.useCallback((Re,Oe)=>{if(e.current.getRowMode(Re)!==Oe)throw new Error(`MUI X: The row with id=${Re} is not in ${Oe} mode.`)},[e]),j=X.useCallback(Re=>{const Oe=Ca(e.current.state);return Object.values(Oe[Re]).some($e=>$e.error)},[e]),W=X.useCallback((Re,Oe)=>{if(!Re.isEditable||e.current.getRowMode(Re.id)===jo.Edit)return;const $e=e.current.getRowParams(Re.id),Ke=Ge({},$e,{field:Re.field,reason:Pf.cellDoubleClick});e.current.publishEvent("rowEditStart",Ke,Oe)},[e]),H=X.useCallback(Re=>{_.current=Re},[]),q=X.useCallback((Re,Oe)=>{Re.isEditable&&e.current.getRowMode(Re.id)!==jo.View&&(_.current=null,f.current=setTimeout(()=>{var $e;if((($e=_.current)==null?void 0:$e.id)!==Re.id){if(!e.current.getRow(Re.id)||e.current.getRowMode(Re.id)===jo.View||j(Re.id))return;const Ke=e.current.getRowParams(Re.id),Ct=Ge({},Ke,{field:Re.field,reason:Md.rowFocusOut});e.current.publishEvent("rowEditStop",Ct,Oe)}}))},[e,j]);X.useEffect(()=>()=>{clearTimeout(f.current)},[]);const Z=X.useCallback((Re,Oe)=>{if(Re.cellMode===jo.Edit){if(Oe.which===229)return;let $e;if(Oe.key==="Escape")$e=Md.escapeKeyDown;else if(Oe.key==="Enter")$e=Md.enterKeyDown;else if(Oe.key==="Tab"){const Ke=T0(e).filter(Ct=>e.current.getColumn(Ct).type===VE?!0:e.current.isCellEditable(e.current.getCellParams(Re.id,Ct)));if(Oe.shiftKey?Re.field===Ke[0]&&($e=Md.shiftTabKeyDown):Re.field===Ke[Ke.length-1]&&($e=Md.tabKeyDown),Oe.preventDefault(),!$e){const Ct=Ke.findIndex(ft=>ft===Re.field),Ue=Ke[Oe.shiftKey?Ct-1:Ct+1];e.current.setCellFocus(Re.id,Ue)}}if($e){if($e!==Md.escapeKeyDown&&j(Re.id))return;const Ke=Ge({},e.current.getRowParams(Re.id),{reason:$e,field:Re.field});e.current.publishEvent("rowEditStop",Ke,Oe)}}else if(Re.isEditable){let $e;if(!e.current.unstable_applyPipeProcessors("canStartEditing",!0,{event:Oe,cellParams:Re,editMode:"row"}))return;if(_$(Oe)||v$(Oe)?$e=Pf.printableKeyDown:Oe.key==="Enter"?$e=Pf.enterKeyDown:(Oe.key==="Backspace"||Oe.key==="Delete")&&($e=Pf.deleteKeyDown),$e){const Ct=e.current.getRowParams(Re.id),Ue=Ge({},Ct,{field:Re.field,reason:$e});e.current.publishEvent("rowEditStart",Ue,Oe)}}},[e,j]),re=X.useCallback(Re=>{const{id:Oe,field:$e,reason:Ke}=Re,Ct={id:Oe,fieldToFocus:$e};(Ke===Pf.printableKeyDown||Ke===Pf.deleteKeyDown)&&(Ct.deleteValue=!!$e),e.current.startRowEditMode(Ct)},[e]),le=X.useCallback(Re=>{const{id:Oe,reason:$e,field:Ke}=Re;e.current.runPendingEditCellValueMutation(Oe);let Ct;$e===Md.enterKeyDown?Ct="below":$e===Md.tabKeyDown?Ct="right":$e===Md.shiftTabKeyDown&&(Ct="left");const Ue=$e==="escapeKeyDown";e.current.stopRowEditMode({id:Oe,ignoreModifications:Ue,field:Ke,cellToFocusAfter:Ct})},[e]);Lr(e,"cellDoubleClick",P(W)),Lr(e,"cellFocusIn",P(H)),Lr(e,"cellFocusOut",P(q)),Lr(e,"cellKeyDown",P(Z)),Lr(e,"rowEditStart",P(re)),Lr(e,"rowEditStop",P(le)),Vo(e,"rowEditStart",t.onRowEditStart),Vo(e,"rowEditStop",t.onRowEditStop);const _e=X.useCallback(Re=>{if(t.editMode===Kd.Cell)return jo.View;const Oe=Ca(e.current.state);return Oe[Re]&&Object.keys(Oe[Re]).length>0?jo.Edit:jo.View},[e,t.editMode]),ye=Ui(Re=>{const Oe=Re!==t.rowModesModel;I&&Oe&&I(Re,{api:e.current}),!(t.rowModesModel&&Oe)&&(s(Re),a.current=Re,e.current.publishEvent("rowModesModelChange",Re))}),de=X.useCallback((Re,Oe)=>{const $e=Ge({},a.current);Oe!==null?$e[Re]=Ge({},Oe):delete $e[Re],ye($e)},[ye]),ce=X.useCallback((Re,Oe)=>{e.current.setState($e=>{const Ke=Ge({},$e.editRows);return Oe!==null?Ke[Re]=Oe:delete Ke[Re],Ge({},$e,{editRows:Ke})}),e.current.forceUpdate()},[e]),oe=X.useCallback((Re,Oe,$e)=>{e.current.setState(Ke=>{const Ct=Ge({},Ke.editRows);return $e!==null?Ct[Re]=Ge({},Ct[Re],{[Oe]:Ge({},$e)}):(delete Ct[Re][Oe],Object.keys(Ct[Re]).length===0&&delete Ct[Re]),Ge({},Ke,{editRows:Ct})}),e.current.forceUpdate()},[e]),xe=X.useCallback(Re=>{const{id:Oe}=Re,$e=Zr(Re,Oye);N(Oe,jo.View),de(Oe,Ge({mode:jo.Edit},$e))},[N,de]),he=Ui(Re=>{const{id:Oe,fieldToFocus:$e,deleteValue:Ke,initialValue:Ct}=Re,Ue=Ph(e),ft=Ue.reduce((Bt,hn)=>{if(!e.current.getCellParams(Oe,hn).isEditable)return Bt;const en=e.current.getColumn(hn);let wt=e.current.getCellValue(Oe,hn);return $e===hn&&(Ke||Ct)&&(Ke?wt=BP(en):Ct&&(wt=Ct)),Bt[hn]={value:wt,error:!1,isProcessingProps:!!en.preProcessEditCellProps&&Ke},Bt},{});ce(Oe,ft),$e&&e.current.setCellFocus(Oe,$e),Ue.filter(Bt=>!!e.current.getColumn(Bt).preProcessEditCellProps&&Ke).forEach(Bt=>{const hn=e.current.getColumn(Bt),ot=e.current.getCellValue(Oe,Bt),en=Ke?BP(hn):Ct??ot;Promise.resolve(hn.preProcessEditCellProps({id:Oe,row:e.current.getRow(Oe),props:ft[Bt],hasChanged:en!==ot})).then(wt=>{if(e.current.getRowMode(Oe)===jo.Edit){const Ne=Ca(e.current.state);oe(Oe,Bt,Ge({},wt,{value:Ne[Oe][Bt].value,isProcessingProps:!1}))}})})}),Ee=X.useCallback(Re=>{const{id:Oe}=Re,$e=Zr(Re,Dye);N(Oe,jo.Edit),de(Oe,Ge({mode:jo.View},$e))},[N,de]),se=Ui(Re=>{const{id:Oe,ignoreModifications:$e,field:Ke,cellToFocusAfter:Ct="none"}=Re;e.current.runPendingEditCellValueMutation(Oe);const Ue=()=>{Ct!=="none"&&Ke&&e.current.moveFocusToRelativeCell(Oe,Ke,Ct),ce(Oe,null),de(Oe,null)};if($e){Ue();return}const ft=Ca(e.current.state),Bt=e.current.getRow(Oe);if(Object.values(ft[Oe]).some(en=>en.isProcessingProps)){u.current[Oe].mode=jo.Edit;return}if(j(Oe)){u.current[Oe].mode=jo.Edit,de(Oe,{mode:jo.Edit});return}const ot=e.current.getRowWithUpdatedValuesFromRowEditing(Oe);if(r){const en=wt=>{u.current[Oe].mode=jo.Edit,de(Oe,{mode:jo.Edit}),C&&C(wt)};try{Promise.resolve(r(ot,Bt,{rowId:Oe})).then(wt=>{e.current.updateRows([wt]),Ue()}).catch(en)}catch(wt){en(wt)}}else e.current.updateRows([ot]),Ue()}),we=X.useCallback(Re=>{const{id:Oe,field:$e,value:Ke,debounceMs:Ct,unstable_skipValueParser:Ue}=Re;D(Oe,$e);const ft=e.current.getColumn($e),Bt=e.current.getRow(Oe);let hn=Ke;ft.valueParser&&!Ue&&(hn=ft.valueParser(Ke,Bt,ft,e));let ot=Ca(e.current.state),en=Ge({},ot[Oe][$e],{value:hn,changeReason:Ct?"debouncedSetEditCellValue":"setEditCellValue"});return ft.preProcessEditCellProps||oe(Oe,$e,en),new Promise(wt=>{const Ne=[];if(ft.preProcessEditCellProps){const We=en.value!==ot[Oe][$e].value;en=Ge({},en,{isProcessingProps:!0}),oe(Oe,$e,en);const Sn=ot[Oe],Ae=Zr(Sn,[$e].map(Zx)),st=Promise.resolve(ft.preProcessEditCellProps({id:Oe,row:Bt,props:en,hasChanged:We,otherFieldsProps:Ae})).then(gt=>{if(e.current.getRowMode(Oe)===jo.View){wt(!1);return}ot=Ca(e.current.state),gt=Ge({},gt,{isProcessingProps:!1}),gt.value=ft.preProcessEditCellProps?ot[Oe][$e].value:hn,oe(Oe,$e,gt)});Ne.push(st)}Object.entries(ot[Oe]).forEach(([We,Sn])=>{if(We===$e)return;const Ae=e.current.getColumn(We);if(!Ae.preProcessEditCellProps)return;Sn=Ge({},Sn,{isProcessingProps:!0}),oe(Oe,We,Sn),ot=Ca(e.current.state);const st=ot[Oe],gt=Zr(st,[We].map(Zx)),ut=Promise.resolve(Ae.preProcessEditCellProps({id:Oe,row:Bt,props:Sn,hasChanged:!1,otherFieldsProps:gt})).then(tt=>{if(e.current.getRowMode(Oe)===jo.View){wt(!1);return}tt=Ge({},tt,{isProcessingProps:!1}),oe(Oe,We,tt)});Ne.push(ut)}),Promise.all(Ne).then(()=>{e.current.getRowMode(Oe)===jo.Edit?(ot=Ca(e.current.state),wt(!ot[Oe][$e].error)):wt(!1)})})},[e,D,oe]),Se=X.useCallback(Re=>{const Oe=Ca(e.current.state),$e=e.current.getRow(Re);if(!Oe[Re])return e.current.getRow(Re);let Ke=Ge({},$e);return Object.entries(Oe[Re]).forEach(([Ct,Ue])=>{const ft=e.current.getColumn(Ct);ft.valueSetter?Ke=ft.valueSetter(Ue.value,Ke,ft,e):Ke[Ct]=Ue.value}),Ke},[e]),Pe={getRowMode:_e,startRowEditMode:xe,stopRowEditMode:Ee},Me={setRowEditingEditCellValue:we,getRowWithUpdatedValuesFromRowEditing:Se};Ei(e,Pe,"public"),Ei(e,Me,"private"),X.useEffect(()=>{k&&ye(k)},[k,ye]),Io(()=>{const Re=bC(e),Oe=u.current;u.current=EV(n);const $e=new Set([...Object.keys(n),...Object.keys(Oe)]);Array.from($e).forEach(Ke=>{var Bt;const Ct=n[Ke]??{mode:jo.View},Ue=((Bt=Oe[Ke])==null?void 0:Bt.mode)||jo.View,ft=Re[Ke]??Ke;Ct.mode===jo.Edit&&Ue===jo.View?he(Ge({id:ft},Ct)):Ct.mode===jo.View&&Ue===jo.Edit&&se(Ge({id:ft},Ct))})},[e,n,he,se])},Fye=e=>Ge({},e,{editRows:{}}),Nye=(e,t)=>{Rye(e,t),zye(e,t);const n=X.useRef({}),{isCellEditable:s}=t,a=X.useCallback(P=>d0(P.rowNode)||!P.colDef.editable||!P.colDef.renderEditCell?!1:s?s(P):!0,[s]),u=(P,D,N,j)=>{if(!N){j();return}if(n.current[P]||(n.current[P]={}),n.current[P][D]){const[q]=n.current[P][D];clearTimeout(q)}const W=()=>{const[q]=n.current[P][D];clearTimeout(q),j(),delete n.current[P][D]},H=setTimeout(()=>{j(),delete n.current[P][D]},N);n.current[P][D]=[H,W]};X.useEffect(()=>{const P=n.current;return()=>{Object.entries(P).forEach(([D,N])=>{Object.keys(N).forEach(j=>{const[W]=P[D][j];clearTimeout(W),delete P[D][j]})})}},[]);const f=X.useCallback((P,D)=>{if(n.current[P]){if(!D)Object.keys(n.current[P]).forEach(N=>{const[,j]=n.current[P][N];j()});else if(n.current[P][D]){const[,N]=n.current[P][D];N()}}},[]),_=X.useCallback(P=>{const{id:D,field:N,debounceMs:j}=P;return new Promise(W=>{u(D,N,j,async()=>{const H=t.editMode===Kd.Row?e.current.setRowEditingEditCellValue:e.current.setCellEditingEditCellValue;if(e.current.getCellMode(D,N)===Co.Edit){const q=await H(P);W(q)}})})},[e,t.editMode]),r=X.useCallback((P,D)=>t.editMode===Kd.Cell?e.current.getRowWithUpdatedValuesFromCellEditing(P,D):e.current.getRowWithUpdatedValuesFromRowEditing(P),[e,t.editMode]),C=X.useCallback((P,D)=>{var j;return((j=Ca(e.current.state)[P])==null?void 0:j[D])??null},[e]),k={isCellEditable:a,setEditCellValue:_,getRowWithUpdatedValues:r,unstable_getEditCellMeta:C},I={runPendingEditCellValueMutation:f};Ei(e,k,"public"),Ei(e,I,"private")},Bye=(e,t,n)=>{const s=!!t.unstable_dataSource;return n.current.caches.rows=yS({rows:s?[]:t.rows,getRowId:t.getRowId,loading:t.loading,rowCount:t.rowCount}),Ge({},e,{rows:RV({apiRef:n,rowCountProp:t.rowCount,loadingProp:s?!0:t.loading,previousTree:null,previousTreeDepths:null})})},jye=(e,t)=>{const n=_a(e,"useGridRows"),s=Sp(e,t),a=X.useRef(Date.now()),u=X.useRef(t.rowCount),f=Eu(),_=X.useCallback(Me=>{const Re=Uf(e)[Me];if(Re)return Re;const Oe=e.current.getRowNode(Me);return Oe&&d0(Oe)?{[Ny]:Me}:null},[e]),r=t.getRowId,C=X.useCallback(Me=>Ny in Me?Me[Ny]:r?r(Me):Me.id,[r]),k=X.useMemo(()=>s.rows.reduce((Me,{id:Re},Oe)=>(Me[Re]=Oe,Me),{}),[s.rows]),I=X.useCallback(({cache:Me,throttle:Re})=>{const Oe=()=>{a.current=Date.now(),e.current.setState(Ke=>Ge({},Ke,{rows:RV({apiRef:e,rowCountProp:t.rowCount,loadingProp:t.loading,previousTree:hl(e),previousTreeDepths:U4(e),previousGroupsToFetch:Rce(e)})})),e.current.publishEvent("rowsSet"),e.current.forceUpdate()};if(f.clear(),e.current.caches.rows=Me,!Re){Oe();return}const $e=t.throttleRowsMs-(Date.now()-a.current);if($e>0){f.start($e,Oe);return}Oe()},[t.throttleRowsMs,t.rowCount,t.loading,e,f]),P=X.useCallback(Me=>{n.debug(`Updating all rows, new length ${Me.length}`);const Re=yS({rows:Me,getRowId:t.getRowId,loading:t.loading,rowCount:t.rowCount}),Oe=e.current.caches.rows;Re.rowsBeforePartialUpdates=Oe.rowsBeforePartialUpdates,I({cache:Re,throttle:!0})},[n,t.getRowId,t.loading,t.rowCount,I,e]),D=X.useCallback(Me=>{if(t.signature===dc.DataGrid&&Me.length>1)throw new Error(["MUI X: You cannot update several rows at once in `apiRef.current.updateRows` on the DataGrid.","You need to upgrade to DataGridPro or DataGridPremium component to unlock this feature."].join(`
`));const Re=H4(e,Me,t.getRowId),Oe=G4({updates:Re,getRowId:t.getRowId,previousCache:e.current.caches.rows});I({cache:Oe,throttle:!0})},[t.signature,t.getRowId,I,e]),N=X.useCallback((Me,Re)=>{const Oe=H4(e,Me,t.getRowId),$e=G4({updates:Oe,getRowId:t.getRowId,previousCache:e.current.caches.rows,groupKeys:Re??[]});I({cache:$e,throttle:!1})},[t.getRowId,I,e]),j=X.useCallback(Me=>{Me!==t.loading&&(n.debug(`Setting loading to ${Me}`),e.current.setState(Re=>Ge({},Re,{rows:Ge({},Re.rows,{loading:Me})})),e.current.caches.rows.loadingPropBeforePartialUpdates=Me)},[t.loading,e,n]),W=X.useCallback(()=>{const Me=Ww(e),Re=Uf(e);return new Map(Me.map(Oe=>[Oe,Re[Oe]??{}]))},[e]),H=X.useCallback(()=>$E(e),[e]),q=X.useCallback(()=>Ww(e),[e]),Z=X.useCallback(Me=>k[Me],[k]),re=X.useCallback((Me,Re)=>{const Oe=e.current.getRowNode(Me);if(!Oe)throw new Error(`MUI X: No row with id #${Me} found.`);if(Oe.type!=="group")throw new Error("MUI X: Only group nodes can be expanded or collapsed.");const $e=Ge({},Oe,{childrenExpanded:Re});e.current.setState(Ke=>Ge({},Ke,{rows:Ge({},Ke.rows,{tree:Ge({},Ke.rows.tree,{[Me]:$e})})})),e.current.forceUpdate(),e.current.publishEvent("rowExpansionChange",$e)},[e]),le=X.useCallback(Me=>hl(e)[Me]??null,[e]),_e=X.useCallback(({skipAutoGeneratedRows:Me=!0,groupId:Re,applySorting:Oe,applyFiltering:$e})=>{const Ke=hl(e);let Ct;if(Oe){const Ue=Ke[Re];if(!Ue)return[];const ft=C1(e);Ct=[];const Bt=ft.findIndex(hn=>hn===Re)+1;for(let hn=Bt;hn<ft.length&&Ke[ft[hn]].depth>Ue.depth;hn+=1){const ot=ft[hn];(!Me||!d0(Ke[ot]))&&Ct.push(ot)}}else Ct=FA(Ke,Re,Me);if($e){const Ue=k0(e);Ct=Ct.filter(ft=>Ue[ft]!==!1)}return Ct},[e]),ye=X.useCallback((Me,Re)=>{const Oe=e.current.getRowNode(Me);if(!Oe)throw new Error(`MUI X: No row with id #${Me} found.`);if(Oe.parent!==Va)throw new Error("MUI X: The row reordering do not support reordering of grouped rows yet.");if(Oe.type!=="leaf")throw new Error("MUI X: The row reordering do not support reordering of footer or grouping rows.");e.current.setState($e=>{const Ke=hl($e,e.current.instanceId)[Va],Ct=Ke.children,Ue=Ct.findIndex(Bt=>Bt===Me);if(Ue===-1||Ue===Re)return $e;n.debug(`Moving row ${Me} to index ${Re}`);const ft=[...Ct];return ft.splice(Re,0,ft.splice(Ue,1)[0]),Ge({},$e,{rows:Ge({},$e.rows,{tree:Ge({},$e.rows.tree,{[Va]:Ge({},Ke,{children:ft})})})})}),e.current.publishEvent("rowsSet")},[e,n]),de=X.useCallback((Me,Re)=>{if(t.signature===dc.DataGrid&&Re.length>1)throw new Error(["MUI X: You cannot replace rows using `apiRef.current.unstable_replaceRows` on the DataGrid.","You need to upgrade to DataGridPro or DataGridPremium component to unlock this feature."].join(`
`));if(Re.length===0)return;if(I0(e)>1)throw new Error("`apiRef.current.unstable_replaceRows` is not compatible with tree data and row grouping");const $e=Ge({},hl(e)),Ke=Ge({},Uf(e)),Ct=Ge({},bC(e)),Ue=$e[Va],ft=[...Ue.children],Bt=new Set;for(let ot=0;ot<Re.length;ot+=1){const en=Re[ot],wt=UE(en,t.getRowId,"A row was provided without id when calling replaceRows()."),[Ne]=ft.splice(Me+ot,1,wt);Bt.has(Ne)||(delete Ke[Ne],delete Ct[Ne],delete $e[Ne]);const We={id:wt,depth:0,parent:Va,type:"leaf",groupingKey:null};Ke[wt]=en,Ct[wt]=wt,$e[wt]=We,Bt.add(wt)}$e[Va]=Ge({},Ue,{children:ft});const hn=ft.filter(ot=>{var en;return((en=$e[ot])==null?void 0:en.type)==="leaf"});e.current.caches.rows.dataRowIdToModelLookup=Ke,e.current.caches.rows.dataRowIdToIdLookup=Ct,e.current.setState(ot=>Ge({},ot,{rows:Ge({},ot.rows,{dataRowIdToModelLookup:Ke,dataRowIdToIdLookup:Ct,dataRowIds:hn,tree:$e})})),e.current.publishEvent("rowsSet")},[e,t.signature,t.getRowId]),ce={getRow:_,setLoading:j,getRowId:C,getRowModels:W,getRowsCount:H,getAllRowIds:q,setRows:P,updateRows:D,getRowNode:le,getRowIndexRelativeToVisibleRows:Z,unstable_replaceRows:de},oe={setRowIndex:ye,setRowChildrenExpansion:re,getRowGroupChildren:_e},xe={updateServerRows:N},he=X.useCallback(()=>{n.info("Row grouping pre-processing have changed, regenerating the row tree");let Me;e.current.caches.rows.rowsBeforePartialUpdates===t.rows?Me=Ge({},e.current.caches.rows,{updates:{type:"full",rows:Ww(e)}}):Me=yS({rows:t.rows,getRowId:t.getRowId,loading:t.loading,rowCount:t.rowCount}),I({cache:Me,throttle:!1})},[n,e,t.rows,t.getRowId,t.loading,t.rowCount,I]),Ee=id(()=>t.unstable_dataSource),se=X.useCallback(Me=>{if(t.unstable_dataSource&&t.unstable_dataSource!==Ee.current){Ee.current=t.unstable_dataSource;return}Me==="rowTreeCreation"&&he()},[he,Ee,t.unstable_dataSource]),we=X.useCallback(()=>{e.current.getActiveStrategy("rowTree")!==Oce(e)&&he()},[e,he]);Lr(e,"activeStrategyProcessorChange",se),Lr(e,"strategyAvailabilityChange",we);const Se=X.useCallback(()=>{e.current.setState(Me=>{const Re=e.current.unstable_applyPipeProcessors("hydrateRows",{tree:hl(Me,e.current.instanceId),treeDepths:U4(Me,e.current.instanceId),dataRowIds:Ww(Me,e.current.instanceId),dataRowIdToModelLookup:Uf(Me,e.current.instanceId),dataRowIdToIdLookup:bC(Me,e.current.instanceId)});return Ge({},Me,{rows:Ge({},Me.rows,Re,{totalTopLevelRowCount:LV({tree:Re.tree,rowCountProp:t.rowCount})})})}),e.current.publishEvent("rowsSet"),e.current.forceUpdate()},[e,t.rowCount]);QA(e,"hydrateRows",Se),Ei(e,ce,"public"),Ei(e,oe,t.signature===dc.DataGrid?"private":"public"),Ei(e,xe,"private");const Pe=X.useRef(!0);X.useEffect(()=>{var Ke;if(Pe.current){Pe.current=!1;return}let Me=!1;t.rowCount!==u.current&&(Me=!0,u.current=t.rowCount);const Re=e.current.caches.rows.rowsBeforePartialUpdates===t.rows,Oe=e.current.caches.rows.loadingPropBeforePartialUpdates===t.loading,$e=e.current.caches.rows.rowCountPropBeforePartialUpdates===t.rowCount;Re&&(Oe||(e.current.setState(Ct=>Ge({},Ct,{rows:Ge({},Ct.rows,{loading:t.loading})})),e.current.caches.rows.loadingPropBeforePartialUpdates=t.loading,e.current.forceUpdate()),$e||(e.current.setState(Ct=>Ge({},Ct,{rows:Ge({},Ct.rows,{totalRowCount:Math.max(t.rowCount||0,Ct.rows.totalRowCount),totalTopLevelRowCount:Math.max(t.rowCount||0,Ct.rows.totalTopLevelRowCount)})})),e.current.caches.rows.rowCountPropBeforePartialUpdates=t.rowCount,e.current.forceUpdate()),!Me)||(n.debug(`Updating all rows, new length ${(Ke=t.rows)==null?void 0:Ke.length}`),I({cache:yS({rows:t.rows,getRowId:t.getRowId,loading:t.loading,rowCount:t.rowCount}),throttle:!1}))},[t.rows,t.rowCount,t.getRowId,t.loading,n,I,e])},Vye=e=>{const t={[Va]:Ge({},Fce(),{children:e})};for(let n=0;n<e.length;n+=1){const s=e[n];t[s]={id:s,depth:0,parent:Va,type:"leaf",groupingKey:null}}return{groupingName:Rm,tree:t,treeDepths:{0:e.length},dataRowIds:e}},$ye=({previousTree:e,actions:t})=>{const n=Ge({},e),s={};for(let f=0;f<t.remove.length;f+=1){const _=t.remove[f];s[_]=!0,delete n[_]}for(let f=0;f<t.insert.length;f+=1){const _=t.insert[f];n[_]={id:_,depth:0,parent:Va,type:"leaf",groupingKey:null}}const a=n[Va];let u=[...a.children,...t.insert];return Object.values(s).length&&(u=u.filter(f=>!s[f])),n[Va]=Ge({},a,{children:u}),{groupingName:Rm,tree:n,treeDepths:{0:u.length},dataRowIds:u}},Uye=e=>e.updates.type==="full"?Vye(e.updates.rows):$ye({previousTree:e.previousTree,actions:e.updates.actions}),Gye=e=>{TC(e,Rm,"rowTreeCreation",Uye)},T$=(e,t)=>e==null||Array.isArray(e)?e:t&&t[0]===e?t:[e],Hye=(e,t)=>Ge({},e,{rowSelection:t.rowSelection?T$(t.rowSelectionModel)??[]:[]}),Wye=(e,t)=>{var Pe,Me,Re,Oe,$e,Ke,Ct;const n=_a(e,"useGridSelection"),s=X.useCallback(Ue=>(...ft)=>{t.rowSelection&&Ue(...ft)},[t.rowSelection]),a=t.signature!==dc.DataGrid&&(((Pe=t.rowSelectionPropagation)==null?void 0:Pe.parents)||((Me=t.rowSelectionPropagation)==null?void 0:Me.descendants)),u=X.useMemo(()=>T$(t.rowSelectionModel,Qu(e.current.state)),[e,t.rowSelectionModel]),f=X.useRef(null);e.current.registerControlState({stateId:"rowSelection",propModel:u,propOnChange:t.onRowSelectionModelChange,stateSelector:Qu,changeEvent:"rowSelectionChange"});const{checkboxSelection:_,disableRowSelectionOnClick:r,isRowSelectable:C}=t,k=VA(t),I=Sp(e,t),P=Kn(e,hl),D=Kn(e,I0)>1,N=X.useCallback(Ue=>{let ft=Ue;const Bt=f.current??Ue,hn=e.current.isRowSelected(Ue);if(hn){const ot=By(e),en=ot.findIndex(Ne=>Ne===Bt),wt=ot.findIndex(Ne=>Ne===ft);if(en===wt)return;en>wt?ft=ot[wt+1]:ft=ot[wt-1]}f.current=Ue,e.current.selectRowRange({startId:Bt,endId:ft},!hn)},[e]),j=X.useCallback(Ue=>{if(t.signature===dc.DataGrid&&!k&&Array.isArray(Ue)&&Ue.length>1)throw new Error(["MUI X: `rowSelectionModel` can only contain 1 item in DataGrid.","You need to upgrade to DataGridPro or DataGridPremium component to unlock multiple selection."].join(`
`));Qu(e.current.state)!==Ue&&(n.debug("Setting selection model"),e.current.setState(Bt=>Ge({},Bt,{rowSelection:t.rowSelection?Ue:[]})),e.current.forceUpdate())},[e,n,t.rowSelection,t.signature,k]),W=X.useCallback(Ue=>Qu(e.current.state).includes(Ue),[e]),H=X.useCallback(Ue=>{if(t.rowSelection===!1||C&&!C(e.current.getRowParams(Ue)))return!1;const ft=e.current.getRowNode(Ue);return!((ft==null?void 0:ft.type)==="footer"||(ft==null?void 0:ft.type)==="pinnedRow")},[e,t.rowSelection,C]),q=X.useCallback(()=>lde(e),[e]),Z=X.useCallback((Ue,ft=!0,Bt=!1)=>{var hn,ot,en,wt,Ne,We;if(e.current.isRowSelectable(Ue))if(f.current=Ue,Bt){n.debug(`Setting selection for row ${Ue}`);const Sn=[],Ae=st=>{Sn.push(st)};ft&&(Ae(Ue),a&&qw(e,P,Ue,((hn=t.rowSelectionPropagation)==null?void 0:hn.descendants)??!1,((ot=t.rowSelectionPropagation)==null?void 0:ot.parents)??!1,Ae)),e.current.setRowSelectionModel(Sn)}else{n.debug(`Toggling selection for row ${Ue}`);const Sn=Qu(e.current.state),Ae=new Set(Sn);Ae.delete(Ue);const st=tt=>{Ae.add(tt)},gt=tt=>{Ae.delete(tt)};ft?(st(Ue),a&&qw(e,P,Ue,((en=t.rowSelectionPropagation)==null?void 0:en.descendants)??!1,((wt=t.rowSelectionPropagation)==null?void 0:wt.parents)??!1,st)):a&&W4(e,P,Ue,((Ne=t.rowSelectionPropagation)==null?void 0:Ne.descendants)??!1,((We=t.rowSelectionPropagation)==null?void 0:We.parents)??!1,gt),(Ae.size<2||k)&&e.current.setRowSelectionModel(Array.from(Ae))}},[e,n,a,P,(Re=t.rowSelectionPropagation)==null?void 0:Re.descendants,(Oe=t.rowSelectionPropagation)==null?void 0:Oe.parents,k]),re=X.useCallback((Ue,ft=!0,Bt=!1)=>{n.debug("Setting selection for several rows");const hn=Ue.filter(wt=>e.current.isRowSelectable(wt));let ot;if(Bt){if(ft){if(ot=new Set(hn),a){const Ne=We=>{ot.add(We)};hn.forEach(We=>{var Sn,Ae;qw(e,P,We,((Sn=t.rowSelectionPropagation)==null?void 0:Sn.descendants)??!1,((Ae=t.rowSelectionPropagation)==null?void 0:Ae.parents)??!1,Ne)})}}else ot=new Set;const wt=Ah(e);if(ot.size===Object.keys(wt).length&&Array.from(ot).every(Ne=>wt[Ne]===Ne))return}else{ot=new Set(Object.values(Ah(e)));const wt=We=>{ot.add(We)},Ne=We=>{ot.delete(We)};hn.forEach(We=>{var Sn,Ae,st,gt;ft?(ot.add(We),a&&qw(e,P,We,((Sn=t.rowSelectionPropagation)==null?void 0:Sn.descendants)??!1,((Ae=t.rowSelectionPropagation)==null?void 0:Ae.parents)??!1,wt)):(Ne(We),a&&W4(e,P,We,((st=t.rowSelectionPropagation)==null?void 0:st.descendants)??!1,((gt=t.rowSelectionPropagation)==null?void 0:gt.parents)??!1,Ne))})}(ot.size<2||k)&&e.current.setRowSelectionModel(Array.from(ot))},[n,a,k,e,P,($e=t.rowSelectionPropagation)==null?void 0:$e.descendants,(Ke=t.rowSelectionPropagation)==null?void 0:Ke.parents]),le=X.useCallback(({startId:Ue,endId:ft},Bt=!0,hn=!1)=>{if(!e.current.getRow(Ue)||!e.current.getRow(ft))return;n.debug(`Expanding selection from row ${Ue} to row ${ft}`);const ot=By(e),en=ot.indexOf(Ue),wt=ot.indexOf(ft),[Ne,We]=en>wt?[wt,en]:[en,wt],Sn=ot.slice(Ne,We+1);e.current.selectRows(Sn,Bt,hn)},[e,n]),_e={selectRow:Z,setRowSelectionModel:j,getSelectedRows:q,isRowSelected:W,isRowSelectable:H},ye={selectRows:re,selectRowRange:le};Ei(e,_e,"public"),Ei(e,ye,t.signature===dc.DataGrid?"private":"public");const de=X.useRef(!0),ce=X.useCallback((Ue=!1)=>{var We;if(de.current)return;const ft=Qu(e.current.state),Bt=Uf(e),hn=k0(e),ot=Ge({},Ah(e)),en=Sn=>t.filterMode==="server"?!Bt[Sn]:hn[Sn]!==!0;let wt=!1;ft.forEach(Sn=>{var st;if(en(Sn)){if(t.keepNonExistentRowsSelected)return;delete ot[Sn],wt=!0;return}if(!((st=t.rowSelectionPropagation)!=null&&st.parents))return;const Ae=P[Sn];if(Ae.type==="group"){if(Ae.isAutoGenerated){delete ot[Sn],wt=!0;return}Ae.children.every(ut=>hn[ut]===!1)||(delete ot[Sn],wt=!0)}});const Ne=D&&((We=t.rowSelectionPropagation)==null?void 0:We.parents)&&Object.keys(ot).length>0;if(wt||Ne&&!Ue){const Sn=Object.values(ot);Ne?e.current.selectRows(Sn,!0,!0):e.current.setRowSelectionModel(Sn)}},[e,D,(Ct=t.rowSelectionPropagation)==null?void 0:Ct.parents,t.keepNonExistentRowsSelected,t.filterMode,P]),oe=X.useCallback((Ue,ft)=>{const Bt=ft.metaKey||ft.ctrlKey,hn=!_&&!Bt&&!eme(ft),ot=!k||hn,en=e.current.isRowSelected(Ue);ot?e.current.selectRow(Ue,hn?!0:!en,!0):e.current.selectRow(Ue,!en,!1)},[e,k,_]),xe=X.useCallback((Ue,ft)=>{var ot;if(r)return;const Bt=(ot=ft.target.closest(`.${xt.cell}`))==null?void 0:ot.getAttribute("data-field");if(Bt===M0.field||Bt===GE)return;if(Bt){const en=e.current.getColumn(Bt);if((en==null?void 0:en.type)===VE)return}e.current.getRowNode(Ue.id).type!=="pinnedRow"&&(ft.shiftKey&&k?N(Ue.id):oe(Ue.id,ft))},[r,k,e,N,oe]),he=X.useCallback((Ue,ft)=>{var Bt;k&&ft.shiftKey&&((Bt=window.getSelection())==null||Bt.removeAllRanges())},[k]),Ee=X.useCallback((Ue,ft)=>{k&&ft.nativeEvent.shiftKey?N(Ue.id):e.current.selectRow(Ue.id,Ue.value,!k)},[e,N,k]),se=X.useCallback(Ue=>{const ft=t.pagination&&t.checkboxSelectionVisibleOnly&&t.paginationMode==="client"?YV(e):By(e);e.current.selectRows(ft,Ue.value)},[e,t.checkboxSelectionVisibleOnly,t.pagination,t.paginationMode]),we=X.useCallback((Ue,ft)=>{if(e.current.getCellMode(Ue.id,Ue.field)!==Co.Edit&&!I1(ft)){if(EC(ft.key)&&ft.shiftKey){const Bt=_u(e);if(Bt&&Bt.id!==Ue.id){ft.preventDefault();const hn=e.current.isRowSelected(Bt.id);if(!k){e.current.selectRow(Bt.id,!hn,!0);return}const ot=e.current.getRowIndexRelativeToVisibleRows(Bt.id),en=e.current.getRowIndexRelativeToVisibleRows(Ue.id);let wt,Ne;ot>en?hn?(wt=en,Ne=ot-1):(wt=en,Ne=ot):hn?(wt=ot+1,Ne=en):(wt=ot,Ne=en);const We=I.rows.slice(wt,Ne+1).map(Sn=>Sn.id);e.current.selectRows(We,!hn);return}}if(ft.key===" "&&ft.shiftKey){ft.preventDefault(),oe(Ue.id,ft);return}String.fromCharCode(ft.keyCode)==="A"&&(ft.ctrlKey||ft.metaKey)&&(ft.preventDefault(),re(e.current.getAllRowIds(),!0))}},[e,oe,re,I.rows,k]);Lr(e,"sortedRowsSet",s(()=>ce(!0))),Lr(e,"filteredRowsSet",s(ce)),Lr(e,"rowClick",s(xe)),Lr(e,"rowSelectionCheckboxChange",s(Ee)),Lr(e,"headerSelectionCheckboxChange",se),Lr(e,"cellMouseDown",s(he)),Lr(e,"cellKeyDown",s(we)),X.useEffect(()=>{u!==void 0&&e.current.setRowSelectionModel(u)},[e,u,t.rowSelection]),X.useEffect(()=>{t.rowSelection||e.current.setRowSelectionModel([])},[e,t.rowSelection]);const Se=u!=null;X.useEffect(()=>{if(Se||!t.rowSelection)return;const Ue=Qu(e.current.state);if(H){const ft=Ue.filter(Bt=>H(Bt));ft.length<Ue.length&&e.current.setRowSelectionModel(ft)}},[e,H,Se,t.rowSelection]),X.useEffect(()=>{if(!t.rowSelection||Se)return;const Ue=Qu(e.current.state);!k&&Ue.length>1&&e.current.setRowSelectionModel([])},[e,k,_,Se,t.rowSelection]),X.useEffect(()=>{s(ce)},[ce,s]),X.useEffect(()=>{de.current&&(de.current=!1)},[])},qye=e=>{const{classes:t}=e;return X.useMemo(()=>yr({cellCheckbox:["cellCheckbox"],columnHeaderCheckbox:["columnHeaderCheckbox"]},Gi,t),[t])},Xye=(e,t)=>{const n={classes:t.classes},s=qye(n),a=X.useCallback(u=>{const f=Ge({},M0,{cellClassName:s.cellCheckbox,headerClassName:s.columnHeaderCheckbox,headerName:e.current.getLocaleText("checkboxSelectionHeaderName")}),_=t.checkboxSelection,r=u.lookup[wh]!=null;return _&&!r?(u.lookup[wh]=f,u.orderedFields=[wh,...u.orderedFields]):!_&&r?(delete u.lookup[wh],u.orderedFields=u.orderedFields.filter(C=>C!==wh)):_&&r&&(u.lookup[wh]=Ge({},f,u.lookup[wh])),u},[e,s,t.checkboxSelection]);ms(e,"hydrateColumns",a)},Yye=(e,t)=>{var s,a;const n=t.sortModel??((a=(s=t.initialState)==null?void 0:s.sorting)==null?void 0:a.sortModel)??[];return Ge({},e,{sorting:{sortModel:bV(n,t.disableMultipleColumnsSorting),sortedRows:[]}})},Zye=(e,t)=>{var le,_e;const n=_a(e,"useGridSorting");e.current.registerControlState({stateId:"sortModel",propModel:t.sortModel,propOnChange:t.onSortModelChange,stateSelector:Ju,changeEvent:"sortModelChange"});const s=X.useCallback((ye,de)=>{const ce=Ju(e),oe=ce.findIndex(he=>he.field===ye);let xe=[...ce];return oe>-1?(de==null?void 0:de.sort)==null?xe.splice(oe,1):xe.splice(oe,1,de):xe=[...ce,de],xe},[e]),a=X.useCallback((ye,de)=>{const oe=Ju(e).find(xe=>xe.field===ye.field);if(oe){const xe=de===void 0?D4(ye.sortingOrder??t.sortingOrder,oe.sort):de;return xe===void 0?void 0:Ge({},oe,{sort:xe})}return{field:ye.field,sort:de===void 0?D4(ye.sortingOrder??t.sortingOrder):de}},[e,t.sortingOrder]),u=X.useCallback((ye,de)=>de==null||de.sortable===!1||t.disableColumnSorting?ye:(de.sortingOrder||t.sortingOrder).some(oe=>!!oe)?[...ye,"columnMenuSortItem"]:ye,[t.sortingOrder,t.disableColumnSorting]),f=X.useCallback(()=>{e.current.setState(ye=>{if(t.sortingMode==="server")return n.debug("Skipping sorting rows as sortingMode = server"),Ge({},ye,{sorting:Ge({},ye.sorting,{sortedRows:FA(hl(e),Va,!1)})});const de=Ju(ye,e.current.instanceId),ce=ice(de,e),oe=e.current.applyStrategyProcessor("sorting",{sortRowList:ce});return Ge({},ye,{sorting:Ge({},ye.sorting,{sortedRows:oe})})}),e.current.publishEvent("sortedRowsSet"),e.current.forceUpdate()},[e,n,t.sortingMode]),_=X.useCallback(ye=>{Ju(e)!==ye&&(n.debug("Setting sort model"),e.current.setState(O4(ye,t.disableMultipleColumnsSorting)),e.current.forceUpdate(),e.current.applySorting())},[e,n,t.disableMultipleColumnsSorting]),r=X.useCallback((ye,de,ce)=>{const oe=e.current.getColumn(ye),xe=a(oe,de);let he;!ce||t.disableMultipleColumnsSorting?he=(xe==null?void 0:xe.sort)==null?[]:[xe]:he=s(oe.field,xe),e.current.setSortModel(he)},[e,s,a,t.disableMultipleColumnsSorting]),C=X.useCallback(()=>Ju(e),[e]),k=X.useCallback(()=>NA(e).map(de=>de.model),[e]),I=X.useCallback(()=>C1(e),[e]),P=X.useCallback(ye=>e.current.getSortedRowIds()[ye],[e]);Ei(e,{getSortModel:C,getSortedRows:k,getSortedRowIds:I,getRowIdFromRowIndex:P,setSortModel:_,sortColumn:r,applySorting:f},"public");const N=X.useCallback((ye,de)=>{var xe,he;const ce=Ju(e);return!de.exportOnlyDirtyModels||t.sortModel!=null||((he=(xe=t.initialState)==null?void 0:xe.sorting)==null?void 0:he.sortModel)!=null||ce.length>0?Ge({},ye,{sorting:{sortModel:ce}}):ye},[e,t.sortModel,(_e=(le=t.initialState)==null?void 0:le.sorting)==null?void 0:_e.sortModel]),j=X.useCallback((ye,de)=>{var oe;const ce=(oe=de.stateToRestore.sorting)==null?void 0:oe.sortModel;return ce==null?ye:(e.current.setState(O4(ce,t.disableMultipleColumnsSorting)),Ge({},ye,{callbacks:[...ye.callbacks,e.current.applySorting]}))},[e,t.disableMultipleColumnsSorting]),W=X.useCallback(ye=>{const de=hl(e),ce=de[Va],oe=ye.sortRowList?ye.sortRowList(ce.children.map(xe=>de[xe])):[...ce.children];return ce.footerId!=null&&oe.push(ce.footerId),oe},[e]);ms(e,"exportState",N),ms(e,"restoreState",j),TC(e,Rm,"sorting",W);const H=X.useCallback(({field:ye,colDef:de},ce)=>{if(!de.sortable||t.disableColumnSorting)return;const oe=ce.shiftKey||ce.metaKey||ce.ctrlKey;r(ye,void 0,oe)},[r,t.disableColumnSorting]),q=X.useCallback(({field:ye,colDef:de},ce)=>{!de.sortable||t.disableColumnSorting||ce.key==="Enter"&&!ce.ctrlKey&&!ce.metaKey&&r(ye,void 0,ce.shiftKey)},[r,t.disableColumnSorting]),Z=X.useCallback(()=>{const ye=Ju(e),de=Hh(e);if(ye.length>0){const ce=ye.filter(oe=>de[oe.field]);ce.length<ye.length&&e.current.setSortModel(ce)}},[e]),re=X.useCallback(ye=>{ye==="sorting"&&e.current.applySorting()},[e]);ms(e,"columnMenu",u),Lr(e,"columnHeaderClick",H),Lr(e,"columnHeaderKeyDown",q),Lr(e,"rowsSet",e.current.applySorting),Lr(e,"columnsChange",Z),Lr(e,"activeStrategyProcessorChange",re),E1(()=>{e.current.applySorting()}),Io(()=>{t.sortModel!==void 0&&e.current.setSortModel(t.sortModel)},[e,t.sortModel])};function TN(e){const{containerSize:t,scrollPosition:n,elementSize:s,elementOffset:a}=e,u=a+s;if(s>t)return a;if(u-t>n)return u-t;if(a<n)return a}const Kye=(e,t)=>{const n=au(),s=_a(e,"useGridScroll"),a=e.current.columnHeadersContainerRef,u=e.current.virtualScrollerRef,f=Kn(e,wp),_=X.useCallback(I=>{var H;const P=Ga(e.current.state),D=$E(e),N=t.unstable_listView?[f0(e.current.state)]:ua(e);if(!(I.rowIndex==null)&&D===0||N.length===0)return!1;s.debug(`Scrolling to cell at row ${I.rowIndex}, col: ${I.colIndex} `);let W={};if(I.colIndex!==void 0){const q=bp(e);let Z;if(typeof I.rowIndex<"u"){const re=(H=f[I.rowIndex])==null?void 0:H.id,le=e.current.unstable_getCellColSpanInfo(re,I.colIndex);le&&!le.spannedByColSpan&&(Z=le.cellProps.width)}typeof Z>"u"&&(Z=N[I.colIndex].computedWidth),W.left=TN({containerSize:P.viewportOuterSize.width,scrollPosition:Math.abs(u.current.scrollLeft),elementSize:Z,elementOffset:q[I.colIndex]})}if(I.rowIndex!==void 0){const q=P0(e.current.state),Z=Cde(e),re=Ede(e),le=t.pagination?I.rowIndex-Z*re:I.rowIndex,_e=q.positions[le+1]?q.positions[le+1]-q.positions[le]:q.currentPageTotalHeight-q.positions[le];W.top=TN({containerSize:P.viewportInnerSize.height,scrollPosition:u.current.scrollTop,elementSize:_e,elementOffset:q.positions[le]})}return W=e.current.unstable_applyPipeProcessors("scrollToIndexes",W,I),typeof W.left!==void 0||typeof W.top!==void 0?(e.current.scroll(W),!0):!1},[s,e,u,t.pagination,f,t.unstable_listView]),r=X.useCallback(I=>{if(u.current&&I.left!==void 0&&a.current){const P=n?-1:1;a.current.scrollLeft=I.left,u.current.scrollLeft=P*I.left,s.debug(`Scrolling left: ${I.left}`)}u.current&&I.top!==void 0&&(u.current.scrollTop=I.top,s.debug(`Scrolling top: ${I.top}`)),s.debug("Scrolling, updating container, and viewport")},[u,n,a,s]),C=X.useCallback(()=>u!=null&&u.current?{top:u.current.scrollTop,left:u.current.scrollLeft}:{top:0,left:0},[u]);Ei(e,{scroll:r,scrollToIndexes:_,getScrollPosition:C},"public")};function Jye(e,t){Vo(e,"columnHeaderClick",t.onColumnHeaderClick),Vo(e,"columnHeaderContextMenu",t.onColumnHeaderContextMenu),Vo(e,"columnHeaderDoubleClick",t.onColumnHeaderDoubleClick),Vo(e,"columnHeaderOver",t.onColumnHeaderOver),Vo(e,"columnHeaderOut",t.onColumnHeaderOut),Vo(e,"columnHeaderEnter",t.onColumnHeaderEnter),Vo(e,"columnHeaderLeave",t.onColumnHeaderLeave),Vo(e,"cellClick",t.onCellClick),Vo(e,"cellDoubleClick",t.onCellDoubleClick),Vo(e,"cellKeyDown",t.onCellKeyDown),Vo(e,"preferencePanelClose",t.onPreferencePanelClose),Vo(e,"preferencePanelOpen",t.onPreferencePanelOpen),Vo(e,"menuOpen",t.onMenuOpen),Vo(e,"menuClose",t.onMenuClose),Vo(e,"rowDoubleClick",t.onRowDoubleClick),Vo(e,"rowClick",t.onRowClick),Vo(e,"stateChange",t.onStateChange)}function Qye(e,t=166){let n,s;const a=()=>{n=void 0,e(...s)};function u(...f){s=f,n===void 0&&(n=setTimeout(a,t))}return u.clear=()=>{clearTimeout(n),n=void 0},u}const jP={autoHeight:!1,autoPageSize:!1,autosizeOnMount:!1,checkboxSelection:!1,checkboxSelectionVisibleOnly:!1,clipboardCopyCellDelimiter:"	",columnBufferPx:150,columnHeaderHeight:56,disableAutosize:!1,disableColumnFilter:!1,disableColumnMenu:!1,disableColumnReorder:!1,disableColumnResize:!1,disableColumnSelector:!1,disableColumnSorting:!1,disableDensitySelector:!1,disableEval:!1,disableMultipleColumnsFiltering:!1,disableMultipleColumnsSorting:!1,disableMultipleRowSelection:!1,disableRowSelectionOnClick:!1,disableVirtualization:!1,editMode:Kd.Cell,filterDebounceMs:150,filterMode:"client",hideFooter:!1,hideFooterPagination:!1,hideFooterRowCount:!1,hideFooterSelectedRowCount:!1,ignoreDiacritics:!1,ignoreValueFormatterDuringExport:!1,indeterminateCheckboxAction:"deselect",keepColumnPositionIfDraggedOutside:!1,keepNonExistentRowsSelected:!1,loading:!1,logger:console,logLevel:"error",pageSizeOptions:[25,50,100],pagination:!1,paginationMode:"client",resizeThrottleMs:60,rowBufferPx:150,rowHeight:52,rowPositionsDebounceMs:166,rows:[],rowSelection:!0,rowSpacingType:"margin",showCellVerticalBorder:!1,showColumnVerticalBorder:!1,sortingMode:"client",sortingOrder:["asc","desc",null],throttleRowsMs:0,unstable_rowSpanning:!1},sy={width:0,height:0},e0e={isReady:!1,root:sy,viewportOuterSize:sy,viewportInnerSize:sy,contentSize:sy,minimumSize:sy,hasScrollX:!1,hasScrollY:!1,scrollbarSize:0,headerHeight:0,groupHeaderHeight:0,headerFilterHeight:0,rowWidth:0,rowHeight:0,columnsTotalWidth:0,leftPinnedWidth:0,rightPinnedWidth:0,headersTotalHeight:0,topContainerHeight:0,bottomContainerHeight:0},t0e=e=>Ge({},e,{dimensions:e0e});function n0e(e,t){const n=_a(e,"useResizeContainer"),s=X.useRef(!1),a=X.useRef(sy),u=Kn(e,Ga),f=Kn(e,P0),_=Kn(e,S1),r=Kn(e,w1),C=X.useMemo(()=>DV(t.rowHeight,jP.rowHeight),[t.rowHeight]),k=Math.floor(C*r),I=Math.floor(t.columnHeaderHeight*r),P=Math.floor((t.columnGroupHeaderHeight??t.columnHeaderHeight)*r),D=Math.floor((t.headerFilterHeight??t.columnHeaderHeight)*r),N=i0e(RA(e),6),j=HA(e,t),W=_.left.reduce((Se,Pe)=>Se+Pe.computedWidth,0),H=_.right.reduce((Se,Pe)=>Se+Pe.computedWidth,0),[q,Z]=X.useState(),re=X.useMemo(()=>Qye(Z,t.resizeThrottleMs),[t.resizeThrottleMs]),le=X.useRef(),_e=()=>e.current.state.dimensions,ye=Ui(Se=>{e.current.setState(Pe=>Ge({},Pe,{dimensions:Se}))}),de=X.useCallback(()=>{const Se=e.current.mainElementRef.current;if(!Se)return;const Pe=pc(Se).getComputedStyle(Se),Me={width:parseFloat(Pe.width)||0,height:parseFloat(Pe.height)||0};(!le.current||!IN(le.current,Me))&&(e.current.publishEvent("resize",Me),le.current=Me)},[e]),ce=X.useCallback(()=>{const Se=Ga(e.current.state);if(!Se.isReady)return 0;const Pe=jy(e,{pagination:t.pagination,paginationMode:t.paginationMode});if(t.getRowHeight){const Re=KE(e),Oe=Re.lastRowIndex-Re.firstRowIndex;return Math.min(Oe-1,Pe.rows.length)}const Me=Math.floor(Se.viewportInnerSize.height/k);return Math.min(Me,Pe.rows.length)},[e,t.pagination,t.paginationMode,t.getRowHeight,k]),oe=X.useCallback(()=>{var Ne,We;const Se=e.current.rootElementRef.current,Pe=Bce(e),Me=r0e(Se,N,t.scrollbarSize),Re=j+Pe.top,Oe=Pe.bottom,Ke={width:N-W-H,height:f.currentPageTotalHeight};let Ct,Ue,ft=!1,Bt=!1;if(t.autoHeight)Bt=!1,ft=Math.round(N)>Math.round(a.current.width),Ct={width:a.current.width,height:Re+Oe+Ke.height},Ue={width:Math.max(0,Ct.width-(Bt?Me:0)),height:Math.max(0,Ct.height-(ft?Me:0))};else{Ct={width:a.current.width,height:a.current.height},Ue={width:Math.max(0,Ct.width-W-H),height:Math.max(0,Ct.height-Re-Oe)};const Sn=Ke,Ae=Ue,st=Sn.width>Ae.width,gt=Sn.height>Ae.height;(st||gt)&&(Bt=gt,ft=Sn.width+(Bt?Me:0)>Ae.width,ft&&(Bt=Sn.height+Me>Ae.height)),Bt&&(Ue.width-=Me),ft&&(Ue.height-=Me)}const hn=Math.max(Ct.width,N+(Bt?Me:0)),ot={width:N,height:Re+Ke.height+Oe},en={isReady:!0,root:a.current,viewportOuterSize:Ct,viewportInnerSize:Ue,contentSize:Ke,minimumSize:ot,hasScrollX:ft,hasScrollY:Bt,scrollbarSize:Me,headerHeight:I,groupHeaderHeight:P,headerFilterHeight:D,rowWidth:hn,rowHeight:k,columnsTotalWidth:N,leftPinnedWidth:W,rightPinnedWidth:H,headersTotalHeight:j,topContainerHeight:Re,bottomContainerHeight:Oe},wt=e.current.state.dimensions;ye(en),IN(en.viewportInnerSize,wt.viewportInnerSize)||e.current.publishEvent("viewportInnerSizeChange",en.viewportInnerSize),(We=(Ne=e.current).updateRenderContext)==null||We.call(Ne)},[e,ye,t.scrollbarSize,t.autoHeight,f.currentPageTotalHeight,k,I,P,D,N,j,W,H]),xe={resize:de,getRootDimensions:_e},he={updateDimensions:oe,getViewportPageSize:ce};Ei(e,xe,"public"),Ei(e,he,"private"),Io(()=>{q&&(oe(),e.current.publishEvent("debouncedResize",a.current))},[e,q,oe]);const Ee=e.current.rootElementRef.current;Io(()=>{if(!Ee)return;const Se=(Pe,Me)=>Ee.style.setProperty(Pe,Me);Se("--DataGrid-width",`${u.viewportOuterSize.width}px`),Se("--DataGrid-hasScrollX",`${Number(u.hasScrollX)}`),Se("--DataGrid-hasScrollY",`${Number(u.hasScrollY)}`),Se("--DataGrid-scrollbarSize",`${u.scrollbarSize}px`),Se("--DataGrid-rowWidth",`${u.rowWidth}px`),Se("--DataGrid-columnsTotalWidth",`${u.columnsTotalWidth}px`),Se("--DataGrid-leftPinnedWidth",`${u.leftPinnedWidth}px`),Se("--DataGrid-rightPinnedWidth",`${u.rightPinnedWidth}px`),Se("--DataGrid-headerHeight",`${u.headerHeight}px`),Se("--DataGrid-headersTotalHeight",`${u.headersTotalHeight}px`),Se("--DataGrid-topContainerHeight",`${u.topContainerHeight}px`),Se("--DataGrid-bottomContainerHeight",`${u.bottomContainerHeight}px`),Se("--height",`${u.rowHeight}px`)},[Ee,u]);const se=X.useRef(!0),we=X.useCallback(Se=>{a.current=Se;const Pe=/jsdom/.test(window.navigator.userAgent);if(Se.height===0&&!s.current&&!t.autoHeight&&!Pe&&(n.error(["The parent DOM element of the Data Grid has an empty height.","Please make sure that this element has an intrinsic height.","The grid displays with a height of 0px.","","More details: https://mui.com/r/x-data-grid-no-dimensions."].join(`
`)),s.current=!0),Se.width===0&&!s.current&&!Pe&&(n.error(["The parent DOM element of the Data Grid has an empty width.","Please make sure that this element has an intrinsic width.","The grid displays with a width of 0px.","","More details: https://mui.com/r/x-data-grid-no-dimensions."].join(`
`)),s.current=!0),se.current){Z(Se),se.current=!1;return}re(Se)},[t.autoHeight,re,n]);Io(oe,[oe]),Vo(e,"sortedRowsSet",oe),Vo(e,"paginationModelChange",oe),Vo(e,"columnsChange",oe),Lr(e,"resize",we),Vo(e,"debouncedResize",t.onResize)}function r0e(e,t,n){if(n!==void 0)return n;if(e===null||t===0)return 0;const a=As(e).createElement("div");a.style.width="99px",a.style.height="99px",a.style.position="absolute",a.style.overflow="scroll",a.className="scrollDiv",e.appendChild(a);const u=a.offsetWidth-a.clientWidth;return e.removeChild(a),u}function i0e(e,t){return Math.round(e*10**t)/10**t}function IN(e,t){return e.width===t.width&&e.height===t.height}const o0e=typeof globalThis.ResizeObserver<"u"?globalThis.ResizeObserver:class{observe(){}unobserve(){}disconnect(){}},s0e=(e,t,n)=>(n.current.caches.rowsMeta={heights:new Map},Ge({},e,{rowsMeta:{currentPageTotalHeight:0,positions:[]}})),a0e=(e,t)=>{const{getRowHeight:n,getRowSpacing:s,getEstimatedRowHeight:a}=t,u=e.current.caches.rowsMeta.heights,f=X.useRef(-1),_=X.useRef(!1),r=X.useRef(!1),C=Kn(e,w1),k=Kn(e,Ba),I=Kn(e,XE),P=Kn(e,Ju),D=Sp(e,t),N=Kn(e,$m),j=Kn(e,()=>Ga(e.current.state).rowHeight),W=Ee=>{let se=u.get(Ee);return se===void 0&&(se={content:j,spacingTop:0,spacingBottom:0,detail:0,autoHeight:!1,needsFirstMeasurement:!0},u.set(Ee,se)),se},H=X.useCallback(Ee=>{const se=Ga(e.current.state).rowHeight,we=e.current.getRowHeightEntry(Ee.id);if(!n)we.content=se,we.needsFirstMeasurement=!1;else{const Se=n(Ge({},Ee,{densityFactor:C}));if(Se==="auto"){if(we.needsFirstMeasurement){const Pe=a?a(Ge({},Ee,{densityFactor:C})):se;we.content=Pe??se}_.current=!0,we.autoHeight=!0}else we.content=DV(Se,se),we.needsFirstMeasurement=!1,we.autoHeight=!1}if(s){const Se=e.current.getRowIndexRelativeToVisibleRows(Ee.id),Pe=s(Ge({},Ee,{isFirstVisible:Se===0,isLastVisible:Se===D.rows.length-1,indexRelativeToCurrentPage:Se}));we.spacingTop=Pe.top??0,we.spacingBottom=Pe.bottom??0}else we.spacingTop=0,we.spacingBottom=0;return e.current.unstable_applyPipeProcessors("rowHeight",we,Ee),we},[e,D.rows.length,n,a,j,s,C]),q=X.useCallback(()=>{_.current=!1,N.top.forEach(H),N.bottom.forEach(H);const Ee=[],se=D.rows.reduce((we,Se)=>{Ee.push(we);const Pe=H(Se),Me=Pe.content+Pe.spacingTop+Pe.spacingBottom+Pe.detail;return we+Me},0);_.current||(f.current=1/0),e.current.setState(we=>Ge({},we,{rowsMeta:{currentPageTotalHeight:se,positions:Ee}})),r.current=!0},[e,N,D.rows,H]),Z=Ee=>{var se;return((se=u.get(Ee))==null?void 0:se.content)??j},re=(Ee,se)=>{const we=e.current.getRowHeightEntry(Ee),Se=we.content!==se;we.needsFirstMeasurement=!1,we.content=se,r.current&&(r.current=!Se)},le=Ee=>{var se;return((se=u.get(Ee))==null?void 0:se.autoHeight)??!1},_e=()=>f.current,ye=Ee=>{_.current&&Ee>f.current&&(f.current=Ee)},de=()=>{u.clear(),q()},ce=id(()=>new o0e(Ee=>{for(let se=0;se<Ee.length;se+=1){const we=Ee[se],Se=we.borderBoxSize&&we.borderBoxSize.length>0?we.borderBoxSize[0].blockSize:we.contentRect.height,Pe=we.target.__mui_id;e.current.unstable_storeRowHeightMeasurement(Pe,Se)}r.current||e.current.requestPipeProcessorsApplication("rowHeight")})).current,oe=(Ee,se)=>(Ee.__mui_id=se,ce.observe(Ee),()=>ce.unobserve(Ee));QA(e,"rowHeight",q),X.useEffect(()=>{q()},[k,I,P,q]);const xe={unstable_getRowHeight:Z,unstable_setLastMeasuredRowIndex:ye,unstable_storeRowHeightMeasurement:re,resetRowHeights:de},he={hydrateRowsMeta:q,observeRowHeight:oe,rowHasAutoHeight:le,getRowHeightEntry:W,getLastMeasuredRowIndex:_e};Ei(e,xe,"public"),Ei(e,he,"private")},l0e=e=>{const t=X.useCallback((a={})=>e.current.unstable_applyPipeProcessors("exportState",{},a),[e]),n=X.useCallback(a=>{e.current.unstable_applyPipeProcessors("restoreState",{callbacks:[]},{stateToRestore:a}).callbacks.forEach(f=>{f()}),e.current.forceUpdate()},[e]);Ei(e,{exportState:t,restoreState:n},"public")},u0e=e=>{const t=X.useRef({}),n=(_,r)=>{var C;return(C=t.current[_])==null?void 0:C[r]},s=()=>{t.current={}},a=X.useCallback(({rowId:_,minFirstColumn:r,maxLastColumn:C,columns:k})=>{for(let I=r;I<C;I+=1){const P=c0e({apiRef:e,lookup:t.current,columnIndex:I,rowId:_,minFirstColumnIndex:r,maxLastColumnIndex:C,columns:k});P.colSpan>1&&(I+=P.colSpan-1)}},[e]),u={unstable_getCellColSpanInfo:n},f={resetColSpan:s,calculateColSpan:a};Ei(e,u,"public"),Ei(e,f,"private"),Lr(e,"columnOrderChange",s)};function c0e(e){const{apiRef:t,lookup:n,columnIndex:s,rowId:a,minFirstColumnIndex:u,maxLastColumnIndex:f,columns:_}=e,r=_.length,C=_[s],k=t.current.getRow(a),I=t.current.getRowValue(k,C),P=typeof C.colSpan=="function"?C.colSpan(I,k,C,t):C.colSpan;if(!P||P===1)return Gk(n,a,s,{spannedByColSpan:!1,cellProps:{colSpan:1,width:C.computedWidth}}),{colSpan:1};let D=C.computedWidth;for(let N=1;N<P;N+=1){const j=s+N;if(j>=u&&j<f){const W=_[j];D+=W.computedWidth,Gk(n,a,s+N,{spannedByColSpan:!0,rightVisibleCellIndex:Math.min(s+P,r-1),leftVisibleCellIndex:s})}Gk(n,a,s,{spannedByColSpan:!1,cellProps:{colSpan:P,width:D}})}return{colSpan:P}}function Gk(e,t,n,s){e[t]||(e[t]={}),e[t][n]=s}const I$=(e,t,n)=>{if(IV(e)){if(n[e.field]!==void 0)throw new Error(["MUI X: columnGroupingModel contains duplicated field",`column field ${e.field} occurs two times in the grouping model:`,`- ${n[e.field].join(" > ")}`,`- ${t.join(" > ")}`].join(`
`));n[e.field]=t;return}const{groupId:s,children:a}=e;a.forEach(u=>{I$(u,[...t,s],n)})},VP=e=>{if(!e)return{};const t={};return e.forEach(n=>{I$(n,[],t)}),t},$P=(e,t,n)=>{const s=r=>t[r]??[],a=[],u=Math.max(...e.map(r=>s(r).length)),f=(r,C,k)=>Fy(s(r).slice(0,k+1),s(C).slice(0,k+1)),_=(r,C)=>!!(n!=null&&n.left&&n.left.includes(r)&&!n.left.includes(C)||n!=null&&n.right&&!n.right.includes(r)&&n.right.includes(C));for(let r=0;r<u;r+=1){const C=e.reduce((k,I)=>{const P=s(I)[r]??null;if(k.length===0)return[{columnFields:[I],groupId:P}];const D=k[k.length-1],N=D.columnFields[D.columnFields.length-1];return D.groupId!==P||!f(N,I,r)||_(N,I)?[...k,{columnFields:[I],groupId:P}]:[...k.slice(0,k.length-1),{columnFields:[...D.columnFields,I],groupId:P}]},[]);a.push(C)}return a},d0e=["groupId","children"],eL=e=>{let t={};return e.forEach(n=>{if(IV(n))return;const{groupId:s,children:a}=n,u=Zr(n,d0e);if(!s)throw new Error("MUI X: An element of the columnGroupingModel does not have either `field` or `groupId`.");const f=Ge({},u,{groupId:s}),_=eL(a);if(_[s]!==void 0||t[s]!==void 0)throw new Error(`MUI X: The groupId ${s} is used multiple times in the columnGroupingModel.`);t=Ge({},t,_,{[s]:f})}),Ge({},t)},h0e=(e,t,n)=>{if(!t.columnGroupingModel)return e;const s=Ph(n),a=T0(n),u=eL(t.columnGroupingModel??[]),f=VP(t.columnGroupingModel??[]),_=$P(s,f,n.current.state.pinnedColumns??{}),r=a.length===0?0:Math.max(...a.map(C=>{var k;return((k=f[C])==null?void 0:k.length)??0}));return Ge({},e,{columnGrouping:{lookup:u,unwrappedGroupingModel:f,headerStructure:_,maxDepth:r}})},f0e=(e,t)=>{const n=X.useCallback(_=>QV(e)[_]??[],[e]),s=X.useCallback(()=>e$(e),[e]);Ei(e,{getColumnGroupPath:n,getAllGroupDetails:s},"public");const u=X.useCallback(()=>{const _=VP(t.columnGroupingModel??[]);e.current.setState(r=>{var P;const C=((P=r.columns)==null?void 0:P.orderedFields)??[],k=r.pinnedColumns??{},I=$P(C,_,k);return Ge({},r,{columnGrouping:Ge({},r.columnGrouping,{headerStructure:I})})})},[e,t.columnGroupingModel]),f=X.useCallback(_=>{var j,W;const r=((W=(j=e.current).getPinnedColumns)==null?void 0:W.call(j))??{},C=Ph(e),k=T0(e),I=eL(_??[]),P=VP(_??[]),D=$P(C,P,r),N=k.length===0?0:Math.max(...k.map(H=>{var q;return((q=P[H])==null?void 0:q.length)??0}));e.current.setState(H=>Ge({},H,{columnGrouping:{lookup:I,unwrappedGroupingModel:P,headerStructure:D,maxDepth:N}}))},[e]);Lr(e,"columnIndexChange",u),Lr(e,"columnsChange",()=>{f(t.columnGroupingModel)}),Lr(e,"columnVisibilityModelChange",()=>{f(t.columnGroupingModel)}),X.useEffect(()=>{f(t.columnGroupingModel)},[f,t.columnGroupingModel])};function p0e(){let e,t;const n=new Promise((s,a)=>{e=s,t=a});return n.resolve=e,n.reject=t,n}function kN(e,t){if(t!==void 0&&e.changedTouches){for(let n=0;n<e.changedTouches.length;n+=1){const s=e.changedTouches[n];if(s.identifier===t)return{x:s.clientX,y:s.clientY}}return!1}return{x:e.clientX,y:e.clientY}}function MN(e,t,n,s){let a=e;return s==="Right"?a+=t-n.left:a+=n.right-t,a}function m0e(e,t,n){return n==="Left"?e-t.left:t.right-e}function g0e(e){return e==="Right"?"Left":"Right"}function y0e(e,t){const n=e.classList.contains(xt["columnSeparator--sideRight"])?"Right":"Left";return t?g0e(n):n}function PN(e){e.preventDefault(),e.stopImmediatePropagation()}function _0e(e){const t=X.useRef(),n=()=>WA(e),s=Kn(e,n);return X.useEffect(()=>{t.current&&s===!1&&(t.current.resolve(),t.current=void 0)}),()=>{if(!t.current){if(n()===!1)return Promise.resolve();t.current=p0e()}return t.current}}function v0e(e,t){if(e.length<4)return e;const n=e.slice();n.sort((_,r)=>_-r);const s=n[Math.floor(n.length*.25)],a=n[Math.floor(n.length*.75)-1],u=a-s,f=u<5?5:u*t;return n.filter(_=>_>s-f&&_<a+f)}function x0e(e,t,n){const s={},a=e.current.rootElementRef.current;return a.classList.add(xt.autosizing),n.forEach(u=>{const _=Ofe(e.current,u.field).map(N=>N.getBoundingClientRect().width??0),r=t.includeOutliers?_:v0e(_,t.outliersFactor);if(t.includeHeaders){const N=Rfe(e.current,u.field);if(N){const j=N.querySelector(`.${xt.columnHeaderTitle}`),W=N.querySelector(`.${xt.columnHeaderTitleContainerContent}`),H=N.querySelector(`.${xt.iconButtonContainer}`),q=N.querySelector(`.${xt.menuIcon}`),Z=j??W,re=window.getComputedStyle(N,null),le=parseInt(re.paddingLeft,10)+parseInt(re.paddingRight,10),ye=Z.scrollWidth+1+le+((H==null?void 0:H.clientWidth)??0)+((q==null?void 0:q.clientWidth)??0);r.push(ye)}}const C=u.minWidth!==-1/0&&u.minWidth!==void 0,k=u.maxWidth!==1/0&&u.maxWidth!==void 0,I=C?u.minWidth:0,P=k?u.maxWidth:1/0,D=r.length===0?0:Math.max(...r);s[u.field]=Wd(D,I,P)}),a.classList.remove(xt.autosizing),s}const b0e=e=>Ge({},e,{columnResize:{resizingColumnField:""}});function w0e(){return{colDef:void 0,initialColWidth:0,initialTotalWidth:0,previousMouseClickEvent:void 0,columnHeaderElement:void 0,headerFilterElement:void 0,groupHeaderElements:[],cellElements:[],leftPinnedCellsAfter:[],rightPinnedCellsBefore:[],fillerLeft:void 0,fillerRight:void 0,leftPinnedHeadersAfter:[],rightPinnedHeadersBefore:[]}}const S0e=(e,t)=>{const n=au(),s=_a(e,"useGridColumnResize"),a=id(w0e).current,u=X.useRef(),f=X.useRef(),_=Eu(),r=X.useRef(),C=ce=>{var Se,Pe;s.debug(`Updating width to ${ce} for col ${a.colDef.field}`);const oe=a.columnHeaderElement.offsetWidth,xe=ce-oe,he=ce-a.initialColWidth,Ee=a.initialTotalWidth+he;(Pe=(Se=e.current.rootElementRef)==null?void 0:Se.current)==null||Pe.style.setProperty("--DataGrid-rowWidth",`${Ee}px`),a.colDef.computedWidth=ce,a.colDef.width=ce,a.colDef.flex=0,a.columnHeaderElement.style.width=`${ce}px`;const se=a.headerFilterElement;se&&(se.style.width=`${ce}px`),a.groupHeaderElements.forEach(Me=>{const Re=Me;let Oe;Re.getAttribute("aria-colspan")==="1"?Oe=`${ce}px`:Oe=`${Re.offsetWidth+xe}px`,Re.style.width=Oe}),a.cellElements.forEach(Me=>{const Re=Me;let Oe;Re.getAttribute("aria-colspan")==="1"?Oe=`${ce}px`:Oe=`${Re.offsetWidth+xe}px`,Re.style.setProperty("--width",Oe)});const we=e.current.unstable_applyPipeProcessors("isColumnPinned",!1,a.colDef.field);we===Go.LEFT&&(ey(a.fillerLeft,"width",xe),a.leftPinnedCellsAfter.forEach(Me=>{ey(Me,"left",xe)}),a.leftPinnedHeadersAfter.forEach(Me=>{ey(Me,"left",xe)})),we===Go.RIGHT&&(ey(a.fillerRight,"width",xe),a.rightPinnedCellsBefore.forEach(Me=>{ey(Me,"right",xe)}),a.rightPinnedHeadersBefore.forEach(Me=>{ey(Me,"right",xe)}))},k=ce=>{if(H(),a.previousMouseClickEvent){const oe=a.previousMouseClickEvent,xe=oe.timeStamp,he=oe.clientX,Ee=oe.clientY;if(ce.timeStamp-xe<300&&ce.clientX===he&&ce.clientY===Ee){a.previousMouseClickEvent=void 0,e.current.publishEvent("columnResizeStop",null,ce);return}}if(a.colDef){e.current.setColumnWidth(a.colDef.field,a.colDef.width),s.debug(`Updating col ${a.colDef.field} with new width: ${a.colDef.width}`);const oe=Hd(e.current.state);a.groupHeaderElements.forEach(xe=>{const he=Tfe(xe),Ee=xe,we=`${he.reduce((Se,Pe)=>oe.columnVisibilityModel[Pe]!==!1?Se+oe.lookup[Pe].computedWidth:Se,0)}px`;Ee.style.width=we})}_.start(0,()=>{e.current.publishEvent("columnResizeStop",null,ce)})},I=(ce,oe,xe)=>{var we;const he=e.current.rootElementRef.current;a.initialColWidth=ce.computedWidth,a.initialTotalWidth=e.current.getRootDimensions().rowWidth,a.colDef=ce,a.columnHeaderElement=Efe(e.current.columnHeadersContainerRef.current,ce.field);const Ee=he.querySelector(`.${xt.headerFilterRow} [data-field="${Wh(ce.field)}"]`);Ee&&(a.headerFilterElement=Ee),a.groupHeaderElements=Ife((we=e.current.columnHeadersContainerRef)==null?void 0:we.current,ce.field),a.cellElements=kfe(a.columnHeaderElement,e.current),a.fillerLeft=tN(e.current,n?"filler--pinnedRight":"filler--pinnedLeft"),a.fillerRight=tN(e.current,n?"filler--pinnedLeft":"filler--pinnedRight");const se=e.current.unstable_applyPipeProcessors("isColumnPinned",!1,a.colDef.field);a.leftPinnedCellsAfter=se!==Go.LEFT?[]:Mfe(e.current,a.columnHeaderElement,n),a.rightPinnedCellsBefore=se!==Go.RIGHT?[]:Pfe(e.current,a.columnHeaderElement,n),a.leftPinnedHeadersAfter=se!==Go.LEFT?[]:Afe(e.current,a.columnHeaderElement,n),a.rightPinnedHeadersBefore=se!==Go.RIGHT?[]:Lfe(e.current,a.columnHeaderElement,n),f.current=y0e(oe,n),u.current=m0e(xe,a.columnHeaderElement.getBoundingClientRect(),f.current)},P=Ui(k),D=Ui(ce=>{if(ce.buttons===0){P(ce);return}let oe=MN(u.current,ce.clientX,a.columnHeaderElement.getBoundingClientRect(),f.current);oe=Wd(oe,a.colDef.minWidth,a.colDef.maxWidth),C(oe);const xe={element:a.columnHeaderElement,colDef:a.colDef,width:oe};e.current.publishEvent("columnResize",xe,ce)}),N=Ui(ce=>{kN(ce,r.current)&&k(ce)}),j=Ui(ce=>{const oe=kN(ce,r.current);if(!oe)return;if(ce.type==="mousemove"&&ce.buttons===0){N(ce);return}let xe=MN(u.current,oe.x,a.columnHeaderElement.getBoundingClientRect(),f.current);xe=Wd(xe,a.colDef.minWidth,a.colDef.maxWidth),C(xe);const he={element:a.columnHeaderElement,colDef:a.colDef,width:xe};e.current.publishEvent("columnResize",he,ce)}),W=Ui(ce=>{const oe=CC(ce.target,xt["columnSeparator--resizable"]);if(!oe)return;const xe=ce.changedTouches[0];xe!=null&&(r.current=xe.identifier);const he=CC(ce.target,xt.columnHeader),Ee=Cfe(he),se=e.current.getColumn(Ee);s.debug(`Start Resize on col ${se.field}`),e.current.publishEvent("columnResizeStart",{field:Ee},ce),I(se,oe,xe.clientX);const we=As(ce.currentTarget);we.addEventListener("touchmove",j),we.addEventListener("touchend",N)}),H=X.useCallback(()=>{const ce=As(e.current.rootElementRef.current);ce.body.style.removeProperty("cursor"),ce.removeEventListener("mousemove",D),ce.removeEventListener("mouseup",P),ce.removeEventListener("touchmove",j),ce.removeEventListener("touchend",N),setTimeout(()=>{ce.removeEventListener("click",PN,!0)},100),a.columnHeaderElement&&(a.columnHeaderElement.style.pointerEvents="unset")},[e,a,D,P,j,N]),q=X.useCallback(({field:ce})=>{e.current.setState(oe=>Ge({},oe,{columnResize:Ge({},oe.columnResize,{resizingColumnField:ce})})),e.current.forceUpdate()},[e]),Z=X.useCallback(()=>{e.current.setState(ce=>Ge({},ce,{columnResize:Ge({},ce.columnResize,{resizingColumnField:""})})),e.current.forceUpdate()},[e]),re=Ui(({colDef:ce},oe)=>{if(oe.button!==0||!oe.currentTarget.classList.contains(xt["columnSeparator--resizable"]))return;oe.preventDefault(),s.debug(`Start Resize on col ${ce.field}`),e.current.publishEvent("columnResizeStart",{field:ce.field},oe),I(ce,oe.currentTarget,oe.clientX);const xe=As(e.current.rootElementRef.current);xe.body.style.cursor="col-resize",a.previousMouseClickEvent=oe.nativeEvent,xe.addEventListener("mousemove",D),xe.addEventListener("mouseup",P),xe.addEventListener("click",PN,!0)}),le=Ui((ce,oe)=>{if(t.disableAutosize||oe.button!==0)return;const xe=e.current.state.columns.lookup[ce.field];xe.resizable!==!1&&e.current.autosizeColumns(Ge({},t.autosizeOptions,{columns:[xe.field]}))}),_e=_0e(e),ye=X.useRef(!1),de=X.useCallback(async ce=>{var se;if(!((se=e.current.rootElementRef)==null?void 0:se.current)||ye.current)return;ye.current=!0;const xe=Hd(e.current.state),he=Ge({},dfe,ce,{columns:(ce==null?void 0:ce.columns)??xe.orderedFields});he.columns=he.columns.filter(we=>xe.columnVisibilityModel[we]!==!1);const Ee=he.columns.map(we=>e.current.state.columns.lookup[we]);try{e.current.unstable_setColumnVirtualization(!1),await _e();const we=x0e(e,he,Ee),Se=Ee.map(Pe=>Ge({},Pe,{width:we[Pe.field],computedWidth:we[Pe.field]}));if(he.expand){const Me=xe.orderedFields.map($e=>xe.lookup[$e]).filter($e=>xe.columnVisibilityModel[$e.field]!==!1).reduce(($e,Ke)=>$e+(we[Ke.field]??Ke.computedWidth??Ke.width),0),Oe=e.current.getRootDimensions().viewportInnerSize.width-Me;if(Oe>0){const $e=Oe/(Se.length||1);Se.forEach(Ke=>{Ke.width+=$e,Ke.computedWidth+=$e})}}e.current.updateColumns(Se),Se.forEach((Pe,Me)=>{if(Pe.width!==Ee[Me].width){const Re=Pe.width;e.current.publishEvent("columnWidthChange",{element:e.current.getColumnHeaderElement(Pe.field),colDef:Pe,width:Re})}})}finally{e.current.unstable_setColumnVirtualization(!0),ye.current=!1}},[e,_e]);X.useEffect(()=>H,[H]),CE(()=>{t.autosizeOnMount&&Promise.resolve().then(()=>{e.current.autosizeColumns(t.autosizeOptions)})}),GV(e,()=>{var ce;return(ce=e.current.columnHeadersContainerRef)==null?void 0:ce.current},"touchstart",W,{passive:!0}),Ei(e,{autosizeColumns:de},"public"),Lr(e,"columnResizeStop",Z),Lr(e,"columnResizeStart",q),Lr(e,"columnSeparatorMouseDown",re),Lr(e,"columnSeparatorDoubleClick",le),Vo(e,"columnResize",t.onColumnResize),Vo(e,"columnWidthChange",t.onColumnWidthChange)};function ey(e,t,n){e&&(e.style[t]=`${parseInt(e.style[t],10)+n}px`)}function C0e(e,t){return e.firstRowIndex>=t.firstRowIndex&&e.lastRowIndex<=t.lastRowIndex?null:e.firstRowIndex>=t.firstRowIndex&&e.lastRowIndex>t.lastRowIndex?{firstRowIndex:t.lastRowIndex,lastRowIndex:e.lastRowIndex}:e.firstRowIndex<t.firstRowIndex&&e.lastRowIndex<=t.lastRowIndex?{firstRowIndex:e.firstRowIndex,lastRowIndex:t.firstRowIndex-1}:e}function E0e(e){return e.firstRowIndex!==0||e.lastRowIndex!==0}function AN(e,t){return e.firstRowIndex!==t.firstRowIndex||e.lastRowIndex!==t.lastRowIndex}const Hk=(e,t,n)=>{if(!e)return null;let s=e[t.field];const a=t.rowSpanValueGetter??t.valueGetter;return a&&(s=a(s,e,t,n)),s},IC={spannedCells:{},hiddenCells:{},hiddenCellOriginMap:{}},dx={firstRowIndex:0,lastRowIndex:0},T0e=new Set([wh,"__reorder__",GE]),k$=20,M$=(e,t,n,s,a,u,f)=>{const _=u?{}:Ge({},e.current.state.rowSpanning.spannedCells),r=u?{}:Ge({},e.current.state.rowSpanning.hiddenCells),C=u?{}:Ge({},e.current.state.rowSpanning.hiddenCellOriginMap);return u&&(f=dx),t.forEach(k=>{var I;if(!T0e.has(k.field)){for(let P=a.firstRowIndex;P<=a.lastRowIndex;P+=1){const D=n[P];if((I=r[D.id])!=null&&I[k.field])continue;const N=Hk(D.model,k,e);if(N==null)continue;let j=D.id,W=P,H=0;const q=[];if(P===a.firstRowIndex){let re=P-1;const le=n[re];for(;re>=s.firstRowIndex&&Hk(le.model,k,e)===N;){const _e=n[re+1];r[_e.id]?r[_e.id][k.field]=!0:r[_e.id]={[k.field]:!0},q.push(P),H+=1,j=le.id,W=re,re-=1}}q.forEach(re=>{C[re]?C[re][k.field]=W:C[re]={[k.field]:W}});let Z=P+1;for(;Z<=s.lastRowIndex&&n[Z]&&Hk(n[Z].model,k,e)===N;){const re=n[Z];r[re.id]?r[re.id][k.field]=!0:r[re.id]={[k.field]:!0},C[Z]?C[Z][k.field]=W:C[Z]={[k.field]:W},Z+=1,H+=1}H>0&&(_[j]?_[j][k.field]=H+1:_[j]={[k.field]:H+1})}f={firstRowIndex:Math.min(f.firstRowIndex,a.firstRowIndex),lastRowIndex:Math.max(f.lastRowIndex,a.lastRowIndex)}}}),{spannedCells:_,hiddenCells:r,hiddenCellOriginMap:C,processedRange:f}},I0e=(e,t,n)=>{var s;if(t.unstable_rowSpanning){const a=e.rows.dataRowIds||[],u=e.columns.orderedFields||[],f=e.rows.dataRowIdToModelLookup,_=e.columns.lookup,r=!!e.filter.filterModel.items.length||!!((s=e.filter.filterModel.quickFilterValues)!=null&&s.length);if(!a.length||!u.length||!f||!_||r)return Ge({},e,{rowSpanning:IC});const C={firstRowIndex:0,lastRowIndex:Math.min(k$-1,Math.max(a.length-1,0))},k=a.map(j=>({id:j,model:f[j]})),I=u.map(j=>_[j]),{spannedCells:P,hiddenCells:D,hiddenCellOriginMap:N}=M$(n,I,k,C,C,!0,dx);return Ge({},e,{rowSpanning:{spannedCells:P,hiddenCells:D,hiddenCellOriginMap:N}})}return Ge({},e,{rowSpanning:IC})},k0e=(e,t)=>{const{range:n,rows:s}=Sp(e,t),a=Kn(e,KE),u=Kn(e,ua),f=id(()=>Object.keys(e.current.state.rowSpanning.spannedCells).length>0?{firstRowIndex:0,lastRowIndex:Math.min(k$-1,Math.max(e.current.state.rows.dataRowIds.length-1,0))}:dx),_=X.useRef(dx),r=X.useCallback((P=!0)=>{if(!t.unstable_rowSpanning){e.current.state.rowSpanning!==IC&&e.current.setState(ye=>Ge({},ye,{rowSpanning:IC}));return}if(n===null||!E0e(a))return;P&&(f.current=dx);const D=C0e({firstRowIndex:a.firstRowIndex,lastRowIndex:Math.min(a.lastRowIndex-1,n.lastRowIndex)},f.current);if(D===null)return;const{spannedCells:N,hiddenCells:j,hiddenCellOriginMap:W,processedRange:H}=M$(e,u,s,n,D,P,f.current);f.current=H;const q=Object.keys(N).length,Z=Object.keys(j).length,re=Object.keys(e.current.state.rowSpanning.spannedCells).length,le=Object.keys(e.current.state.rowSpanning.hiddenCells).length;(P||q!==re||Z!==le)&&e.current.setState(ye=>Ge({},ye,{rowSpanning:{spannedCells:N,hiddenCells:j,hiddenCellOriginMap:W}}))},[e,t.unstable_rowSpanning,n,a,s,u,f]),C=X.useRef(a),k=X.useRef(!0),I=X.useRef(!1);X.useEffect(()=>{const P=k.current;if(k.current&&(k.current=!1),n&&_.current&&AN(n,_.current)&&(_.current=n,I.current=!0),!P&&C.current!==a){AN(C.current,a)&&(r(I.current),I.current=!1),C.current=a;return}r()},[r,a,n,_])},M0e=(e,t,n)=>Ge({},e,{listViewColumn:t.unstable_listColumn?Ge({},t.unstable_listColumn,{computedWidth:UP(n)}):void 0});function P0e(e,t){const n=()=>{e.current.setState(u=>u.listViewColumn?Ge({},u,{listViewColumn:Ge({},u.listViewColumn,{computedWidth:UP(e)})}):u)},s=X.useRef(null);Lr(e,"viewportInnerSizeChange",u=>{s.current!==u.width&&(s.current=u.width,n())}),Lr(e,"columnVisibilityModelChange",n),X.useEffect(()=>{const u=t.unstable_listColumn;u&&e.current.setState(f=>Ge({},f,{listViewColumn:Ge({},u,{computedWidth:UP(e)})}))},[e,t.unstable_listColumn]),X.useEffect(()=>{t.unstable_listView&&t.unstable_listColumn},[t.unstable_listView,t.unstable_listColumn])}function UP(e){return Ga(e.current.state).viewportInnerSize.width}const A0e=(e,t)=>{const n=Zge(e,t);return Xye(n,t),Gye(n),Sa(t0e,n,t),Sa(Hye,n,t),Sa(iye,n,t),Sa(Bye,n,t),Sa(Fye,n,t),Sa(_ye,n,t),Sa(Yye,n,t),Sa(Mye,n,t),Sa(pye,n,t),Sa(I0e,n,t),Sa(sye,n,t),Sa(b0e,n,t),Sa(Iye,n,t),Sa(s0e,n,t),Sa(nye,n,t),Sa(h0e,n,t),Sa(Che,n,t),Sa(M0e,n,t),Cye(n,t),Wye(n,t),oye(n,t),jye(n,t),k0e(n,t),Dfe(n,t),u0e(n),f0e(n,t),Nye(n,t),vye(n,t),Pye(n,t),yye(n,t),Zye(n,t),aye(n,t),S0e(n,t),kye(n,t),a0e(n,t),Kye(n,t),rye(n),uye(n,t),fye(n,t),tye(n,t),n0e(n,t),Jye(n,t),l0e(n),Ehe(n,t),P0e(n,t),n},L0e=e=>{const{classes:t,headerAlign:n,isDragging:s,isLastColumn:a,showLeftBorder:u,showRightBorder:f,groupId:_,pinnedPosition:r}=e;return yr({root:["columnHeader",n==="left"&&"columnHeader--alignLeft",n==="center"&&"columnHeader--alignCenter",n==="right"&&"columnHeader--alignRight",s&&"columnHeader--moving",f&&"columnHeader--withRightBorder",u&&"columnHeader--withLeftBorder","withBorderColor",_===null?"columnHeader--emptyGroup":"columnHeader--filledGroup",r==="left"&&"columnHeader--pinnedLeft",r==="right"&&"columnHeader--pinnedRight",a&&"columnHeader--last"],draggableContainer:["columnHeaderDraggableContainer"],titleContainer:["columnHeaderTitleContainer","withBorderColor"],titleContainerContent:["columnHeaderTitleContainerContent"]},Gi,t)};function R0e(e){var $e;const{groupId:t,width:n,depth:s,maxDepth:a,fields:u,height:f,colIndex:_,hasFocus:r,tabIndex:C,isLastColumn:k,pinnedPosition:I,style:P,indexInSection:D,sectionLength:N,gridHasFiller:j}=e,W=Ur(),H=X.useRef(null),q=Bi(),Z=Kn(q,e$),re=t?Z[t]:{},{headerName:le=t??"",description:_e="",headerAlign:ye=void 0}=re;let de;const ce=t&&(($e=Z[t])==null?void 0:$e.renderHeaderGroup),oe=X.useMemo(()=>({groupId:t,headerName:le,description:_e,depth:s,maxDepth:a,fields:u,colIndex:_,isLastColumn:k}),[t,le,_e,s,a,u,_,k]);t&&ce&&(de=ce(oe));const xe=QE(I,D),he=JE(I,D,N,W.showColumnVerticalBorder,j),Ee=Ge({},e,{classes:W.classes,showLeftBorder:xe,showRightBorder:he,headerAlign:ye,depth:s,isDragging:!1}),se=le??t,we=ls(),Se=t===null?`empty-group-cell-${we}`:t,Pe=L0e(Ee);X.useLayoutEffect(()=>{if(r){const Ct=H.current.querySelector('[tabindex="0"]')||H.current;Ct==null||Ct.focus()}},[q,r]);const Me=X.useCallback(Ke=>Ct=>{I1(Ct)||q.current.publishEvent(Ke,oe,Ct)},[q,oe]),Re=X.useMemo(()=>({onKeyDown:Me("columnGroupHeaderKeyDown"),onFocus:Me("columnGroupHeaderFocus"),onBlur:Me("columnGroupHeaderBlur")}),[Me]),Oe=typeof re.headerClassName=="function"?re.headerClassName(oe):re.headerClassName;return K.jsx(g$,Ge({ref:H,classes:Pe,columnMenuOpen:!1,colIndex:_,height:f,isResizing:!1,sortDirection:null,hasFocus:!1,tabIndex:C,isDraggable:!1,headerComponent:de,headerClassName:Oe,description:_e,elementId:Se,width:n,columnMenuIconButton:null,columnTitleIconButtons:null,resizable:!1,label:se,"aria-colspan":u.length,"data-fields":`|-${u.join("-|-")}-|`,style:P},Re))}const LN=Dn("div",{name:"MuiDataGrid",slot:"ColumnHeaderRow",overridesResolver:(e,t)=>t.columnHeaderRow})({display:"flex"}),O0e=e=>{const{visibleColumns:t,sortColumnLookup:n,filterColumnLookup:s,columnHeaderTabIndexState:a,columnGroupHeaderTabIndexState:u,columnHeaderFocus:f,columnGroupHeaderFocus:_,headerGroupingMaxDepth:r,columnMenuState:C,columnVisibility:k,columnGroupsHeaderStructure:I,hasOtherElementInTabSequence:P}=e,[D,N]=X.useState(""),[j,W]=X.useState(""),H=Sc(),q=au(),Z=Ur(),re=Kn(H,Ga),le=Kn(H,WA),_e=Kn(H,QV),ye=Kn(H,bp),de=Kn(H,She),ce=Kn(H,S1),oe=Kn(H,Hh),xe=o$(ye,de,ce.left.length),he=re.columnsTotalWidth<re.viewportOuterSize.width;X.useEffect(()=>{H.current.columnHeadersContainerRef.current&&(H.current.columnHeadersContainerRef.current.scrollLeft=0)},[H]);const Ee=X.useCallback(Bt=>W(Bt.field),[]),se=X.useCallback(()=>W(""),[]),we=X.useCallback(Bt=>N(Bt.field),[]),Se=X.useCallback(()=>N(""),[]),Pe=X.useMemo(()=>ce.left.length?{firstColumnIndex:0,lastColumnIndex:ce.left.length}:null,[ce.left.length]),Me=X.useMemo(()=>ce.right.length?{firstColumnIndex:t.length-ce.right.length,lastColumnIndex:t.length}:null,[ce.right.length,t.length]);Lr(H,"columnResizeStart",Ee),Lr(H,"columnResizeStop",se),Lr(H,"columnHeaderDragStart",we),Lr(H,"columnHeaderDragEnd",Se);const Re=Bt=>{const{renderContext:hn=de,maxLastColumn:ot=t.length}=Bt||{},en=hn.firstColumnIndex,wt=le?hn.lastColumnIndex:ot;return{renderedColumns:t.slice(en,wt),firstColumnToRender:en,lastColumnToRender:wt}},Oe=(Bt,hn,ot,en=!1)=>{const wt=(Bt==null?void 0:Bt.position)===Go.RIGHT,Ne=(Bt==null?void 0:Bt.position)===void 0,We=ce.right.length>0&&wt||ce.right.length===0&&Ne,Sn=xe-ot;return K.jsxs(X.Fragment,{children:[Ne&&K.jsx("div",{role:"presentation",style:{width:Sn}}),hn,Ne&&K.jsx("div",{role:"presentation",className:Hn(xt.filler,en&&xt["filler--borderBottom"])}),We&&K.jsx(KA,{header:!0,pinnedRight:wt,borderBottom:en,borderTop:!1})]})},$e=({pinnedPosition:Bt,columnIndex:hn,computedWidth:ot})=>{let en;const wt=Bt===Go.LEFT,Ne=Bt===Go.RIGHT;if(wt||Ne){const We=ZA(Bt,ot,hn,ye,re);let Sn=wt?"left":"right";q&&(Sn=wt?"right":"left"),Bt==="left"&&(en={[Sn]:We}),Bt==="right"&&(en={[Sn]:We})}return en},Ke=(Bt,hn={})=>{const{renderedColumns:ot,firstColumnToRender:en}=Re(Bt),wt=[];for(let Ne=0;Ne<ot.length;Ne+=1){const We=ot[Ne],Sn=en+Ne,Ae=Sn===0,st=a!==null&&a.field===We.field||Ae&&!P?0:-1,gt=f!==null&&f.field===We.field,ut=C.open&&C.field===We.field,tt=Bt==null?void 0:Bt.position,nt=$e({pinnedPosition:tt,columnIndex:Sn,computedWidth:We.computedWidth}),tn=tt===Go.RIGHT?ot[Ne-1]:ot[Ne+1],un=tn?f!==null&&f.field===tn.field:!1,qt=Sn+1===ye.length-ce.right.length;wt.push(K.jsx(Tpe,Ge({},n[We.field],{columnMenuOpen:ut,filterItemsCounter:s[We.field]&&s[We.field].length,headerHeight:re.headerHeight,isDragging:We.field===D,colDef:We,colIndex:Sn,isResizing:j===We.field,isLast:Sn===ye.length-1,hasFocus:gt,tabIndex:st,pinnedPosition:tt,style:nt,indexInSection:Ne,sectionLength:ot.length,gridHasFiller:he,isLastUnpinned:qt,isSiblingFocused:un},hn),We.field))}return Oe(Bt,wt,0)},Ct=()=>K.jsxs(LN,{role:"row","aria-rowindex":r+1,ownerState:Z,className:xt["row--borderBottom"],children:[Pe&&Ke({position:Go.LEFT,renderContext:Pe,maxLastColumn:Pe.lastColumnIndex},{disableReorder:!0}),Ke({renderContext:de,maxLastColumn:t.length-ce.right.length}),Me&&Ke({position:Go.RIGHT,renderContext:Me,maxLastColumn:Me.lastColumnIndex},{disableReorder:!0,separatorSide:YA.Left})]}),Ue=({depth:Bt,params:hn})=>{var Jt,Wt;const ot=Re(hn);if(ot.renderedColumns.length===0)return null;const{firstColumnToRender:en,lastColumnToRender:wt}=ot,Ne=I[Bt],We=t[en].field,Sn=((Jt=_e[We])==null?void 0:Jt[Bt])??null,Ae=Ne.findIndex(({groupId:Fn,columnFields:ar})=>Fn===Sn&&ar.includes(We)),st=t[wt-1].field,gt=((Wt=_e[st])==null?void 0:Wt[Bt])??null,ut=Ne.findIndex(({groupId:Fn,columnFields:ar})=>Fn===gt&&ar.includes(st)),tt=Ne.slice(Ae,ut+1).map(Fn=>Ge({},Fn,{columnFields:Fn.columnFields.filter(ar=>k[ar]!==!1)})).filter(Fn=>Fn.columnFields.length>0),nt=tt[0].columnFields.indexOf(We),un=tt[0].columnFields.slice(0,nt).reduce((Fn,ar)=>{const bn=oe[ar];return Fn+(bn.computedWidth??0)},0);let qt=en;const an=tt.map(({groupId:Fn,columnFields:ar},bn)=>{const lr=_!==null&&_.depth===Bt&&ar.includes(_.field),Cn=u!==null&&u.depth===Bt&&ar.includes(u.field)?0:-1,xn={groupId:Fn,width:ar.reduce((Mn,Ar)=>Mn+oe[Ar].computedWidth,0),fields:ar,colIndex:qt,hasFocus:lr,tabIndex:Cn},Er=hn.position,Rr=$e({pinnedPosition:Er,columnIndex:qt,computedWidth:xn.width});qt+=ar.length;let Wn=bn;return Er==="left"&&(Wn=qt-1),K.jsx(R0e,{groupId:Fn,width:xn.width,fields:xn.fields,colIndex:xn.colIndex,depth:Bt,isLastColumn:xn.colIndex===t.length-xn.fields.length,maxDepth:r,height:re.groupHeaderHeight,hasFocus:lr,tabIndex:Cn,pinnedPosition:Er,style:Rr,indexInSection:Wn,sectionLength:Ne.length,gridHasFiller:he},bn)});return Oe(hn,an,un)};return{renderContext:de,leftRenderContext:Pe,rightRenderContext:Me,pinnedColumns:ce,visibleColumns:t,getCellOffsetStyle:$e,getFillers:Oe,getColumnHeadersRow:Ct,getColumnsToRender:Re,getColumnGroupHeadersRows:()=>{if(r===0)return null;const Bt=[];for(let hn=0;hn<r;hn+=1)Bt.push(K.jsxs(LN,{role:"row","aria-rowindex":hn+1,ownerState:Z,children:[Pe&&Ue({depth:hn,params:{position:Go.LEFT,renderContext:Pe,maxLastColumn:Pe.lastColumnIndex}}),Ue({depth:hn,params:{renderContext:de}}),Me&&Ue({depth:hn,params:{position:Go.RIGHT,renderContext:Me,maxLastColumn:Me.lastColumnIndex}})]},hn));return Bt},isDragging:!!D,getInnerProps:()=>({role:"rowgroup"})}},D0e=["className"],z0e=e=>{const{classes:t}=e;return yr({root:["columnHeaders"]},Gi,t)},F0e=Wo("div",{name:"MuiDataGrid",slot:"ColumnHeaders",overridesResolver:(e,t)=>t.columnHeaders})({display:"flex",flexDirection:"column",borderTopLeftRadius:"var(--unstable_DataGrid-radius)",borderTopRightRadius:"var(--unstable_DataGrid-radius)"}),N0e=X.forwardRef(function(t,n){const{className:s}=t,a=Zr(t,D0e),u=Ur(),f=z0e(u);return K.jsx(F0e,Ge({ref:n,className:Hn(f.root,s),ownerState:u},a,{role:"presentation"}))}),B0e=["className","visibleColumns","sortColumnLookup","filterColumnLookup","columnHeaderTabIndexState","columnGroupHeaderTabIndexState","columnHeaderFocus","columnGroupHeaderFocus","headerGroupingMaxDepth","columnMenuState","columnVisibility","columnGroupsHeaderStructure","hasOtherElementInTabSequence"],j0e=X.forwardRef(function(t,n){const{visibleColumns:s,sortColumnLookup:a,filterColumnLookup:u,columnHeaderTabIndexState:f,columnGroupHeaderTabIndexState:_,columnHeaderFocus:r,columnGroupHeaderFocus:C,headerGroupingMaxDepth:k,columnMenuState:I,columnVisibility:P,columnGroupsHeaderStructure:D,hasOtherElementInTabSequence:N}=t,j=Zr(t,B0e),{getInnerProps:W,getColumnHeadersRow:H,getColumnGroupHeadersRows:q}=O0e({visibleColumns:s,sortColumnLookup:a,filterColumnLookup:u,columnHeaderTabIndexState:f,columnGroupHeaderTabIndexState:_,columnHeaderFocus:r,columnGroupHeaderFocus:C,headerGroupingMaxDepth:k,columnMenuState:I,columnVisibility:P,columnGroupsHeaderStructure:D,hasOtherElementInTabSequence:N});return K.jsxs(N0e,Ge({ref:n},j,W(),{children:[q(),H()]}))}),V0e=xp(j0e);function $0e(e){return null}function U0e(e){return null}const G0e=X.forwardRef(function(t,n){const a=Bi().current.getLocaleText("noResultsOverlayLabel");return K.jsx(XA,Ge({ref:n},t,{children:a}))}),H0e=["sortingOrder"],W0e=X.memo(function(t){const{sortingOrder:n}=t,s=Zr(t,H0e),a=Ur(),[u]=n,f=u==="asc"?a.slots.columnSortedAscendingIcon:a.slots.columnSortedDescendingIcon;return f?K.jsx(f,Ge({},s)):null}),q0e=["native"];function X0e(e){let{native:t}=e,n=Zr(e,q0e);return t?K.jsx("option",Ge({},n)):K.jsx(gl,Ge({},n))}const Y0e={booleanCellTrueIcon:Xpe,booleanCellFalseIcon:Vk,columnMenuIcon:Gpe,openFilterButtonIcon:Fpe,filterPanelDeleteIcon:Vk,columnFilteredIcon:dN,columnSelectorIcon:Bpe,columnUnsortedIcon:W0e,columnSortedAscendingIcon:aN,columnSortedDescendingIcon:lN,columnResizeIcon:jpe,densityCompactIcon:Vpe,densityStandardIcon:$pe,densityComfortableIcon:Upe,exportIcon:qpe,moreActionsIcon:Ype,treeDataCollapseIcon:cN,treeDataExpandIcon:uN,groupingCriteriaCollapseIcon:cN,groupingCriteriaExpandIcon:uN,detailPanelExpandIcon:hN,detailPanelCollapseIcon:Hpe,rowReorderIcon:fN,quickFilterIcon:Npe,quickFilterClearIcon:Vk,columnMenuHideIcon:Zpe,columnMenuSortAscendingIcon:aN,columnMenuSortDescendingIcon:lN,columnMenuFilterIcon:dN,columnMenuManageColumnsIcon:Kpe,columnMenuClearIcon:Jpe,loadIcon:Wpe,filterPanelAddIcon:hN,filterPanelRemoveAllIcon:Qpe,columnReorderIcon:fN},Z0e=Ge({},Y0e,{baseBadge:Zee,baseCheckbox:vte,baseDivider:hm,baseTextField:c8,baseFormControl:up,baseSelect:Zd,baseButton:km,baseIconButton:ga,baseInputAdornment:zne,baseTooltip:d1,basePopper:Nm,baseInputLabel:cp,baseSelectOption:X0e,baseChip:ME}),K0e=Ge({},Z0e,{cell:jfe,skeletonCell:qfe,columnHeaderFilterIconButton:zpe,columnHeaderSortIcon:Ope,columnMenu:yme,columnHeaders:V0e,detailPanels:$0e,footer:uge,footerRowCount:Tge,toolbar:null,pinnedRows:U0e,loadingOverlay:yge,noResultsOverlay:G0e,noRowsOverlay:_ge,pagination:wge,filterPanel:ege,columnsPanel:Mme,columnsManagement:b$,panel:Ome,row:Age});function J0e({defaultSlots:e,slots:t}){const n=t;if(!n||Object.keys(n).length===0)return e;const s=Ge({},e);return Object.keys(n).forEach(a=>{const u=a;n[u]!==void 0&&(s[u]=n[u])}),s}function Q0e(e){const t=Object.keys(e);if(!t.some(a=>a.startsWith("aria-")||a.startsWith("data-")))return e;const n={},s=e.forwardedProps??{};for(let a=0;a<t.length;a+=1){const u=t[a];u.startsWith("aria-")||u.startsWith("data-")?s[u]=e[u]:n[u]=e[u]}return n.forwardedProps=s,n}function e_e(e){return X.useMemo(()=>Q0e(e),[e])}const t_e={disableMultipleColumnsFiltering:!0,disableMultipleColumnsSorting:!0,throttleRowsMs:void 0,hideFooterRowCount:!1,pagination:!0,checkboxSelectionVisibleOnly:!1,disableColumnReorder:!0,keepColumnPositionIfDraggedOutside:!1,signature:"DataGrid",unstable_listView:!1},n_e=K0e,r_e=e=>{const t=e_e(Rj({props:e,name:"MuiDataGrid"})),n=X.useMemo(()=>Ge({},yue,t.localeText),[t.localeText]),s=X.useMemo(()=>J0e({defaultSlots:n_e,slots:t.slots}),[t.slots]),a=X.useMemo(()=>Object.keys(jP).reduce((u,f)=>(u[f]=t[f]??jP[f],u),{}),[t]);return X.useMemo(()=>Ge({},t,a,{localeText:n,slots:s},t_e),[t,n,s,a])},i_e={hooks:{useGridAriaAttributes:Lge,useGridRowAriaAttributes:Rge}},P$=X.forwardRef(function(t,n){const s=r_e(t),a=A0e(s.apiRef,s);return K.jsx(Oge,{privateApiRef:a,configuration:i_e,props:s,children:K.jsxs(rpe,Ge({className:s.className,style:s.style,sx:s.sx,ref:n},s.forwardedProps,{children:[K.jsx(dge,{}),K.jsx(yfe,{}),K.jsx(_fe,{})]}))})}),o_e=X.memo(P$);P$.propTypes={apiRef:Pt.shape({current:Pt.object.isRequired}),"aria-label":Pt.string,"aria-labelledby":Pt.string,autoHeight:Pt.bool,autoPageSize:Pt.bool,autosizeOnMount:Pt.bool,autosizeOptions:Pt.shape({columns:Pt.arrayOf(Pt.string),expand:Pt.bool,includeHeaders:Pt.bool,includeOutliers:Pt.bool,outliersFactor:Pt.number}),cellModesModel:Pt.object,checkboxSelection:Pt.bool,classes:Pt.object,clipboardCopyCellDelimiter:Pt.string,columnBufferPx:Pt.number,columnGroupHeaderHeight:Pt.number,columnGroupingModel:Pt.arrayOf(Pt.object),columnHeaderHeight:Pt.number,columns:Pt.arrayOf(Pt.object).isRequired,columnVisibilityModel:Pt.object,density:Pt.oneOf(["comfortable","compact","standard"]),disableAutosize:Pt.bool,disableColumnFilter:Pt.bool,disableColumnMenu:Pt.bool,disableColumnResize:Pt.bool,disableColumnSelector:Pt.bool,disableColumnSorting:Pt.bool,disableDensitySelector:Pt.bool,disableEval:Pt.bool,disableMultipleRowSelection:Pt.bool,disableRowSelectionOnClick:Pt.bool,disableVirtualization:Pt.bool,editMode:Pt.oneOf(["cell","row"]),estimatedRowCount:Pt.number,experimentalFeatures:Pt.shape({warnIfFocusStateIsNotSynced:Pt.bool}),filterDebounceMs:Pt.number,filterMode:Pt.oneOf(["client","server"]),filterModel:Pt.shape({items:Pt.arrayOf(Pt.shape({field:Pt.string.isRequired,id:Pt.oneOfType([Pt.number,Pt.string]),operator:Pt.string.isRequired,value:Pt.any})).isRequired,logicOperator:Pt.oneOf(["and","or"]),quickFilterExcludeHiddenColumns:Pt.bool,quickFilterLogicOperator:Pt.oneOf(["and","or"]),quickFilterValues:Pt.array}),forwardedProps:Pt.object,getCellClassName:Pt.func,getDetailPanelContent:Pt.func,getEstimatedRowHeight:Pt.func,getRowClassName:Pt.func,getRowHeight:Pt.func,getRowId:Pt.func,getRowSpacing:Pt.func,hideFooter:Pt.bool,hideFooterPagination:Pt.bool,hideFooterSelectedRowCount:Pt.bool,ignoreDiacritics:Pt.bool,ignoreValueFormatterDuringExport:Pt.oneOfType([Pt.shape({clipboardExport:Pt.bool,csvExport:Pt.bool}),Pt.bool]),indeterminateCheckboxAction:Pt.oneOf(["deselect","select"]),initialState:Pt.object,isCellEditable:Pt.func,isRowSelectable:Pt.func,keepNonExistentRowsSelected:Pt.bool,loading:Pt.bool,localeText:Pt.object,logger:Pt.shape({debug:Pt.func.isRequired,error:Pt.func.isRequired,info:Pt.func.isRequired,warn:Pt.func.isRequired}),logLevel:Pt.oneOf(["debug","error","info","warn",!1]),nonce:Pt.string,onCellClick:Pt.func,onCellDoubleClick:Pt.func,onCellEditStart:Pt.func,onCellEditStop:Pt.func,onCellKeyDown:Pt.func,onCellModesModelChange:Pt.func,onClipboardCopy:Pt.func,onColumnHeaderClick:Pt.func,onColumnHeaderContextMenu:Pt.func,onColumnHeaderDoubleClick:Pt.func,onColumnHeaderEnter:Pt.func,onColumnHeaderLeave:Pt.func,onColumnHeaderOut:Pt.func,onColumnHeaderOver:Pt.func,onColumnOrderChange:Pt.func,onColumnResize:Pt.func,onColumnVisibilityModelChange:Pt.func,onColumnWidthChange:Pt.func,onDensityChange:Pt.func,onFilterModelChange:Pt.func,onMenuClose:Pt.func,onMenuOpen:Pt.func,onPaginationMetaChange:Pt.func,onPaginationModelChange:Pt.func,onPreferencePanelClose:Pt.func,onPreferencePanelOpen:Pt.func,onProcessRowUpdateError:Pt.func,onResize:Pt.func,onRowClick:Pt.func,onRowCountChange:Pt.func,onRowDoubleClick:Pt.func,onRowEditStart:Pt.func,onRowEditStop:Pt.func,onRowModesModelChange:Pt.func,onRowSelectionModelChange:Pt.func,onSortModelChange:Pt.func,onStateChange:Pt.func,pageSizeOptions:Pt.arrayOf(Pt.oneOfType([Pt.number,Pt.shape({label:Pt.string.isRequired,value:Pt.number.isRequired})]).isRequired),pagination:Pt.oneOf([!0]),paginationMeta:Pt.shape({hasNextPage:Pt.bool}),paginationMode:Pt.oneOf(["client","server"]),paginationModel:Pt.shape({page:Pt.number.isRequired,pageSize:Pt.number.isRequired}),processRowUpdate:Pt.func,resizeThrottleMs:Pt.number,rowBufferPx:Pt.number,rowCount:Pt.number,rowHeight:Pt.number,rowModesModel:Pt.object,rowPositionsDebounceMs:Pt.number,rows:Pt.arrayOf(Pt.object),rowSelection:Pt.bool,rowSelectionModel:Pt.oneOfType([Pt.arrayOf(Pt.oneOfType([Pt.number,Pt.string]).isRequired),Pt.number,Pt.string]),rowSpacingType:Pt.oneOf(["border","margin"]),scrollbarSize:Pt.number,showCellVerticalBorder:Pt.bool,showColumnVerticalBorder:Pt.bool,slotProps:Pt.object,slots:Pt.object,sortingMode:Pt.oneOf(["client","server"]),sortingOrder:Pt.arrayOf(Pt.oneOf(["asc","desc"])),sortModel:Pt.arrayOf(Pt.shape({field:Pt.string.isRequired,sort:Pt.oneOf(["asc","desc"])})),sx:Pt.oneOfType([Pt.arrayOf(Pt.oneOfType([Pt.func,Pt.object,Pt.bool])),Pt.func,Pt.object]),unstable_rowSpanning:Pt.bool};const s_e=({id:e,selectedLayerId:t,data:n,onFilterModelChange:s,rowSelectionModel:a,setRowSelectionModel:u})=>{const f=n.every(r=>r.id),_=n.length>0?Object.keys(n[0]).map(r=>({field:r,headerName:r,flex:1,sortable:!0,filterable:!0,headerClassName:"super-app-theme--header"})):[];return K.jsx(Ci,{id:e,sx:{height:500,bgcolor:"#444444",borderRadius:"8px",overflow:"hidden"},children:t?f?K.jsx(o_e,{rows:n,columns:_,checkboxSelection:!0,onRowSelectionModelChange:r=>u(r),rowSelectionModel:a,getRowId:r=>r.id,onFilterModelChange:s,sx:{color:"white",bgcolor:"#555555",border:"none",borderRadius:"5px","& .super-app-theme--header":{backgroundColor:"#ECAC7A",color:"black",fontSize:"0.9rem",fontWeight:"bold"},"& .MuiDataGrid-cell":{color:"white",fontSize:"0.875rem",fontWeight:400},"& .MuiDataGrid-columnHeaders":{bgcolor:"#A8D99C",color:"black",fontSize:"1rem",fontWeight:"bold"},"& .MuiDataGrid-columnHeader:focus, & .MuiDataGrid-columnHeader:focus-within":{outline:"none"},"& .MuiDataGrid-columnHeader .MuiDataGrid-sortIcon":{color:"black"},"& .MuiDataGrid-row:hover":{bgcolor:"rgba(255, 255, 255, 0.1)"},"& .Mui-selected":{bgcolor:"rgba(255, 255, 255, 0.1) !important",color:"white !important"},"& .MuiDataGrid-footerContainer":{bgcolor:"#666666",color:"white"},"& .MuiDataGrid-columnHeaderCheckbox":{backgroundColor:"#ECAC7A",color:"black"},"& .MuiDataGrid-checkboxInput":{color:"#ECAC7A",outline:"none","&.Mui-checked":{color:"#ECAC7A",outline:"none"}},"& .MuiDataGrid-columnHeaderCheckbox .MuiSvgIcon-root":{color:"white"},"& .MuiDataGrid-cell:focus":{outline:"none"},"& .MuiDataGrid-row.Mui-selected:focus":{outline:"none"},"& .MuiDataGrid-row":{borderBottomWidth:"0.2px",borderBottomColor:"#ECAC7A"},"& .MuiDataGrid-columnSeparator":{color:"#white","&hover":{color:"#ECAC7A"}},"& .MuiDataGrid-virtualScroller":{"&::-webkit-scrollbar":{width:"8px",height:"8px"},"&::-webkit-scrollbar-thumb":{backgroundColor:"#A8D99C",borderRadius:"4px"},"&::-webkit-scrollbar-thumb:hover":{backgroundColor:"#ECAC7A"},"&::-webkit-scrollbar-track":{backgroundColor:"#444444"}}}}):K.jsx(To,{variant:"body2",sx:{color:"#ffffff",textAlign:"center",mt:4},children:"Invalid data. Unable to display table."}):K.jsx(To,{variant:"body2",sx:{color:"#ffffff",textAlign:"center",mt:4},children:"Please select a layer to view its attributes."})})},a_e=({attributes:e,onFilterChange:t})=>{const[n,s]=X.useState([{selectedAttribute:null,selectedOperation:null,filterValue:""}]),a={string:["equals","starts with","contains"],number:["=","!=",">","<",">=","<="],boolean:["is true","is false"]},u=k=>{const I=new Set;for(const P of e){const D=P[k];typeof D=="string"&&I.add("string"),typeof D=="number"&&I.add("number"),typeof D=="boolean"&&I.add("boolean")}return I.size>1?"mixed":I.size===1?Array.from(I)[0]:null},f=()=>{const k=e.filter(I=>n.every(P=>{const{selectedAttribute:D,selectedOperation:N,filterValue:j}=P;if(!D||!N)return!0;const W=I[D];if(typeof W=="string"){if(N==="equals")return W===j;if(N==="starts with")return W.startsWith(j);if(N==="contains")return W.includes(j)}else if(typeof W=="number"){const H=Number(j);if(N==="=")return W===H;if(N==="!=")return W!==H;if(N===">")return W>H;if(N==="<")return W<H;if(N===">=")return W>=H;if(N==="<=")return W<=H}else if(typeof W=="boolean"){if(N==="is true")return W===!0;if(N==="is false")return W===!1}return!1}));t(k)},_=k=>{s(I=>{if(k===0){const P=I.map((N,j)=>j===0?{selectedAttribute:null,selectedOperation:null,filterValue:""}:N),D=e.filter(N=>P.every(j=>{const{selectedAttribute:W,selectedOperation:H,filterValue:q}=j;if(!W||!H)return!0;const Z=N[W];if(typeof Z=="string"){if(H==="equals")return Z===q;if(H==="starts with")return Z.startsWith(q);if(H==="contains")return Z.includes(q)}else if(typeof Z=="number"){const re=Number(q);if(H==="=")return Z===re;if(H==="!=")return Z!==re;if(H===">")return Z>re;if(H==="<")return Z<re;if(H===">=")return Z>=re;if(H==="<=")return Z<=re}else if(typeof Z=="boolean"){if(H==="is true")return Z===!0;if(H==="is false")return Z===!1}return!1}));return t(D),P}else{const P=I.filter((N,j)=>j!==k),D=e.filter(N=>P.every(j=>{const{selectedAttribute:W,selectedOperation:H,filterValue:q}=j;if(!W||!H)return!0;const Z=N[W];if(typeof Z=="string"){if(H==="equals")return Z===q;if(H==="starts with")return Z.startsWith(q);if(H==="contains")return Z.includes(q)}else if(typeof Z=="number"){const re=Number(q);if(H==="=")return Z===re;if(H==="!=")return Z!==re;if(H===">")return Z>re;if(H==="<")return Z<re;if(H===">=")return Z>=re;if(H==="<=")return Z<=re}else if(typeof Z=="boolean"){if(H==="is true")return Z===!0;if(H==="is false")return Z===!1}return!1}));return t(D),P}})},r=()=>{s(k=>[...k,{selectedAttribute:null,selectedOperation:null,filterValue:""}])},C=(k,I,P)=>{s(D=>D.map((N,j)=>j===k?{...N,[I]:P}:N))};return K.jsx(Ci,{sx:{p:2,pt:1},children:n.map((k,I)=>{var D;const P=k.selectedAttribute?u(k.selectedAttribute):null;return K.jsxs(Ci,{sx:{display:"flex",alignItems:"center",gap:2,width:"100%"},children:[K.jsxs(Ci,{sx:{display:"flex",alignItems:"center",gap:2,flex:3},children:[K.jsx(jh,{id:"attribute-select",label:"Attribute",value:k.selectedAttribute||"",options:Object.keys(e[0]||{}).map(N=>({value:N,label:N})),onChange:N=>C(I,"selectedAttribute",N.target.value)}),K.jsx(jh,{id:"operation-select",label:"Operation",value:k.selectedOperation||"",options:P?(D=a[P])==null?void 0:D.map(N=>({value:N,label:N})):[],onChange:N=>C(I,"selectedOperation",N.target.value),disabled:!P}),K.jsx(Bh,{id:"filter-value",label:"Value",value:k.filterValue,onChange:N=>C(I,"filterValue",N.target.value),InputLabelProps:{shrink:!0}}),K.jsxs(Ci,{sx:{display:"flex",justifyContent:"center",alignItems:"center",gap:1},children:[K.jsx(ga,{id:"apply-filter",onClick:f,disabled:!n.some(N=>N.selectedAttribute&&N.selectedOperation),sx:{color:"#A8D99C","&.Mui-disabled":{color:"rgba(168, 217, 156, 0.5)"}},children:K.jsx(aoe,{sx:{fontSize:24}})}),K.jsx(ga,{onClick:()=>{_(I)},sx:{color:"#ECAC7A"},children:K.jsx(ooe,{sx:{fontSize:24}})})]})]}),K.jsx(Ci,{sx:{flex:1,display:"flex",justifyContent:I===n.length-1?"center":"flex-start"},children:I===n.length-1&&K.jsx(km,{variant:"outlined",onClick:r,sx:{borderColor:"#A8D99C",fontSize:"0.7rem",color:"#A8D99C",whiteSpace:"nowrap",px:2,"&:hover":{backgroundColor:"rgba(168, 217, 156, 0.1)"}},children:"Add another rule"})})]},I)})})},l_e=({open:e,onClose:t,layers:n,initialSelectedLayerId:s})=>{const[a,u]=X.useState(s),[f,_]=X.useState([]),{enqueueSnackbar:r}=vp(),{addLayer:C}=_c(),[k,I]=X.useState(!1),[P,D]=X.useState(!1),N=Sr.useMemo(()=>n.map(ye=>({...ye,data:{...ye.data,features:ye.data.features.map((de,ce)=>{var xe;const oe=((xe=de.properties)==null?void 0:xe.id)||`${ye.id||"layer"}-${ce}`;return{...de,id:oe}})}})),[n]),j=N.find(ye=>ye.id===a),W=Sr.useMemo(()=>(j==null?void 0:j.data.features.map(ye=>({id:ye.id,...ye.properties})))||[],[j]),[H,q]=X.useState(W);X.useEffect(()=>{q(W)},[W]);const Z=()=>{if(f.length===0){r("Please select rows to create a new layer.",{variant:"warning",autoHideDuration:2500});return}const ye=j==null?void 0:j.data.features.filter(de=>f.includes(de.id));ye&&ye.length>0?(C({type:"FeatureCollection",features:ye},nd(),`${j==null?void 0:j.name}_Filtered`,!0),r("New layer created successfully!",{variant:"success",autoHideDuration:2500}),t()):r("No valid features selected.",{variant:"error",autoHideDuration:2500})},re=()=>{I(ye=>(ye&&q(W),!ye))};X.useEffect(()=>{s&&u(s)},[s]);const le=()=>D(!0),_e=[{target:"#attribute-table-modal",content:"Now you are going to make a layer of Solvangen kindergarten by filtering the attribute table.",disableBeacon:!0,spotlightClicks:!0,placement:"bottom"},{target:"#layer-select",content:"Select 'barnehager' from the dropdown list.",disableBeacon:!0,spotlightClicks:!0,placement:"bottom",styles:{overlay:{pointerEvents:"none"}}},{target:"#filter-button",content:"Click to filter on attributes.",disableBeacon:!0,spotlightClicks:!0,placement:"bottom"},{target:"#attribute-select",content:"Choose the 'barnehagenavn' attribute.",disableBeacon:!0,spotlightClicks:!0,placement:"top",styles:{overlay:{pointerEvents:"none"}}},{target:"#operation-select",content:"Choose the 'starts with' operation.",disableBeacon:!0,spotlightClicks:!0,placement:"top",styles:{overlay:{pointerEvents:"none"}}},{target:"#filter-value",content:"Write 'Solvangen' in the filter value field. Remember capital 'S'.",disableBeacon:!0,spotlightClicks:!0,placement:"top",styles:{overlay:{pointerEvents:"none"}}},{target:"#apply-filter",content:"Click to filter on this rule. The matching rows will be selected.",disableBeacon:!0,spotlightClicks:!0,placement:"top"},{target:"#attribute-table-grid",content:"Inspect the information in the table, and assure that the row with 'Solvangen barnehage' in the 'barnehagenavn' attribute is selected.",disableBeacon:!0,spotlightClicks:!0,placement:"top"},{target:"#submit-button",content:"Click to create layer with the selected row.",disableBeacon:!0,spotlightClicks:!0,placement:"top"}];return K.jsxs(K.Fragment,{children:[K.jsx(od,{open:e,onClose:t,header:"Attribute Table",headerId:"attribute-table-modal",submitLabel:"Create Layer With Selected Rows",onSubmit:Z,modalWidth:900,tutorialHelp:!0,openTutorial:le,children:K.jsxs(Ci,{sx:{maxHeight:"78vh",overflowY:"auto"},children:[K.jsx(mue,{layers:N,selectedLayerId:a,setSelectedLayerId:u,toggleFilterRow:re,isFilterRowVisible:k}),k&&K.jsx(a_e,{attributes:W,onFilterChange:ye=>{q(ye||W),_((ye||W).map(de=>de.id))}}),K.jsx(s_e,{id:"attribute-table-grid",selectedLayerId:a,data:H,rowSelectionModel:f,setRowSelectionModel:ye=>_(ye)})]})}),K.jsx(BE,{steps:_e,run:e&&P,onClose:()=>D(!1)})]})},u_e=({onOpenAddLayerModal:e})=>{const{toggleAllLayersVisibility:t}=_c(),{layers:n}=Lu(),[s,a]=X.useState(!1),[u,f]=X.useState(!1),[_,r]=X.useState(!1),C=n.length>0,k=()=>a(!0),I=()=>a(!1),P=()=>f(!0),D=()=>f(!1),N=()=>{n.length>0&&r(!0)},j=()=>{r(!1)};return K.jsxs(K.Fragment,{children:[K.jsx(u8,{children:K.jsx("img",{src:lV,alt:"App Logo",style:{width:"170px",height:"70px"}})}),K.jsx(hm,{textAlign:"left",sx:{"&::before, &::after":{borderColor:"#ECAC7A"}},children:K.jsx(ME,{label:"Map Layers",size:"medium",sx:{backgroundColor:"#A8D99C",color:"black",height:20}})}),K.jsxs(Ci,{sx:{display:"flex",alignItems:"center",justifyContent:"space-around",paddingY:1,paddingX:2},children:[K.jsx(Av,{id:"add-layer-button",icon:K.jsx(roe,{sx:{color:"white",fontSize:"28px","&:hover":{color:"#A8D99C"}}}),tooltipTitle:"Add Layer",onClick:e}),K.jsx(hm,{orientation:"vertical",sx:{height:24}}),K.jsx(Av,{icon:K.jsx(yoe,{sx:{width:"24px",height:"24px"}}),tooltipTitle:"Show Attribute Table",onClick:()=>N(),disabled:!C}),K.jsx(hm,{orientation:"vertical",sx:{height:24}}),K.jsx(Av,{icon:K.jsx(doe,{sx:{width:"24px",height:"24px"}}),tooltipTitle:"Download Selected Layer(s)",onClick:()=>P(),disabled:!C}),K.jsx(Av,{icon:C&&n.every(W=>W.visible)?K.jsx(voe,{sx:{width:"24px",height:"24px"}}):K.jsx(xoe,{sx:{width:"24px",height:"24px",color:"grey"}}),tooltipTitle:C&&n.every(W=>W.visible)?"Hide All Layers":"Show All Layers",onClick:()=>t(),disabled:!C}),K.jsx(Av,{icon:K.jsx(coe,{sx:{width:"24px",height:"24px","&:hover":{color:"#ECAC7A"}}}),tooltipTitle:"Delete Selected Layer(s)",onClick:()=>k(),disabled:!C})]}),K.jsx(hm,{}),K.jsx(due,{open:s,onClose:I}),K.jsx(pue,{open:u,onClose:D}),K.jsx(l_e,{open:_,onClose:j,layers:n,initialSelectedLayerId:null})]})};var c_e="Expected a function",RN=NaN,d_e="[object Symbol]",h_e=/^\s+|\s+$/g,f_e=/^[-+]0x[0-9a-f]+$/i,p_e=/^0b[01]+$/i,m_e=/^0o[0-7]+$/i,g_e=parseInt,y_e=typeof fl=="object"&&fl&&fl.Object===Object&&fl,__e=typeof self=="object"&&self&&self.Object===Object&&self,v_e=y_e||__e||Function("return this")(),x_e=Object.prototype,b_e=x_e.toString,w_e=Math.max,S_e=Math.min,Wk=function(){return v_e.Date.now()};function C_e(e,t,n){var s,a,u,f,_,r,C=0,k=!1,I=!1,P=!0;if(typeof e!="function")throw new TypeError(c_e);t=ON(t)||0,GP(n)&&(k=!!n.leading,I="maxWait"in n,u=I?w_e(ON(n.maxWait)||0,t):u,P="trailing"in n?!!n.trailing:P);function D(_e){var ye=s,de=a;return s=a=void 0,C=_e,f=e.apply(de,ye),f}function N(_e){return C=_e,_=setTimeout(H,t),k?D(_e):f}function j(_e){var ye=_e-r,de=_e-C,ce=t-ye;return I?S_e(ce,u-de):ce}function W(_e){var ye=_e-r,de=_e-C;return r===void 0||ye>=t||ye<0||I&&de>=u}function H(){var _e=Wk();if(W(_e))return q(_e);_=setTimeout(H,j(_e))}function q(_e){return _=void 0,P&&s?D(_e):(s=a=void 0,f)}function Z(){_!==void 0&&clearTimeout(_),C=0,s=r=a=_=void 0}function re(){return _===void 0?f:q(Wk())}function le(){var _e=Wk(),ye=W(_e);if(s=arguments,a=this,r=_e,ye){if(_===void 0)return N(r);if(I)return _=setTimeout(H,t),D(r)}return _===void 0&&(_=setTimeout(H,t)),f}return le.cancel=Z,le.flush=re,le}function GP(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function E_e(e){return!!e&&typeof e=="object"}function T_e(e){return typeof e=="symbol"||E_e(e)&&b_e.call(e)==d_e}function ON(e){if(typeof e=="number")return e;if(T_e(e))return RN;if(GP(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=GP(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=e.replace(h_e,"");var n=p_e.test(e);return n||m_e.test(e)?g_e(e.slice(2),n?2:8):f_e.test(e)?RN:+e}var I_e=C_e;const k_e=yc(I_e),M_e=Sr.lazy(()=>aV(()=>import("./AddLayerModal-DMVSchiP.js"),__vite__mapDeps([0,1]))),P_e=Sr.lazy(()=>aV(()=>import("./LayerList-BNUadUBf.js"),__vite__mapDeps([2,1]))),A_e=280,L_e=window.innerWidth/1.5,R_e=({isOpen:e,currentWidth:t,onToggle:n,onResize:s})=>{const[a,u]=X.useState(!1),[f,_]=X.useState(!1),[r,C]=X.useState(!1),{clearTempLayers:k}=cV(),I=X.useCallback(W=>{const H=Math.max(A_e,Math.min(W,L_e));s(H)},[s]);X.useEffect(()=>{const W=k_e(I,0),H=q=>{a&&W(q.clientX)};return a&&(window.addEventListener("mousemove",H),window.addEventListener("mouseup",D)),()=>{window.removeEventListener("mousemove",H),window.removeEventListener("mouseup",D),W.cancel()}},[a,I]);const P=()=>{u(!0)},D=()=>{u(!1)},N=()=>{C(!0)},j=()=>{k(),C(!1)};return K.jsxs("div",{style:{position:"relative"},children:[K.jsxs(one,{variant:"persistent",open:e,sx:{width:t,transition:"width 0.3s ease",flexShrink:0,"& .MuiDrawer-paper":{width:t,boxSizing:"border-box",zIndex:1e3,backgroundColor:"#555555",color:"#ffffff",display:"flex",flexDirection:"column",height:"100%",overflow:"hidden"}},children:[K.jsx(u_e,{onOpenAddLayerModal:N}),K.jsx(Ci,{sx:{display:"flex",flexDirection:"column",flexGrow:1,position:"relative"},children:K.jsx(X.Suspense,{fallback:K.jsx("div",{children:"Loading Layers..."}),children:K.jsx(Ci,{sx:{overflowY:"auto",flexGrow:1,maxHeight:"80vh"},children:K.jsx(P_e,{})})})}),K.jsx(X.Suspense,{fallback:K.jsx("div",{children:"Loading Modal..."}),children:K.jsx(M_e,{open:r,onClose:j})})]}),!e&&K.jsx("div",{style:{position:"absolute",left:24,top:0,zIndex:1300},children:K.jsx("img",{src:lV,alt:"App Logo",style:{width:"170px",height:"70px"}})}),e&&K.jsx("div",{style:{position:"absolute",left:t-3,top:0,height:"100%",width:"6px",cursor:"col-resize",backgroundColor:f?"#6A6A6A":"transparent",transition:"background-color 0.3s ease",zIndex:1100},onMouseDown:P,onMouseEnter:()=>_(!0),onMouseLeave:()=>_(!1)}),e&&K.jsx(ga,{onClick:n,sx:{position:"absolute",left:t-10,top:"50%",transform:"translateY(-50%)",zIndex:1200,backgroundColor:"#555555",color:"white",width:15,height:40,transition:"background-color 0.3s ease","&:hover":{backgroundColor:"#6A6A6A",boxShadow:"0px 0px 10px rgba(0, 0, 0, 0.5)"},borderRadius:"15%"},children:K.jsx(loe,{})}),!e&&K.jsx(DE,{onClick:n,tooltipTitle:"Map Layers",icon:K.jsx("img",{src:lue,alt:"Map Layers",style:{width:"100%",height:"100%"}}),borderRadius:"20%",tooltipPlacement:"right",left:15,top:"50%",transform:"translateY(-70%)",absolute:!0})]})},O_e="/YouGIS/assets/streets-DGgoZd0m.png",D_e="/YouGIS/assets/outdoors-U9jZTTCI.png",z_e="/YouGIS/assets/light-BI-nhWjL.png",F_e="/YouGIS/assets/dark-BKIOtYQ9.png",N_e="/YouGIS/assets/satellite-DsU4BA_t.png",B_e="/YouGIS/assets/satellite_streets-DHZI-mtk.png",j_e="/YouGIS/assets/navigation_day-3JQb2LFF.png",V_e="/YouGIS/assets/navigation_night-CpFoc55t.png",$_e=[{id:"streets-v12",name:"Streets",imageUrl:O_e,mapboxStyle:"mapbox://styles/mapbox/streets-v12"},{id:"outdoors-v12",name:"Outdoors",imageUrl:D_e,mapboxStyle:"mapbox://styles/mapbox/outdoors-v12"},{id:"light-v11",name:"Light",imageUrl:z_e,mapboxStyle:"mapbox://styles/mapbox/light-v11"},{id:"dark-v11",name:"Dark",imageUrl:F_e,mapboxStyle:"mapbox://styles/mapbox/dark-v11"},{id:"satellite-v9",name:"Satellite",imageUrl:N_e,mapboxStyle:"mapbox://styles/mapbox/satellite-v9"},{id:"satellite-streets-v12",name:"Satellite Streets",imageUrl:B_e,mapboxStyle:"mapbox://styles/mapbox/satellite-streets-v12"},{id:"navigation-day-v1",name:"Navigation Day",imageUrl:j_e,mapboxStyle:"mapbox://styles/mapbox/navigation-day-v1"},{id:"navigation-night-v1",name:"Navigation Night",imageUrl:V_e,mapboxStyle:"mapbox://styles/mapbox/navigation-night-v1"}],U_e=({open:e,onClose:t})=>{const{baseMap:n}=Lu(),{setBaseMap:s,saveLayerVisibilityState:a,refreshLayerVisibilityWithState:u}=_c(),f=_=>{a(),s(_),u()};return K.jsx(od,{open:e,onClose:t,header:"Choose Map Style",submitLabel:"Confirm",onSubmit:t,modalWidth:600,children:K.jsx(Ci,{sx:{display:"flex",flexWrap:"wrap",justifyContent:"center",paddingY:2,gap:3,maxWidth:580,margin:"0 auto","@media (max-width: 500px)":{maxWidth:"100%"}},children:$_e.map(_=>K.jsxs(Ci,{sx:{textAlign:"center",width:120},children:[K.jsx(ga,{onClick:()=>f(_.mapboxStyle),sx:{borderRadius:"50%",border:n===_.mapboxStyle?"4px solid #A8D99C":"2px solid transparent",padding:0,overflow:"hidden",width:120,height:120,transition:"transform 0.2s, border 0.2s","&:hover":{transform:"scale(1.1)"}},children:K.jsx("img",{src:_.imageUrl,alt:_.name,style:{width:"100%",height:"100%",objectFit:"cover",borderRadius:"50%"}})}),K.jsx(To,{variant:"caption",sx:{display:"block",marginTop:1,fontWeight:n===_.mapboxStyle?"bold":"normal",color:n===_.mapboxStyle?"#A8D99C":"inherit"},children:_.name})]},_.id))})})},G_e=({header:e,content:t,currentStep:n,totalSteps:s,onNext:a,onPrev:u,onCancel:f,onQuit:_,disableNext:r=!1,disablePrev:C=!1,themeColors:k})=>{const I=Uh();return X.useEffect(()=>{const P=D=>{D.key==="ArrowLeft"&&!C?u():D.key==="ArrowRight"&&!r&&a()};return window.addEventListener("keydown",P),()=>{window.removeEventListener("keydown",P)}},[u,a,C,r]),K.jsxs(Ci,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",bgcolor:k.backgroundColor,color:k.textColor,boxShadow:24,p:4,borderRadius:"8px",width:400,zIndex:2e3,textAlign:"center"},children:[K.jsx(ga,{onClick:f,sx:{position:"absolute",top:10,right:10,color:k.textColor},children:K.jsx(h1,{})}),K.jsx(To,{variant:"h6",sx:{mb:2},children:e}),K.jsx(Ci,{sx:{mb:3,...I.typography.body2,color:k.textColor,maxHeight:"78vh",overflowY:"auto"},children:t}),K.jsxs(Ci,{display:"flex",justifyContent:"space-around",alignItems:"center",px:"10px",children:[K.jsx(km,{variant:"outlined",onClick:u,disabled:C,sx:{borderColor:"#ECAC7A",color:"#ECAC7A",mr:2,"&:hover":{backgroundColor:"rgba(236, 172, 122, 0.1)",borderColor:"#E59548"}},children:"Back"}),K.jsx(To,{variant:"body1",sx:{color:k.textColor,fontWeight:"bold",mx:2},children:`${n} / ${s}`}),K.jsx(km,{variant:"contained",onClick:r?_:a,sx:{backgroundColor:"#A8D99C",color:"#000","&:hover":{backgroundColor:"#89C287"}},children:r?"Finish":"Next"})]})]})},H_e=({steps:e,run:t,currentStep:n,setRun:s,setPaused:a,setCurrentStep:u,themeColors:f})=>{var I,P;const _=()=>{n<e.length-1&&u(n+1)},r=()=>{n>0&&u(n-1)},C=()=>{a(!0),s(!1)},k=()=>{u(0),s(!1)};return t?K.jsxs(K.Fragment,{children:[K.jsx(Ci,{onClick:C,sx:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",backgroundColor:f.overlayColor,zIndex:1500}}),K.jsx(Ci,{onClick:D=>D.stopPropagation(),sx:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:2e3},children:K.jsx(G_e,{header:(I=e[n])==null?void 0:I.header,content:(P=e[n])==null?void 0:P.content,currentStep:n+1,totalSteps:e.length,onNext:_,onPrev:r,onCancel:C,onQuit:k,disableNext:n===e.length-1,disablePrev:n===0,themeColors:f})})]}):null},W_e="/YouGIS/assets/yey-DeTXyAvC.png",q_e="/YouGIS/assets/help-Bt4JYxyx.png",X_e="/YouGIS/assets/clip-9WSwSnrV.png",Y_e="/YouGIS/assets/lakes-DoPzQNOB.png",Z_e="/YouGIS/assets/buffer-Bg_tFht5.png",K_e="/YouGIS/assets/gap_hook-DvH1TRff.webp",J_e="/YouGIS/assets/add_layer-Bw-fpeeq.png",Q_e="/YouGIS/assets/intersect-DIbGpWnP.png",eve="/YouGIS/assets/Solvangen-CY0QxeTu.png",tve="/YouGIS/assets/forest_3km-BVx9KPJB.png",nve="/YouGIS/assets/lake_buffer-Biva-XOW.png",rve="/YouGIS/assets/create_layer-fKng9u51.png",ive="/YouGIS/assets/tutorial_menu-BVe-4U5x.png",ove="/YouGIS/assets/download_data-Do0rW106.png",sve="/YouGIS/assets/layer_styling-XlrNDelT.png",ave="/YouGIS/assets/done_download-CRv0fW7Y.png",lve="/YouGIS/assets/basemap_button-DADEUayK.png",uve="/YouGIS/assets/attribute_table-D9T86bbK.png",cve="/YouGIS/assets/forest_potential-DvZcsyvK.png",dve="/YouGIS/assets/add_create_layer-BXM_JtfB.png",hve="/YouGIS/assets/drawn_polygon_map-dRT8M3vJ.png",fve=[{header:"Welcome to YouGIS!",content:K.jsxs("div",{children:[K.jsx("p",{children:"This tutorial will guide you through some of the basic features of the app, and will hopefully help you get started."}),K.jsx("p",{children:"Click at the cross in the top right corner or anywhere outside this box to pause the tutorial. You can then do the task."}),K.jsx("p",{children:"Resume and manage the tutorial by hovering the speed dial menu in the upper right corner."}),K.jsx("div",{children:K.jsx("img",{src:ive,style:{width:"250px",height:"auto"}})}),K.jsxs("p",{children:["Click ",K.jsx("span",{style:{fontWeight:"bold"},children:"Next"})," to continue."]})]})},{header:"Information",content:K.jsxs("div",{children:[K.jsxs("ul",{style:{textAlign:"left",width:"85%",gap:2,marginBottom:"35px"},children:[K.jsx("li",{style:{marginBottom:"7px"},children:"Google Chrome is the recommended browser."}),K.jsxs("li",{style:{marginBottom:"7px"},children:["All your work will be"," ",K.jsx("span",{style:{textDecoration:"underline"},children:"lost"})," if you"," ",K.jsx("span",{style:{textDecoration:"underline"},children:"refresh"})," the page."]}),K.jsx("li",{style:{marginBottom:"13px"},children:"The left- and right-arrow keys can be used to navigate the steps of this tutorial."}),K.jsxs("li",{children:["In many of the steps in this tutorial, a more detailed guide-through of the specific task is provided when clicking the"," ",K.jsx(Vc,{sx:{paddingTop:"6px",marginBottom:"-3px",fontSize:"1.0rem"}}),"-symbol. This is often to be found in bottom left corner of the modal."]})]}),K.jsx("div",{children:K.jsx("img",{src:q_e,style:{width:"350px",height:"auto"}})})]})},{header:"You've got a mission!",content:K.jsxs("div",{children:[K.jsx("p",{children:"Solvangen kindergarten wants to build a nature hut for the children to enjoy outdoor activities, and has hired YOU to find good options for the location."}),K.jsx("div",{children:K.jsx("img",{src:K_e,style:{width:"350px",height:"auto"}})}),K.jsx("p",{style:{textAlign:"left",paddingLeft:"10px"},children:K.jsx("span",{style:{fontWeight:"bold"},children:"Here are some requirements to the location:"})}),K.jsxs("ul",{style:{textAlign:"left",width:"85%",gap:2,marginBottom:"20px"},children:[K.jsx("li",{style:{marginBottom:"7px"},children:"In a forested area"}),K.jsx("li",{style:{marginBottom:"7px"},children:"Within 3 km from the kindergarten"}),K.jsx("li",{style:{marginBottom:"7px"},children:"Closer than 100 meters to a lake"}),K.jsx("li",{children:"As close as possible to a popular hiking trail"})]}),K.jsx("p",{children:K.jsx("span",{style:{fontWeight:"bold",fontSize:"1rem"},children:"Good luck!"})})]})},{header:"Load data",content:K.jsxs("div",{children:[K.jsxs("p",{children:["Before you can start working, you need to load some data. Please click on"," ",K.jsx("a",{href:"https://github.com/PederUndheim/YouGIS/blob/main/src/data/tutorial_data.zip",target:"_blank",style:{color:"#00aaff",textDecoration:"underline"},children:"this link"})," ","to a data folder at GitHub, and download the data."]}),K.jsx("p",{children:"The position of the download button can be seen below."}),K.jsx("div",{children:K.jsx("img",{src:ove,style:{width:"370px",height:"auto"}})}),K.jsx("p",{children:"When downloaded, unpack the files on your computer."})]})},{header:"Add data to the map",content:K.jsxs("div",{children:[K.jsxs("p",{children:["Now that you have downloaded the data, the next step is to add the data as layers on the map. This is done by clicking the"," ",K.jsx("span",{style:{fontWeight:"bold"},children:"plus-symbol"})," shown in the image below."]}),K.jsx("p",{children:"To continue, you have to pause the tutorial by clicking outside of this box or clicking the cross. Remember that you continue the tutorial afterwards with the tutorial button in the right corner of the app."}),K.jsx("div",{children:K.jsx("img",{src:J_e,style:{width:"350px",height:"auto"}})}),K.jsx("p",{children:K.jsxs("span",{style:{fontWeight:"lighter"},children:[K.jsx("span",{style:{fontWeight:"bold"},children:"NB!"})," Remember to look for the"," ",K.jsx(Vc,{sx:{paddingTop:"6px",marginBottom:"-3px",fontSize:"1.0rem"}}),"-symbol in the pop-up for adding data layers for a detailed guide-through of the task."]})})]})},{header:"Layer Handling",content:K.jsxs("div",{children:[K.jsx("p",{children:"In the sidebar to the left in the app, you can see the map layers. General operations are placed at top, while operations for one specific layer are placed on each layer row."}),K.jsxs("p",{children:["You can (un)select more layers with the classical keys for file handling. (",K.jsx("span",{style:{fontWeight:"lighter"},children:"Shift- and ctrl/command-key is useful."}),")"]}),K.jsxs("p",{children:["Play around with the map layer list to get to know how it works. Try to ",K.jsx("span",{style:{fontWeight:"bold"},children:"drag and drop"})," the layers to change the visibility order, and click the eye to change the"," ",K.jsx("span",{style:{fontWeight:"bold"},children:"visibility"})," of the layer. You can also ",K.jsx("span",{style:{fontWeight:"bold"},children:"zoom to"})," one specific layer by right-clicking or clicking the three dots-menu."]}),K.jsxs("p",{children:["Also change the colors of the layers to achieve a better visually understanding of your mission. Click the"," ",K.jsx("span",{style:{fontWeight:"bold"},children:"edit-icon"}),", and change the colors as you want. The image below shows an exmaple of what colors one could use."]}),K.jsx("div",{children:K.jsx("img",{src:sve,style:{width:"360px",height:"auto"}})}),K.jsx("p",{children:K.jsxs("span",{style:{fontWeight:"lighter"},children:["Remember the"," ",K.jsx(Vc,{sx:{paddingTop:"6px",marginBottom:"-3px",fontSize:"1.0rem"}}),"-symbol for detailed steps."]})})]})},{header:"Change Map Style",content:K.jsxs("div",{children:[K.jsx("p",{children:"Explore different basemaps by clicking on this mapstyle-button shown in the image below, located in the top right corner."}),K.jsx("div",{children:K.jsx("img",{src:lve,style:{width:"300px",height:"auto"}})})]})},{header:"Find Solvangen kindergarten",content:K.jsxs("div",{children:[K.jsx("p",{children:"To start your mission, you must find the location of the kindergarten that wants you to help them."}),K.jsxs("p",{children:["To do so, the"," ",K.jsx("span",{style:{fontWeight:"bold"},children:"attribute table"})," come in handy. In this table you can inspect the information of a layer, and eventually create a new layer based on property filtering."]}),K.jsx("p",{children:"You find the attribute table by clicking on the button shown in the image below, or by right-clicking/go to the three dots-menu of the wanted layer."}),K.jsx("div",{children:K.jsx("img",{src:uve,style:{width:"360px",height:"auto"}})}),K.jsxs("p",{children:["Find the"," ",K.jsx(Vc,{sx:{paddingTop:"6px",marginBottom:"-3px",fontSize:"1.0rem"}}),"-symbol in the attribute table for further information of how to create a new layer showing"," ",K.jsx("span",{style:{fontWeight:"lighter"},children:"Solvangen kindergarten"}),"."]})]})},{header:"Organize layers",content:K.jsxs("div",{children:[K.jsx("p",{children:"Now, and further in this mission it is a good idea to keep the layers well organized."}),K.jsx("p",{children:'Give the new layer the suitable name "Solvangen barnehage". Give it a visible color and keep only some of the layers visible to gain better control.'}),K.jsx("div",{children:K.jsx("img",{src:eve,style:{width:"390px",height:"auto"}})})]})},{header:"Make buffer around the kindergarten",content:K.jsxs("div",{children:[K.jsxs("p",{children:["From the requirements, you know that you are looking for a forested area within ",K.jsx("span",{style:{fontWeight:"bold"},children:"3 km"})," from the kindergarten."]}),K.jsxs("p",{children:["To find these, you can use the"," ",K.jsx("span",{style:{fontWeight:"bold"},children:"Buffer"}),"-tool to first create a buffer around the kindergarten."]}),K.jsx("div",{children:K.jsx("img",{src:Z_e,style:{width:"360px",height:"auto"}})}),K.jsx("p",{children:"Open this tool by clicking the button shown in the image. "}),K.jsx("p",{children:K.jsxs("span",{style:{fontWeight:"lighter"},children:["Find the"," ",K.jsx(Vc,{sx:{paddingTop:"6px",marginBottom:"-3px",fontSize:"1.0rem"}}),"-symbol in the buffer-tool for the detailed steps."]})})]})},{header:"Clip the forest layer",content:K.jsxs("div",{children:[K.jsxs("p",{children:["Next, you have to clip the forest layer to this new buffer you made to retrieve the nearby forested areas. This is done by using the"," ",K.jsx("span",{style:{fontWeight:"bold"},children:"Clip"}),"-tool."]}),K.jsx("div",{children:K.jsx("img",{src:X_e,style:{width:"360px",height:"auto"}})}),K.jsx("p",{children:"Open this tool by clicking the button shown in the image. "}),K.jsx("p",{children:K.jsxs("span",{style:{fontWeight:"lighter"},children:["Find the"," ",K.jsx(Vc,{sx:{paddingTop:"6px",marginBottom:"-3px",fontSize:"1.0rem"}}),"-symbol in the clip-tool for detailed steps."]})})]})},{header:"Filter water layer to find lakes",content:K.jsxs("div",{children:[K.jsx("p",{children:"The image below shows a clean view of the current progress."}),K.jsx("div",{children:K.jsx("img",{src:tve,style:{width:"380px",height:"auto"}})}),K.jsx("p",{children:"One of the requirements of the location was to be closer than 100 meters to a lake. By visually inspecting the water bodies close to the nearby forested areas, you can observe that there is also a river in the area."}),K.jsxs("p",{children:["Use the ",K.jsx("span",{style:{fontWeight:"bold"},children:"attribute table"})," to create a new layer containing only the lakes. Go back to step 8 and find the"," ",K.jsx(Vc,{sx:{paddingTop:"3px",marginBottom:"-3px",fontSize:"1.0rem"}}),"-symbol in the attribute table for an example of how to do this if in doubt."]}),K.jsx("p",{children:'Name the new layer "innsjø" and give it a visible color.'}),K.jsx("p",{style:{textAlign:"left",paddingLeft:"10px",marginBottom:"5px"},children:K.jsx("span",{style:{fontWeight:"bold"},children:"Use these filter criteria:"})}),K.jsxs("ul",{style:{textAlign:"left",width:"85%",gap:2,marginBottom:"20px",marginTop:"0px"},children:[K.jsxs("li",{style:{marginBottom:"7px"},children:[K.jsx("span",{style:{fontWeight:"lighter"},children:"Attribute"}),": objekttypenavn"]}),K.jsxs("li",{style:{marginBottom:"7px"},children:[K.jsx("span",{style:{fontWeight:"lighter"},children:"Operation"}),": equals"]}),K.jsxs("li",{style:{marginBottom:"7px"},children:[K.jsx("span",{style:{fontWeight:"lighter"},children:"Value"}),": Innsjø"]})]})]})},{header:"Make buffer around the lakes",content:K.jsxs("div",{children:[K.jsx("p",{children:"The current progress is shown below. Only lakes are visible."}),K.jsx("div",{children:K.jsx("img",{src:Y_e,style:{width:"380px",height:"auto"}})}),K.jsxs("p",{children:["Now, your next step is to find the forest areas that are both nearby"," ",K.jsx("span",{style:{fontWeight:"bold"},children:"and"})," closer than 100 meters from a lake."]}),K.jsxs("p",{children:["The first thing to do is to use the"," ",K.jsx("span",{style:{fontWeight:"bold"},children:"Buffer"}),"-tool again and create a buffer around the lakes."]}),K.jsxs("p",{children:[K.jsx("p",{style:{textAlign:"left",paddingLeft:"10px",marginBottom:"5px"},children:K.jsx("span",{style:{fontWeight:"bold"},children:"Use these inputs:"})}),K.jsxs("ul",{style:{textAlign:"left",width:"85%",gap:2,marginBottom:"20px",marginTop:"0px"},children:[K.jsxs("li",{style:{marginBottom:"7px"},children:[K.jsx("span",{style:{fontWeight:"lighter"},children:"Select Layer"}),": innsjø"]}),K.jsxs("li",{style:{marginBottom:"7px"},children:[K.jsx("span",{style:{fontWeight:"lighter"},children:"Buffer Radius"}),": 100"]}),K.jsxs("li",{style:{marginBottom:"7px"},children:[K.jsx("span",{style:{fontWeight:"lighter"},children:"Outout Layer Name"}),": innsjø_100m"]})]})]}),K.jsx("p",{children:K.jsxs("span",{style:{fontWeight:"lighter"},children:["Go back to step 10 and find the"," ",K.jsx(Vc,{sx:{paddingTop:"3px",marginBottom:"-3px",fontSize:"1.0rem"}}),"-symbol in the buffer tool for an example of how to do this if in doubt."]})})]})},{header:"Find forested areas close to a lake",content:K.jsxs("div",{children:[K.jsx("p",{children:"The image below shows the current progress."}),K.jsx("div",{children:K.jsx("img",{src:nve,style:{width:"360px",height:"auto"}})}),K.jsxs("p",{children:["To extract the forested areas that now are both nearby the kindergarten and closer than 100 meters to a lake, use the"," ",K.jsx("span",{style:{fontWeight:"bold"},children:"Intersect"}),"-tool."]}),K.jsx("p",{children:"Open this tool by clicking the button shown in the image below."}),K.jsx("div",{children:K.jsx("img",{src:Q_e,style:{width:"300px",height:"auto"}})}),K.jsx("p",{children:K.jsxs("span",{style:{fontWeight:"lighter"},children:["Find the"," ",K.jsx(Vc,{sx:{paddingTop:"6px",marginBottom:"-3px",fontSize:"1.0rem"}}),"-symbol in the intersect-tool for further detailed steps on how to perform the intersection."]})})]})},{header:"Evaluation of potential areas",content:K.jsxs("div",{children:[K.jsx("p",{children:"The image below shows the potential areas, based on the first three requirements."}),K.jsx("div",{children:K.jsx("img",{src:cve,style:{width:"360px",height:"auto"}})}),K.jsx("p",{children:"Now, the only requirement left not yet considered, is the wish for the area to be as close as possible to a popular hiking trail."}),K.jsx("p",{children:"At this point, you could have done more operations to get closer to the best option, but you can also inspect the results you got so far and make a decision based on what you see."}),K.jsxs("p",{children:["Click ",K.jsx("span",{style:{fontWeight:"bold"},children:"Next"})," to learn how to extract the final location by drawing a polygon."]}),K.jsx("p",{children:K.jsx("span",{style:{fontWeight:"lighter"},children:"Note that the only potential area that a popular hiking trail is going through, is the topmost of the bigger areas."})})]})},{header:"Draw a polygon over the best suited area",content:K.jsxs("div",{children:[K.jsx("p",{children:"To create a new custom drawed layer, click on the icon for adding layers shown in the image below."}),K.jsx("div",{children:K.jsx("img",{src:dve,style:{width:"250px",height:"auto"}})}),K.jsxs("p",{style:{marginTop:"0px"},children:["In the pop-up for adding new layers to the map, click on the"," ",K.jsx("span",{style:{fontWeight:"lighter"},children:"CREATE LAYER"}),"-tab shown in the image below."]}),K.jsx("div",{children:K.jsx("img",{src:rve,style:{width:"360px",height:"auto"}})}),K.jsx("p",{children:K.jsxs("span",{style:{fontWeight:"lighter"},children:["Find the"," ",K.jsx(Vc,{sx:{paddingTop:"6px",marginBottom:"-3px",fontSize:"1.0rem"}}),"-symbol in the create layer-tab for further detailed steps on how to create the custom polygon layer."]})})]})},{header:"Extract the final location",content:K.jsxs("div",{children:[K.jsx("p",{children:"The image below shows the new layer that was drawn over the best suited location."}),K.jsx("div",{children:K.jsx("img",{src:hve,style:{width:"300px",height:"auto"}})}),K.jsxs("p",{children:["To extract the final location, you can use the"," ",K.jsx("span",{style:{fontWeight:"bold"},children:"Clip"}),"-tool again."]}),K.jsx("p",{children:"Go back to step 11 if you have forgotten how to clip layers."}),K.jsxs("p",{children:[K.jsx("p",{style:{textAlign:"left",paddingLeft:"10px",marginBottom:"5px"},children:K.jsx("span",{style:{fontWeight:"bold"},children:"Use these inputs:"})}),K.jsxs("ul",{style:{textAlign:"left",width:"85%",gap:2,marginBottom:"20px",marginTop:"0px"},children:[K.jsxs("li",{style:{marginBottom:"7px"},children:[K.jsx("span",{style:{fontWeight:"lighter"},children:"Select Layer to Clip"}),": skog_potensiell"]}),K.jsxs("li",{style:{marginBottom:"7px"},children:[K.jsx("span",{style:{fontWeight:"lighter"},children:"Select Polygon to Clip To"}),": polygon_område"]}),K.jsxs("li",{style:{marginBottom:"7px"},children:[K.jsx("span",{style:{fontWeight:"lighter"},children:"Outout Layer Name"}),": område_ferdig"]})]})]})]})},{header:"Download layer of final location",content:K.jsxs("div",{children:[K.jsx("p",{children:"In the image below the final location is green, visiualized together with the popular hiking trails, lakes and the kindergarten for better context."}),K.jsx("div",{children:K.jsx("img",{src:ave,style:{width:"370px",height:"auto"}})}),K.jsxs("p",{children:[K.jsx("span",{style:{fontWeight:"bold"},children:"Select"})," the layer with the final location, and click on the download-button shown in the image."]}),K.jsxs("p",{children:["Click ",K.jsx("span",{style:{fontWeight:"ligther"},children:"DOWNLOAD"})," in the pop-up to download the layer."]}),K.jsx("p",{children:"Remember to provide your recommended area to the kindergarten ;)"})]})},{header:"Mission Completed!",content:K.jsxs("div",{children:[K.jsxs("p",{children:[K.jsx("span",{style:{fontWeight:"bold"},children:"Congratulations!"})," You have now completed the mission and found a suitable location for the nature hut."]}),K.jsx("p",{children:"Hope you enjoyed this tutorial and got inspired to explore more of the opportunities in the world of GIS!"}),K.jsx("div",{children:K.jsx("img",{src:W_e,style:{width:"370px",height:"auto"}})})]})}],pve=()=>{const[e,t]=X.useState(!1),[n,s]=X.useState(!1),[a,u]=X.useState(!1),[f,_]=X.useState(!1),[r,C]=X.useState(0),k=()=>t(!0),I=()=>t(!1),P=()=>{u(!1),s(!0),_(!1)},D=()=>{u(!1),s(!0),_(!1)},N=()=>{u(!0),s(!1),_(!1)},j=()=>{u(!1),s(!0),C(0),_(!1)},W=()=>{u(!1),s(!1),_(!1)},H=a?[{icon:K.jsx(zF,{}),name:"Resume Tutorial",onClick:D},{icon:K.jsx(FF,{}),name:"Reset Tutorial",onClick:j},{icon:K.jsx(DF,{}),name:"Quit Tutorial",onClick:W}]:n?[{icon:K.jsx(moe,{}),name:"Pause Tutorial",onClick:N},{icon:K.jsx(FF,{}),name:"Reset Tutorial",onClick:j},{icon:K.jsx(DF,{}),name:"Quit Tutorial",onClick:W}]:[{icon:K.jsx(zF,{}),name:"Start Tutorial",onClick:P}];return K.jsxs(Ci,{sx:{position:"absolute",top:4,right:0,display:"flex",flexDirection:"row",justifyContent:"center",padding:2},children:[K.jsx(Ci,{sx:{pt:1.2},children:K.jsx(DE,{onClick:k,tooltipTitle:"Change Map Style",tooltipPlacement:"left",width:50,height:50,backgroundColor:"#555555",icon:K.jsx(poe,{sx:{color:"white",fontSize:"1.8rem",transition:"color 0.3s ease","&:hover":{color:"white"}}})})}),K.jsx(U_e,{open:e,onClose:I}),K.jsxs(Ci,{sx:{position:"relative",display:"flex",ml:2},children:[K.jsx(Yj,{open:f,sx:{zIndex:10,backgroundColor:"rgba(0, 0, 0, 0.5)"}}),K.jsx(uie,{ariaLabel:"Tutorial",icon:K.jsx(goe,{sx:{color:"#555555",fontSize:"2.8rem",transition:"color 0.3s ease"}}),onClose:()=>_(!1),onOpen:()=>_(!0),open:f,direction:"down",sx:{position:"relative",".MuiSpeedDial-fab":{backgroundColor:"#ECAC7A",borderRadius:"50%",width:"70px",height:"70px",color:"#ECAC7A","&:hover":{backgroundColor:"transparent",transform:"scale(1.08)",border:"1px solid #ccc",boxShadow:"0 6px 12px rgba(0, 0, 0, 0.25)"}}},children:H.map(q=>K.jsx(bie,{icon:q.icon,tooltipTitle:q.name,onClick:q.onClick,tooltipOpen:!0,FabProps:{sx:{mr:1.1,mb:.7,mt:.5,color:"#555555",borderRadius:"50%",width:"40px",height:"40px",boxShadow:"0 4px 8px rgba(0, 0, 0, 0.2)",transition:"all 0.3s ease","&:hover":{backgroundColor:"rgba(255, 255, 255, 0.1)",color:"#ffffff",transform:"scale(1.1)",boxShadow:"0 6px 12px rgba(0, 0, 0, 0.3)"}}}},q.name))})]}),K.jsx(H_e,{steps:fve,run:n,currentStep:r,setRun:s,setCurrentStep:C,setPaused:u,themeColors:{overlayColor:"rgba(0, 0, 0, 0.4)",textColor:"white",backgroundColor:"#555555",buttonColor:"#ECAC7A"}})]})},mve=()=>{const[e]=X.useState(!1),[t,n]=X.useState(!0),[s,a]=X.useState(!0),[u,f]=X.useState(350),_=()=>{n(!t)},r=()=>{a(!s)},C=k=>{f(k)};return K.jsx(PX,{children:K.jsx(Ble,{maxSnack:3,anchorOrigin:{vertical:"top",horizontal:"center"},children:K.jsx("div",{style:{height:"100vh",width:"100vw",display:"flex",flexDirection:"column",overflow:"hidden"},children:K.jsxs("div",{style:{display:"flex",flexGrow:1,position:"relative"},children:[K.jsx(uue,{children:K.jsx(R_e,{isOpen:t,currentWidth:u,onToggle:_,onResize:C,style:{zIndex:2e3}})}),K.jsx(oue,{isOpen:s,onToggle:r}),K.jsx(pve,{}),K.jsxs("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,zIndex:1,overflow:"hidden"},children:[K.jsx(AX,{style:{width:"100%",height:"100%"},onDrawingFinish:k=>{console.log("Drawing finished:",k)}}),e&&K.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:2e3},children:K.jsx(Jj,{})})]})]})})})})};q6(document.getElementById("root")).render(K.jsx(X.StrictMode,{children:K.jsx(mve,{})}));export{Ge as $,km as A,lp as B,h1 as C,dV as D,ep as E,coe as F,nd as G,Bh as H,ga as I,AX as J,Nie as K,i8 as L,mA as M,_c as N,od as O,woe as P,BE as Q,Nle as R,boe as S,To as T,Mm as U,pS as V,mo as W,uC as X,yv as Y,qk as Z,Sr as _,gi as a,Vf as a0,kh as a1,Lu as a2,voe as a3,xoe as a4,xre as a5,gl as a6,yoe as a7,doe as a8,l_e as a9,$3 as aa,yA as ab,Qf as ac,bj as ad,Ej as ae,oC as af,Fm as ag,zm as ah,Oj as ai,Hn as b,Rn as c,yr as d,Io as e,rA as f,pi as g,au as h,Bie as i,K as j,Nx as k,Uh as l,$r as m,Ui as n,pc as o,As as p,vi as q,X as r,Dn as s,Ms as t,xi as u,Qy as v,Jr as w,cV as x,Ci as y,c8 as z};
